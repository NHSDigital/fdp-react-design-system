{# DateInput macro (initial SSR parity â€“ does not include client-only validation states) #}
{% macro dateInput(params) %}
  {% set id = params.id %}
  {% set items = params.items or [
    { name: 'day', classes: 'nhsuk-input--width-2', inputMode: 'numeric', pattern: '[0-9]*' },
    { name: 'month', classes: 'nhsuk-input--width-2', inputMode: 'numeric', pattern: '[0-9]*' },
    { name: 'year', classes: 'nhsuk-input--width-4', inputMode: 'numeric', pattern: '[0-9]*' }
  ] %}
  {% set hintId = params.hint and (id + '-hint') %}
  {% set errorId = params.errorMessage and (id + '-error') %}
  {% set describedAttr = '' %}
  {% if params.fieldset and params.fieldset.describedBy %}{% set describedAttr = params.fieldset.describedBy %}{% endif %}
  {% if hintId %}{% set describedAttr = describedAttr and (describedAttr + ' ' + hintId) or hintId %}{% endif %}
  {% if errorId %}{% set describedAttr = describedAttr and (describedAttr + ' ' + errorId) or errorId %}{% endif %}
  {% set formGroupClasses = 'nhsuk-form-group' + ((params.errorMessage) and ' nhsuk-form-group--error' or '') %}
  <div class="{{ formGroupClasses }}">
    {% if params.fieldset %}
      <fieldset class="nhsuk-fieldset{% if params.fieldset.classes %} {{ params.fieldset.classes }}{% endif %}"{% if describedAttr %} aria-describedby="{{ describedAttr }}"{% endif %}>
        {% if params.fieldset.legend %}<legend class="nhsuk-fieldset__legend">{{ params.fieldset.legend }}</legend>{% endif %}
        {% if params.hint %}<div id="{{ hintId }}" class="nhsuk-hint{% if params.hint.classes %} {{ params.hint.classes }}{% endif %}">{% if params.hint.html %}{{ params.hint.html | safe }}{% else %}{{ params.hint.text }}{% endif %}</div>{% endif %}
        {% if params.errorMessage %}<span id="{{ errorId }}" class="nhsuk-error-message{% if params.errorMessage.classes %} {{ params.errorMessage.classes }}{% endif %}"><span class="nhsuk-u-visually-hidden">Error:</span> {% if params.errorMessage.html %}{{ params.errorMessage.html | safe }}{% else %}{{ params.errorMessage.text }}{% endif %}</span>{% endif %}
        {% set wrapperId = id %}
        <div class="nhsuk-date-input{% if params.className %} {{ params.className }}{% endif %}" id="{{ wrapperId }}" data-testid="date-input">
          {% for item in items %}
            {% set inputId = (item.id or (id + '-' + item.name)) %}
            {% set inputName = params.namePrefix and (params.namePrefix + '[' + item.name + ']') or item.name %}
            {% set baseLabel = item.label or (item.name | capitalize) %}
            {% set val = (params.values and (params.values[item.name] is defined) and params.values[item.name]) or '' %}
            <div class="nhsuk-date-input__item">
              <label class="nhsuk-label nhsuk-date-input__label" for="{{ inputId }}">{{ baseLabel }}</label>
              <input class="nhsuk-input nhsuk-date-input__input {{ item.classes }}" id="{{ inputId }}" name="{{ inputName }}" type="text"{% if item.inputMode %} inputMode="{{ item.inputMode }}"{% endif %}{% if item.autocomplete %} autoComplete="{{ item.autocomplete }}"{% endif %}{% if item.pattern %} pattern="{{ item.pattern }}"{% endif %}{% if describedAttr %} aria-describedby="{{ describedAttr }}"{% endif %} value="{{ val }}" />
            </div>
          {% endfor %}
        </div>
      </fieldset>
    {% else %}
      {% if params.hint %}<div id="{{ hintId }}" class="nhsuk-hint{% if params.hint.classes %} {{ params.hint.classes }}{% endif %}">{% if params.hint.html %}{{ params.hint.html | safe }}{% else %}{{ params.hint.text }}{% endif %}</div>{% endif %}
      {% if params.errorMessage %}<span id="{{ errorId }}" class="nhsuk-error-message{% if params.errorMessage.classes %} {{ params.errorMessage.classes }}{% endif %}"><span class="nhsuk-u-visually-hidden">Error:</span> {% if params.errorMessage.html %}{{ params.errorMessage.html | safe }}{% else %}{{ params.errorMessage.text }}{% endif %}</span>{% endif %}
      <div class="nhsuk-date-input{% if params.className %} {{ params.className }}{% endif %}" id="{{ id }}" data-testid="date-input">
        {% for item in items %}
          {% set inputId = (item.id or (id + '-' + item.name)) %}
          {% set inputName = params.namePrefix and (params.namePrefix + '[' + item.name + ']') or item.name %}
          {% set baseLabel = item.label or (item.name | capitalize) %}
          {% set val = (params.values and (params.values[item.name] is defined) and params.values[item.name]) or '' %}
          <div class="nhsuk-date-input__item">
            <label class="nhsuk-label nhsuk-date-input__label" for="{{ inputId }}">{{ baseLabel }}</label>
            <input class="nhsuk-input nhsuk-date-input__input {{ item.classes }}" id="{{ inputId }}" name="{{ inputName }}" type="text"{% if item.inputMode %} inputMode="{{ item.inputMode }}"{% endif %}{% if item.autocomplete %} autoComplete="{{ item.autocomplete }}"{% endif %}{% if item.pattern %} pattern="{{ item.pattern }}"{% endif %}{% if describedAttr %} aria-describedby="{{ describedAttr }}"{% endif %} value="{{ val }}" />
          </div>
        {% endfor %}
      </div>
    {% endif %}
  </div>
{% endmacro %}

{# Inner partial (scoped variables inherited) #}
{% macro _inner(params) %}{% endmacro %}
