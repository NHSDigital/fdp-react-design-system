{# Select component macro (parity with React Select) #}
{% macro select(params) %}
  {# Build class list #}
  {% set classes = 'nhsuk-select' %}{% if params.hasError %}{% set classes = classes + ' nhsuk-select--error' %}{% endif %}{% if params.className %}{% set classes = classes + ' ' + params.className %}{% endif %}
  <select
    class="{{ classes }}"
    id="{{ params.id }}"
    name="{{ params.name }}"{% if params.multiple %} multiple=""{% endif %}{% if params.size %} size="{{ params.size }}"{% endif %}{% if params.autoComplete %} autoComplete="{{ params.autoComplete }}"{% endif %}{% if params.describedBy %} aria-describedby="{{ params.describedBy }}"{% endif %}>
    {# Options via params.options #}
    {% if params.options %}
      {% for o in params.options %}
  {% set isSelected = o.selected or (params.value is defined and params.value == o.value) or (params.defaultValue is defined and params.defaultValue == o.value) %}
  <option value="{{ o.value }}"{% if o.disabled %} disabled{% endif %}{% if isSelected %} selected=""{% endif %}{% if o.selected %} data-initial-selected="true"{% endif %}>{{ o.text }}</option>
      {% endfor %}
    {% endif %}
    {# Raw children HTML string (already rendered) #}
    {% if params.children %}{{ params.children | safe }}{% endif %}
  </select>
{% endmacro %}
