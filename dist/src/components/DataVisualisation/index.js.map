{
  "version": 3,
  "sources": ["../../../../node_modules/classnames/index.js", "../../../../src/components/DataVisualisation/charts/ChartContainer.tsx", "../../../../node_modules/clsx/dist/clsx.mjs", "../../../../src/components/DataVisualisation/charts/LineChart/LineChart.tsx", "../../../../node_modules/d3-array/src/ascending.js", "../../../../node_modules/d3-array/src/descending.js", "../../../../node_modules/d3-array/src/bisector.js", "../../../../node_modules/d3-array/src/number.js", "../../../../node_modules/d3-array/src/bisect.js", "../../../../node_modules/d3-array/src/extent.js", "../../../../node_modules/internmap/src/index.js", "../../../../node_modules/d3-array/src/ticks.js", "../../../../node_modules/d3-array/src/range.js", "../../../../node_modules/d3-scale/src/init.js", "../../../../node_modules/d3-scale/src/ordinal.js", "../../../../node_modules/d3-scale/src/band.js", "../../../../node_modules/d3-color/src/define.js", "../../../../node_modules/d3-color/src/color.js", "../../../../node_modules/d3-interpolate/src/basis.js", "../../../../node_modules/d3-interpolate/src/basisClosed.js", "../../../../node_modules/d3-interpolate/src/constant.js", "../../../../node_modules/d3-interpolate/src/color.js", "../../../../node_modules/d3-interpolate/src/rgb.js", "../../../../node_modules/d3-interpolate/src/numberArray.js", "../../../../node_modules/d3-interpolate/src/array.js", "../../../../node_modules/d3-interpolate/src/date.js", "../../../../node_modules/d3-interpolate/src/number.js", "../../../../node_modules/d3-interpolate/src/object.js", "../../../../node_modules/d3-interpolate/src/string.js", "../../../../node_modules/d3-interpolate/src/value.js", "../../../../node_modules/d3-interpolate/src/round.js", "../../../../node_modules/d3-scale/src/constant.js", "../../../../node_modules/d3-scale/src/number.js", "../../../../node_modules/d3-scale/src/continuous.js", "../../../../node_modules/d3-format/src/formatDecimal.js", "../../../../node_modules/d3-format/src/exponent.js", "../../../../node_modules/d3-format/src/formatGroup.js", "../../../../node_modules/d3-format/src/formatNumerals.js", "../../../../node_modules/d3-format/src/formatSpecifier.js", "../../../../node_modules/d3-format/src/formatTrim.js", "../../../../node_modules/d3-format/src/formatPrefixAuto.js", "../../../../node_modules/d3-format/src/formatRounded.js", "../../../../node_modules/d3-format/src/formatTypes.js", "../../../../node_modules/d3-format/src/identity.js", "../../../../node_modules/d3-format/src/locale.js", "../../../../node_modules/d3-format/src/defaultLocale.js", "../../../../node_modules/d3-format/src/precisionFixed.js", "../../../../node_modules/d3-format/src/precisionPrefix.js", "../../../../node_modules/d3-format/src/precisionRound.js", "../../../../node_modules/d3-scale/src/tickFormat.js", "../../../../node_modules/d3-scale/src/linear.js", "../../../../node_modules/d3-scale/src/nice.js", "../../../../node_modules/d3-time/src/interval.js", "../../../../node_modules/d3-time/src/millisecond.js", "../../../../node_modules/d3-time/src/duration.js", "../../../../node_modules/d3-time/src/second.js", "../../../../node_modules/d3-time/src/minute.js", "../../../../node_modules/d3-time/src/hour.js", "../../../../node_modules/d3-time/src/day.js", "../../../../node_modules/d3-time/src/week.js", "../../../../node_modules/d3-time/src/month.js", "../../../../node_modules/d3-time/src/year.js", "../../../../node_modules/d3-time/src/ticks.js", "../../../../node_modules/d3-time-format/src/locale.js", "../../../../node_modules/d3-time-format/src/defaultLocale.js", "../../../../node_modules/d3-scale/src/time.js", "../../../../node_modules/d3-shape/src/constant.js", "../../../../node_modules/d3-path/src/path.js", "../../../../node_modules/d3-shape/src/path.js", "../../../../node_modules/d3-shape/src/array.js", "../../../../node_modules/d3-shape/src/curve/linear.js", "../../../../node_modules/d3-shape/src/point.js", "../../../../node_modules/d3-shape/src/line.js", "../../../../node_modules/d3-shape/src/area.js", "../../../../node_modules/d3-shape/src/curve/monotone.js", "../../../../src/components/DataVisualisation/utils/scales.ts", "../../../../src/components/DataVisualisation/hooks/useChartDimensions.ts", "../../../../src/components/DataVisualisation/core/ChartRoot.tsx", "../../../../src/components/DataVisualisation/core/ScaleContext.tsx", "../../../../src/components/DataVisualisation/charts/Axis/Axis.tsx", "../../../../src/components/DataVisualisation/charts/GridlLines/GridLines.tsx", "../../../../src/components/DataVisualisation/series/LineSeriesPrimitive.tsx", "../../../../packages/nhs-fdp/tokens/data-viz.json", "../../../../packages/nhs-fdp/tokens/colors.json", "../../../../src/components/DataVisualisation/utils/colors.ts", "../../../../src/components/DataVisualisation/core/VisibilityContext.tsx", "../../../../src/components/DataVisualisation/core/TooltipContext.tsx", "../../../../src/components/DataVisualisation/primitives/VisuallyHiddenLiveRegion.tsx", "../../../../src/components/DataVisualisation/primitives/TooltipOverlay.tsx", "../../../../src/components/Tabs/Tabs.tsx", "../../../../src/components/Button/Button.tsx", "../../../../src/components/Tables/Table.tsx", "../../../../src/components/Panel/Panel.tsx", "../../../../src/components/Heading/Heading.tsx", "../../../../src/components/DataVisualisation/charts/ChartWithTableTabs/ChartWithTableTabs.tsx", "../../../../src/components/DataVisualisation/charts/Legend/Legend.tsx", "../../../../src/components/DataVisualisation/FilterableLineChart.tsx", "../../../../src/components/DataVisualisation/series/AreaSeriesPrimitive.tsx", "../../../../src/components/DataVisualisation/series/BarSeriesPrimitive.tsx", "../../../../src/components/DataVisualisation/core/BandScalesProvider.tsx", "../../../../src/components/DataVisualisation/charts/ChartNoScript/ChartNoScript.tsx", "../../../../src/components/DataVisualisation/charts/ChartEnhancer/ChartEnhancer.tsx", "../../../../src/components/DataVisualisation/components/MetricCard/MetricCard.tsx", "../../../../src/components/DataVisualisation/charts/SPCChart/SPCChart.tsx", "../../../../src/components/DataVisualisation/charts/SPCChart/SPCTooltipOverlay.tsx", "../../../../src/components/DataVisualisation/charts/SPCChart/logic/spc.ts", "../../../../src/components/DataVisualisation/charts/SPCChart/logic/spcDescriptors.ts", "../../../../src/components/Tag/Tag.tsx", "../../../../src/components/DataVisualisation/charts/SPCIcons/SPCIcon.tsx", "../../../../src/components/DataVisualisation/charts/SPCIcons/tokenUtils.ts", "../../../../src/components/DataVisualisation/charts/SPCIcons/SPCConstants.ts", "../../../../src/components/DataVisualisation/charts/SPCIcons/SPCAssuranceIcon.tsx"],
  "sourcesContent": ["/*!\n\tCopyright (c) 2018 Jed Watson.\n\tLicensed under the MIT License (MIT), see\n\thttp://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = '';\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (arg) {\n\t\t\t\tclasses = appendClass(classes, parseValue(arg));\n\t\t\t}\n\t\t}\n\n\t\treturn classes;\n\t}\n\n\tfunction parseValue (arg) {\n\t\tif (typeof arg === 'string' || typeof arg === 'number') {\n\t\t\treturn arg;\n\t\t}\n\n\t\tif (typeof arg !== 'object') {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (Array.isArray(arg)) {\n\t\t\treturn classNames.apply(null, arg);\n\t\t}\n\n\t\tif (arg.toString !== Object.prototype.toString && !arg.toString.toString().includes('[native code]')) {\n\t\t\treturn arg.toString();\n\t\t}\n\n\t\tvar classes = '';\n\n\t\tfor (var key in arg) {\n\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\tclasses = appendClass(classes, key);\n\t\t\t}\n\t\t}\n\n\t\treturn classes;\n\t}\n\n\tfunction appendClass (value, newClass) {\n\t\tif (!newClass) {\n\t\t\treturn value;\n\t\t}\n\t\n\t\tif (value) {\n\t\t\treturn value + ' ' + newClass;\n\t\t}\n\t\n\t\treturn value + newClass;\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n", "import * as React from 'react';\nimport clsx from 'clsx';\nimport '../DataVisualisation.scss';\n\nexport interface ChartContainerProps {\n  title: string;\n  description?: string;\n  source?: string;\n  children: React.ReactNode;\n  width?: number | string;\n  height?: number;\n  className?: string;\n  id?: string;\n  tabularData?: React.ReactNode;\n  showTableToggle?: boolean;\n  onToggleTable?: () => void;\n  initiallyShowTable?: boolean;\n}\n\n/**\n * Accessible chart wrapper providing figure/figcaption semantics and optional\n * table toggle pattern for data transparency.\n */\nexport const ChartContainer: React.FC<ChartContainerProps> = ({\n  title,\n  description,\n  source,\n  children,\n  width = '100%',\n  height = 320,\n  className,\n  id,\n  tabularData,\n  showTableToggle,\n  onToggleTable,\n  initiallyShowTable = false\n}) => {\n  const figureId = React.useId();\n  const resolvedId = id || figureId;\n  const descId = description ? `${resolvedId}-desc` : undefined;\n  const sourceId = source ? `${resolvedId}-src` : undefined;\n  const [showTable, setShowTable] = React.useState(initiallyShowTable);\n\n  const handleToggle = React.useCallback(() => {\n    setShowTable(s => !s);\n    onToggleTable?.();\n  }, [onToggleTable]);\n\n  return (\n    <figure\n      id={resolvedId}\n      className={clsx('fdp-chart', className)}\n      style={{ width }}\n      aria-labelledby={`${resolvedId}-title`}\n      aria-describedby={clsx(descId, sourceId)}\n    >\n      <header className=\"fdp-chart__header\">\n        <h3 id={`${resolvedId}-title`} className=\"fdp-chart__title\">{title}</h3>\n        {showTableToggle && (\n          <button\n            type=\"button\"\n            className=\"fdp-chart__toggle\"\n            aria-expanded={showTable}\n            onClick={handleToggle}\n          >\n            {showTable ? 'Hide table' : 'Show table'}\n          </button>\n        )}\n      </header>\n      {description && (\n        <p id={descId} className=\"fdp-chart__description\">\n          {description}\n        </p>\n      )}\n      <div\n        className=\"fdp-chart__viz\"\n        style={{ height }}\n        role=\"group\"\n        aria-label={title}\n      >\n        {children}\n      </div>\n      {(source || tabularData) && (\n        <figcaption className=\"fdp-chart__caption\">\n          {source && (\n            <small id={sourceId} className=\"fdp-chart__source\">\n              Source: {source}\n            </small>\n          )}\n          {showTable && tabularData}\n        </figcaption>\n      )}\n    </figure>\n  );\n};\n\nexport default ChartContainer;\n", "function r(e){var t,f,n=\"\";if(\"string\"==typeof e||\"number\"==typeof e)n+=e;else if(\"object\"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=\" \"),n+=f)}else for(f in e)e[f]&&(n&&(n+=\" \"),n+=f);return n}export function clsx(){for(var e,t,f=0,n=\"\",o=arguments.length;f<o;f++)(e=arguments[f])&&(t=r(e))&&(n&&(n+=\" \"),n+=t);return n}export default clsx;", "import * as React from 'react';\nimport { createXTimeScale, createYLinearScale } from '../../utils/scales';\nimport { scaleTime } from 'd3-scale';\nimport { useChartDimensions } from '../../hooks/useChartDimensions';\nimport { ChartRoot, useChartContext } from '../../core/ChartRoot';\nimport ScaleContext, { useScaleContext, LineScalesProvider } from '../../core/ScaleContext';\nimport Axis from '../../charts/Axis/Axis';\nimport GridLines from '../../charts/GridlLines/GridLines';\nimport LineSeriesPrimitive from '../../series/LineSeriesPrimitive';\nimport { pickSeriesColor, pickRegionColor } from '../../utils/colors';\nimport VisuallyHiddenLiveRegion from '../../primitives/VisuallyHiddenLiveRegion';\nimport { TooltipProvider } from '../../core/TooltipContext';\nimport TooltipOverlay from '../../primitives/TooltipOverlay';\nimport { useTooltipContext } from '../../core/TooltipContext';\nimport { useVisibility } from '../../core/VisibilityContext';\n\nexport interface LineDatum { x: Date | string | number; y: number; }\nexport interface LineSeries { id: string; data: LineDatum[]; color?: string; label?: string; }\nexport interface LineChartProps {\n  series: LineSeries[];\n  height?: number;\n  yLabel?: string;\n  ariaLabel?: string;\n  showPoints?: boolean;\n  focusablePoints?: boolean;\n  /** Palette selection: 'categorical' (default 12\u2011colour data-viz set) or 'region' (maps series id to region tokens if possible) */\n  palette?: 'categorical' | 'region';\n  /** Optional date tick label formatter (defaults locale month short + day) */\n  dateFormatter?: (d: Date) => string;\n  /** Optional y-value tick formatter */\n  valueFormatter?: (n: number) => string;\n  /** Explicit x-axis tick values (dates); overrides automatic ticks. */\n  xTickValues?: (Date | string | number)[];\n  /** Convenience flag: when true, x-axis ticks align exactly to the unique set of data point x values (sorted). Ignored if xTickValues supplied. */\n  alignXTicksToData?: boolean;\n  /** Announce focused point changes via an aria live region (default true). Requires TooltipProvider higher in tree for focus changes; safe no-op otherwise. */\n  announceFocus?: boolean;\n  /** Show floating tooltip overlay (circle + label). Defaults true. */\n  showTooltipOverlay?: boolean;\n  /** Pad the x-domain by half a step on each side so edge points (focus ring) are fully visible (default true). */\n  padXDomain?: boolean;\n  /** Enable wrap-around keyboard navigation for points & series (Arrow keys wrap). */\n  wrapAroundNav?: boolean;\n  /** Opt-in: enable built-in keyboard navigation handler (Arrow/Home/End/Escape). Default false for explicit adoption. */\n  keyboardNav?: boolean;\n  /** Presentation of hidden series: 'remove' (default, series omitted) or 'fade' (dim visually, non-interactive). */\n  visibilityMode?: 'remove' | 'fade';\n  /** When true and some series are hidden, recompute y-domain using only visible series. */\n  recomputeYDomainOnHidden?: boolean;\n  /** Custom stroke width for all series (passed to LineSeriesPrimitive). */\n  strokeWidth?: number;\n  /** Enable / disable curve smoothing (monotoneX). Default true. */\n  smooth?: boolean;\n  /** Light gradient wash under lines (uses series stroke color fading to transparent). Default true. */\n  gradientFills?: boolean;\n}\n\n// Internal renderer. If used inside a ChartRoot (context) it will use those dimensions; otherwise\n// it falls back to creating its own via useChartDimensions (only for legacy direct usage path).\nconst InternalLineChart: React.FC<LineChartProps & { providedDims?: ReturnType<typeof useChartDimensions> | null }> = ({\n  series,\n  yLabel,\n  ariaLabel = 'Line chart',\n  showPoints = true,\n  focusablePoints = true,\n  palette = 'categorical',\n  dateFormatter,\n  valueFormatter,\n  xTickValues,\n  alignXTicksToData = false,\n  announceFocus = true,\n  showTooltipOverlay = true,\n  padXDomain = true,\n  wrapAroundNav = false,\n  keyboardNav = false,\n  visibilityMode = 'remove',\n  recomputeYDomainOnHidden = false,\n  strokeWidth = 1,\n  smooth = true,\n  gradientFills = true,\n  providedDims\n}) => {\n  // Prefer explicit prop (legacy), then context (ChartRoot), else create local dimensions (standalone mode)\n  const contextDims = useChartContext();\n  const dims = providedDims || (contextDims as any) || useChartDimensions({ bottom: 48, left: 56, right: 16, top: 12 });\n  const scaleCtx = useScaleContext();\n  const visibility = useVisibility();\n  const visibleSeries = React.useMemo(() => {\n    if (!visibility) return series;\n    return series.filter(s => !visibility.isHidden(s.id));\n  }, [series, visibility]);\n  const allData = React.useMemo(() => {\n    if (recomputeYDomainOnHidden && visibility) return visibleSeries.flatMap(s => s.data);\n    return series.flatMap(s => s.data);\n  }, [series, visibleSeries, recomputeYDomainOnHidden, visibility]);\n  const parseX = React.useCallback((d: LineDatum) => (d.x instanceof Date ? d.x : new Date(d.x)), []);\n  const xScale = scaleCtx ? scaleCtx.xScale : React.useMemo(() => {\n    if (!padXDomain) return createXTimeScale(allData, parseX, [0, dims.innerWidth]);\n    // Derive padded domain: half typical step either side\n    const times = allData.map(d => parseX(d).getTime()).sort((a,b)=>a-b);\n    if (times.length === 0) return createXTimeScale(allData, parseX, [0, dims.innerWidth]);\n    let step: number;\n    if (times.length === 1) {\n      step = 24 * 3600 * 1000; // 1 day default\n    } else {\n      // median of diffs for robustness\n      const diffs = [] as number[];\n      for (let i=1;i<times.length;i++) diffs.push(times[i]-times[i-1]);\n      diffs.sort((a,b)=>a-b);\n      step = diffs[Math.floor(diffs.length/2)] || (times[times.length-1]-times[0])/(times.length-1);\n    }\n    const pad = step/2;\n    const domain: [Date, Date] = [new Date(times[0]-pad), new Date(times[times.length-1]+pad)];\n    return scaleTime().domain(domain).range([0, dims.innerWidth]);\n  }, [allData, parseX, dims.innerWidth, padXDomain]);\n  const yScale = scaleCtx ? scaleCtx.yScale : React.useMemo(() => createYLinearScale(allData, d => d.y, [dims.innerHeight, 0]), [allData, dims.innerHeight]);\n  const formatDate = dateFormatter || ((d: Date) => d.toLocaleDateString(undefined,{ month:'short', day:'numeric'}));\n  const computedDataTickValues: Date[] = React.useMemo(() => {\n    if (xTickValues && xTickValues.length) return xTickValues.map(v => v instanceof Date ? v : new Date(v));\n    if (!alignXTicksToData) return [];\n    const set = new Set<number>();\n    for (const d of allData) set.add(parseX(d).getTime());\n    return Array.from(set).sort((a,b)=>a-b).map(ms => new Date(ms));\n  }, [xTickValues, alignXTicksToData, allData, parseX]);\n  const formatValue = valueFormatter || ((v: number) => String(v));\n  const gradientIds = React.useMemo(() => series.map(s => `fdp-line-grad-${s.id}`), [series]);\n  const svgContent = (\n    <svg width={dims.width} height={dims.height} role=\"img\">\n      <g transform={`translate(${dims.margin.left},${dims.margin.top})`}>\n        {gradientFills && (\n          <defs>\n            {series.map((s, i) => {\n              const lineColor = s.color || (palette === 'region' ? pickRegionColor(s.id, i) : pickSeriesColor(i));\n              return (\n                <linearGradient key={s.id} id={gradientIds[i]} x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n                  <stop offset=\"0%\" stopColor={lineColor} stopOpacity={0.25} />\n                  <stop offset=\"100%\" stopColor={lineColor} stopOpacity={0} />\n                </linearGradient>\n              );\n            })}\n          </defs>\n        )}\n        <Axis type=\"x\" formatTick={formatDate} tickValues={computedDataTickValues.length ? computedDataTickValues : undefined} />\n        <Axis type=\"y\" formatTick={formatValue} label={yLabel} />\n        <GridLines axis=\"y\" />\n  {series.map((s, si) => (\n          <LineSeriesPrimitive\n            key={s.id}\n            series={s as any}\n            seriesIndex={si}\n            palette={palette}\n            showPoints={showPoints}\n            focusablePoints={focusablePoints}\n            focusIndex={-1} // legacy prop no longer used; tooltip context drives focus\n            parseX={parseX}\n      visibilityMode={visibilityMode}\n      strokeWidth={strokeWidth}\n      smooth={smooth}\n      gradientFillId={gradientFills ? gradientIds[si] : undefined}\n          />\n        ))}\n        {showTooltipOverlay && <TooltipOverlay />}\n      </g>\n    </svg>\n  );\n\n  const KeyboardNavWrapper: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n    const t = useTooltipContext();\n    const onKeyDown = React.useCallback((e: React.KeyboardEvent) => {\n      if (!t) return;\n      switch (e.key) {\n        case 'ArrowRight': t.focusNextPoint(); e.preventDefault(); break;\n        case 'ArrowLeft': t.focusPrevPoint(); e.preventDefault(); break;\n        case 'ArrowDown': t.focusNextSeries(); e.preventDefault(); break;\n        case 'ArrowUp': t.focusPrevSeries(); e.preventDefault(); break;\n        case 'Home': t.focusFirstPoint(); e.preventDefault(); break;\n        case 'End': t.focusLastPoint(); e.preventDefault(); break;\n        case 'Escape': t.clear(); e.preventDefault(); break;\n        default: break;\n      }\n    }, [t]);\n    return (\n      <div className=\"fdp-line-chart\" role=\"group\" aria-label={ariaLabel} tabIndex={0} onKeyDown={onKeyDown}>\n        {children}\n      </div>\n    );\n  };\n\n  const body = (\n    <TooltipProvider wrapAround={wrapAroundNav}>\n      {keyboardNav ? (\n        <KeyboardNavWrapper>\n          {svgContent}\n          {announceFocus && <VisuallyHiddenLiveRegion />}\n        </KeyboardNavWrapper>\n      ) : (\n        <div className=\"fdp-line-chart\" role=\"group\" aria-label={ariaLabel}>\n          {svgContent}\n          {announceFocus && <VisuallyHiddenLiveRegion />}\n        </div>\n      )}\n    </TooltipProvider>\n  );\n  if (scaleCtx) return body;\n  // Provide ad-hoc ScaleContext so Axis/GridLines can function when no external provider.\n  const value = {\n    xScale,\n    yScale,\n    getXTicks: (c = 6) => xScale.ticks(c),\n    getYTicks: (c = 5) => yScale.ticks(c)\n  };\n  return <ScaleContext.Provider value={value}>{body}</ScaleContext.Provider>;\n};\n\nexport const LineChart: React.FC<LineChartProps> = (props) => {\n  const ctx = useChartContext();\n  const content = <InternalLineChart {...props} providedDims={ctx as any} />;\n  if (ctx) {\n    // If already inside ChartRoot and no ScaleContext provided higher up, mount a provider here.\n    return useScaleContext() ? content : (\n      <LineScalesProvider series={props.series} innerWidth={ctx.innerWidth} innerHeight={ctx.innerHeight}>\n        {content}\n      </LineScalesProvider>\n    );\n  }\n  // Standalone: create ChartRoot then provide scales then render internal\n  const ariaLabel = (props as any).ariaLabel;\n  return (\n    <ChartRoot height={(props as any).height ?? 240} ariaLabel={ariaLabel} margin={{ bottom: 48, left: 56, right: 16, top: 12 }}>\n  {/* No ScaleContext in standalone mode so InternalLineChart builds its own scales with measured dims */}\n  <InternalLineChart {...props} />\n    </ChartRoot>\n  );\n};\n\nexport default LineChart;\n", "export default function ascending(a, b) {\n  return a == null || b == null ? NaN : a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n", "export default function descending(a, b) {\n  return a == null || b == null ? NaN\n    : b < a ? -1\n    : b > a ? 1\n    : b >= a ? 0\n    : NaN;\n}\n", "import ascending from \"./ascending.js\";\nimport descending from \"./descending.js\";\n\nexport default function bisector(f) {\n  let compare1, compare2, delta;\n\n  // If an accessor is specified, promote it to a comparator. In this case we\n  // can test whether the search value is (self-) comparable. We can\u2019t do this\n  // for a comparator (except for specific, known comparators) because we can\u2019t\n  // tell if the comparator is symmetric, and an asymmetric comparator can\u2019t be\n  // used to test whether a single value is comparable.\n  if (f.length !== 2) {\n    compare1 = ascending;\n    compare2 = (d, x) => ascending(f(d), x);\n    delta = (d, x) => f(d) - x;\n  } else {\n    compare1 = f === ascending || f === descending ? f : zero;\n    compare2 = f;\n    delta = f;\n  }\n\n  function left(a, x, lo = 0, hi = a.length) {\n    if (lo < hi) {\n      if (compare1(x, x) !== 0) return hi;\n      do {\n        const mid = (lo + hi) >>> 1;\n        if (compare2(a[mid], x) < 0) lo = mid + 1;\n        else hi = mid;\n      } while (lo < hi);\n    }\n    return lo;\n  }\n\n  function right(a, x, lo = 0, hi = a.length) {\n    if (lo < hi) {\n      if (compare1(x, x) !== 0) return hi;\n      do {\n        const mid = (lo + hi) >>> 1;\n        if (compare2(a[mid], x) <= 0) lo = mid + 1;\n        else hi = mid;\n      } while (lo < hi);\n    }\n    return lo;\n  }\n\n  function center(a, x, lo = 0, hi = a.length) {\n    const i = left(a, x, lo, hi - 1);\n    return i > lo && delta(a[i - 1], x) > -delta(a[i], x) ? i - 1 : i;\n  }\n\n  return {left, center, right};\n}\n\nfunction zero() {\n  return 0;\n}\n", "export default function number(x) {\n  return x === null ? NaN : +x;\n}\n\nexport function* numbers(values, valueof) {\n  if (valueof === undefined) {\n    for (let value of values) {\n      if (value != null && (value = +value) >= value) {\n        yield value;\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null && (value = +value) >= value) {\n        yield value;\n      }\n    }\n  }\n}\n", "import ascending from \"./ascending.js\";\nimport bisector from \"./bisector.js\";\nimport number from \"./number.js\";\n\nconst ascendingBisect = bisector(ascending);\nexport const bisectRight = ascendingBisect.right;\nexport const bisectLeft = ascendingBisect.left;\nexport const bisectCenter = bisector(number).center;\nexport default bisectRight;\n", "export default function extent(values, valueof) {\n  let min;\n  let max;\n  if (valueof === undefined) {\n    for (const value of values) {\n      if (value != null) {\n        if (min === undefined) {\n          if (value >= value) min = max = value;\n        } else {\n          if (min > value) min = value;\n          if (max < value) max = value;\n        }\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null) {\n        if (min === undefined) {\n          if (value >= value) min = max = value;\n        } else {\n          if (min > value) min = value;\n          if (max < value) max = value;\n        }\n      }\n    }\n  }\n  return [min, max];\n}\n", "export class InternMap extends Map {\n  constructor(entries, key = keyof) {\n    super();\n    Object.defineProperties(this, {_intern: {value: new Map()}, _key: {value: key}});\n    if (entries != null) for (const [key, value] of entries) this.set(key, value);\n  }\n  get(key) {\n    return super.get(intern_get(this, key));\n  }\n  has(key) {\n    return super.has(intern_get(this, key));\n  }\n  set(key, value) {\n    return super.set(intern_set(this, key), value);\n  }\n  delete(key) {\n    return super.delete(intern_delete(this, key));\n  }\n}\n\nexport class InternSet extends Set {\n  constructor(values, key = keyof) {\n    super();\n    Object.defineProperties(this, {_intern: {value: new Map()}, _key: {value: key}});\n    if (values != null) for (const value of values) this.add(value);\n  }\n  has(value) {\n    return super.has(intern_get(this, value));\n  }\n  add(value) {\n    return super.add(intern_set(this, value));\n  }\n  delete(value) {\n    return super.delete(intern_delete(this, value));\n  }\n}\n\nfunction intern_get({_intern, _key}, value) {\n  const key = _key(value);\n  return _intern.has(key) ? _intern.get(key) : value;\n}\n\nfunction intern_set({_intern, _key}, value) {\n  const key = _key(value);\n  if (_intern.has(key)) return _intern.get(key);\n  _intern.set(key, value);\n  return value;\n}\n\nfunction intern_delete({_intern, _key}, value) {\n  const key = _key(value);\n  if (_intern.has(key)) {\n    value = _intern.get(key);\n    _intern.delete(key);\n  }\n  return value;\n}\n\nfunction keyof(value) {\n  return value !== null && typeof value === \"object\" ? value.valueOf() : value;\n}\n", "const e10 = Math.sqrt(50),\n    e5 = Math.sqrt(10),\n    e2 = Math.sqrt(2);\n\nfunction tickSpec(start, stop, count) {\n  const step = (stop - start) / Math.max(0, count),\n      power = Math.floor(Math.log10(step)),\n      error = step / Math.pow(10, power),\n      factor = error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1;\n  let i1, i2, inc;\n  if (power < 0) {\n    inc = Math.pow(10, -power) / factor;\n    i1 = Math.round(start * inc);\n    i2 = Math.round(stop * inc);\n    if (i1 / inc < start) ++i1;\n    if (i2 / inc > stop) --i2;\n    inc = -inc;\n  } else {\n    inc = Math.pow(10, power) * factor;\n    i1 = Math.round(start / inc);\n    i2 = Math.round(stop / inc);\n    if (i1 * inc < start) ++i1;\n    if (i2 * inc > stop) --i2;\n  }\n  if (i2 < i1 && 0.5 <= count && count < 2) return tickSpec(start, stop, count * 2);\n  return [i1, i2, inc];\n}\n\nexport default function ticks(start, stop, count) {\n  stop = +stop, start = +start, count = +count;\n  if (!(count > 0)) return [];\n  if (start === stop) return [start];\n  const reverse = stop < start, [i1, i2, inc] = reverse ? tickSpec(stop, start, count) : tickSpec(start, stop, count);\n  if (!(i2 >= i1)) return [];\n  const n = i2 - i1 + 1, ticks = new Array(n);\n  if (reverse) {\n    if (inc < 0) for (let i = 0; i < n; ++i) ticks[i] = (i2 - i) / -inc;\n    else for (let i = 0; i < n; ++i) ticks[i] = (i2 - i) * inc;\n  } else {\n    if (inc < 0) for (let i = 0; i < n; ++i) ticks[i] = (i1 + i) / -inc;\n    else for (let i = 0; i < n; ++i) ticks[i] = (i1 + i) * inc;\n  }\n  return ticks;\n}\n\nexport function tickIncrement(start, stop, count) {\n  stop = +stop, start = +start, count = +count;\n  return tickSpec(start, stop, count)[2];\n}\n\nexport function tickStep(start, stop, count) {\n  stop = +stop, start = +start, count = +count;\n  const reverse = stop < start, inc = reverse ? tickIncrement(stop, start, count) : tickIncrement(start, stop, count);\n  return (reverse ? -1 : 1) * (inc < 0 ? 1 / -inc : inc);\n}\n", "export default function range(start, stop, step) {\n  start = +start, stop = +stop, step = (n = arguments.length) < 2 ? (stop = start, start = 0, 1) : n < 3 ? 1 : +step;\n\n  var i = -1,\n      n = Math.max(0, Math.ceil((stop - start) / step)) | 0,\n      range = new Array(n);\n\n  while (++i < n) {\n    range[i] = start + i * step;\n  }\n\n  return range;\n}\n", "export function initRange(domain, range) {\n  switch (arguments.length) {\n    case 0: break;\n    case 1: this.range(domain); break;\n    default: this.range(range).domain(domain); break;\n  }\n  return this;\n}\n\nexport function initInterpolator(domain, interpolator) {\n  switch (arguments.length) {\n    case 0: break;\n    case 1: {\n      if (typeof domain === \"function\") this.interpolator(domain);\n      else this.range(domain);\n      break;\n    }\n    default: {\n      this.domain(domain);\n      if (typeof interpolator === \"function\") this.interpolator(interpolator);\n      else this.range(interpolator);\n      break;\n    }\n  }\n  return this;\n}\n", "import {InternMap} from \"d3-array\";\nimport {initRange} from \"./init.js\";\n\nexport const implicit = Symbol(\"implicit\");\n\nexport default function ordinal() {\n  var index = new InternMap(),\n      domain = [],\n      range = [],\n      unknown = implicit;\n\n  function scale(d) {\n    let i = index.get(d);\n    if (i === undefined) {\n      if (unknown !== implicit) return unknown;\n      index.set(d, i = domain.push(d) - 1);\n    }\n    return range[i % range.length];\n  }\n\n  scale.domain = function(_) {\n    if (!arguments.length) return domain.slice();\n    domain = [], index = new InternMap();\n    for (const value of _) {\n      if (index.has(value)) continue;\n      index.set(value, domain.push(value) - 1);\n    }\n    return scale;\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = Array.from(_), scale) : range.slice();\n  };\n\n  scale.unknown = function(_) {\n    return arguments.length ? (unknown = _, scale) : unknown;\n  };\n\n  scale.copy = function() {\n    return ordinal(domain, range).unknown(unknown);\n  };\n\n  initRange.apply(scale, arguments);\n\n  return scale;\n}\n", "import {range as sequence} from \"d3-array\";\nimport {initRange} from \"./init.js\";\nimport ordinal from \"./ordinal.js\";\n\nexport default function band() {\n  var scale = ordinal().unknown(undefined),\n      domain = scale.domain,\n      ordinalRange = scale.range,\n      r0 = 0,\n      r1 = 1,\n      step,\n      bandwidth,\n      round = false,\n      paddingInner = 0,\n      paddingOuter = 0,\n      align = 0.5;\n\n  delete scale.unknown;\n\n  function rescale() {\n    var n = domain().length,\n        reverse = r1 < r0,\n        start = reverse ? r1 : r0,\n        stop = reverse ? r0 : r1;\n    step = (stop - start) / Math.max(1, n - paddingInner + paddingOuter * 2);\n    if (round) step = Math.floor(step);\n    start += (stop - start - step * (n - paddingInner)) * align;\n    bandwidth = step * (1 - paddingInner);\n    if (round) start = Math.round(start), bandwidth = Math.round(bandwidth);\n    var values = sequence(n).map(function(i) { return start + step * i; });\n    return ordinalRange(reverse ? values.reverse() : values);\n  }\n\n  scale.domain = function(_) {\n    return arguments.length ? (domain(_), rescale()) : domain();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? ([r0, r1] = _, r0 = +r0, r1 = +r1, rescale()) : [r0, r1];\n  };\n\n  scale.rangeRound = function(_) {\n    return [r0, r1] = _, r0 = +r0, r1 = +r1, round = true, rescale();\n  };\n\n  scale.bandwidth = function() {\n    return bandwidth;\n  };\n\n  scale.step = function() {\n    return step;\n  };\n\n  scale.round = function(_) {\n    return arguments.length ? (round = !!_, rescale()) : round;\n  };\n\n  scale.padding = function(_) {\n    return arguments.length ? (paddingInner = Math.min(1, paddingOuter = +_), rescale()) : paddingInner;\n  };\n\n  scale.paddingInner = function(_) {\n    return arguments.length ? (paddingInner = Math.min(1, _), rescale()) : paddingInner;\n  };\n\n  scale.paddingOuter = function(_) {\n    return arguments.length ? (paddingOuter = +_, rescale()) : paddingOuter;\n  };\n\n  scale.align = function(_) {\n    return arguments.length ? (align = Math.max(0, Math.min(1, _)), rescale()) : align;\n  };\n\n  scale.copy = function() {\n    return band(domain(), [r0, r1])\n        .round(round)\n        .paddingInner(paddingInner)\n        .paddingOuter(paddingOuter)\n        .align(align);\n  };\n\n  return initRange.apply(rescale(), arguments);\n}\n\nfunction pointish(scale) {\n  var copy = scale.copy;\n\n  scale.padding = scale.paddingOuter;\n  delete scale.paddingInner;\n  delete scale.paddingOuter;\n\n  scale.copy = function() {\n    return pointish(copy());\n  };\n\n  return scale;\n}\n\nexport function point() {\n  return pointish(band.apply(null, arguments).paddingInner(1));\n}\n", "export default function(constructor, factory, prototype) {\n  constructor.prototype = factory.prototype = prototype;\n  prototype.constructor = constructor;\n}\n\nexport function extend(parent, definition) {\n  var prototype = Object.create(parent.prototype);\n  for (var key in definition) prototype[key] = definition[key];\n  return prototype;\n}\n", "import define, {extend} from \"./define.js\";\n\nexport function Color() {}\n\nexport var darker = 0.7;\nexport var brighter = 1 / darker;\n\nvar reI = \"\\\\s*([+-]?\\\\d+)\\\\s*\",\n    reN = \"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",\n    reP = \"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",\n    reHex = /^#([0-9a-f]{3,8})$/,\n    reRgbInteger = new RegExp(`^rgb\\\\(${reI},${reI},${reI}\\\\)$`),\n    reRgbPercent = new RegExp(`^rgb\\\\(${reP},${reP},${reP}\\\\)$`),\n    reRgbaInteger = new RegExp(`^rgba\\\\(${reI},${reI},${reI},${reN}\\\\)$`),\n    reRgbaPercent = new RegExp(`^rgba\\\\(${reP},${reP},${reP},${reN}\\\\)$`),\n    reHslPercent = new RegExp(`^hsl\\\\(${reN},${reP},${reP}\\\\)$`),\n    reHslaPercent = new RegExp(`^hsla\\\\(${reN},${reP},${reP},${reN}\\\\)$`);\n\nvar named = {\n  aliceblue: 0xf0f8ff,\n  antiquewhite: 0xfaebd7,\n  aqua: 0x00ffff,\n  aquamarine: 0x7fffd4,\n  azure: 0xf0ffff,\n  beige: 0xf5f5dc,\n  bisque: 0xffe4c4,\n  black: 0x000000,\n  blanchedalmond: 0xffebcd,\n  blue: 0x0000ff,\n  blueviolet: 0x8a2be2,\n  brown: 0xa52a2a,\n  burlywood: 0xdeb887,\n  cadetblue: 0x5f9ea0,\n  chartreuse: 0x7fff00,\n  chocolate: 0xd2691e,\n  coral: 0xff7f50,\n  cornflowerblue: 0x6495ed,\n  cornsilk: 0xfff8dc,\n  crimson: 0xdc143c,\n  cyan: 0x00ffff,\n  darkblue: 0x00008b,\n  darkcyan: 0x008b8b,\n  darkgoldenrod: 0xb8860b,\n  darkgray: 0xa9a9a9,\n  darkgreen: 0x006400,\n  darkgrey: 0xa9a9a9,\n  darkkhaki: 0xbdb76b,\n  darkmagenta: 0x8b008b,\n  darkolivegreen: 0x556b2f,\n  darkorange: 0xff8c00,\n  darkorchid: 0x9932cc,\n  darkred: 0x8b0000,\n  darksalmon: 0xe9967a,\n  darkseagreen: 0x8fbc8f,\n  darkslateblue: 0x483d8b,\n  darkslategray: 0x2f4f4f,\n  darkslategrey: 0x2f4f4f,\n  darkturquoise: 0x00ced1,\n  darkviolet: 0x9400d3,\n  deeppink: 0xff1493,\n  deepskyblue: 0x00bfff,\n  dimgray: 0x696969,\n  dimgrey: 0x696969,\n  dodgerblue: 0x1e90ff,\n  firebrick: 0xb22222,\n  floralwhite: 0xfffaf0,\n  forestgreen: 0x228b22,\n  fuchsia: 0xff00ff,\n  gainsboro: 0xdcdcdc,\n  ghostwhite: 0xf8f8ff,\n  gold: 0xffd700,\n  goldenrod: 0xdaa520,\n  gray: 0x808080,\n  green: 0x008000,\n  greenyellow: 0xadff2f,\n  grey: 0x808080,\n  honeydew: 0xf0fff0,\n  hotpink: 0xff69b4,\n  indianred: 0xcd5c5c,\n  indigo: 0x4b0082,\n  ivory: 0xfffff0,\n  khaki: 0xf0e68c,\n  lavender: 0xe6e6fa,\n  lavenderblush: 0xfff0f5,\n  lawngreen: 0x7cfc00,\n  lemonchiffon: 0xfffacd,\n  lightblue: 0xadd8e6,\n  lightcoral: 0xf08080,\n  lightcyan: 0xe0ffff,\n  lightgoldenrodyellow: 0xfafad2,\n  lightgray: 0xd3d3d3,\n  lightgreen: 0x90ee90,\n  lightgrey: 0xd3d3d3,\n  lightpink: 0xffb6c1,\n  lightsalmon: 0xffa07a,\n  lightseagreen: 0x20b2aa,\n  lightskyblue: 0x87cefa,\n  lightslategray: 0x778899,\n  lightslategrey: 0x778899,\n  lightsteelblue: 0xb0c4de,\n  lightyellow: 0xffffe0,\n  lime: 0x00ff00,\n  limegreen: 0x32cd32,\n  linen: 0xfaf0e6,\n  magenta: 0xff00ff,\n  maroon: 0x800000,\n  mediumaquamarine: 0x66cdaa,\n  mediumblue: 0x0000cd,\n  mediumorchid: 0xba55d3,\n  mediumpurple: 0x9370db,\n  mediumseagreen: 0x3cb371,\n  mediumslateblue: 0x7b68ee,\n  mediumspringgreen: 0x00fa9a,\n  mediumturquoise: 0x48d1cc,\n  mediumvioletred: 0xc71585,\n  midnightblue: 0x191970,\n  mintcream: 0xf5fffa,\n  mistyrose: 0xffe4e1,\n  moccasin: 0xffe4b5,\n  navajowhite: 0xffdead,\n  navy: 0x000080,\n  oldlace: 0xfdf5e6,\n  olive: 0x808000,\n  olivedrab: 0x6b8e23,\n  orange: 0xffa500,\n  orangered: 0xff4500,\n  orchid: 0xda70d6,\n  palegoldenrod: 0xeee8aa,\n  palegreen: 0x98fb98,\n  paleturquoise: 0xafeeee,\n  palevioletred: 0xdb7093,\n  papayawhip: 0xffefd5,\n  peachpuff: 0xffdab9,\n  peru: 0xcd853f,\n  pink: 0xffc0cb,\n  plum: 0xdda0dd,\n  powderblue: 0xb0e0e6,\n  purple: 0x800080,\n  rebeccapurple: 0x663399,\n  red: 0xff0000,\n  rosybrown: 0xbc8f8f,\n  royalblue: 0x4169e1,\n  saddlebrown: 0x8b4513,\n  salmon: 0xfa8072,\n  sandybrown: 0xf4a460,\n  seagreen: 0x2e8b57,\n  seashell: 0xfff5ee,\n  sienna: 0xa0522d,\n  silver: 0xc0c0c0,\n  skyblue: 0x87ceeb,\n  slateblue: 0x6a5acd,\n  slategray: 0x708090,\n  slategrey: 0x708090,\n  snow: 0xfffafa,\n  springgreen: 0x00ff7f,\n  steelblue: 0x4682b4,\n  tan: 0xd2b48c,\n  teal: 0x008080,\n  thistle: 0xd8bfd8,\n  tomato: 0xff6347,\n  turquoise: 0x40e0d0,\n  violet: 0xee82ee,\n  wheat: 0xf5deb3,\n  white: 0xffffff,\n  whitesmoke: 0xf5f5f5,\n  yellow: 0xffff00,\n  yellowgreen: 0x9acd32\n};\n\ndefine(Color, color, {\n  copy(channels) {\n    return Object.assign(new this.constructor, this, channels);\n  },\n  displayable() {\n    return this.rgb().displayable();\n  },\n  hex: color_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: color_formatHex,\n  formatHex8: color_formatHex8,\n  formatHsl: color_formatHsl,\n  formatRgb: color_formatRgb,\n  toString: color_formatRgb\n});\n\nfunction color_formatHex() {\n  return this.rgb().formatHex();\n}\n\nfunction color_formatHex8() {\n  return this.rgb().formatHex8();\n}\n\nfunction color_formatHsl() {\n  return hslConvert(this).formatHsl();\n}\n\nfunction color_formatRgb() {\n  return this.rgb().formatRgb();\n}\n\nexport default function color(format) {\n  var m, l;\n  format = (format + \"\").trim().toLowerCase();\n  return (m = reHex.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn(m) // #ff0000\n      : l === 3 ? new Rgb((m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), ((m & 0xf) << 4) | (m & 0xf), 1) // #f00\n      : l === 8 ? rgba(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000\n      : l === 4 ? rgba((m >> 12 & 0xf) | (m >> 8 & 0xf0), (m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), (((m & 0xf) << 4) | (m & 0xf)) / 0xff) // #f000\n      : null) // invalid hex\n      : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) // rgb(255, 0, 0)\n      : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)\n      : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)\n      : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)\n      : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)\n      : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)\n      : named.hasOwnProperty(format) ? rgbn(named[format]) // eslint-disable-line no-prototype-builtins\n      : format === \"transparent\" ? new Rgb(NaN, NaN, NaN, 0)\n      : null;\n}\n\nfunction rgbn(n) {\n  return new Rgb(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);\n}\n\nfunction rgba(r, g, b, a) {\n  if (a <= 0) r = g = b = NaN;\n  return new Rgb(r, g, b, a);\n}\n\nexport function rgbConvert(o) {\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Rgb;\n  o = o.rgb();\n  return new Rgb(o.r, o.g, o.b, o.opacity);\n}\n\nexport function rgb(r, g, b, opacity) {\n  return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b, opacity == null ? 1 : opacity);\n}\n\nexport function Rgb(r, g, b, opacity) {\n  this.r = +r;\n  this.g = +g;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Rgb, rgb, extend(Color, {\n  brighter(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  darker(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  rgb() {\n    return this;\n  },\n  clamp() {\n    return new Rgb(clampi(this.r), clampi(this.g), clampi(this.b), clampa(this.opacity));\n  },\n  displayable() {\n    return (-0.5 <= this.r && this.r < 255.5)\n        && (-0.5 <= this.g && this.g < 255.5)\n        && (-0.5 <= this.b && this.b < 255.5)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  hex: rgb_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: rgb_formatHex,\n  formatHex8: rgb_formatHex8,\n  formatRgb: rgb_formatRgb,\n  toString: rgb_formatRgb\n}));\n\nfunction rgb_formatHex() {\n  return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}`;\n}\n\nfunction rgb_formatHex8() {\n  return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity) ? 1 : this.opacity) * 255)}`;\n}\n\nfunction rgb_formatRgb() {\n  const a = clampa(this.opacity);\n  return `${a === 1 ? \"rgb(\" : \"rgba(\"}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${a === 1 ? \")\" : `, ${a})`}`;\n}\n\nfunction clampa(opacity) {\n  return isNaN(opacity) ? 1 : Math.max(0, Math.min(1, opacity));\n}\n\nfunction clampi(value) {\n  return Math.max(0, Math.min(255, Math.round(value) || 0));\n}\n\nfunction hex(value) {\n  value = clampi(value);\n  return (value < 16 ? \"0\" : \"\") + value.toString(16);\n}\n\nfunction hsla(h, s, l, a) {\n  if (a <= 0) h = s = l = NaN;\n  else if (l <= 0 || l >= 1) h = s = NaN;\n  else if (s <= 0) h = NaN;\n  return new Hsl(h, s, l, a);\n}\n\nexport function hslConvert(o) {\n  if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Hsl;\n  if (o instanceof Hsl) return o;\n  o = o.rgb();\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      min = Math.min(r, g, b),\n      max = Math.max(r, g, b),\n      h = NaN,\n      s = max - min,\n      l = (max + min) / 2;\n  if (s) {\n    if (r === max) h = (g - b) / s + (g < b) * 6;\n    else if (g === max) h = (b - r) / s + 2;\n    else h = (r - g) / s + 4;\n    s /= l < 0.5 ? max + min : 2 - max - min;\n    h *= 60;\n  } else {\n    s = l > 0 && l < 1 ? 0 : h;\n  }\n  return new Hsl(h, s, l, o.opacity);\n}\n\nexport function hsl(h, s, l, opacity) {\n  return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity == null ? 1 : opacity);\n}\n\nfunction Hsl(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Hsl, hsl, extend(Color, {\n  brighter(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb() {\n    var h = this.h % 360 + (this.h < 0) * 360,\n        s = isNaN(h) || isNaN(this.s) ? 0 : this.s,\n        l = this.l,\n        m2 = l + (l < 0.5 ? l : 1 - l) * s,\n        m1 = 2 * l - m2;\n    return new Rgb(\n      hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2),\n      hsl2rgb(h, m1, m2),\n      hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2),\n      this.opacity\n    );\n  },\n  clamp() {\n    return new Hsl(clamph(this.h), clampt(this.s), clampt(this.l), clampa(this.opacity));\n  },\n  displayable() {\n    return (0 <= this.s && this.s <= 1 || isNaN(this.s))\n        && (0 <= this.l && this.l <= 1)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  formatHsl() {\n    const a = clampa(this.opacity);\n    return `${a === 1 ? \"hsl(\" : \"hsla(\"}${clamph(this.h)}, ${clampt(this.s) * 100}%, ${clampt(this.l) * 100}%${a === 1 ? \")\" : `, ${a})`}`;\n  }\n}));\n\nfunction clamph(value) {\n  value = (value || 0) % 360;\n  return value < 0 ? value + 360 : value;\n}\n\nfunction clampt(value) {\n  return Math.max(0, Math.min(1, value || 0));\n}\n\n/* From FvD 13.37, CSS Color Module Level 3 */\nfunction hsl2rgb(h, m1, m2) {\n  return (h < 60 ? m1 + (m2 - m1) * h / 60\n      : h < 180 ? m2\n      : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60\n      : m1) * 255;\n}\n", "export function basis(t1, v0, v1, v2, v3) {\n  var t2 = t1 * t1, t3 = t2 * t1;\n  return ((1 - 3 * t1 + 3 * t2 - t3) * v0\n      + (4 - 6 * t2 + 3 * t3) * v1\n      + (1 + 3 * t1 + 3 * t2 - 3 * t3) * v2\n      + t3 * v3) / 6;\n}\n\nexport default function(values) {\n  var n = values.length - 1;\n  return function(t) {\n    var i = t <= 0 ? (t = 0) : t >= 1 ? (t = 1, n - 1) : Math.floor(t * n),\n        v1 = values[i],\n        v2 = values[i + 1],\n        v0 = i > 0 ? values[i - 1] : 2 * v1 - v2,\n        v3 = i < n - 1 ? values[i + 2] : 2 * v2 - v1;\n    return basis((t - i / n) * n, v0, v1, v2, v3);\n  };\n}\n", "import {basis} from \"./basis.js\";\n\nexport default function(values) {\n  var n = values.length;\n  return function(t) {\n    var i = Math.floor(((t %= 1) < 0 ? ++t : t) * n),\n        v0 = values[(i + n - 1) % n],\n        v1 = values[i % n],\n        v2 = values[(i + 1) % n],\n        v3 = values[(i + 2) % n];\n    return basis((t - i / n) * n, v0, v1, v2, v3);\n  };\n}\n", "export default x => () => x;\n", "import constant from \"./constant.js\";\n\nfunction linear(a, d) {\n  return function(t) {\n    return a + t * d;\n  };\n}\n\nfunction exponential(a, b, y) {\n  return a = Math.pow(a, y), b = Math.pow(b, y) - a, y = 1 / y, function(t) {\n    return Math.pow(a + t * b, y);\n  };\n}\n\nexport function hue(a, b) {\n  var d = b - a;\n  return d ? linear(a, d > 180 || d < -180 ? d - 360 * Math.round(d / 360) : d) : constant(isNaN(a) ? b : a);\n}\n\nexport function gamma(y) {\n  return (y = +y) === 1 ? nogamma : function(a, b) {\n    return b - a ? exponential(a, b, y) : constant(isNaN(a) ? b : a);\n  };\n}\n\nexport default function nogamma(a, b) {\n  var d = b - a;\n  return d ? linear(a, d) : constant(isNaN(a) ? b : a);\n}\n", "import {rgb as colorRgb} from \"d3-color\";\nimport basis from \"./basis.js\";\nimport basisClosed from \"./basisClosed.js\";\nimport nogamma, {gamma} from \"./color.js\";\n\nexport default (function rgbGamma(y) {\n  var color = gamma(y);\n\n  function rgb(start, end) {\n    var r = color((start = colorRgb(start)).r, (end = colorRgb(end)).r),\n        g = color(start.g, end.g),\n        b = color(start.b, end.b),\n        opacity = nogamma(start.opacity, end.opacity);\n    return function(t) {\n      start.r = r(t);\n      start.g = g(t);\n      start.b = b(t);\n      start.opacity = opacity(t);\n      return start + \"\";\n    };\n  }\n\n  rgb.gamma = rgbGamma;\n\n  return rgb;\n})(1);\n\nfunction rgbSpline(spline) {\n  return function(colors) {\n    var n = colors.length,\n        r = new Array(n),\n        g = new Array(n),\n        b = new Array(n),\n        i, color;\n    for (i = 0; i < n; ++i) {\n      color = colorRgb(colors[i]);\n      r[i] = color.r || 0;\n      g[i] = color.g || 0;\n      b[i] = color.b || 0;\n    }\n    r = spline(r);\n    g = spline(g);\n    b = spline(b);\n    color.opacity = 1;\n    return function(t) {\n      color.r = r(t);\n      color.g = g(t);\n      color.b = b(t);\n      return color + \"\";\n    };\n  };\n}\n\nexport var rgbBasis = rgbSpline(basis);\nexport var rgbBasisClosed = rgbSpline(basisClosed);\n", "export default function(a, b) {\n  if (!b) b = [];\n  var n = a ? Math.min(b.length, a.length) : 0,\n      c = b.slice(),\n      i;\n  return function(t) {\n    for (i = 0; i < n; ++i) c[i] = a[i] * (1 - t) + b[i] * t;\n    return c;\n  };\n}\n\nexport function isNumberArray(x) {\n  return ArrayBuffer.isView(x) && !(x instanceof DataView);\n}\n", "import value from \"./value.js\";\nimport numberArray, {isNumberArray} from \"./numberArray.js\";\n\nexport default function(a, b) {\n  return (isNumberArray(b) ? numberArray : genericArray)(a, b);\n}\n\nexport function genericArray(a, b) {\n  var nb = b ? b.length : 0,\n      na = a ? Math.min(nb, a.length) : 0,\n      x = new Array(na),\n      c = new Array(nb),\n      i;\n\n  for (i = 0; i < na; ++i) x[i] = value(a[i], b[i]);\n  for (; i < nb; ++i) c[i] = b[i];\n\n  return function(t) {\n    for (i = 0; i < na; ++i) c[i] = x[i](t);\n    return c;\n  };\n}\n", "export default function(a, b) {\n  var d = new Date;\n  return a = +a, b = +b, function(t) {\n    return d.setTime(a * (1 - t) + b * t), d;\n  };\n}\n", "export default function(a, b) {\n  return a = +a, b = +b, function(t) {\n    return a * (1 - t) + b * t;\n  };\n}\n", "import value from \"./value.js\";\n\nexport default function(a, b) {\n  var i = {},\n      c = {},\n      k;\n\n  if (a === null || typeof a !== \"object\") a = {};\n  if (b === null || typeof b !== \"object\") b = {};\n\n  for (k in b) {\n    if (k in a) {\n      i[k] = value(a[k], b[k]);\n    } else {\n      c[k] = b[k];\n    }\n  }\n\n  return function(t) {\n    for (k in i) c[k] = i[k](t);\n    return c;\n  };\n}\n", "import number from \"./number.js\";\n\nvar reA = /[-+]?(?:\\d+\\.?\\d*|\\.?\\d+)(?:[eE][-+]?\\d+)?/g,\n    reB = new RegExp(reA.source, \"g\");\n\nfunction zero(b) {\n  return function() {\n    return b;\n  };\n}\n\nfunction one(b) {\n  return function(t) {\n    return b(t) + \"\";\n  };\n}\n\nexport default function(a, b) {\n  var bi = reA.lastIndex = reB.lastIndex = 0, // scan index for next number in b\n      am, // current match in a\n      bm, // current match in b\n      bs, // string preceding current number in b, if any\n      i = -1, // index in s\n      s = [], // string constants and placeholders\n      q = []; // number interpolators\n\n  // Coerce inputs to strings.\n  a = a + \"\", b = b + \"\";\n\n  // Interpolate pairs of numbers in a & b.\n  while ((am = reA.exec(a))\n      && (bm = reB.exec(b))) {\n    if ((bs = bm.index) > bi) { // a string precedes the next number in b\n      bs = b.slice(bi, bs);\n      if (s[i]) s[i] += bs; // coalesce with previous string\n      else s[++i] = bs;\n    }\n    if ((am = am[0]) === (bm = bm[0])) { // numbers in a & b match\n      if (s[i]) s[i] += bm; // coalesce with previous string\n      else s[++i] = bm;\n    } else { // interpolate non-matching numbers\n      s[++i] = null;\n      q.push({i: i, x: number(am, bm)});\n    }\n    bi = reB.lastIndex;\n  }\n\n  // Add remains of b.\n  if (bi < b.length) {\n    bs = b.slice(bi);\n    if (s[i]) s[i] += bs; // coalesce with previous string\n    else s[++i] = bs;\n  }\n\n  // Special optimization for only a single match.\n  // Otherwise, interpolate each of the numbers and rejoin the string.\n  return s.length < 2 ? (q[0]\n      ? one(q[0].x)\n      : zero(b))\n      : (b = q.length, function(t) {\n          for (var i = 0, o; i < b; ++i) s[(o = q[i]).i] = o.x(t);\n          return s.join(\"\");\n        });\n}\n", "import {color} from \"d3-color\";\nimport rgb from \"./rgb.js\";\nimport {genericArray} from \"./array.js\";\nimport date from \"./date.js\";\nimport number from \"./number.js\";\nimport object from \"./object.js\";\nimport string from \"./string.js\";\nimport constant from \"./constant.js\";\nimport numberArray, {isNumberArray} from \"./numberArray.js\";\n\nexport default function(a, b) {\n  var t = typeof b, c;\n  return b == null || t === \"boolean\" ? constant(b)\n      : (t === \"number\" ? number\n      : t === \"string\" ? ((c = color(b)) ? (b = c, rgb) : string)\n      : b instanceof color ? rgb\n      : b instanceof Date ? date\n      : isNumberArray(b) ? numberArray\n      : Array.isArray(b) ? genericArray\n      : typeof b.valueOf !== \"function\" && typeof b.toString !== \"function\" || isNaN(b) ? object\n      : number)(a, b);\n}\n", "export default function(a, b) {\n  return a = +a, b = +b, function(t) {\n    return Math.round(a * (1 - t) + b * t);\n  };\n}\n", "export default function constants(x) {\n  return function() {\n    return x;\n  };\n}\n", "export default function number(x) {\n  return +x;\n}\n", "import {bisect} from \"d3-array\";\nimport {interpolate as interpolateValue, interpolateNumber, interpolateRound} from \"d3-interpolate\";\nimport constant from \"./constant.js\";\nimport number from \"./number.js\";\n\nvar unit = [0, 1];\n\nexport function identity(x) {\n  return x;\n}\n\nfunction normalize(a, b) {\n  return (b -= (a = +a))\n      ? function(x) { return (x - a) / b; }\n      : constant(isNaN(b) ? NaN : 0.5);\n}\n\nfunction clamper(a, b) {\n  var t;\n  if (a > b) t = a, a = b, b = t;\n  return function(x) { return Math.max(a, Math.min(b, x)); };\n}\n\n// normalize(a, b)(x) takes a domain value x in [a,b] and returns the corresponding parameter t in [0,1].\n// interpolate(a, b)(t) takes a parameter t in [0,1] and returns the corresponding range value x in [a,b].\nfunction bimap(domain, range, interpolate) {\n  var d0 = domain[0], d1 = domain[1], r0 = range[0], r1 = range[1];\n  if (d1 < d0) d0 = normalize(d1, d0), r0 = interpolate(r1, r0);\n  else d0 = normalize(d0, d1), r0 = interpolate(r0, r1);\n  return function(x) { return r0(d0(x)); };\n}\n\nfunction polymap(domain, range, interpolate) {\n  var j = Math.min(domain.length, range.length) - 1,\n      d = new Array(j),\n      r = new Array(j),\n      i = -1;\n\n  // Reverse descending domains.\n  if (domain[j] < domain[0]) {\n    domain = domain.slice().reverse();\n    range = range.slice().reverse();\n  }\n\n  while (++i < j) {\n    d[i] = normalize(domain[i], domain[i + 1]);\n    r[i] = interpolate(range[i], range[i + 1]);\n  }\n\n  return function(x) {\n    var i = bisect(domain, x, 1, j) - 1;\n    return r[i](d[i](x));\n  };\n}\n\nexport function copy(source, target) {\n  return target\n      .domain(source.domain())\n      .range(source.range())\n      .interpolate(source.interpolate())\n      .clamp(source.clamp())\n      .unknown(source.unknown());\n}\n\nexport function transformer() {\n  var domain = unit,\n      range = unit,\n      interpolate = interpolateValue,\n      transform,\n      untransform,\n      unknown,\n      clamp = identity,\n      piecewise,\n      output,\n      input;\n\n  function rescale() {\n    var n = Math.min(domain.length, range.length);\n    if (clamp !== identity) clamp = clamper(domain[0], domain[n - 1]);\n    piecewise = n > 2 ? polymap : bimap;\n    output = input = null;\n    return scale;\n  }\n\n  function scale(x) {\n    return x == null || isNaN(x = +x) ? unknown : (output || (output = piecewise(domain.map(transform), range, interpolate)))(transform(clamp(x)));\n  }\n\n  scale.invert = function(y) {\n    return clamp(untransform((input || (input = piecewise(range, domain.map(transform), interpolateNumber)))(y)));\n  };\n\n  scale.domain = function(_) {\n    return arguments.length ? (domain = Array.from(_, number), rescale()) : domain.slice();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = Array.from(_), rescale()) : range.slice();\n  };\n\n  scale.rangeRound = function(_) {\n    return range = Array.from(_), interpolate = interpolateRound, rescale();\n  };\n\n  scale.clamp = function(_) {\n    return arguments.length ? (clamp = _ ? true : identity, rescale()) : clamp !== identity;\n  };\n\n  scale.interpolate = function(_) {\n    return arguments.length ? (interpolate = _, rescale()) : interpolate;\n  };\n\n  scale.unknown = function(_) {\n    return arguments.length ? (unknown = _, scale) : unknown;\n  };\n\n  return function(t, u) {\n    transform = t, untransform = u;\n    return rescale();\n  };\n}\n\nexport default function continuous() {\n  return transformer()(identity, identity);\n}\n", "export default function(x) {\n  return Math.abs(x = Math.round(x)) >= 1e21\n      ? x.toLocaleString(\"en\").replace(/,/g, \"\")\n      : x.toString(10);\n}\n\n// Computes the decimal coefficient and exponent of the specified number x with\n// significant digits p, where x is positive and p is in [1, 21] or undefined.\n// For example, formatDecimalParts(1.23) returns [\"123\", 0].\nexport function formatDecimalParts(x, p) {\n  if ((i = (x = p ? x.toExponential(p - 1) : x.toExponential()).indexOf(\"e\")) < 0) return null; // NaN, \u00B1Infinity\n  var i, coefficient = x.slice(0, i);\n\n  // The string returned by toExponential either has the form \\d\\.\\d+e[-+]\\d+\n  // (e.g., 1.2e+3) or the form \\de[-+]\\d+ (e.g., 1e+3).\n  return [\n    coefficient.length > 1 ? coefficient[0] + coefficient.slice(2) : coefficient,\n    +x.slice(i + 1)\n  ];\n}\n", "import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport default function(x) {\n  return x = formatDecimalParts(Math.abs(x)), x ? x[1] : NaN;\n}\n", "export default function(grouping, thousands) {\n  return function(value, width) {\n    var i = value.length,\n        t = [],\n        j = 0,\n        g = grouping[0],\n        length = 0;\n\n    while (i > 0 && g > 0) {\n      if (length + g + 1 > width) g = Math.max(1, width - length);\n      t.push(value.substring(i -= g, i + g));\n      if ((length += g + 1) > width) break;\n      g = grouping[j = (j + 1) % grouping.length];\n    }\n\n    return t.reverse().join(thousands);\n  };\n}\n", "export default function(numerals) {\n  return function(value) {\n    return value.replace(/[0-9]/g, function(i) {\n      return numerals[+i];\n    });\n  };\n}\n", "// [[fill]align][sign][symbol][0][width][,][.precision][~][type]\nvar re = /^(?:(.)?([<>=^]))?([+\\-( ])?([$#])?(0)?(\\d+)?(,)?(\\.\\d+)?(~)?([a-z%])?$/i;\n\nexport default function formatSpecifier(specifier) {\n  if (!(match = re.exec(specifier))) throw new Error(\"invalid format: \" + specifier);\n  var match;\n  return new FormatSpecifier({\n    fill: match[1],\n    align: match[2],\n    sign: match[3],\n    symbol: match[4],\n    zero: match[5],\n    width: match[6],\n    comma: match[7],\n    precision: match[8] && match[8].slice(1),\n    trim: match[9],\n    type: match[10]\n  });\n}\n\nformatSpecifier.prototype = FormatSpecifier.prototype; // instanceof\n\nexport function FormatSpecifier(specifier) {\n  this.fill = specifier.fill === undefined ? \" \" : specifier.fill + \"\";\n  this.align = specifier.align === undefined ? \">\" : specifier.align + \"\";\n  this.sign = specifier.sign === undefined ? \"-\" : specifier.sign + \"\";\n  this.symbol = specifier.symbol === undefined ? \"\" : specifier.symbol + \"\";\n  this.zero = !!specifier.zero;\n  this.width = specifier.width === undefined ? undefined : +specifier.width;\n  this.comma = !!specifier.comma;\n  this.precision = specifier.precision === undefined ? undefined : +specifier.precision;\n  this.trim = !!specifier.trim;\n  this.type = specifier.type === undefined ? \"\" : specifier.type + \"\";\n}\n\nFormatSpecifier.prototype.toString = function() {\n  return this.fill\n      + this.align\n      + this.sign\n      + this.symbol\n      + (this.zero ? \"0\" : \"\")\n      + (this.width === undefined ? \"\" : Math.max(1, this.width | 0))\n      + (this.comma ? \",\" : \"\")\n      + (this.precision === undefined ? \"\" : \".\" + Math.max(0, this.precision | 0))\n      + (this.trim ? \"~\" : \"\")\n      + this.type;\n};\n", "// Trims insignificant zeros, e.g., replaces 1.2000k with 1.2k.\nexport default function(s) {\n  out: for (var n = s.length, i = 1, i0 = -1, i1; i < n; ++i) {\n    switch (s[i]) {\n      case \".\": i0 = i1 = i; break;\n      case \"0\": if (i0 === 0) i0 = i; i1 = i; break;\n      default: if (!+s[i]) break out; if (i0 > 0) i0 = 0; break;\n    }\n  }\n  return i0 > 0 ? s.slice(0, i0) + s.slice(i1 + 1) : s;\n}\n", "import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport var prefixExponent;\n\nexport default function(x, p) {\n  var d = formatDecimalParts(x, p);\n  if (!d) return x + \"\";\n  var coefficient = d[0],\n      exponent = d[1],\n      i = exponent - (prefixExponent = Math.max(-8, Math.min(8, Math.floor(exponent / 3))) * 3) + 1,\n      n = coefficient.length;\n  return i === n ? coefficient\n      : i > n ? coefficient + new Array(i - n + 1).join(\"0\")\n      : i > 0 ? coefficient.slice(0, i) + \".\" + coefficient.slice(i)\n      : \"0.\" + new Array(1 - i).join(\"0\") + formatDecimalParts(x, Math.max(0, p + i - 1))[0]; // less than 1y!\n}\n", "import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport default function(x, p) {\n  var d = formatDecimalParts(x, p);\n  if (!d) return x + \"\";\n  var coefficient = d[0],\n      exponent = d[1];\n  return exponent < 0 ? \"0.\" + new Array(-exponent).join(\"0\") + coefficient\n      : coefficient.length > exponent + 1 ? coefficient.slice(0, exponent + 1) + \".\" + coefficient.slice(exponent + 1)\n      : coefficient + new Array(exponent - coefficient.length + 2).join(\"0\");\n}\n", "import formatDecimal from \"./formatDecimal.js\";\nimport formatPrefixAuto from \"./formatPrefixAuto.js\";\nimport formatRounded from \"./formatRounded.js\";\n\nexport default {\n  \"%\": (x, p) => (x * 100).toFixed(p),\n  \"b\": (x) => Math.round(x).toString(2),\n  \"c\": (x) => x + \"\",\n  \"d\": formatDecimal,\n  \"e\": (x, p) => x.toExponential(p),\n  \"f\": (x, p) => x.toFixed(p),\n  \"g\": (x, p) => x.toPrecision(p),\n  \"o\": (x) => Math.round(x).toString(8),\n  \"p\": (x, p) => formatRounded(x * 100, p),\n  \"r\": formatRounded,\n  \"s\": formatPrefixAuto,\n  \"X\": (x) => Math.round(x).toString(16).toUpperCase(),\n  \"x\": (x) => Math.round(x).toString(16)\n};\n", "export default function(x) {\n  return x;\n}\n", "import exponent from \"./exponent.js\";\nimport formatGroup from \"./formatGroup.js\";\nimport formatNumerals from \"./formatNumerals.js\";\nimport formatSpecifier from \"./formatSpecifier.js\";\nimport formatTrim from \"./formatTrim.js\";\nimport formatTypes from \"./formatTypes.js\";\nimport {prefixExponent} from \"./formatPrefixAuto.js\";\nimport identity from \"./identity.js\";\n\nvar map = Array.prototype.map,\n    prefixes = [\"y\",\"z\",\"a\",\"f\",\"p\",\"n\",\"\u00B5\",\"m\",\"\",\"k\",\"M\",\"G\",\"T\",\"P\",\"E\",\"Z\",\"Y\"];\n\nexport default function(locale) {\n  var group = locale.grouping === undefined || locale.thousands === undefined ? identity : formatGroup(map.call(locale.grouping, Number), locale.thousands + \"\"),\n      currencyPrefix = locale.currency === undefined ? \"\" : locale.currency[0] + \"\",\n      currencySuffix = locale.currency === undefined ? \"\" : locale.currency[1] + \"\",\n      decimal = locale.decimal === undefined ? \".\" : locale.decimal + \"\",\n      numerals = locale.numerals === undefined ? identity : formatNumerals(map.call(locale.numerals, String)),\n      percent = locale.percent === undefined ? \"%\" : locale.percent + \"\",\n      minus = locale.minus === undefined ? \"\u2212\" : locale.minus + \"\",\n      nan = locale.nan === undefined ? \"NaN\" : locale.nan + \"\";\n\n  function newFormat(specifier) {\n    specifier = formatSpecifier(specifier);\n\n    var fill = specifier.fill,\n        align = specifier.align,\n        sign = specifier.sign,\n        symbol = specifier.symbol,\n        zero = specifier.zero,\n        width = specifier.width,\n        comma = specifier.comma,\n        precision = specifier.precision,\n        trim = specifier.trim,\n        type = specifier.type;\n\n    // The \"n\" type is an alias for \",g\".\n    if (type === \"n\") comma = true, type = \"g\";\n\n    // The \"\" type, and any invalid type, is an alias for \".12~g\".\n    else if (!formatTypes[type]) precision === undefined && (precision = 12), trim = true, type = \"g\";\n\n    // If zero fill is specified, padding goes after sign and before digits.\n    if (zero || (fill === \"0\" && align === \"=\")) zero = true, fill = \"0\", align = \"=\";\n\n    // Compute the prefix and suffix.\n    // For SI-prefix, the suffix is lazily computed.\n    var prefix = symbol === \"$\" ? currencyPrefix : symbol === \"#\" && /[boxX]/.test(type) ? \"0\" + type.toLowerCase() : \"\",\n        suffix = symbol === \"$\" ? currencySuffix : /[%p]/.test(type) ? percent : \"\";\n\n    // What format function should we use?\n    // Is this an integer type?\n    // Can this type generate exponential notation?\n    var formatType = formatTypes[type],\n        maybeSuffix = /[defgprs%]/.test(type);\n\n    // Set the default precision if not specified,\n    // or clamp the specified precision to the supported range.\n    // For significant precision, it must be in [1, 21].\n    // For fixed precision, it must be in [0, 20].\n    precision = precision === undefined ? 6\n        : /[gprs]/.test(type) ? Math.max(1, Math.min(21, precision))\n        : Math.max(0, Math.min(20, precision));\n\n    function format(value) {\n      var valuePrefix = prefix,\n          valueSuffix = suffix,\n          i, n, c;\n\n      if (type === \"c\") {\n        valueSuffix = formatType(value) + valueSuffix;\n        value = \"\";\n      } else {\n        value = +value;\n\n        // Determine the sign. -0 is not less than 0, but 1 / -0 is!\n        var valueNegative = value < 0 || 1 / value < 0;\n\n        // Perform the initial formatting.\n        value = isNaN(value) ? nan : formatType(Math.abs(value), precision);\n\n        // Trim insignificant zeros.\n        if (trim) value = formatTrim(value);\n\n        // If a negative value rounds to zero after formatting, and no explicit positive sign is requested, hide the sign.\n        if (valueNegative && +value === 0 && sign !== \"+\") valueNegative = false;\n\n        // Compute the prefix and suffix.\n        valuePrefix = (valueNegative ? (sign === \"(\" ? sign : minus) : sign === \"-\" || sign === \"(\" ? \"\" : sign) + valuePrefix;\n        valueSuffix = (type === \"s\" ? prefixes[8 + prefixExponent / 3] : \"\") + valueSuffix + (valueNegative && sign === \"(\" ? \")\" : \"\");\n\n        // Break the formatted value into the integer \u201Cvalue\u201D part that can be\n        // grouped, and fractional or exponential \u201Csuffix\u201D part that is not.\n        if (maybeSuffix) {\n          i = -1, n = value.length;\n          while (++i < n) {\n            if (c = value.charCodeAt(i), 48 > c || c > 57) {\n              valueSuffix = (c === 46 ? decimal + value.slice(i + 1) : value.slice(i)) + valueSuffix;\n              value = value.slice(0, i);\n              break;\n            }\n          }\n        }\n      }\n\n      // If the fill character is not \"0\", grouping is applied before padding.\n      if (comma && !zero) value = group(value, Infinity);\n\n      // Compute the padding.\n      var length = valuePrefix.length + value.length + valueSuffix.length,\n          padding = length < width ? new Array(width - length + 1).join(fill) : \"\";\n\n      // If the fill character is \"0\", grouping is applied after padding.\n      if (comma && zero) value = group(padding + value, padding.length ? width - valueSuffix.length : Infinity), padding = \"\";\n\n      // Reconstruct the final output based on the desired alignment.\n      switch (align) {\n        case \"<\": value = valuePrefix + value + valueSuffix + padding; break;\n        case \"=\": value = valuePrefix + padding + value + valueSuffix; break;\n        case \"^\": value = padding.slice(0, length = padding.length >> 1) + valuePrefix + value + valueSuffix + padding.slice(length); break;\n        default: value = padding + valuePrefix + value + valueSuffix; break;\n      }\n\n      return numerals(value);\n    }\n\n    format.toString = function() {\n      return specifier + \"\";\n    };\n\n    return format;\n  }\n\n  function formatPrefix(specifier, value) {\n    var f = newFormat((specifier = formatSpecifier(specifier), specifier.type = \"f\", specifier)),\n        e = Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3,\n        k = Math.pow(10, -e),\n        prefix = prefixes[8 + e / 3];\n    return function(value) {\n      return f(k * value) + prefix;\n    };\n  }\n\n  return {\n    format: newFormat,\n    formatPrefix: formatPrefix\n  };\n}\n", "import formatLocale from \"./locale.js\";\n\nvar locale;\nexport var format;\nexport var formatPrefix;\n\ndefaultLocale({\n  thousands: \",\",\n  grouping: [3],\n  currency: [\"$\", \"\"]\n});\n\nexport default function defaultLocale(definition) {\n  locale = formatLocale(definition);\n  format = locale.format;\n  formatPrefix = locale.formatPrefix;\n  return locale;\n}\n", "import exponent from \"./exponent.js\";\n\nexport default function(step) {\n  return Math.max(0, -exponent(Math.abs(step)));\n}\n", "import exponent from \"./exponent.js\";\n\nexport default function(step, value) {\n  return Math.max(0, Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3 - exponent(Math.abs(step)));\n}\n", "import exponent from \"./exponent.js\";\n\nexport default function(step, max) {\n  step = Math.abs(step), max = Math.abs(max) - step;\n  return Math.max(0, exponent(max) - exponent(step)) + 1;\n}\n", "import {tickStep} from \"d3-array\";\nimport {format, formatPrefix, formatSpecifier, precisionFixed, precisionPrefix, precisionRound} from \"d3-format\";\n\nexport default function tickFormat(start, stop, count, specifier) {\n  var step = tickStep(start, stop, count),\n      precision;\n  specifier = formatSpecifier(specifier == null ? \",f\" : specifier);\n  switch (specifier.type) {\n    case \"s\": {\n      var value = Math.max(Math.abs(start), Math.abs(stop));\n      if (specifier.precision == null && !isNaN(precision = precisionPrefix(step, value))) specifier.precision = precision;\n      return formatPrefix(specifier, value);\n    }\n    case \"\":\n    case \"e\":\n    case \"g\":\n    case \"p\":\n    case \"r\": {\n      if (specifier.precision == null && !isNaN(precision = precisionRound(step, Math.max(Math.abs(start), Math.abs(stop))))) specifier.precision = precision - (specifier.type === \"e\");\n      break;\n    }\n    case \"f\":\n    case \"%\": {\n      if (specifier.precision == null && !isNaN(precision = precisionFixed(step))) specifier.precision = precision - (specifier.type === \"%\") * 2;\n      break;\n    }\n  }\n  return format(specifier);\n}\n", "import {ticks, tickIncrement} from \"d3-array\";\nimport continuous, {copy} from \"./continuous.js\";\nimport {initRange} from \"./init.js\";\nimport tickFormat from \"./tickFormat.js\";\n\nexport function linearish(scale) {\n  var domain = scale.domain;\n\n  scale.ticks = function(count) {\n    var d = domain();\n    return ticks(d[0], d[d.length - 1], count == null ? 10 : count);\n  };\n\n  scale.tickFormat = function(count, specifier) {\n    var d = domain();\n    return tickFormat(d[0], d[d.length - 1], count == null ? 10 : count, specifier);\n  };\n\n  scale.nice = function(count) {\n    if (count == null) count = 10;\n\n    var d = domain();\n    var i0 = 0;\n    var i1 = d.length - 1;\n    var start = d[i0];\n    var stop = d[i1];\n    var prestep;\n    var step;\n    var maxIter = 10;\n\n    if (stop < start) {\n      step = start, start = stop, stop = step;\n      step = i0, i0 = i1, i1 = step;\n    }\n    \n    while (maxIter-- > 0) {\n      step = tickIncrement(start, stop, count);\n      if (step === prestep) {\n        d[i0] = start\n        d[i1] = stop\n        return domain(d);\n      } else if (step > 0) {\n        start = Math.floor(start / step) * step;\n        stop = Math.ceil(stop / step) * step;\n      } else if (step < 0) {\n        start = Math.ceil(start * step) / step;\n        stop = Math.floor(stop * step) / step;\n      } else {\n        break;\n      }\n      prestep = step;\n    }\n\n    return scale;\n  };\n\n  return scale;\n}\n\nexport default function linear() {\n  var scale = continuous();\n\n  scale.copy = function() {\n    return copy(scale, linear());\n  };\n\n  initRange.apply(scale, arguments);\n\n  return linearish(scale);\n}\n", "export default function nice(domain, interval) {\n  domain = domain.slice();\n\n  var i0 = 0,\n      i1 = domain.length - 1,\n      x0 = domain[i0],\n      x1 = domain[i1],\n      t;\n\n  if (x1 < x0) {\n    t = i0, i0 = i1, i1 = t;\n    t = x0, x0 = x1, x1 = t;\n  }\n\n  domain[i0] = interval.floor(x0);\n  domain[i1] = interval.ceil(x1);\n  return domain;\n}\n", "const t0 = new Date, t1 = new Date;\n\nexport function timeInterval(floori, offseti, count, field) {\n\n  function interval(date) {\n    return floori(date = arguments.length === 0 ? new Date : new Date(+date)), date;\n  }\n\n  interval.floor = (date) => {\n    return floori(date = new Date(+date)), date;\n  };\n\n  interval.ceil = (date) => {\n    return floori(date = new Date(date - 1)), offseti(date, 1), floori(date), date;\n  };\n\n  interval.round = (date) => {\n    const d0 = interval(date), d1 = interval.ceil(date);\n    return date - d0 < d1 - date ? d0 : d1;\n  };\n\n  interval.offset = (date, step) => {\n    return offseti(date = new Date(+date), step == null ? 1 : Math.floor(step)), date;\n  };\n\n  interval.range = (start, stop, step) => {\n    const range = [];\n    start = interval.ceil(start);\n    step = step == null ? 1 : Math.floor(step);\n    if (!(start < stop) || !(step > 0)) return range; // also handles Invalid Date\n    let previous;\n    do range.push(previous = new Date(+start)), offseti(start, step), floori(start);\n    while (previous < start && start < stop);\n    return range;\n  };\n\n  interval.filter = (test) => {\n    return timeInterval((date) => {\n      if (date >= date) while (floori(date), !test(date)) date.setTime(date - 1);\n    }, (date, step) => {\n      if (date >= date) {\n        if (step < 0) while (++step <= 0) {\n          while (offseti(date, -1), !test(date)) {} // eslint-disable-line no-empty\n        } else while (--step >= 0) {\n          while (offseti(date, +1), !test(date)) {} // eslint-disable-line no-empty\n        }\n      }\n    });\n  };\n\n  if (count) {\n    interval.count = (start, end) => {\n      t0.setTime(+start), t1.setTime(+end);\n      floori(t0), floori(t1);\n      return Math.floor(count(t0, t1));\n    };\n\n    interval.every = (step) => {\n      step = Math.floor(step);\n      return !isFinite(step) || !(step > 0) ? null\n          : !(step > 1) ? interval\n          : interval.filter(field\n              ? (d) => field(d) % step === 0\n              : (d) => interval.count(0, d) % step === 0);\n    };\n  }\n\n  return interval;\n}\n", "import {timeInterval} from \"./interval.js\";\n\nexport const millisecond = timeInterval(() => {\n  // noop\n}, (date, step) => {\n  date.setTime(+date + step);\n}, (start, end) => {\n  return end - start;\n});\n\n// An optimized implementation for this simple case.\nmillisecond.every = (k) => {\n  k = Math.floor(k);\n  if (!isFinite(k) || !(k > 0)) return null;\n  if (!(k > 1)) return millisecond;\n  return timeInterval((date) => {\n    date.setTime(Math.floor(date / k) * k);\n  }, (date, step) => {\n    date.setTime(+date + step * k);\n  }, (start, end) => {\n    return (end - start) / k;\n  });\n};\n\nexport const milliseconds = millisecond.range;\n", "export const durationSecond = 1000;\nexport const durationMinute = durationSecond * 60;\nexport const durationHour = durationMinute * 60;\nexport const durationDay = durationHour * 24;\nexport const durationWeek = durationDay * 7;\nexport const durationMonth = durationDay * 30;\nexport const durationYear = durationDay * 365;\n", "import {timeInterval} from \"./interval.js\";\nimport {durationSecond} from \"./duration.js\";\n\nexport const second = timeInterval((date) => {\n  date.setTime(date - date.getMilliseconds());\n}, (date, step) => {\n  date.setTime(+date + step * durationSecond);\n}, (start, end) => {\n  return (end - start) / durationSecond;\n}, (date) => {\n  return date.getUTCSeconds();\n});\n\nexport const seconds = second.range;\n", "import {timeInterval} from \"./interval.js\";\nimport {durationMinute, durationSecond} from \"./duration.js\";\n\nexport const timeMinute = timeInterval((date) => {\n  date.setTime(date - date.getMilliseconds() - date.getSeconds() * durationSecond);\n}, (date, step) => {\n  date.setTime(+date + step * durationMinute);\n}, (start, end) => {\n  return (end - start) / durationMinute;\n}, (date) => {\n  return date.getMinutes();\n});\n\nexport const timeMinutes = timeMinute.range;\n\nexport const utcMinute = timeInterval((date) => {\n  date.setUTCSeconds(0, 0);\n}, (date, step) => {\n  date.setTime(+date + step * durationMinute);\n}, (start, end) => {\n  return (end - start) / durationMinute;\n}, (date) => {\n  return date.getUTCMinutes();\n});\n\nexport const utcMinutes = utcMinute.range;\n", "import {timeInterval} from \"./interval.js\";\nimport {durationHour, durationMinute, durationSecond} from \"./duration.js\";\n\nexport const timeHour = timeInterval((date) => {\n  date.setTime(date - date.getMilliseconds() - date.getSeconds() * durationSecond - date.getMinutes() * durationMinute);\n}, (date, step) => {\n  date.setTime(+date + step * durationHour);\n}, (start, end) => {\n  return (end - start) / durationHour;\n}, (date) => {\n  return date.getHours();\n});\n\nexport const timeHours = timeHour.range;\n\nexport const utcHour = timeInterval((date) => {\n  date.setUTCMinutes(0, 0, 0);\n}, (date, step) => {\n  date.setTime(+date + step * durationHour);\n}, (start, end) => {\n  return (end - start) / durationHour;\n}, (date) => {\n  return date.getUTCHours();\n});\n\nexport const utcHours = utcHour.range;\n", "import {timeInterval} from \"./interval.js\";\nimport {durationDay, durationMinute} from \"./duration.js\";\n\nexport const timeDay = timeInterval(\n  date => date.setHours(0, 0, 0, 0),\n  (date, step) => date.setDate(date.getDate() + step),\n  (start, end) => (end - start - (end.getTimezoneOffset() - start.getTimezoneOffset()) * durationMinute) / durationDay,\n  date => date.getDate() - 1\n);\n\nexport const timeDays = timeDay.range;\n\nexport const utcDay = timeInterval((date) => {\n  date.setUTCHours(0, 0, 0, 0);\n}, (date, step) => {\n  date.setUTCDate(date.getUTCDate() + step);\n}, (start, end) => {\n  return (end - start) / durationDay;\n}, (date) => {\n  return date.getUTCDate() - 1;\n});\n\nexport const utcDays = utcDay.range;\n\nexport const unixDay = timeInterval((date) => {\n  date.setUTCHours(0, 0, 0, 0);\n}, (date, step) => {\n  date.setUTCDate(date.getUTCDate() + step);\n}, (start, end) => {\n  return (end - start) / durationDay;\n}, (date) => {\n  return Math.floor(date / durationDay);\n});\n\nexport const unixDays = unixDay.range;\n", "import {timeInterval} from \"./interval.js\";\nimport {durationMinute, durationWeek} from \"./duration.js\";\n\nfunction timeWeekday(i) {\n  return timeInterval((date) => {\n    date.setDate(date.getDate() - (date.getDay() + 7 - i) % 7);\n    date.setHours(0, 0, 0, 0);\n  }, (date, step) => {\n    date.setDate(date.getDate() + step * 7);\n  }, (start, end) => {\n    return (end - start - (end.getTimezoneOffset() - start.getTimezoneOffset()) * durationMinute) / durationWeek;\n  });\n}\n\nexport const timeSunday = timeWeekday(0);\nexport const timeMonday = timeWeekday(1);\nexport const timeTuesday = timeWeekday(2);\nexport const timeWednesday = timeWeekday(3);\nexport const timeThursday = timeWeekday(4);\nexport const timeFriday = timeWeekday(5);\nexport const timeSaturday = timeWeekday(6);\n\nexport const timeSundays = timeSunday.range;\nexport const timeMondays = timeMonday.range;\nexport const timeTuesdays = timeTuesday.range;\nexport const timeWednesdays = timeWednesday.range;\nexport const timeThursdays = timeThursday.range;\nexport const timeFridays = timeFriday.range;\nexport const timeSaturdays = timeSaturday.range;\n\nfunction utcWeekday(i) {\n  return timeInterval((date) => {\n    date.setUTCDate(date.getUTCDate() - (date.getUTCDay() + 7 - i) % 7);\n    date.setUTCHours(0, 0, 0, 0);\n  }, (date, step) => {\n    date.setUTCDate(date.getUTCDate() + step * 7);\n  }, (start, end) => {\n    return (end - start) / durationWeek;\n  });\n}\n\nexport const utcSunday = utcWeekday(0);\nexport const utcMonday = utcWeekday(1);\nexport const utcTuesday = utcWeekday(2);\nexport const utcWednesday = utcWeekday(3);\nexport const utcThursday = utcWeekday(4);\nexport const utcFriday = utcWeekday(5);\nexport const utcSaturday = utcWeekday(6);\n\nexport const utcSundays = utcSunday.range;\nexport const utcMondays = utcMonday.range;\nexport const utcTuesdays = utcTuesday.range;\nexport const utcWednesdays = utcWednesday.range;\nexport const utcThursdays = utcThursday.range;\nexport const utcFridays = utcFriday.range;\nexport const utcSaturdays = utcSaturday.range;\n", "import {timeInterval} from \"./interval.js\";\n\nexport const timeMonth = timeInterval((date) => {\n  date.setDate(1);\n  date.setHours(0, 0, 0, 0);\n}, (date, step) => {\n  date.setMonth(date.getMonth() + step);\n}, (start, end) => {\n  return end.getMonth() - start.getMonth() + (end.getFullYear() - start.getFullYear()) * 12;\n}, (date) => {\n  return date.getMonth();\n});\n\nexport const timeMonths = timeMonth.range;\n\nexport const utcMonth = timeInterval((date) => {\n  date.setUTCDate(1);\n  date.setUTCHours(0, 0, 0, 0);\n}, (date, step) => {\n  date.setUTCMonth(date.getUTCMonth() + step);\n}, (start, end) => {\n  return end.getUTCMonth() - start.getUTCMonth() + (end.getUTCFullYear() - start.getUTCFullYear()) * 12;\n}, (date) => {\n  return date.getUTCMonth();\n});\n\nexport const utcMonths = utcMonth.range;\n", "import {timeInterval} from \"./interval.js\";\n\nexport const timeYear = timeInterval((date) => {\n  date.setMonth(0, 1);\n  date.setHours(0, 0, 0, 0);\n}, (date, step) => {\n  date.setFullYear(date.getFullYear() + step);\n}, (start, end) => {\n  return end.getFullYear() - start.getFullYear();\n}, (date) => {\n  return date.getFullYear();\n});\n\n// An optimized implementation for this simple case.\ntimeYear.every = (k) => {\n  return !isFinite(k = Math.floor(k)) || !(k > 0) ? null : timeInterval((date) => {\n    date.setFullYear(Math.floor(date.getFullYear() / k) * k);\n    date.setMonth(0, 1);\n    date.setHours(0, 0, 0, 0);\n  }, (date, step) => {\n    date.setFullYear(date.getFullYear() + step * k);\n  });\n};\n\nexport const timeYears = timeYear.range;\n\nexport const utcYear = timeInterval((date) => {\n  date.setUTCMonth(0, 1);\n  date.setUTCHours(0, 0, 0, 0);\n}, (date, step) => {\n  date.setUTCFullYear(date.getUTCFullYear() + step);\n}, (start, end) => {\n  return end.getUTCFullYear() - start.getUTCFullYear();\n}, (date) => {\n  return date.getUTCFullYear();\n});\n\n// An optimized implementation for this simple case.\nutcYear.every = (k) => {\n  return !isFinite(k = Math.floor(k)) || !(k > 0) ? null : timeInterval((date) => {\n    date.setUTCFullYear(Math.floor(date.getUTCFullYear() / k) * k);\n    date.setUTCMonth(0, 1);\n    date.setUTCHours(0, 0, 0, 0);\n  }, (date, step) => {\n    date.setUTCFullYear(date.getUTCFullYear() + step * k);\n  });\n};\n\nexport const utcYears = utcYear.range;\n", "import {bisector, tickStep} from \"d3-array\";\nimport {durationDay, durationHour, durationMinute, durationMonth, durationSecond, durationWeek, durationYear} from \"./duration.js\";\nimport {millisecond} from \"./millisecond.js\";\nimport {second} from \"./second.js\";\nimport {timeMinute, utcMinute} from \"./minute.js\";\nimport {timeHour, utcHour} from \"./hour.js\";\nimport {timeDay, unixDay} from \"./day.js\";\nimport {timeSunday, utcSunday} from \"./week.js\";\nimport {timeMonth, utcMonth} from \"./month.js\";\nimport {timeYear, utcYear} from \"./year.js\";\n\nfunction ticker(year, month, week, day, hour, minute) {\n\n  const tickIntervals = [\n    [second,  1,      durationSecond],\n    [second,  5,  5 * durationSecond],\n    [second, 15, 15 * durationSecond],\n    [second, 30, 30 * durationSecond],\n    [minute,  1,      durationMinute],\n    [minute,  5,  5 * durationMinute],\n    [minute, 15, 15 * durationMinute],\n    [minute, 30, 30 * durationMinute],\n    [  hour,  1,      durationHour  ],\n    [  hour,  3,  3 * durationHour  ],\n    [  hour,  6,  6 * durationHour  ],\n    [  hour, 12, 12 * durationHour  ],\n    [   day,  1,      durationDay   ],\n    [   day,  2,  2 * durationDay   ],\n    [  week,  1,      durationWeek  ],\n    [ month,  1,      durationMonth ],\n    [ month,  3,  3 * durationMonth ],\n    [  year,  1,      durationYear  ]\n  ];\n\n  function ticks(start, stop, count) {\n    const reverse = stop < start;\n    if (reverse) [start, stop] = [stop, start];\n    const interval = count && typeof count.range === \"function\" ? count : tickInterval(start, stop, count);\n    const ticks = interval ? interval.range(start, +stop + 1) : []; // inclusive stop\n    return reverse ? ticks.reverse() : ticks;\n  }\n\n  function tickInterval(start, stop, count) {\n    const target = Math.abs(stop - start) / count;\n    const i = bisector(([,, step]) => step).right(tickIntervals, target);\n    if (i === tickIntervals.length) return year.every(tickStep(start / durationYear, stop / durationYear, count));\n    if (i === 0) return millisecond.every(Math.max(tickStep(start, stop, count), 1));\n    const [t, step] = tickIntervals[target / tickIntervals[i - 1][2] < tickIntervals[i][2] / target ? i - 1 : i];\n    return t.every(step);\n  }\n\n  return [ticks, tickInterval];\n}\n\nconst [utcTicks, utcTickInterval] = ticker(utcYear, utcMonth, utcSunday, unixDay, utcHour, utcMinute);\nconst [timeTicks, timeTickInterval] = ticker(timeYear, timeMonth, timeSunday, timeDay, timeHour, timeMinute);\n\nexport {utcTicks, utcTickInterval, timeTicks, timeTickInterval};\n", "import {\n  timeDay,\n  timeSunday,\n  timeMonday,\n  timeThursday,\n  timeYear,\n  utcDay,\n  utcSunday,\n  utcMonday,\n  utcThursday,\n  utcYear\n} from \"d3-time\";\n\nfunction localDate(d) {\n  if (0 <= d.y && d.y < 100) {\n    var date = new Date(-1, d.m, d.d, d.H, d.M, d.S, d.L);\n    date.setFullYear(d.y);\n    return date;\n  }\n  return new Date(d.y, d.m, d.d, d.H, d.M, d.S, d.L);\n}\n\nfunction utcDate(d) {\n  if (0 <= d.y && d.y < 100) {\n    var date = new Date(Date.UTC(-1, d.m, d.d, d.H, d.M, d.S, d.L));\n    date.setUTCFullYear(d.y);\n    return date;\n  }\n  return new Date(Date.UTC(d.y, d.m, d.d, d.H, d.M, d.S, d.L));\n}\n\nfunction newDate(y, m, d) {\n  return {y: y, m: m, d: d, H: 0, M: 0, S: 0, L: 0};\n}\n\nexport default function formatLocale(locale) {\n  var locale_dateTime = locale.dateTime,\n      locale_date = locale.date,\n      locale_time = locale.time,\n      locale_periods = locale.periods,\n      locale_weekdays = locale.days,\n      locale_shortWeekdays = locale.shortDays,\n      locale_months = locale.months,\n      locale_shortMonths = locale.shortMonths;\n\n  var periodRe = formatRe(locale_periods),\n      periodLookup = formatLookup(locale_periods),\n      weekdayRe = formatRe(locale_weekdays),\n      weekdayLookup = formatLookup(locale_weekdays),\n      shortWeekdayRe = formatRe(locale_shortWeekdays),\n      shortWeekdayLookup = formatLookup(locale_shortWeekdays),\n      monthRe = formatRe(locale_months),\n      monthLookup = formatLookup(locale_months),\n      shortMonthRe = formatRe(locale_shortMonths),\n      shortMonthLookup = formatLookup(locale_shortMonths);\n\n  var formats = {\n    \"a\": formatShortWeekday,\n    \"A\": formatWeekday,\n    \"b\": formatShortMonth,\n    \"B\": formatMonth,\n    \"c\": null,\n    \"d\": formatDayOfMonth,\n    \"e\": formatDayOfMonth,\n    \"f\": formatMicroseconds,\n    \"g\": formatYearISO,\n    \"G\": formatFullYearISO,\n    \"H\": formatHour24,\n    \"I\": formatHour12,\n    \"j\": formatDayOfYear,\n    \"L\": formatMilliseconds,\n    \"m\": formatMonthNumber,\n    \"M\": formatMinutes,\n    \"p\": formatPeriod,\n    \"q\": formatQuarter,\n    \"Q\": formatUnixTimestamp,\n    \"s\": formatUnixTimestampSeconds,\n    \"S\": formatSeconds,\n    \"u\": formatWeekdayNumberMonday,\n    \"U\": formatWeekNumberSunday,\n    \"V\": formatWeekNumberISO,\n    \"w\": formatWeekdayNumberSunday,\n    \"W\": formatWeekNumberMonday,\n    \"x\": null,\n    \"X\": null,\n    \"y\": formatYear,\n    \"Y\": formatFullYear,\n    \"Z\": formatZone,\n    \"%\": formatLiteralPercent\n  };\n\n  var utcFormats = {\n    \"a\": formatUTCShortWeekday,\n    \"A\": formatUTCWeekday,\n    \"b\": formatUTCShortMonth,\n    \"B\": formatUTCMonth,\n    \"c\": null,\n    \"d\": formatUTCDayOfMonth,\n    \"e\": formatUTCDayOfMonth,\n    \"f\": formatUTCMicroseconds,\n    \"g\": formatUTCYearISO,\n    \"G\": formatUTCFullYearISO,\n    \"H\": formatUTCHour24,\n    \"I\": formatUTCHour12,\n    \"j\": formatUTCDayOfYear,\n    \"L\": formatUTCMilliseconds,\n    \"m\": formatUTCMonthNumber,\n    \"M\": formatUTCMinutes,\n    \"p\": formatUTCPeriod,\n    \"q\": formatUTCQuarter,\n    \"Q\": formatUnixTimestamp,\n    \"s\": formatUnixTimestampSeconds,\n    \"S\": formatUTCSeconds,\n    \"u\": formatUTCWeekdayNumberMonday,\n    \"U\": formatUTCWeekNumberSunday,\n    \"V\": formatUTCWeekNumberISO,\n    \"w\": formatUTCWeekdayNumberSunday,\n    \"W\": formatUTCWeekNumberMonday,\n    \"x\": null,\n    \"X\": null,\n    \"y\": formatUTCYear,\n    \"Y\": formatUTCFullYear,\n    \"Z\": formatUTCZone,\n    \"%\": formatLiteralPercent\n  };\n\n  var parses = {\n    \"a\": parseShortWeekday,\n    \"A\": parseWeekday,\n    \"b\": parseShortMonth,\n    \"B\": parseMonth,\n    \"c\": parseLocaleDateTime,\n    \"d\": parseDayOfMonth,\n    \"e\": parseDayOfMonth,\n    \"f\": parseMicroseconds,\n    \"g\": parseYear,\n    \"G\": parseFullYear,\n    \"H\": parseHour24,\n    \"I\": parseHour24,\n    \"j\": parseDayOfYear,\n    \"L\": parseMilliseconds,\n    \"m\": parseMonthNumber,\n    \"M\": parseMinutes,\n    \"p\": parsePeriod,\n    \"q\": parseQuarter,\n    \"Q\": parseUnixTimestamp,\n    \"s\": parseUnixTimestampSeconds,\n    \"S\": parseSeconds,\n    \"u\": parseWeekdayNumberMonday,\n    \"U\": parseWeekNumberSunday,\n    \"V\": parseWeekNumberISO,\n    \"w\": parseWeekdayNumberSunday,\n    \"W\": parseWeekNumberMonday,\n    \"x\": parseLocaleDate,\n    \"X\": parseLocaleTime,\n    \"y\": parseYear,\n    \"Y\": parseFullYear,\n    \"Z\": parseZone,\n    \"%\": parseLiteralPercent\n  };\n\n  // These recursive directive definitions must be deferred.\n  formats.x = newFormat(locale_date, formats);\n  formats.X = newFormat(locale_time, formats);\n  formats.c = newFormat(locale_dateTime, formats);\n  utcFormats.x = newFormat(locale_date, utcFormats);\n  utcFormats.X = newFormat(locale_time, utcFormats);\n  utcFormats.c = newFormat(locale_dateTime, utcFormats);\n\n  function newFormat(specifier, formats) {\n    return function(date) {\n      var string = [],\n          i = -1,\n          j = 0,\n          n = specifier.length,\n          c,\n          pad,\n          format;\n\n      if (!(date instanceof Date)) date = new Date(+date);\n\n      while (++i < n) {\n        if (specifier.charCodeAt(i) === 37) {\n          string.push(specifier.slice(j, i));\n          if ((pad = pads[c = specifier.charAt(++i)]) != null) c = specifier.charAt(++i);\n          else pad = c === \"e\" ? \" \" : \"0\";\n          if (format = formats[c]) c = format(date, pad);\n          string.push(c);\n          j = i + 1;\n        }\n      }\n\n      string.push(specifier.slice(j, i));\n      return string.join(\"\");\n    };\n  }\n\n  function newParse(specifier, Z) {\n    return function(string) {\n      var d = newDate(1900, undefined, 1),\n          i = parseSpecifier(d, specifier, string += \"\", 0),\n          week, day;\n      if (i != string.length) return null;\n\n      // If a UNIX timestamp is specified, return it.\n      if (\"Q\" in d) return new Date(d.Q);\n      if (\"s\" in d) return new Date(d.s * 1000 + (\"L\" in d ? d.L : 0));\n\n      // If this is utcParse, never use the local timezone.\n      if (Z && !(\"Z\" in d)) d.Z = 0;\n\n      // The am-pm flag is 0 for AM, and 1 for PM.\n      if (\"p\" in d) d.H = d.H % 12 + d.p * 12;\n\n      // If the month was not specified, inherit from the quarter.\n      if (d.m === undefined) d.m = \"q\" in d ? d.q : 0;\n\n      // Convert day-of-week and week-of-year to day-of-year.\n      if (\"V\" in d) {\n        if (d.V < 1 || d.V > 53) return null;\n        if (!(\"w\" in d)) d.w = 1;\n        if (\"Z\" in d) {\n          week = utcDate(newDate(d.y, 0, 1)), day = week.getUTCDay();\n          week = day > 4 || day === 0 ? utcMonday.ceil(week) : utcMonday(week);\n          week = utcDay.offset(week, (d.V - 1) * 7);\n          d.y = week.getUTCFullYear();\n          d.m = week.getUTCMonth();\n          d.d = week.getUTCDate() + (d.w + 6) % 7;\n        } else {\n          week = localDate(newDate(d.y, 0, 1)), day = week.getDay();\n          week = day > 4 || day === 0 ? timeMonday.ceil(week) : timeMonday(week);\n          week = timeDay.offset(week, (d.V - 1) * 7);\n          d.y = week.getFullYear();\n          d.m = week.getMonth();\n          d.d = week.getDate() + (d.w + 6) % 7;\n        }\n      } else if (\"W\" in d || \"U\" in d) {\n        if (!(\"w\" in d)) d.w = \"u\" in d ? d.u % 7 : \"W\" in d ? 1 : 0;\n        day = \"Z\" in d ? utcDate(newDate(d.y, 0, 1)).getUTCDay() : localDate(newDate(d.y, 0, 1)).getDay();\n        d.m = 0;\n        d.d = \"W\" in d ? (d.w + 6) % 7 + d.W * 7 - (day + 5) % 7 : d.w + d.U * 7 - (day + 6) % 7;\n      }\n\n      // If a time zone is specified, all fields are interpreted as UTC and then\n      // offset according to the specified time zone.\n      if (\"Z\" in d) {\n        d.H += d.Z / 100 | 0;\n        d.M += d.Z % 100;\n        return utcDate(d);\n      }\n\n      // Otherwise, all fields are in local time.\n      return localDate(d);\n    };\n  }\n\n  function parseSpecifier(d, specifier, string, j) {\n    var i = 0,\n        n = specifier.length,\n        m = string.length,\n        c,\n        parse;\n\n    while (i < n) {\n      if (j >= m) return -1;\n      c = specifier.charCodeAt(i++);\n      if (c === 37) {\n        c = specifier.charAt(i++);\n        parse = parses[c in pads ? specifier.charAt(i++) : c];\n        if (!parse || ((j = parse(d, string, j)) < 0)) return -1;\n      } else if (c != string.charCodeAt(j++)) {\n        return -1;\n      }\n    }\n\n    return j;\n  }\n\n  function parsePeriod(d, string, i) {\n    var n = periodRe.exec(string.slice(i));\n    return n ? (d.p = periodLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;\n  }\n\n  function parseShortWeekday(d, string, i) {\n    var n = shortWeekdayRe.exec(string.slice(i));\n    return n ? (d.w = shortWeekdayLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;\n  }\n\n  function parseWeekday(d, string, i) {\n    var n = weekdayRe.exec(string.slice(i));\n    return n ? (d.w = weekdayLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;\n  }\n\n  function parseShortMonth(d, string, i) {\n    var n = shortMonthRe.exec(string.slice(i));\n    return n ? (d.m = shortMonthLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;\n  }\n\n  function parseMonth(d, string, i) {\n    var n = monthRe.exec(string.slice(i));\n    return n ? (d.m = monthLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;\n  }\n\n  function parseLocaleDateTime(d, string, i) {\n    return parseSpecifier(d, locale_dateTime, string, i);\n  }\n\n  function parseLocaleDate(d, string, i) {\n    return parseSpecifier(d, locale_date, string, i);\n  }\n\n  function parseLocaleTime(d, string, i) {\n    return parseSpecifier(d, locale_time, string, i);\n  }\n\n  function formatShortWeekday(d) {\n    return locale_shortWeekdays[d.getDay()];\n  }\n\n  function formatWeekday(d) {\n    return locale_weekdays[d.getDay()];\n  }\n\n  function formatShortMonth(d) {\n    return locale_shortMonths[d.getMonth()];\n  }\n\n  function formatMonth(d) {\n    return locale_months[d.getMonth()];\n  }\n\n  function formatPeriod(d) {\n    return locale_periods[+(d.getHours() >= 12)];\n  }\n\n  function formatQuarter(d) {\n    return 1 + ~~(d.getMonth() / 3);\n  }\n\n  function formatUTCShortWeekday(d) {\n    return locale_shortWeekdays[d.getUTCDay()];\n  }\n\n  function formatUTCWeekday(d) {\n    return locale_weekdays[d.getUTCDay()];\n  }\n\n  function formatUTCShortMonth(d) {\n    return locale_shortMonths[d.getUTCMonth()];\n  }\n\n  function formatUTCMonth(d) {\n    return locale_months[d.getUTCMonth()];\n  }\n\n  function formatUTCPeriod(d) {\n    return locale_periods[+(d.getUTCHours() >= 12)];\n  }\n\n  function formatUTCQuarter(d) {\n    return 1 + ~~(d.getUTCMonth() / 3);\n  }\n\n  return {\n    format: function(specifier) {\n      var f = newFormat(specifier += \"\", formats);\n      f.toString = function() { return specifier; };\n      return f;\n    },\n    parse: function(specifier) {\n      var p = newParse(specifier += \"\", false);\n      p.toString = function() { return specifier; };\n      return p;\n    },\n    utcFormat: function(specifier) {\n      var f = newFormat(specifier += \"\", utcFormats);\n      f.toString = function() { return specifier; };\n      return f;\n    },\n    utcParse: function(specifier) {\n      var p = newParse(specifier += \"\", true);\n      p.toString = function() { return specifier; };\n      return p;\n    }\n  };\n}\n\nvar pads = {\"-\": \"\", \"_\": \" \", \"0\": \"0\"},\n    numberRe = /^\\s*\\d+/, // note: ignores next directive\n    percentRe = /^%/,\n    requoteRe = /[\\\\^$*+?|[\\]().{}]/g;\n\nfunction pad(value, fill, width) {\n  var sign = value < 0 ? \"-\" : \"\",\n      string = (sign ? -value : value) + \"\",\n      length = string.length;\n  return sign + (length < width ? new Array(width - length + 1).join(fill) + string : string);\n}\n\nfunction requote(s) {\n  return s.replace(requoteRe, \"\\\\$&\");\n}\n\nfunction formatRe(names) {\n  return new RegExp(\"^(?:\" + names.map(requote).join(\"|\") + \")\", \"i\");\n}\n\nfunction formatLookup(names) {\n  return new Map(names.map((name, i) => [name.toLowerCase(), i]));\n}\n\nfunction parseWeekdayNumberSunday(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 1));\n  return n ? (d.w = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseWeekdayNumberMonday(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 1));\n  return n ? (d.u = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseWeekNumberSunday(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.U = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseWeekNumberISO(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.V = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseWeekNumberMonday(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.W = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseFullYear(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 4));\n  return n ? (d.y = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseYear(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.y = +n[0] + (+n[0] > 68 ? 1900 : 2000), i + n[0].length) : -1;\n}\n\nfunction parseZone(d, string, i) {\n  var n = /^(Z)|([+-]\\d\\d)(?::?(\\d\\d))?/.exec(string.slice(i, i + 6));\n  return n ? (d.Z = n[1] ? 0 : -(n[2] + (n[3] || \"00\")), i + n[0].length) : -1;\n}\n\nfunction parseQuarter(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 1));\n  return n ? (d.q = n[0] * 3 - 3, i + n[0].length) : -1;\n}\n\nfunction parseMonthNumber(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.m = n[0] - 1, i + n[0].length) : -1;\n}\n\nfunction parseDayOfMonth(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.d = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseDayOfYear(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 3));\n  return n ? (d.m = 0, d.d = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseHour24(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.H = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseMinutes(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.M = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseSeconds(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.S = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseMilliseconds(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 3));\n  return n ? (d.L = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseMicroseconds(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 6));\n  return n ? (d.L = Math.floor(n[0] / 1000), i + n[0].length) : -1;\n}\n\nfunction parseLiteralPercent(d, string, i) {\n  var n = percentRe.exec(string.slice(i, i + 1));\n  return n ? i + n[0].length : -1;\n}\n\nfunction parseUnixTimestamp(d, string, i) {\n  var n = numberRe.exec(string.slice(i));\n  return n ? (d.Q = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseUnixTimestampSeconds(d, string, i) {\n  var n = numberRe.exec(string.slice(i));\n  return n ? (d.s = +n[0], i + n[0].length) : -1;\n}\n\nfunction formatDayOfMonth(d, p) {\n  return pad(d.getDate(), p, 2);\n}\n\nfunction formatHour24(d, p) {\n  return pad(d.getHours(), p, 2);\n}\n\nfunction formatHour12(d, p) {\n  return pad(d.getHours() % 12 || 12, p, 2);\n}\n\nfunction formatDayOfYear(d, p) {\n  return pad(1 + timeDay.count(timeYear(d), d), p, 3);\n}\n\nfunction formatMilliseconds(d, p) {\n  return pad(d.getMilliseconds(), p, 3);\n}\n\nfunction formatMicroseconds(d, p) {\n  return formatMilliseconds(d, p) + \"000\";\n}\n\nfunction formatMonthNumber(d, p) {\n  return pad(d.getMonth() + 1, p, 2);\n}\n\nfunction formatMinutes(d, p) {\n  return pad(d.getMinutes(), p, 2);\n}\n\nfunction formatSeconds(d, p) {\n  return pad(d.getSeconds(), p, 2);\n}\n\nfunction formatWeekdayNumberMonday(d) {\n  var day = d.getDay();\n  return day === 0 ? 7 : day;\n}\n\nfunction formatWeekNumberSunday(d, p) {\n  return pad(timeSunday.count(timeYear(d) - 1, d), p, 2);\n}\n\nfunction dISO(d) {\n  var day = d.getDay();\n  return (day >= 4 || day === 0) ? timeThursday(d) : timeThursday.ceil(d);\n}\n\nfunction formatWeekNumberISO(d, p) {\n  d = dISO(d);\n  return pad(timeThursday.count(timeYear(d), d) + (timeYear(d).getDay() === 4), p, 2);\n}\n\nfunction formatWeekdayNumberSunday(d) {\n  return d.getDay();\n}\n\nfunction formatWeekNumberMonday(d, p) {\n  return pad(timeMonday.count(timeYear(d) - 1, d), p, 2);\n}\n\nfunction formatYear(d, p) {\n  return pad(d.getFullYear() % 100, p, 2);\n}\n\nfunction formatYearISO(d, p) {\n  d = dISO(d);\n  return pad(d.getFullYear() % 100, p, 2);\n}\n\nfunction formatFullYear(d, p) {\n  return pad(d.getFullYear() % 10000, p, 4);\n}\n\nfunction formatFullYearISO(d, p) {\n  var day = d.getDay();\n  d = (day >= 4 || day === 0) ? timeThursday(d) : timeThursday.ceil(d);\n  return pad(d.getFullYear() % 10000, p, 4);\n}\n\nfunction formatZone(d) {\n  var z = d.getTimezoneOffset();\n  return (z > 0 ? \"-\" : (z *= -1, \"+\"))\n      + pad(z / 60 | 0, \"0\", 2)\n      + pad(z % 60, \"0\", 2);\n}\n\nfunction formatUTCDayOfMonth(d, p) {\n  return pad(d.getUTCDate(), p, 2);\n}\n\nfunction formatUTCHour24(d, p) {\n  return pad(d.getUTCHours(), p, 2);\n}\n\nfunction formatUTCHour12(d, p) {\n  return pad(d.getUTCHours() % 12 || 12, p, 2);\n}\n\nfunction formatUTCDayOfYear(d, p) {\n  return pad(1 + utcDay.count(utcYear(d), d), p, 3);\n}\n\nfunction formatUTCMilliseconds(d, p) {\n  return pad(d.getUTCMilliseconds(), p, 3);\n}\n\nfunction formatUTCMicroseconds(d, p) {\n  return formatUTCMilliseconds(d, p) + \"000\";\n}\n\nfunction formatUTCMonthNumber(d, p) {\n  return pad(d.getUTCMonth() + 1, p, 2);\n}\n\nfunction formatUTCMinutes(d, p) {\n  return pad(d.getUTCMinutes(), p, 2);\n}\n\nfunction formatUTCSeconds(d, p) {\n  return pad(d.getUTCSeconds(), p, 2);\n}\n\nfunction formatUTCWeekdayNumberMonday(d) {\n  var dow = d.getUTCDay();\n  return dow === 0 ? 7 : dow;\n}\n\nfunction formatUTCWeekNumberSunday(d, p) {\n  return pad(utcSunday.count(utcYear(d) - 1, d), p, 2);\n}\n\nfunction UTCdISO(d) {\n  var day = d.getUTCDay();\n  return (day >= 4 || day === 0) ? utcThursday(d) : utcThursday.ceil(d);\n}\n\nfunction formatUTCWeekNumberISO(d, p) {\n  d = UTCdISO(d);\n  return pad(utcThursday.count(utcYear(d), d) + (utcYear(d).getUTCDay() === 4), p, 2);\n}\n\nfunction formatUTCWeekdayNumberSunday(d) {\n  return d.getUTCDay();\n}\n\nfunction formatUTCWeekNumberMonday(d, p) {\n  return pad(utcMonday.count(utcYear(d) - 1, d), p, 2);\n}\n\nfunction formatUTCYear(d, p) {\n  return pad(d.getUTCFullYear() % 100, p, 2);\n}\n\nfunction formatUTCYearISO(d, p) {\n  d = UTCdISO(d);\n  return pad(d.getUTCFullYear() % 100, p, 2);\n}\n\nfunction formatUTCFullYear(d, p) {\n  return pad(d.getUTCFullYear() % 10000, p, 4);\n}\n\nfunction formatUTCFullYearISO(d, p) {\n  var day = d.getUTCDay();\n  d = (day >= 4 || day === 0) ? utcThursday(d) : utcThursday.ceil(d);\n  return pad(d.getUTCFullYear() % 10000, p, 4);\n}\n\nfunction formatUTCZone() {\n  return \"+0000\";\n}\n\nfunction formatLiteralPercent() {\n  return \"%\";\n}\n\nfunction formatUnixTimestamp(d) {\n  return +d;\n}\n\nfunction formatUnixTimestampSeconds(d) {\n  return Math.floor(+d / 1000);\n}\n", "import formatLocale from \"./locale.js\";\n\nvar locale;\nexport var timeFormat;\nexport var timeParse;\nexport var utcFormat;\nexport var utcParse;\n\ndefaultLocale({\n  dateTime: \"%x, %X\",\n  date: \"%-m/%-d/%Y\",\n  time: \"%-I:%M:%S %p\",\n  periods: [\"AM\", \"PM\"],\n  days: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\n  shortDays: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n  months: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\n  shortMonths: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"]\n});\n\nexport default function defaultLocale(definition) {\n  locale = formatLocale(definition);\n  timeFormat = locale.format;\n  timeParse = locale.parse;\n  utcFormat = locale.utcFormat;\n  utcParse = locale.utcParse;\n  return locale;\n}\n", "import {timeYear, timeMonth, timeWeek, timeDay, timeHour, timeMinute, timeSecond, timeTicks, timeTickInterval} from \"d3-time\";\nimport {timeFormat} from \"d3-time-format\";\nimport continuous, {copy} from \"./continuous.js\";\nimport {initRange} from \"./init.js\";\nimport nice from \"./nice.js\";\n\nfunction date(t) {\n  return new Date(t);\n}\n\nfunction number(t) {\n  return t instanceof Date ? +t : +new Date(+t);\n}\n\nexport function calendar(ticks, tickInterval, year, month, week, day, hour, minute, second, format) {\n  var scale = continuous(),\n      invert = scale.invert,\n      domain = scale.domain;\n\n  var formatMillisecond = format(\".%L\"),\n      formatSecond = format(\":%S\"),\n      formatMinute = format(\"%I:%M\"),\n      formatHour = format(\"%I %p\"),\n      formatDay = format(\"%a %d\"),\n      formatWeek = format(\"%b %d\"),\n      formatMonth = format(\"%B\"),\n      formatYear = format(\"%Y\");\n\n  function tickFormat(date) {\n    return (second(date) < date ? formatMillisecond\n        : minute(date) < date ? formatSecond\n        : hour(date) < date ? formatMinute\n        : day(date) < date ? formatHour\n        : month(date) < date ? (week(date) < date ? formatDay : formatWeek)\n        : year(date) < date ? formatMonth\n        : formatYear)(date);\n  }\n\n  scale.invert = function(y) {\n    return new Date(invert(y));\n  };\n\n  scale.domain = function(_) {\n    return arguments.length ? domain(Array.from(_, number)) : domain().map(date);\n  };\n\n  scale.ticks = function(interval) {\n    var d = domain();\n    return ticks(d[0], d[d.length - 1], interval == null ? 10 : interval);\n  };\n\n  scale.tickFormat = function(count, specifier) {\n    return specifier == null ? tickFormat : format(specifier);\n  };\n\n  scale.nice = function(interval) {\n    var d = domain();\n    if (!interval || typeof interval.range !== \"function\") interval = tickInterval(d[0], d[d.length - 1], interval == null ? 10 : interval);\n    return interval ? domain(nice(d, interval)) : scale;\n  };\n\n  scale.copy = function() {\n    return copy(scale, calendar(ticks, tickInterval, year, month, week, day, hour, minute, second, format));\n  };\n\n  return scale;\n}\n\nexport default function time() {\n  return initRange.apply(calendar(timeTicks, timeTickInterval, timeYear, timeMonth, timeWeek, timeDay, timeHour, timeMinute, timeSecond, timeFormat).domain([new Date(2000, 0, 1), new Date(2000, 0, 2)]), arguments);\n}\n", "export default function(x) {\n  return function constant() {\n    return x;\n  };\n}\n", "const pi = Math.PI,\n    tau = 2 * pi,\n    epsilon = 1e-6,\n    tauEpsilon = tau - epsilon;\n\nfunction append(strings) {\n  this._ += strings[0];\n  for (let i = 1, n = strings.length; i < n; ++i) {\n    this._ += arguments[i] + strings[i];\n  }\n}\n\nfunction appendRound(digits) {\n  let d = Math.floor(digits);\n  if (!(d >= 0)) throw new Error(`invalid digits: ${digits}`);\n  if (d > 15) return append;\n  const k = 10 ** d;\n  return function(strings) {\n    this._ += strings[0];\n    for (let i = 1, n = strings.length; i < n; ++i) {\n      this._ += Math.round(arguments[i] * k) / k + strings[i];\n    }\n  };\n}\n\nexport class Path {\n  constructor(digits) {\n    this._x0 = this._y0 = // start of current subpath\n    this._x1 = this._y1 = null; // end of current subpath\n    this._ = \"\";\n    this._append = digits == null ? append : appendRound(digits);\n  }\n  moveTo(x, y) {\n    this._append`M${this._x0 = this._x1 = +x},${this._y0 = this._y1 = +y}`;\n  }\n  closePath() {\n    if (this._x1 !== null) {\n      this._x1 = this._x0, this._y1 = this._y0;\n      this._append`Z`;\n    }\n  }\n  lineTo(x, y) {\n    this._append`L${this._x1 = +x},${this._y1 = +y}`;\n  }\n  quadraticCurveTo(x1, y1, x, y) {\n    this._append`Q${+x1},${+y1},${this._x1 = +x},${this._y1 = +y}`;\n  }\n  bezierCurveTo(x1, y1, x2, y2, x, y) {\n    this._append`C${+x1},${+y1},${+x2},${+y2},${this._x1 = +x},${this._y1 = +y}`;\n  }\n  arcTo(x1, y1, x2, y2, r) {\n    x1 = +x1, y1 = +y1, x2 = +x2, y2 = +y2, r = +r;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(`negative radius: ${r}`);\n\n    let x0 = this._x1,\n        y0 = this._y1,\n        x21 = x2 - x1,\n        y21 = y2 - y1,\n        x01 = x0 - x1,\n        y01 = y0 - y1,\n        l01_2 = x01 * x01 + y01 * y01;\n\n    // Is this path empty? Move to (x1,y1).\n    if (this._x1 === null) {\n      this._append`M${this._x1 = x1},${this._y1 = y1}`;\n    }\n\n    // Or, is (x1,y1) coincident with (x0,y0)? Do nothing.\n    else if (!(l01_2 > epsilon));\n\n    // Or, are (x0,y0), (x1,y1) and (x2,y2) collinear?\n    // Equivalently, is (x1,y1) coincident with (x2,y2)?\n    // Or, is the radius zero? Line to (x1,y1).\n    else if (!(Math.abs(y01 * x21 - y21 * x01) > epsilon) || !r) {\n      this._append`L${this._x1 = x1},${this._y1 = y1}`;\n    }\n\n    // Otherwise, draw an arc!\n    else {\n      let x20 = x2 - x0,\n          y20 = y2 - y0,\n          l21_2 = x21 * x21 + y21 * y21,\n          l20_2 = x20 * x20 + y20 * y20,\n          l21 = Math.sqrt(l21_2),\n          l01 = Math.sqrt(l01_2),\n          l = r * Math.tan((pi - Math.acos((l21_2 + l01_2 - l20_2) / (2 * l21 * l01))) / 2),\n          t01 = l / l01,\n          t21 = l / l21;\n\n      // If the start tangent is not coincident with (x0,y0), line to.\n      if (Math.abs(t01 - 1) > epsilon) {\n        this._append`L${x1 + t01 * x01},${y1 + t01 * y01}`;\n      }\n\n      this._append`A${r},${r},0,0,${+(y01 * x20 > x01 * y20)},${this._x1 = x1 + t21 * x21},${this._y1 = y1 + t21 * y21}`;\n    }\n  }\n  arc(x, y, r, a0, a1, ccw) {\n    x = +x, y = +y, r = +r, ccw = !!ccw;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(`negative radius: ${r}`);\n\n    let dx = r * Math.cos(a0),\n        dy = r * Math.sin(a0),\n        x0 = x + dx,\n        y0 = y + dy,\n        cw = 1 ^ ccw,\n        da = ccw ? a0 - a1 : a1 - a0;\n\n    // Is this path empty? Move to (x0,y0).\n    if (this._x1 === null) {\n      this._append`M${x0},${y0}`;\n    }\n\n    // Or, is (x0,y0) not coincident with the previous point? Line to (x0,y0).\n    else if (Math.abs(this._x1 - x0) > epsilon || Math.abs(this._y1 - y0) > epsilon) {\n      this._append`L${x0},${y0}`;\n    }\n\n    // Is this arc empty? We\u2019re done.\n    if (!r) return;\n\n    // Does the angle go the wrong way? Flip the direction.\n    if (da < 0) da = da % tau + tau;\n\n    // Is this a complete circle? Draw two arcs to complete the circle.\n    if (da > tauEpsilon) {\n      this._append`A${r},${r},0,1,${cw},${x - dx},${y - dy}A${r},${r},0,1,${cw},${this._x1 = x0},${this._y1 = y0}`;\n    }\n\n    // Is this arc non-empty? Draw an arc!\n    else if (da > epsilon) {\n      this._append`A${r},${r},0,${+(da >= pi)},${cw},${this._x1 = x + r * Math.cos(a1)},${this._y1 = y + r * Math.sin(a1)}`;\n    }\n  }\n  rect(x, y, w, h) {\n    this._append`M${this._x0 = this._x1 = +x},${this._y0 = this._y1 = +y}h${w = +w}v${+h}h${-w}Z`;\n  }\n  toString() {\n    return this._;\n  }\n}\n\nexport function path() {\n  return new Path;\n}\n\n// Allow instanceof d3.path\npath.prototype = Path.prototype;\n\nexport function pathRound(digits = 3) {\n  return new Path(+digits);\n}\n", "import {Path} from \"d3-path\";\n\nexport function withPath(shape) {\n  let digits = 3;\n\n  shape.digits = function(_) {\n    if (!arguments.length) return digits;\n    if (_ == null) {\n      digits = null;\n    } else {\n      const d = Math.floor(_);\n      if (!(d >= 0)) throw new RangeError(`invalid digits: ${_}`);\n      digits = d;\n    }\n    return shape;\n  };\n\n  return () => new Path(digits);\n}\n", "export var slice = Array.prototype.slice;\n\nexport default function(x) {\n  return typeof x === \"object\" && \"length\" in x\n    ? x // Array, TypedArray, NodeList, array-like\n    : Array.from(x); // Map, Set, iterable, string, or anything else\n}\n", "function Linear(context) {\n  this._context = context;\n}\n\nLinear.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; // falls through\n      default: this._context.lineTo(x, y); break;\n    }\n  }\n};\n\nexport default function(context) {\n  return new Linear(context);\n}\n", "export function x(p) {\n  return p[0];\n}\n\nexport function y(p) {\n  return p[1];\n}\n", "import array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport curveLinear from \"./curve/linear.js\";\nimport {withPath} from \"./path.js\";\nimport {x as pointX, y as pointY} from \"./point.js\";\n\nexport default function(x, y) {\n  var defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null,\n      path = withPath(line);\n\n  x = typeof x === \"function\" ? x : (x === undefined) ? pointX : constant(x);\n  y = typeof y === \"function\" ? y : (y === undefined) ? pointY : constant(y);\n\n  function line(data) {\n    var i,\n        n = (data = array(data)).length,\n        d,\n        defined0 = false,\n        buffer;\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) output.lineStart();\n        else output.lineEnd();\n      }\n      if (defined0) output.point(+x(d, i, data), +y(d, i, data));\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  line.x = function(_) {\n    return arguments.length ? (x = typeof _ === \"function\" ? _ : constant(+_), line) : x;\n  };\n\n  line.y = function(_) {\n    return arguments.length ? (y = typeof _ === \"function\" ? _ : constant(+_), line) : y;\n  };\n\n  line.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), line) : defined;\n  };\n\n  line.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), line) : curve;\n  };\n\n  line.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), line) : context;\n  };\n\n  return line;\n}\n", "import array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport curveLinear from \"./curve/linear.js\";\nimport line from \"./line.js\";\nimport {withPath} from \"./path.js\";\nimport {x as pointX, y as pointY} from \"./point.js\";\n\nexport default function(x0, y0, y1) {\n  var x1 = null,\n      defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null,\n      path = withPath(area);\n\n  x0 = typeof x0 === \"function\" ? x0 : (x0 === undefined) ? pointX : constant(+x0);\n  y0 = typeof y0 === \"function\" ? y0 : (y0 === undefined) ? constant(0) : constant(+y0);\n  y1 = typeof y1 === \"function\" ? y1 : (y1 === undefined) ? pointY : constant(+y1);\n\n  function area(data) {\n    var i,\n        j,\n        k,\n        n = (data = array(data)).length,\n        d,\n        defined0 = false,\n        buffer,\n        x0z = new Array(n),\n        y0z = new Array(n);\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) {\n          j = i;\n          output.areaStart();\n          output.lineStart();\n        } else {\n          output.lineEnd();\n          output.lineStart();\n          for (k = i - 1; k >= j; --k) {\n            output.point(x0z[k], y0z[k]);\n          }\n          output.lineEnd();\n          output.areaEnd();\n        }\n      }\n      if (defined0) {\n        x0z[i] = +x0(d, i, data), y0z[i] = +y0(d, i, data);\n        output.point(x1 ? +x1(d, i, data) : x0z[i], y1 ? +y1(d, i, data) : y0z[i]);\n      }\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  function arealine() {\n    return line().defined(defined).curve(curve).context(context);\n  }\n\n  area.x = function(_) {\n    return arguments.length ? (x0 = typeof _ === \"function\" ? _ : constant(+_), x1 = null, area) : x0;\n  };\n\n  area.x0 = function(_) {\n    return arguments.length ? (x0 = typeof _ === \"function\" ? _ : constant(+_), area) : x0;\n  };\n\n  area.x1 = function(_) {\n    return arguments.length ? (x1 = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), area) : x1;\n  };\n\n  area.y = function(_) {\n    return arguments.length ? (y0 = typeof _ === \"function\" ? _ : constant(+_), y1 = null, area) : y0;\n  };\n\n  area.y0 = function(_) {\n    return arguments.length ? (y0 = typeof _ === \"function\" ? _ : constant(+_), area) : y0;\n  };\n\n  area.y1 = function(_) {\n    return arguments.length ? (y1 = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), area) : y1;\n  };\n\n  area.lineX0 =\n  area.lineY0 = function() {\n    return arealine().x(x0).y(y0);\n  };\n\n  area.lineY1 = function() {\n    return arealine().x(x0).y(y1);\n  };\n\n  area.lineX1 = function() {\n    return arealine().x(x1).y(y0);\n  };\n\n  area.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), area) : defined;\n  };\n\n  area.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), area) : curve;\n  };\n\n  area.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), area) : context;\n  };\n\n  return area;\n}\n", "function sign(x) {\n  return x < 0 ? -1 : 1;\n}\n\n// Calculate the slopes of the tangents (Hermite-type interpolation) based on\n// the following paper: Steffen, M. 1990. A Simple Method for Monotonic\n// Interpolation in One Dimension. Astronomy and Astrophysics, Vol. 239, NO.\n// NOV(II), P. 443, 1990.\nfunction slope3(that, x2, y2) {\n  var h0 = that._x1 - that._x0,\n      h1 = x2 - that._x1,\n      s0 = (that._y1 - that._y0) / (h0 || h1 < 0 && -0),\n      s1 = (y2 - that._y1) / (h1 || h0 < 0 && -0),\n      p = (s0 * h1 + s1 * h0) / (h0 + h1);\n  return (sign(s0) + sign(s1)) * Math.min(Math.abs(s0), Math.abs(s1), 0.5 * Math.abs(p)) || 0;\n}\n\n// Calculate a one-sided slope.\nfunction slope2(that, t) {\n  var h = that._x1 - that._x0;\n  return h ? (3 * (that._y1 - that._y0) / h - t) / 2 : t;\n}\n\n// According to https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Representations\n// \"you can express cubic Hermite interpolation in terms of cubic B\u00E9zier curves\n// with respect to the four values p0, p0 + m0 / 3, p1 - m1 / 3, p1\".\nfunction point(that, t0, t1) {\n  var x0 = that._x0,\n      y0 = that._y0,\n      x1 = that._x1,\n      y1 = that._y1,\n      dx = (x1 - x0) / 3;\n  that._context.bezierCurveTo(x0 + dx, y0 + dx * t0, x1 - dx, y1 - dx * t1, x1, y1);\n}\n\nfunction MonotoneX(context) {\n  this._context = context;\n}\n\nMonotoneX.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 =\n    this._t0 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x1, this._y1); break;\n      case 3: point(this, this._t0, slope2(this, this._t0)); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    var t1 = NaN;\n\n    x = +x, y = +y;\n    if (x === this._x1 && y === this._y1) return; // Ignore coincident points.\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; point(this, slope2(this, t1 = slope3(this, x, y)), t1); break;\n      default: point(this, this._t0, t1 = slope3(this, x, y)); break;\n    }\n\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n    this._t0 = t1;\n  }\n}\n\nfunction MonotoneY(context) {\n  this._context = new ReflectContext(context);\n}\n\n(MonotoneY.prototype = Object.create(MonotoneX.prototype)).point = function(x, y) {\n  MonotoneX.prototype.point.call(this, y, x);\n};\n\nfunction ReflectContext(context) {\n  this._context = context;\n}\n\nReflectContext.prototype = {\n  moveTo: function(x, y) { this._context.moveTo(y, x); },\n  closePath: function() { this._context.closePath(); },\n  lineTo: function(x, y) { this._context.lineTo(y, x); },\n  bezierCurveTo: function(x1, y1, x2, y2, x, y) { this._context.bezierCurveTo(y1, x1, y2, x2, y, x); }\n};\n\nexport function monotoneX(context) {\n  return new MonotoneX(context);\n}\n\nexport function monotoneY(context) {\n  return new MonotoneY(context);\n}\n", "import { scaleLinear, scaleTime } from 'd3-scale';\nimport { extent } from 'd3-array';\nimport { line as d3Line, curveMonotoneX } from 'd3-shape';\n\nexport function createXTimeScale<T>(data: T[], accessor: (d: T) => Date, range: [number, number]) {\n  const domain = extent(data, accessor) as [Date, Date];\n  return scaleTime().domain(domain).range(range);\n}\n\nexport function createYLinearScale<T>(data: T[], accessor: (d: T) => number, range: [number, number]) {\n  const [min, max] = extent(data, accessor) as [number, number];\n  // We want a small visual gap below the lowest plotted value when the series is strictly positive,\n  // instead of always anchoring at zero (which can waste vertical space if min is far from 0) or\n  // sitting the lowest point flush on the axis. If the minimum value is 0 or negative we keep the\n  // natural lower bound (no enforced gap) because the user explicitly allows that case.\n  const hasData = Number.isFinite(min) && Number.isFinite(max);\n  if (!hasData) {\n    return scaleLinear().domain([0, 0]).range(range); // empty / invalid fallback\n  }\n  let lower: number;\n  if (min <= 0) {\n    // Keep original behaviour for datasets that include zero or negative values.\n    lower = Math.min(0, min);\n  } else {\n    const span = max - min;\n    // Padding is 5% of span, with a fallback to 10% of min when span is tiny / zero.\n    const pad = (span > 0 ? span : min) * 0.1;\n    lower = Math.max(0, min - pad);\n    // Guard against floating precision causing lower == min.\n    if (lower === min) lower = Math.max(0, min * 0.9);\n  }\n  const upper = max ?? 0;\n  return scaleLinear()\n    .domain([lower, upper])\n    .nice()\n    .range(range);\n}\n\nexport function createLinePath<T>(\n  data: T[],\n  x: (d: T) => number,\n  y: (d: T) => number,\n  options?: { smooth?: boolean }\n) {\n  const lineGen = d3Line<T>()\n    .x(x)\n    .y(y);\n  if (options?.smooth !== false) {\n    lineGen.curve(curveMonotoneX);\n  }\n  return lineGen(data) ?? '';\n}\n", "import * as React from 'react';\n\nexport interface ChartDimensions {\n  width: number;\n  height: number;\n  innerWidth: number;\n  innerHeight: number;\n  margin: { top: number; right: number; bottom: number; left: number };\n  ref: React.RefObject<HTMLDivElement | null>;\n}\n\nexport function useChartDimensions(initial: Partial<ChartDimensions['margin']> = {}): ChartDimensions {\n  const ref = React.useRef<HTMLDivElement>(null);\n  const margin = React.useMemo(() => ({\n    top: initial.top ?? 16,\n    right: initial.right ?? 16,\n    bottom: initial.bottom ?? 32,\n    left: initial.left ?? 48\n  }), [initial.bottom, initial.left, initial.right, initial.top]);\n\n  const [dims, setDims] = React.useState({ width: 0, height: 0 });\n\n  React.useLayoutEffect(() => {\n    if (!ref.current) return;    \n    const ro = new ResizeObserver(entries => {\n      for (const entry of entries) {\n        const { width, height } = entry.contentRect;\n        setDims({ width, height });\n      }\n    });\n    ro.observe(ref.current);\n    return () => ro.disconnect();\n  }, []);\n\n  const innerWidth = Math.max(0, dims.width - margin.left - margin.right);\n  const innerHeight = Math.max(0, dims.height - margin.top - margin.bottom);\n\n  return { width: dims.width, height: dims.height, innerWidth, innerHeight, margin, ref };\n}\n", "import * as React from 'react';\nimport { useChartDimensions, type ChartDimensions } from '../hooks/useChartDimensions';\n\nexport interface ChartRootProps {\n  /** Explicit height (px). Width is responsive to parent unless set via style */\n  height?: number;\n  /** Override margins (top,right,bottom,left) */\n  margin?: Partial<ChartDimensions['margin']>;\n  /** Optional explicit width; otherwise flex/parent controlled */\n  width?: number | string;\n  className?: string;\n  children: React.ReactNode;\n  role?: string;\n  ariaLabel?: string;\n}\n\ninterface ChartContextValue extends ChartDimensions {}\n\nconst ChartContext = React.createContext<ChartContextValue | null>(null);\nexport function useChartContext(): ChartContextValue | null { return React.useContext(ChartContext); }\n\nexport const ChartRoot: React.FC<ChartRootProps> = ({\n  height = 240,\n  margin,\n  width,\n  className = 'fdp-chart', // align with SCSS token application (.fdp-chart)\n  children,\n  role = 'group',\n  ariaLabel\n}) => {\n  const dims = useChartDimensions(margin);\n  const style: React.CSSProperties = { height, position: 'relative' };\n  if (width !== undefined) style.width = typeof width === 'number' ? `${width}px` : width;\n\n  return (\n    <div ref={dims.ref as any} className={className} style={style} role={role} aria-label={ariaLabel}>\n      <ChartContext.Provider value={dims}>\n        {children}\n      </ChartContext.Provider>\n    </div>\n  );\n};\n\nexport default ChartRoot;\n", "import * as React from 'react';\nimport { createXTimeScale, createYLinearScale } from '../utils/scales';\nimport { useChartContext } from './ChartRoot';\n\n// Provides d3 x/y scales + tick helpers for time-series line charts (initial scope).\nexport interface ScaleContextValue {\n  xScale: any; // d3 ScaleTime\n  yScale: any; // d3 ScaleLinear\n  getXTicks: (count?: number) => Date[];\n  getYTicks: (count?: number) => number[];\n}\n\nconst ScaleContext = React.createContext<ScaleContextValue | null>(null);\nexport const useScaleContext = () => React.useContext(ScaleContext);\n\nexport interface LineScalesProviderProps<Datum extends { x: any; y: number }> {\n  series: { data: Datum[] }[];\n  /** Explicit inner width; if omitted, derived from ChartRoot context (if available) */\n  innerWidth?: number; // width excluding margins\n  /** Explicit inner height; if omitted, derived from ChartRoot context (if available) */\n  innerHeight?: number; // height excluding margins\n  parseX?: (d: Datum) => Date; // custom accessor override\n  children: React.ReactNode;\n  xTickCount?: number; // preferred default counts\n  yTickCount?: number;\n  /** Optional explicit y domain override (e.g. stacked totals). */\n  yDomain?: [number, number];\n  /** Inner padding (px) to leave between axis and plotted points \u2014 improves hover targets near edges. Default: 6px */\n  xPadding?: number;\n  yPadding?: number;\n}\n\nexport const LineScalesProvider = <Datum extends { x: any; y: number }>({\n  series,\n  innerWidth: innerWidthProp,\n  innerHeight: innerHeightProp,\n  parseX: parseXProp,\n  children,\n  xTickCount = 6,\n  yTickCount = 5,\n  yDomain\n  , xPadding, yPadding\n}: LineScalesProviderProps<Datum>) => {\n  const chartDims = useChartContext();\n  // Prefer explicit values; fallback to chart context; final fallback 0 (will update on re-measure)\n  const innerWidth = innerWidthProp ?? chartDims?.innerWidth ?? 0;\n  const innerHeight = innerHeightProp ?? chartDims?.innerHeight ?? 0;\n  const allData = React.useMemo(() => series.flatMap(s => s.data), [series]);\n  const parseX = React.useCallback((d: Datum) => {\n    if (parseXProp) return parseXProp(d);\n    const raw = (d as any).x;\n    return raw instanceof Date ? raw : new Date(raw);\n  }, [parseXProp]);\n\n  const xPad = xPadding ?? 6;\n  const yPad = yPadding ?? 6;\n\n  const xScale = React.useMemo(() => createXTimeScale(allData, parseX as any, [xPad, Math.max(0, innerWidth - xPad)]), [allData, parseX, innerWidth, xPad]);\n  const yScale = React.useMemo(() => {\n    if (yDomain) {\n      const scale = createYLinearScale([], (d: any) => d.y, [Math.max(0, innerHeight - yPad), yPad]);\n      scale.domain(yDomain);\n      return scale;\n    }\n    return createYLinearScale(allData, (d: any) => d.y, [Math.max(0, innerHeight - yPad), yPad]);\n  }, [allData, innerHeight, yDomain]);\n\n  const value: ScaleContextValue = React.useMemo(() => ({\n    xScale,\n    yScale,\n    getXTicks: (count = xTickCount) => xScale.ticks(count),\n    getYTicks: (count = yTickCount) => yScale.ticks(count)\n  }), [xScale, yScale, xTickCount, yTickCount]);\n\n  return <ScaleContext.Provider value={value}>{children}</ScaleContext.Provider>;\n};\n\nexport default ScaleContext;\n", "import * as React from 'react';\nimport { useScaleContext } from '../../core/ScaleContext';\nimport { useChartContext } from '../../core/ChartRoot';\n\nexport interface AxisProps {\n  type: 'x' | 'y';\n  scale?: any; // user-supplied override\n  tickCount?: number;\n  /** Explicit tick values; if provided overrides tickCount/ticks() generation */\n  tickValues?: any[];\n  formatTick?: (v: any) => string;\n  label?: string; // used for y\n  offset?: number; // x axis vertical offset (defaults to innerHeight)\n  className?: string;\n  /** Minimum pixel spacing between adjacent tick labels (x axis only). If labels would overlap, intermediate ticks are dropped. Default 0 (no filtering). */\n  minLabelSpacing?: number;\n  /** Truncate tick label text to this many characters (adds ellipsis). Full value kept in <title> for tooltip/a11y. */\n  maxTickLabelLength?: number;\n  /** Auto-compute a reasonable minLabelSpacing based on average label length if explicit minLabelSpacing not provided. */\n  autoMinLabelSpacing?: boolean;\n  /** Rotate x-axis tick labels (degrees). Negative leans left, positive right. */\n  labelAngle?: number;\n  /** If true, split labels containing \\n into multiple tspans (multi-line). */\n  allowLabelWrap?: boolean;\n  /** Preset date/time formatting helper (applies only if formatTick not provided). */\n  tickFormatPreset?: 'dayShortMonth' | 'dayShortMonthYear' | 'shortMonth' | 'shortMonthYear' | 'hourMinute';\n}\n\nexport const Axis: React.FC<AxisProps> = ({\n  type,\n  scale,\n  tickCount,\n  tickValues,\n  formatTick: rawFormatTick,\n  label,\n  offset,\n  className,\n  minLabelSpacing,\n  maxTickLabelLength,\n  autoMinLabelSpacing = type === 'x' ? true : false,\n  labelAngle = 0,\n  allowLabelWrap = true,\n  tickFormatPreset\n}) => {\n  const scaleCtx = useScaleContext();\n  const dims = useChartContext();\n  const resolvedScale = scale || (type === 'x' ? scaleCtx?.xScale : scaleCtx?.yScale);\n  const defaultCount = tickCount ?? (type === 'x' ? 6 : 5);\n  // Derive formatter from preset if provided and no explicit formatter\n  const hasUserFormatter = typeof rawFormatTick === 'function';\n  const presetFormatter: ((v: any) => string) | undefined = React.useMemo(() => {\n    if (hasUserFormatter) return undefined;\n    if (!tickFormatPreset) return undefined;\n    const dtf = (opts: Intl.DateTimeFormatOptions) => new Intl.DateTimeFormat(undefined, opts);\n    switch (tickFormatPreset) {\n      case 'dayShortMonth':\n        return (v: any) => {\n          const d = v instanceof Date ? v : new Date(v);\n          return `${d.getDate()}\\n${dtf({ month: 'short' }).format(d)}`;\n        };\n      case 'dayShortMonthYear':\n        return (v: any) => {\n          const d = v instanceof Date ? v : new Date(v);\n            return `${d.getDate()}\\n${dtf({ month: 'short' }).format(d)} ${d.getFullYear()}`;\n        };\n      case 'shortMonth':\n        return (v: any) => {\n          const d = v instanceof Date ? v : new Date(v);\n          return dtf({ month: 'short' }).format(d);\n        };\n      case 'shortMonthYear':\n        return (v: any) => {\n          const d = v instanceof Date ? v : new Date(v);\n          return `${dtf({ month: 'short' }).format(d)} ${d.getFullYear()}`;\n        };\n      case 'hourMinute':\n        return (v: any) => {\n          const d = v instanceof Date ? v : new Date(v);\n          return dtf({ hour: '2-digit', minute: '2-digit' }).format(d);\n        };\n      default:\n        return undefined;\n    }\n  }, [hasUserFormatter, tickFormatPreset]);\n  let effectiveFormatTick: (v:any)=>string = hasUserFormatter ? (rawFormatTick as (v:any)=>string) : (presetFormatter || ((v: any) => String(v)));\n  const ticks: any[] = React.useMemo(() => {\n    if (tickValues && Array.isArray(tickValues)) return tickValues;\n    if (!resolvedScale) return [];\n    if (typeof resolvedScale.ticks === 'function') return resolvedScale.ticks(defaultCount);\n    return resolvedScale.domain ? resolvedScale.domain() : [];\n  }, [resolvedScale, defaultCount, tickValues]);\n\n  // Auto date formatting heuristic for x-axis when using time scale and no user/preset format provided\n  if (type === 'x' && !hasUserFormatter && !tickFormatPreset && ticks.length && ticks.every(t => t instanceof Date)) {\n    const first = ticks[0] as Date;\n    const last = ticks[ticks.length - 1] as Date;\n    const spanMs = last.getTime() - first.getTime();\n    const oneDay = 24*3600*1000;\n    const oneYear = 365*oneDay;\n    const sameYear = first.getFullYear() === last.getFullYear();\n    const dtfMonth = new Intl.DateTimeFormat(undefined, { month: 'short' });\n    if (spanMs < 2*oneDay) {\n      const dtfTime = new Intl.DateTimeFormat(undefined, { hour: '2-digit', minute: '2-digit' });\n      effectiveFormatTick = (v:any) => dtfTime.format(v as Date);\n    } else if (spanMs < 32*oneDay) {\n      // Show day + short month\n      effectiveFormatTick = (v:any) => {\n        const d = v as Date; return `${d.getDate()} ${dtfMonth.format(d)}`;\n      };\n    } else if (spanMs < oneYear && sameYear) {\n      // Show short month (year implied)\n      effectiveFormatTick = (v:any) => dtfMonth.format(v as Date);\n    } else if (spanMs < 2*oneYear) {\n      // Show short month + year on first month of each year maybe; keep simple: Mon YYYY\n      const seenMonths = new Set<number>();\n      effectiveFormatTick = (v:any) => {\n        const d = v as Date; const key = d.getMonth();\n        if (!seenMonths.has(key)) { seenMonths.add(key); }\n        return `${dtfMonth.format(d)} ${d.getFullYear()}`;\n      };\n    } else {\n      // Multi-year span \u2013 show year only\n      effectiveFormatTick = (v:any) => String((v as Date).getFullYear());\n    }\n  }\n\n  if (!resolvedScale || !dims) return null;\n\n  if (type === 'x') {\n    const y = offset ?? dims.innerHeight;\n    const isBandScale = typeof (resolvedScale as any).bandwidth === 'function';\n    const bandwidth = isBandScale ? (resolvedScale as any).bandwidth() : 0;\n    const tickPos = (t: any) => {\n      const base = resolvedScale(t);\n      return isBandScale ? base + bandwidth / 2 : base;\n    };\n    // Determine min spacing (auto or explicit)\n    let resolvedMinSpacing = minLabelSpacing ?? 0;\n    if (autoMinLabelSpacing && (minLabelSpacing === undefined || minLabelSpacing === null)) {\n      // Approximate per-label pixel width = avg length * 6 (rough chars * px). Add padding.\n      const labels = ticks.map(t => effectiveFormatTick(t).replace(/\\n.*/g, '')); // first line only for width\n      const avgLen = labels.length ? labels.reduce((a,b)=>a+b.length,0)/labels.length : 0;\n      resolvedMinSpacing = Math.max(12, Math.round(avgLen * 6 + 4));\n    }\n    // Optionally filter ticks to avoid overlap based on pixel distance\n  const filteredTicks = React.useMemo(() => {\n      // If user supplied explicit tickValues we render them all (no auto thinning) to keep alignment with data points.\n      if (tickValues && Array.isArray(tickValues)) return ticks;\n      if (resolvedMinSpacing <= 0) return ticks;\n      const accepted: any[] = [];\n      let lastPos = -Infinity;\n      for (const t of ticks) {\n    const pos = tickPos(t);\n        if (pos - lastPos >= resolvedMinSpacing) {\n          accepted.push(t);\n          lastPos = pos;\n        }\n      }\n      return accepted;\n  }, [ticks, resolvedScale, resolvedMinSpacing, tickValues, isBandScale, bandwidth]);\n    return (\n  <g className={['fdp-axis','fdp-axis--x', className].filter(Boolean).join(' ')} transform={`translate(0,${y})`} fontFamily=\"var(--nhs-fdp-font-family-base, var(--fdp-chart-font-family))\">\n        <line x1={0} x2={dims.innerWidth} y1={0} y2={0} stroke=\"currentColor\" />\n        {filteredTicks.map((t, i) => {\n          const rawLabel = effectiveFormatTick(t);\n            const displayLabel = (maxTickLabelLength && rawLabel.length > maxTickLabelLength)\n              ? rawLabel.slice(0, Math.max(1, maxTickLabelLength - 1)) + '\u2026'\n              : rawLabel;\n          const lines = allowLabelWrap ? displayLabel.split(/\\n/) : [displayLabel.replace(/\\n/g,' ' )];\n          const anchor = labelAngle < 0 ? 'end' : labelAngle > 0 ? 'start' : 'middle';\n          return (\n      <g key={t?.toString?.() || i} transform={`translate(${tickPos(t)},0)`}>\n              <line y2={6} stroke=\"currentColor\" />\n              <text y={9} textAnchor={anchor} className=\"fdp-axis__tick\" dominantBaseline=\"hanging\" transform={labelAngle ? `rotate(${labelAngle})` : undefined} fontFamily=\"inherit\">\n                {lines.map((ln, li) => (\n                  <tspan key={li} x={0} dy={li===0?0:'1.1em'}>{ln}</tspan>\n                ))}\n                {displayLabel !== rawLabel && <title>{rawLabel}</title>}\n              </text>\n            </g>\n          );\n        })}\n      </g>\n    );\n  }\n\n  return (\n  <g className={['fdp-axis','fdp-axis--y', className].filter(Boolean).join(' ')} fontFamily=\"var(--nhs-fdp-font-family-base, var(--fdp-chart-font-family))\">\n      {ticks.map((t, i) => {\n        const rawLabel = effectiveFormatTick(t);\n        const displayLabel = (maxTickLabelLength && rawLabel.length > maxTickLabelLength)\n          ? rawLabel.slice(0, Math.max(1, maxTickLabelLength - 1)) + '\u2026'\n          : rawLabel;\n        const lines = allowLabelWrap ? displayLabel.split(/\\n/) : [displayLabel.replace(/\\n/g,' ')];\n        return (\n          <g key={t?.toString?.() || i} transform={`translate(0,${resolvedScale(t)})`}>\n            <line x2={-6} stroke=\"currentColor\" />\n            <text x={-9} dy=\"0.32em\" textAnchor=\"end\" className=\"fdp-axis__tick\" fontFamily=\"inherit\">\n              {lines.map((ln, li) => (\n                <tspan key={li} x={-9} dy={li===0?0:'1.1em'}>{ln}</tspan>\n              ))}\n              {displayLabel !== rawLabel && <title>{rawLabel}</title>}\n            </text>\n          </g>\n        );\n      })}\n      {label && (\n        <text transform=\"rotate(-90)\" x={-dims.innerHeight / 2} y={-dims.margin.left + 12} textAnchor=\"middle\" className=\"fdp-axis__label\" fontFamily=\"inherit\">{label}</text>\n      )}\n    </g>\n  );\n};\n\nexport default Axis;\n", "import * as React from 'react';\nimport { useScaleContext } from '../../core/ScaleContext';\nimport { useChartContext } from '../../core/ChartRoot';\n\nexport interface GridLinesProps {\n  axis?: 'x' | 'y'; // draw lines perpendicular to specified axis ticks (default y -> horizontal lines)\n  tickCount?: number;\n  stroke?: string;\n  dasharray?: string;\n  className?: string;\n}\n\nexport const GridLines: React.FC<GridLinesProps> = ({\n  axis = 'y',\n  tickCount,\n  stroke = 'var(--fdp-chart-grid,#e5e5e5)',\n  dasharray = '2 4',\n  className\n}) => {\n  const scaleCtx = useScaleContext();\n  const dims = useChartContext();\n  if (!scaleCtx || !dims) return null;\n  const ticks = axis === 'y' ? scaleCtx.getYTicks(tickCount) : scaleCtx.getXTicks(tickCount);\n  return (\n    <g className={['fdp-grid', className].filter(Boolean).join(' ')}>\n      {axis === 'y' && ticks.map((t, i) => (\n        <line key={i} x1={0} x2={dims.innerWidth} y1={scaleCtx.yScale(t)} y2={scaleCtx.yScale(t)} stroke={stroke} strokeDasharray={dasharray} />\n      ))}\n      {axis === 'x' && ticks.map((t, i) => (\n        <line key={i} y1={0} y2={dims.innerHeight} x1={scaleCtx.xScale(t)} x2={scaleCtx.xScale(t)} stroke={stroke} strokeDasharray={dasharray} />\n      ))}\n    </g>\n  );\n};\n\nexport default GridLines;\n", "import * as React from \"react\";\nimport { createLinePath } from \"../utils/scales\";\nimport { area as d3Area, curveMonotoneX } from \"d3-shape\";\nimport {\n\tpickSeriesColor,\n\tpickRegionColor,\n\tpickSeriesStroke,\n\tpickRegionStroke,\n} from \"../utils/colors\";\nimport { useScaleContext } from \"../core/ScaleContext\";\nimport { useVisibility } from \"../core/VisibilityContext\";\nimport { useTooltipContext } from \"../core/TooltipContext\";\n\nexport interface LineDatum {\n\tx: Date | string | number;\n\ty: number;\n}\nexport interface LineSeries {\n\tid: string;\n\tdata: LineDatum[];\n\tcolor?: string;\n\tlabel?: string;\n}\n\nexport interface LineSeriesPrimitiveProps {\n\tseries: LineSeries;\n\tseriesIndex: number;\n\tpalette: \"categorical\" | \"region\";\n\tshowPoints: boolean;\n\tfocusablePoints: boolean;\n\tfocusIndex: number;\n\t/** Provide parseX to avoid reallocation across series */\n\tparseX: (d: LineDatum) => Date;\n\t/** Presentation for hidden series (inherited via LineChart). */\n\tvisibilityMode?: \"remove\" | \"fade\";\n\t/** Custom stroke width for the series line (defaults to 1). */\n\tstrokeWidth?: number;\n\t/** Enable curve smoothing (monotoneX). Defaults to true. */\n\tsmooth?: boolean;\n\t/** Optional gradient fill id (linearGradient) for subtle wash under line. */\n\tgradientFillId?: string;\n}\n\n/** Low-level renderer for a single line series (no axes, assumes ScaleContext present). */\nexport const LineSeriesPrimitive: React.FC<LineSeriesPrimitiveProps> = ({\n\tseries,\n\tseriesIndex,\n\tpalette,\n\tshowPoints,\n\tfocusablePoints,\n\tfocusIndex,\n\tparseX,\n\tvisibilityMode = \"remove\",\n\tstrokeWidth = 1,\n\tsmooth = true,\n\tgradientFillId,\n}) => {\n\tconst scaleCtx = useScaleContext();\n\tif (!scaleCtx) return null; // safeguard\n\tconst { xScale, yScale } = scaleCtx;\n\tconst visibility = useVisibility();\n\tconst isHidden = visibility?.isHidden(series.id) ?? false;\n\tconst faded = isHidden && visibilityMode === \"fade\";\n\tif (isHidden && visibilityMode === \"remove\") {\n\t\treturn null;\n\t}\n\tconst tooltip = useTooltipContext();\n\n\t// Register series with tooltip context for nearest-point computation\n\tReact.useEffect(() => {\n\t\tif (!tooltip) return;\n\t\tconst normalized = series.data.map((d) => ({ x: parseX(d), y: d.y }));\n\t\ttooltip.registerSeries(series.id, normalized);\n\t\treturn () => tooltip.unregisterSeries(series.id);\n\t}, [tooltip, series.id, series.data, parseX]);\n\tconst path = React.useMemo(\n\t\t() =>\n\t\t\tcreateLinePath(\n\t\t\t\tseries.data,\n\t\t\t\t(d) => xScale(parseX(d)),\n\t\t\t\t(d) => yScale(d.y),\n\t\t\t\t{ smooth }\n\t\t\t),\n\t\t[series.data, xScale, yScale, parseX, smooth]\n\t);\n\t// Build an area path from the scale's lower domain bound (visual baseline) up to the series line so the gradient wash fills \"down\" fully.\n\tconst areaPath = React.useMemo(() => {\n\t\tif (!series.data.length) return \"\";\n\t\tconst [domainMin] = yScale.domain();\n\t\tconst gen = d3Area<LineDatum>()\n\t\t\t.x((d) => xScale(parseX(d)))\n\t\t\t.y0(() => yScale(domainMin))\n\t\t\t.y1((d) => yScale(d.y));\n\t\tif (smooth) gen.curve(curveMonotoneX);\n\t\treturn gen(series.data) || \"\";\n\t}, [series.data, xScale, yScale, parseX, smooth]);\n\tconst color =\n\t\tseries.color ||\n\t\t(palette === \"region\"\n\t\t\t? pickRegionColor(series.id, seriesIndex)\n\t\t\t: pickSeriesColor(seriesIndex));\n\tconst stroke =\n\t\tpalette === \"region\"\n\t\t\t? pickRegionStroke(series.id, seriesIndex)\n\t\t\t: pickSeriesStroke(seriesIndex);\n\n\treturn (\n\t\t<g\n\t\t\tclassName=\"fdp-line-series\"\n\t\t\tdata-series={series.id}\n\t\t\topacity={faded ? 0.25 : 1}\n\t\t\taria-hidden={faded ? true : undefined}\n\t\t>\n\t\t\t{gradientFillId && (\n\t\t\t\t<path\n\t\t\t\t\td={areaPath}\n\t\t\t\t\tfill={`url(#${gradientFillId})`}\n\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\trole=\"presentation\"\n\t\t\t\t\tclassName=\"fdp-line-series__gradient\"\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t<path\n\t\t\t\td={path}\n\t\t\t\tfill=\"none\"\n\t\t\t\tstroke={color}\n\t\t\t\tstrokeWidth={strokeWidth}\n\t\t\t\trole=\"presentation\"\n\t\t\t/>\n\t\t\t{showPoints &&\n\t\t\t\tseries.data.map((d, di) => {\n\t\t\t\t\tconst cx = xScale(parseX(d));\n\t\t\t\t\tconst cy = yScale(d.y);\n\t\t\t\t\tconst tabIndex = focusablePoints ? 0 : -1;\n\t\t\t\t\tconst isFocusedPoint =\n\t\t\t\t\t\t!faded &&\n\t\t\t\t\t\t((focusablePoints && di === focusIndex) ||\n\t\t\t\t\t\t\t(tooltip?.focused?.seriesId === series.id &&\n\t\t\t\t\t\t\t\ttooltip.focused.index === di));\n\t\t\t\t\tconst handleEnter = () => {\n\t\t\t\t\t\tif (tooltip && !faded) {\n\t\t\t\t\t\t\ttooltip.setFocused({\n\t\t\t\t\t\t\t\tseriesId: series.id,\n\t\t\t\t\t\t\t\tindex: di,\n\t\t\t\t\t\t\t\tx: parseX(d),\n\t\t\t\t\t\t\t\ty: d.y,\n\t\t\t\t\t\t\t\tclientX: cx,\n\t\t\t\t\t\t\t\tclientY: cy,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tconst handleLeave = () => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\ttooltip &&\n\t\t\t\t\t\t\ttooltip.focused?.seriesId === series.id &&\n\t\t\t\t\t\t\ttooltip.focused.index === di\n\t\t\t\t\t\t)\n\t\t\t\t\t\t\ttooltip.clear();\n\t\t\t\t\t};\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<circle\n\t\t\t\t\t\t\tkey={di}\n\t\t\t\t\t\t\tcx={cx}\n\t\t\t\t\t\t\tcy={cy}\n\t\t\t\t\t\t\tr={isFocusedPoint ? 5 : 3.5}\n\t\t\t\t\t\t\tstroke={\n\t\t\t\t\t\t\t\tisFocusedPoint\n\t\t\t\t\t\t\t\t\t? \"var(--nhs-fdp-color-primary-yellow, #ffeb3b)\"\n\t\t\t\t\t\t\t\t\t: stroke\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tstrokeWidth={isFocusedPoint ? 2 : 1}\n\t\t\t\t\t\t\tfill={\n\t\t\t\t\t\t\t\tisFocusedPoint ? \"var(--nhs-fdp-color-grey-3, #aeb7bd)\" : color\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tclassName=\"fdp-line-point\"\n\t\t\t\t\t\t\ttabIndex={faded ? -1 : tabIndex}\n\t\t\t\t\t\t\taria-label={`${series.label || series.id} ${parseX(d).toDateString()} value ${d.y}`}\n\t\t\t\t\t\t\tdata-series={series.id}\n\t\t\t\t\t\t\tdata-index={di}\n\t\t\t\t\t\t\tonMouseEnter={handleEnter}\n\t\t\t\t\t\t\tonFocus={handleEnter}\n\t\t\t\t\t\t\tonMouseLeave={handleLeave}\n\t\t\t\t\t\t\tonBlur={handleLeave}\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t</g>\n\t);\n};\n\nexport default LineSeriesPrimitive;\n", "{\n  \"color\": {\n    \"data-viz\": {\n      \"$type\": \"color\",\n      \"categorical\": {\n        \"1\": { \"$value\": \"{color.primary.blue}\", \"$description\": \"Series 1 \u2013 NHS Blue (brand core)\" },\n        \"2\": { \"$value\": \"#41B6E6\", \"$description\": \"Series 2 \u2013 NHS Light Blue (new)\" },\n        \"3\": { \"$value\": \"{color.secondary.aqua-green}\", \"$description\": \"Series 3 \u2013 NHS Aqua Green (existing)\" },\n        \"4\": { \"$value\": \"#78BE20\", \"$description\": \"Series 4 \u2013 NHS Light Green (new)\" },\n        \"5\": { \"$value\": \"{color.primary.green}\", \"$description\": \"Series 5 \u2013 NHS Green (existing)\" },\n        \"6\": { \"$value\": \"{color.secondary.warm-yellow}\", \"$description\": \"Series 6 \u2013 NHS Warm Yellow (existing; distinct from focus yellow)\" },\n        \"7\": { \"$value\": \"#ED4F00\", \"$description\": \"Series 7 \u2013 NHS Tangerine (new; warmer/deeper than existing orange)\" },\n        \"8\": { \"$value\": \"{color.secondary.pink}\", \"$description\": \"Series 8 \u2013 NHS Pink (existing)\" },\n        \"9\": { \"$value\": \"#E317AA\", \"$description\": \"Series 9 \u2013 NHS Bright Pink (new vivid accent)\" },\n        \"10\": { \"$value\": \"#880FB8\", \"$description\": \"Series 10 \u2013 NHS Light Purple (new mid purple)\" },\n        \"11\": { \"$value\": \"{color.primary.purple}\", \"$description\": \"Series 11 \u2013 NHS Purple (existing dark purple)\" },\n        \"12\": { \"$value\": \"#9A6324\", \"$description\": \"Series 12 \u2013 NHS Brown (new; earth neutral)\" }\n      },\n      \"neutral\": {\n        \"comparison\": { \"$value\": \"{color.grey.1}\", \"$description\": \"Neutral comparison series (optional)\" }\n      },\n      \"region\": {\n        \"$comment\": \"Fixed colours for NHS geographical regions; prefer stable mapping for maps. London colour updated (#78BE21 \u2013 light green).\",\n        \"north-east\": { \"$value\": \"{color.primary.blue}\", \"$description\": \"North East \u2013 NHS Blue\" },\n        \"north-west\": { \"$value\": \"#41B6E6\", \"$description\": \"North West \u2013 NHS Light Blue\" },\n        \"east-of-england\": { \"$value\": \"{color.primary.purple}\", \"$description\": \"East of England \u2013 NHS Purple\" },\n        \"midlands\": { \"$value\": \"{color.secondary.pink}\", \"$description\": \"Midlands \u2013 NHS Pink\" },\n  \t\t\"london\": { \"$value\": \"#78BE21\", \"$description\": \"London \u2013 NHS Light Green (new)\" },\n        \"south-west\": { \"$value\": \"#FAE100\", \"$description\": \"South West \u2013 NHS Yellow variant (new)\" },\n        \"south-east\": { \"$value\": \"#ed8b00\", \"$description\": \"South East \u2013 NHS Orange (existing base orange)\" }\n      },\n      \"severity\": {\n        \"$comment\": \"Semantic severity / alert colours (light background ramp \u2192 critical).\",\n        \"low\": { \"$value\": \"{color.secondary.pale-yellow}\", \"$description\": \"Low severity \u2013 pale yellow background\" },\n        \"moderate\": { \"$value\": \"{color.secondary.warm-yellow}\", \"$description\": \"Moderate severity \u2013 warm yellow\" },\n        \"high\": { \"$value\": \"{color.secondary.orange}\", \"$description\": \"High severity \u2013 orange\" },\n        \"critical\": { \"$value\": \"{color.primary.red}\", \"$description\": \"Critical severity \u2013 red\" }\n      },\n      \"org-level\": {\n        \"$comment\": \"Organisational level semantic colours (stable NHS brand mappings).\",\n        \"trust\": { \"$value\": \"{color.primary.blue}\", \"$description\": \"Trust \u2013 NHS Blue\" },\n        \"ambulance\": { \"$value\": \"{color.primary.green}\", \"$description\": \"Ambulance \u2013 NHS Green\" },\n        \"icb\": { \"$value\": \"{color.primary.dark-pink}\", \"$description\": \"ICB \u2013 NHS Dark Pink\" },\n        \"region\": { \"$value\": \"{color.primary.purple}\", \"$description\": \"Region \u2013 NHS Purple\" }\n      },\n      \"stroke\": {\n        \"$comment\": \"Automatic contrast stroke colours for overlays / borders. Light fills get dark stroke; dark fills get white stroke.\",\n        \"categorical\": {\n          \"1\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for series 1 (blue)\" },\n          \"2\": { \"$value\": \"#212b32\", \"$description\": \"Stroke for series 2 (light blue)\" },\n          \"3\": { \"$value\": \"#212b32\", \"$description\": \"Stroke for series 3 (aqua green)\" },\n          \"4\": { \"$value\": \"#212b32\", \"$description\": \"Stroke for series 4 (light green)\" },\n          \"5\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for series 5 (green)\" },\n          \"6\": { \"$value\": \"#212b32\", \"$description\": \"Stroke for series 6 (warm yellow)\" },\n          \"7\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for series 7 (tangerine)\" },\n          \"8\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for series 8 (pink)\" },\n          \"9\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for series 9 (bright pink)\" },\n          \"10\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for series 10 (light purple)\" },\n          \"11\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for series 11 (purple)\" },\n          \"12\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for series 12 (brown)\" }\n        },\n        \"region\": {\n          \"$comment\": \"Region stroke colours derived from fill colours: dark fills lightened ~35%; light fills darkened ~25% for consistent contrast without defaulting to pure white/black.\",\n          \"north-east\": { \"$value\": \"#5996D1\", \"$description\": \"Stroke for North East (blue lightened 35%)\" },\n          \"north-west\": { \"$value\": \"#3189AD\", \"$description\": \"Stroke for North West (light blue darkened 25%)\" },\n          \"east-of-england\": { \"$value\": \"#7A59A3\", \"$description\": \"Stroke for East of England (purple lightened 35%)\" },\n          \"midlands\": { \"$value\": \"#CA71A4\", \"$description\": \"Stroke for Midlands (pink lightened 35%)\" },\n          \"london\": { \"$value\": \"#5A8F19\", \"$description\": \"Stroke for London (light green darkened 25%)\" },\n          \"south-west\": { \"$value\": \"#BCA900\", \"$description\": \"Stroke for South West (yellow darkened 25%)\" },\n          \"south-east\": { \"$value\": \"#B26800\", \"$description\": \"Stroke for South East (orange darkened 25%)\" }\n        },\n        \"severity\": {\n          \"$comment\": \"Contrast strokes for severity colours (light backgrounds use dark stroke; dark backgrounds use white).\",\n          \"low\": { \"$value\": \"#212b32\", \"$description\": \"Stroke for low severity (pale yellow fill)\" },\n          \"moderate\": { \"$value\": \"#212b32\", \"$description\": \"Stroke for moderate severity (warm yellow fill)\" },\n          \"high\": { \"$value\": \"#212b32\", \"$description\": \"Stroke for high severity (orange fill)\" },\n          \"critical\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for critical severity (red fill)\" }\n        },\n        \"org-level\": {\n          \"$comment\": \"Contrast strokes for organisational level colours (all dark brand fills so white stroke for consistency).\",\n          \"trust\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for trust (blue fill)\" },\n          \"ambulance\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for ambulance (green fill)\" },\n          \"icb\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for ICB (dark pink fill)\" },\n          \"region\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for region (purple fill)\" }\n        }\n      }\n      ,\n      \"spc\": {\n        \"$comment\": \"SPC (Statistical Process Control) semantic variation colours aligned to SPCChart.scss and SPCIcons.\",\n        \"improvement\": { \"$value\": \"#00B0F0\", \"$description\": \"SPC special cause improvement (favourable)\" },\n        \"concern\": { \"$value\": \"#E46C0A\", \"$description\": \"SPC special cause concern (deteriorating)\" },\n        \"no-judgement\": { \"$value\": \"#490092\", \"$description\": \"SPC special cause (no directional judgement)\" },\n        \"common-cause\": { \"$value\": \"#A6A6A6\", \"$description\": \"SPC common cause (baseline variation)\" },\n        \"assurance-pass\": { \"$value\": \"#00823B\", \"$description\": \"SPC assurance pass indicator (process capable)\" },\n        \"assurance-fail\": { \"$value\": \"#DA291C\", \"$description\": \"SPC assurance fail indicator (process not capable)\" },\n        \"gradient\": {\n          \"$comment\": \"Opacity stops for SPC icon gradient wash (applied top-left -> bottom-right). Consumers build gradients using these opacities + base colour.\",\n          \"stop\": {\n            \"start-opacity\": { \"$value\": \"0.18\", \"$description\": \"Start stop opacity (0%) for classic variant wash\" },\n            \"mid-opacity\": { \"$value\": \"0.06\", \"$description\": \"Mid stop opacity (~65-75%)\" },\n            \"end-opacity\": { \"$value\": \"0\", \"$description\": \"End stop opacity (100%)\" },\n            \"triangle-start-opacity\": { \"$value\": \"0.18\", \"$description\": \"Start opacity for triangle variants (kept aligned)\" },\n            \"triangle-mid-opacity\": { \"$value\": \"0.06\", \"$description\": \"Mid opacity for triangle variants\" },\n            \"triangle-end-opacity\": { \"$value\": \"0\", \"$description\": \"End opacity for triangle variants\" }\n          }\n        },\n        \"stroke\": {\n          \"$comment\": \"Contrast stroke colours for SPC variation fills.\",\n          \"improvement\": { \"$value\": \"#000000\", \"$description\": \"Stroke for improvement points\" },\n          \"concern\": { \"$value\": \"#000000\", \"$description\": \"Stroke for concern points\" },\n          \"no-judgement\": { \"$value\": \"#000000\", \"$description\": \"Stroke for no-judgement points\" },\n          \"common-cause\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for common cause points\" },\n          \"assurance-pass\": { \"$value\": \"#000000\", \"$description\": \"Stroke for assurance pass points\" },\n          \"assurance-fail\": { \"$value\": \"#000000\", \"$description\": \"Stroke for assurance fail points\" }\n        }\n      }\n    }\n  }\n}\n", "{\n  \"color\": {\n\t\"primary\": {\n\t  \"$type\": \"color\",\n\t  \"blue\": {\n\t\t\"$value\": \"#005eb8\",\n\t\t\"$description\": \"NHS Blue - Primary brand color\"\n\t  },\n\t  \"blue-active\": {\n\t\t\"$value\": \"#002f5c\",\n\t\t\"$description\": \"NHS Active Blue (50% shade) \u2013 alias of button/login active; promoted for general reuse\"\n\t  },\n\t  \"white\": {\n\t\t\"$value\": \"#ffffff\",\n\t\t\"$description\": \"NHS White\"\n\t  },\n\t  \"black\": {\n\t\t\"$value\": \"#212b32\",\n\t\t\"$description\": \"NHS Black\"\n\t  },\n\t  \"green\": {\n\t\t\"$value\": \"#007f3b\",\n\t\t\"$description\": \"NHS Green\"\n\t  },\n\t  \"purple\": {\n\t\t\"$value\": \"#330072\",\n\t\t\"$description\": \"NHS Purple\"\n\t  },\n\t  \"dark-pink\": {\n\t\t\"$value\": \"#7c2855\",\n\t\t\"$description\": \"NHS Dark Pink\"\n\t  },\n\t  \"red\": {\n\t\t\"$value\": \"#d5281b\",\n\t\t\"$description\": \"NHS Red\"\n\t  },\n\t  \"light-purple\": {\n\t\t\"$value\": \"#880FB8\",\n\t\t\"$description\": \"NHS Light Purple (data viz promoted)\"\n\t  },\n\t  \"yellow\": {\n\t\t\"$value\": \"#ffeb3b\",\n\t\t\"$description\": \"NHS Yellow\"\n\t  }\n\t},\n\t\"secondary\": {\n\t  \"$type\": \"color\",\n\t  \"pale-yellow\": {\n\t\t\"$value\": \"#fff9c4\",\n\t\t\"$description\": \"NHS Pale Yellow\"\n\t  },\n\t  \"warm-yellow\": {\n\t\t\"$value\": \"#ffb81c\",\n\t\t\"$description\": \"NHS Warm Yellow\"\n\t  },\n\t  \"region-yellow\": {\n\t\t\"$value\": \"#FAE100\",\n\t\t\"$description\": \"NHS Region Yellow (maps)\"\n\t  },\n\t  \"orange\": {\n\t\t\"$value\": \"#ed8b00\",\n\t\t\"$description\": \"NHS Orange\"\n\t  },\n\t  \"tangerine\": {\n\t\t\"$value\": \"#ED4F00\",\n\t\t\"$description\": \"NHS Tangerine (data viz promoted)\"\n\t  },\n\t  \"aqua-green\": {\n\t\t\"$value\": \"#00a499\",\n\t\t\"$description\": \"NHS Aqua Green\"\n\t  },\n\t  \"light-blue\": {\n\t\t\"$value\": \"#41B6E6\",\n\t\t\"$description\": \"NHS Light Blue (data viz promoted)\"\n\t  },\n\t  \"pink\": {\n\t\t\"$value\": \"#ae2573\",\n\t\t\"$description\": \"NHS Pink\"\n\t  },\n\t  \"bright-pink\": {\n\t\t\"$value\": \"#E317AA\",\n\t\t\"$description\": \"NHS Bright Pink (data viz promoted)\"\n\t  },\n\t  \"light-green\": {\n\t\t\"$value\": \"#78BE20\",\n\t\t\"$description\": \"NHS Light Green (data viz promoted)\"\n\t  },\n\t  \"brown\": {\n\t\t\"$value\": \"#9A6324\",\n\t\t\"$description\": \"NHS Brown (data viz promoted neutral)\"\n\t  }\n\t},\n\t\"grey\": {\n\t  \"$type\": \"color\",\n\t  \"1\": {\n\t\t\"$value\": \"#4c6272\",\n\t\t\"$description\": \"NHS Grey 1 - Darkest grey\"\n\t  },\n\t  \"2\": {\n\t\t\"$value\": \"#768692\",\n\t\t\"$description\": \"NHS Grey 2 - Darker grey\"\n\t  },\n\t  \"3\": {\n\t\t\"$value\": \"#aeb7bd\",\n\t\t\"$description\": \"NHS Grey 3 - Medium grey\"\n\t  },\n\t  \"4\": {\n\t\t\"$value\": \"#d8dde0\",\n\t\t\"$description\": \"NHS Grey 4 - Light grey\"\n\t  },\n\t  \"5\": {\n\t\t\"$value\": \"#f0f4f5\",\n\t\t\"$description\": \"NHS Grey 5 - Lightest grey\"\n\t  }\n\t},\n\t\"accessibility\": {\n\t  \"$type\": \"color\",\n\t  \"$comment\": \"Accessibility-oriented color tokens. Includes CVD-safe pairs and Okabe\u2013Ito colors. Use these for positive/negative semantics and colour-blind\u2013friendly defaults.\",\n\t  \"okabe-ito\": {\n\t\t\"green\": {\n\t\t  \"$value\": \"#009E73\",\n\t\t  \"$description\": \"Okabe\u2013Ito green (CVD-safe) \u2013 recommended positive\"\n\t\t},\n\t\t\"vermillion\": {\n\t\t  \"$value\": \"#D55E00\",\n\t\t  \"$description\": \"Okabe\u2013Ito vermillion / red\u2013orange (CVD-safe) \u2013 recommended negative\"\n\t\t}\n\t  },\n\t  \"cvd-safe\": {\n\t\t\"blue\": {\n\t\t  \"$value\": \"#1f77b4\",\n\t\t  \"$description\": \"CVD-safe blue (pairs with orange); widely used in Matplotlib/Tableau sets\"\n\t\t},\n\t\t\"orange\": {\n\t\t  \"$value\": \"#ff7f0e\",\n\t\t  \"$description\": \"CVD-safe orange (pairs with blue)\"\n\t\t}\n\t  },\n\t  \"positive\": {\n\t\t\"$value\": \"{color.accessibility.okabe-ito.green}\",\n\t\t\"$description\": \"Accessibility semantic alias \u2013 positive\"\n\t  },\n\t  \"negative\": {\n\t\t\"$value\": \"{color.accessibility.okabe-ito.vermillion}\",\n\t\t\"$description\": \"Accessibility semantic alias \u2013 negative\"\n\t  }\n\t}\n  }\n}\n", "// Attempt to source colours from design tokens (data-viz categorical 1..12).\n// We now use static ESM JSON imports (TS resolveJsonModule) so build will surface errors\n// instead of silently swallowing them with dynamic require.\n\nimport dataVizTokens from '../../../../packages/nhs-fdp/tokens/data-viz.json';\nimport colorTokens from '../../../../packages/nhs-fdp/tokens/colors.json';\n\n// Legacy fallback (previous implementation) \u2013 retained to avoid breaking consumers\nconst legacyCategorical = [\n  '#005eb8', '#0072ce', '#41b6e6', '#00a499',\n  '#7c2855', '#330072', '#d5281b', '#ffb81c',\n  '#fae100', '#4c6272', '#768692', '#aeb7bd'\n];\n\nlet categoricalPalette: string[] | null = null;\nlet optimizedCategoricalPalette: string[] | null = null; // reordered for maximal early distinctness\nlet extendedPaletteCache: string[] | null = null; // cache including generated variants beyond base length\n\ntype CategoricalStrategy = 'optimized' | 'raw';\nlet categoricalStrategy: CategoricalStrategy = 'optimized';\n\nexport function setCategoricalColorStrategy(strategy: CategoricalStrategy) {\n  categoricalStrategy = strategy;\n}\nexport function getCategoricalColorStrategy(): CategoricalStrategy { return categoricalStrategy; }\n\nfunction buildPalette(): string[] {\n  const root: any = { color: { ...(colorTokens as any).color, ...(dataVizTokens as any).color } };\n\n    const resolve = (path: string, seen: Set<string> = new Set()): string | undefined => {\n      if (seen.has(path)) return undefined; // circular guard\n      seen.add(path);\n      const node = path.split('.').reduce((acc: any, k) => (acc ? acc[k] : undefined), root);\n      if (!node) return undefined;\n      const value = node.$value || node.value; // support raw & built forms\n      if (typeof value === 'string' && /^\\{.+\\}$/.test(value)) {\n        return resolve(value.slice(1, -1), seen);\n      }\n      if (typeof value === 'string') return value;\n      return undefined;\n    };\n\n    const palette: string[] = [];\n    try {\n      for (let i = 1; i <= 12; i++) {\n        const tokenPath = `color.data-viz.categorical.${i}`;\n        const hex = resolve(tokenPath);\n        if (!hex) throw new Error(`Missing token ${tokenPath}`);\n        palette.push(hex);\n      }\n      return palette;\n    } catch (e) {\n      return legacyCategorical; // hard fallback if tokens unexpectedly incomplete\n    }\n}\n\nfunction getPalette(): string[] {\n  if (!categoricalPalette) categoricalPalette = buildPalette();\n  return categoricalPalette;\n}\n\n// --- Perceptual distinctness optimisation (CIE Lab farthest-point sampling) ---\n// We keep this lightweight (no external deps) with approximate conversions; sufficient for ordering.\ninterface Lab { L: number; a: number; b: number }\n\nfunction hexToRgb(hex: string): { r: number; g: number; b: number } | null {\n  const m = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex.trim());\n  if (!m) return null;\n  return { r: parseInt(m[1], 16), g: parseInt(m[2], 16), b: parseInt(m[3], 16) };\n}\n\n// sRGB -> linear\nfunction srgbToLinear(x: number): number { x /= 255; return x <= 0.04045 ? x / 12.92 : Math.pow((x + 0.055) / 1.055, 2.4); }\n\nfunction rgbToXyz(r: number, g: number, b: number): { x: number; y: number; z: number } {\n  const R = srgbToLinear(r); const G = srgbToLinear(g); const B = srgbToLinear(b);\n  // Observer = 2\u00B0, Illuminant = D65\n  const x = R * 0.4124 + G * 0.3576 + B * 0.1805;\n  const y = R * 0.2126 + G * 0.7152 + B * 0.0722;\n  const z = R * 0.0193 + G * 0.1192 + B * 0.9505;\n  return { x: x * 100, y: y * 100, z: z * 100 };\n}\n\nfunction xyzToLab(x: number, y: number, z: number): Lab {\n  // D65 reference white\n  const refX = 95.047, refY = 100.0, refZ = 108.883;\n  let X = x / refX, Y = y / refY, Z = z / refZ;\n  const f = (t: number) => (t > 0.008856 ? Math.cbrt(t) : (7.787 * t) + 16 / 116);\n  X = f(X); Y = f(Y); Z = f(Z);\n  return { L: (116 * Y) - 16, a: 500 * (X - Y), b: 200 * (Y - Z) };\n}\n\nfunction hexToLab(hex: string): Lab | null {\n  const rgb = hexToRgb(hex);\n  if (!rgb) return null;\n  const xyz = rgbToXyz(rgb.r, rgb.g, rgb.b);\n  return xyzToLab(xyz.x, xyz.y, xyz.z);\n}\n\nfunction deltaE76(c1: Lab, c2: Lab): number {\n  const dL = c1.L - c2.L; const da = c1.a - c2.a; const db = c1.b - c2.b;\n  return Math.sqrt(dL * dL + da * da + db * db);\n}\n\nfunction buildOptimizedCategoricalPalette(): string[] {\n  const base = getPalette();\n  if (base.length <= 2) return base.slice();\n  const labs = base.map(c => hexToLab(c));\n  // Farthest-point sampling: start with colour having max average distance (more central choice) to others.\n  let bestStartIdx = 0; let bestAvg = -1;\n  for (let i = 0; i < base.length; i++) {\n    const li = labs[i]; if (!li) continue;\n    let total = 0; let count = 0;\n    for (let j = 0; j < base.length; j++) if (i !== j && labs[j]) { total += deltaE76(li, labs[j]!); count++; }\n    const avg = total / Math.max(1, count);\n    if (avg > bestAvg) { bestAvg = avg; bestStartIdx = i; }\n  }\n  const remaining = new Set<number>(base.map((_, i) => i));\n  const order: number[] = [];\n  order.push(bestStartIdx); remaining.delete(bestStartIdx);\n  while (remaining.size) {\n    let nextIdx = Array.from(remaining)[0];\n    let bestMin = -1;\n    for (const idx of remaining) {\n      const l = labs[idx]; if (!l) continue;\n      // Distance to closest already-picked colour\n      let minD = Infinity;\n      for (const o of order) {\n        const lo = labs[o]; if (lo) { const d = deltaE76(l, lo); if (d < minD) minD = d; }\n      }\n      if (minD > bestMin) { bestMin = minD; nextIdx = idx; }\n    }\n    order.push(nextIdx); remaining.delete(nextIdx);\n  }\n  return order.map(i => base[i]);\n}\n\nfunction getOptimizedPalette(): string[] {\n  if (!optimizedCategoricalPalette) optimizedCategoricalPalette = buildOptimizedCategoricalPalette();\n  return optimizedCategoricalPalette;\n}\n\nfunction getRawPalette(): string[] { return getPalette(); }\n\n// --- Extended palette generation for > base length ---\n// Creates lightened/darkened variants per base colour cycle while attempting to keep DeltaE separation.\ninterface RGB { r:number; g:number; b:number }\nfunction labToXyz(L:number,a:number,b:number){\n  const y = (L + 16) / 116; const x = a / 500 + y; const z = y - b / 200;\n  const f = (t:number)=>{ const t3 = t*t*t; return t3 > 0.008856 ? t3 : (t - 16/116)/7.787; };\n  const X = f(x) * 95.047; const Y = f(y) * 100; const Z = f(z) * 108.883; return {X,Y,Z};\n}\nfunction xyzToRgb(x:number,y:number,z:number): RGB {\n  x/=100; y/=100; z/=100;\n  let R = x*3.2406 + y*-1.5372 + z*-0.4986;\n  let G = x*-0.9689 + y*1.8758 + z*0.0415;\n  let B = x*0.0557 + y*-0.2040 + z*1.0570;\n  const linToSrgb = (c:number)=> c <= 0.0031308 ? 12.92*c : 1.055*Math.pow(c,1/2.4)-0.055;\n  R = Math.min(1, Math.max(0, linToSrgb(R)));\n  G = Math.min(1, Math.max(0, linToSrgb(G)));\n  B = Math.min(1, Math.max(0, linToSrgb(B)));\n  return { r: Math.round(R*255), g: Math.round(G*255), b: Math.round(B*255) };\n}\nfunction rgbToHex(r:number,g:number,b:number){ return `#${[r,g,b].map(v=>v.toString(16).padStart(2,'0')).join('')}`; }\nfunction adjustLightness(hex:string, deltaL:number): string {\n  const lab = hexToLab(hex); if(!lab) return hex;\n  const L = Math.min(100, Math.max(0, lab.L + deltaL));\n  const {X,Y,Z} = labToXyz(L, lab.a, lab.b);\n  const rgb = xyzToRgb(X,Y,Z);\n  return rgbToHex(rgb.r,rgb.g,rgb.b);\n}\n\nfunction buildExtendedPalette(): string[] {\n  const base = categoricalStrategy === 'raw' ? getRawPalette() : getOptimizedPalette();\n  // Precompute a couple of variant rounds (lighten, darken, lighten+, darken+)\n  const deltas = [12, -12, 24, -24];\n  const variants: string[][] = deltas.map(d => base.map(c => adjustLightness(c, d)));\n  // Interleave: base first, then for each variant level append its colours in optimized order.\n  const extended: string[] = [...base];\n  variants.forEach(v => extended.push(...v));\n  return extended;\n}\n\nfunction getExtendedPalette(): string[] {\n  if (!extendedPaletteCache || extendedPaletteCacheStrategyMismatch()) {\n    extendedPaletteCache = buildExtendedPalette();\n    lastExtendedStrategy = categoricalStrategy;\n  }\n  return extendedPaletteCache;\n}\nlet lastExtendedStrategy: CategoricalStrategy | null = null;\nfunction extendedPaletteCacheStrategyMismatch() { return lastExtendedStrategy !== categoricalStrategy; }\n\nexport function pickSeriesColor(i: number) {\n  const ext = getExtendedPalette();\n  return ext[i % ext.length];\n}\n\n// Export for potential external inspection/testing\nexport function getCategoricalPalette(): string[] { return [...getPalette()]; }\nexport function getOptimizedCategoricalPalette(): string[] { return [...getOptimizedPalette()]; }\nexport function getRawCategoricalPalette(): string[] { return [...getRawPalette()]; }\nexport function getExtendedCategoricalPalette(): string[] { return [...getExtendedPalette()]; }\n\n// Stroke (contrast outline) tokens\nlet categoricalStrokeMap: string[] | null = null;\nlet regionStrokeMap: Record<string,string> | null = null;\nlet severityStrokeMap: Record<string,string> | null = null;\nlet orgLevelStrokeMap: Record<string,string> | null = null;\n\nfunction buildStrokeMaps() {\n  const stroke = (dataVizTokens as any)?.color?.['data-viz']?.stroke;\n  if (stroke) {\n    const cat = stroke.categorical || {};\n    categoricalStrokeMap = [];\n    for (let i=1;i<=12;i++) {\n      const v = cat[String(i)]?.$value || cat[String(i)]?.value;\n      categoricalStrokeMap.push(typeof v === 'string' ? v : '#212b32');\n    }\n    const reg = stroke.region || {};\n    regionStrokeMap = {};\n    Object.keys(reg).forEach(k => {\n      const v = reg[k]?.$value || reg[k]?.value;\n      if (typeof v === 'string') regionStrokeMap![k] = v;\n    });\n    const sev = stroke.severity || {};\n    const org = stroke['org-level'] || {};\n    orgLevelStrokeMap = {};\n    Object.keys(org).forEach(k => {\n      const v = org[k]?.$value || org[k]?.value;\n      if (typeof v === 'string') orgLevelStrokeMap![k] = v;\n    });\n    severityStrokeMap = {};\n    Object.keys(sev).forEach(k => {\n      const v = sev[k]?.$value || sev[k]?.value;\n      if (typeof v === 'string') severityStrokeMap![k] = v;\n    });\n  }\n}\n\nfunction ensureStrokeMaps() {\n  if (!categoricalStrokeMap || !regionStrokeMap || !severityStrokeMap || !orgLevelStrokeMap) buildStrokeMaps();\n}\n\nexport function pickSeriesStroke(i: number) {\n  ensureStrokeMaps();\n  if (!categoricalStrokeMap) return '#212b32';\n  return categoricalStrokeMap[i % categoricalStrokeMap.length];\n}\n\nexport function getRegionStroke(id: string): string | undefined {\n  ensureStrokeMaps();\n  return regionStrokeMap ? regionStrokeMap[id] : undefined;\n}\n\nexport function pickRegionStroke(id: string, fallbackIndex: number): string {\n  return getRegionStroke(id) || pickSeriesStroke(fallbackIndex);\n}\n\n// Severity colours \u2013 semantic alert levels\nexport const SEVERITY_IDS = [ 'low', 'moderate', 'high', 'critical' ] as const;\nexport type SeverityId = typeof SEVERITY_IDS[number];\nlet severityMap: Record<string,string> | null = null;\n\nfunction buildSeverityMap(): Record<string,string> {\n  const root: any = { color: { ...(colorTokens as any).color, ...(dataVizTokens as any).color } };\n  const resolve = (path: string, seen: Set<string> = new Set()): string | undefined => {\n    if (seen.has(path)) return undefined;\n    seen.add(path);\n    const node = path.split('.').reduce((acc: any, k) => (acc ? acc[k] : undefined), root);\n    if (!node) return undefined;\n    const value = node.$value || node.value;\n    if (typeof value === 'string' && /^\\{.+\\}$/.test(value)) return resolve(value.slice(1,-1), seen);\n    return typeof value === 'string' ? value : undefined;\n  };\n  const map: Record<string,string> = {};\n  SEVERITY_IDS.forEach(id => {\n    const hex = resolve(`color.data-viz.severity.${id}`);\n    if (hex) map[id] = hex;\n  });\n  return map;\n}\n\nfunction getSeverityMap(): Record<string,string> { if (!severityMap) severityMap = buildSeverityMap(); return severityMap; }\nexport function getSeverityColor(id: string): string | undefined { return getSeverityMap()[id.toLowerCase()]; }\nexport function pickSeverityColor(id: string, fallbackIndex: number): string {\n  return getSeverityColor(id) || getSeverityMap()[SEVERITY_IDS[fallbackIndex % SEVERITY_IDS.length]] || pickSeriesColor(fallbackIndex);\n}\nexport function getSeverityStroke(id: string): string | undefined { ensureStrokeMaps(); return severityStrokeMap ? severityStrokeMap[id] : undefined; }\nexport function pickSeverityStroke(id: string, fallbackIndex: number): string {\n  return getSeverityStroke(id) || pickSeriesStroke(fallbackIndex);\n}\n\n// Org-level colours (trust, ambulance, icb, region)\nexport const ORG_LEVEL_IDS = [ 'trust', 'ambulance', 'icb', 'region' ] as const;\nexport type OrgLevelId = typeof ORG_LEVEL_IDS[number];\nlet orgLevelMap: Record<string,string> | null = null;\n\nfunction buildOrgLevelMap(): Record<string,string> {\n  const root: any = { color: { ...(colorTokens as any).color, ...(dataVizTokens as any).color } };\n  const resolve = (path: string, seen: Set<string> = new Set()): string | undefined => {\n    if (seen.has(path)) return undefined;\n    seen.add(path);\n    const node = path.split('.').reduce((acc: any, k) => (acc ? acc[k] : undefined), root);\n    if (!node) return undefined;\n    const value = node.$value || node.value;\n    if (typeof value === 'string' && /^\\{.+\\}$/.test(value)) return resolve(value.slice(1,-1), seen);\n    return typeof value === 'string' ? value : undefined;\n  };\n  const map: Record<string,string> = {};\n  ORG_LEVEL_IDS.forEach(id => {\n    const hex = resolve(`color.data-viz.org-level.${id}`);\n    if (hex) map[id] = hex;\n  });\n  return map;\n}\n\nfunction getOrgLevelMap(): Record<string,string> { if (!orgLevelMap) orgLevelMap = buildOrgLevelMap(); return orgLevelMap; }\nexport function getOrgLevelColor(id: string): string | undefined { return getOrgLevelMap()[id.toLowerCase()]; }\nexport function pickOrgLevelColor(id: string, fallbackIndex: number): string {\n  return getOrgLevelColor(id) || getOrgLevelMap()[ORG_LEVEL_IDS[fallbackIndex % ORG_LEVEL_IDS.length]] || pickSeriesColor(fallbackIndex);\n}\nexport function getOrgLevelStroke(id: string): string | undefined { ensureStrokeMaps(); return orgLevelStrokeMap ? orgLevelStrokeMap[id] : undefined; }\nexport function pickOrgLevelStroke(id: string, fallbackIndex: number): string {\n  return getOrgLevelStroke(id) || pickSeriesStroke(fallbackIndex);\n}\n\n// Region colours \u2013 resolved from tokens; key by region token id (kebab-case)\nlet regionMap: Record<string,string> | null = null;\n\n// Canonical list of region token ids we currently support (order stable)\nexport const REGION_IDS = [\n  'north-east',\n  'north-west',\n  'east-of-england',\n  'midlands',\n  'london',\n  'south-west',\n  'south-east'\n] as const;\nexport type RegionId = typeof REGION_IDS[number];\n\n// Normalise user supplied id variants (e.g. \"North East\", \"north_east\", \"NORTH-EAST\") to kebab-case token id.\nexport function normalizeRegionId(id: string): string {\n  return id\n    .trim()\n    .toLowerCase()\n    .replace(/&/g, 'and')\n    .replace(/[^a-z0-9]+/g, '-') // collapse any separator chars/spaces/underscores\n    .replace(/^-+|-+$/g, '');\n}\n\nfunction buildRegionMap(): Record<string,string> {\n  const root: any = { color: { ...(colorTokens as any).color, ...(dataVizTokens as any).color } };\n  const resolve = (path: string, seen: Set<string> = new Set()): string | undefined => {\n    if (seen.has(path)) return undefined;\n    seen.add(path);\n    const node = path.split('.').reduce((acc: any, k) => (acc ? acc[k] : undefined), root);\n    if (!node) return undefined;\n    const value = node.$value || node.value;\n    if (typeof value === 'string' && /^\\{.+\\}$/.test(value)) return resolve(value.slice(1,-1), seen);\n    return typeof value === 'string' ? value : undefined;\n  };\n  const map: Record<string,string> = {};\n  const missing: string[] = [];\n  REGION_IDS.forEach(id => {\n    const hex = resolve(`color.data-viz.region.${id}`);\n    if (hex) map[id] = hex; else missing.push(id);\n  });\n  if (process.env.NODE_ENV !== 'production') {\n    if (Object.keys(map).length === 0) {\n      console.warn('[DataViz] Region colour tokens unresolved \u0013 falling back to categorical colours.');\n    } else if (missing.length) {\n      console.warn(`[DataViz] Missing region colour tokens: ${missing.join(', ')}.`);\n    }\n  }\n  return map;\n}\n\nfunction getRegionMap(): Record<string,string> {\n  if (!regionMap) regionMap = buildRegionMap();\n  return regionMap;\n}\n\nexport function getRegionColor(id: string): string | undefined {\n  return getRegionMap()[normalizeRegionId(id)];\n}\n\n// Convenience: if consumer passes a region-like id we can attempt to auto-map (normalising first).\nexport function pickRegionColor(id: string, fallbackIndex: number): string {\n  return getRegionColor(id) || pickSeriesColor(fallbackIndex);\n}\n\n// Access / maintenance helpers\nexport function getAvailableRegionIds(): string[] { return [...REGION_IDS]; }\n\n// Allow consumers (e.g. during HMR in Storybook) to clear caches if token file changes at runtime.\nexport function invalidateColorCaches(options: { regions?: boolean; categorical?: boolean; strokes?: boolean } = {}) {\n  const { regions = true, categorical = false, strokes = false } = options;\n  if (regions) regionMap = null;\n  if (categorical) {\n    categoricalPalette = null;\n    optimizedCategoricalPalette = null;\n    extendedPaletteCache = null;\n  }\n  if (strokes) {\n    categoricalStrokeMap = null;\n    regionStrokeMap = null;\n  severityStrokeMap = null;\n  orgLevelStrokeMap = null;\n  }\n}\n\nexport interface AssignColorOptions {\n  palette?: 'categorical' | 'region' | 'severity' | 'org-level';\n  random?: boolean; // if true, shuffle palette order before assignment (stable per call)\n}\n\n// Assign colours to a mutable copy of the provided series objects; existing explicit s.color is preserved.\nexport function assignSeriesColors<T extends { id: string; color?: string }>(\n  series: T[],\n  { palette = 'categorical', random = false }: AssignColorOptions = {}\n): T[] {\n  const copy = series.map(s => ({ ...s }));\n  const paletteValues = palette === 'region'\n    ? copy.map((s, i) => pickRegionColor(s.id, i))\n    : palette === 'severity'\n      ? copy.map((s,i)=> pickSeverityColor(s.id, i))\n      : palette === 'org-level'\n        ? copy.map((s,i)=> pickOrgLevelColor(s.id, i))\n    : (series.length > getOptimizedCategoricalPalette().length\n        ? getExtendedCategoricalPalette()\n        : (categoricalStrategy === 'optimized'\n            ? getOptimizedCategoricalPalette()\n            : getRawCategoricalPalette()));\n\n  let order: number[] = palette === 'region'\n    ? copy.map((_, i) => i) // region colours already derived per id position\n    : palette === 'severity'\n      ? copy.map((_, i) => i)\n      : palette === 'org-level'\n        ? copy.map((_, i) => i)\n    : [...Array(paletteValues.length).keys()];\n  if (random) {\n    // Fisher\u2013Yates\n    for (let i = order.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [order[i], order[j]] = [order[j], order[i]];\n    }\n  }\n  let cursor = 0;\n  copy.forEach((s, si) => {\n    if (!s.color) {\n      if (palette === 'region') {\n        s.color = paletteValues[si];\n      } else {\n        const idx = order[cursor % order.length];\n        s.color = paletteValues[idx];\n        cursor++;\n      }\n    }\n  });\n  return copy;\n}\n\n// ---------------------------------------------------------------------------\n// Sequential & Diverging Colour Scale Utilities (token\u2011agnostic helpers)\n// ---------------------------------------------------------------------------\n\n// We intentionally keep these lightweight (no d3 dependency) by reusing the\n// CIE Lab helpers above for perceptual interpolation between arbitrary hexes.\n\nfunction labToHex(L: number, a: number, b: number): string {\n  const {X,Y,Z} = labToXyz(L,a,b);\n  const { r, g, b: bb } = xyzToRgb(X,Y,Z);\n  return rgbToHex(r,g,bb);\n}\n\nfunction interpolateLab(hexA: string, hexB: string, t: number): string {\n  const la = hexToLab(hexA); const lb = hexToLab(hexB);\n  if (!la || !lb) return t < 0.5 ? hexA : hexB;\n  const L = la.L + (lb.L - la.L) * t;\n  const a = la.a + (lb.a - la.a) * t;\n  const b = la.b + (lb.b - la.b) * t;\n  return labToHex(L, a, b);\n}\n\n// Piecewise interpolate across an ordered colour array. t in [0,1].\nfunction interpolateMulti(colors: string[], t: number): string {\n  if (colors.length === 0) return '#000000';\n  if (colors.length === 1) return colors[0];\n  const n = colors.length - 1;\n  const scaled = t * n;\n  const i = Math.min(n - 1, Math.max(0, Math.floor(scaled)));\n  const localT = scaled - i;\n  return interpolateLab(colors[i], colors[i + 1], localT);\n}\n\nexport interface SequentialScaleOptions {\n  domain: [number, number];\n  colors?: string[]; // ordered light -> dark (or vice versa; interpolation is linear across array)\n  steps?: number; // if provided with base colours length === 1 generate light/dark variants\n  clamp?: boolean;\n  baseColor?: string; // fallback single colour (default brand blue)\n  lightnessSpan?: number; // total L* delta to distribute either side when auto\u2011generating\n}\n\n/** Create a sequential colour scale (continuous). */\nexport function createSequentialColorScale({\n  domain,\n  colors,\n  steps = 7,\n  clamp = true,\n  baseColor = '#005eb8',\n  lightnessSpan = 60\n}: SequentialScaleOptions) {\n  let [d0, d1] = domain;\n  if (d0 === d1) { d1 = d0 + 1; } // guard zero range\n  if (d1 < d0) { const tmp = d0; d0 = d1; d1 = tmp; }\n\n  let palette: string[] = [];\n  if (colors && colors.length > 1) palette = colors.slice();\n  else if (colors && colors.length === 1) { baseColor = colors[0]; }\n  if (!palette.length) {\n    // Auto\u2011generate by sampling lightness around the base colour.\n    const lab = hexToLab(baseColor) || { L: 50, a: 0, b: 0 };\n    const half = lightnessSpan / 2;\n    // Distribute steps from light (higher L) to dark (lower L)\n    const minL = Math.max(2, lab.L - half);\n    const maxL = Math.min(98, lab.L + half);\n    palette = Array.from({ length: steps }).map((_, i) => {\n      const t = i / Math.max(1, steps - 1); // 0..1\n      const L = maxL - (maxL - minL) * t; // descending light->dark\n      return labToHex(L, lab.a, lab.b);\n    });\n  }\n\n  const range = d1 - d0;\n  return (value: number) => {\n    let t = (value - d0) / range; // may be <0 or >1\n    if (clamp) t = Math.min(1, Math.max(0, t));\n    return interpolateMulti(palette, t);\n  };\n}\n\nexport interface DivergingScaleOptions {\n  domain: [number, number, number]; // [min, mid, max]; mid acts as neutral pivot\n  colors?: string[]; // >=3 colours; if exactly 3 => [negative, neutral, positive]\n  negativeColor?: string; // used if no explicit colours\n  positiveColor?: string;\n  neutralColor?: string;\n  stepsPerSide?: number; // used when auto\u2011generating from neg/pos + neutral\n  clamp?: boolean;\n}\n\n/** Create a diverging colour scale. */\nexport function createDivergingColorScale({\n  domain,\n  colors,\n  negativeColor = '#d5281b', // NHS error/red\n  positiveColor = '#007f3b', // NHS green\n  neutralColor = '#f2f2f2',\n  stepsPerSide = 3,\n  clamp = true\n}: DivergingScaleOptions) {\n  let [d0, dm, d1] = domain;\n  // Ensure ordering\n  if (!(d0 <= dm && dm <= d1)) {\n    const sorted = [d0, dm, d1].sort((a,b)=>a-b);\n    [d0, dm, d1] = sorted as [number, number, number];\n  }\n  if (d0 === d1) { d1 = d0 + 1; dm = d0 + 0.5; }\n  if (dm === d0) dm = d0 + (d1 - d0) / 2;\n  if (dm === d1) dm = d0 + (d1 - d0) / 2;\n\n  let palette: string[] = [];\n  if (colors && colors.length >= 3) palette = colors.slice();\n  if (!palette.length) {\n    // Auto\u2011generate side ramps from neg/pos towards neutral (lightening each side)\n    const negLab = hexToLab(negativeColor) || { L: 40, a: 60, b: 40 } as any;\n    const posLab = hexToLab(positiveColor) || { L: 40, a: -60, b: 40 } as any;\n    const neuLab = hexToLab(neutralColor) || { L: 96, a: 0, b: 0 } as any;\n    const negRamp = Array.from({ length: stepsPerSide }).map((_, i) => {\n      const t = i / Math.max(1, stepsPerSide - 1); // 0..1 towards neutral\n      return labToHex(\n        negLab.L + (neuLab.L - negLab.L) * t,\n        negLab.a + (neuLab.a - negLab.a) * t,\n        negLab.b + (neuLab.b - negLab.b) * t\n      );\n    });\n    const posRamp = Array.from({ length: stepsPerSide }).map((_, i) => {\n      const t = i / Math.max(1, stepsPerSide - 1);\n      return labToHex(\n        neuLab.L + (posLab.L - neuLab.L) * t,\n        neuLab.a + (posLab.a - neuLab.a) * t,\n        neuLab.b + (posLab.b - neuLab.b) * t\n      );\n    });\n    // Combine, ensuring single neutral duplicate removal\n    palette = [...negRamp.slice(0, -1), ...posRamp];\n  }\n\n  // Build two segments: [d0..dm] and [dm..d1]. We normalise t separately for each half.\n  const left = palette.slice(0, Math.ceil(palette.length / 2));\n  const right = palette.slice(Math.floor(palette.length / 2));\n  return (value: number) => {\n    if (clamp) value = Math.min(d1, Math.max(d0, value));\n    if (value <= dm) {\n      const t = (value - d0) / (dm - d0 || 1);\n      return interpolateMulti(left, t);\n    }\n    const t = (value - dm) / (d1 - dm || 1);\n    return interpolateMulti(right, t);\n  };\n}\n\n// Convenience categorical wrapper that selects between scale factories based on config.\nexport type ColorScale = (value: number) => string;\nexport type ColorScaleConfig =\n  | ({ type: 'sequential' } & SequentialScaleOptions)\n  | ({ type: 'diverging' } & DivergingScaleOptions);\n\nexport function createColorScale(config: ColorScaleConfig): ColorScale {\n  if (config.type === 'sequential') return createSequentialColorScale(config);\n  return createDivergingColorScale(config);\n}\n\n", "import * as React from 'react';\n\nexport interface VisibilityContextValue {\n  hiddenIds: Set<string>;\n  isHidden: (id: string) => boolean;\n  toggle: (id: string) => void;\n  showOnly: (id: string) => void;\n  showAll: () => void;\n  setHidden: (ids: string[] | Set<string>) => void;\n}\n\nconst VisibilityContext = React.createContext<VisibilityContextValue | null>(null);\nexport const useVisibility = () => React.useContext(VisibilityContext);\n\nexport interface VisibilityProviderProps {\n  initialHiddenIds?: string[];\n  children: React.ReactNode;\n  /** Optional controlled hidden set (if provided, component becomes controlled) */\n  hiddenIds?: string[];\n  onChange?: (hidden: string[]) => void;\n}\n\nexport const VisibilityProvider: React.FC<VisibilityProviderProps> = ({\n  initialHiddenIds = [],\n  children,\n  hiddenIds: controlledHidden,\n  onChange\n}) => {\n  const [uncontrolled, setUncontrolled] = React.useState<Set<string>>(() => new Set(initialHiddenIds));\n  const isControlled = controlledHidden !== undefined;\n  const hiddenSet = React.useMemo(() => isControlled ? new Set(controlledHidden) : uncontrolled, [isControlled, controlledHidden, uncontrolled]);\n\n  const update = React.useCallback((next: Set<string>) => {\n    if (!isControlled) setUncontrolled(new Set(next));\n    onChange?.(Array.from(next));\n  }, [isControlled, onChange]);\n\n  const api: VisibilityContextValue = React.useMemo(() => ({\n    hiddenIds: hiddenSet,\n    isHidden: (id: string) => hiddenSet.has(id),\n    toggle: (id: string) => {\n      const next = new Set(hiddenSet);\n      next.has(id) ? next.delete(id) : next.add(id);\n      update(next);\n    },\n  showOnly: (_id: string) => {\n      // Future: require full ids set to hide others. For now just clear hidden set making all visible.\n      update(new Set());\n    },\n    showAll: () => update(new Set()),\n    setHidden: (ids) => update(new Set(Array.isArray(ids) ? ids : Array.from(ids)))\n  }), [hiddenSet, update]);\n\n  return <VisibilityContext.Provider value={api}>{children}</VisibilityContext.Provider>;\n};\n\nexport default VisibilityContext;\n", "import * as React from \"react\";\nimport { useScaleContext } from \"./ScaleContext\";\nimport { useVisibility } from \"./VisibilityContext\";\n\nexport interface TooltipDatum {\n\tseriesId: string;\n\tindex: number; // index within series\n\tx: Date | string | number; // allow categorical values\n\ty: number;\n\tclientX: number; // scaled x position within plot area\n\tclientY: number; // scaled y position within plot area\n}\n\nexport interface TooltipContextValue {\n\tfocused: TooltipDatum | null;\n\tsetFocused: (d: TooltipDatum | null) => void;\n\t/** All series points sharing the focused x (including focused point) when multiple series align. Length 0 when no focus, 1 when single. */\n\taggregated: TooltipDatum[];\n\t/** Programmatic focus of nearest datum to given SVG plot coordinates (already in inner coordinate space). */\n\tfocusNearest: (plotX: number, plotY: number) => void;\n\t/** Clear current focus */\n\tclear: () => void;\n\t/** Register series data for nearest-point lookup */\n\tregisterSeries: (\n\t\tseriesId: string,\n\t\tdata: { x: Date | string | number; y: number }[]\n\t) => void;\n\tunregisterSeries: (seriesId: string) => void;\n\t/** Move focus to next point in same series */\n\tfocusNextPoint: () => void;\n\t/** Move focus to previous point in same series */\n\tfocusPrevPoint: () => void;\n\t/** Cycle to next series at same index (if exists) */\n\tfocusNextSeries: () => void;\n\t/** Cycle to previous series at same index (if exists) */\n\tfocusPrevSeries: () => void;\n\t/** Jump to first point in current (or first) series */\n\tfocusFirstPoint: () => void;\n\t/** Jump to last point in current (or first) series */\n\tfocusLastPoint: () => void;\n}\n\nconst TooltipContext = React.createContext<TooltipContextValue | null>(null);\nexport const useTooltipContext = () => React.useContext(TooltipContext);\n\ninterface TooltipProviderProps {\n\tchildren: React.ReactNode;\n\t/** Maximum pixel distance to accept a nearest match (otherwise focus cleared) */\n\tmaxDistance?: number;\n\t/** Allow wrap-around when navigating past start/end of points or series */\n\twrapAround?: boolean;\n}\n\n/** Shared tooltip / focus context: unifies pointer & keyboard focus of a single datum across chart primitives. */\nexport const TooltipProvider: React.FC<TooltipProviderProps> = ({\n\tchildren,\n\tmaxDistance = 40,\n\twrapAround = false,\n}) => {\n\tconst scaleCtx = useScaleContext();\n\tconst visibility = useVisibility();\n\tconst [focused, setFocused] = React.useState<TooltipDatum | null>(null);\n\tconst seriesRef = React.useRef<\n\t\tMap<string, { x: Date | string | number; y: number }[]>\n\t>(new Map());\n\tconst [aggregated, setAggregated] = React.useState<TooltipDatum[]>([]);\n\n\tconst registerSeries = React.useCallback(\n\t\t(seriesId: string, data: { x: Date | string | number; y: number }[]) => {\n\t\t\tseriesRef.current.set(seriesId, data);\n\t\t},\n\t\t[]\n\t);\n\tconst unregisterSeries = React.useCallback((seriesId: string) => {\n\t\tseriesRef.current.delete(seriesId);\n\t}, []);\n\n\tconst focusNearest = React.useCallback(\n\t\t(plotX: number, plotY: number) => {\n\t\t\tif (!scaleCtx) return;\n\t\t\tconst { xScale, yScale } = scaleCtx;\n\t\t\tlet best: TooltipDatum | null = null;\n\t\t\tlet bestDist = Infinity;\n\t\t\tseriesRef.current.forEach((data, sid) => {\n\t\t\t\tdata.forEach((d, i) => {\n\t\t\t\t\tconst px = xScale(d.x);\n\t\t\t\t\tconst py = yScale(d.y);\n\t\t\t\t\tconst dx = px - plotX;\n\t\t\t\t\tconst dy = py - plotY;\n\t\t\t\t\tconst dist = Math.sqrt(dx * dx + dy * dy);\n\t\t\t\t\tif (dist < bestDist) {\n\t\t\t\t\t\tbestDist = dist;\n\t\t\t\t\t\tbest = {\n\t\t\t\t\t\t\tseriesId: sid,\n\t\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\t\tx: d.x,\n\t\t\t\t\t\t\ty: d.y,\n\t\t\t\t\t\t\tclientX: px,\n\t\t\t\t\t\t\tclientY: py,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tif (best && bestDist <= maxDistance) setFocused(best);\n\t\t\telse setFocused(null);\n\t\t},\n\t\t[scaleCtx, maxDistance]\n\t);\n\n\tconst clear = React.useCallback(() => setFocused(null), []);\n\n\t// Recompute aggregated aligned points whenever focused changes\n\tReact.useEffect(() => {\n\t\tif (!focused) {\n\t\t\tsetAggregated([]);\n\t\t\treturn;\n\t\t}\n\t\t// Collect all points with identical x timestamp (exact match) across visible (registered) series\n\t\tif (!scaleCtx) return;\n\t\tconst { xScale, yScale } = scaleCtx;\n\t\tconst agg: TooltipDatum[] = [];\n\t\tseriesRef.current.forEach((data, sid) => {\n\t\t\tdata.forEach((d, i) => {\n\t\t\t\tconst match = ((): boolean => {\n\t\t\t\t\tif (focused.x instanceof Date && d.x instanceof Date)\n\t\t\t\t\t\treturn d.x.getTime() === focused.x.getTime();\n\t\t\t\t\treturn d.x === focused.x; // strict equality for non-dates\n\t\t\t\t})();\n\t\t\t\tif (match) {\n\t\t\t\t\tagg.push({\n\t\t\t\t\t\tseriesId: sid,\n\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\tx: d.x,\n\t\t\t\t\t\ty: d.y,\n\t\t\t\t\t\tclientX: xScale(d.x as any),\n\t\t\t\t\t\tclientY: yScale(d.y),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\t// Sort by seriesId for stable output\n\t\tagg.sort((a, b) => a.seriesId.localeCompare(b.seriesId));\n\t\tsetAggregated(agg);\n\t}, [focused, scaleCtx]);\n\n\tconst focusRelativePoint = React.useCallback(\n\t\t(delta: 1 | -1) => {\n\t\t\tif (!focused) return;\n\t\t\tconst data = seriesRef.current.get(focused.seriesId);\n\t\t\tif (!data) return;\n\t\t\tlet nextIndex = focused.index + delta;\n\t\t\tif (nextIndex < 0 || nextIndex >= data.length) {\n\t\t\t\tif (!wrapAround) return;\n\t\t\t\t// wrap\n\t\t\t\tnextIndex = (nextIndex + data.length) % data.length;\n\t\t\t}\n\t\t\tconst d = data[nextIndex];\n\t\t\tif (!scaleCtx) return;\n\t\t\tconst { xScale, yScale } = scaleCtx;\n\t\t\tsetFocused({\n\t\t\t\tseriesId: focused.seriesId,\n\t\t\t\tindex: nextIndex,\n\t\t\t\tx: d.x,\n\t\t\t\ty: d.y,\n\t\t\t\tclientX: xScale(d.x),\n\t\t\t\tclientY: yScale(d.y),\n\t\t\t});\n\t\t},\n\t\t[focused, scaleCtx, wrapAround]\n\t);\n\n\tconst focusSeriesAtIndex = React.useCallback(\n\t\t(seriesDelta: 1 | -1) => {\n\t\t\tlet ids = Array.from(seriesRef.current.keys());\n\t\t\t// Skip hidden series (if visibility context present)\n\t\t\tif (visibility) ids = ids.filter((id) => !visibility.isHidden(id));\n\t\t\tif (ids.length === 0) return;\n\t\t\tif (!focused) {\n\t\t\t\t// pick first series first point\n\t\t\t\tconst first = ids[0];\n\t\t\t\tconst data = seriesRef.current.get(first);\n\t\t\t\tif (!data || !scaleCtx) return;\n\t\t\t\tconst { xScale, yScale } = scaleCtx;\n\t\t\t\tconst d = data[0];\n\t\t\t\tsetFocused({\n\t\t\t\t\tseriesId: first,\n\t\t\t\t\tindex: 0,\n\t\t\t\t\tx: d.x,\n\t\t\t\t\ty: d.y,\n\t\t\t\t\tclientX: xScale(d.x),\n\t\t\t\t\tclientY: yScale(d.y),\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst currentSeriesIdx = ids.indexOf(focused.seriesId);\n\t\t\tif (currentSeriesIdx === -1) return;\n\t\t\tlet nextSeriesIdx = currentSeriesIdx + seriesDelta;\n\t\t\tif (nextSeriesIdx < 0 || nextSeriesIdx >= ids.length) {\n\t\t\t\tif (!wrapAround) return; // clamp\n\t\t\t\tnextSeriesIdx = (nextSeriesIdx + ids.length) % ids.length;\n\t\t\t}\n\t\t\tconst nextSeriesId = ids[nextSeriesIdx];\n\t\t\tconst nextData = seriesRef.current.get(nextSeriesId);\n\t\t\tif (!nextData || !scaleCtx) return;\n\t\t\tconst idx = Math.min(focused.index, nextData.length - 1);\n\t\t\tconst d = nextData[idx];\n\t\t\tconst { xScale, yScale } = scaleCtx;\n\t\t\tsetFocused({\n\t\t\t\tseriesId: nextSeriesId,\n\t\t\t\tindex: idx,\n\t\t\t\tx: d.x,\n\t\t\t\ty: d.y,\n\t\t\t\tclientX: xScale(d.x),\n\t\t\t\tclientY: yScale(d.y),\n\t\t\t});\n\t\t},\n\t\t[focused, scaleCtx, wrapAround, visibility]\n\t);\n\tconst focusFirstPoint = React.useCallback(() => {\n\t\t// Within current focused series; if none, pick first visible series\n\t\tlet ids = Array.from(seriesRef.current.keys());\n\t\tif (visibility) ids = ids.filter((id) => !visibility.isHidden(id));\n\t\tif (ids.length === 0) return;\n\t\tconst targetSeriesId = focused ? focused.seriesId : ids[0];\n\t\tconst data = seriesRef.current.get(targetSeriesId);\n\t\tif (!data || data.length === 0 || !scaleCtx) return;\n\t\tconst d = data[0];\n\t\tconst { xScale, yScale } = scaleCtx;\n\t\tsetFocused({\n\t\t\tseriesId: targetSeriesId,\n\t\t\tindex: 0,\n\t\t\tx: d.x,\n\t\t\ty: d.y,\n\t\t\tclientX: xScale(d.x),\n\t\t\tclientY: yScale(d.y),\n\t\t});\n\t}, [focused, scaleCtx, visibility]);\n\n\tconst focusLastPoint = React.useCallback(() => {\n\t\tlet ids = Array.from(seriesRef.current.keys());\n\t\tif (visibility) ids = ids.filter((id) => !visibility.isHidden(id));\n\t\tif (ids.length === 0) return;\n\t\tconst targetSeriesId = focused ? focused.seriesId : ids[0];\n\t\tconst data = seriesRef.current.get(targetSeriesId);\n\t\tif (!data || data.length === 0 || !scaleCtx) return;\n\t\tconst lastIndex = data.length - 1;\n\t\tconst d = data[lastIndex];\n\t\tconst { xScale, yScale } = scaleCtx;\n\t\tsetFocused({\n\t\t\tseriesId: targetSeriesId,\n\t\t\tindex: lastIndex,\n\t\t\tx: d.x,\n\t\t\ty: d.y,\n\t\t\tclientX: xScale(d.x),\n\t\t\tclientY: yScale(d.y),\n\t\t});\n\t}, [focused, scaleCtx, visibility]);\n\n\tconst focusNextPoint = React.useCallback(\n\t\t() => focusRelativePoint(1),\n\t\t[focusRelativePoint]\n\t);\n\tconst focusPrevPoint = React.useCallback(\n\t\t() => focusRelativePoint(-1),\n\t\t[focusRelativePoint]\n\t);\n\tconst focusNextSeries = React.useCallback(\n\t\t() => focusSeriesAtIndex(1),\n\t\t[focusSeriesAtIndex]\n\t);\n\tconst focusPrevSeries = React.useCallback(\n\t\t() => focusSeriesAtIndex(-1),\n\t\t[focusSeriesAtIndex]\n\t);\n\n\tconst value: TooltipContextValue = React.useMemo(\n\t\t() => ({\n\t\t\tfocused,\n\t\t\tsetFocused,\n\t\t\taggregated,\n\t\t\tfocusNearest,\n\t\t\tclear,\n\t\t\tregisterSeries,\n\t\t\tunregisterSeries,\n\t\t\tfocusNextPoint,\n\t\t\tfocusPrevPoint,\n\t\t\tfocusNextSeries,\n\t\t\tfocusPrevSeries,\n\t\t\tfocusFirstPoint,\n\t\t\tfocusLastPoint,\n\t\t}),\n\t\t[\n\t\t\tfocused,\n\t\t\taggregated,\n\t\t\tfocusNearest,\n\t\t\tclear,\n\t\t\tregisterSeries,\n\t\t\tunregisterSeries,\n\t\t\tfocusNextPoint,\n\t\t\tfocusPrevPoint,\n\t\t\tfocusNextSeries,\n\t\t\tfocusPrevSeries,\n\t\t\tfocusFirstPoint,\n\t\t\tfocusLastPoint,\n\t\t]\n\t);\n\n\treturn (\n\t\t<TooltipContext.Provider value={value}>{children}</TooltipContext.Provider>\n\t);\n};\n\nexport default TooltipContext;\n", "import * as React from 'react';\nimport { useTooltipContext } from '../core/TooltipContext';\n\n/**\n * ARIA live region announcing the currently focused data point for screen reader users.\n * Mount inside TooltipProvider scope (e.g. within LineChart). Hidden visually.\n */\nconst VisuallyHiddenLiveRegion: React.FC<{ polite?: boolean; format?: (d: { seriesId: string; x: Date | string | number; y: number; index: number }) => string }>\n  = ({ polite = true, format }) => {\n  const tooltip = useTooltipContext();\n  const [message, setMessage] = React.useState('');\n  const lastRef = React.useRef<string>('');\n\n  React.useEffect(() => {\n    if (!tooltip?.focused) return;\n    const { focused, aggregated } = tooltip;\n    let msg: string;\n    if (aggregated && aggregated.length > 1) {\n      // Aggregate announcement\n      const parts = aggregated.map(a => `${a.seriesId} ${a.y}`).join('; ');\n  const xLabel = focused.x instanceof Date ? focused.x.toDateString() : String(focused.x);\n  msg = `${xLabel} \u2013 ${parts}`;\n    } else {\n      msg = format ? format({ seriesId: focused.seriesId, x: focused.x, y: focused.y, index: focused.index })\n        : defaultFormatter(focused.seriesId, focused.x, focused.y, focused.index);\n    }\n    if (msg !== lastRef.current) {\n      lastRef.current = msg;\n      // Force screen reader to re-announce by clearing then setting (some AT benefit from refresh)\n      setMessage('');\n      const timeout = setTimeout(() => setMessage(msg), 10);\n      return () => clearTimeout(timeout);\n    }\n  }, [tooltip?.focused, format]);\n\n  return (\n    <div\n      aria-live={polite ? 'polite' : 'assertive'}\n      aria-atomic=\"true\"\n      style={{ position: 'absolute', width: 1, height: 1, margin: -1, padding: 0, overflow: 'hidden', clip: 'rect(0 0 0 0)', border: 0 }}\n    >\n      {message}\n    </div>\n  );\n};\n\nfunction defaultFormatter(seriesId: string, x: Date | string | number, y: number, index: number) {\n  const xLabel = x instanceof Date ? x.toDateString() : String(x);\n  return `Series ${seriesId}, point ${index + 1}, ${xLabel}, value ${y}`;\n}\n\nexport default VisuallyHiddenLiveRegion;\n", "import * as React from 'react';\nimport { useTooltipContext } from '../core/TooltipContext';\nimport { useChartContext } from '../core/ChartRoot';\nimport { pickSeriesColor } from '../utils/colors';\n\n/** Basic overlay showing a single focused datum (from TooltipContext). */\nexport const TooltipOverlay: React.FC = () => {\n  const tooltip = useTooltipContext();\n  const chart = useChartContext();\n  if (!tooltip || !chart || !tooltip.focused) return null;\n  const { focused, aggregated } = tooltip;\n  const { innerWidth, innerHeight } = chart;\n  const clampX = Math.min(Math.max(focused.clientX, 0), innerWidth);\n  const clampY = Math.min(Math.max(focused.clientY, 0), innerHeight);\n  const bgX = clampX + 8;\n  const bgY = clampY - 8;\n  const multi = aggregated.length > 1;\n  const dateLabel = focused.x instanceof Date ? focused.x.toDateString() : String(focused.x);\n  const label = multi ? dateLabel : `${dateLabel} \u2022 ${focused.y}`;\n  // Derive base series colour (fallback to NHS blue if util absent)\n  // We only have seriesId; attempt to parse trailing digits else fallback index 0\n  const idDigits = /\\d+$/.exec(focused.seriesId || '');\n  const seriesIdx = idDigits ? parseInt(idDigits[0], 10) - 1 : 0;\n  const seriesColor = pickSeriesColor(seriesIdx >=0 ? seriesIdx : 0) || '#005eb8';\n  // NHS focus yellow via CSS variable with fallback\n  const focusYellow = 'var(--nhs-fdp-color-primary-yellow,#ffeb3b)';\n  return (\n    <g className=\"fdp-tooltip-layer\" pointerEvents=\"none\">\n  {/* Reduced outer focus ring close to point size */}\n  <circle cx={clampX} cy={clampY} r={7} fill=\"none\" stroke={focusYellow} strokeWidth={3} />\n  {/* Inner white core with yellow stroke hugging point */}\n  <circle cx={clampX} cy={clampY} r={5} fill=\"#000\" stroke={focusYellow} strokeWidth={1.5} />\n  {/* Centre dot in series colour */}\n  <circle cx={clampX} cy={clampY} r={2.5} fill={seriesColor} stroke=\"#fff\" strokeWidth={0.5} />\n      {multi ? (\n        (() => {\n          const lineHeight = 16;\n          const rows = aggregated.map(a => `${a.seriesId}: ${a.y}`);\n          const content = [label, ...rows];\n          const maxChars = content.reduce((m,s)=>Math.max(m,s.length),0);\n          const width = Math.max(90, maxChars * 6.2 + 16);\n          const height = lineHeight * content.length + 8;\n          return (\n            <g>\n              <rect x={bgX} y={bgY - height} rx={4} ry={4} width={width} height={height} fill=\"#212b32\" opacity={0.92} />\n              {content.map((t,i) => (\n                <text key={i} x={bgX + 8} y={bgY - height + 6 + lineHeight*(i+0.7)} fill=\"#fff\" fontSize={12}>{t}</text>\n              ))}\n            </g>\n          );\n        })()\n      ) : (\n        <g>\n          <rect x={bgX} y={bgY - 24} rx={4} ry={4} width={Math.max(60, label.length * 6.2)} height={24} fill=\"#212b32\" opacity={0.92} />\n          <text x={bgX + 8} y={bgY - 8} fill=\"#fff\" fontSize={12}>{label}</text>\n        </g>\n      )}\n    </g>\n  );\n};\n\nexport default TooltipOverlay;\n", "import React, { useState, useCallback, useRef, forwardRef, useImperativeHandle } from 'react';\nimport classNames from 'classnames';\nimport { TabsProps, TabItemId, TabsHandle, TabItem } from './Tabs.types';\nimport './Tabs.scss';\n\n// Export TabsHandle type for external use\nexport type { TabsHandle } from './Tabs.types';\n\n/**\n * NHS Tabs Component\n * \n * A tabs component for organizing related content into separate views.\n * Follows NHS design guidelines and accessibility standards.\n * \n * @param props - Tabs component props\n * @returns JSX element\n */\nexport const Tabs = forwardRef<TabsHandle, TabsProps>(({\n  items,\n  defaultActiveTab,\n  activeTab: controlledActiveTab,\n  onTabChange,\n  onTabFocus,\n  onTabListBlur,\n  onEscape,\n  autoActivate = true,\n  className,\n  id,\n  'data-testid': testId,\n  ...props\n}, ref) => {\n  // Determine if component is controlled or uncontrolled\n  const isControlled = controlledActiveTab !== undefined;\n  \n  // Internal state for uncontrolled mode\n  const [internalActiveTab, setInternalActiveTab] = useState<TabItemId>(() => {\n    return defaultActiveTab || items[0]?.id || '';\n  });\n  \n  // Current active tab (controlled or uncontrolled)\n  const activeTab = isControlled ? controlledActiveTab : internalActiveTab;\n  \n  // Refs for keyboard navigation\n  const tabListRef = useRef<HTMLDivElement>(null);\n  const tabRefs = useRef<Map<TabItemId, HTMLButtonElement>>(new Map());\n  \n  // Handle tab selection\n  const handleTabClick = useCallback((tabId: TabItemId) => {\n    if (!isControlled) {\n      setInternalActiveTab(tabId);\n    }\n    onTabChange?.(tabId);\n  }, [isControlled, onTabChange]);\n  \n  // Handle tab focus\n  const handleTabFocus = useCallback((tabId: TabItemId) => {\n    onTabFocus?.(tabId);\n    if (autoActivate) {\n      handleTabClick(tabId);\n    }\n  }, [onTabFocus, autoActivate, handleTabClick]);\n  \n  // Keyboard navigation\n  const handleKeyDown = useCallback((event: React.KeyboardEvent, tabId: TabItemId) => {\n    const tabIds = items.filter((item: TabItem) => !item.disabled).map((item: TabItem) => item.id);\n    const currentIndex = tabIds.indexOf(tabId);\n    \n    let newIndex: number | null = null;\n    \n    switch (event.key) {\n      case 'ArrowLeft':\n        newIndex = currentIndex > 0 ? currentIndex - 1 : tabIds.length - 1;\n        break;\n      case 'ArrowRight':\n        newIndex = currentIndex < tabIds.length - 1 ? currentIndex + 1 : 0;\n        break;\n      case 'Home':\n        newIndex = 0;\n        break;\n      case 'End':\n        newIndex = tabIds.length - 1;\n        break;\n      case 'Escape':\n        event.preventDefault();\n        onEscape?.();\n        return;\n      default:\n        return;\n    }\n    \n    if (newIndex !== null) {\n      event.preventDefault();\n      const newTabId = tabIds[newIndex];\n      const newTabRef = tabRefs.current.get(newTabId);\n      if (newTabRef) {\n        newTabRef.focus();\n        handleTabFocus(newTabId);\n      }\n    }\n  }, [items, handleTabFocus, onEscape]);\n  \n  // Set tab ref\n  const setTabRef = useCallback((tabId: TabItemId, element: HTMLButtonElement | null) => {\n    if (element) {\n      tabRefs.current.set(tabId, element);\n    } else {\n      tabRefs.current.delete(tabId);\n    }\n  }, []);\n  \n  // Focus a specific tab (for external control)\n  const focusTab = useCallback((tabId: TabItemId) => {\n    const tabRef = tabRefs.current.get(tabId);\n    if (tabRef) {\n      tabRef.focus();\n    }\n  }, []);\n  \n  // Expose ref methods\n  useImperativeHandle(ref, () => ({\n    focusTab,\n    getActiveTab: () => activeTab,\n    getTabListElement: () => tabListRef.current,\n  }), [focusTab, activeTab]);\n  \n  // Handle blur from tablist\n  const handleTabListBlur = useCallback((event: React.FocusEvent) => {\n    // Check if focus is moving outside the tablist\n    const relatedTarget = event.relatedTarget as Element;\n    if (!tabListRef.current?.contains(relatedTarget)) {\n      onTabListBlur?.();\n    }\n  }, [onTabListBlur]);\n  \n  // Build CSS classes\n  const tabsClasses = classNames('nhsuk-tabs', className);\n  \n  return (\n    <div \n      className={tabsClasses}\n      id={id}\n      data-testid={testId}\n      {...props}\n    >\n      <h2 className=\"nhsuk-tabs__title\">Contents</h2>\n      \n      <div \n        className=\"nhsuk-tabs__list-container\"\n        ref={tabListRef}\n      >\n        <ul \n          className=\"nhsuk-tabs__list\"\n          role=\"tablist\"\n          onBlur={handleTabListBlur}\n        >\n          {items.map((item: TabItem) => {\n            const isActive = item.id === activeTab;\n            const isDisabled = item.disabled;\n            \n            const tabClasses = classNames('nhsuk-tabs__list-item', {\n              'nhsuk-tabs__list-item--selected': isActive,\n              'nhsuk-tabs__list-item--disabled': isDisabled,\n            });\n            \n            return (\n              <li key={item.id} className={tabClasses} role=\"presentation\">\n                <button\n                  ref={(element) => setTabRef(item.id, element)}\n                  className=\"nhsuk-tabs__tab\"\n                  role=\"tab\"\n                  aria-selected={isActive}\n                  aria-controls={`${item.id}-panel`}\n                  id={`${item.id}-tab`}\n                  tabIndex={isActive ? 0 : -1}\n                  disabled={isDisabled}\n                  onClick={() => !isDisabled && handleTabClick(item.id)}\n                  onKeyDown={(event) => !isDisabled && handleKeyDown(event, item.id)}\n                  onFocus={() => !isDisabled && handleTabFocus(item.id)}\n                  {...item.attributes}\n                >\n                  {item.label}\n                </button>\n              </li>\n            );\n          })}\n        </ul>\n      </div>\n      \n      {items.map((item: TabItem) => {\n        const isActive = item.id === activeTab;\n        \n        return (\n          <div\n            key={item.id}\n            className=\"nhsuk-tabs__panel\"\n            role=\"tabpanel\"\n            aria-labelledby={`${item.id}-tab`}\n            id={`${item.id}-panel`}\n            hidden={!isActive}\n          >\n            {item.content}\n          </div>\n        );\n      })}\n    </div>\n  );\n});\n", "import * as React from 'react';\nconst { forwardRef, useCallback, useState } = React;\nimport { ButtonVariant, ButtonSize } from './Button.types';\nimport './Button.scss';\n\n/**\n * Base props for NHS Button component\n */\ninterface BaseButtonProps {\n\t/**\n\t * The variant of the button\n\t * @default 'primary'\n\t */\n\tvariant?: ButtonVariant;\n\t\n\t/**\n\t * The size of the button\n\t * @default 'default'\n\t */\n\tsize?: ButtonSize;\n\t\n\t/**\n\t * Whether the button should take up the full width of its container\n\t * @default false\n\t */\n\tfullWidth?: boolean;\n\t\n\t/**\n\t * Additional CSS class names\n\t */\n\tclassName?: string;\n\t\n\t/**\n\t * Button content\n\t */\n\tchildren: React.ReactNode;\n\t\n\t/**\n\t * Prevent double click submissions (adds debouncing)\n\t * @default false\n\t */\n\tpreventDoubleClick?: boolean;\n}\n\n/**\n * Props when rendering as button element (no href)\n */\nexport interface ButtonAsButtonProps extends BaseButtonProps, Omit<React.ButtonHTMLAttributes<HTMLButtonElement>, keyof BaseButtonProps> {\n\t/**\n\t * Button type\n\t * @default 'button'\n\t */\n\ttype?: 'button' | 'submit' | 'reset';\n}\n\n/**\n * Props when rendering as anchor element (with href)\n */\nexport interface ButtonAsLinkProps extends BaseButtonProps, Omit<React.AnchorHTMLAttributes<HTMLAnchorElement>, keyof BaseButtonProps | 'role' | 'type'> {\n\t/**\n\t * When provided, renders as anchor link instead of button\n\t */\n\thref: string;\n\t\n\t/**\n\t * Link target\n\t */\n\ttarget?: string;\n\t\n\t/**\n\t * Link rel attribute\n\t */\n\trel?: string;\n\t\n\t/**\n\t * Use aria-disabled for anchor elements (no native disabled support)\n\t * Use disabled prop instead for button elements\n\t */\n\t'aria-disabled'?: 'true' | 'false';\n}\n\n/**\n * NHS Button Component\n * \n * A button component that provides excellent accessibility out of the box \n * while following NHS design guidelines. Based on NHS.UK button patterns.\n * \n * Features:\n * - Full keyboard navigation support (Enter and Space key activation)\n * - Screen reader compatibility\n * - Focus management\n * - Proper ARIA attributes\n * - Double-click prevention\n * - Support for button and link variants\n * \n * @example\n * ```tsx\n * <Button variant=\"primary\" size=\"default\">\n *\t Continue\n * </Button>\n * \n * <Button href=\"/next-page\" variant=\"secondary\">\n *\t Go to next page\n * </Button>\n * ```\n */\n\n// Implementation function\nfunction ButtonComponent(\n\tprops: ButtonAsButtonProps | ButtonAsLinkProps,\n\tref: React.Ref<HTMLButtonElement | HTMLAnchorElement>\n): React.ReactElement {\n\tconst {\n\t\tchildren,\n\t\tvariant = 'primary',\n\t\tsize = 'default',\n\t\tfullWidth = false,\n\t\tclassName = '',\n\t\tpreventDoubleClick = false,\n\t\t...rest\n\t} = props;\n\n\t// State for interactive data attributes (replaces React Aria state management)\n\tconst [isPressed, setIsPressed] = useState(false);\n\tconst [isHovered, setIsHovered] = useState(false);\n\tconst [isFocused, setIsFocused] = useState(false);\n\n\t// Build CSS classes\n\tconst classes = [\n\t\t'nhs-aria-button',\n\t\t`nhs-aria-button--${variant}`,\n\t\tsize !== 'default' ? `nhs-aria-button--${size}` : '',\n\t\tfullWidth ? 'nhs-aria-button--full-width' : '',\n\t\tclassName\n\t].filter(Boolean).join(' ');\n\n\t// Build data attributes for styling (replaces React Aria data attributes)\n\tconst isDisabled = 'disabled' in rest ? rest.disabled : rest['aria-disabled'] === 'true';\n\tconst dataAttributes = {\n\t\t...(isPressed && { 'data-pressed': 'true' }),\n\t\t...(isHovered && { 'data-hovered': 'true' }),\n\t\t...(isFocused && { 'data-focused': 'true' }),\n\t\t...(isDisabled && { 'data-disabled': 'true' })\n\t};\n\n\t// Event handlers for state management\n\tconst handleMouseDown = useCallback(() => !isDisabled && setIsPressed(true), [isDisabled]);\n\tconst handleMouseUp = useCallback(() => setIsPressed(false), []);\n\tconst handleMouseEnter = useCallback(() => !isDisabled && setIsHovered(true), [isDisabled]);\n\tconst handleMouseLeave = useCallback(() => {\n\t\tsetIsHovered(false);\n\t\tsetIsPressed(false); // Reset pressed state when leaving\n\t}, []);\n\tconst handleFocus = useCallback(() => setIsFocused(true), []);\n\tconst handleBlur = useCallback(() => setIsFocused(false), []);\n\n\t// Handle keyboard navigation (Space key support for buttons and links with role=\"button\")\n\tconst handleKeyDown = useCallback((event: React.KeyboardEvent<HTMLElement>) => {\n\t\t// Handle space bar activation for button role elements\n\t\tif (event.key === ' ' && ('href' in rest || event.currentTarget.getAttribute('role') === 'button')) {\n\t\t\tevent.preventDefault();\n\t\t\t(event.currentTarget as HTMLElement).click();\n\t\t}\n\t}, [rest]);\n\n\t// Handle click with double-click prevention\n\tconst handleClick = useCallback((event: React.MouseEvent<HTMLElement>) => {\n\t\t// Double-click prevention logic (following NHS.UK pattern)\n\t\tif (preventDoubleClick) {\n\t\t\tconst target = event.currentTarget as HTMLElement;\n\t\t\tconst isAlreadyProcessing = target.getAttribute('data-processing') === 'true';\n\t\t\t\n\t\t\tif (isAlreadyProcessing) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\t// Mark as processing\n\t\t\ttarget.setAttribute('data-processing', 'true');\n\t\t\t\n\t\t\t// Clear processing state after 1 second\n\t\t\tsetTimeout(() => {\n\t\t\t\ttarget.removeAttribute('data-processing');\n\t\t\t}, 1000);\n\t\t}\n\t}, [preventDoubleClick]);\n\n\t// Render as anchor link if href is provided\n\tif ('href' in rest && rest.href) {\n\t\tconst { id, style, title, ['aria-label']: ariaLabel, ['aria-describedby']: ariaDescribedBy, ['aria-labelledby']: ariaLabelledBy, tabIndex, ...anchorRest } = rest as ButtonAsLinkProps as any;\n\t\tconst anchorProps = rest as ButtonAsLinkProps;\n\t\treturn (\n\t\t\t<a\n\t\t\t\tref={ref as React.Ref<HTMLAnchorElement>}\n\t\t\t\thref={anchorProps.href}\n\t\t\t\ttarget={anchorProps.target}\n\t\t\t\trel={anchorProps.rel}\n\t\t\t\tclassName={classes}\n\t\t\t\trole=\"button\"\n\t\t\t\tdraggable=\"false\"\n\t\t\t\tdata-module=\"nhs-button\"\n\t\t\t\t{...dataAttributes}\n\t\t\t\t{...(preventDoubleClick && { 'data-prevent-double-click': 'true' })}\n\t\t\t\t{...anchorRest}\n\t\t\t\tonKeyDown={(event) => {\n\t\t\t\t\tanchorProps.onKeyDown?.(event);\n\t\t\t\t\thandleKeyDown(event);\n\t\t\t\t}}\n\t\t\t\tonClick={(event) => {\n\t\t\t\t\tanchorProps.onClick?.(event);\n\t\t\t\t\thandleClick(event);\n\t\t\t\t}}\n\t\t\t\tonMouseDown={(event) => {\n\t\t\t\t\tanchorProps.onMouseDown?.(event);\n\t\t\t\t\thandleMouseDown();\n\t\t\t\t}}\n\t\t\t\tonMouseUp={(event) => {\n\t\t\t\t\tanchorProps.onMouseUp?.(event);\n\t\t\t\t\thandleMouseUp();\n\t\t\t\t}}\n\t\t\t\tonMouseEnter={(event) => {\n\t\t\t\t\tanchorProps.onMouseEnter?.(event);\n\t\t\t\t\thandleMouseEnter();\n\t\t\t\t}}\n\t\t\t\tonMouseLeave={(event) => {\n\t\t\t\t\tanchorProps.onMouseLeave?.(event);\n\t\t\t\t\thandleMouseLeave();\n\t\t\t\t}}\n\t\t\t\tonFocus={(event) => {\n\t\t\t\t\tanchorProps.onFocus?.(event);\n\t\t\t\t\thandleFocus();\n\t\t\t\t}}\n\t\t\t\tonBlur={(event) => {\n\t\t\t\t\tanchorProps.onBlur?.(event);\n\t\t\t\t\thandleBlur();\n\t\t\t\t}}\n\t\t\t\t// Note: anchor links don't support disabled, but we can simulate it with aria-disabled\n\t\t\t\taria-disabled={anchorProps['aria-disabled']}\n\t\t\t\t{...(anchorProps['aria-disabled'] === 'true' && { 'tabIndex': -1 })}\n\t\t\t\t// Extract relevant props excluding our custom ones\n\t\t\t\tid={id}\n\t\t\t\tstyle={style}\n\t\t\t\ttitle={title}\n\t\t\t\taria-label={ariaLabel}\n\t\t\t\taria-describedby={ariaDescribedBy}\n\t\t\t\taria-labelledby={ariaLabelledBy}\n\t\t\t\ttabIndex={tabIndex}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</a>\n\t\t);\n\t}\n\n\t// Render as button element\n\tconst { id, style, title, ['aria-label']: ariaLabel, ['aria-describedby']: ariaDescribedBy, ['aria-labelledby']: ariaLabelledBy, tabIndex, name, value: valueProp, form, formAction, formEncType, formMethod, formNoValidate, formTarget, autoFocus, ...buttonRest } = rest as any as ButtonAsButtonProps;\n\tconst buttonProps = rest as ButtonAsButtonProps;\n\treturn (\n\t\t<button\n\t\t\tref={ref as React.Ref<HTMLButtonElement>}\n\t\t\ttype={buttonProps.type || 'button'}\n\t\t\tdisabled={buttonProps.disabled}\n\t\t\tclassName={classes}\n\t\t\tdata-module=\"nhs-button\"\n\t\t\t{...dataAttributes}\n\t\t\t{...(preventDoubleClick && { 'data-prevent-double-click': 'true' })}\n\t\t\t{...(buttonProps.disabled && { 'aria-disabled': 'true' })}\n\t\t\t{...buttonRest}\n\t\t\tonKeyDown={(event) => {\n\t\t\t\tbuttonProps.onKeyDown?.(event);\n\t\t\t\thandleKeyDown(event);\n\t\t\t}}\n\t\t\tonClick={(event) => {\n\t\t\t\tbuttonProps.onClick?.(event);\n\t\t\t\thandleClick(event);\n\t\t\t}}\n\t\t\tonMouseDown={(event) => {\n\t\t\t\tbuttonProps.onMouseDown?.(event);\n\t\t\t\thandleMouseDown();\n\t\t\t}}\n\t\t\tonMouseUp={(event) => {\n\t\t\t\tbuttonProps.onMouseUp?.(event);\n\t\t\t\thandleMouseUp();\n\t\t\t}}\n\t\t\tonMouseEnter={(event) => {\n\t\t\t\tbuttonProps.onMouseEnter?.(event);\n\t\t\t\thandleMouseEnter();\n\t\t\t}}\n\t\t\tonMouseLeave={(event) => {\n\t\t\t\tbuttonProps.onMouseLeave?.(event);\n\t\t\t\thandleMouseLeave();\n\t\t\t}}\n\t\t\tonFocus={(event) => {\n\t\t\t\tbuttonProps.onFocus?.(event);\n\t\t\t\thandleFocus();\n\t\t\t}}\n\t\t\tonBlur={(event) => {\n\t\t\t\tbuttonProps.onBlur?.(event);\n\t\t\t\thandleBlur();\n\t\t\t}}\n\t\t\t// Extract relevant props\n\t\t\tid={id}\n\t\t\tstyle={style}\n\t\t\ttitle={title}\n\t\t\taria-label={ariaLabel}\n\t\t\taria-describedby={ariaDescribedBy}\n\t\t\taria-labelledby={ariaLabelledBy}\n\t\t\ttabIndex={tabIndex}\n\t\t\tname={name}\n\t\t\tvalue={valueProp}\n\t\t\tform={form}\n\t\t\tformAction={formAction}\n\t\t\tformEncType={formEncType}\n\t\t\tformMethod={formMethod}\n\t\t\tformNoValidate={formNoValidate}\n\t\t\tformTarget={formTarget}\n\t\t\tautoFocus={autoFocus}\n\t\t>\n\t\t\t{children}\n\t\t</button>\n\t);\n}\n\n// Define overloaded function signatures \ninterface ButtonComponent {\n\t(props: ButtonAsButtonProps & { ref?: React.Ref<HTMLButtonElement> }): React.ReactElement;\n\t(props: ButtonAsLinkProps & { ref?: React.Ref<HTMLAnchorElement> }): React.ReactElement;\n\tdisplayName?: string;\n}\n\nexport const Button = forwardRef(ButtonComponent) as ButtonComponent;\nButton.displayName = 'Button';\n\n// Export union type for compatibility\nexport type NHSButtonProps = ButtonAsButtonProps | ButtonAsLinkProps;\n\nexport default Button;\n", "import React from 'react';\nimport classNames from 'classnames';\nimport { TableProps, TableCellData, TableHeaderCell } from './Table.types';\nimport './Table.scss';\nimport { Panel } from '../Panel';\nimport { Heading } from '../Heading';\n\n/**\n * Table component for displaying structured data\n * \n * Features:\n * - Responsive design with mobile-friendly stacked layout\n * - Accessible table structure with proper headers\n * - Support for complex cell types (headers, numeric, spans)\n * - Optional panel wrapper with heading\n * - Customizable caption and styling\n * \n * @param props - Table component props\n * @returns JSX element\n */\nconst Table: React.FC<TableProps> = ({\n\trows,\n\thead,\n\tcaption,\n\tcaptionSize,\n\tfirstCellIsHeader = false,\n\tresponsive = false,\n\theading,\n\theadingLevel = 3,\n\tpanel = false,\n\tpanelClasses,\n\ttableClasses,\n\tclasses,\n\tattributes,\n\t'data-testid': testId,\n}) => {\n  // Build caption classes\n\tconst captionClass = `nhsuk-table__caption ${captionSize ? `nhsuk-table__caption--${captionSize}` : ''}`.trim();\n\n  // Build table classes\n  const tableClassList = classNames(\n\t'nhsuk-table',\n\t{\n\t  'nhsuk-table-responsive': responsive,\n\t},\n\ttableClasses\n  );\n\n  // Build container classes\n  const containerClassList = classNames(classes);\n\n  const renderHeaderCell = (cell: TableHeaderCell, index: number) => {\n\tconst headerClasses = classNames('nhsuk-table__header', {\n\t  [`nhsuk-table__header--${cell.format}`]: cell.format,\n\t}, cell.classes);\n\n\tconst headerAttributes = {\n\t\tscope: 'col' as const,\n\t\t...(cell.colspan && { colSpan: cell.colspan }),\n\t\t...(cell.rowspan && { rowSpan: cell.rowspan }),\n\t\t...(responsive && { role: 'columnheader' }),\n\t\t...cell.attributes,\n\t};\n\n\treturn (\n\t  <th key={index} className={headerClasses} {...headerAttributes}>\n\t\t{cell.html ? (\n\t\t  <span dangerouslySetInnerHTML={{ __html: cell.html }} />\n\t\t) : (\n\t\t  cell.text\n\t\t)}\n\t  </th>\n\t);\n  };\n\n  const renderCell = (cell: TableCellData, cellIndex: number, isFirstCell: boolean) => {\n\tconst isHeaderCell = firstCellIsHeader && isFirstCell;\n\t\n\tconst cellClasses = classNames(\n\t  isHeaderCell ? 'nhsuk-table__header' : 'nhsuk-table__cell',\n\t  {\n\t\t[`nhsuk-table__${isHeaderCell ? 'header' : 'cell'}--${cell.format}`]: cell.format,\n\t  },\n\t  cell.classes\n\t);\n\n\tconst cellAttributes = {\n\t\t...(isHeaderCell && { scope: 'row' as const }),\n\t\t...(cell.colspan && { colSpan: cell.colspan }),\n\t\t...(cell.rowspan && { rowSpan: cell.rowspan }),\n\t\t...(responsive && { \n\t\trole: isHeaderCell ? 'rowheader' : 'cell',\n\t\t...(cell.header && { 'data-label': cell.header })\n\t\t}),\n\t\t...cell.attributes,\n\t};\n\n\tconst cellContent = (\n\t  <>\n\t\t{responsive && cell.header && (\n\t\t  <span className=\"nhsuk-table-responsive__heading\" aria-hidden=\"true\">\n\t\t\t{cell.header}{' '}\n\t\t  </span>\n\t\t)}\n\t\t{cell.html ? (\n\t\t  <span dangerouslySetInnerHTML={{ __html: cell.html }} />\n\t\t) : (\n\t\t  cell.text\n\t\t)}\n\t  </>\n\t);\n\n\tconst Component = isHeaderCell ? 'th' : 'td';\n\n\treturn (\n\t  <Component key={cellIndex} className={cellClasses} {...cellAttributes}>\n\t\t{cellContent}\n\t  </Component>\n\t);\n  };\n\n  const renderTable = () => (\n\t<table \n\t  className={tableClassList}\n\t  {...(responsive && { role: 'table' })}\n\t  {...attributes}\n\t  {...(testId && { 'data-testid': testId })}\n\t>\n\t  { caption && (\n\t\t<caption className={captionClass}>\n\t\t  {caption}\n\t\t</caption>\n\t  )}\n\t  \n\t  { head && head.length > 0 && (\n\t\t<thead \n\t\t  className=\"nhsuk-table__head\"\n\t\t  {...(responsive && { role: 'rowgroup' })}\n\t\t>\n\t\t  <tr {...(responsive && { role: 'row' })}>\n\t\t\t{head.map((cell: any, index: number) => renderHeaderCell(cell, index))}\n\t\t  </tr>\n\t\t</thead>\n\t  )}\n\t  \n\t  <tbody className=\"nhsuk-table__body\">\n\t\t{rows && rows.map((row: any, rowIndex: number) => (\n\t\t  <tr \n\t\t\tkey={rowIndex} \n\t\t\tclassName=\"nhsuk-table__row\"\n\t\t\t{...(responsive && { role: 'row' })}\n\t\t  >\n\t\t\t{row.map((cell: any, cellIndex: number) => \n\t\t\t\trenderCell(cell, cellIndex, cellIndex === 0)\n\t\t\t)}\n\t\t  </tr>\n\t\t))}\n\t  </tbody>\n\t</table>\n  );\n\nif (panel) {\n\treturn (\n\t\t<Panel className={panelClasses}>\n\t\t\t{ heading && (\n\t\t\t\t<Heading level={headingLevel} className=\"nhsuk-table__heading-tab\">\n\t\t\t\t\t{heading}\n\t\t\t\t</Heading>\n\t\t\t)}\n\t\t\t{ renderTable() }\n\t\t</Panel>\n\t);\n}\n\n  if (containerClassList) {\n\treturn (\n\t  <div className={containerClassList}>\n\t\t{ renderTable() }\n\t  </div>\n\t);\n  }\n\n  return renderTable();\n};\n\nexport default Table;\n", "import React from 'react';\nimport classNames from 'classnames';\nimport './Panel.scss';\nimport { PanelProps } from './Panel.types';\nimport { Heading } from '../Heading';\n\nexport const Panel: React.FC<PanelProps> = ({\n  id,\n  className,\n  headingText,\n  headingHtml,\n  headingLevel = 2,\n  bodyText,\n  bodyHtml,\n  children,\n  ...props\n}) => {\n  const panelClasses = classNames(\n    'nhsuk-panel',\n    className\n  );\n\n  const renderHeading = () => {\n    if (!headingText && !headingHtml && !children) return null;\n\n    if (headingHtml) {\n      return (\n        <Heading\n          level={headingLevel}\n          className=\"nhsuk-panel__heading\"\n          html={headingHtml}\n          marginBottom=\"var(--panel-heading-margin, 24px)\"\n        />\n      );\n    }\n\n    if (headingText) {\n      return (\n        <Heading\n          level={headingLevel}\n          className=\"nhsuk-panel__heading\"\n          text={headingText}\n          marginBottom=\"var(--panel-heading-margin, 24px)\"\n        />\n      );\n    }\n\n    return null;\n  };\n\n  const renderBody = () => {\n    if (children) {\n      return <div className=\"nhsuk-panel__body\">{children}</div>;\n    }\n\n    if (bodyHtml) {\n      return (\n        <div \n          className=\"nhsuk-panel__body\"\n          dangerouslySetInnerHTML={{ __html: bodyHtml }}\n        />\n      );\n    }\n\n    if (bodyText) {\n      return (\n        <div className=\"nhsuk-panel__body\">\n          <p>{bodyText}</p>\n        </div>\n      );\n    }\n\n    return null;\n  };\n\n  return (\n    <div className={panelClasses} id={id} {...props}>\n      {renderHeading()}\n      {renderBody()}\n    </div>\n  );\n};\n", "import React, { createElement } from 'react';\nimport classNames from 'classnames';\nimport './Heading.scss';\nimport { HeadingProps } from './Heading.types';\n\n/**\n * A reusable Heading component that abstracts heading level logic and provides consistent styling.\n * Separates semantic meaning (level) from visual appearance (size).\n * \n * If level is not provided, it will be automatically determined from the size prop:\n * - xxl/xl \u2192 h1\n * - l \u2192 h2 \n * - m \u2192 h3\n * - s \u2192 h4\n * - xs \u2192 h5\n * \n * @example\n * <Heading level={1} size=\"xl\">Page Title</Heading>\n * <Heading level={2} size=\"l\" text=\"Section Title\" />\n * <Heading size=\"xl\" text=\"Auto h1 from size\" />\n * <Heading size=\"m\" text=\"Auto h3 from size\" />\n * <Heading level={2} text=\"Custom Spacing\" marginBottom=\"32px\" />\n */\nexport const Heading: React.FC<HeadingProps> = ({\n  level,\n  className,\n  text,\n  html,\n  children,\n  size,\n  marginBottom,\n  ...props\n}) => {\n  // Map size to default heading levels (NHS long content pattern)\n  const getDefaultLevelFromSize = (size?: string): 1 | 2 | 3 | 4 | 5 | 6 => {\n    switch (size) {\n      case 'xxl':\n      case 'xl':\n        return 1;\n      case 'l':\n        return 2;\n      case 'm':\n        return 3;\n      case 's':\n        return 4;\n      case 'xs':\n        return 5;\n      default:\n        return 2; // Default fallback\n    }\n  };\n\n  // Use explicit level if provided, otherwise derive from size\n  const headingLevel = level ?? getDefaultLevelFromSize(size);\n  const headingClasses = classNames(\n    'nhsuk-heading',\n    {\n      [`nhsuk-heading--${size}`]: size,\n    },\n    className\n  );\n\n  const content = children || (html ? (\n    <span dangerouslySetInnerHTML={{ __html: html }} />\n  ) : text);\n\n  const tagName = `h${headingLevel}` as 'h1' | 'h2' | 'h3' | 'h4' | 'h5' | 'h6';\n\n  // Apply custom margin-bottom if provided\n  const style = marginBottom ? { ...props.style, marginBottom } : props.style;\n\n  return createElement(\n    tagName,\n    { className: headingClasses, ...props, style },\n    content\n  );\n};\n", "import * as React from 'react';\nimport { Tabs } from '../../../Tabs/Tabs';\nimport { Button } from '../../../Button';\nimport type { TabItem } from '../../../Tabs/Tabs.types';\nimport { ChartContainer, type ChartContainerProps, type LineSeries } from '../../index';\nimport Table from '../../../Tables/Table';\n\nexport interface ChartWithTableTabsProps extends Omit<ChartContainerProps, 'children' | 'tabularData' | 'showTableToggle'> {\n  /** The chart element to render */\n  chart: React.ReactNode;\n  /** Accessible data table (required for tabs; if omitted tabs are disabled) */\n  table?: React.ReactNode;\n  /** Provide line series for auto table generation when table not manually supplied */\n  autoTableFromSeries?: LineSeries[];\n  /** Alignment for auto-generated (and optional consumer provided) table columns.\n   * Provide an array matching column order (including Date/time column if auto generated).\n   * Values: 'left' | 'center' | 'right'. Missing entries default to 'left'.\n   */\n  columnAlign?: Array<'left' | 'center' | 'right'>;\n  /** Enable CSV download button for auto-generated table */\n  enableDownload?: boolean;\n  /** Override default generated filename (without extension) */\n  downloadFilename?: string;\n  /** Label for the chart tab */\n  chartTabLabel?: string;\n  /** Label for the table tab */\n  tableTabLabel?: string;\n  /** Start on table instead of chart */\n  initialView?: 'chart' | 'table';\n  /** Disable tabs and render only the chart (ignores table) */\n  disableTabs?: boolean;\n  /** Force hide the table even if provided (e.g. embed contexts) */\n  hideTable?: boolean;\n  /** Pass extra tab items (appended after built-ins) */\n  additionalTabs?: TabItem[];\n  /** Callback when active tab changes */\n  onViewChange?: (view: 'chart' | 'table' | string) => void;\n}\n\n/**\n * Wrapper providing NHS/GDS style accessible fallback: a tabset switching between chart and underlying data table.\n * Falls back to a single chart view when table not supplied or tabs disabled.\n */\nexport const ChartWithTableTabs: React.FC<ChartWithTableTabsProps> = ({\n  chart,\n  table,\n  autoTableFromSeries,\n  columnAlign,\n  enableDownload = false,\n  downloadFilename,\n  chartTabLabel = 'Chart',\n  tableTabLabel = 'Data table',\n  initialView = 'chart',\n  disableTabs = false,\n  hideTable = false,\n  additionalTabs,\n  onViewChange,\n  title,\n  description,\n  source,\n  width,\n  height,\n  className,\n  id,\n  initiallyShowTable,\n  ...restContainer\n}) => {\n  let resolvedTable = table;\n  if (!resolvedTable && autoTableFromSeries && autoTableFromSeries.length > 0 && !hideTable) {\n  // All columns forced left-aligned (colAlign no longer needed)\n\n    // Build multi-series table: first column Date, subsequent per series\n    const heads = [\n      { text: 'Date', classes: 'nhsuk-table__header--align-left' },\n      ...autoTableFromSeries.map((s) => ({\n        text: s.label || s.id,\n        classes: 'nhsuk-table__header--align-left'\n      }))\n    ];\n\n    // Assume all series share x domain; use longest series for rows\n    const longest = autoTableFromSeries.reduce((a, b) => (b.data.length > a.data.length ? b : a), autoTableFromSeries[0]);\n\n    const rows = longest.data.map((d, rowIdx) => {\n      const dateCell = { text: new Date(d.x as any).toLocaleDateString(), classes: 'nhsuk-table__cell--align-left' };\n      const seriesCells = autoTableFromSeries.map((s) => {\n        const point = s.data[rowIdx];\n        const yVal = point ? point.y : undefined;\n        return {\n          text: yVal === undefined || yVal === null ? '\u2013' : String(yVal),\n          classes: 'nhsuk-table__cell--align-left',\n          header: s.label || s.id\n        };\n      });\n      return [dateCell, ...seriesCells];\n    });\n\n    const filenameBase = downloadFilename || (title ? title.replace(/[^a-z0-9]+/gi, '-').toLowerCase() : 'chart-data');\n    const toCsv = () => {\n      const headerLine = heads.map(h => '\"' + (h.text || '') + '\"').join(',');\n      const body = rows.map(r => r.map(c => '\"' + (c.text ?? '') + '\"').join(',')).join('\\n');\n      return headerLine + '\\n' + body + '\\n';\n    };\n    const handleDownload = () => {\n      try {\n        const blob = new Blob([toCsv()], { type: 'text/csv;charset=utf-8;' });\n        const link = document.createElement('a');\n        const url = URL.createObjectURL(blob);\n        link.href = url;\n        link.download = `${filenameBase}.csv`;\n        link.style.display = 'none';\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n        URL.revokeObjectURL(url);\n      } catch (e) {\n        console.warn('CSV download failed', e);\n      }\n    };\n    resolvedTable = (\n      <div className=\"fdp-chart__auto-table\">\n        {enableDownload && (\n          <div className=\"fdp-chart__download-row\">\n            <Button variant=\"secondary\" onClick={handleDownload} size=\"small\">Download CSV</Button>\n          </div>\n        )}\n        <Table\n          caption={`${title} data`}\n          head={heads}\n          rows={rows}\n          responsive\n        />\n      </div>\n    );\n  }\n\n  const hasTable = !!resolvedTable && !hideTable;\n  const shouldUseTabs = !disableTabs && hasTable;\n\n  if (!shouldUseTabs) {\n    return (\n      <ChartContainer\n        title={title}\n        description={description}\n        source={source}\n        width={width}\n        height={height}\n        className={className}\n        id={id}\n        initiallyShowTable={false}\n        {...restContainer}\n      >\n        {chart}\n      </ChartContainer>\n    );\n  }\n\n  const baseTabs: TabItem[] = [\n    {\n      id: 'chart',\n      label: chartTabLabel,\n      content: (\n        <ChartContainer\n          title={title}\n          description={description}\n          source={source}\n          width={width}\n          height={height}\n          className={className}\n          id={id}\n          initiallyShowTable={false}\n          {...restContainer}\n        >\n          {chart}\n        </ChartContainer>\n      )\n    },\n    {\n      id: 'table',\n      label: tableTabLabel,\n      content: (\n        <div className=\"fdp-chart-table-wrapper\" aria-label={`${title} data table`}>\n          {resolvedTable}\n        </div>\n      )\n    }\n  ];\n\n  const items: TabItem[] = additionalTabs ? [...baseTabs, ...additionalTabs] : baseTabs;\n\n  return (\n    <div className=\"fdp-chart-tabs\" data-chart-with-table>\n      <Tabs\n        items={items}\n        defaultActiveTab={initialView}\n        onTabChange={(tabId: string) => {\n          if (tabId === 'chart' || tabId === 'table') {\n            onViewChange?.(tabId);\n          } else {\n            onViewChange?.(tabId as any);\n          }\n        }}\n      />\n    </div>\n  );\n};\n\nexport default ChartWithTableTabs;\n", "import * as React from 'react';\nimport { pickSeriesColor, pickSeriesStroke, pickRegionColor, pickRegionStroke, pickSeverityColor, pickSeverityStroke, pickOrgLevelColor, pickOrgLevelStroke } from '../../utils/colors';\nimport { useVisibility } from '../../core/VisibilityContext';\n\nexport interface LegendItem {\n  id: string;\n  label: string;\n  color?: string; // explicit override fill colour\n  stroke?: string; // explicit stroke\n  palette?: 'categorical' | 'region' | 'severity' | 'org-level';\n  description?: string; // optional accessible description / tooltip (future)\n  /** Optional pattern data URI (e.g. from patternDataUrl). When provided overlays on top of colour for CVD-friendly distinction. */\n  patternDataUrl?: string;\n}\n\nexport interface LegendProps {\n  /** Legend items. If omitted and a VisibilityProvider is present, auto inference may be added later. */\n  items?: LegendItem[];\n  palette?: 'categorical' | 'region' | 'severity';\n  direction?: 'row' | 'column';\n  /** Make legend interactive \u2013 clicking toggles series visibility */\n  interactive?: boolean;\n  /** If true (default) adjust a white stroke token to dark on white page backgrounds for visibility */\n  adjustStrokeForWhiteBackground?: boolean;\n  /** Controlled hidden ids (when supplied component is controlled) */\n  hiddenIds?: string[];\n  /** Default hidden ids (uncontrolled) */\n  defaultHiddenIds?: string[];\n  /** Callback whenever visibility changes */\n  onVisibilityChange?: (visibleIds: string[], hiddenIds: string[]) => void;\n  /** Optional announcement override; return string describing change */\n  formatAnnouncement?: (id: string, nowVisible: boolean, label: string) => string;\n}\n\n/** Legend with optional interactive show/hide toggling and aria-live announcements */\nexport const Legend: React.FC<LegendProps> = ({\n  items: itemsProp,\n  palette = 'categorical',\n  direction = 'row',\n  interactive = false,\n  adjustStrokeForWhiteBackground = true,\n  hiddenIds,\n  defaultHiddenIds = [],\n  onVisibilityChange,\n  formatAnnouncement\n}) => {\n  const visibility = useVisibility();\n  const contextInteractive = !!(visibility && !interactive && !onVisibilityChange && hiddenIds === undefined);\n  const effectiveInteractive = interactive || contextInteractive;\n  const items = itemsProp || [];\n  const controlled = hiddenIds !== undefined;\n  const [internalHidden, setInternalHidden] = React.useState<Set<string>>(new Set(defaultHiddenIds));\n  const effectiveHidden = controlled ? new Set(hiddenIds) : internalHidden;\n  const [announcement, setAnnouncement] = React.useState('');\n\n  const toggle = (id: string) => {\n    if (contextInteractive && visibility) {\n      const wasHidden = visibility.isHidden(id);\n      visibility.toggle(id);\n      const item = items.find(i => i.id === id);\n      const label = item?.label || id;\n      const msg = formatAnnouncement\n        ? formatAnnouncement(id, wasHidden, label)\n        : `${label} ${wasHidden ? 'shown' : 'hidden'}`;\n      setAnnouncement(msg);\n      return;\n    }\n    if (!effectiveInteractive) return;\n    const next = new Set(effectiveHidden);\n    const wasHidden = next.has(id);\n    if (wasHidden) next.delete(id); else next.add(id);\n    if (!controlled) setInternalHidden(next);\n    const visibleIds = items.filter(i => !next.has(i.id)).map(i => i.id);\n    const hiddenNow = Array.from(next);\n    onVisibilityChange?.(visibleIds, hiddenNow);\n    const item = items.find(i => i.id === id);\n    const label = item?.label || id;\n    const msg = formatAnnouncement\n      ? formatAnnouncement(id, wasHidden, label)\n      : `${label} ${wasHidden ? 'shown' : 'hidden'}`;\n    setAnnouncement(msg);\n  };\n\n  return (\n    <div className=\"fdp-legend-wrapper\">\n      <ul className={`fdp-legend fdp-legend--${direction}`}> \n        {items.map((item, i) => {\n          const effectivePalette = item.palette || palette;\n          const fill = item.color || (\n            effectivePalette === 'region' ? pickRegionColor(item.id, i)\n            : effectivePalette === 'severity' ? pickSeverityColor(item.id, i)\n            : effectivePalette === 'org-level' ? pickOrgLevelColor(item.id, i)\n            : pickSeriesColor(i)\n          );\n          let stroke = item.stroke || (\n            effectivePalette === 'region' ? pickRegionStroke(item.id, i)\n            : effectivePalette === 'severity' ? pickSeverityStroke(item.id, i)\n            : effectivePalette === 'org-level' ? pickOrgLevelStroke(item.id, i)\n            : pickSeriesStroke(i)\n          );\n          if (adjustStrokeForWhiteBackground && stroke) {\n            const norm = stroke.trim().toLowerCase();\n            if (norm === '#fff' || norm === '#ffffff' || norm === 'white' || /^rgb\\(\\s*255\\s*,\\s*255\\s*,\\s*255\\s*\\)$/.test(norm)) {\n              // Override to dark neutral for visibility against white legend background.\n              stroke = '#212b32';\n            }\n          }\n          const hidden = contextInteractive && visibility ? visibility.isHidden(item.id) : effectiveHidden.has(item.id);\n          const btnProps: React.ButtonHTMLAttributes<HTMLButtonElement> = effectiveInteractive ? {\n            'aria-pressed': !hidden,\n            'aria-label': `${item.label} (${hidden ? 'show' : 'hide'})`,\n            onClick: () => toggle(item.id)\n          } : { 'aria-label': item.label };\n          return (\n            <li key={item.id} className={`fdp-legend__item${hidden ? ' fdp-legend__item--hidden' : ''}`}> \n              <button\n                type=\"button\"\n                className=\"fdp-legend__swatch\"\n                style={{\n                  backgroundColor: fill,\n                  backgroundImage: item.patternDataUrl ? `url(${item.patternDataUrl})` : undefined,\n                  backgroundSize: item.patternDataUrl ? 'auto' : undefined,\n                  borderColor: stroke\n                }}\n                {...btnProps}\n              />\n              <span className=\"fdp-legend__label\">{item.label}</span>\n            </li>\n          );\n        })}\n      </ul>\n  {effectiveInteractive && (\n        <div className=\"fdp-visually-hidden\" aria-live=\"polite\" aria-atomic=\"true\">{announcement}</div>\n      )}\n    </div>\n  );\n};\n\nexport default Legend;\n", "import * as React from 'react';\nimport LineChart, { type LineChartProps, type LineSeries } from './charts/LineChart/LineChart';\nimport Legend, { type LegendProps } from './charts/Legend/Legend';\nimport { assignSeriesColors } from './utils/colors';\n\nexport interface FilterableLineChartProps extends Omit<LineChartProps, 'series'> {\n  series: LineSeries[];\n  legendPosition?: 'top' | 'bottom';\n  initialHiddenIds?: string[];\n  hiddenIds?: string[];\n  onHiddenChange?: (hiddenIds: string[], visibleIds: string[]) => void;\n  legendProps?: Omit<LegendProps, 'items' | 'interactive' | 'hiddenIds' | 'onVisibilityChange'>;\n  assignColors?: boolean;\n}\n\nexport const FilterableLineChart: React.FC<FilterableLineChartProps> = ({\n  series,\n  legendPosition = 'top',\n  initialHiddenIds = [],\n  hiddenIds,\n  onHiddenChange,\n  legendProps,\n  assignColors = true,\n  palette = 'categorical',\n  ...lineChartProps\n}) => {\n  const coloured = React.useMemo(() => assignColors ? assignSeriesColors(series, { palette }) : series, [series, assignColors, palette]);\n  const controlled = hiddenIds !== undefined;\n  const [internalHidden, setInternalHidden] = React.useState<Set<string>>(new Set(initialHiddenIds));\n  const hiddenSet = controlled ? new Set(hiddenIds) : internalHidden;\n  const visibleSeries = React.useMemo(() => coloured.filter(s => !hiddenSet.has(s.id)), [coloured, hiddenSet]);\n\n  const handleVisibilityChange = React.useCallback((_visibleIds: string[], nextHiddenIds: string[]) => {\n    if (!controlled) setInternalHidden(new Set(nextHiddenIds));\n    const visibleIds = coloured.filter(s => !nextHiddenIds.includes(s.id)).map(s => s.id);\n    onHiddenChange?.(nextHiddenIds, visibleIds);\n  }, [controlled, coloured, onHiddenChange]);\n\n  const legendItems = React.useMemo(() => coloured.map(s => ({ id: s.id, label: s.label || s.id, color: s.color })), [coloured]);\n\n  const chartEl = <LineChart {...lineChartProps} series={visibleSeries} palette={palette} />;\n  const legendEl = (\n    <Legend\n      {...legendProps}\n      palette={palette}\n      items={legendItems}\n      interactive\n      hiddenIds={Array.from(hiddenSet)}\n      onVisibilityChange={(visible, hidden) => handleVisibilityChange(visible, hidden)}\n    />\n  );\n\n  return (\n    <div className=\"fdp-filterable-line-chart\">\n      {legendPosition === 'top' && legendEl}\n      {chartEl}\n      {legendPosition === 'bottom' && legendEl}\n    </div>\n  );\n};\n\nexport default FilterableLineChart;\n", "import * as React from \"react\";\nimport { createLinePath } from \"../utils/scales\";\nimport { pickSeriesColor, pickRegionColor } from \"../utils/colors\";\nimport { useScaleContext } from \"../core/ScaleContext\";\nimport { useVisibility } from \"../core/VisibilityContext\";\nimport { useTooltipContext } from \"../core/TooltipContext\";\nimport { area as d3Area, curveMonotoneX } from \"d3-shape\";\n\nexport interface AreaDatum {\n\tx: Date | string | number;\n\ty: number;\n}\nexport interface AreaSeries {\n\tid: string;\n\tdata: AreaDatum[];\n\tcolor?: string;\n\tlabel?: string;\n}\n\nexport interface AreaSeriesPrimitiveProps {\n\tseries: AreaSeries;\n\tseriesIndex: number;\n\tpalette: \"categorical\" | \"region\";\n\tfocusablePoints?: boolean; // reserved for future parity with line points\n\tfocusIndex?: number; // reserved for future keyboard focus impl\n\tparseX: (d: AreaDatum) => Date;\n\t/** If true, draws only the area fill (no outline). Default renders both. */\n\tareaOnly?: boolean;\n\t/** Hidden presentation mirrors LineSeriesPrimitive behaviour. */\n\tvisibilityMode?: \"remove\" | \"fade\";\n\t/** Optional baseline (y value) for stacked / diverging future use. Defaults to 0. */\n\tbaselineY?: number;\n\t/** Enable curve smoothing (monotoneX). Defaults to true. */\n\tsmooth?: boolean;\n\t/** Optional stacked data providing per-datum y0/y1 (overrides baselineY & raw y). Length must match series.data. */\n\tstacked?: { y0: number; y1: number }[];\n\t/** When true, uses a vertical gradient (solid at line, transparent at baseline) instead of flat fill. */\n\tgradientFill?: boolean;\n}\n\n/** Renders an area under a line (baseline -> series y). Provides tooltip registration like LineSeriesPrimitive. */\nexport const AreaSeriesPrimitive: React.FC<AreaSeriesPrimitiveProps> = ({\n\tseries,\n\tseriesIndex,\n\tpalette,\n\tparseX,\n\tareaOnly = false,\n\tvisibilityMode = \"remove\",\n\tbaselineY = 0,\n\tsmooth = true,\n\tstacked,\n\tgradientFill = true,\n}) => {\n\tconst scaleCtx = useScaleContext();\n\tif (!scaleCtx) return null;\n\tconst { xScale, yScale } = scaleCtx;\n\tconst visibility = useVisibility();\n\tconst isHidden = visibility?.isHidden(series.id) ?? false;\n\tconst faded = isHidden && visibilityMode === \"fade\";\n\tif (isHidden && visibilityMode === \"remove\") return null;\n\tconst tooltip = useTooltipContext();\n\n\tReact.useEffect(() => {\n\t\tif (!tooltip) return;\n\t\tconst normalized = series.data.map((d) => ({ x: parseX(d), y: d.y }));\n\t\ttooltip.registerSeries(series.id, normalized);\n\t\treturn () => tooltip.unregisterSeries(series.id);\n\t}, [tooltip, series.id, series.data, parseX]);\n\n\tconst color =\n\t\tseries.color ||\n\t\t(palette === \"region\"\n\t\t\t? pickRegionColor(series.id, seriesIndex)\n\t\t\t: pickSeriesColor(seriesIndex));\n\n\t// Build area + optional line with smoothing toggle.\n\t// For stacked series we want the line to trace the TOP boundary (y1), not the raw datum y.\n\tconst linePath = React.useMemo(() => {\n\t\tif (stacked && stacked.length === series.data.length) {\n\t\t\t// createLinePath expects (d: AreaDatum) => number; we derive index via reference equality.\n\t\t\treturn createLinePath(\n\t\t\t\tseries.data,\n\t\t\t\t(d) => xScale(parseX(d)),\n\t\t\t\t(d) => {\n\t\t\t\t\tconst idx = series.data.indexOf(d);\n\t\t\t\t\treturn yScale(stacked[idx].y1);\n\t\t\t\t},\n\t\t\t\t{ smooth }\n\t\t\t);\n\t\t}\n\t\treturn createLinePath(\n\t\t\tseries.data,\n\t\t\t(d) => xScale(parseX(d)),\n\t\t\t(d) => yScale(d.y),\n\t\t\t{ smooth }\n\t\t);\n\t}, [series.data, stacked, xScale, yScale, parseX, smooth]);\n\tconst areaPath = React.useMemo(() => {\n\t\tif (stacked && stacked.length === series.data.length) {\n\t\t\tconst gen = d3Area<AreaDatum & { __y0: number; __y1: number }>()\n\t\t\t\t.x((d) => xScale(parseX(d)))\n\t\t\t\t.y0((_, i) => yScale(stacked[i].y0))\n\t\t\t\t.y1((_, i) => yScale(stacked[i].y1));\n\t\t\tif (smooth) gen.curve(curveMonotoneX);\n\t\t\treturn gen(series.data as any) || \"\";\n\t\t}\n\t\t// Clamp baseline so it never falls below the current y-domain minimum (otherwise the path\n\t\t// can extrapolate off the bottom when the domain has a positive lower bound).\n\t\tconst [domainMin, domainMax] = yScale.domain();\n\t\tlet effectiveBaseline = baselineY;\n\t\tif (effectiveBaseline < domainMin) effectiveBaseline = domainMin;\n\t\telse if (effectiveBaseline > domainMax) effectiveBaseline = domainMax; // safety clamp\n\t\tconst gen = d3Area<AreaDatum>()\n\t\t\t.x((d) => xScale(parseX(d)))\n\t\t\t.y0(() => yScale(effectiveBaseline))\n\t\t\t.y1((d) => yScale(d.y));\n\t\tif (smooth) gen.curve(curveMonotoneX);\n\t\treturn gen(series.data) || \"\";\n\t}, [series.data, stacked, xScale, yScale, parseX, baselineY, smooth]);\n\n\tconst gradientId = React.useId();\n\treturn (\n\t\t<g\n\t\t\tclassName=\"fdp-area-series\"\n\t\t\tdata-series={series.id}\n\t\t\topacity={faded ? 0.25 : 1}\n\t\t\taria-hidden={faded ? true : undefined}\n\t\t>\n\t\t\t{gradientFill && (\n\t\t\t\t<defs>\n\t\t\t\t\t<linearGradient id={gradientId} x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n\t\t\t\t\t\t<stop offset=\"0%\" stopColor={color} stopOpacity={0.25} />\n\t\t\t\t\t\t<stop offset=\"100%\" stopColor={color} stopOpacity={0} />\n\t\t\t\t\t</linearGradient>\n\t\t\t\t</defs>\n\t\t\t)}\n\t\t\t<path\n\t\t\t\tclassName=\"fdp-area-series__fill\"\n\t\t\t\td={areaPath}\n\t\t\t\tfill={gradientFill ? `url(#${gradientId})` : color}\n\t\t\t\t{...(gradientFill ? {} : { fillOpacity: 0.25 })}\n\t\t\t\tstroke=\"none\"\n\t\t\t/>\n\t\t\t{!areaOnly && (\n\t\t\t\t<path d={linePath} fill=\"none\" stroke={color} strokeWidth={1} />\n\t\t\t)}\n\t\t</g>\n\t);\n};\n\nexport default AreaSeriesPrimitive;\n", "import * as React from 'react';\nimport { useScaleContext } from '../core/ScaleContext';\nimport { useVisibility } from '../core/VisibilityContext';\nimport { useTooltipContext } from '../core/TooltipContext';\nimport { useChartContext } from '../core/ChartRoot';\nimport { pickSeriesColor, pickRegionColor, pickSeriesStroke, pickRegionStroke } from '../utils/colors';\n\nexport interface BarDatum { x: Date | string | number; y: number; }\nexport interface BarSeries { id: string; data: BarDatum[]; color?: string; label?: string; barWidth?: number; }\n\nexport interface BarSeriesPrimitiveProps {\n  series: BarSeries;\n  seriesIndex: number;\n  seriesCount: number; // total number of bar series rendered in the group (for width partitioning)\n  palette: 'categorical' | 'region';\n  /** Provide parseX so callers can reuse memoised function across series */\n  parseX: (d: BarDatum) => Date;\n  /** All series in the grouped chart (used for global x step inference on continuous scales to avoid overlap). */\n  allSeries?: BarSeries[];\n  /** Focusable bars (keyboard tab). For large sets you may disable. */\n  focusable?: boolean;\n  /** Width fill factor inside inferred step (0..1) */\n  widthFactor?: number;\n  /** Gap (px) between grouped bars (apportioned inside step) */\n  groupGap?: number;\n  /** Dynamic gap ratio (gap = barWidth * gapRatio) for grouped bars. Overrides static groupGap when provided. Default 0.15 */\n  gapRatio?: number;\n  /** Explicit per-bar width override (px). If provided, inference is skipped (continuous scales). For band scales this is clamped to available slot. */\n  barWidth?: number;\n  /** Adaptive mode: dynamically fill available step width up to an occupancy factor, ignoring widthFactor when continuous. */\n  adaptive?: boolean;\n  /** Fraction (0-1] of the step (distance to next category midpoint) to occupy as total group width in adaptive mode. Default 0.9 */\n  adaptiveGroupOccupancy?: number;\n  /** Minimum bar width (px) for continuous scales. If the inferred uniform bar width would be smaller and it is possible to satisfy the constraint within slot bounds, it will be raised to this value. (No effect for band scales or when explicit barWidth provided.) */\n  minBarWidth?: number;\n  /** Presentation for hidden series (consistency with line). */\n  visibilityMode?: 'remove' | 'fade';\n  /** Color assignment mode: by entire series (default) or per category (datum index within a single series). */\n  colorMode?: 'series' | 'category';\n  /** Optional stacked data: for a stacked vertical bar each datum gets y0,y1 absolute values (pre-normalised if percent). Mutually exclusive with grouped multi-series at same x (i.e., set seriesCount=1 for stacked multi-layer). */\n  stacked?: { y0: number; y1: number }[];\n  /** If true, renders stacked segments individually instead of grouping across series. Provided mainly for future extension (multi-encoded). */\n  stackedMode?: boolean;\n  /** Apply vertical gradient wash (solid at top -> transparent at baseline). Default true. */\n  gradientFill?: boolean;\n  /** When gradientFill is true, match stroke to primary bar colour. If false, fall back to token/dark stroke. Default true. */\n  gradientStrokeMatch?: boolean;\n}\n\n/** Low-level primitive for vertical bars (time / ordinal X via ScaleContext time scale). */\nexport const BarSeriesPrimitive: React.FC<BarSeriesPrimitiveProps> = ({\n  series,\n  seriesIndex,\n  seriesCount,\n  palette,\n  parseX,\n  focusable = true,\n  widthFactor = 0.8,\n  groupGap = 2,\n  barWidth,\n  adaptive = false,\n  adaptiveGroupOccupancy = 0.9,\n  visibilityMode = 'remove'\n  , colorMode = 'series'\n  , allSeries\n  , stacked\n  , gapRatio = 0.15\n  , minBarWidth\n  , gradientFill = true\n  , gradientStrokeMatch = true\n}) => {\n  const effectiveGapRatio = Math.max(0, gapRatio);\n  const scaleCtx = useScaleContext();\n  const chartDims = useChartContext();\n  if (!scaleCtx || !chartDims) return null;\n  const { xScale, yScale } = scaleCtx;\n  const visibility = useVisibility();\n  const isHidden = visibility?.isHidden(series.id) ?? false;\n  const faded = isHidden && visibilityMode === 'fade';\n  if (isHidden && visibilityMode === 'remove') return null;\n  const tooltip = useTooltipContext();\n\n  // Register for tooltip nearest lookup (treat bar top as focus coordinate)\n  React.useEffect(() => {\n    if (!tooltip) return;\n    const normalized = series.data.map(d => ({ x: parseX(d), y: d.y }));\n    tooltip.registerSeries(series.id, normalized);\n    return () => tooltip.unregisterSeries(series.id);\n  }, [tooltip, series.id, series.data, parseX]);\n\n  // Support band scale (categorical) if present, else fall back to pixel inference on continuous scale\n  const isBandScale = typeof (xScale as any).bandwidth === 'function';\n  const bandwidth = isBandScale ? (xScale as any).bandwidth() : undefined;\n  const inferredPixelWidth = React.useMemo(() => {\n    if (bandwidth != null) return bandwidth; // band scale already encodes step\n    // Use global x positions across all series if provided for consistent grouping width\n    const sourceSeries = allSeries && allSeries.length ? allSeries : [series];\n    const posSet: number[] = [];\n    sourceSeries.forEach(s => {\n      s.data.forEach(d => {\n        const v = xScale(parseX(d));\n        if (Number.isFinite(v)) posSet.push(v);\n      });\n    });\n    const pxPositions = posSet.sort((a,b)=>a-b);\n    if (pxPositions.length <= 1) return 40; // fallback width for single bar\n    const diffs: number[] = [];\n    for (let i=1;i<pxPositions.length;i++) diffs.push(pxPositions[i]-pxPositions[i-1]);\n    diffs.sort((a,b)=>a-b);\n    const median = diffs[Math.floor(diffs.length/2)] || 40;\n    return median * widthFactor;\n  }, [series.data, allSeries, xScale, parseX, widthFactor, bandwidth]);\n\n  // Group width = total width occupied by all bars in a group plus base single bar width candidate\n  const { basePerBar } = React.useMemo(() => {\n    // Band scale: derived from bandwidth then optional override (clamped)\n    if (isBandScale) {\n      const bw = inferredPixelWidth; // bandwidth\n      const autoPerBar = Math.max(1, (bw - groupGap * (seriesCount - 1)) / seriesCount);\n      const explicit = series.barWidth ?? barWidth;\n      let finalPerBar = explicit ? Math.min(explicit, bw) : autoPerBar;\n      if (adaptive) {\n        const targetGroup = bw * Math.min(1, Math.max(0.05, adaptiveGroupOccupancy));\n        const adaptedPerBar = Math.max(1, (targetGroup - groupGap * (seriesCount - 1)) / seriesCount);\n        finalPerBar = explicit ? Math.min(finalPerBar, adaptedPerBar) : adaptedPerBar;\n      }\n  return { basePerBar: finalPerBar };\n    }\n    // Continuous scale: explicit override first\n    const explicit = series.barWidth ?? barWidth;\n    // Compute base auto width from inferredPixelWidth (median diff * widthFactor already baked into inferredPixelWidth)\n    const maxAutoPer = Math.max(1, (inferredPixelWidth - groupGap * (seriesCount - 1)) / seriesCount);\n    if (adaptive) {\n      // Recompute step using nearest neighbor distance across global positions for tighter occupancy\n      const sourceSeries = allSeries && allSeries.length ? allSeries : [series];\n      const positions: number[] = [];\n      sourceSeries.forEach(s => s.data.forEach(d => {\n        const v = xScale(parseX(d)); if (Number.isFinite(v)) positions.push(v);\n      }));\n      positions.sort((a,b)=>a-b);\n      const diffs: number[] = [];\n      for (let i=1;i<positions.length;i++) diffs.push(positions[i]-positions[i-1]);\n      diffs.sort((a,b)=>a-b);\n      const step = diffs[Math.floor(diffs.length/2)] || inferredPixelWidth;\n      const targetGroup = step * Math.min(1, Math.max(0.05, adaptiveGroupOccupancy));\n      const adaptivePer = Math.max(1, (targetGroup - groupGap * (seriesCount - 1)) / seriesCount);\n      const finalPer = explicit ? Math.min(explicit, adaptivePer) : adaptivePer;\n  return { basePerBar: finalPer };\n    }\n    if (explicit) {\n      const finalPer = Math.min(explicit, maxAutoPer);\n  return { basePerBar: finalPer };\n    }\n  return { basePerBar: maxAutoPer };\n  }, [isBandScale, inferredPixelWidth, groupGap, seriesCount, barWidth, series.barWidth, adaptive, adaptiveGroupOccupancy, allSeries, xScale, parseX]);\n  // Precompute global centers for continuous scale once\n  const globalCenters = React.useMemo(() => {\n    if (isBandScale) return [] as number[];\n    const pts: number[] = [];\n    const src = allSeries && allSeries.length ? allSeries : [series];\n    src.forEach(s => s.data.forEach(pt => {\n      const v = xScale(parseX(pt));\n      if (Number.isFinite(v)) pts.push(v);\n    }));\n    pts.sort((a,b)=>a-b);\n    return Array.from(new Set(pts));\n  }, [isBandScale, allSeries, series, xScale, parseX]);\n  // Slot bounds for continuous layout: each data center gets a slot from midpoint(prev, current) to midpoint(current, next);\n  // first slot starts at 0, last slot ends at innerWidth -> ensures no overflow beyond plotting area.\n  const continuousSlots = React.useMemo(() => {\n    if (isBandScale) return [] as { center: number; left: number; right: number }[];\n    if (!globalCenters.length) return [];\n    if (globalCenters.length === 1) {\n      return [{ center: globalCenters[0], left: 0, right: chartDims.innerWidth }];\n    }\n    const slots: { center: number; left: number; right: number }[] = [];\n    for (let i=0;i<globalCenters.length;i++) {\n      const c = globalCenters[i];\n      const left = i===0 ? 0 : (globalCenters[i-1] + c)/2;\n      const right = i===globalCenters.length-1 ? chartDims.innerWidth : (c + globalCenters[i+1])/2;\n      slots.push({ center: c, left: Math.max(0,left), right: Math.min(chartDims.innerWidth,right) });\n    }\n    return slots;\n  }, [isBandScale, globalCenters, chartDims.innerWidth]);\n\n  // Uniform group width across all continuous slots so first/last bars are same width.\n  const continuousUniforms = React.useMemo(() => {\n    if (isBandScale || !continuousSlots.length) return undefined as undefined | { groupWidth: number; barWidth: number };\n    const occupancy = Math.min(1, Math.max(0.05, widthFactor));\n    const slotSpans = continuousSlots.map(s => Math.max(2, s.right - s.left));\n    // Candidate width per slot capped by slot span minus a pixel padding, scaled by occupancy\n    const candidates = slotSpans.map(span => Math.max(2, Math.min(span - 1, span * occupancy)));\n    let uniformGroupWidth = Math.min(...candidates);\n    // If a minBarWidth is provided we may be able to expand beyond occupancy (without exceeding any slot span - 1)\n    if (minBarWidth) {\n      if (seriesCount <= 1) {\n        const maxFeasible = Math.min(...slotSpans.map(span => span - 1));\n        if (maxFeasible >= minBarWidth && uniformGroupWidth < minBarWidth) {\n          uniformGroupWidth = Math.min(maxFeasible, minBarWidth);\n        }\n      } else {\n        const maxFeasibleGroup = Math.min(...slotSpans.map(span => span - 1));\n        const requiredGroupForMin = minBarWidth * seriesCount + (seriesCount - 1) * (minBarWidth * effectiveGapRatio);\n        if (requiredGroupForMin <= maxFeasibleGroup && uniformGroupWidth < requiredGroupForMin) {\n          uniformGroupWidth = requiredGroupForMin;\n        }\n      }\n    }\n    if (seriesCount <= 1) {\n      // For single-series continuous bars we can attempt to respect minBarWidth directly (bounded by slot constraints)\n      if (minBarWidth && uniformGroupWidth < minBarWidth) {\n        // Only upgrade if all slots can accommodate minBarWidth (single series so groupWidth == barWidth)\n        const canAllFit = slotSpans.every(span => span >= minBarWidth);\n        if (canAllFit) return { groupWidth: minBarWidth, barWidth: minBarWidth };\n      }\n      return { groupWidth: uniformGroupWidth, barWidth: uniformGroupWidth };\n    }\n    // Solve for barWidth where gap = barWidth * effectiveGapRatio and total group fits uniformGroupWidth\n    // uniformGroupWidth = b*seriesCount + (seriesCount-1)*(b*effectiveGapRatio)\n    // => b = uniformGroupWidth / (seriesCount + (seriesCount-1)*effectiveGapRatio)\n    let b = uniformGroupWidth / (seriesCount + (seriesCount - 1) * effectiveGapRatio);\n    if (b < 1) b = 1; // clamp minimal visibility\n    if (minBarWidth && b < minBarWidth) {\n      // Check if raising to minBarWidth still fits inside the smallest slot span\n      const requiredGroup = minBarWidth * seriesCount + (seriesCount - 1) * (minBarWidth * effectiveGapRatio);\n      if (requiredGroup <= uniformGroupWidth) {\n        b = minBarWidth;\n      }\n    }\n  // Recompute group width using derived b (might be slightly < uniformGroupWidth due to clamping)\n    const groupWidth = b * seriesCount + (seriesCount - 1) * (b * effectiveGapRatio);\n    return { groupWidth, barWidth: b };\n  }, [isBandScale, continuousSlots, widthFactor, seriesCount, effectiveGapRatio, minBarWidth]);\n\n  // innerWidth not needed after uniform span logic (bounds derived from midpoints)\n\n  const baseSeriesColor = series.color || (palette === 'region' ? pickRegionColor(series.id, seriesIndex) : pickSeriesColor(seriesIndex));\n  const baseSeriesStroke = palette === 'region' ? pickRegionStroke(series.id, seriesIndex) : pickSeriesStroke(seriesIndex);\n  const baselineY = Number.isFinite(yScale(0)) ? yScale(0) : yScale.range()[0];\n\n  // If stacked provided, render each datum as a single vertical rect spanning y0->y1 (ignore grouping logic beyond width allocation).\n  const seriesGradientId = React.useId();\n  if (stacked && stacked.length === series.data.length) {\n    // For stacked bars we typically have one BarSeriesPrimitive per stacked layer OR a combined single series with stacked segments? Here we assume one primitive per layer (like stacked areas). Width partition among series becomes full slot per layer (overlap) so we treat seriesCount=1 for geometry.\n    return (\n      <g className=\"fdp-bar-series fdp-bar-series--stacked\" data-series={series.id} opacity={faded ? 0.25 : 1} aria-hidden={faded ? true : undefined}>\n        {gradientFill && (\n          <defs>\n            {/* Vertical gradient from top-left downward (strong at top, soft toward baseline). */}\n            <linearGradient id={seriesGradientId} x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n              <stop offset=\"0%\" stopColor={baseSeriesColor} stopOpacity={0.30} />\n              <stop offset=\"60%\" stopColor={baseSeriesColor} stopOpacity={0.14} />\n              <stop offset=\"100%\" stopColor={baseSeriesColor} stopOpacity={0.06} />\n            </linearGradient>\n          </defs>\n        )}\n        {series.data.map((d, di) => {\n          const rawX = parseX(d);\n          const xPos = isBandScale ? xScale(d.x as any) : xScale(rawX);\n          let fullWidth: number;\n          let barX: number;\n          if (isBandScale) {\n            fullWidth = inferredPixelWidth;\n            barX = xPos;\n          } else {\n            const slot = continuousSlots.find(s => Math.abs(s.center - xPos) < 0.5);\n            if (!slot || !continuousUniforms) {\n              fullWidth = basePerBar; barX = xPos - basePerBar/2;\n            } else {\n              const { groupWidth } = continuousUniforms;\n              fullWidth = groupWidth;\n              let groupLeft = xPos - groupWidth/2;\n              // Clamp within slot\n              if (groupLeft < slot.left) groupLeft = slot.left;\n              if (groupLeft + groupWidth > slot.right) groupLeft = Math.max(slot.left, slot.right - groupWidth);\n              barX = groupLeft;\n            }\n          }\n          const seg = stacked[di];\n          const y0 = yScale(seg.y0);\n          const y1 = yScale(seg.y1);\n          const y = Math.min(y0, y1);\n          const height = Math.abs(y1 - y0) || 1;\n          // Fallback enforcement: ensure minBarWidth respected if possible\n          if (!isBandScale && minBarWidth && fullWidth < minBarWidth) {\n            const slot = continuousSlots.find(s => Math.abs(s.center - xPos) < 0.5);\n            if (slot) {\n              const maxFeasible = Math.max(2, slot.right - slot.left - 1);\n              const target = Math.min(maxFeasible, minBarWidth);\n              if (target > fullWidth) {\n                fullWidth = target;\n                barX = Math.max(slot.left, Math.min(slot.right - fullWidth, xPos - fullWidth / 2));\n              }\n            }\n          }\n          const isFocused = !faded && tooltip?.focused?.seriesId === series.id && tooltip.focused.index === di;\n          const onEnter = () => {\n            if (!tooltip || faded) return;\n            // Use top segment value for focus (y1)\n            tooltip.setFocused({ seriesId: series.id, index: di, x: rawX as any, y: seg.y1 - seg.y0, clientX: barX + fullWidth / 2, clientY: y });\n          };\n           const onLeave = () => { if (tooltip?.focused?.seriesId === series.id && tooltip.focused.index === di) tooltip.clear(); };\n       return (\n             <rect\n               key={di}\n               x={barX}\n               y={y}\n               width={fullWidth}\n               height={height}\n               fill={gradientFill ? `url(#${seriesGradientId})` : baseSeriesColor}\n               {...(!gradientFill ? { fillOpacity: 0.25 } : {})}\n         // Stroke now driven by CSS variable for non-matched gradient strokes (path 2c). Attribute only overrides for focus highlight or when matching base color.\n         stroke={isFocused ? 'var(--nhs-fdp-color-primary-yellow, #ffeb3b)' : (gradientFill && gradientStrokeMatch ? baseSeriesColor : undefined)}\n               strokeWidth={isFocused ? 2 : 1}\n               className=\"fdp-bar fdp-bar--stacked\"\n               tabIndex={faded || !focusable ? -1 : 0}\n               role=\"graphics-symbol\"\n               aria-label={`${series.label || series.id} ${rawX instanceof Date ? rawX.toDateString() : rawX} value ${seg.y1 - seg.y0}`}\n               onMouseEnter={onEnter}\n               onFocus={onEnter}\n               onMouseLeave={onLeave}\n               onBlur={onLeave}\n             />\n           );\n        })}\n      </g>\n    );\n  }\n\n  return (\n    <g className=\"fdp-bar-series\" data-series={series.id} opacity={faded ? 0.25 : 1} aria-hidden={faded ? true : undefined}>\n      {/* Gradients: one per series in series color mode, or per bar when category mode (unique id based on index) */}\n      {gradientFill && (\n        <defs>\n          {colorMode === 'series' && (\n            <linearGradient id={seriesGradientId} x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n              <stop offset=\"0%\" stopColor={baseSeriesColor} stopOpacity={0.30} />\n              <stop offset=\"60%\" stopColor={baseSeriesColor} stopOpacity={0.14} />\n              <stop offset=\"100%\" stopColor={baseSeriesColor} stopOpacity={0.06} />\n            </linearGradient>\n          )}\n          {colorMode === 'category' && series.data.map((d, di) => {\n            const catColor = palette === 'region' ? pickRegionColor(String(d.x), di) : pickSeriesColor(di);\n            const gid = `${seriesGradientId}-${di}`;\n            return (\n              <linearGradient key={gid} id={gid} x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n                <stop offset=\"0%\" stopColor={catColor} stopOpacity={0.30} />\n                <stop offset=\"60%\" stopColor={catColor} stopOpacity={0.14} />\n                <stop offset=\"100%\" stopColor={catColor} stopOpacity={0.06} />\n              </linearGradient>\n            );\n          })}\n        </defs>\n      )}\n      {series.data.map((d, di) => {\n        const rawX = parseX(d);\n        const xPos = isBandScale ? xScale(d.x as any) : xScale(rawX);\n        // For band scale we can position directly within the band; else group logic with inferred group width\n        let barX: number;\n        let barWidth: number;\n        if (isBandScale) {\n          const bw = inferredPixelWidth; // full categorical slot\n          if (seriesCount <= 1) {\n            barWidth = bw;\n            barX = xPos;\n          } else {\n            barWidth = Math.max(1, bw / (seriesCount + (seriesCount - 1) * effectiveGapRatio));\n            const gap = barWidth * effectiveGapRatio;\n            const groupWidth = barWidth * seriesCount + gap * (seriesCount - 1);\n            const groupLeft = xPos + (bw - groupWidth) / 2;\n            barX = groupLeft + seriesIndex * (barWidth + gap);\n          }\n        } else {\n          const slot = continuousSlots.find(s => s.center === xPos);\n          if (!slot || !continuousUniforms) {\n            barWidth = basePerBar; barX = xPos - basePerBar/2;\n            if (minBarWidth && barWidth < minBarWidth) {\n              barWidth = minBarWidth;\n              barX = xPos - barWidth/2;\n            }\n          } else {\n            const { barWidth: uBar } = continuousUniforms;\n            barWidth = uBar;\n            const gap = seriesCount > 1 ? uBar * effectiveGapRatio : 0;\n            const computedGroupWidth = barWidth * seriesCount + gap * (seriesCount - 1);\n            let groupLeft = xPos - computedGroupWidth / 2;\n            if (groupLeft < slot.left) groupLeft = slot.left;\n            if (groupLeft + computedGroupWidth > slot.right) groupLeft = Math.max(slot.left, slot.right - computedGroupWidth);\n            barX = groupLeft + seriesIndex * (barWidth + gap);\n          }\n          // Fallback enforcement for continuous bars\n          if (minBarWidth && barWidth < minBarWidth) {\n            const slot2 = continuousSlots.find(s => Math.abs(s.center - xPos) < 0.5);\n            if (slot2) {\n              const maxFeasible = Math.max(2, slot2.right - slot2.left - 1);\n              const target = Math.min(maxFeasible, minBarWidth);\n              if (target > barWidth) {\n                if (seriesCount <= 1) {\n                  barWidth = target;\n                  barX = Math.max(slot2.left, Math.min(slot2.right - barWidth, xPos - barWidth / 2));\n                } else {\n                  const gap = target * effectiveGapRatio;\n                  const neededGroup = target * seriesCount + gap * (seriesCount - 1);\n                  if (neededGroup <= (slot2.right - slot2.left - 1)) {\n                    barWidth = target;\n                    const groupWidth = neededGroup;\n                    let groupLeft = xPos - groupWidth / 2;\n                    if (groupLeft < slot2.left) groupLeft = slot2.left;\n                    if (groupLeft + groupWidth > slot2.right) groupLeft = Math.max(slot2.left, slot2.right - groupWidth);\n                    barX = groupLeft + seriesIndex * (barWidth + gap);\n                  }\n                }\n              }\n            }\n          }\n        }\n        const barCenterX = barX + (barWidth / 2);\n        const valueY = yScale(d.y);\n        const y = Math.min(baselineY, valueY);\n        const height = Math.abs(baselineY - valueY);\n        const isFocused = !faded && tooltip?.focused?.seriesId === series.id && tooltip.focused.index === di;\n        const onEnter = () => {\n          if (!tooltip || faded) return;\n          tooltip.setFocused({ seriesId: series.id, index: di, x: rawX as any, y: d.y, clientX: barCenterX, clientY: valueY });\n        };\n        const onLeave = () => {\n          if (tooltip?.focused?.seriesId === series.id && tooltip.focused.index === di) tooltip.clear();\n        };\n        const catColor = colorMode === 'category' ? (palette === 'region' ? pickRegionColor(String(d.x), di) : pickSeriesColor(di)) : baseSeriesColor;\n        const fillId = colorMode === 'category' ? `${seriesGradientId}-${di}` : seriesGradientId;\n        const baseStroke = (gradientFill && gradientStrokeMatch)\n          ? catColor\n          : (colorMode === 'category'\n              ? (palette === 'region' ? pickRegionStroke(String(d.x), di) : pickSeriesStroke(di))\n              : baseSeriesStroke);\n        const barStrokeColor = isFocused ? 'var(--nhs-fdp-color-primary-yellow, #ffeb3b)' : (baseStroke || catColor);\n        return (\n          <rect\n            key={di}\n            x={barX}\n            y={y}\n            width={barWidth}\n            height={height || 1} // ensure minimal visibility for zero-height\n            fill={gradientFill ? `url(#${fillId})` : catColor}\n            {...(!gradientFill ? { fillOpacity: 0.25 } : {})}\n            stroke={barStrokeColor}\n            strokeWidth={isFocused ? 2 : 1}\n            className=\"fdp-bar\"\n            tabIndex={faded || !focusable ? -1 : 0}\n            role=\"graphics-symbol\"\n            aria-label={`${series.label || series.id} ${rawX instanceof Date ? rawX.toDateString() : rawX} value ${d.y}`}\n            onMouseEnter={onEnter}\n            onFocus={onEnter}\n            onMouseLeave={onLeave}\n            onBlur={onLeave}\n          />\n        );\n      })}\n    </g>\n  );\n};\n\nexport default BarSeriesPrimitive;\n", "import * as React from 'react';\nimport { scaleBand, scaleLinear } from 'd3-scale';\nimport ScaleContext, { type ScaleContextValue } from './ScaleContext';\nimport { useChartContext } from './ChartRoot';\n\nexport interface BandDatum { x: string; y: number; }\nexport interface BandSeries { data: BandDatum[] }\n\nexport interface BandScalesProviderProps {\n  series: BandSeries[];\n  innerWidth?: number;\n  innerHeight?: number;\n  paddingInner?: number; // band scale inner padding\n  paddingOuter?: number; // band scale outer padding\n  children: React.ReactNode;\n  yTickCount?: number;\n}\n\nexport const BandScalesProvider: React.FC<BandScalesProviderProps> = ({\n  series,\n  innerWidth: iw,\n  innerHeight: ih,\n  paddingInner = 0.1,\n  paddingOuter = 0.05,\n  children,\n  yTickCount = 5\n}) => {\n  const chart = useChartContext();\n  const innerWidth = iw ?? chart?.innerWidth ?? 0;\n  const innerHeight = ih ?? chart?.innerHeight ?? 0;\n  const allData = React.useMemo(() => series.flatMap(s => s.data), [series]);\n  const xDomain = React.useMemo(() => {\n    const set = new Set<string>();\n    allData.forEach(d => set.add(d.x));\n    return Array.from(set);\n  }, [allData]);\n  const yMax = React.useMemo(() => Math.max(0, ...allData.map(d => d.y)), [allData]);\n  const xScale = React.useMemo(() => scaleBand<string>().domain(xDomain).range([0, innerWidth]).paddingInner(paddingInner).paddingOuter(paddingOuter), [xDomain, innerWidth, paddingInner, paddingOuter]);\n  const yScale = React.useMemo(() => scaleLinear().domain([0, yMax]).nice().range([innerHeight, 0]), [yMax, innerHeight]);\n  const value: ScaleContextValue = React.useMemo(() => ({\n    xScale,\n    yScale,\n    getXTicks: () => xDomain as any,\n    getYTicks: (c = yTickCount) => yScale.ticks(c)\n  }), [xScale, yScale, xDomain, yTickCount]);\n  return <ScaleContext.Provider value={value}>{children}</ScaleContext.Provider>;\n};\n\nexport default BandScalesProvider;\n", "import * as React from 'react';\nimport clsx from 'clsx';\nimport '../../DataVisualisation.scss';\nimport { default as Table } from '../../../Tables/Table';\nimport type { TableProps } from '../../../Tables/Table.types';\n\nexport interface ChartNoScriptProps {\n  /** Accessible title for the chart (mirrors ChartContainer usage) */\n  title: string;\n  /** Short description or summary of what the chart shows */\n  description?: string;\n  /** Source string (optional) */\n  source?: string;\n  /** Data table fallback props (passed to internal Table component). Provide at least rows + head OR caption. */\n  table: TableProps;\n  /** Optional className for outer wrapper */\n  className?: string;\n  /** Optional id to stabilise aria attributes */\n  id?: string;\n  /** Message shown above table when scripting disabled / prior to hydration */\n  message?: string;\n  /** If true, always show fallback (useful for forcing SSR mode in tests) */\n  forceFallback?: boolean;\n}\n\n/**\n * ChartNoScript provides an SSR-friendly static fallback for chart content.\n * It renders a figure with a table (data) wrapped in a <noscript> block for browsers\n * with JavaScript disabled. During hydration it can also reveal a progressive\n * enhancement message until the real interactive chart mounts.\n * Usage notes:\n * - Pass structured data via `table` (TableProps). For responsive stacking, set `responsive: true`.\n * - For panel styling, include `panel: true` and optional `panelClasses` inside `table` prop.\n * - After your interactive chart hydrates, add the class `.fdp-chart--enhanced` to the wrapping figure\n *   (or an ancestor) to hide the static fallback table (`[data-fallback-table]`).\n */\nexport const ChartNoScript: React.FC<ChartNoScriptProps> = ({\n  title,\n  description,\n  source,\n  table,\n  className,\n  id,\n  message = 'Interactive chart loading\u2026',\n  forceFallback = false\n}) => {\n  const figureId = React.useId();\n  const resolvedId = id || figureId;\n  const descId = description ? `${resolvedId}-desc` : undefined;\n  const sourceId = source ? `${resolvedId}-src` : undefined;\n\n  // We rely on absence of window during SSR. forceFallback allows tests to simulate.\n  const isHydrated = typeof window !== 'undefined' && !forceFallback;\n\n  return (\n    <figure\n      id={resolvedId}\n      className={clsx('fdp-chart fdp-chart--noscript', className)}\n      aria-labelledby={`${resolvedId}-title`}\n      aria-describedby={clsx(descId, sourceId)}\n      data-component=\"ChartNoScript\"\n    >\n      <header className=\"fdp-chart__header\">\n        <h3 id={`${resolvedId}-title`} className=\"fdp-chart__title\">{title}</h3>\n      </header>\n      {description && (\n        <p id={descId} className=\"fdp-chart__description\">{description}</p>\n      )}\n      {/* Progressive enhancement message (hidden after hydration handled by caller) */}\n      {!isHydrated && (\n        <div className=\"fdp-chart__loading\" role=\"status\" aria-live=\"polite\">{message}</div>\n      )}\n      <div className=\"fdp-chart__fallback\" role=\"group\" aria-label={title}>\n        {/* noscript ensures content visible with JS disabled */}\n        <noscript>\n          <div className=\"fdp-chart__noscript-wrapper\">\n            <Table {...table} />\n          </div>\n        </noscript>\n        {/* Also render table immediately for SSR for SEO / immediate access; hide via CSS when interactive chart replaces */}\n        <div className=\"fdp-chart__table\" data-fallback-table>\n          <Table {...table} />\n        </div>\n      </div>\n      {(source) && (\n        <figcaption className=\"fdp-chart__caption\">\n          {source && (\n            <small id={sourceId} className=\"fdp-chart__source\">Source: {source}</small>\n          )}\n        </figcaption>\n      )}\n    </figure>\n  );\n};\n\nexport default ChartNoScript;\n", "import * as React from 'react';\n\nexport interface ChartEnhancerProps {\n  /**\n   * CSS selector used to locate the chart figure(s) to enhance.\n   * Defaults to 'figure.fdp-chart'. All matches receive the class 'fdp-chart--enhanced'.\n   */\n  selector?: string;\n  /** Optional callback fired after enhancement completes (provides enhanced elements) */\n  onEnhanced?: (elements: HTMLElement[]) => void;\n  /** Optional delay (ms) before applying enhancement (useful for Storybook demos) */\n  delay?: number;\n  /** Children containing one or more chart figures */\n  children: React.ReactNode;\n}\n\n/**\n * ChartEnhancer automatically applies the `.fdp-chart--enhanced` class to any chart figure(s)\n * once the client has hydrated. This hides the static fallback table rendered by `ChartNoScript`\n * while preserving the `<noscript>` content for non\u2011JS scenarios.\n *\n * Example:\n * ```tsx\n * <ChartEnhancer>\n *   <ChartNoScript title=\"KPI\" table={tableProps} />\n *   // Interactive chart mounts here\n * </ChartEnhancer>\n * ```\n */\nconst ChartEnhancer: React.FC<ChartEnhancerProps> = ({ selector = 'figure.fdp-chart', onEnhanced, delay = 0, children }) => {\n  const ref = React.useRef<HTMLDivElement | null>(null);\n\n  React.useEffect(() => {\n    const root = ref.current;\n    if (!root) return;\n    const apply = () => {\n      const figures = Array.from(root.querySelectorAll<HTMLElement>(selector));\n      if (figures.length === 0) return;\n      const newlyEnhanced: HTMLElement[] = [];\n      figures.forEach(fig => {\n        if (!fig.classList.contains('fdp-chart--enhanced')) {\n          fig.classList.add('fdp-chart--enhanced');\n          newlyEnhanced.push(fig);\n        }\n      });\n      if (newlyEnhanced.length && onEnhanced) onEnhanced(newlyEnhanced);\n    };\n    if (delay > 0) {\n      const t = window.setTimeout(apply, delay);\n      return () => window.clearTimeout(t);\n    }\n    apply();\n  }, [selector, onEnhanced, delay]);\n\n  return <div ref={ref}>{children}</div>;\n};\n\nexport default ChartEnhancer;\n", "import * as React from 'react';\nimport clsx from 'clsx';\nimport '../../DataVisualisation.scss';\nimport './MetricCard.scss';\n\nexport type MetricStatus = 'positive' | 'negative' | 'warning' | 'neutral';\nexport type MetricVariant = 'default' | 'primary' | 'secondary' | 'accent' | 'success' | 'warning' | 'error';\n\nexport interface MetricDelta {\n  /** Numeric change (positive, negative or zero). Sign used if direction not supplied. */\n  value: number;\n  /** Override auto direction (derived from value sign when omitted). */\n  direction?: 'up' | 'down' | 'neutral';\n  /** Optional accessible label (e.g. \"+12% compared to last week\"). Auto\u2011generated if omitted. */\n  ariaLabel?: string;\n  /** If true, invert meaning (e.g. lower is better) for auto aria text wording. */\n  invert?: boolean;\n  /** Treat value as percentage and append % sign in visual text (ariaLabel can still override). */\n  isPercent?: boolean;\n  /** Additional context text for the delta (e.g. \"this month\", \"this year\") */\n  period?: string;\n}\n\nexport interface MetricCardProps {\n  /** Primary textual label (short) */\n  label: string;\n  /** Value to display (string or number). When number, valueFormatter can adjust. */\n  value: string | number;\n  /** Unit displayed inline after value (e.g. % or ms) */\n  unit?: string;\n  /** Optional delta / change indicator */\n  delta?: MetricDelta;\n  /** Visual status accent (maps to border / colour modifiers) */\n  status?: MetricStatus;\n  /** Visual variant (maps to DataViz color palette) */\n  variant?: MetricVariant;\n  /** Optional subtitle/description text */\n  subtitle?: string;\n  /** Optional metadata (e.g. \"Latest period: Aug 2025\") */\n  metadata?: string;\n  /** Optional little trend sparkline values (reserved \u2013 visualisation to follow) */\n  trendData?: number[];\n  /** Show skeleton / placeholder instead of value */\n  loading?: boolean;\n  /** Error message overrides normal value layout */\n  error?: string;\n  /** Format numeric value (before unit). Default: locale string */\n  valueFormatter?: (n: number) => string;\n  /** Custom class name */\n  className?: string;\n  /** Stable id (auto generated if omitted) */\n  id?: string;\n  /** Announce delta changes in live region (polite) */\n  announceDelta?: boolean;\n}\n\n/**\n * MetricCard presents a headline KPI value with optional delta (change) and severity/status accent.\n * Features modern DataViz-inspired styling with left border accents and subtle gradients.\n * Accessibility:\n * - Wrapper uses role=\"group\" with aria-labelledby referencing the label.\n * - Delta includes an aria-label conveying direction & magnitude; a live region announces updates.\n * - Colour alone isn't relied on: arrow + sign (+/\u2212) supplied; neutral shows a dash.\n * Future:\n * - `trendData` will enable a miniature sparkline beneath or beside the value.\n */\nexport const MetricCard: React.FC<MetricCardProps> = ({\n  label,\n  value,\n  unit,\n  delta,\n  status = 'neutral',\n  variant = 'default',\n  subtitle,\n  metadata,\n  trendData,\n  loading = false,\n  error,\n  valueFormatter,\n  className,\n  id,\n  announceDelta = true\n}) => {\n  const internalId = React.useId();\n  const baseId = id || internalId;\n  const labelId = `${baseId}-label`;\n  const valueId = `${baseId}-value`;\n  const deltaId = `${baseId}-delta`;\n\n  const isNumber = typeof value === 'number' && !Number.isNaN(value);\n  const formattedValue = loading ? '\u2014' : error ? '' : (isNumber ? (valueFormatter ? valueFormatter(value as number) : (value as number).toLocaleString()) : value);\n\n  let deltaDirection: 'up' | 'down' | 'neutral' | undefined;\n  let visualDelta = '';\n  let deltaAria = '';\n  if (delta && !loading && !error) {\n    deltaDirection = delta.direction || (delta.value > 0 ? 'up' : delta.value < 0 ? 'down' : 'neutral');\n    const absVal = Math.abs(delta.value);\n  const signedDisplay = deltaDirection === 'up' ? `+${absVal}` : deltaDirection === 'down' ? `-${absVal}` : '0';\n  const suffix = delta.isPercent ? '%' : '';\n  // Plain representation (no arrow emojis) per design refinement\n  visualDelta = `${signedDisplay}${suffix}`;\n    if (delta.ariaLabel) {\n      deltaAria = delta.ariaLabel;\n    } else {\n      const better = delta.invert ? (deltaDirection === 'down') : (deltaDirection === 'up');\n      const dirWord = deltaDirection === 'neutral' ? 'no change' : deltaDirection === 'up' ? 'up' : 'down';\n      deltaAria = `${dirWord} ${absVal}${suffix}${deltaDirection === 'neutral' ? '' : better ? ' (improvement)' : ' (worse)'}`;\n    }\n  }\n\n  return (\n    <div\n      className={clsx(\n        'fdp-metric-card',\n        variant && `fdp-metric-card--${variant}`,\n        status && `fdp-metric-card--status-${status}`,\n        loading && 'fdp-metric-card--loading',\n        error && 'fdp-metric-card--error',\n        className\n      )}\n      role=\"group\"\n      aria-labelledby={labelId}\n      data-component=\"MetricCard\"\n    >\n      <div className=\"fdp-metric-card__inner\">\n        <div className=\"fdp-metric-card__header\">\n          <h3 id={labelId} className=\"fdp-metric-card__label\">\n            {label}\n          </h3>\n          {metadata && (\n            <div className=\"fdp-metric-card__metadata\">\n              {metadata}\n            </div>\n          )}\n        </div>\n\n        <div className=\"fdp-metric-card__content\">\n          <div className=\"fdp-metric-card__value-section\">\n            <div id={valueId} className=\"fdp-metric-card__value\">\n              {loading ? (\n                <div className=\"fdp-metric-card__skeleton\" aria-hidden=\"true\">\n                  <div className=\"fdp-metric-card__skeleton-line fdp-metric-card__skeleton-line--value\"></div>\n                </div>\n              ) : error ? (\n                <div className=\"fdp-metric-card__error\" role=\"alert\">\n                  {error}\n                </div>\n              ) : (\n                <>\n                  <span className=\"fdp-metric-card__number\">{formattedValue}</span>\n                  {unit && <span className=\"fdp-metric-card__unit\">{unit}</span>}\n                </>\n              )}\n            </div>\n\n            {subtitle && !loading && !error && (\n              <div className=\"fdp-metric-card__subtitle\">\n                {subtitle}\n              </div>\n            )}\n          </div>\n\n          {delta && !loading && !error && (\n            <div className=\"fdp-metric-card__delta-section\">\n              <div\n                id={deltaId}\n                aria-label={deltaAria}\n                className={clsx(\n                  'fdp-metric-card__delta',\n                  deltaDirection && `fdp-metric-card__delta--${deltaDirection}`\n                )}\n              >\n                <span className=\"fdp-metric-card__delta-value\">\n                  {visualDelta}\n                </span>\n                {delta.period && (\n                  <span className=\"fdp-metric-card__delta-period\">\n                    {delta.period}\n                  </span>\n                )}\n              </div>\n            </div>\n          )}\n\n          {trendData && trendData.length > 0 && !loading && !error && (\n            <div className=\"fdp-metric-card__trend\" aria-hidden=\"true\">\n              {/* Future: mini sparkline visualization */}\n            </div>\n          )}\n        </div>\n\n        {announceDelta && delta && !delta.ariaLabel && !loading && !error && (\n          <div className=\"fdp-visually-hidden\" aria-live=\"polite\">\n            {deltaAria}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default MetricCard;", "import * as React from \"react\";\nimport \"../../DataVisualisation.scss\";\nimport \"./SPCChart.scss\";\nimport { ChartRoot } from \"../../core/ChartRoot\";\nimport { LineScalesProvider, useScaleContext } from \"../../core/ScaleContext\";\nimport { useChartContext } from \"../../core/ChartRoot\";\nimport { useTooltipContext } from \"../../core/TooltipContext\";\nimport Axis from \"../../charts/Axis/Axis\";\nimport GridLines from \"../../charts/GridlLines/GridLines\";\nimport LineSeriesPrimitive from \"../../series/LineSeriesPrimitive\";\n// Replaced generic TooltipOverlay with SPC-specific enriched overlay\nimport SPCTooltipOverlay from \"./SPCTooltipOverlay\";\nimport { TooltipProvider } from \"../../core/TooltipContext\";\nimport VisuallyHiddenLiveRegion from \"../../primitives/VisuallyHiddenLiveRegion\";\nimport { SpcVariationIcon } from \"../SPCIcons/SPCIcon\";\nimport { SPCAssuranceIcon } from \"../SPCIcons/SPCAssuranceIcon\";\nimport { AssuranceResult } from \"../SPCIcons/SPCConstants\";\nimport { Direction } from \"../SPCIcons/SPCConstants\";\n// Design tokens (accessibility colors)\nimport {\n\tbuildSpc,\n\tImprovementDirection,\n\tVariationIcon,\n\tAssuranceIcon,\n\ttype ChartType,\n\ttype SpcSettings,\n} from \"./logic/spc\";\nimport { VariationJudgement, MetricPolarity } from \"../SPCIcons/SPCConstants\";\nimport { extractRuleIds, ruleGlossary, variationLabel } from './logic/spcDescriptors';\n\nexport interface SPCDatum {\n\tx: Date | string | number;\n\ty: number;\n}\nexport interface SPCChartProps {\n\tdata: SPCDatum[];\n\tariaLabel?: string;\n\theight?: number;\n\tshowZones?: boolean;\n\tshowPoints?: boolean;\n\tannounceFocus?: boolean;\n\tclassName?: string;\n\t/** Convenience unit alias (overrides narrationContext.measureUnit). Auto-detected as '%' when all y in [0,1] if not provided */\n\tunit?: string;\n\t/** Highlight points outside 3-sigma */\n\thighlightOutOfControl?: boolean;\n\t/** SPC chart type */\n\tchartType?: ChartType;\n\t/** Direction where higher/lower is better (affects variation + assurance icons) */\n\tmetricImprovement?: ImprovementDirection;\n\t/** Show special-cause coloured point classes */\n\tenableRules?: boolean;\n\t/** Render variation/assurance icons (basic text markers for now) */\n\tshowIcons?: boolean;\n\t/** Render embedded SPC variation icon in chart corner (defaults to true) */\n\tshowEmbeddedIcon?: boolean;\n\t/** Optional targets per point (same length order as data) */\n\ttargets?: (number | null | undefined)[];\n\t/** Baseline flags per point to start new partitions */\n\tbaselines?: (boolean | null | undefined)[];\n\t/** Ghost flags per point (excluded from calc) */\n\tghosts?: (boolean | null | undefined)[];\n\t/** Advanced engine settings (special-cause thresholds, rule toggles, assurance mode) */\n\tsettings?: SpcSettings;\n\t/** Optional contextual metadata used to enrich accessible narration */\n\tnarrationContext?: {\n\t\tmeasureName?: string;\n\t\tmeasureUnit?: string; // e.g. '%', 'ms', 'patients'\n\t\tdatasetContext?: string; // e.g. \"Monthly trust-wide data\"\n\t\torganisation?: string;\n\t\ttimeframe?: string; // free text timeframe summary\n\t\tadditionalNote?: string; // intervention or caveat\n\t};\n\t/** When true, render light gradient band fills behind contiguous sequences of similarly coloured points (concern / improvement / common). */\n\tgradientSequences?: boolean;\n\t/** Stroke width (thickness) of the main process line. Defaults to 1. */\n\tprocessLineWidth?: number;\n}\n\nexport const SPCChart: React.FC<SPCChartProps> = ({\n\tdata,\n\tariaLabel = \"SPC chart\",\n\theight = 260,\n\tshowZones = true,\n\tshowPoints = true,\n\tannounceFocus = false,\n\tclassName,\n\tunit,\n\thighlightOutOfControl = true,\n\tchartType = \"XmR\",\n\tmetricImprovement = ImprovementDirection.Neither,\n\tenableRules = true,\n\tshowIcons = false,\n\tshowEmbeddedIcon = true,\n\ttargets: targetsProp,\n\tbaselines,\n\tghosts,\n\tsettings,\n\tnarrationContext,\n\tgradientSequences = false,\n \tprocessLineWidth = 2,\n}) => {\n\tconst engine = React.useMemo(() => {\n\t\tconst rowsInput = data.map((d, i) => ({\n\t\t\tx: d.x,\n\t\t\tvalue: d.y,\n\t\t\ttarget: targetsProp?.[i] ?? undefined,\n\t\t\tbaseline: baselines?.[i] ?? undefined,\n\t\t\tghost: ghosts?.[i] ?? undefined,\n\t\t}));\n\t\ttry {\n\t\t\treturn buildSpc({\n\t\t\t\tchartType,\n\t\t\t\tmetricImprovement,\n\t\t\t\tdata: rowsInput,\n\t\t\t\tsettings,\n\t\t\t});\n\t\t} catch {\n\t\t\treturn null;\n\t\t}\n\t}, [\n\t\tdata,\n\t\ttargetsProp,\n\t\tbaselines,\n\t\tghosts,\n\t\tchartType,\n\t\tmetricImprovement,\n\t\tsettings,\n\t]);\n\n\t// Representative row with populated limits (last available)\n\tconst engineRepresentative = engine?.rows\n\t\t.slice()\n\t\t.reverse()\n\t\t.find((r) => r.mean != null);\n\tconst mean = engineRepresentative?.mean ?? null;\n\tconst ucl = engineRepresentative?.upperProcessLimit ?? null;\n\tconst lcl = engineRepresentative?.lowerProcessLimit ?? null;\n\tconst onePos = engineRepresentative?.upperOneSigma ?? null;\n\tconst oneNeg = engineRepresentative?.lowerOneSigma ?? null;\n\tconst twoPos = engineRepresentative?.upperTwoSigma ?? null;\n\tconst twoNeg = engineRepresentative?.lowerTwoSigma ?? null;\n\tconst sigma = mean != null && onePos != null ? Math.abs(onePos - mean) : 0;\n\n\t// Force SPC process line to neutral grey (#A6A6A6) to align with default point (common cause) colour.\n\tconst series = React.useMemo(\n\t\t() => [{ id: \"process\", data, color: \"#A6A6A6\" }],\n\t\t[data]\n\t);\n\tconst yDomain = React.useMemo(() => {\n\t\tconst values = data.map((d) => d.y);\n\t\tconst base = [...values];\n\t\t[mean, ucl, lcl, onePos, oneNeg, twoPos, twoNeg].forEach((v) => {\n\t\t\tif (v != null) base.push(v);\n\t\t});\n\t\t// Include any numeric targets so target line never sits outside vertical range\n\t\tif (targetsProp) targetsProp.forEach((t: number | null | undefined) => { if (typeof t === 'number' && !isNaN(t)) base.push(t); });\n\t\tif (!base.length) return undefined;\n\t\treturn [Math.min(...base), Math.max(...base)];\n\t}, [data, mean, ucl, lcl, onePos, oneNeg, twoPos, twoNeg, targetsProp]);\n\n\t// Auto-detect percentage unit when all values in [0,1] and no explicit unit supplied\n\tconst autoUnit = React.useMemo(() => {\n\t\tif (unit || narrationContext?.measureUnit) return undefined;\n\t\tif (!data.length) return undefined;\n\t\treturn data.every(d => d.y >= 0 && d.y <= 1) ? '%' : undefined;\n\t}, [unit, narrationContext?.measureUnit, data]);\n\n\tconst effectiveUnit = unit ?? narrationContext?.measureUnit ?? autoUnit;\n\tconst effectiveNarrationContext = React.useMemo(() => {\n\t\treturn effectiveUnit\n\t\t\t? { ...(narrationContext || {}), measureUnit: effectiveUnit }\n\t\t\t: narrationContext;\n\t}, [narrationContext, effectiveUnit]);\n\n\t// Derive embedded variation icon (now rendered above chart instead of inside SVG)\n\tconst embeddedIcon = React.useMemo(() => {\n\t\tif (!showEmbeddedIcon || !engine?.rows?.length) return null;\n\t\tconst engineRows = engine.rows;\n\t\t// Suppress embedded icon entirely when insufficient non-ghost points to establish stable limits\n\t\tconst minPoints = settings?.minimumPoints ?? 13;\n\t\tconst nonGhostCount = engineRows.filter(r => !r.ghost && r.value != null).length;\n\t\tif (nonGhostCount < minPoints) return null;\n\t\t// Determine if targets exist (no longer used to suppress placeholder; kept for potential future diagnostics)\n\t\t// const hasAnyTargets = (targetsProp?.some(t => typeof t === 'number' && !isNaN(t as any))) ?? false;\n\t\tlet lastIdx = -1;\n\t\tfor (let i = engineRows.length - 1; i >= 0; i--) {\n\t\t\tconst r = engineRows[i];\n\t\t\tif (r && r.value != null && !r.ghost) { lastIdx = i; break; }\n\t\t}\n\t\tif (lastIdx === -1) return null;\n\t\tconst lastRow = engineRows[lastIdx];\n\t\tconst variation = lastRow.variationIcon as VariationIcon | undefined;\n\t\tconst assuranceRaw = lastRow.assuranceIcon as AssuranceIcon | undefined;\n\t\t// Map engine assurance icon (which can be None) to visual AssuranceResult (None -> Uncertain placeholder glyph)\n\t\tconst assuranceRenderStatus: AssuranceResult = assuranceRaw === AssuranceIcon.Pass\n\t\t\t? AssuranceResult.Pass\n\t\t\t: assuranceRaw === AssuranceIcon.Fail\n\t\t\t\t? AssuranceResult.Fail\n\t\t\t\t: AssuranceResult.Uncertain;\n\t\t// Derive a trend/orientation hint for suppressed 'no judgement' cases so the purple arrow points towards the favourable direction\n\t\tlet trend: Direction | undefined = undefined;\n\t\tif (variation === VariationIcon.None) {\n\t\t\t// A suppressed favourable single point will have exactly one of the singlePointAbove/Below flags set\n\t\t\tconst singleHigh = lastRow.specialCauseSinglePointAbove;\n\t\t\tconst singleLow = lastRow.specialCauseSinglePointBelow;\n\t\t\tif (metricImprovement === ImprovementDirection.Up) {\n\t\t\t\t// Higher is favourable: a suppressed high point should orient higher\n\t\t\t\tif (singleHigh) trend = Direction.Higher;\n\t\t\t\telse if (singleLow) trend = Direction.Lower; // defensive (should not be favourable)\n\t\t\t} else if (metricImprovement === ImprovementDirection.Down) {\n\t\t\t\t// Lower is favourable: a suppressed low point should orient lower\n\t\t\t\tif (singleLow) trend = Direction.Lower;\n\t\t\t\telse if (singleHigh) trend = Direction.Higher; // defensive\n\t\t\t} else {\n\t\t\t\t// Neutral metrics: default to higher to preserve legacy layout\n\t\t\t\ttrend = Direction.Higher;\n\t\t\t}\n\t\t}\n\t\tlet judgement: VariationJudgement;\n\t\tswitch (variation) {\n\t\t\tcase VariationIcon.Improvement:\n\t\t\t\tjudgement = VariationJudgement.Improving;\n\t\t\t\tbreak;\n\t\t\tcase VariationIcon.Concern:\n\t\t\t\tjudgement = VariationJudgement.Deteriorating;\n\t\t\t\tbreak;\n\t\t\tcase VariationIcon.None:\n\t\t\t\tjudgement = VariationJudgement.No_Judgement;\n\t\t\t\tbreak;\n\t\t\tcase VariationIcon.Neither:\n\t\t\tdefault:\n\t\t\t\tjudgement = VariationJudgement.None;\n\t\t}\n\t\tlet polarity: MetricPolarity;\n\t\tif (metricImprovement === ImprovementDirection.Up) {\n\t\t\tpolarity = MetricPolarity.HigherIsBetter;\n\t\t} else if (metricImprovement === ImprovementDirection.Down) {\n\t\t\tpolarity = MetricPolarity.LowerIsBetter;\n\t\t} else {\n\t\t\tpolarity = MetricPolarity.ContextDependent;\n\t\t}\n\t\tconst iconSize = 80;\n\t\treturn (\n\t\t\t<div key={`embedded-icon-${lastIdx}`} style={{ display: 'flex', gap: 12, marginRight: 16 }}>\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"fdp-spc-chart__embedded-icon\"\n\t\t\t\t\tdata-variation={String(variation)}\n\t\t\t\t\tdata-variation-judgement={String(judgement)}\n\t\t\t\t\tdata-trend-raw={trend ? String(trend) : 'none'}\n\t\t\t\t\tdata-trend={trend ? String(trend) : 'none'}\n\t\t\t\t\tdata-polarity={String(polarity ?? 'unknown')}\n\t\t\t\t\tstyle={{ width: iconSize, height: iconSize }}\n\t\t\t\t>\n\t\t\t\t\t<SpcVariationIcon\n\t\t\t\t\t\tdropShadow={false}\n\t\t\t\t\t\tdata={{ judgement, polarity, ...(trend ? { trend } : {}) }}\n\t\t\t\t\t\tsize={iconSize}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t{/* Always render assurance icon (mapping 'none' -> Uncertain placeholder) for consistent dual-icon display */}\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"fdp-spc-chart__embedded-assurance-icon\"\n\t\t\t\t\tdata-assurance={String(assuranceRaw)}\n\t\t\t\t\tstyle={{ width: iconSize, height: iconSize }}\n\t\t\t\t>\n\t\t\t\t\t<SPCAssuranceIcon status={assuranceRenderStatus} size={iconSize} dropShadow={false} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}, [showEmbeddedIcon, engine?.rows, metricImprovement, settings?.minimumPoints, targetsProp]);\n\n\treturn (\n\t\t<div className={className ? `fdp-spc-chart-wrapper ${className}` : 'fdp-spc-chart-wrapper'}>\n\t\t\t{/* Top row containing right-aligned embedded variation icon */}\n\t\t\t{showEmbeddedIcon && (\n\t\t\t\t<div className=\"fdp-spc-chart__top-row\" style={{ display: 'flex', justifyContent: 'flex-end', marginBottom: 4 }}>\n\t\t\t\t\t{embeddedIcon}\n\t\t\t\t</div>\n\t\t\t)}\n\t\t\t<ChartRoot\n\t\t\t\theight={height}\n\t\t\t\tariaLabel={ariaLabel}\n\t\t\t\tmargin={{ bottom: 48, left: 56, right: 16, top: 12 }}\n\t\t\t\tclassName={undefined /* avoid duplicating outer class */}\n\t\t\t>\n\t\t\t\t<LineScalesProvider series={series as any} yDomain={yDomain as any}>\n\t\t\t\t\t<InternalSPC\n\t\t\t\t\t\tseries={series as any}\n\t\t\t\t\t\tshowPoints={showPoints}\n\t\t\t\t\t\tannounceFocus={announceFocus}\n\t\t\t\t\t\tlimits={{ mean, ucl, lcl, sigma, onePos, oneNeg, twoPos, twoNeg }}\n\t\t\t\t\t\tshowZones={showZones}\n\t\t\t\t\t\thighlightOutOfControl={highlightOutOfControl}\n\t\t\t\t\t\tengineRows={engine?.rows || null}\n\t\t\t\t\t\tenableRules={enableRules}\n\t\t\t\t\t\tshowIcons={showIcons}\n\t\t\t\t\t\tnarrationContext={effectiveNarrationContext}\n\t\t\t\t\t\tmetricImprovement={metricImprovement}\n\t\t\t\t\t\tgradientSequences={gradientSequences}\n\t\t\t\t\t\tprocessLineWidth={processLineWidth}\n\t\t\t\t\t\teffectiveUnit={effectiveUnit}\n\t\t\t\t\t/>\n\t\t\t\t</LineScalesProvider>\n\t\t\t</ChartRoot>\n\t\t</div>\n\t);\n};\n\ninterface InternalProps {\n\tseries: { id: string; data: SPCDatum[] }[];\n\tshowPoints: boolean;\n\tannounceFocus: boolean;\n\tlimits: {\n\t\tmean?: number | null;\n\t\tucl?: number | null;\n\t\tlcl?: number | null;\n\t\tsigma: number;\n\t\tonePos?: number | null;\n\t\toneNeg?: number | null;\n\t\ttwoPos?: number | null;\n\t\ttwoNeg?: number | null;\n\t};\n\tshowZones: boolean;\n\thighlightOutOfControl: boolean;\n\tengineRows: any[] | null;\n\tenableRules: boolean;\n\tshowIcons: boolean;\n\tnarrationContext?: {\n\t\tmeasureName?: string;\n\t\tmeasureUnit?: string;\n\t\tdatasetContext?: string;\n\t\torganisation?: string;\n\t\ttimeframe?: string;\n\t\tadditionalNote?: string;\n\t};\n\tmetricImprovement?: ImprovementDirection;\n\tgradientSequences: boolean;\n\tprocessLineWidth: number;\n\teffectiveUnit?: string;\n}\n\nconst InternalSPC: React.FC<InternalProps> = ({\n\tseries,\n\tshowPoints,\n\tannounceFocus,\n\tlimits,\n\tshowZones,\n\thighlightOutOfControl,\n\tengineRows,\n\tenableRules,\n\tshowIcons,\n\tnarrationContext,\n\tgradientSequences,\n \tprocessLineWidth,\n\teffectiveUnit,\n}) => {\n\tconst scaleCtx = useScaleContext();\n\tconst chartCtx = useChartContext();\n\tif (!scaleCtx) return null;\n\tconst { xScale, yScale } = scaleCtx;\n\tconst tooltipCtx = useTooltipContext();\n\tconst all = series[0]?.data || [];\n\tconst outOfControl = React.useMemo(() => {\n\t\tif (!limits.ucl && !limits.lcl) return new Set<number>();\n\t\tconst set = new Set<number>();\n\t\tall.forEach((d, i) => {\n\t\t\tif (\n\t\t\t\t(limits.ucl != null && d.y > limits.ucl) ||\n\t\t\t\t(limits.lcl != null && d.y < limits.lcl)\n\t\t\t)\n\t\t\t\tset.add(i);\n\t\t});\n\t\treturn set;\n\t}, [all, limits.ucl, limits.lcl]);\n\n\t// Map engine row signals by index (rowId is 1-based, order preserved relative to data input)\n\tconst engineSignals = React.useMemo(() => {\n\t\tif (!engineRows) return null;\n\t\tconst map: Record<\n\t\t\tnumber,\n\t\t\t{\n\t\t\t\tvariation?: VariationIcon;\n\t\t\t\tassurance?: AssuranceIcon;\n\t\t\t\tspecial?: boolean;\n\t\t\t\tconcern?: boolean;\n\t\t\t\timprovement?: boolean;\n\t\t\t}\n\t\t> = {};\n\t\tengineRows.forEach((r, idx) => {\n\t\t\tif (r.value == null || r.ghost) return;\n\t\t\tconst anySpecial =\n\t\t\t\tr.specialCauseSinglePointAbove ||\n\t\t\t\tr.specialCauseSinglePointBelow ||\n\t\t\t\tr.specialCauseTwoOfThreeAbove ||\n\t\t\t\tr.specialCauseTwoOfThreeBelow ||\n\t\t\t\tr.specialCauseFourOfFiveAbove ||\n\t\t\t\tr.specialCauseFourOfFiveBelow ||\n\t\t\t\tr.specialCauseShiftHigh ||\n\t\t\t\tr.specialCauseShiftLow ||\n\t\t\t\tr.specialCauseTrendIncreasing ||\n\t\t\t\tr.specialCauseTrendDecreasing;\n\t\t\tmap[idx] = {\n\t\t\t\tvariation: r.variationIcon,\n\t\t\t\tassurance: r.assuranceIcon,\n\t\t\t\tspecial: anySpecial,\n\t\t\t\tconcern: r.variationIcon === VariationIcon.Concern,\n\t\t\t\timprovement: r.variationIcon === VariationIcon.Improvement,\n\t\t\t};\n\t\t});\n\t\treturn map;\n\t}, [engineRows]);\n\n\t// Derive a single uniform target (most common current usage) for drawing a horizontal reference line.\n\tconst uniformTarget = React.useMemo(() => {\n\t\tif (!engineRows || !engineRows.length) return null;\n\t\tconst values: number[] = [];\n\t\tfor (const r of engineRows) {\n\t\t\tif (typeof r.target === 'number' && !isNaN(r.target)) values.push(r.target);\n\t\t}\n\t\tif (!values.length) return null;\n\t\tconst first = values[0];\n\t\treturn values.every(v => v === first) ? first : null; // only render when constant across series\n\t}, [engineRows]);\n\n\t// Preprocess categories with singleton coloured point absorption\n\tconst categories = React.useMemo(() => {\n\t\tif (!engineSignals) return [] as ('concern' | 'improvement' | 'common')[];\n\t\tconst raw: ('concern' | 'improvement' | 'common')[] = all.map((_d, i) => {\n\t\t\tconst sig = engineSignals?.[i];\n\t\t\tif (sig?.concern) return 'concern';\n\t\t\tif (sig?.improvement) return 'improvement';\n\t\t\treturn 'common';\n\t\t});\n\t\t// Absorb single coloured point interruptions (concern/improvement) flanked by identical common segments\n\t\tfor (let i = 1; i < raw.length - 1; i++) {\n\t\t\tif ((raw[i] === 'concern' || raw[i] === 'improvement') && raw[i - 1] === 'common' && raw[i + 1] === 'common') {\n\t\t\t\traw[i] = 'common';\n\t\t\t}\n\t\t}\n\t\t// New rule: absorb a single coloured point of one category that sits between two of the *other* coloured category\n\t\t// e.g. improvement (blue) between two concern (orange) points, or vice versa \u2013 treat as inconclusive (common) for wash fill\n\t\tfor (let i = 1; i < raw.length - 1; i++) {\n\t\t\tconst left = raw[i - 1];\n\t\t\tconst mid = raw[i];\n\t\t\tconst right = raw[i + 1];\n\t\t\tif (mid !== 'common' && left !== 'common' && right !== 'common' && left === right && mid !== left) {\n\t\t\t\t// Pattern: A B A with A,B both coloured -> make B common\n\t\t\t\traw[i] = 'common';\n\t\t\t}\n\t\t}\n\t\treturn raw;\n\t}, [engineSignals, all]);\n\n\t// Derive contiguous sequences after absorption\n\tconst sequences = React.useMemo(() => {\n\t\tif (!gradientSequences || !categories.length) return [] as { start: number; end: number; category: 'concern' | 'improvement' | 'common' }[];\n\t\tconst result: { start: number; end: number; category: 'concern' | 'improvement' | 'common' }[] = [];\n\t\tlet runStart = 0;\n\t\tfor (let i = 1; i <= categories.length; i++) {\n\t\t\tconst changed = i === categories.length || categories[i] !== categories[runStart];\n\t\t\tif (changed) {\n\t\t\t\tconst cat = categories[runStart];\n\t\t\t\tconst runEnd = i - 1;\n\t\t\t\tconst runLen = runEnd - runStart + 1;\n\t\t\t\tif (cat === 'common') {\n\t\t\t\t\t// Include all common runs (even single) to avoid gaps.\n\t\t\t\t\tresult.push({ start: runStart, end: runEnd, category: 'common' });\n\t\t\t\t} else {\n\t\t\t\t\t// For coloured runs require length > 1 to show wash (skip isolated coloured point already absorbed earlier if flanked by common)\n\t\t\t\t\tif (runLen > 1) result.push({ start: runStart, end: runEnd, category: cat });\n\t\t\t\t}\n\t\t\t\trunStart = i;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}, [gradientSequences, categories]);\n\n\t// Precompute x positions for boundary calculations (after scales + data available)\n\tconst xPositions = React.useMemo(() => all.map(d => xScale(d.x instanceof Date ? d.x : new Date(d.x))), [all, xScale]);\n\tconst plotWidth = xScale.range()[1];\n\n\t// Build gradient definitions + rects\n\tconst sequenceDefs = React.useMemo(() => {\n\t\tif (!sequences.length) return null;\n\t\treturn (\n\t\t\t<defs>\n\t\t\t\t{sequences.map((seq, idx) => {\n\t\t\t\t\tconst id = `spc-seq-grad-${idx}`;\n\t\t\t\t\tlet baseVar: string;\n\t\t\t\t\tlet top = 0.28, mid = 0.12, end = 0.045; // default (grey/common)\n\t\t\t\t\tswitch (seq.category) {\n\t\t\t\t\t\tcase 'concern':\n\t\t\t\t\t\t\tbaseVar = 'var(--nhs-fdp-color-data-viz-spc-concern, #E46C0A)';\n\t\t\t\t\t\t\t// stronger wash for coloured sequences\n\t\t\t\t\t\t\ttop = 0.28; mid = 0.12; end = 0.045;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'improvement':\n\t\t\t\t\t\t\tbaseVar = 'var(--nhs-fdp-color-data-viz-spc-improvement, #00B0F0)';\n\t\t\t\t\t\t\ttop = 0.26; mid = 0.11; end = 0.045;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tbaseVar = 'var(--nhs-fdp-color-data-viz-spc-common-cause, #A6A6A6)';\n\t\t\t\t\t}\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<linearGradient key={id} id={id} x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n\t\t\t\t\t\t\t<stop offset=\"0%\" stopColor={baseVar} stopOpacity={top} />\n\t\t\t\t\t\t\t<stop offset=\"70%\" stopColor={baseVar} stopOpacity={mid} />\n\t\t\t\t\t\t\t<stop offset=\"100%\" stopColor={baseVar} stopOpacity={end} />\n\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</defs>\n\t\t);\n\t}, [sequences]);\n\n\tconst sequenceAreas = React.useMemo(() => {\n\t\tif (!sequences.length) return null;\n\t\tconst [domainMin] = yScale.domain();\n\t\tconst baseY = yScale(domainMin);\n\t\tconst areas = sequences.map((seq, idx) => {\n\t\t\tconst firstIdx = seq.start;\n\t\t\tconst lastIdx = seq.end;\n\t\t\tconst firstX = xPositions[firstIdx];\n\t\t\tconst lastX = xPositions[lastIdx];\n\t\t\tconst prevX = firstIdx > 0 ? xPositions[firstIdx - 1] : firstX;\n\t\t\tconst nextX = lastIdx < xPositions.length - 1 ? xPositions[lastIdx + 1] : lastX;\n\t\t\t// Boundary midpoints (default behaviour for coloured runs)\n\t\t\tlet left = firstIdx === 0 ? Math.max(0, firstX - (xPositions.length > 1 ? (xPositions[1] - firstX) / 2 : 10)) : (prevX + firstX) / 2;\n\t\t\tlet right = lastIdx === xPositions.length - 1 ? Math.min(plotWidth, lastX + (xPositions.length > 1 ? (lastX - xPositions[xPositions.length - 2]) / 2 : 10)) : (lastX + nextX) / 2;\n\t\t\t// For common-cause (grey) sequences, extend to neighbouring actual point x positions so wash meets coloured washes directly.\n\t\t\tlet extendLeftY: number | null = null;\n\t\t\tlet extendRightY: number | null = null;\n\t\t\tif (seq.category === 'common') {\n\t\t\t\tif (firstIdx > 0) {\n\t\t\t\t\tleft = xPositions[firstIdx - 1];\n\t\t\t\t\t// Always anchor left vertical to previous point's y so wash top aligns with preceding colour block\n\t\t\t\t\textendLeftY = yScale(all[firstIdx - 1].y);\n\t\t\t\t}\n\t\t\t\tif (lastIdx < all.length - 1) {\n\t\t\t\t\tright = xPositions[lastIdx + 1];\n\t\t\t\t\t// Always anchor forward to next point height (even single-point run) for seamless bridge\n\t\t\t\t\textendRightY = yScale(all[lastIdx + 1].y);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// For coloured sequences (concern/improvement) start exactly under first point normally\n\t\t\t\tleft = firstX;\n\t\t\t\t// But if previous point is a different coloured category, extend back to that previous point so seams align at point instead of midpoint\n\t\t\t\tif (firstIdx > 0) {\n\t\t\t\t\tconst prevCat = categories[firstIdx - 1];\n\t\t\t\t\tif (prevCat !== 'common' && prevCat !== seq.category) {\n\t\t\t\t\t\tleft = xPositions[firstIdx - 1];\n\t\t\t\t\t\textendLeftY = yScale(all[firstIdx - 1].y);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Build polygon: left baseline -> vertical up to first point -> through points -> down to baseline at lastX & right midpoint -> close\n\t\t\tlet d = `M ${left} ${baseY}`;\n\t\t\t// Left side ascent: if we extended into previous point (common cause) use its Y, then go to first point\n\t\t\tconst firstY = yScale(all[firstIdx].y);\n\t\t\tif (extendLeftY != null) {\n\t\t\t\t// vertical lift to previous point height\n\t\t\t\td += ` L ${left} ${extendLeftY}`;\n\t\t\t\tif (firstX !== left) d += ` L ${firstX} ${firstY}`;\n\t\t\t} else {\n\t\t\t\t// standard: lift to first point height at left boundary (midpoint)\n\t\t\t\td += ` L ${left} ${firstY}`;\n\t\t\t\tif (firstX !== left) d += ` L ${firstX} ${firstY}`;\n\t\t\t}\n\t\t\tfor (let i = firstIdx; i <= lastIdx; i++) {\n\t\t\t\tconst x = xPositions[i];\n\t\t\t\tconst y = yScale(all[i].y);\n\t\t\t\td += ` L ${x} ${y}`;\n\t\t\t}\n\t\t\t// Right descent: if common run and we extended to next point's x, bridge to that point height before dropping\n\t\t\tif (seq.category === 'common' && extendRightY != null) {\n\t\t\t\t// ensure path includes last point already; connect to next point height to avoid gap\n\t\t\t\tif (right !== lastX) {\n\t\t\t\t\t// draw towards next point height (straight line)\n\t\t\t\t\td += ` L ${right} ${extendRightY}`;\n\t\t\t\t}\n\t\t\t\t// then drop to baseline at right boundary\n\t\t\t\td += ` L ${right} ${baseY} Z`;\n\t\t\t} else {\n\t\t\t\t// standard closure via last point down to baseline then to right boundary baseline\n\t\t\t\td += ` L ${lastX} ${baseY} L ${right} ${baseY} Z`;\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t<path\n\t\t\t\t\tkey={`seq-area-${idx}`}\n\t\t\t\t\td={d}\n\t\t\t\t\tfill={`url(#spc-seq-grad-${idx})`}\n\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\tclassName=\"fdp-spc__sequence-bg\"\n\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t/>\n\t\t\t);\n\t\t});\n\t\treturn <g className=\"fdp-spc__sequence-bgs\">{areas}</g>;\n\t}, [sequences, xPositions, plotWidth, yScale, all]);\n\n\t// Live region formatter (invoked only when announceFocus prop true)\n\t// Derive descriptive timeframe if not explicitly provided\n\tconst computedTimeframe = React.useMemo(() => {\n\t\tif (!narrationContext?.timeframe && all.length >= 2) {\n\t\t\tconst xs = all.map((d) => (d.x instanceof Date ? d.x : new Date(d.x)));\n\t\t\tconst min = new Date(Math.min(...xs.map((d) => d.getTime())));\n\t\t\tconst max = new Date(Math.max(...xs.map((d) => d.getTime())));\n\t\t\tconst diffDays =\n\t\t\t\tMath.round((max.getTime() - min.getTime()) / 86400000) || 0;\n\t\t\tif (diffDays < 14)\n\t\t\t\treturn `The chart shows a timeframe of ${diffDays + 1} days`;\n\t\t\tconst weeks = Math.round(diffDays / 7);\n\t\t\tif (weeks < 20) return `The chart shows a timeframe of ${weeks} weeks`;\n\t\t\tconst months =\n\t\t\t\t(max.getFullYear() - min.getFullYear()) * 12 +\n\t\t\t\t(max.getMonth() - min.getMonth()) +\n\t\t\t\t1; // inclusive months span\n\t\t\treturn `The chart shows a timeframe of ${months} months`;\n\t\t}\n\t\tif (narrationContext?.timeframe) {\n\t\t\treturn `The chart shows a timeframe of ${narrationContext.timeframe}`;\n\t\t}\n\t\treturn undefined;\n\t}, [narrationContext?.timeframe, all]);\n\n\tconst ordinal = (n: number) => {\n\t\tconst mod10 = n % 10,\n\t\t\tmod100 = n % 100;\n\t\tif (mod10 === 1 && mod100 !== 11) return `${n}st`;\n\t\tif (mod10 === 2 && mod100 !== 12) return `${n}nd`;\n\t\tif (mod10 === 3 && mod100 !== 13) return `${n}rd`;\n\t\treturn `${n}th`;\n\t};\n\tconst formatDateLong = (d: Date) =>\n\t\t`${ordinal(d.getDate())} ${d.toLocaleString(\"en-GB\", { month: \"long\" })}, ${d.getFullYear()}`;\n\n\tconst formatLive = React.useCallback(\n\t\t({ index, x, y }: { seriesId: string; x: Date; y: number; index: number }) => {\n\t\t\tconst row = engineRows?.[index];\n\t\t\tconst dateObj = x instanceof Date ? x : new Date(x);\n\t\t\tconst dateLabel = formatDateLong(dateObj);\n\t\t\tconst unit = narrationContext?.measureUnit ? ` ${narrationContext.measureUnit}` : \"\";\n\t\t\tconst measure = narrationContext?.measureName ? ` ${narrationContext.measureName}` : \"\";\n\t\t\tif (!row) {\n\t\t\t\treturn `General summary is: ${computedTimeframe ? computedTimeframe + \". \" : \"\"}Point ${index + 1}, ${dateLabel}, ${y}${unit}${measure}`;\n\t\t\t}\n\t\t\tconst varLabel = variationLabel(row.variationIcon) || \"Variation\";\n\t\t\tconst ruleIds = extractRuleIds(row);\n\t\t\tconst ruleNarr = ruleIds.length\n\t\t\t\t? ` Rules: ${[...new Set(ruleIds.map(r => ruleGlossary[r].narration))].join(\"; \")}.`\n\t\t\t\t: \" No special cause rules.\";\n\t\t\tconst ctxParts: string[] = [];\n\t\t\tif (narrationContext?.measureName) ctxParts.push(`Measure: ${narrationContext.measureName}.`);\n\t\t\tif (narrationContext?.datasetContext) ctxParts.push(`${narrationContext.datasetContext}.`);\n\t\t\tif (narrationContext?.organisation) ctxParts.push(`Organisation: ${narrationContext.organisation}.`);\n\t\t\tif (narrationContext?.additionalNote) ctxParts.push(narrationContext.additionalNote);\n\t\t\treturn [\n\t\t\t\t`General summary is:`,\n\t\t\t\t...ctxParts,\n\t\t\t\t`Point ${index + 1} recorded on `,\n\t\t\t\tdateLabel + \",\",\n\t\t\t\t`with a value of ${y} ${unit}${measure}`,\n\t\t\t\tvarLabel + \".\",\n\t\t\t\truleNarr,\n\t\t\t]\n\t\t\t\t.join(\" \")\n\t\t\t\t.replace(/\\s+/g, \" \")\n\t\t\t\t.trim();\n\t\t},\n\t\t[engineRows, narrationContext, computedTimeframe]\n\t);\n\n\t// Per-point aria-description (long form) reusing formatLive but omitting leading \"Point N\" for brevity.\n\tconst describePoint = React.useCallback(\n\t\t(index: number, d: SPCDatum): string | undefined => {\n\t\t\tconst row = engineRows?.[index];\n\t\t\tif (!row) return undefined;\n\t\t\tconst base = formatLive({\n\t\t\t\tindex,\n\t\t\t\tseriesId: \"process\",\n\t\t\t\tx: d.x instanceof Date ? d.x : new Date(d.x),\n\t\t\t\ty: d.y,\n\t\t\t});\n\t\t\t// Remove leading \"Point N \" if present to reduce repetition when screen reader announces label then description.\n\t\t\treturn base\n\t\t\t\t.replace(/^General summary is:\\s*/, \"\")\n\t\t\t\t.replace(/^Point \\d+\\s*/, \"\");\n\t\t},\n\t\t[engineRows, formatLive]\n\t);\n\n\treturn (\n\t\t<TooltipProvider>\n\t\t\t<div\n\t\t\t\tclassName=\"fdp-spc-chart\"\n\t\t\t\trole=\"group\"\n\t\t\t\taria-label=\"Statistical process control chart\"\n\t\t\t\taria-roledescription=\"chart\"\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\twidth={scaleCtx.xScale.range()[1] + 56 + 16}\n\t\t\t\t\theight={scaleCtx.yScale.range()[0] + 12 + 48}\n\t\t\t\t\trole=\"img\"\n\t\t\t\t>\n\t\t\t\t\t<g transform={`translate(56,12)`}>\n\t\t\t\t\t\t<Axis type=\"x\" />\n\t\t\t\t\t\t<Axis type=\"y\" />\n\t\t\t\t\t\t<GridLines axis=\"y\" />\n\t\t\t\t\t\t{sequenceDefs}\n\t\t\t\t\t\t{sequenceAreas}\n\t\t\t\t\t\t{limits.mean != null && (\n\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\tclassName=\"fdp-spc__cl\"\n\t\t\t\t\t\t\t\tx1={0}\n\t\t\t\t\t\t\t\tx2={xScale.range()[1]}\n\t\t\t\t\t\t\t\ty1={yScale(limits.mean)}\n\t\t\t\t\t\t\t\ty2={yScale(limits.mean)}\n\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{uniformTarget != null && (\n\t\t\t\t\t\t\t// Render later (after limits) for stacking; temporary placeholder (moved below)\n\t\t\t\t\t\t\t<></>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{limits.ucl != null && (\n\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\tclassName=\"fdp-spc__limit fdp-spc__limit--ucl\"\n\t\t\t\t\t\t\t\tx1={0}\n\t\t\t\t\t\t\t\tx2={xScale.range()[1]}\n\t\t\t\t\t\t\t\ty1={yScale(limits.ucl)}\n\t\t\t\t\t\t\t\ty2={yScale(limits.ucl)}\n\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\tstrokeWidth={2}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{limits.lcl != null && (\n\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\tclassName=\"fdp-spc__limit fdp-spc__limit--lcl\"\n\t\t\t\t\t\t\t\tx1={0}\n\t\t\t\t\t\t\t\tx2={xScale.range()[1]}\n\t\t\t\t\t\t\t\ty1={yScale(limits.lcl)}\n\t\t\t\t\t\t\t\ty2={yScale(limits.lcl)}\n\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\tstrokeWidth={2}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{/* Target line drawn after limits for clear visibility */}\n\t\t\t\t\t\t{uniformTarget != null && (\n\t\t\t\t\t\t\t<g aria-hidden=\"true\" className=\"fdp-spc__target-group\">\n\t\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc__target\"\n\t\t\t\t\t\t\t\t\tdata-testid=\"spc-target-line\"\n\t\t\t\t\t\t\t\t\tx1={0}\n\t\t\t\t\t\t\t\t\tx2={xScale.range()[1]}\n\t\t\t\t\t\t\t\t\ty1={yScale(uniformTarget)}\n\t\t\t\t\t\t\t\t\ty2={yScale(uniformTarget)}\n\t\t\t\t\t\t\t\t\tstrokeWidth={2.5}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<text\n\t\t\t\t\t\t\t\t\tdata-testid=\"spc-target-label\"\n\t\t\t\t\t\t\t\t\tx={xScale.range()[0] - 7}\n\t\t\t\t\t\t\t\t\ty={yScale(uniformTarget) - 5}\n\t\t\t\t\t\t\t\t\ttextAnchor=\"start\"\n\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc__target-label\"\n\t\t\t\t\t\t\t\t\tfontSize={12}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tTarget {uniformTarget} {effectiveUnit || narrationContext?.measureUnit || ''}\n\t\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{showZones && limits.mean != null && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{limits.onePos != null && (\n\t\t\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc__zone fdp-spc__zone--pos1\"\n\t\t\t\t\t\t\t\t\t\tx1={0}\n\t\t\t\t\t\t\t\t\t\tx2={xScale.range()[1]}\n\t\t\t\t\t\t\t\t\t\ty1={yScale(limits.onePos)}\n\t\t\t\t\t\t\t\t\t\ty2={yScale(limits.onePos)}\n\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t\tstrokeWidth={2}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t{limits.oneNeg != null && (\n\t\t\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc__zone fdp-spc__zone--neg1\"\n\t\t\t\t\t\t\t\t\t\tx1={0}\n\t\t\t\t\t\t\t\t\t\tx2={xScale.range()[1]}\n\t\t\t\t\t\t\t\t\t\ty1={yScale(limits.oneNeg)}\n\t\t\t\t\t\t\t\t\t\ty2={yScale(limits.oneNeg)}\n\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t\tstrokeWidth={2}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t{limits.twoPos != null && (\n\t\t\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc__zone fdp-spc__zone--pos2\"\n\t\t\t\t\t\t\t\t\t\tx1={0}\n\t\t\t\t\t\t\t\t\t\tx2={xScale.range()[1]}\n\t\t\t\t\t\t\t\t\t\ty1={yScale(limits.twoPos)}\n\t\t\t\t\t\t\t\t\t\ty2={yScale(limits.twoPos)}\n\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t\tstrokeWidth={2}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t{limits.twoNeg != null && (\n\t\t\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc__zone fdp-spc__zone--neg2\"\n\t\t\t\t\t\t\t\t\t\tx1={0}\n\t\t\t\t\t\t\t\t\t\tx2={xScale.range()[1]}\n\t\t\t\t\t\t\t\t\t\ty1={yScale(limits.twoNeg)}\n\t\t\t\t\t\t\t\t\t\ty2={yScale(limits.twoNeg)}\n\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t\tstrokeWidth={2}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<LineSeriesPrimitive\n\t\t\t\t\t\t\tseries={series[0] as any}\n\t\t\t\t\t\t\tseriesIndex={0}\n\t\t\t\t\t\t\tpalette=\"categorical\"\n\t\t\t\t\t\t\tshowPoints={false}\n\t\t\t\t\t\t\tfocusablePoints={false}\n\t\t\t\t\t\t\tfocusIndex={-1}\n\t\t\t\t\t\t\tparseX={(d: SPCDatum) =>\n\t\t\t\t\t\t\t\td.x instanceof Date ? d.x : new Date(d.x)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsmooth={false}\n\t\t\t\t\t\t\tstrokeWidth={processLineWidth}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{showPoints &&\n\t\t\t\t\t\t\tall.map((d, i) => {\n\t\t\t\t\t\t\t\tconst cx = xScale(d.x instanceof Date ? d.x : new Date(d.x));\n\t\t\t\t\t\t\t\tconst cy = yScale(d.y);\n\t\t\t\t\t\t\t\tconst ooc = outOfControl.has(i);\n\t\t\t\t\t\t\t\tconst sig = engineSignals?.[i];\n\t\t\t\t\t\t\t\tconst classes = [\n\t\t\t\t\t\t\t\t\t\"fdp-spc__point\",\n\t\t\t\t\t\t\t\t\tooc && highlightOutOfControl ? \"fdp-spc__point--ooc\" : null,\n\t\t\t\t\t\t\t\t\tenableRules && sig?.special && sig.concern\n\t\t\t\t\t\t\t\t\t\t? \"fdp-spc__point--sc-concern\"\n\t\t\t\t\t\t\t\t\t\t: null,\n\t\t\t\t\t\t\t\t\tenableRules && sig?.special && sig.improvement\n\t\t\t\t\t\t\t\t\t\t? \"fdp-spc__point--sc-improvement\"\n\t\t\t\t\t\t\t\t\t\t: null,\n\t\t\t\t\t\t\t\t\tsig?.assurance === AssuranceIcon.Pass\n\t\t\t\t\t\t\t\t\t\t? \"fdp-spc__point--assurance-pass\"\n\t\t\t\t\t\t\t\t\t\t: null,\n\t\t\t\t\t\t\t\t\tsig?.assurance === AssuranceIcon.Fail\n\t\t\t\t\t\t\t\t\t\t? \"fdp-spc__point--assurance-fail\"\n\t\t\t\t\t\t\t\t\t\t: null,\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t.filter(Boolean)\n\t\t\t\t\t\t\t\t\t.join(\" \");\n\t\t\t\t\t\t\t\tconst ariaLabel =\n\t\t\t\t\t\t\t\t\t`Point ${i + 1} value ${d.y}` +\n\t\t\t\t\t\t\t\t\t(sig?.special ? \" special cause\" : \"\") +\n\t\t\t\t\t\t\t\t\t(sig?.variation === VariationIcon.Improvement\n\t\t\t\t\t\t\t\t\t\t? \" improving\"\n\t\t\t\t\t\t\t\t\t\t: sig?.variation === VariationIcon.Concern\n\t\t\t\t\t\t\t\t\t\t\t? \" concern\"\n\t\t\t\t\t\t\t\t\t\t\t: \"\");\n\t\t\t\t\t\t\t\t// Removed per refined ARIA approach: rely on tooltip via aria-describedby for detailed context\n\t\t\t\t\t\t\t\tconst isFocused = tooltipCtx?.focused?.index === i;\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<circle\n\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\tcx={cx}\n\t\t\t\t\t\t\t\t\t\tcy={cy}\n\t\t\t\t\t\t\t\t\t\tr={5} // unified radius for consistency across all points\n\t\t\t\t\t\t\t\t\t\tclassName={classes}\n\t\t\t\t\t\t\t\t\t\tdata-variation={sig?.variation}\n\t\t\t\t\t\t\t\t\t\tdata-assurance={sig?.assurance}\n\t\t\t\t\t\t\t\t\t\taria-label={ariaLabel}\n\t\t\t\t\t\t\t\t\t\t{...(isFocused ? { 'aria-describedby': `spc-tooltip-${i}` } : {})}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t{showIcons &&\n\t\t\t\t\t\t\tenableRules &&\n\t\t\t\t\t\t\tengineSignals &&\n\t\t\t\t\t\t\tall.map((d, i) => {\n\t\t\t\t\t\t\t\tconst sig = engineSignals[i];\n\t\t\t\t\t\t\t\tif (!sig) return null;\n\t\t\t\t\t\t\t\tif (!(sig.concern || sig.improvement)) return null;\n\t\t\t\t\t\t\t\tconst rawX = xScale(d.x instanceof Date ? d.x : new Date(d.x));\n\t\t\t\t\t\t\t\tconst rawPointY = yScale(d.y);\n\t\t\t\t\t\t\t\tlet iconY = rawPointY - 10; // preferred: above point\n\t\t\t\t\t\t\t\tconst topPadding = 12; // must stay >= group translate y (12) for visibility\n\t\t\t\t\t\t\t\tconst bottomLimit = yScale.range()[0] - 4; // small bottom padding\n\t\t\t\t\t\t\t\tif (iconY < topPadding) {\n\t\t\t\t\t\t\t\t\t// If too close to top, place below point instead (avoids clipping + overlap)\n\t\t\t\t\t\t\t\t\t// When forced below the point, add extra 10px vertical gap for clarity\n\t\t\t\t\t\t\t\t\ticonY = Math.min(rawPointY + 16, bottomLimit);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// Horizontal clamp so text anchor centre doesn't overflow\n\t\t\t\t\t\t\t\tconst plotWidth = xScale.range()[1];\n\t\t\t\t\t\t\t\tconst iconX = Math.min(Math.max(rawX, 0), plotWidth - 0);\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<text\n\t\t\t\t\t\t\t\t\t\tkey={`icon-${i}`}\n\t\t\t\t\t\t\t\t\t\tx={iconX}\n\t\t\t\t\t\t\t\t\t\ty={iconY}\n\t\t\t\t\t\t\t\t\t\ttextAnchor=\"middle\"\n\t\t\t\t\t\t\t\t\t\tclassName={`fdp-spc__icon ${sig.concern ? \"fdp-spc__icon--concern\" : \"fdp-spc__icon--improvement\"}`}\n\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{sig.concern ? \"!\" : \"\u2605\"}\n\t\t\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t{/* Pointer / keyboard interaction layer (covers plot area) */}\n\t\t\t\t\t\t{chartCtx && (\n\t\t\t\t\t\t\t<InteractionLayer\n\t\t\t\t\t\t\t\twidth={xScale.range()[1]}\n\t\t\t\t\t\t\t\theight={yScale.range()[0]}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<SPCTooltipOverlay\n\t\t\t\t\t\t\tengineRows={engineRows}\n\t\t\t\t\t\t\tlimits={{ mean: limits.mean, sigma: limits.sigma }}\n\t\t\t\t\t\t\tpointDescriber={describePoint}\n\t\t\t\t\t\t\tmeasureName={narrationContext?.measureName}\n\t\t\t\t\t\t\tmeasureUnit={narrationContext?.measureUnit}\n\t\t\t\t\t\t\tdateFormatter={(d: Date) => formatDateLong(d)}\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t</g>\n\t\t\t\t</svg>\n\t\t\t\t{announceFocus && (\n\t\t\t\t\t<VisuallyHiddenLiveRegion\n\t\t\t\t\t\tformat={(d) =>\n\t\t\t\t\t\t\tformatLive({ ...d, x: d.x instanceof Date ? d.x : new Date(d.x) })\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</TooltipProvider>\n\t);\n};\n\n// Transparent rectangle capturing pointer + keyboard events to drive tooltip focus\nconst InteractionLayer: React.FC<{ width: number; height: number }> = ({\n\twidth,\n\theight,\n}) => {\n\tconst t = useTooltipContext();\n\tif (!t) return null;\n\treturn (\n\t\t<rect\n\t\t\tclassName=\"fdp-spc__interaction-layer\"\n\t\t\twidth={width}\n\t\t\theight={height}\n\t\t\tfill=\"transparent\"\n\t\t\ttabIndex={0}\n\t\t\taria-label=\"Interactive chart area. Use arrow keys to move between points.\"\n\t\t\tonMouseMove={(e) => {\n\t\t\t\tconst target = e.currentTarget as SVGRectElement;\n\t\t\t\tconst bounds = target.getBoundingClientRect();\n\t\t\t\tconst x = e.clientX - bounds.left;\n\t\t\t\tconst y = e.clientY - bounds.top;\n\t\t\t\tt.focusNearest(x, y);\n\t\t\t}}\n\t\t\tonMouseLeave={() => t.clear()}\n\t\t\tonKeyDown={(e) => {\n\t\t\t\tswitch (e.key) {\n\t\t\t\t\tcase \"ArrowRight\":\n\t\t\t\t\t\tt.focusNextPoint();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"ArrowLeft\":\n\t\t\t\t\t\tt.focusPrevPoint();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"ArrowDown\":\n\t\t\t\t\t\tt.focusNextSeries();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"ArrowUp\":\n\t\t\t\t\t\tt.focusPrevSeries();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Home\":\n\t\t\t\t\t\tt.focusFirstPoint();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"End\":\n\t\t\t\t\t\tt.focusLastPoint();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}}\n\t\t\tstyle={{ cursor: \"crosshair\" }}\n\t\t/>\n\t);\n};\n\nexport { ImprovementDirection, VariationIcon, AssuranceIcon };\nexport default SPCChart;\n", "import * as React from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { useTooltipContext } from \"../../core/TooltipContext\";\nimport { useChartContext } from \"../../core/ChartRoot\";\n// pickSeriesColor intentionally not used in SPC tooltip overlay; keep import commented for future use\n// import { pickSeriesColor } from \"../../utils/colors\";\n// AssuranceIcon import removed (utility based)\nimport {\n\textractRuleIds,\n\truleGlossary,\n\tvariationLabel,\n\tassuranceLabel,\n\tzoneLabel,\n} from \"./logic/spcDescriptors\";\nimport { getVariationColorToken } from \"./logic/spcDescriptors\";\nimport { Tag } from \"../../../Tag\";\n\ninterface SPCTooltipOverlayProps {\n\tengineRows: any[] | null;\n\tlimits: { mean?: number | null; sigma: number };\n\t/** Optional callback to produce rich aria / tooltip narrative for a point (index, SPCDatum-like) */\n\tpointDescriber?: (\n\t\tindex: number,\n\t\td: { x: Date | string | number; y: number }\n\t) => string | undefined;\n\t/** Optional measure name for richer value line e.g. \"85 % Hand Washing Compliance\" */\n\tmeasureName?: string;\n\t/** Optional unit e.g. '%', 'ms' */\n\tmeasureUnit?: string;\n\t/** Optional date formatter (defaults to toDateString) */\n\tdateFormatter?: (d: Date) => string;\n}\n\n/**\n * SPC specific tooltip overlay enriching the basic overlay with:\n *  - Variation / assurance interpretation (improvement vs concern)\n *  - Specific special-cause rule(s) that triggered for the point\n *  - Zone classification relative to mean (inside 1\u03C3, 1\u20132\u03C3, 2\u20133\u03C3, >3\u03C3)\n */\nconst SPCTooltipOverlay: React.FC<SPCTooltipOverlayProps> = ({\n\tengineRows,\n\tlimits,\n\tpointDescriber,\n\tmeasureName,\n\tmeasureUnit,\n\tdateFormatter,\n}) => {\n\tconst tooltip = useTooltipContext();\n\tconst chart = useChartContext();\n\n\t// Sticky tooltip behaviour: retain last focused point while user hovers tooltip surface.\n\t// Hooks must run every render (even when no point focused) to keep order stable.\n\tconst [cachedFocus, setCachedFocus] = React.useState<any | null>(null);\n\tconst [hoveringTooltip, setHoveringTooltip] = React.useState(false);\n\tconst hideTimeoutRef = React.useRef<number | null>(null);\n\n\t// When context focus changes to a real point, cache it\n\tReact.useEffect(() => {\n\t\tif (!tooltip) return; // no context yet\n\t\tif (tooltip.focused) {\n\t\t\tsetCachedFocus(tooltip.focused);\n\t\t\tif (hideTimeoutRef.current) {\n\t\t\t\tcancelAnimationFrame(hideTimeoutRef.current);\n\t\t\t\thideTimeoutRef.current = null;\n\t\t\t}\n\t\t}\n\t\tif (!tooltip.focused && !hoveringTooltip) {\n\t\t\tconst id = requestAnimationFrame(() => {\n\t\t\t\tsetCachedFocus(null);\n\t\t\t\thideTimeoutRef.current = null;\n\t\t\t});\n\t\t\thideTimeoutRef.current = id;\n\t\t}\n\t\treturn () => {\n\t\t\tif (hideTimeoutRef.current) {\n\t\t\t\tcancelAnimationFrame(hideTimeoutRef.current);\n\t\t\t\thideTimeoutRef.current = null;\n\t\t\t}\n\t\t};\n\t}, [tooltip, tooltip?.focused, hoveringTooltip]);\n\n\t// Determine current focused point (may be null). No early returns until AFTER all hooks declared.\n\tconst focused =\n\t\ttooltip &&\n\t\t(tooltip.focused || (hoveringTooltip ? cachedFocus : null) || cachedFocus);\n\n\t// Visibility animation hooks MUST run every render to keep ordering stable.\n\tconst [visible, setVisible] = React.useState(false);\n\tReact.useEffect(() => {\n\t\tconst id = requestAnimationFrame(() => setVisible(true));\n\t\treturn () => cancelAnimationFrame(id);\n\t}, [focused?.index]);\n\n\t// Safe metrics (fallback to 0 if chart not ready so calculations still defined)\n\tconst innerWidth = chart?.innerWidth ?? 0;\n\tconst innerHeight = chart?.innerHeight ?? 0;\n\tconst clampX = focused\n\t\t? Math.min(Math.max(focused.clientX, 0), innerWidth)\n\t\t: 0;\n\tconst clampY = focused\n\t\t? Math.min(Math.max(focused.clientY, 0), innerHeight)\n\t\t: 0;\n\n\t// We'll render marker in SVG but move rich text into an absolutely positioned HTML portal so it can overflow chart.\n\tconst containerEl = (chart as any).ref?.current as HTMLElement | undefined; // ChartRoot div (position: relative)\n\tconst host = containerEl; // we rely on ChartRoot's positioned container\n\n\t// If no focused point yet, don't attempt to derive tooltip content.\n\tif (!focused) {\n\t\treturn null;\n\t}\n\n\t// Single series assumption for SPCChart; index aligns with engineRows order used earlier.\n\tconst row = engineRows?.[focused.index];\n\tconst rules = extractRuleIds(row).map((r) => ruleGlossary[r].tooltip);\n\tconst dateObj = focused.x instanceof Date ? focused.x : new Date(focused.x);\n\tconst dateLabel = dateFormatter\n\t\t? dateFormatter(dateObj)\n\t\t: dateObj.toDateString();\n\tconst unit = measureUnit ? `${measureUnit}` : \"\";\n\tconst valueLabel =\n\t\tmeasureName || unit\n\t\t\t? `${focused.y}${unit ? \"\" + unit : \" \"}${measureName ? \" \" + measureName : \"\"}`\n\t\t\t: `${focused.y}`;\n\n\t// Variation / assurance descriptors\n\tconst variationDesc: string | null = variationLabel(row?.variationIcon);\n\t// Assurance descriptor\n\tconst assuranceDesc: string | null = assuranceLabel(row?.assuranceIcon);\n\n\t// Zone classification relative to mean & sigma\n\tconst zone: string | null = zoneLabel(\n\t\tlimits.mean ?? null,\n\t\tlimits.sigma,\n\t\tfocused.y\n\t);\n\n\t// Build structured content blocks for NHS styled tooltip\n\tconst narrative = pointDescriber\n\t\t? pointDescriber(focused.index, { x: focused.x, y: focused.y })\n\t\t: undefined;\n\tconst showBadges = variationDesc || assuranceDesc || zone;\n\tconst hasRules = rules.length > 0;\n\n\t// focus ring colour\n\tconst focusYellow = \"var(--nhs-fdp-color-primary-yellow, #ffeb3b)\";\n\t// Tooltip inner dot colour: use canonical token exported from spcDescriptors\n\tconst spcDotColor = getVariationColorToken(row?.variationIcon);\n\n\t// lineHeight constant removed (was only used for height calculation)\n\t// Height no longer needed for positioning (always placed below point)\n\n\t// Compute absolute positioning relative to chart container for portal.\n\t// Determine desired width from content (approximate character width heuristic) within bounds.\n\tconst charPx = 6.2;\n\t// Estimate width using primary textual lines (narrative / date-value) \u2013 badges and list wrap naturally\n\tconst baseLinesForMeasure = [\n\t\tnarrative || \"\",\n\t\t`${dateLabel} \u2022 ${valueLabel}`,\n\t].filter(Boolean);\n\tconst contentWidthEstimate = baseLinesForMeasure.reduce(\n\t\t(m, s) => Math.max(m, s.length * charPx + 32),\n\t\t0\n\t); // padding allowance\n\tconst minWidth = 200;\n\tconst maxWidth = 440;\n\tconst boxWidth = Math.min(maxWidth, Math.max(minWidth, contentWidthEstimate));\n\n\tlet left = clampX + 12; // initial: to the right of point\n\t// Account for chart margin.top (group translate) so portal top matches visual point position.\n\tconst marginTop = (chart as any).margin?.top ?? 0;\n\t// Position tooltip below the point: top edge exactly 10px beneath the data point\n\tlet top = marginTop + clampY + 16;\n\t// If overflowing right edge, flip to left side of point\n\tif (left + boxWidth > innerWidth) {\n\t\tconst flipGap = -60; // smaller gap when flipped to sit closer to point\n\t\tleft = clampX - flipGap - boxWidth;\n\t}\n\t// Final clamp to container bounds\n\tif (left < 0) left = Math.max(0, innerWidth - boxWidth);\n\n\t// Fade-in: mount flag already handled earlier; reuse existing visible state.\n\tconst tooltipId = focused ? `spc-tooltip-${focused.index}` : \"spc-tooltip\";\n\tconst portal = host\n\t\t? createPortal(\n\t\t\t\t<div\n\t\t\t\t\tid={tooltipId}\n\t\t\t\t\tclassName={\n\t\t\t\t\t\t\"fdp-spc-tooltip fdp-spc-tooltip-portal\" +\n\t\t\t\t\t\t(visible ? \" is-visible\" : \"\")\n\t\t\t\t\t}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tposition: \"absolute\",\n\t\t\t\t\t\tleft,\n\t\t\t\t\t\ttop,\n\t\t\t\t\t\twidth: boxWidth,\n\t\t\t\t\t\tmaxWidth: maxWidth,\n\t\t\t\t\t\tzIndex: 10,\n\t\t\t\t\t\tpointerEvents: \"auto\",\n\t\t\t\t\t\tuserSelect: \"none\",\n\t\t\t\t\t}}\n\t\t\t\t\trole=\"tooltip\"\n\t\t\t\t\taria-live=\"polite\"\n\t\t\t\t\taria-hidden={visible ? \"false\" : \"true\"}\n\t\t\t\t\tdata-floating\n\t\t\t\t\tdata-placement={left + boxWidth + 12 > innerWidth ? \"left\" : \"right\"}\n\t\t\t\t\tonPointerEnter={() => {\n\t\t\t\t\t\tsetHoveringTooltip(true);\n\t\t\t\t\t\tif (hideTimeoutRef.current) {\n\t\t\t\t\t\t\tcancelAnimationFrame(hideTimeoutRef.current);\n\t\t\t\t\t\t\thideTimeoutRef.current = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\tonPointerLeave={() => {\n\t\t\t\t\t\tsetHoveringTooltip(false);\n\t\t\t\t\t\t// if context no longer focused, clear cached after a short animation frame\n\t\t\t\t\t\tif (!tooltip?.focused) {\n\t\t\t\t\t\t\tconst id = requestAnimationFrame(() => {\n\t\t\t\t\t\t\t\tsetCachedFocus(null);\n\t\t\t\t\t\t\t\thideTimeoutRef.current = null;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\thideTimeoutRef.current = id;\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"fdp-spc-tooltip__body\">\n\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section fdp-spc-tooltip__section--date\">\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section-label\">\n\t\t\t\t\t\t\t\t<strong>Date</strong>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__primary-line\">{dateLabel}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section fdp-spc-tooltip__section--value\">\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section-label\">\n\t\t\t\t\t\t\t\t<strong>Value</strong>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__primary-line\">{valueLabel}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/* {narrative && (\n\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section fdp-spc-tooltip__section--narrative\">\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__narrative\">{narrative}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)} */}\n\t\t\t\t\t\t{showBadges && (\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section fdp-spc-tooltip__section--signals\">\n\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section-label\">\n\t\t\t\t\t\t\t\t\t<strong>Signals</strong>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__badges\" aria-label=\"Signals\">\n\t\t\t\t\t\t\t\t\t{variationDesc &&\n\t\t\t\t\t\t\t\t\t\t(variationDesc.toLowerCase().includes(\"concern\") ? (\n\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\ttext={variationDesc}\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc-tooltip__tag fdp-spc-tag fdp-spc-tag--concern\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t) : variationDesc.toLowerCase().includes(\"improvement\") ? (\n\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\ttext={variationDesc}\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc-tooltip__tag fdp-spc-tag fdp-spc-tag--improvement\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\ttext={variationDesc}\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc-tooltip__tag fdp-spc-tag fdp-spc-tag--common\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{assuranceDesc && (\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section fdp-spc-tooltip__section--assurance\">\n\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section-label\">\n\t\t\t\t\t\t\t\t\t<strong>Assurance</strong>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__badges\" aria-label=\"Limits\">\n\t\t\t\t\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\t\t\t\tconst lower = assuranceDesc.toLowerCase();\n\t\t\t\t\t\t\t\t\t\t// Treat explicit 'not met' (or 'not achieved') as fail; require standalone 'met' / 'achieved' for pass.\n\t\t\t\t\t\t\t\t\t\tconst isFail = lower.includes(\"not met\") || lower.includes(\"not achieved\");\n\t\t\t\t\t\t\t\t\t\t// Pass if contains 'met' or 'achieved' and not a fail phrase.\n\t\t\t\t\t\t\t\t\t\tconst isPass = !isFail && (/(^|\\b)(met|achieved)(\\b|$)/).test(lower);\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\ttext={assuranceDesc}\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\t// Pass -> improvement (blue), Fail -> concern (orange)\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={`fdp-spc-tooltip__tag fdp-spc-tag fdp-spc-tag--assurance ${isPass ? \"fdp-spc-tag--improvement\" : \"fdp-spc-tag--concern\"}`}\n\t\t\t\t\t\t\t\t\t\t\t\taria-label={`Assurance: ${assuranceDesc}`}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t})()}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{zone && (\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section fdp-spc-tooltip__section--limits\">\n\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section-label\">\n\t\t\t\t\t\t\t\t\t<strong>Control Limits & Sigma</strong>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__badges\" aria-label=\"Limits\">\n\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\ttext={(() => {\n\t\t\t\t\t\t\t\t\t\t\tconst z = zone.toLowerCase();\n\t\t\t\t\t\t\t\t\t\t\tif (z.startsWith(\"within 1\")) return \"\u22641\u03C3\";\n\t\t\t\t\t\t\t\t\t\t\tif (z.startsWith(\"1\u20132\")) return \"1\u20132\u03C3\";\n\t\t\t\t\t\t\t\t\t\t\tif (z.startsWith(\"2\u20133\")) return \"2\u20133\u03C3\";\n\t\t\t\t\t\t\t\t\t\t\tif (z.startsWith(\">3\")) return \">3\u03C3\";\n\t\t\t\t\t\t\t\t\t\t\treturn zone;\n\t\t\t\t\t\t\t\t\t\t})()}\n\t\t\t\t\t\t\t\t\t\tcolor={\n\t\t\t\t\t\t\t\t\t\t\tzone.includes(\">3\")\n\t\t\t\t\t\t\t\t\t\t\t\t? \"orange\"\n\t\t\t\t\t\t\t\t\t\t\t\t: zone.includes(\"2\u20133\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t? \"yellow\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t: \"grey\"\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\taria-label={`Sigma zone: ${zone}`}\n\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc-tooltip__tag fdp-spc-tag fdp-spc-tag--zone\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{hasRules && (\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section fdp-spc-tooltip__section--rules\">\n\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section-label\">\n\t\t\t\t\t\t\t\t\t<strong>Special cause</strong>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc-tooltip__rule-tags\"\n\t\t\t\t\t\t\t\t\taria-label=\"Special cause rules\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{rules.map((r) => {\n\t\t\t\t\t\t\t\t\t\tconst ruleColorClass = variationDesc\n\t\t\t\t\t\t\t\t\t\t\t? variationDesc.toLowerCase().includes(\"concern\")\n\t\t\t\t\t\t\t\t\t\t\t\t? \"fdp-spc-tag--concern\"\n\t\t\t\t\t\t\t\t\t\t\t\t: variationDesc.toLowerCase().includes(\"improvement\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t? \"fdp-spc-tag--improvement\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t: \"fdp-spc-tag--rule\"\n\t\t\t\t\t\t\t\t\t\t\t: \"fdp-spc-tag--rule\";\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\tkey={r}\n\t\t\t\t\t\t\t\t\t\t\t\ttext={r}\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={`fdp-spc-tooltip__tag fdp-spc-tag ${ruleColorClass}`}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>,\n\t\t\t\thost\n\t\t\t)\n\t\t: null;\n\n\treturn (\n\t\t<g\n\t\t\tclassName=\"fdp-tooltip-layer fdp-spc-tooltip\"\n\t\t\tpointerEvents=\"none\"\n\t\t\taria-hidden=\"true\"\n\t\t>\n\t\t\t<circle\n\t\t\t\tcx={clampX}\n\t\t\t\tcy={clampY}\n\t\t\t\tr={7}\n\t\t\t\tfill=\"none\"\n\t\t\t\tstroke={focusYellow}\n\t\t\t\tstrokeWidth={3}\n\t\t\t/>\n\t\t\t<circle\n\t\t\t\tcx={clampX}\n\t\t\t\tcy={clampY}\n\t\t\t\tr={5}\n\t\t\t\tfill=\"#000\"\n\t\t\t\tstroke={focusYellow}\n\t\t\t\tstrokeWidth={1.5}\n\t\t\t/>\n\t\t\t<circle\n\t\t\t\tcx={clampX}\n\t\t\t\tcy={clampY}\n\t\t\t\tr={2.5}\n\t\t\t\tfill={spcDotColor}\n\t\t\t\tstroke=\"#fff\"\n\t\t\t\tstrokeWidth={0.5}\n\t\t\t/>\n\t\t\t{portal}\n\t\t</g>\n\t);\n};\n\nexport default SPCTooltipOverlay;\n", "// NHSE \"Making Data Count\" SPC Charts \u2013 TypeScript port of SQL v2.6\n// Supports XmR, T, and G charts with special-cause rules and variation/assurance icons.\n\n/**\n * Chart type meanings (high\u2011level):\n *  XmR (Individuals & Moving Range):\n *    - Use for a continuous measurement per period (e.g. % compliance, rate, time, count when roughly normal).\n *    - Centre line = mean of individual values; sigma estimated from average moving range (MRbar).\n *    - Control limits = mean \u00B1 2.66 * MRbar (3\u03C3); 1\u03C3/2\u03C3 bands are proportional fractions (1/3, 2/3 of 2.66).\n *\n *  T chart (Time\u2011between events):\n *    - Use when data are elapsed time between rare events (positive, skewed).\n *    - Applies power transform y = t^0.2777 to stabilise variance; runs an XmR on y; then back\u2011transforms limits.\n *    - Lower limit suppressed if back\u2011transform would fall \u2264 0 (time cannot be negative).\n *\n *  G chart (Count between events):\n *    - Use when data record the number of opportunities/units between rare events (geometric behaviour).\n *    - No moving range; limits derived directly from geometric distribution quantiles around the mean count.\n *    - Provides probability\u2011based 1\u03C3/2\u03C3/3\u03C3 style bands using inverse CDF (no MR / d2 constants involved).\n */\nexport type ChartType = \"XmR\" | \"T\" | \"G\";\n// Core enums (replacing prior string union types) to share with icon layer.\nexport enum ImprovementDirection {\n\tUp = \"Up\",\n\tDown = \"Down\",\n\tNeither = \"Neither\",\n}\nexport enum VariationIcon {\n\tImprovement = \"improvement\",\n\tConcern = \"concern\",\n\tNeither = \"neither\",\n\tNone = \"none\", // used where previously null (ghost/missing or suppressed)\n}\nexport enum AssuranceIcon {\n\tPass = \"pass\",\n\tFail = \"fail\",\n\tNone = \"none\",\n}\n\nexport interface SpcInputRow {\n\tx: string | number | Date; // period label or date\n\tvalue?: number | null; // numeric value (null/undefined treated as missing)\n\tghost?: boolean; // if true, do not include in calc (still output)\n\tbaseline?: boolean; // if true, start a new partition from this row\n\ttarget?: number; // optional target value (for assurance icon)\n}\n\nexport interface SpcSettings {\n\texcludeMovingRangeOutliers?: boolean; // default: false\n\tspecialCauseShiftPoints?: number; // default: 6\n\tspecialCauseTrendPoints?: number; // default: 6\n\t/** Enable the four-of-five beyond 1\u03C3 rule (not in headline public four rules). Default: false */\n\tenableFourOfFiveRule?: boolean; // default: false\n\t/** Suppress isolated favourable single 3\u03C3 point without corroboration. Default: true */\n\tsuppressIsolatedFavourablePoint?: boolean; // default: true\n\tminimumPoints?: number; // default: 13\n\tminimumPointsWarning?: boolean; // default: false\n\tminimumPointsPartition?: number; // default: 12\n\tmaximumPointsPartition?: number | null; // default: null\n\tmaximumPoints?: number | null; // default: null\n\tpointConflictWarning?: boolean; // default: false\n\tvariationIconConflictWarning?: boolean; // default: true\n\tnullValueWarning?: boolean; // warn for null data (XmR, G)\n\ttargetSuppressedWarning?: boolean; // warn when targets ignored for T/G\n\tghostOnRareEventWarning?: boolean; // warn when ghost rows appear on T/G\n\tpartitionSizeWarnings?: boolean; // warn when partition has too few points\n\tbaselineSpecialCauseWarning?: boolean; // warn if baseline row shows special cause\n\tmaximumPointsWarnings?: boolean; // warn when max points caps applied\n\t/** Capability mode: classify assurance by full process band vs target. Default: true */\n\tassuranceCapabilityMode?: boolean; // default: true\n\t/** Precedence strategy for classifying variation when multiple rule types overlap */\n\tprecedenceStrategy?: \"legacy\" | \"directional_first\"; // default legacy\n\t/** When true (with directional_first), allow early favourable emerging trend to neutralise/downgrade concern before full trend rule fires */\n\temergingDirectionGrace?: boolean; // default false\n\t/** Points difference buffer when resolving simultaneous opposing sustained indications */\n\ttransitionBufferPoints?: number; // default 2\n\t/** Collapse lower-severity cluster rules (2-of-3 vs 4-of-5) keeping only strongest */\n\tcollapseClusterRules?: boolean; // default true\n\t/** Enable heuristic baseline (phase) change suggestions */\n\tbaselineSuggest?: boolean; // default false\n\t/** Minimum change in mean (in sigma units) between old & new stable windows */\n\tbaselineSuggestMinDeltaSigma?: number; // default 0.5\n\t/** Points required in stability window after candidate change */\n\tbaselineSuggestStabilityPoints?: number; // default 5\n\t/** Minimum non-ghost points since previous accepted (or initial) baseline */\n\tbaselineSuggestMinGap?: number; // default 12\n\t/** Minimum score threshold (0-100) for emitting suggestion */\n\tbaselineSuggestScoreThreshold?: number; // default 50\n}\n\nexport interface BuildSpcArgs {\n\tchartType: ChartType;\n\tmetricImprovement: ImprovementDirection;\n\tdata: SpcInputRow[];\n\tsettings?: SpcSettings;\n}\n\nexport interface SpcRow {\n\trowId: number;\n\tx: string | number | Date;\n\tvalue: number | null;\n\tghost: boolean;\n\tpartitionId: number;\n\tpointRank: number;\n\tmean: number | null;\n\tmr: number | null;\n\tmrMean: number | null;\n\tmrUcl: number | null;\n\tupperProcessLimit: number | null;\n\tlowerProcessLimit: number | null;\n\tupperTwoSigma: number | null;\n\tupperOneSigma: number | null;\n\tlowerOneSigma: number | null;\n\tlowerTwoSigma: number | null;\n\t/** Target value for this row (if provided in input). Exposed for rendering reference lines. */\n\ttarget: number | null;\n\tspecialCauseSinglePointAbove: boolean;\n\tspecialCauseSinglePointBelow: boolean;\n\tspecialCauseTwoOfThreeAbove: boolean;\n\tspecialCauseTwoOfThreeBelow: boolean;\n\tspecialCauseFourOfFiveAbove: boolean;\n\tspecialCauseFourOfFiveBelow: boolean;\n\tspecialCauseShiftHigh: boolean;\n\tspecialCauseShiftLow: boolean;\n\tspecialCauseTrendIncreasing: boolean;\n\tspecialCauseTrendDecreasing: boolean;\n\tvariationIcon: VariationIcon; // never null; use VariationIcon.None when suppressed\n\tassuranceIcon: AssuranceIcon; // 'none' when no target / not assessed\n\t// Parity/helper columns\n\tupperBaseline: number | null;\n\tlowerBaseline: number | null;\n\tmovingRangeHighPointValue: number | null;\n\tghostValue: number | null;\n\tghostFlag: boolean;\n\tspecialCauseImprovementValue: number | null;\n\tspecialCauseConcernValue: number | null;\n\tspecialCauseNeitherValue: number | null;\n}\n\nexport interface SpcWarning {\n\tcode: string; // short stable identifier\n\tmessage: string; // human-readable text\n\tseverity?: \"info\" | \"warning\" | \"error\";\n\tcategory?:\n\t\t| \"config\"\n\t\t| \"data\"\n\t\t| \"limits\"\n\t\t| \"special_cause\"\n\t\t| \"baseline\"\n\t\t| \"logic\"\n\t\t| \"target\"\n\t\t| \"ghost\"\n\t\t| \"partition\";\n\tcontext?: Record<string, unknown>; // optional structured data (counts, ids, etc.)\n}\nexport interface SpcResult {\n\trows: SpcRow[];\n\twarnings: SpcWarning[];\n\t/** Optional heuristic suggestions for candidate new baseline starting points (phase changes) */\n\tsuggestedBaselines?: Array<{\n\t\tindex: number; // 0-based index into rows\n\t\treason: 'shift' | 'trend' | 'point';\n\t\tscore: number; // relative confidence 0-100\n\t\tdeltaMean: number; // absolute difference in means (new - old)\n\t\toldMean: number;\n\t\tnewMean: number;\n\t\twindow: [number, number]; // stability window used\n\t}>;\n}\n\n// ------------------------- Utility functions -------------------------\n\nconst isNumber = (v: unknown): v is number =>\n\ttypeof v === \"number\" && Number.isFinite(v);\nconst sum = (arr: number[]): number => arr.reduce((a, b) => a + b, 0);\nconst mean = (arr: number[]): number =>\n\tarr.length ? sum(arr) / arr.length : NaN;\n\ntype CanonicalRow = {\n\trowId: number;\n\tx: string | number | Date;\n\tvalue: number | null;\n\tghost: boolean;\n\tbaseline: boolean;\n\ttarget: number | null;\n};\n\n/** Split into partitions based on row.baseline === true (inclusive of flag row). */\nfunction partitionRows(data: CanonicalRow[]): CanonicalRow[][] {\n\tconst partitions: CanonicalRow[][] = [];\n\tlet current: CanonicalRow[] = [];\n\tfor (const row of data) {\n\t\tif (row.baseline && current.length) {\n\t\t\tpartitions.push(current);\n\t\t\tcurrent = [];\n\t\t}\n\t\tcurrent.push(row);\n\t}\n\tif (current.length) partitions.push(current);\n\treturn partitions;\n}\n\n/** Compute moving range array relative to previous NON-GHOST, within a partition */\nfunction movingRanges(\n\tvalues: (number | null)[],\n\tghosts: boolean[]\n): (number | null)[] {\n\tconst mr: (number | null)[] = new Array(values.length).fill(null);\n\tlet prevIdx: number | null = null;\n\tfor (let i = 0; i < values.length; i++) {\n\t\tconst vi = values[i];\n\t\tif (!ghosts[i] && isNumber(vi)) {\n\t\t\tif (prevIdx !== null) {\n\t\t\t\tconst pv = values[prevIdx];\n\t\t\t\tmr[i] = isNumber(pv) ? Math.abs(vi - pv) : null;\n\t\t\t}\n\t\t\tprevIdx = i;\n\t\t}\n\t}\n\treturn mr;\n}\n\n/** Iterative single-pass outlier exclusion for MR using UCL = 3.267 * MRbar (1 iteration) */\nfunction mrMeanWithOptionalExclusion(\n\tmr: (number | null)[],\n\texcludeOutliers: boolean\n): { mrMean: number; mrUcl: number } {\n\tconst pool = mr.filter((v): v is number => isNumber(v));\n\tif (!pool.length) return { mrMean: NaN, mrUcl: NaN };\n\tlet mrMeanVal = mean(pool);\n\tlet mrUclVal = 3.267 * mrMeanVal;\n\tif (excludeOutliers) {\n\t\tconst trimmed = pool.filter((v) => v <= mrUclVal);\n\t\tif (trimmed.length && trimmed.length !== pool.length) {\n\t\t\tmrMeanVal = mean(trimmed);\n\t\t\tmrUclVal = 3.267 * mrMeanVal;\n\t\t}\n\t}\n\treturn { mrMean: mrMeanVal, mrUcl: mrUclVal };\n}\n\n/** Build sigma/limit lines given mean and MRbar for XmR */\nfunction xmrLimits(\n\tcenterMean: number,\n\tmrMeanVal: number\n): {\n\tupperProcessLimit: number | null;\n\tlowerProcessLimit: number | null;\n\tupperTwoSigma: number | null;\n\tlowerTwoSigma: number | null;\n\tupperOneSigma: number | null;\n\tlowerOneSigma: number | null;\n} {\n\tif (!isNumber(centerMean) || !isNumber(mrMeanVal))\n\t\treturn {\n\t\t\tupperProcessLimit: null,\n\t\t\tlowerProcessLimit: null,\n\t\t\tupperTwoSigma: null,\n\t\t\tlowerTwoSigma: null,\n\t\t\tupperOneSigma: null,\n\t\t\tlowerOneSigma: null,\n\t\t};\n\t// XmR constants (derived from d2 for n=2). 3-sigma: 2.66*MRbar; 2-sigma: (2/3)*2.66; 1-sigma: (1/3)*2.66\n\tconst k3 = 2.66;\n\tconst k2 = (2 / 3) * k3;\n\tconst k1 = (1 / 3) * k3;\n\treturn {\n\t\tupperProcessLimit: centerMean + k3 * mrMeanVal,\n\t\tlowerProcessLimit: centerMean - k3 * mrMeanVal,\n\t\tupperTwoSigma: centerMean + k2 * mrMeanVal,\n\t\tlowerTwoSigma: centerMean - k2 * mrMeanVal,\n\t\tupperOneSigma: centerMean + k1 * mrMeanVal,\n\t\tlowerOneSigma: centerMean - k1 * mrMeanVal,\n\t};\n}\n\n// Count how many of the provided values are strictly above (> ref) or strictly below (< ref)\nfunction countAbove(values: (number | null)[], ref: number): number {\n\treturn values.reduce(\n\t\t(c: number, v) => c + (isNumber(v) && v > ref ? 1 : 0),\n\t\t0\n\t);\n}\nfunction countBelow(values: (number | null)[], ref: number): number {\n\treturn values.reduce(\n\t\t(c: number, v) => c + (isNumber(v) && v < ref ? 1 : 0),\n\t\t0\n\t);\n}\n\n/** True if last n non-ghost values form a strict monotonic trend */\nfunction isTrend(\n\tseq: (number | null)[],\n\tn: number,\n\tdirection: \"up\" | \"down\"\n): boolean {\n\tconst vals = seq.filter((v): v is number => isNumber(v));\n\tif (vals.length < n) return false;\n\tconst tail = vals.slice(-n);\n\tfor (let i = 1; i < tail.length; i++) {\n\t\tif (direction === \"up\" && !(tail[i] > tail[i - 1])) return false;\n\t\tif (direction === \"down\" && !(tail[i] < tail[i - 1])) return false;\n\t}\n\treturn true;\n}\n\n/** True if last n non-ghost values are all strictly on one side of ref (mean) */\nfunction isRunOnOneSide(\n\tseq: (number | null)[],\n\tn: number,\n\tref: number,\n\tside: \"high\" | \"low\"\n): boolean {\n\tconst vals = seq.filter((v): v is number => isNumber(v));\n\tif (vals.length < n) return false;\n\tconst tail = vals.slice(-n);\n\tif (side === \"high\") return tail.every((v) => v > ref);\n\tif (side === \"low\") return tail.every((v) => v < ref);\n\treturn false;\n}\n\n// ------------------------- Rare event chart helpers (T & G) -------------------------\n// T chart (time-between events): y = t^0.2777; XmR on y; back-transform t = y^3.6; no LCL if lower transform \u2264 0.\nconst T_ALPHA = 0.2777;\nconst T_INV_ALPHA = 3.6;\nconst toTTransformed = (t: number | null): number | null =>\n\tisNumber(t) && t >= 0 ? Math.pow(t, T_ALPHA) : null;\nconst fromTTransformed = (y: number | null): number | null =>\n\tisNumber(y) && y >= 0 ? Math.pow(y, T_INV_ALPHA) : null;\n\n// Normal CDF quantile probabilities for 1\u03C3, 2\u03C3, 3\u03C3 used by probability-based G chart limits\nconst SIGMA_PROBS = {\n\tone: { low: 0.1586552539, high: 0.8413447461 },\n\ttwo: { low: 0.0227501319, high: 0.9772498681 },\n\tthree: { low: 0.001349898, high: 0.998650102 },\n};\n\n// Inverse CDF for geometric (\"number until first success\") as a real value (no ceiling)\nfunction geomInvCdfReal(q: number, p: number): number {\n\tif (!(q > 0 && q < 1) || !(p > 0 && p < 1)) return NaN;\n\treturn Math.log(1 - q) / Math.log(1 - p);\n}\n\n// Probability-based control lines for a G chart given mean g (\"number between\")\nfunction gChartProbabilityLimits(gMean: number): {\n\tcl: number | null;\n\tlcl: number | null;\n\tucl: number | null;\n\toneLow: number | null;\n\toneHigh: number | null;\n\ttwoLow: number | null;\n\ttwoHigh: number | null;\n} {\n\tif (!isNumber(gMean) || gMean < 0)\n\t\treturn {\n\t\t\tcl: null,\n\t\t\tlcl: null,\n\t\t\tucl: null,\n\t\t\toneLow: null,\n\t\t\toneHigh: null,\n\t\t\ttwoLow: null,\n\t\t\ttwoHigh: null,\n\t\t};\n\tconst p = 1 / (gMean + 1); // from E[G_between] = (1-p)/p\n\tconst qToGbetween = (q: number) => geomInvCdfReal(q, p) - 1; // convert from \"until\" to \"between\"\n\n\tconst cl = qToGbetween(0.5);\n\tconst lcl = Math.max(0, qToGbetween(SIGMA_PROBS.three.low));\n\tconst ucl = qToGbetween(SIGMA_PROBS.three.high);\n\tconst oneL = Math.max(0, qToGbetween(SIGMA_PROBS.one.low));\n\tconst oneH = qToGbetween(SIGMA_PROBS.one.high);\n\tconst twoL = Math.max(0, qToGbetween(SIGMA_PROBS.two.low));\n\tconst twoH = qToGbetween(SIGMA_PROBS.two.high);\n\n\treturn {\n\t\tcl,\n\t\tlcl,\n\t\tucl,\n\t\toneLow: oneL,\n\t\toneHigh: oneH,\n\t\ttwoLow: twoL,\n\t\ttwoHigh: twoH,\n\t};\n}\n\n// Compute T chart limits on the original t-scale using XmR on transformed y = t^alpha\nfunction tChartLimits(\n\ttValues: (number | null)[],\n\tghosts: boolean[],\n\texcludeOutliers: boolean\n): {\n\tcenter: number | null;\n\tupperProcessLimit: number | null;\n\tlowerProcessLimit: number | null;\n\tupperTwoSigma: number | null;\n\tlowerTwoSigma: number | null;\n\tupperOneSigma: number | null;\n\tlowerOneSigma: number | null;\n\tmr: (number | null)[];\n\tmrMean: number | null;\n\tmrUcl: number | null;\n} {\n\tconst y = tValues.map((v) => (isNumber(v) ? toTTransformed(v)! : null));\n\tconst mrY = movingRanges(y, ghosts);\n\tconst { mrMean: mrMeanY_raw /*, mrUcl: _mrUclY_raw*/ } =\n\t\tmrMeanWithOptionalExclusion(mrY, !!excludeOutliers);\n\tconst yNonGhost = y.filter((v, i) => !ghosts[i] && isNumber(v)) as number[];\n\tconst yBar = yNonGhost.length ? mean(yNonGhost) : NaN;\n\n\tif (!isNumber(yBar) || !isNumber(mrMeanY_raw)) {\n\t\treturn {\n\t\t\tcenter: null,\n\t\t\tupperProcessLimit: null,\n\t\t\tlowerProcessLimit: null,\n\t\t\tupperTwoSigma: null,\n\t\t\tlowerTwoSigma: null,\n\t\t\tupperOneSigma: null,\n\t\t\tlowerOneSigma: null,\n\t\t\tmr: mrY,\n\t\t\tmrMean: null,\n\t\t\tmrUcl: null,\n\t\t};\n\t}\n\tconst k3 = 2.66,\n\t\tk2 = (2 / 3) * k3,\n\t\tk1 = (1 / 3) * k3;\n\tconst UL_y = yBar + k3 * mrMeanY_raw;\n\tconst LL_y = yBar - k3 * mrMeanY_raw;\n\tconst U2_y = yBar + k2 * mrMeanY_raw;\n\tconst L2_y = yBar - k2 * mrMeanY_raw;\n\tconst U1_y = yBar + k1 * mrMeanY_raw;\n\tconst L1_y = yBar - k1 * mrMeanY_raw;\n\n\tconst center = fromTTransformed(yBar);\n\tconst upl = fromTTransformed(UL_y);\n\tconst lpl = LL_y <= 0 ? null : fromTTransformed(LL_y); // no LCL if LL<0\n\n\tconst oneH = fromTTransformed(U1_y);\n\tconst oneL = L1_y <= 0 ? null : fromTTransformed(L1_y);\n\tconst twoH = fromTTransformed(U2_y);\n\tconst twoL = L2_y <= 0 ? null : fromTTransformed(L2_y);\n\n\treturn {\n\t\tcenter: center ?? null,\n\t\tupperProcessLimit: upl ?? null,\n\t\tlowerProcessLimit: lpl ?? null,\n\t\tupperTwoSigma: twoH ?? null,\n\t\tlowerTwoSigma: twoL ?? null,\n\t\tupperOneSigma: oneH ?? null,\n\t\tlowerOneSigma: oneL ?? null,\n\t\tmr: mrY,\n\t\tmrMean: mrMeanY_raw,\n\t\tmrUcl: isNumber(mrMeanY_raw) ? 3.267 * mrMeanY_raw : null,\n\t};\n}\n\n// ------------------------- Core builder -------------------------\n\nexport function buildSpc(args: BuildSpcArgs): SpcResult {\n\tconst {\n\t\tchartType,\n\t\tmetricImprovement,\n\t\tdata,\n\t\tsettings: userSettings = {},\n\t} = args;\n\n\tconst settings = {\n\t\texcludeMovingRangeOutliers: false,\n\t\tspecialCauseShiftPoints: 6,\n\t\tspecialCauseTrendPoints: 6,\n\t\tenableFourOfFiveRule: false,\n\t\tsuppressIsolatedFavourablePoint: true,\n\t\tminimumPoints: 13,\n\t\tminimumPointsWarning: false,\n\t\tminimumPointsPartition: 12,\n\t\tmaximumPointsPartition: null,\n\t\tmaximumPoints: null,\n\t\tpointConflictWarning: false,\n\t\tvariationIconConflictWarning: true,\n\t\tnullValueWarning: true,\n\t\ttargetSuppressedWarning: true,\n\t\tghostOnRareEventWarning: true,\n\t\tpartitionSizeWarnings: true,\n\t\tbaselineSpecialCauseWarning: true,\n\t\tmaximumPointsWarnings: true,\n\t\tassuranceCapabilityMode: true,\n\t\tprecedenceStrategy: \"legacy\",\n\t\temergingDirectionGrace: false,\n\t\ttransitionBufferPoints: 2,\n\t\tcollapseClusterRules: true,\n\t\tbaselineSuggest: false,\n\t\tbaselineSuggestMinDeltaSigma: 0.5,\n\t\tbaselineSuggestStabilityPoints: 5,\n\t\tbaselineSuggestMinGap: 12,\n\t\tbaselineSuggestScoreThreshold: 50,\n\t\t...userSettings,\n\t} as Required<SpcSettings>;\n\n\tif (!Array.isArray(data)) throw new Error(\"data must be an array of rows\");\n\tconst canonical: CanonicalRow[] = data.map((d, i) => ({\n\t\trowId: i + 1,\n\t\tx: d.x,\n\t\tvalue: isNumber(d.value) ? d.value : null,\n\t\tghost: !!d.ghost,\n\t\tbaseline: !!d.baseline,\n\t\ttarget: isNumber(d.target) ? d.target : null,\n\t}));\n\n\tconst partitions = partitionRows(canonical);\n\tconst output: SpcRow[] = [];\n\tconst warnings: SpcWarning[] = [];\n\n\t// Global counts for minimum point checks\n\tconst nonGhostGlobalCount = canonical.filter(\n\t\t(r) => !r.ghost && isNumber(r.value)\n\t).length;\n\tconst globalEnough = nonGhostGlobalCount >= (settings.minimumPoints ?? 13);\n\n\t// Iterate partitions\n\tlet partitionId = 0;\n\tconst partitionNonGhostCounts: Record<number, number> = {};\n\tfor (const part of partitions) {\n\t\tpartitionId++;\n\n\t\tconst values = part.map((r) => r.value);\n\t\tconst ghosts = part.map((r) => r.ghost);\n\n\t\tlet mr: (number | null)[] = new Array(values.length).fill(null);\n\t\tlet centerLine: number = NaN;\n\t\tlet mrMean: number = NaN;\n\t\tlet mrUcl: number = NaN;\n\t\tlet lim: {\n\t\t\tupperProcessLimit: number | null;\n\t\t\tlowerProcessLimit: number | null;\n\t\t\tupperTwoSigma: number | null;\n\t\t\tlowerTwoSigma: number | null;\n\t\t\tupperOneSigma: number | null;\n\t\t\tlowerOneSigma: number | null;\n\t\t} = {\n\t\t\tupperProcessLimit: null,\n\t\t\tlowerProcessLimit: null,\n\t\t\tupperTwoSigma: null,\n\t\t\tlowerTwoSigma: null,\n\t\t\tupperOneSigma: null,\n\t\t\tlowerOneSigma: null,\n\t\t};\n\n\t\tif (chartType === \"XmR\") {\n\t\t\tmr = movingRanges(values, ghosts);\n\t\t\tconst nonGhostVals = values.filter(\n\t\t\t\t(v, i) => !ghosts[i] && isNumber(v)\n\t\t\t) as number[];\n\t\t\tcenterLine = nonGhostVals.length ? mean(nonGhostVals) : NaN;\n\t\t\tconst tmp = mrMeanWithOptionalExclusion(\n\t\t\t\tmr,\n\t\t\t\t!!settings.excludeMovingRangeOutliers\n\t\t\t);\n\t\t\tmrMean = tmp.mrMean;\n\t\t\tmrUcl = tmp.mrUcl;\n\t\t\tlim = xmrLimits(centerLine, mrMean);\n\t\t} else if (chartType === \"T\") {\n\t\t\tconst tlim = tChartLimits(\n\t\t\t\tvalues,\n\t\t\t\tghosts,\n\t\t\t\t!!settings.excludeMovingRangeOutliers\n\t\t\t);\n\t\t\tmr = tlim.mr;\n\t\t\tmrMean = tlim.mrMean ?? NaN;\n\t\t\tmrUcl = tlim.mrUcl ?? NaN;\n\t\t\tcenterLine = tlim.center ?? NaN;\n\t\t\tlim = {\n\t\t\t\tupperProcessLimit: tlim.upperProcessLimit,\n\t\t\t\tlowerProcessLimit: tlim.lowerProcessLimit,\n\t\t\t\tupperTwoSigma: tlim.upperTwoSigma,\n\t\t\t\tlowerTwoSigma: tlim.lowerTwoSigma,\n\t\t\t\tupperOneSigma: tlim.upperOneSigma,\n\t\t\t\tlowerOneSigma: tlim.lowerOneSigma,\n\t\t\t};\n\t\t} else if (chartType === \"G\") {\n\t\t\tconst nonGhostVals = values.filter(\n\t\t\t\t(v, i) => !ghosts[i] && isNumber(v)\n\t\t\t) as number[];\n\t\t\tconst gMean = nonGhostVals.length ? mean(nonGhostVals) : NaN;\n\t\t\tconst g = gChartProbabilityLimits(gMean);\n\t\t\tcenterLine = g.cl ?? NaN;\n\t\t\tlim = {\n\t\t\t\tupperProcessLimit: g.ucl,\n\t\t\t\tlowerProcessLimit: g.lcl,\n\t\t\t\tupperTwoSigma: g.twoHigh,\n\t\t\t\tlowerTwoSigma: g.twoLow,\n\t\t\t\tupperOneSigma: g.oneHigh,\n\t\t\t\tlowerOneSigma: g.oneLow,\n\t\t\t};\n\t\t\t// No MR concept on probability-based G\n\t\t\tmr = new Array(values.length).fill(null);\n\t\t\tmrMean = NaN;\n\t\t\tmrUcl = NaN;\n\t\t} else {\n\t\t\twarnings.push({\n\t\t\t\tcode: \"unknown_chart_type\",\n\t\t\t\tcategory: \"config\",\n\t\t\t\tseverity: \"error\",\n\t\t\t\tmessage: `Unknown ChartType '${chartType}' \u2013 supported: XmR, T, G.`,\n\t\t\t\tcontext: { chartType },\n\t\t\t});\n\t\t}\n\n\t\tconst withLines: SpcRow[] = part.map((r, i) => {\n\t\t\tconst pointRank =\n\t\t\t\t!r.ghost && isNumber(r.value)\n\t\t\t\t\t? values.slice(0, i + 1).filter((v, j) => !ghosts[j] && isNumber(v))\n\t\t\t\t\t\t\t.length\n\t\t\t\t\t: 0;\n\n\t\t\tconst limitsAllowed = globalEnough; // suppress until global minimum reached\n\t\t\tconst limits = limitsAllowed\n\t\t\t\t? lim\n\t\t\t\t: {\n\t\t\t\t\t\tupperProcessLimit: null,\n\t\t\t\t\t\tlowerProcessLimit: null,\n\t\t\t\t\t\tupperTwoSigma: null,\n\t\t\t\t\t\tlowerTwoSigma: null,\n\t\t\t\t\t\tupperOneSigma: null,\n\t\t\t\t\t\tlowerOneSigma: null,\n\t\t\t\t\t};\n\n\t\t\tconst row: SpcRow = {\n\t\t\t\trowId: r.rowId,\n\t\t\t\tx: r.x,\n\t\t\t\tvalue: isNumber(r.value) ? r.value : null,\n\t\t\t\tghost: r.ghost,\n\t\t\t\tpartitionId,\n\t\t\t\tpointRank,\n\t\t\t\tmean: limitsAllowed && isNumber(centerLine) ? centerLine : null,\n\t\t\t\tmr: isNumber(mr[i]) ? mr[i] : null,\n\t\t\t\tmrMean: limitsAllowed && isNumber(mrMean) ? mrMean : null,\n\t\t\t\tmrUcl: limitsAllowed && isNumber(mrUcl) ? mrUcl : null,\n\t\t\t\tupperProcessLimit: isNumber(limits.upperProcessLimit)\n\t\t\t\t\t? limits.upperProcessLimit\n\t\t\t\t\t: null,\n\t\t\t\tlowerProcessLimit: isNumber(limits.lowerProcessLimit)\n\t\t\t\t\t? limits.lowerProcessLimit\n\t\t\t\t\t: null,\n\t\t\t\tupperTwoSigma: isNumber(limits.upperTwoSigma)\n\t\t\t\t\t? limits.upperTwoSigma\n\t\t\t\t\t: null,\n\t\t\t\tlowerTwoSigma: isNumber(limits.lowerTwoSigma)\n\t\t\t\t\t? limits.lowerTwoSigma\n\t\t\t\t\t: null,\n\t\t\t\tupperOneSigma: isNumber(limits.upperOneSigma)\n\t\t\t\t\t? limits.upperOneSigma\n\t\t\t\t\t: null,\n\t\t\t\tlowerOneSigma: isNumber(limits.lowerOneSigma)\n\t\t\t\t\t? limits.lowerOneSigma\n\t\t\t\t\t: null,\n\t\t\t\ttarget: isNumber(r.target) ? r.target : null,\n\t\t\t\tspecialCauseSinglePointAbove: false,\n\t\t\t\tspecialCauseSinglePointBelow: false,\n\t\t\t\tspecialCauseTwoOfThreeAbove: false,\n\t\t\t\tspecialCauseTwoOfThreeBelow: false,\n\t\t\t\tspecialCauseFourOfFiveAbove: false,\n\t\t\t\tspecialCauseFourOfFiveBelow: false,\n\t\t\t\tspecialCauseShiftHigh: false,\n\t\t\t\tspecialCauseShiftLow: false,\n\t\t\t\tspecialCauseTrendIncreasing: false,\n\t\t\t\tspecialCauseTrendDecreasing: false,\n\t\t\t\tvariationIcon: VariationIcon.None,\n\t\t\t\tassuranceIcon: AssuranceIcon.None,\n\t\t\t\tupperBaseline:\n\t\t\t\t\tlimitsAllowed && isNumber(centerLine) ? centerLine : null,\n\t\t\t\tlowerBaseline:\n\t\t\t\t\tlimitsAllowed && isNumber(centerLine) ? centerLine : null,\n\t\t\t\tmovingRangeHighPointValue:\n\t\t\t\t\tlimitsAllowed && isNumber(mrUcl) ? mrUcl : null,\n\t\t\t\tghostValue: r.ghost && isNumber(r.value) ? r.value : null,\n\t\t\t\tghostFlag: !!r.ghost,\n\t\t\t\tspecialCauseImprovementValue: null,\n\t\t\t\tspecialCauseConcernValue: null,\n\t\t\t\tspecialCauseNeitherValue: null,\n\t\t\t};\n\t\t\treturn row;\n\t\t});\n\n\t\tpartitionNonGhostCounts[partitionId] = withLines.filter(\n\t\t\t(r) => !r.ghost && isNumber(r.value)\n\t\t).length;\n\n\t\t// Special cause detection (within partition)\n\t\tconst shiftN = settings.specialCauseShiftPoints ?? 6;\n\t\tconst trendN = settings.specialCauseTrendPoints ?? 6;\n\n\t\tconst runningNonGhostValues: (number | null)[] = [];\n\t\tfor (let i = 0; i < withLines.length; i++) {\n\t\t\tconst row = withLines[i];\n\t\t\tconst v = row.value;\n\t\t\tif (!row.ghost && isNumber(v)) runningNonGhostValues.push(v);\n\n\t\t\tconst hasLimits =\n\t\t\t\tisNumber(row.mean) &&\n\t\t\t\tisNumber(row.upperProcessLimit) &&\n\t\t\t\tisNumber(row.lowerProcessLimit);\n\t\t\tif (!hasLimits || row.ghost || !isNumber(v)) {\n\t\t\t\toutput.push(row);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Single point beyond 3-sigma\n\t\t\trow.specialCauseSinglePointAbove = isNumber(row.upperProcessLimit)\n\t\t\t\t? v > row.upperProcessLimit\n\t\t\t\t: false;\n\t\t\trow.specialCauseSinglePointBelow = isNumber(row.lowerProcessLimit)\n\t\t\t\t? v < row.lowerProcessLimit\n\t\t\t\t: false;\n\n\t\t\t// Helpers enforcing side-of-mean consistency\n\t\t\tconst allAboveMean = (vals: number[], meanVal: number) =>\n\t\t\t\tvals.every((val) => val > meanVal);\n\t\t\tconst allBelowMean = (vals: number[], meanVal: number) =>\n\t\t\t\tvals.every((val) => val < meanVal);\n\n\t\t\t// Two of three beyond 2-sigma AND all three on same side of mean\n\t\t\tconst last3 = (runningNonGhostValues as number[]).slice(-3);\n\t\t\tif (last3.length === 3 && isNumber(row.mean)) {\n\t\t\t\tconst u2 = row.upperTwoSigma ?? Infinity;\n\t\t\t\tconst l2 = row.lowerTwoSigma ?? -Infinity;\n\t\t\t\tconst highCount = countAbove(last3, u2);\n\t\t\t\tconst lowCount = countBelow(last3, l2);\n\t\t\t\tif (highCount >= 2 && allAboveMean(last3, row.mean)) {\n\t\t\t\t\trow.specialCauseTwoOfThreeAbove = true;\n\t\t\t\t}\n\t\t\t\tif (lowCount >= 2 && allBelowMean(last3, row.mean)) {\n\t\t\t\t\trow.specialCauseTwoOfThreeBelow = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Four of five beyond 1-sigma (same side) \u2013 optional, require all five on same side of mean\n\t\t\tif (settings.enableFourOfFiveRule && isNumber(row.mean)) {\n\t\t\t\tconst last5 = (runningNonGhostValues as number[]).slice(-5);\n\t\t\t\tif (last5.length === 5) {\n\t\t\t\t\tconst u1 = row.upperOneSigma ?? Infinity;\n\t\t\t\t\tconst l1 = row.lowerOneSigma ?? -Infinity;\n\t\t\t\t\tconst highCount = countAbove(last5, u1);\n\t\t\t\t\tconst lowCount = countBelow(last5, l1);\n\t\t\t\t\tif (highCount >= 4 && allAboveMean(last5, row.mean)) {\n\t\t\t\t\t\trow.specialCauseFourOfFiveAbove = true;\n\t\t\t\t\t}\n\t\t\t\t\tif (lowCount >= 4 && allBelowMean(last5, row.mean)) {\n\t\t\t\t\t\trow.specialCauseFourOfFiveBelow = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Shift (run) of N on one side of mean\n\t\t\tif (isNumber(row.mean)) {\n\t\t\t\trow.specialCauseShiftHigh = isRunOnOneSide(\n\t\t\t\t\trunningNonGhostValues,\n\t\t\t\t\tshiftN,\n\t\t\t\t\trow.mean,\n\t\t\t\t\t\"high\"\n\t\t\t\t);\n\t\t\t\trow.specialCauseShiftLow = isRunOnOneSide(\n\t\t\t\t\trunningNonGhostValues,\n\t\t\t\t\tshiftN,\n\t\t\t\t\trow.mean,\n\t\t\t\t\t\"low\"\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Trend of N strictly increasing/decreasing\n\t\t\trow.specialCauseTrendIncreasing = isTrend(\n\t\t\t\trunningNonGhostValues,\n\t\t\t\ttrendN,\n\t\t\t\t\"up\"\n\t\t\t);\n\t\t\trow.specialCauseTrendDecreasing = isTrend(\n\t\t\t\trunningNonGhostValues,\n\t\t\t\ttrendN,\n\t\t\t\t\"down\"\n\t\t\t);\n\n\n\t\t\toutput.push(row);\n\t\t}\n\n\t\t// (Optional) enforce maximumPointsPartition by nulling limits after cap\n\t\tif (\n\t\t\tsettings.maximumPointsPartition &&\n\t\t\tNumber.isFinite(settings.maximumPointsPartition)\n\t\t) {\n\t\t\tconst cap = settings.maximumPointsPartition as number;\n\t\t\tlet seen = 0;\n\t\t\tfor (const row of output.filter((r) => r.partitionId === partitionId)) {\n\t\t\t\tif (!row.ghost && isNumber(row.value)) seen++;\n\t\t\t\tif (seen > cap) {\n\t\t\t\t\trow.mean = row.upperProcessLimit = row.lowerProcessLimit = null;\n\t\t\t\t\trow.upperTwoSigma =\n\t\t\t\t\t\trow.lowerTwoSigma =\n\t\t\t\t\t\trow.upperOneSigma =\n\t\t\t\t\t\trow.lowerOneSigma =\n\t\t\t\t\t\t\tnull;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Variation icon per row based on improvement direction\n\tfor (let idx = 0; idx < output.length; idx++) {\n\t\tconst row = output[idx];\n\t\tif (row.ghost || !isNumber(row.value) || row.mean === null) {\n\t\t\trow.variationIcon = VariationIcon.None;\n\t\t\tcontinue;\n\t\t}\n\t\tconst anyHigh =\n\t\t\trow.specialCauseSinglePointAbove ||\n\t\t\trow.specialCauseTwoOfThreeAbove ||\n\t\t\t(settings.enableFourOfFiveRule && row.specialCauseFourOfFiveAbove) ||\n\t\t\trow.specialCauseShiftHigh ||\n\t\t\trow.specialCauseTrendIncreasing;\n\t\tconst anyLow =\n\t\t\trow.specialCauseSinglePointBelow ||\n\t\t\trow.specialCauseTwoOfThreeBelow ||\n\t\t\t(settings.enableFourOfFiveRule && row.specialCauseFourOfFiveBelow) ||\n\t\t\trow.specialCauseShiftLow ||\n\t\t\trow.specialCauseTrendDecreasing;\n\t\t// Optional cluster rule collapse (retain stronger 4-of-5 over 2-of-3 when both same side)\n\t\tif (settings.collapseClusterRules) {\n\t\t\tif (row.specialCauseTwoOfThreeAbove && row.specialCauseFourOfFiveAbove)\n\t\t\t\trow.specialCauseTwoOfThreeAbove = false;\n\t\t\tif (row.specialCauseTwoOfThreeBelow && row.specialCauseFourOfFiveBelow)\n\t\t\t\trow.specialCauseTwoOfThreeBelow = false;\n\t\t}\n\n\t\tif (settings.precedenceStrategy === \"directional_first\") {\n\t\t\t// Emerging direction grace heuristic: detect near-trend favourable movement (trendN-1 window with majority directional steps)\n\t\t\tconst trendWindow = settings.specialCauseTrendPoints ?? 6;\n\t\t\tconst lookBack = trendWindow - 1; // emerging window\n\t\t\tlet emergingFavourable = false;\n\t\t\tif (lookBack >= 3 && isNumber(row.value)) {\n\t\t\t\t// gather last lookBack non-ghost numeric values including current\n\t\t\t\tconst recent: number[] = [];\n\t\t\t\tfor (let back = idx; back >= 0 && recent.length < lookBack; back--) {\n\t\t\t\t\tconst rv = output[back].value;\n\t\t\t\t\tif (output[back].ghost || !isNumber(rv)) continue;\n\t\t\t\t\trecent.unshift(rv);\n\t\t\t\t}\n\t\t\t\tif (recent.length === lookBack) {\n\t\t\t\t\tlet directionalSteps = 0;\n\t\t\t\t\tfor (let k = 1; k < recent.length; k++) {\n\t\t\t\t\t\tif (metricImprovement === ImprovementDirection.Down) {\n\t\t\t\t\t\t\tif (recent[k] <= recent[k - 1]) directionalSteps++; // allow flat or down\n\t\t\t\t\t\t} else if (metricImprovement === ImprovementDirection.Up) {\n\t\t\t\t\t\t\tif (recent[k] >= recent[k - 1]) directionalSteps++; // allow flat or up\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// Require all but at most one step consistent\n\t\t\t\t\temergingFavourable = directionalSteps >= lookBack - 2;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst favourable =\n\t\t\t\tmetricImprovement === ImprovementDirection.Up ? anyHigh : anyLow;\n\t\t\tconst unfavourable =\n\t\t\t\tmetricImprovement === ImprovementDirection.Up ? anyLow : anyHigh;\n\t\t\t// When both favourable and unfavourable present for a row, directionally-first precedence chooses favourable unless clearly outweighed.\n\t\t\tif (favourable && !unfavourable) {\n\t\t\t\trow.variationIcon = VariationIcon.Improvement;\n\t\t\t} else if (!favourable && unfavourable) {\n\t\t\t\t// Allow graceful downgrade only for weaker unfavourable signals (exclude strong sigma/cluster/shift signals)\n\t\t\t\tconst strongUnfavourable =\n\t\t\t\t\trow.specialCauseSinglePointAbove ||\n\t\t\t\t\trow.specialCauseSinglePointBelow ||\n\t\t\t\t\trow.specialCauseTwoOfThreeAbove ||\n\t\t\t\t\trow.specialCauseTwoOfThreeBelow ||\n\t\t\t\t\t(settings.enableFourOfFiveRule &&\n\t\t\t\t\t\t(row.specialCauseFourOfFiveAbove ||\n\t\t\t\t\t\t\trow.specialCauseFourOfFiveBelow)) ||\n\t\t\t\t\trow.specialCauseShiftHigh ||\n\t\t\t\t\trow.specialCauseShiftLow;\n\t\t\t\tif (\n\t\t\t\t\tsettings.emergingDirectionGrace &&\n\t\t\t\t\temergingFavourable &&\n\t\t\t\t\t!strongUnfavourable\n\t\t\t\t) {\n\t\t\t\t\trow.variationIcon = VariationIcon.Neither;\n\t\t\t\t} else {\n\t\t\t\t\trow.variationIcon = VariationIcon.Concern;\n\t\t\t\t}\n\t\t\t} else if (favourable && unfavourable) {\n\t\t\t\t// Conflict: pick favourable if emerging direction or existing trend flagged; else neutral\n\t\t\t\tif (\n\t\t\t\t\tsettings.emergingDirectionGrace &&\n\t\t\t\t\t(emergingFavourable ||\n\t\t\t\t\t\trow.specialCauseTrendIncreasing ||\n\t\t\t\t\t\trow.specialCauseTrendDecreasing)\n\t\t\t\t) {\n\t\t\t\t\trow.variationIcon = VariationIcon.Improvement;\n\t\t\t\t} else {\n\t\t\t\t\trow.variationIcon = VariationIcon.Neither;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trow.variationIcon = VariationIcon.Neither;\n\t\t\t}\n\t\t} else {\n\t\t\t// legacy logic\n\t\t\tif (metricImprovement === ImprovementDirection.Up) {\n\t\t\t\trow.variationIcon = anyHigh\n\t\t\t\t\t? VariationIcon.Improvement\n\t\t\t\t\t: anyLow\n\t\t\t\t\t\t? VariationIcon.Concern\n\t\t\t\t\t\t: VariationIcon.Neither;\n\t\t\t} else if (metricImprovement === ImprovementDirection.Down) {\n\t\t\t\trow.variationIcon = anyLow\n\t\t\t\t\t? VariationIcon.Improvement\n\t\t\t\t\t: anyHigh\n\t\t\t\t\t\t? VariationIcon.Concern\n\t\t\t\t\t\t: VariationIcon.Neither;\n\t\t\t} else {\n\t\t\t\trow.variationIcon = VariationIcon.Neither; // neutral metric\n\t\t\t}\n\t\t}\n\n\t\t// Suppress isolated favourable single 3\u03C3 point if enabled\n\t\tif (\n\t\t\tsettings.suppressIsolatedFavourablePoint &&\n\t\t\trow.variationIcon === VariationIcon.Improvement\n\t\t) {\n\t\t\tconst favourableSingleHigh =\n\t\t\t\tmetricImprovement === ImprovementDirection.Up &&\n\t\t\t\trow.specialCauseSinglePointAbove;\n\t\t\tconst favourableSingleLow =\n\t\t\t\tmetricImprovement === ImprovementDirection.Down &&\n\t\t\t\trow.specialCauseSinglePointBelow;\n\t\t\tconst corroborating =\n\t\t\t\t(metricImprovement === ImprovementDirection.Up &&\n\t\t\t\t\t(row.specialCauseTwoOfThreeAbove ||\n\t\t\t\t\t\t(settings.enableFourOfFiveRule &&\n\t\t\t\t\t\t\trow.specialCauseFourOfFiveAbove) ||\n\t\t\t\t\t\trow.specialCauseShiftHigh ||\n\t\t\t\t\t\trow.specialCauseTrendIncreasing)) ||\n\t\t\t\t(metricImprovement === ImprovementDirection.Down &&\n\t\t\t\t\t(row.specialCauseTwoOfThreeBelow ||\n\t\t\t\t\t\t(settings.enableFourOfFiveRule &&\n\t\t\t\t\t\t\trow.specialCauseFourOfFiveBelow) ||\n\t\t\t\t\t\trow.specialCauseShiftLow ||\n\t\t\t\t\t\trow.specialCauseTrendDecreasing));\n\t\t\tif ((favourableSingleHigh || favourableSingleLow) && !corroborating) {\n\t\t\t\t// Suppressed favourable single 3\u03C3 point -> show 'no judgement' (purple) icon\n\t\t\t\trow.variationIcon = VariationIcon.None;\n\t\t\t\trow.specialCauseImprovementValue = null;\n\t\t\t}\n\t\t}\n\n\t\tconst anySignal = anyHigh || anyLow;\n\t\trow.specialCauseImprovementValue =\n\t\t\tanySignal && row.variationIcon === VariationIcon.Improvement\n\t\t\t\t? row.value\n\t\t\t\t: null;\n\t\trow.specialCauseConcernValue =\n\t\t\tanySignal && row.variationIcon === VariationIcon.Concern\n\t\t\t\t? row.value\n\t\t\t\t: null;\n\t\trow.specialCauseNeitherValue =\n\t\t\tanySignal && row.variationIcon === VariationIcon.Neither\n\t\t\t\t? row.value\n\t\t\t\t: null;\n\n\t\t// Assurance icon \u2013 capability mode (limits vs target) or fallback single-point\n\t\tif (isNumber(row.value) && row.mean !== null) {\n\t\t\trow.assuranceIcon = AssuranceIcon.None;\n\t\t\tconst inputRow = canonical[row.rowId - 1];\n\t\t\tif (isNumber(inputRow.target)) {\n\t\t\t\tconst t = inputRow.target;\n\t\t\t\tif (\n\t\t\t\t\tsettings.assuranceCapabilityMode &&\n\t\t\t\t\tisNumber(row.upperProcessLimit) &&\n\t\t\t\t\tisNumber(row.lowerProcessLimit)\n\t\t\t\t) {\n\t\t\t\t\tif (metricImprovement === ImprovementDirection.Up) {\n\t\t\t\t\t\tif (row.lowerProcessLimit !== null && row.lowerProcessLimit > t)\n\t\t\t\t\t\t\trow.assuranceIcon = AssuranceIcon.Pass; // whole band above\n\t\t\t\t\t\telse if (\n\t\t\t\t\t\t\trow.upperProcessLimit !== null &&\n\t\t\t\t\t\t\trow.upperProcessLimit < t\n\t\t\t\t\t\t)\n\t\t\t\t\t\t\trow.assuranceIcon = AssuranceIcon.Fail; // whole band below\n\t\t\t\t\t\telse row.assuranceIcon = AssuranceIcon.None; // overlaps -> uncertain\n\t\t\t\t\t} else if (metricImprovement === ImprovementDirection.Down) {\n\t\t\t\t\t\tif (row.upperProcessLimit !== null && row.upperProcessLimit < t)\n\t\t\t\t\t\t\trow.assuranceIcon = AssuranceIcon.Pass; // whole band below (good)\n\t\t\t\t\t\telse if (\n\t\t\t\t\t\t\trow.lowerProcessLimit !== null &&\n\t\t\t\t\t\t\trow.lowerProcessLimit > t\n\t\t\t\t\t\t)\n\t\t\t\t\t\t\trow.assuranceIcon = AssuranceIcon.Fail; // whole band above (bad)\n\t\t\t\t\t\telse row.assuranceIcon = AssuranceIcon.None;\n\t\t\t\t\t} else {\n\t\t\t\t\t\trow.assuranceIcon = AssuranceIcon.None;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (metricImprovement === ImprovementDirection.Down)\n\t\t\t\t\t\trow.assuranceIcon =\n\t\t\t\t\t\t\trow.value <= t ? AssuranceIcon.Pass : AssuranceIcon.Fail;\n\t\t\t\t\telse if (metricImprovement === ImprovementDirection.Up)\n\t\t\t\t\t\trow.assuranceIcon =\n\t\t\t\t\t\t\trow.value >= t ? AssuranceIcon.Pass : AssuranceIcon.Fail;\n\t\t\t\t\telse row.assuranceIcon = AssuranceIcon.None;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Step 5-like warnings\n\tif ((settings.minimumPointsWarning ?? false) && !globalEnough) {\n\t\tconst available = canonical.filter(\n\t\t\t(r) => !r.ghost && isNumber(r.value)\n\t\t).length;\n\t\twarnings.push({\n\t\t\tcode: \"insufficient_points_global\",\n\t\t\tcategory: \"data\",\n\t\t\tseverity: \"warning\",\n\t\t\tmessage: `Only ${available} non-ghost points available; minimum required is ${settings.minimumPoints}. Limits and icons suppressed.`,\n\t\t\tcontext: { available, minimumRequired: settings.minimumPoints },\n\t\t});\n\t}\n\n\tif (settings.variationIconConflictWarning) {\n\t\tfor (const row of output) {\n\t\t\tif (row.variationIcon === VariationIcon.Improvement) {\n\t\t\t\tconst highAndLow =\n\t\t\t\t\t(row.specialCauseSinglePointAbove ||\n\t\t\t\t\t\trow.specialCauseTwoOfThreeAbove ||\n\t\t\t\t\t\t(settings.enableFourOfFiveRule &&\n\t\t\t\t\t\t\trow.specialCauseFourOfFiveAbove) ||\n\t\t\t\t\t\trow.specialCauseShiftHigh ||\n\t\t\t\t\t\trow.specialCauseTrendIncreasing) &&\n\t\t\t\t\t(row.specialCauseSinglePointBelow ||\n\t\t\t\t\t\trow.specialCauseTwoOfThreeBelow ||\n\t\t\t\t\t\t(settings.enableFourOfFiveRule &&\n\t\t\t\t\t\t\trow.specialCauseFourOfFiveBelow) ||\n\t\t\t\t\t\trow.specialCauseShiftLow ||\n\t\t\t\t\t\trow.specialCauseTrendDecreasing);\n\t\t\t\tif (highAndLow)\n\t\t\t\t\twarnings.push({\n\t\t\t\t\t\tcode: \"variation_conflict_row\",\n\t\t\t\t\t\tcategory: \"logic\",\n\t\t\t\t\t\tseverity: \"warning\",\n\t\t\t\t\t\tmessage: `Row ${row.rowId}: simultaneous high/low special-cause signals \u2013 variation icon may be ambiguous.`,\n\t\t\t\t\t\tcontext: { rowId: row.rowId },\n\t\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t// Optional global cap on number of non-ghost points considered\n\tif (settings.maximumPoints && Number.isFinite(settings.maximumPoints)) {\n\t\tconst cap = settings.maximumPoints as number;\n\t\tlet seen = 0;\n\t\tfor (const row of output) {\n\t\t\tif (!row.ghost && isNumber(row.value)) seen++;\n\t\t\tif (seen > cap) {\n\t\t\t\trow.mean = row.upperProcessLimit = row.lowerProcessLimit = null;\n\t\t\t\trow.upperTwoSigma =\n\t\t\t\t\trow.lowerTwoSigma =\n\t\t\t\t\trow.upperOneSigma =\n\t\t\t\t\trow.lowerOneSigma =\n\t\t\t\t\t\tnull;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Extended warning suite\n\tif (settings.nullValueWarning && (chartType === \"XmR\" || chartType === \"G\")) {\n\t\tconst nullCount = canonical.filter(\n\t\t\t(r) =>\n\t\t\t\t!r.ghost &&\n\t\t\t\t(r.value === null || r.value === undefined || !isNumber(r.value))\n\t\t).length;\n\t\tif (nullCount)\n\t\t\twarnings.push({\n\t\t\t\tcode: \"null_values_excluded\",\n\t\t\t\tcategory: \"data\",\n\t\t\t\tseverity: \"info\",\n\t\t\t\tmessage: `${nullCount} null/missing value(s) excluded from calculations.`,\n\t\t\t\tcontext: { nullCount },\n\t\t\t});\n\t}\n\tif (\n\t\tsettings.targetSuppressedWarning &&\n\t\t(chartType === \"T\" || chartType === \"G\")\n\t) {\n\t\tconst hasTarget = canonical.some((r) => isNumber(r.target));\n\t\tif (hasTarget)\n\t\t\twarnings.push({\n\t\t\t\tcode: \"target_ignored_rare_event\",\n\t\t\t\tcategory: \"target\",\n\t\t\t\tseverity: \"info\",\n\t\t\t\tmessage: `Targets provided are ignored for ${chartType} charts in this port.`,\n\t\t\t\tcontext: { chartType },\n\t\t\t});\n\t}\n\tif (\n\t\tsettings.ghostOnRareEventWarning &&\n\t\t(chartType === \"T\" || chartType === \"G\")\n\t) {\n\t\tconst ghostCount = canonical.filter((r) => r.ghost).length;\n\t\tif (ghostCount)\n\t\t\twarnings.push({\n\t\t\t\tcode: \"ghost_rows_rare_event\",\n\t\t\t\tcategory: \"ghost\",\n\t\t\t\tseverity: \"info\",\n\t\t\t\tmessage: `${ghostCount} ghost row(s) supplied for rare-event chart (${chartType}); verify intent.`,\n\t\t\t\tcontext: { chartType, ghostCount },\n\t\t\t});\n\t}\n\tif (settings.partitionSizeWarnings) {\n\t\tObject.entries(partitionNonGhostCounts).forEach(([pid, count]) => {\n\t\t\tif (count < settings.minimumPointsPartition)\n\t\t\t\twarnings.push({\n\t\t\t\t\tcode: \"insufficient_points_partition\",\n\t\t\t\t\tcategory: \"partition\",\n\t\t\t\t\tseverity: \"warning\",\n\t\t\t\t\tmessage: `Partition ${pid} has only ${count} non-ghost point(s); below recommended ${settings.minimumPointsPartition}.`,\n\t\t\t\t\tcontext: {\n\t\t\t\t\t\tpartitionId: Number(pid),\n\t\t\t\t\t\tcount,\n\t\t\t\t\t\tminimum: settings.minimumPointsPartition,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t});\n\t}\n\tif (settings.baselineSpecialCauseWarning) {\n\t\tconst issueRows: number[] = [];\n\t\toutput.forEach((r) => {\n\t\t\tconst input = canonical[r.rowId - 1];\n\t\t\tif (input.baseline) {\n\t\t\t\tconst anySignal =\n\t\t\t\t\tr.specialCauseSinglePointAbove ||\n\t\t\t\t\tr.specialCauseSinglePointBelow ||\n\t\t\t\t\tr.specialCauseTwoOfThreeAbove ||\n\t\t\t\t\tr.specialCauseTwoOfThreeBelow ||\n\t\t\t\t\tr.specialCauseFourOfFiveAbove ||\n\t\t\t\t\tr.specialCauseFourOfFiveBelow ||\n\t\t\t\t\tr.specialCauseShiftHigh ||\n\t\t\t\t\tr.specialCauseShiftLow ||\n\t\t\t\t\tr.specialCauseTrendIncreasing ||\n\t\t\t\t\tr.specialCauseTrendDecreasing;\n\t\t\t\tif (anySignal) issueRows.push(r.rowId);\n\t\t\t}\n\t\t});\n\t\tif (issueRows.length)\n\t\t\twarnings.push({\n\t\t\t\tcode: \"baseline_with_special_cause\",\n\t\t\t\tcategory: \"baseline\",\n\t\t\t\tseverity: \"warning\",\n\t\t\t\tmessage: `Baseline set with special-cause present at row(s): ${issueRows.join(\", \")}.`,\n\t\t\t\tcontext: { rows: issueRows },\n\t\t\t});\n\t}\n\tif (settings.maximumPointsWarnings) {\n\t\tif (\n\t\t\tsettings.maximumPointsPartition &&\n\t\t\tNumber.isFinite(settings.maximumPointsPartition)\n\t\t)\n\t\t\twarnings.push({\n\t\t\t\tcode: \"partition_cap_applied\",\n\t\t\t\tcategory: \"limits\",\n\t\t\t\tseverity: \"info\",\n\t\t\t\tmessage: `Limits suppressed after ${settings.maximumPointsPartition} non-ghost points per partition.`,\n\t\t\t\tcontext: { cap: settings.maximumPointsPartition },\n\t\t\t});\n\t\tif (settings.maximumPoints && Number.isFinite(settings.maximumPoints))\n\t\t\twarnings.push({\n\t\t\t\tcode: \"global_cap_applied\",\n\t\t\t\tcategory: \"limits\",\n\t\t\t\tseverity: \"info\",\n\t\t\t\tmessage: `Limits suppressed after global cap of ${settings.maximumPoints} non-ghost points.`,\n\t\t\t\tcontext: { cap: settings.maximumPoints },\n\t\t\t});\n\t}\n\n\tlet suggestedBaselines: SpcResult['suggestedBaselines'];\n\tif (settings.baselineSuggest) {\n\t\t// Heuristic baseline change (phase) suggestions\n\t\tconst rows = output;\n\t\tconst W = settings.baselineSuggestStabilityPoints;\n\t\tconst minGap = settings.baselineSuggestMinGap;\n\t\tconst minDeltaSigma = settings.baselineSuggestMinDeltaSigma;\n\t\tconst scoreThreshold = settings.baselineSuggestScoreThreshold;\n\t\tconst suggestions: NonNullable<SpcResult['suggestedBaselines']> = [];\n\t\t// Determine existing manual baseline positions (input baselines create new partitions). Use earliest row index for gap.\n\t\tlet lastBaselineIndex = 0; // treat start as baseline\n\t\tfor (let i = 0; i < rows.length; i++) {\n\t\t\tconst r = rows[i];\n\t\t\t// If this row began a new partition (partitionId increment), treat as baseline boundary.\n\t\t\tif (i > 0 && rows[i - 1].partitionId !== r.partitionId) {\n\t\t\t\tlastBaselineIndex = i;\n\t\t\t}\n\t\t\t// Collect candidate triggers only at first point where rule becomes true\n\t\t\tconst prev = rows[i - 1];\n\t\t\tfunction becameTrue(flag: keyof SpcRow): boolean {\n\t\t\t\treturn !!(r as any)[flag] && !(prev as any)?.[flag];\n\t\t\t}\n\t\t\tconst candidates: { reason: 'shift' | 'trend' | 'point'; index: number }[] = [];\n\t\t\tif (becameTrue('specialCauseShiftHigh') || becameTrue('specialCauseShiftLow')) {\n\t\t\t\tcandidates.push({ reason: 'shift', index: i });\n\t\t\t}\n\t\t\tif (becameTrue('specialCauseTrendIncreasing') || becameTrue('specialCauseTrendDecreasing')) {\n\t\t\t\tcandidates.push({ reason: 'trend', index: i });\n\t\t\t}\n\t\t\t// Single 3\u03C3 point candidate \u2013 only if not already part of shift/trend suggestion\n\t\t\tif (becameTrue('specialCauseSinglePointAbove') || becameTrue('specialCauseSinglePointBelow')) {\n\t\t\t\tcandidates.push({ reason: 'point', index: i });\n\t\t\t}\n\t\t\tfor (const c of candidates) {\n\t\t\t\t// Enforce minimum gap\n\t\t\t\tif (c.index - lastBaselineIndex < minGap) continue;\n\t\t\t\t// Windows: previous W non-ghost points before candidate (excluding candidate) & next W points starting at candidate\n\t\t\t\tconst oldStart = Math.max(0, c.index - W);\n\t\t\t\tconst oldEnd = c.index - 1;\n\t\t\t\tif (oldEnd - oldStart + 1 < W) continue; // insufficient history\n\t\t\t\tconst newStart = c.index;\n\t\t\t\tconst newEnd = c.index + W - 1;\n\t\t\t\tif (newEnd >= rows.length) continue; // insufficient future stability window\n\t\t\t\tconst oldVals = rows.slice(oldStart, oldEnd + 1).map(rw => rw.value).filter(isNumber) as number[];\n\t\t\t\tconst newVals = rows.slice(newStart, newEnd + 1).map(rw => rw.value).filter(isNumber) as number[];\n\t\t\t\tif (oldVals.length < W || newVals.length < W) continue;\n\t\t\t\t// Sigma estimate from candidate row (if limits present)\n\t\t\t\tconst cand = rows[c.index];\n\t\t\t\tlet sigma: number | null = null;\n\t\t\t\tif (isNumber(cand.upperProcessLimit) && isNumber(cand.mean)) {\n\t\t\t\t\tconst span = cand.upperProcessLimit - cand.mean;\n\t\t\t\t\tif (span > 0) sigma = span / 3;\n\t\t\t\t}\n\t\t\t\tif (!sigma || sigma <= 0) continue;\n\t\t\t\tconst oldMean = mean(oldVals);\n\t\t\t\tconst newMean = mean(newVals);\n\t\t\t\tconst deltaMean = newMean - oldMean;\n\t\t\t\tif (Math.abs(deltaMean) < minDeltaSigma * sigma) continue;\n\t\t\t\t// Stability: limit number of special cause concern/improvement flags inside new window (<=1 Concern allowed, Improvement neutral)\n\t\t\t\tconst newRows = rows.slice(newStart, newEnd + 1);\n\t\t\t\tconst concernCount = newRows.filter(rw => rw.variationIcon === VariationIcon.Concern).length;\n\t\t\t\tif (concernCount > 1) continue;\n\t\t\t\t// Variance change (optionally reward lower variance)\n\t\t\t\tconst variance = (arr: number[]) => {\n\t\t\t\t\tconst m = mean(arr);\n\t\t\t\t\treturn arr.length ? arr.reduce((a,b)=> a + (b - m) * (b - m), 0) / arr.length : 0;\n\t\t\t\t};\n\t\t\t\tconst oldVar = variance(oldVals);\n\t\t\t\tconst newVar = variance(newVals);\n\t\t\t\tlet scoreBase = c.reason === 'shift' ? 90 : c.reason === 'trend' ? 70 : 60;\n\t\t\t\tif (newVar < oldVar) scoreBase += 10;\n\t\t\t\tscoreBase -= concernCount * 15;\n\t\t\t\tif (scoreBase < scoreThreshold) continue;\n\t\t\t\t// Avoid duplicates at same index (keep highest score / more significant reason ordering shift>trend>point)\n\t\t\t\tconst existing = suggestions.find(s => s.index === c.index);\n\t\t\t\tif (existing) {\n\t\t\t\t\tconst priority = (reason: 'shift'|'trend'|'point') => reason === 'shift' ? 3 : reason === 'trend' ? 2 : 1;\n\t\t\t\t\tif (priority(c.reason) > priority(existing.reason) || scoreBase > existing.score) {\n\t\t\t\t\t\texisting.reason = c.reason;\n\t\t\t\t\t\texisting.score = scoreBase;\n\t\t\t\t\t\texisting.deltaMean = deltaMean;\n\t\t\t\t\t\texisting.oldMean = oldMean;\n\t\t\t\t\t\texisting.newMean = newMean;\n\t\t\t\t\t\texisting.window = [newStart, newEnd];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tsuggestions.push({\n\t\t\t\t\t\tindex: c.index,\n\t\t\t\t\t\treason: c.reason,\n\t\t\t\t\t\tscore: scoreBase,\n\t\t\t\t\t\tdeltaMean,\n\t\t\t\t\t\toldMean,\n\t\t\t\t\t\tnewMean,\n\t\t\t\t\t\twindow: [newStart, newEnd],\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\t// If a manual baseline occurs update lastBaselineIndex\n\t\t\tif (i > 0 && rows[i - 1].partitionId !== rows[i].partitionId) {\n\t\t\t\tlastBaselineIndex = i;\n\t\t\t}\n\t\t}\n\t\tsuggestions.sort((a,b)=> a.index - b.index);\n\t\tsuggestedBaselines = suggestions;\n\t}\n\treturn { rows: output, warnings, ...(suggestedBaselines ? { suggestedBaselines } : {}) };\n}\n\nexport default { buildSpc };\n", "import { VariationIcon, AssuranceIcon, SpcRow } from './spc';\n\n// Stable identifiers for rule flags mapped from SpcRow boolean properties\nexport type SpcRuleId =\n  | 'singlePointAbove'\n  | 'singlePointBelow'\n  | 'twoOfThreeAbove'\n  | 'twoOfThreeBelow'\n  | 'fourOfFiveAbove'\n  | 'fourOfFiveBelow'\n  | 'shiftHigh'\n  | 'shiftLow'\n  | 'trendIncreasing'\n  | 'trendDecreasing';\n\nexport interface SpcRuleGlossaryEntry {\n  /** Short label suitable for dense tooltip list */\n  tooltip: string;\n  /** Longer narration fragment (not full sentence) used when assembling live region text */\n  narration: string;\n}\n\nexport const ruleGlossary: Record<SpcRuleId, SpcRuleGlossaryEntry> = {\n  singlePointAbove: {\n    tooltip: 'Single point above upper control limit',\n    narration: 'Single point beyond a control limit',\n  },\n  singlePointBelow: {\n    tooltip: 'Single point below lower control limit',\n    narration: 'Single point beyond a control limit',\n  },\n  twoOfThreeAbove: {\n    tooltip: 'Two of three points beyond +2\u03C3',\n    narration: 'Two of three points beyond two sigma (same side)',\n  },\n  twoOfThreeBelow: {\n    tooltip: 'Two of three points beyond -2\u03C3',\n    narration: 'Two of three points beyond two sigma (same side)',\n  },\n  fourOfFiveAbove: {\n    tooltip: 'Four of five points beyond +1\u03C3',\n    narration: 'Four of five points beyond one sigma (same side)',\n  },\n  fourOfFiveBelow: {\n    tooltip: 'Four of five points beyond -1\u03C3',\n    narration: 'Four of five points beyond one sigma (same side)',\n  },\n  shiftHigh: {\n    tooltip: 'Shift: run of points above centre line',\n    narration: 'Shift (run on one side of mean)',\n  },\n  shiftLow: {\n    tooltip: 'Shift: run of points below centre line',\n    narration: 'Shift (run on one side of mean)',\n  },\n  trendIncreasing: {\n    tooltip: 'Trend: consecutive increasing points',\n    narration: 'Trend (consecutive increases)',\n  },\n  trendDecreasing: {\n    tooltip: 'Trend: consecutive decreasing points',\n    narration: 'Trend (consecutive decreases)',\n  },\n};\n\n/** Extract the triggered rule identifiers for a given SPC row */\nexport function extractRuleIds(row: SpcRow | undefined | null): SpcRuleId[] {\n  if (!row) return [];\n  const ids: SpcRuleId[] = [];\n  if (row.specialCauseSinglePointAbove) ids.push('singlePointAbove');\n  if (row.specialCauseSinglePointBelow) ids.push('singlePointBelow');\n  if (row.specialCauseTwoOfThreeAbove) ids.push('twoOfThreeAbove');\n  if (row.specialCauseTwoOfThreeBelow) ids.push('twoOfThreeBelow');\n  if (row.specialCauseFourOfFiveAbove) ids.push('fourOfFiveAbove');\n  if (row.specialCauseFourOfFiveBelow) ids.push('fourOfFiveBelow');\n  if (row.specialCauseShiftHigh) ids.push('shiftHigh');\n  if (row.specialCauseShiftLow) ids.push('shiftLow');\n  if (row.specialCauseTrendIncreasing) ids.push('trendIncreasing');\n  if (row.specialCauseTrendDecreasing) ids.push('trendDecreasing');\n  return ids;\n}\n\n/** Standardised human readable label for variation classification */\nexport function variationLabel(icon: VariationIcon | undefined): string | null {\n  switch (icon) {\n    case VariationIcon.Improvement: return 'Improvement signal';\n    case VariationIcon.Concern: return 'Concern signal';\n    case VariationIcon.Neither: return 'Common cause variation';\n    case VariationIcon.None: return null; // suppressed / not enough data\n    default: return null;\n  }\n}\n\n/** Human readable assurance (target) classification */\nexport function assuranceLabel(icon: AssuranceIcon | undefined): string | null {\n  switch (icon) {\n    case AssuranceIcon.Pass: return 'Target met';\n    case AssuranceIcon.Fail: return 'Target not met';\n    default: return null;\n  }\n}\n\n/** Zone classification given mean + sigma + value */\nexport function zoneLabel(mean: number | null | undefined, sigma: number, value: number): string | null {\n  if (mean == null || !Number.isFinite(sigma) || sigma <= 0) return null;\n  const z = Math.abs((value - mean) / sigma);\n  if (z < 1) return 'Within 1\u03C3';\n  if (z < 2) return 'Between 1\u20132\u03C3';\n  if (z < 3) return 'Between 2\u20133\u03C3';\n  return 'Beyond 3\u03C3';\n}\n\n// ------------------------- Shared visual tokens (source of truth) -------------------------\n// Canonical mapping of engine variation icons -> CSS token (with fallback hex).\nexport const VARIATION_COLOR_TOKENS: Record<VariationIcon, { token: string; hex: string }> = {\n  improvement: { token: 'var(--nhs-fdp-color-data-viz-spc-improvement, #00B0F0)', hex: '#00B0F0' },\n  concern:     { token: 'var(--nhs-fdp-color-data-viz-spc-concern, #E46C0A)', hex: '#E46C0A' },\n  none:        { token: 'var(--nhs-fdp-color-data-viz-spc-no-judgement, #490092)', hex: '#490092' },\n  neither:     { token: 'var(--nhs-fdp-color-data-viz-spc-common-cause, #A6A6A6)', hex: '#A6A6A6' },\n};\n\nexport function getVariationColorToken(icon: VariationIcon | undefined): string {\n  if (!icon) return VARIATION_COLOR_TOKENS.neither.token;\n  return VARIATION_COLOR_TOKENS[icon]?.token ?? VARIATION_COLOR_TOKENS.neither.token;\n}\n\nexport function getVariationColorHex(icon: VariationIcon | undefined): string {\n  if (!icon) return VARIATION_COLOR_TOKENS.neither.hex;\n  return VARIATION_COLOR_TOKENS[icon]?.hex ?? VARIATION_COLOR_TOKENS.neither.hex;\n}\n", "import React from 'react';\nimport classNames from 'classnames';\nimport './Tag.scss';\nimport { TagProps } from './Tag.types';\n\nexport const Tag: React.FC<TagProps> = ({\n  text,\n  html,\n  children,\n  color = 'default',\n  noBorder = false,\n  closable = false,\n  onClose,\n  disabled = false,\n  className,\n  ...props\n}) => {\n  const tagClasses = classNames(\n    'nhsuk-tag',\n    {\n      [`nhsuk-tag--${color}`]: color !== 'default',\n      'nhsuk-tag--no-border': noBorder,\n      'nhsuk-tag--closable': closable,\n      'nhsuk-tag--disabled': disabled,\n    },\n    className\n  );\n\n  const handleClose = (e: React.MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    if (!disabled && onClose) {\n      onClose();\n    }\n  };\n\n  return (\n    <strong className={tagClasses} {...props}>\n      {/* Content - children take precedence, then html, then text */}\n      {children ? (\n        children\n      ) : html ? (\n        <span dangerouslySetInnerHTML={{ __html: html }} />\n      ) : (\n        text\n      )}\n      \n      {/* Close button */}\n      {closable && (\n        <button\n          type=\"button\"\n          className=\"nhsuk-tag__close\"\n          onClick={handleClose}\n          disabled={disabled}\n          aria-label=\"Remove\"\n          title=\"Remove\"\n        >\n          \u00D7\n        </button>\n      )}\n    </strong>\n  );\n};\n", "import React, { useId, useMemo } from \"react\";\nimport { tokenColour, getGradientOpacities } from './tokenUtils';\nimport {\n\tcomputePointPositions,\n\tDirection,\n\tgetVariationColour,\n\tgetVariationTrend,\n\tMetricPolarity,\n\tPoint,\n\tVariationJudgement,\n\tVariationState,\n} from \"./SPCConstants\";\n// Token utilities now sourced from shared tokenUtils module.\n// Import VariationIcon enum from SPC engine to permit direct usage with icon component.\n// Updated: point to advanced SPC engine (legacy ../../xmr/spc path removed during refactor)\nimport { VariationIcon as SpcEngineVariationIcon } from \"../SPCChart/logic/spc\";\n\n// Friendly alias exported for consumers who want to pass just the engine icon key\nexport type SpcEngineIconPayload = { variationIcon: SpcEngineVariationIcon; trend?: Direction; polarity?: MetricPolarity };\n\n// --- Variation colour system -------------------------------------------------\n// Primary brand\u2011aligned palette for SPC variation states.\n// stroke: ring / outline; fill: interior glyph colour. In most cases we use the same.\n// You can extend each entry later with lighter/darker ramps if needed for backgrounds.\nexport interface VariationColourDef {\n\thex: string; // canonical colour\n\tstroke?: string; // optional override for stroke (defaults to hex)\n\tfill?: string; // optional override for fill (defaults to hex)\n\tlabel: string; // human readable label\n\tdescription: string; // semantic description for tooltips / a11y\n\ttext?: string; // recommended contrasting text colour\n\tjudgement?: VariationJudgement; // variation judgement\n}\n\n// Accessible text colour picker (simple luminance threshold)\nconst pickTextColour = (hex: string) => {\n\tconst c = hex.replace(\"#\", \"\");\n\tconst r = parseInt(c.slice(0, 2), 16) / 255;\n\tconst g = parseInt(c.slice(2, 4), 16) / 255;\n\tconst b = parseInt(c.slice(4, 6), 16) / 255;\n\tconst srgb = [r, g, b].map((v) =>\n\t\tv <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4)\n\t);\n\tconst L = 0.2126 * srgb[0] + 0.7152 * srgb[1] + 0.0722 * srgb[2];\n\treturn L < 0.55 ? \"#ffffff\" : \"#212b32\";\n};\n\nexport const VARIATION_COLOURS: Record<VariationState, VariationColourDef> = {\n\t[VariationState.SpecialCauseDeteriorating]: {\n\t\thex: tokenColour('concern', '#E46C0A'),\n\t\tjudgement: VariationJudgement.Deteriorating,\n\t\tlabel: \"Special Cause (Deteriorating)\",\n\t\tdescription:\n\t\t\t\"Deteriorating variation detected (special cause) relative to baseline.\",\n\t},\n\t[VariationState.SpecialCauseImproving]: {\n\t\thex: tokenColour('improvement', '#00B0F0'),\n\t\tjudgement: VariationJudgement.Improving,\n\t\tlabel: \"Special Cause (Improving)\",\n\t\tdescription:\n\t\t\t\"Improving variation detected (special cause) relative to baseline.\",\n\t},\n\t[VariationState.CommonCause]: {\n\t\thex: tokenColour('common-cause', '#A6A6A6'),\n\t\tjudgement: VariationJudgement.None,\n\t\tlabel: \"Common Cause\",\n\t\tdescription: \"Common cause variation only \u2013 no special cause detected.\",\n\t},\n\t[VariationState.SpecialCauseNoJudgement]: {\n\t\thex: tokenColour('no-judgement', '#490092'),\n\t\tjudgement: VariationJudgement.No_Judgement,\n\t\tlabel: \"Special Cause (No Judgement)\",\n\t\tdescription:\n\t\t\t\"Special cause detected without assigning improving/deteriorating judgement.\",\n\t},\n};\n\n// Augment each with contrast text colour lazily\nObject.values(VARIATION_COLOURS).forEach((def) => {\n\tif (!def.text) def.text = pickTextColour(def.hex);\n});\n\n// --- Point layout system ----------------------------------------------------\n// We render five recent data points; their vertical positions vary with state + direction\n// Coordinates are in icon space (300x300). We preserve r=16.\n// Chosen layouts (provided examples):\n// - special cause (current \"higher\" pattern)       : existing original coordinates\n// - special cause (\"lower\" pattern)                : alternate set provided\n// - common cause (neutral variation)               : all grey positions provided\n// - special cause no judgement uses direction to choose between higher/lower layout\n\n/**\n * Payload driving the variation icon.\n *\n * The `state` determines the SPC classification (special cause improving/deteriorating,\n * common cause or special cause with no judgement) and therefore the colour.\n * The optional `trend/direction` explicitly controls whether the variation is moving\n * higher or lower relative to the baseline. This allows all eight logical\n * permutations (state \u00D7 trend) to be specified directly. When omitted,\n * a trend will be derived for special cause improving/deteriorating states\n * only; other states will default to 'higher'.\n *\n * `polarity` is retained for alt\u2011text copy but has no effect on colour or\n * letter rendering.\n */\nexport interface SpcVariationPayload {\n\tstate: VariationState;\n\ttrend?: Direction; // explicitly choose geometry (higher/lower)\n\tpolarity?: MetricPolarity;\n}\n\n// New: direct engine variation icon payload (maps engine-level VariationIcon enum to a state)\nexport interface SpcVariationEngineIconPayload {\n\tvariationIcon: SpcEngineVariationIcon;\n\ttrend?: Direction; // required for neutral/none if you want lower layout\n\tpolarity?: MetricPolarity;\n}\n\n/**\n * V2 (derivable) payload \u2013 supply semantic \"what we know\" and let the icon infer \"how to draw\".\n *\n * Inputs\n *  - judgement: SPC variation judgement at the most recent point.\n *      * improving        -> maps to VariationState.SpecialCauseImproving (special cause, positive)\n *      * deteriorating    -> maps to VariationState.SpecialCauseDeteriorating (special cause, negative)\n *      * no_judgement     -> maps to VariationState.SpecialCauseNoJudgement (special cause detected but cannot label direction)\n *      * none             -> maps to VariationState.CommonCause (no special cause)\n *  - polarity: MetricPolarity describing whether higher values are desirable, lower are desirable, or it is context dependent.\n *  - trend (optional): Explicit geometric direction (higher / lower). Only used / needed when the judgement itself does\n *    not imply a direction (no_judgement, none) OR when inference would be ambiguous (e.g. polarity context dependent).\n *\n * Derivation Logic (implemented in resolveStateAndLayout):\n *  1. State mapping is direct from judgement (see above).\n *  2. Direction inference:\n *      a. If judgement is Improving:\n *           - If polarity === LowerIsBetter, a reduction is desirable so the trend is considered Lower.\n *           - Otherwise (HigherIsBetter or ContextDependent), assume Higher.\n *      b. If judgement is Deteriorating:\n *           - If polarity === LowerIsBetter, an increase is undesirable -> direction inferred Higher.\n *           - Otherwise, inferred Lower.\n *      c. If judgement is No_Judgement or None:\n *           - We cannot infer reliably; use provided trend prop or fall back to Higher as a neutral default.\n *  3. Polarity is carried through for potential use in externally generated aria text / tooltips but does not\n *     currently alter colour once state is fixed (colour is keyed solely by final VariationState).\n *\n * Rendering Effects of Derived Values:\n *  - state selects the colour (ring, letter, special glyph) via getVariationColour(state).\n *  - direction selects which set of 5 point coordinates are used (higher vs lower layout) via computePointPositions.\n *  - letter (H / L) is only rendered when judgement is Improving or Deteriorating; it reflects the final direction.\n *  - SpecialCauseNoJudgement renders the purple arrow glyph; direction rotates / orients that glyph.\n *  - CommonCause (state = common cause) suppresses letter and arrow; all points render grey and the ring is grey.\n *  - Special cause states colour the last two data points; common cause keeps all points grey.\n *\n * When to Provide trend explicitly:\n *  - Always for judgement = No_Judgement or None (otherwise a default of Higher is applied which may misrepresent geometry).\n *  - Optionally for Improving/Deteriorating if you wish to override the inferred direction (rare; would make semantics inconsistent).\n *\n * Examples:\n *  { judgement: Improving, polarity: HigherIsBetter } -> state special_cause_improving, direction higher, letter H\n *  { judgement: Improving, polarity: LowerIsBetter }  -> state special_cause_improving, direction lower,  letter L\n *  { judgement: Deteriorating, polarity: HigherIsBetter } -> state special_cause_deteriorating, direction lower,  letter L\n *  { judgement: Deteriorating, polarity: LowerIsBetter }  -> state special_cause_deteriorating, direction higher, letter H\n *  { judgement: No_Judgement, polarity: HigherIsBetter, trend: Lower } -> state special_cause_no_judgement, direction lower, arrow rotated, no letter\n *  { judgement: None, polarity: ContextDependent, trend: Higher } -> state common_cause, direction higher, grey ring, no letter\n */\nexport interface SpcVariationDerivePayload {\n\tjudgement: VariationJudgement;\n\tpolarity: MetricPolarity;\n\ttrend?: Direction; // required when judgement is no_judgement/none OR polarity is context_dependent\n}\n\nexport type SpcVariationInput =\n\t| SpcVariationPayload\n\t| SpcVariationDerivePayload\n\t| SpcVariationParsimonious\n\t| SpcVariationEngineIconPayload;\n\n/**\n * Strict, parsimonious V2 shape \u2014 requires orientation when judgement is neutral\n * or when polarity is context-dependent. This enforces compile-time clarity.\n */\nexport type SpcVariationParsimonious =\n\t| {\n\t\tjudgement: VariationJudgement.Improving;\n\t\tpolarity: MetricPolarity.HigherIsBetter | MetricPolarity.LowerIsBetter;\n\t  }\n\t| {\n\t\tjudgement: VariationJudgement.Deteriorating;\n\t\tpolarity: MetricPolarity.HigherIsBetter | MetricPolarity.LowerIsBetter;\n\t  }\n\t| {\n\t\tjudgement: VariationJudgement.No_Judgement;\n\t\tpolarity: MetricPolarity;\n\t\ttrend: Direction;\n\t  }\n\t| {\n\t\tjudgement: VariationJudgement.None;\n\t\tpolarity: MetricPolarity;\n\t\ttrend: Direction;\n\t  };\n\nexport interface SpcVariationAltIconProps extends SpcIconBaseProps {\n\tdata: SpcVariationParsimonious;\n}\n\n/**\n * Normalise either V1 (state/layout) or V2 (judgement+polarity) into { state, layout, polarity } for rendering.\n */\nconst resolveStateAndLayout = (input: SpcVariationInput): {\n\tstate: VariationState;\n\tdirection: Direction;\n\tpolarity: MetricPolarity;\n} => {\n\t// Engine VariationIcon mapping support\n\tif ((input as SpcVariationEngineIconPayload).variationIcon !== undefined) {\n\t\tconst eng = input as SpcVariationEngineIconPayload;\n\t\tconst mapping: Record<SpcEngineVariationIcon, VariationState> = {\n\t\t\t[SpcEngineVariationIcon.Improvement]: VariationState.SpecialCauseImproving,\n\t\t\t[SpcEngineVariationIcon.Concern]: VariationState.SpecialCauseDeteriorating,\n\t\t\t[SpcEngineVariationIcon.Neither]: VariationState.CommonCause,\n\t\t\t[SpcEngineVariationIcon.None]: VariationState.SpecialCauseNoJudgement,\n\t\t};\n\t\tconst state = mapping[eng.variationIcon];\n\t\tconst direction = (eng.trend ?? (state === VariationState.SpecialCauseImproving\n\t\t\t? Direction.Higher\n\t\t\t: state === VariationState.SpecialCauseDeteriorating\n\t\t\t? Direction.Lower\n\t\t\t: Direction.Higher)) as Direction;\n\t\treturn { state, direction, polarity: eng.polarity ?? MetricPolarity.ContextDependent };\n\t}\n\t// Legacy explicit state payload\n\tif ((input as SpcVariationPayload).state !== undefined) {\n\t\tconst v1 = input as SpcVariationPayload;\n\t\tlet inferred: Direction | undefined;\n\t\tif (v1.state === VariationState.SpecialCauseImproving) inferred = Direction.Higher;\n\t\telse if (v1.state === VariationState.SpecialCauseDeteriorating) inferred = Direction.Lower;\n\t\tconst direction = (v1.trend ?? inferred ?? Direction.Higher) as Direction;\n\t\treturn { state: v1.state, direction, polarity: v1.polarity ?? MetricPolarity.ContextDependent };\n\t}\n\t// Derivation payload based on judgement + polarity\n\tconst v2 = input as SpcVariationDerivePayload;\n\tconst map: Record<VariationJudgement, VariationState> = {\n\t\t[VariationJudgement.Improving]: VariationState.SpecialCauseImproving,\n\t\t[VariationJudgement.Deteriorating]: VariationState.SpecialCauseDeteriorating,\n\t\t[VariationJudgement.No_Judgement]: VariationState.SpecialCauseNoJudgement,\n\t\t[VariationJudgement.None]: VariationState.CommonCause,\n\t};\n\tconst state = map[v2.judgement];\n\tlet direction: Direction;\n\tif (v2.judgement === VariationJudgement.Improving) {\n\t\tdirection = v2.polarity === MetricPolarity.LowerIsBetter ? Direction.Lower : Direction.Higher;\n\t} else if (v2.judgement === VariationJudgement.Deteriorating) {\n\t\tdirection = v2.polarity === MetricPolarity.LowerIsBetter ? Direction.Higher : Direction.Lower;\n\t} else {\n\t\tdirection = (v2.trend ?? Direction.Higher) as Direction;\n\t}\n\treturn { state, direction, polarity: v2.polarity };\n};\n\n/**\n * Derive a rich, sentence\u2011level aria description for assistive tech.\n * This version aligns with MDC accessibility and NHS style.\n */\nexport interface VariationNarrativeContext {\n\tmeasureName?: string;         // e.g. \"Emergency department 4h performance\"\n\tdatasetContext?: string;      // e.g. \"Monthly trust-wide data\"\n\torganisation?: string;        // e.g. \"University Hospital A\"\n\ttimeframe?: string;           // e.g. \"Jan 2024 \u2013 Jul 2025\"\n\tadditionalNote?: string;      // free-form note (intervention, caveat)\n}\n\nexport function deriveVariationAriaDescription(\n\tinput: SpcVariationInput,\n\tcontext?: VariationNarrativeContext\n): string {\n\tconst { state, direction, polarity } = resolveStateAndLayout(input);\n\tconst judgement = getVariationTrend(state);\n\n\t// Use plain-English SPC phrasing: sustained run above/below the mean\n\tconst sideWord = direction === Direction.Higher ? \"above\" : \"below\";\n\tconst trendWord = direction === Direction.Higher ? \"upwards\" : \"downwards\";\n\n\tconst polarityClause = (() => {\n\t\tswitch (polarity) {\n\t\t\tcase MetricPolarity.HigherIsBetter:\n\t\t\t\treturn \"For this measure, higher values are better.\";\n\t\t\tcase MetricPolarity.LowerIsBetter:\n\t\t\t\treturn \"For this measure, lower values are better.\";\n\t\t\tdefault:\n\t\t\t\treturn \"Direction of improvement is context dependent.\";\n\t\t}\n\t})();\n\n\tconst base = (() => {\n\t\tswitch (judgement) {\n\t\t\tcase VariationJudgement.Improving:\n\t\t\t\treturn `Special cause improvement: recent data show a sustained run ${sideWord} the mean (unlikely due to random variation).`;\n\t\t\tcase VariationJudgement.Deteriorating:\n\t\t\t\treturn `Special cause deterioration: recent data show a sustained run ${sideWord} the mean (unlikely due to random variation).`;\n\t\t\tcase VariationJudgement.No_Judgement:\n\t\t\t\treturn `Special cause detected (no value judgement): recent data show a change in level, trending ${trendWord}.`;\n\t\t\tcase VariationJudgement.None:\n\t\t\tdefault:\n\t\t\t\treturn `Common cause variation: points vary randomly around the mean; no special cause detected.`;\n\t\t}\n\t})();\n\tconst parts = [\n\t\tbase,\n\t\tpolarityClause,\n\t\tcontext?.measureName ? `Measure: ${context.measureName}.` : null,\n\t\tcontext?.datasetContext ? `${context.datasetContext}.` : null,\n\t\tcontext?.organisation ? `Organisation: ${context.organisation}.` : null,\n\t\tcontext?.timeframe ? `Timeframe: ${context.timeframe}.` : null,\n\t\tcontext?.additionalNote ? context.additionalNote : null,\n\t];\n\treturn parts.filter(Boolean).join(' ');\n}\n\n/** Assurance states \u2013 SPC\u2011based likelihood to meet target consistently. */\nexport type AssuranceState = \"likely\" | \"unlikely\" | \"uncertain\";\n\nexport interface SpcAssurancePayload {\n\tstate: AssuranceState; // No RAG colours; neutral glyphs.\n\ttargetLabel?: string; // e.g., \"95% within 4h\"\n}\n\n/** Shared visual props */\nexport interface SpcIconBaseProps {\n\tsize?: number; // px; default 44. Consider 32\u201344 for dense tables.\n\tariaLabel?: string; // override accessible label\n\tshowLetter?: boolean; // default true \u2014 render H/L\n\tdropShadow?: boolean; // default true \u2013 apply outer circle shadow\n\t/** When true, apply a diagonal (top-left -> bottom-right) colour wash instead of solid white interior. */\n\tgradientWash?: boolean;\n}\n\nexport interface SpcVariationIconProps extends SpcIconBaseProps {\n\tdata: SpcVariationInput;\n}\n\nexport interface SpcAssuranceIconProps extends SpcIconBaseProps {\n\tdata: SpcAssurancePayload;\n}\n\nexport interface SpcIconsProps {\n\tvariation: SpcVariationIconProps[\"data\"];\n\tassurance: SpcAssuranceIconProps[\"data\"];\n\tsize?: number;\n\tariaLabel?: string; // combined label for the pair\n}\n\n// Derive an H/L direction from the SPC state for backward compatibility.\n// Improving states imply movement upwards; deteriorating states imply downwards.\n// For states without an inherent judgement (common cause or no judgement),\n// return null to allow callers to specify their own direction.\n\n\nexport interface SpcVariationIconPropsAlt extends SpcVariationIconProps {\n\tvariant?: 'classic' | 'triangle' | 'triangleWithRun';\n\trunLength?: number;\n}\n\nexport const SpcVariationIcon = ({\n\tdata,\n\tsize = 44,\n\tariaLabel,\n\tshowLetter = true,\n\tdropShadow = true,\n\tgradientWash = false,\n\tvariant = 'classic',\n\trunLength = 0,\n\t...rest\n}: SpcVariationIconPropsAlt & Record<string, unknown>) => {\n\tconst shadowId = useId();\n\tconst washId = useId();\n\t// Gradient opacities via shared util (ensures import is used)\n\tconst { start: gradStart, mid: gradMid, end: gradEnd, triStart: triGradStart, triMid: triGradMid, triEnd: triGradEnd } = getGradientOpacities();\n\tconst { state, direction } = resolveStateAndLayout(data as SpcVariationInput);\n\tconst colour = getVariationColour(state);\n\tconst judgement = getVariationTrend(state);\n\tconst showLetterForJudgement =\n\t\tjudgement === VariationJudgement.Improving ||\n\t\tjudgement === VariationJudgement.Deteriorating;\n\tconst letter =\n\t\tshowLetter && showLetterForJudgement\n\t\t\t? direction === Direction.Higher\n\t\t\t\t? 'H'\n\t\t\t\t: 'L'\n\t\t\t: '';\n\tconst isSpecial = state !== VariationState.CommonCause;\n\tconst isNoJudgement = state === VariationState.SpecialCauseNoJudgement;\n\tconst neutralGrey = tokenColour('common-cause', '#A6A6A6');\n\tconst pointColour = isSpecial ? colour.hex : neutralGrey;\n\tconst points: Point[] = useMemo(\n\t\t() => computePointPositions(state, direction),\n\t\t[state, direction]\n\t);\n\tconst aria =\n\t\tariaLabel ||\n\t\t`${colour.label}${\n\t\t\tletter ? (direction === Direction.Higher ? ' \u2013 Higher' : ' \u2013 Lower') : ''\n\t\t}`;\n\tconst ariaDescription = deriveVariationAriaDescription(\n\t\tdata as SpcVariationInput\n\t);\n\n\t// --- Triangle with run rendering (new) ---\n\tif (variant === 'triangleWithRun') {\n\t\t// Short triangle with run indicator (five small circles)\n\t\tconst triSize = 100;\n\t\tconst centerX = 150;\n\t\tconst centerY = 140;\n\t\tconst upTriangle = [\n\t\t\t[centerX, centerY - triSize / 2],\n\t\t\t[centerX - triSize / 2, centerY + triSize / 2],\n\t\t\t[centerX + triSize / 2, centerY + triSize / 2],\n\t\t];\n\t\tconst downTriangle = [\n\t\t\t[centerX, centerY + triSize / 2],\n\t\t\t[centerX - triSize / 2, centerY - triSize / 2],\n\t\t\t[centerX + triSize / 2, centerY - triSize / 2],\n\t\t];\n\t\t// flatLine intentionally omitted \u2014 rendered as a short line when needed directly in JSX\n\t\tlet shape: React.ReactNode = null;\n\t\tlet shapeLetter = '';\n\t\tif (state === VariationState.SpecialCauseImproving) {\n\t\t\tshape = (\n\t\t\t\t<polygon\n\t\t\t\t\tpoints={upTriangle.map((p) => p.join(',')).join(' ')}\n\t\t\t\t\tfill={colour.hex}\n\t\t\t\t\tstroke={colour.hex}\n\t\t\t\t\tstrokeWidth={6}\n\t\t\t\t\ttransform=\"translate(0, -15)\"\n\t\t\t\t/>\n\t\t\t);\n\t\t\tshapeLetter = 'H';\n\t\t} else if (state === VariationState.SpecialCauseDeteriorating) {\n\t\t\tshape = (\n\t\t\t\t<polygon\n\t\t\t\t\tpoints={downTriangle.map((p) => p.join(',')).join(' ')}\n\t\t\t\t\tfill={colour.hex}\n\t\t\t\t\tstroke={colour.hex}\n\t\t\t\t\tstrokeWidth={6}\n\t\t\t\t\ttransform=\"translate(0, 15)\"\n\t\t\t\t/>\n\t\t\t);\n\t\t\tshapeLetter = 'L';\n\t\t} else if (state === VariationState.SpecialCauseNoJudgement) {\n\t\t\tshape = (\n\t\t\t\t<polygon\n\t\t\t\t\tpoints={\n\t\t\t\t\t\tdirection === Direction.Higher\n\t\t\t\t\t\t\t? upTriangle.map((p) => p.join(',')).join(' ')\n\t\t\t\t\t\t\t: downTriangle.map((p) => p.join(',')).join(' ')\n\t\t\t\t\t}\n\t\t\t\t\tfill={colour.hex}\n\t\t\t\t\tstroke={colour.hex}\n\t\t\t\t\tstrokeWidth={6}\n\t\t\t\t\ttransform={direction === Direction.Higher ? 'translate(0,-6)' : 'translate(0,6)'}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\t// Run circles\n\t\tconst runLen = Math.max(0, Math.min(5, Math.floor(runLength || 0)));\n\t\tconst runY = state === VariationState.CommonCause ? 160 : direction === Direction.Higher ? 210 : 70;\n\t\tconst runRadius = 10;\n\t\tconst runGap = 26;\n\t\tconst runStartX = centerX - 2 * runGap;\n\t\tconst runColor = state === VariationState.SpecialCauseImproving\n\t\t\t? tokenColour('improvement', '#00B0F0')\n\t\t\t: state === VariationState.SpecialCauseDeteriorating\n\t\t\t? tokenColour('concern', '#E46C0A')\n\t\t\t: neutralGrey;\n\t\tconst runCircles = Array.from({ length: 5 }).map((_, i) => {\n\t\tconst filled = (state === VariationState.SpecialCauseImproving || state === VariationState.SpecialCauseDeteriorating) && i >= 5 - runLen;\n\t\tconst fill = filled ? runColor : neutralGrey;\n\t\t\treturn <circle key={i} cx={runStartX + i * runGap} cy={runY} r={runRadius} fill={fill} stroke={fill} strokeWidth={1} />;\n\t\t});\n\t\treturn (\n\t\t\t<svg width={size} height={size} viewBox=\"0 0 300 300\" role=\"img\" aria-label={aria} aria-description={ariaDescription} {...rest}>\n\t\t\t\t<defs>\n\t\t\t\t\t{dropShadow && (\n\t\t\t\t\t\t<filter id={shadowId} filterUnits=\"objectBoundingBox\">\n\t\t\t\t\t\t\t<feGaussianBlur stdDeviation=\"3\" />\n\t\t\t\t\t\t\t<feOffset dx=\"0\" dy=\"15\" result=\"blur\" />\n\t\t\t\t\t\t\t<feFlood floodColor=\"rgb(150,150,150)\" floodOpacity=\"1\" />\n\t\t\t\t\t\t\t<feComposite in2=\"blur\" operator=\"in\" result=\"colorShadow\" />\n\t\t\t\t\t\t\t<feComposite in=\"SourceGraphic\" in2=\"colorShadow\" operator=\"over\" />\n\t\t\t\t\t\t</filter>\n\t\t\t\t\t)}\n\t\t\t\t\t{gradientWash && (\n\t\t\t\t\t\t<linearGradient id={washId} x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n\t\t\t\t\t\t\t<stop offset=\"0%\" stopColor={colour.hex} stopOpacity={parseFloat(triGradStart)} />\n\t\t\t\t\t\t\t<stop offset=\"75%\" stopColor={colour.hex} stopOpacity={parseFloat(triGradMid)} />\n\t\t\t\t\t\t\t<stop offset=\"100%\" stopColor=\"#ffffff\" stopOpacity={parseFloat(triGradEnd)} />\n\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t)}\n\t\t\t\t</defs>\n\t\t\t\t<circle stroke=\"none\" fill={gradientWash ? `url(#${washId})` : '#ffffff'} {...(dropShadow ? { filter: `url(#${shadowId})` } : {})} cx=\"150\" cy=\"150\" r=\"120\" />\n\t\t\t\t<circle stroke={colour.hex} strokeWidth={15} strokeMiterlimit={10} fill=\"none\" cx=\"150\" cy=\"150\" r=\"120\" />\n\t\t\t\t<g transform={ direction === Direction.Higher ? \"translate(0,-10)\" : \"translate(0,20)\"}>\n\t\t\t\t\t{shape}\n\t\t\t\t\t{shapeLetter && (\n\t\t\t\t\t\t<text fill=\"#fff\" fontFamily=\"'Frutiger W01', Frutiger, Arial, 'Helvetica Neue', Helvetica, sans-serif\" fontWeight=\"bold\" fontSize={64} x=\"150\" y={direction === Direction.Higher ? 150 : 145} textAnchor=\"middle\" dominantBaseline=\"middle\">{shapeLetter}</text>\n\t\t\t\t\t)}\n\t\t\t\t\t{runCircles}\n\t\t\t\t</g>\n\t\t\t</svg>\n\t\t);\n\t}\n\n\t// --- Alternative triangle rendering ---\n\tif (variant === 'triangle') {\n\t\t// Triangle geometry\n\t\t// Upward triangle: base at bottom, tip at top\n\t\t// Downward triangle: base at top, tip at bottom\n\t\t// Centered at (150,150), size ~120px\n\t\tconst triSize = 150;\n\t\tconst centerX = 150;\n\t\tconst centerY = 150;\n\t\tconst upTriangle = [\n\t\t\t[centerX, centerY - triSize / 2],\n\t\t\t[centerX - triSize / 2, centerY + triSize / 2],\n\t\t\t[centerX + triSize / 2, centerY + triSize / 2],\n\t\t];\n\t\tconst downTriangle = [\n\t\t\t[centerX, centerY + triSize / 2],\n\t\t\t[centerX - triSize / 2, centerY - triSize / 2],\n\t\t\t[centerX + triSize / 2, centerY - triSize / 2],\n\t\t];\n\t\t// Flat line for neither\n\t\tconst flatLine = [\n\t\t\t[centerX - triSize / 2, centerY + triSize / 2],\n\t\t\t[centerX + triSize / 2, centerY + triSize / 2],\n\t\t];\n\tlet shape: React.ReactNode = null;\n\t\tif (state === VariationState.SpecialCauseImproving) {\n\t\t\tshape = (\n\t\t\t\t<>\n\t\t\t\t<polygon\n\t\t\t\t\tpoints={upTriangle.map((p) => p.join(',')).join(' ')}\n\t\t\t\t\tfill={colour.hex}\n\t\t\t\t\tstroke={colour.hex}\n\t\t\t\t\tstrokeWidth={8}\n\t\t\t\t\ttransform=\"translate(0, -10)\"\n\t\t\t\t/>\n\t\t\t\t<text\n\t\t\t\t\tfill=\"#fff\"\n\t\t\t\t\tfontFamily=\"'Frutiger W01', Frutiger, Arial, 'Helvetica Neue', Helvetica, sans-serif\"\n\t\t\t\t\tfontWeight=\"bold\"\n\t\t\t\t\tfontSize={100}\n\t\t\t\t\tx=\"150\"\n\t\t\t\t\ty=\"175\"\n\t\t\t\t\ttextAnchor=\"middle\"\n\t\t\t\t\tdominantBaseline=\"middle\"\n\t\t\t\t>\n\t\t\t\t\t{'H'}\n\t\t\t\t\t</text>\n\t\t\t\t</>\n\t\t\t);\n\t\t} else if (state === VariationState.SpecialCauseDeteriorating) {\n\t\t\tshape = (\n\t\t\t\t<>\n\t\t\t\t<polygon\n\t\t\t\t\tpoints={downTriangle.map((p) => p.join(',')).join(' ')}\n\t\t\t\t\tfill={colour.hex}\n\t\t\t\t\tstroke={colour.hex}\n\t\t\t\t\tstrokeWidth={8}\n\t\t\t\t\ttransform=\"translate(0, 10)\"\n\t\t\t\t/>\n\t\t\t\t<text\n\t\t\t\t\tfill=\"#fff\"\n\t\t\t\t\tfontFamily=\"'Frutiger W01', Frutiger, Arial, 'Helvetica Neue', Helvetica, sans-serif\"\n\t\t\t\t\tfontWeight=\"bold\"\n\t\t\t\t\tfontSize={100}\n\t\t\t\t\tx=\"150\"\n\t\t\t\t\ty=\"145\"\n\t\t\t\t\ttextAnchor=\"middle\"\n\t\t\t\t\tdominantBaseline=\"middle\"\n\t\t\t\t>\n\t\t\t\t\t{'L'}\n\t\t\t\t\t</text>\n\t\t\t\t</>\n\t\t\t);\t\t\t\n\t\t} else if (state === VariationState.SpecialCauseNoJudgement) {\n\t\t\t// Up or down triangle, no letter\n\t\t\tshape = (\n\t\t\t\t<polygon\n\t\t\t\t\tpoints={\n\t\t\t\t\t\tdirection === Direction.Higher\n\t\t\t\t\t\t\t? upTriangle.map((p) => p.join(',')).join(' ')\n\t\t\t\t\t\t\t: downTriangle.map((p) => p.join(',')).join(' ')\n\t\t\t\t\t}\n\t\t\t\t\tfill={colour.hex}\n\t\t\t\t\tstroke={colour.hex}\n\t\t\t\t\tstrokeWidth={8}\n\t\t\t\t\ttransform={direction === Direction.Higher ? \"translate(0, -15)\" : \"translate(0, 15)\"}\n\t\t\t\t/>\n\t\t\t);\n\t\t} else if (state === VariationState.CommonCause) {\n\t\t\t// Flat line\n\t\t\tshape = (\n\t\t\t\t<line\n\t\t\t\t\tx1={flatLine[0][0]}\n\t\t\t\t\ty1={flatLine[0][1]}\n\t\t\t\t\tx2={flatLine[1][0]}\n\t\t\t\t\ty2={flatLine[1][1]}\n\t\t\t\t\tstroke={colour.hex}\n\t\t\t\t\tstrokeWidth={32}\n\t\t\t\t\tstrokeLinecap=\"square\"\n\t\t\t\t\ttransform=\"translate(0, -75)\"\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\treturn (\n\t\t\t<svg\n\t\t\t\twidth={size}\n\t\t\t\theight={size}\n\t\t\t\tviewBox=\"0 0 300 300\"\n\t\t\t\trole=\"img\"\n\t\t\t\taria-label={aria}\n\t\t\t\taria-description={ariaDescription}\n\t\t\t\t{...rest}\n\t\t\t>\n\t\t\t\t<defs>\n\t\t\t\t\t{dropShadow && (\n\t\t\t\t\t\t<filter id={shadowId} filterUnits=\"objectBoundingBox\">\n\t\t\t\t\t\t\t<feGaussianBlur stdDeviation=\"3\" />\n\t\t\t\t\t\t\t<feOffset dx=\"0\" dy=\"15\" result=\"blur\" />\n\t\t\t\t\t\t\t<feFlood floodColor=\"rgb(150,150,150)\" floodOpacity=\"1\" />\n\t\t\t\t\t\t\t<feComposite in2=\"blur\" operator=\"in\" result=\"colorShadow\" />\n\t\t\t\t\t\t\t<feComposite in=\"SourceGraphic\" in2=\"colorShadow\" operator=\"over\" />\n\t\t\t\t\t\t</filter>\n\t\t\t\t\t)}\n\t\t\t\t\t{gradientWash && (\n\t\t\t\t\t\t<linearGradient id={washId} x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n\t\t\t\t\t\t\t<stop offset=\"0%\" stopColor={colour.hex} stopOpacity={parseFloat(triGradStart)} />\n\t\t\t\t\t\t\t<stop offset=\"65%\" stopColor={colour.hex} stopOpacity={parseFloat(triGradMid)} />\n\t\t\t\t\t\t\t<stop offset=\"100%\" stopColor=\"#ffffff\" stopOpacity={parseFloat(triGradEnd)} />\n\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t)}\n\t\t\t\t</defs>\n\t\t\t\t<circle\n\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\tfill={gradientWash ? `url(#${washId})` : '#ffffff'}\n\t\t\t\t\t{...(dropShadow ? { filter: `url(#${shadowId})` } : {})}\n\t\t\t\t\tcx=\"150\"\n\t\t\t\t\tcy=\"150\"\n\t\t\t\t\tr=\"120\"\n\t\t\t\t/>\n\t\t\t\t<circle\n\t\t\t\t\tstroke={colour.hex}\n\t\t\t\t\tstrokeWidth={15}\n\t\t\t\t\tstrokeMiterlimit={10}\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tcx=\"150\"\n\t\t\t\t\tcy=\"150\"\n\t\t\t\t\tr=\"120\"\n\t\t\t\t/>\n\t\t\t\t{shape}\n\t\t\t</svg>\n\t\t);\n\t}\n\n\t// --- Default/classic rendering ---\n\treturn (\n\t\t<svg\n\t\t\twidth={size}\n\t\t\theight={size}\n\t\t\tviewBox=\"0 0 300 300\"\n\t\t\trole=\"img\"\n\t\t\taria-label={aria}\n\t\t\taria-description={ariaDescription}\n\t\t\t{...rest}\n\t\t>\n\t\t\t<defs>\n\t\t\t\t{dropShadow && (\n\t\t\t\t\t<filter id={shadowId} filterUnits=\"objectBoundingBox\">\n\t\t\t\t\t\t<feGaussianBlur stdDeviation=\"3\" />\n\t\t\t\t\t\t<feOffset dx=\"0\" dy=\"15\" result=\"blur\" />\n\t\t\t\t\t\t<feFlood floodColor=\"rgb(150,150,150)\" floodOpacity=\"1\" />\n\t\t\t\t\t\t<feComposite in2=\"blur\" operator=\"in\" result=\"colorShadow\" />\n\t\t\t\t\t\t<feComposite in=\"SourceGraphic\" in2=\"colorShadow\" operator=\"over\" />\n\t\t\t\t\t</filter>\n\t\t\t\t)}\n\t\t\t\t{gradientWash && (\n\t\t\t\t\t<linearGradient id={washId} x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n\t\t\t\t\t\t<stop offset=\"0%\" stopColor={colour.hex} stopOpacity={parseFloat(gradStart)} />\n\t\t\t\t\t\t<stop offset=\"65%\" stopColor={colour.hex} stopOpacity={parseFloat(gradMid)} />\n\t\t\t\t\t\t<stop offset=\"100%\" stopColor=\"#ffffff\" stopOpacity={parseFloat(gradEnd)} />\n\t\t\t\t\t</linearGradient>\n\t\t\t\t)}\n\t\t\t</defs>\n\t\t\t<circle\n\t\t\t\tstroke=\"none\"\n\t\t\t\tfill={gradientWash ? `url(#${washId})` : '#ffffff'}\n\t\t\t\t{...(dropShadow ? { filter: `url(#${shadowId})` } : {})}\n\t\t\t\tcx=\"150\"\n\t\t\t\tcy=\"150\"\n\t\t\t\tr=\"120\"\n\t\t\t/>\n\t\t\t<circle\n\t\t\t\tstroke={colour.hex}\n\t\t\t\tstrokeWidth={15}\n\t\t\t\tstrokeMiterlimit={10}\n\t\t\t\tfill=\"none\"\n\t\t\t\tcx=\"150\"\n\t\t\t\tcy=\"150\"\n\t\t\t\tr=\"120\"\n\t\t\t/>\n\t\t\t{letter && (\n\t\t\t\t<text\n\t\t\t\t\tfill={colour.hex}\n\t\t\t\t\tfontFamily=\"Arial-BoldMT, Arial, 'Helvetica Neue', Helvetica, sans-serif\"\n\t\t\t\t\tfontWeight=\"bold\"\n\t\t\t\t\tfontSize={176}\n\t\t\t\t\ttransform=\"translate(86.67, 54) scale(0.5, 0.5)\"\n\t\t\t\t\ttextAnchor=\"end\"\n\t\t\t\t>\n\t\t\t\t\t<tspan x=\"120\" y={direction === Direction.Lower ? '325' : '156'}>\n\t\t\t\t\t\t{letter}\n\t\t\t\t\t</tspan>\n\t\t\t\t</text>\n\t\t\t)}\n\t\t\t{/* Special Cause (No Judgement) arrow glyph: vertical arrow indicating orientation.\n\t\t\t\tUp (layout Higher) shows arrow pointing up; Down (layout Lower) rotates 90\u00B0. */}\n\t\t\t{isNoJudgement ? (\n\t\t\t\t<path\n\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\tfillRule=\"evenodd\"\n\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\tfill={colour.hex}\n\t\t\t\t\t{...(direction === Direction.Lower\n\t\t\t\t\t\t? { transform: 'rotate(90 150 150)' }\n\t\t\t\t\t\t: { transform: 'translate(-5 0) rotate(0 150 150)' })}\n\t\t\t\t\td=\"M 90.26,185.42 L 149.31,126.37 127.44,104.51 209.81,90.66 195.96,173.02 174.09,151.16 115.05,210.2 90.26,185.42 Z M 90.26,185.42\"\n\t\t\t\t/>\n\t\t\t) : (\n\t\t\t\t<>\n\t\t\t\t\t{/* Trend path connecting the five point centres */}\n\t\t\t\t\t{points.length === 5 && (\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke={neutralGrey}\n\t\t\t\t\t\t\tstrokeWidth={12}\n\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\t\topacity={0.9}\n\t\t\t\t\t\t\td={`M ${points.map((p) => `${p.cx} ${p.cy}`).join(' L ')}`}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{/* Data points (last two coloured when judgement positive or negative) */}\n\t\t\t\t\t{points.map((p: Point, i: number) => {\n\t\t\t\t\t\tconst specialIdx = i >= points.length - 2 && isSpecial; // last two\n\t\t\t\t\t\tconst fill = specialIdx ? pointColour : neutralGrey;\n\t\t\t\t\t\tconst stroke = fill;\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<circle\n\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\tstroke={stroke}\n\t\t\t\t\t\t\t\tstrokeWidth={2}\n\t\t\t\t\t\t\t\tstrokeMiterlimit={10}\n\t\t\t\t\t\t\t\tfill={fill}\n\t\t\t\t\t\t\t\tcx={p.cx}\n\t\t\t\t\t\t\t\tcy={p.cy}\n\t\t\t\t\t\t\t\tr={16}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</>\n\t\t\t)}\n\t\t</svg>\n\t);\n};\n\nSpcVariationIcon.displayName = 'SpcVariationIcon';\n", "// Shared token lookup utilities for SPC icons.\nlet spcTokenRoot: Record<string, any> | null = null;\ntry {\n  // Dynamic require to avoid breaking SSR if tokens file not present at runtime.\n  // @ts-ignore - compiled artifact path resolved post-build\n  const tokens = require('@fergusbisset/nhs-fdp-design-system/dist/js/tokens.json');\n  spcTokenRoot = tokens?.color?.['data-viz']?.spc || null;\n} catch {\n  // Swallow \u2013 fall back to provided colour fallbacks.\n}\n\nexport const tokenColour = (key: string, fallback: string): string => {\n  if (!spcTokenRoot) return fallback;\n  const parts = key.split('.');\n  let current: any = spcTokenRoot;\n  for (const p of parts) { if (current == null) break; current = current[p]; }\n  const val = current;\n  if (val == null) return fallback;\n  if (typeof val === 'string' || typeof val === 'number') return String(val);\n  if (val.$value != null) return String(val.$value);\n  if (val.value != null) return String(val.value);\n  return fallback;\n};\n\nexport const getGradientOpacities = () => ({\n  start: tokenColour('gradient.stop.start-opacity', '0.18'),\n  mid: tokenColour('gradient.stop.mid-opacity', '0.06'),\n  end: tokenColour('gradient.stop.end-opacity', '0'),\n  triStart: tokenColour('gradient.stop.triangle-start-opacity', tokenColour('gradient.stop.start-opacity', '0.18')),\n  triMid: tokenColour('gradient.stop.triangle-mid-opacity', tokenColour('gradient.stop.mid-opacity', '0.06')),\n  triEnd: tokenColour('gradient.stop.triangle-end-opacity', tokenColour('gradient.stop.end-opacity', '0')),\n});\n", "// Simple three\u2011state assurance enum\nexport enum AssuranceResult {\n  Pass = 'pass',\n  Fail = 'fail',\n  Uncertain = 'uncertain'\n}\n\n// Pull canonical SPC palette from engine logic (source of truth)\nimport { VARIATION_COLOR_TOKENS } from \"../SPCChart/logic/spcDescriptors\";\n\n// Default colours aligned to variation icon palette\nexport const DEFAULT_COLOURS: Record<AssuranceResult, string> = {\n  [AssuranceResult.Pass]: '#00B0F0', // blue\n  [AssuranceResult.Fail]: '#E46C0A', // orange\n  [AssuranceResult.Uncertain]: '#A6A6A6' // grey\n};\n\n// Default letters to show for each state\nexport const DEFAULT_LETTERS: Record<AssuranceResult, string> = {\n  [AssuranceResult.Pass]: 'P',\n  [AssuranceResult.Fail]: 'F',\n  [AssuranceResult.Uncertain]: '?'\n};\n\n// Metric polarity tells us if \"higher\" is good or bad for interpretation text.\nexport enum MetricPolarity {\n  HigherIsBetter = 'higher_is_better',\n  LowerIsBetter = 'lower_is_better',\n  ContextDependent = 'context_dependent'\n}\n\n// Orientation / geometry (was TrendDirection / Layout earlier)\nexport enum Direction {\n  Higher = 'higher',\n  Lower = 'lower'\n}\n\nexport enum VariationJudgement {\n  Improving = 'improving',\n  Deteriorating = 'deteriorating',\n  No_Judgement = 'no_judgement',\n  None = 'none'\n}\n\nexport enum VariationState {\n  SpecialCauseImproving = 'special_cause_improving',\n  SpecialCauseDeteriorating = 'special_cause_deteriorating',\n  CommonCause = 'common_cause',\n  SpecialCauseNoJudgement = 'special_cause_no_judgement'\n}\n\nexport interface VariationColourDef {\n  hex: string;\n  stroke?: string;\n  fill?: string;\n  label: string;\n  description: string;\n  text?: string;\n  judgement?: VariationJudgement;\n}\n\n// Geometry constants (legacy 300x300 artboard)\nexport const ICON_VIEWBOX = '0 0 300 300';\nexport const ICON_SIZE = 300; // default px\nexport const ICON_CX = 150;\nexport const ICON_CY = 150;\nexport const ICON_R = 113.25;\nexport const POINT_RADIUS = 16;\n\n// Base polygon path currently used for No Judgement glyph (points upward by default)\nexport const NO_JUDGEMENT_GLYPH_PATH = 'M 90.26,185.42 L 149.31,126.37 127.44,104.51 209.81,90.66 195.96,173.02 174.09,151.16 115.05,210.2 90.26,185.42 Z M 90.26,185.42';\n\n// Accessible text colour picker (simple luminance threshold)\nconst pickTextColour = (hex: string) => {\n  const c = hex.replace('#', '');\n  const r = parseInt(c.slice(0, 2), 16) / 255;\n  const g = parseInt(c.slice(2, 4), 16) / 255;\n  const b = parseInt(c.slice(4, 6), 16) / 255;\n  const srgb = [r, g, b].map(v => (v <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4)));\n  const L = 0.2126 * srgb[0] + 0.7152 * srgb[1] + 0.0722 * srgb[2];\n  return L < 0.55 ? '#ffffff' : '#212b32';\n};\n\nexport const VARIATION_COLOURS: Record<VariationState, VariationColourDef> = {\n  [VariationState.SpecialCauseDeteriorating]: {\n  hex: VARIATION_COLOR_TOKENS.concern.hex,\n    judgement: VariationJudgement.Deteriorating,\n    label: 'Special Cause (Deteriorating)',\n    description: 'Deteriorating variation detected (special cause) relative to baseline.'\n  },\n  [VariationState.SpecialCauseImproving]: {\n  hex: VARIATION_COLOR_TOKENS.improvement.hex,\n    judgement: VariationJudgement.Improving,\n    label: 'Special Cause (Improving)',\n    description: 'Improving variation detected (special cause) relative to baseline.'\n  },\n  [VariationState.CommonCause]: {\n  hex: VARIATION_COLOR_TOKENS.neither.hex,\n    judgement: VariationJudgement.None,\n    label: 'Common Cause',\n    description: 'Common cause variation only \u2013 no special cause detected.'\n  },\n  [VariationState.SpecialCauseNoJudgement]: {\n  hex: VARIATION_COLOR_TOKENS.none.hex,\n    judgement: VariationJudgement.No_Judgement,\n    label: 'Special Cause (No Judgement)',\n    description: 'Special cause detected without assigning improving/deteriorating judgement.'\n  }\n};\n\nObject.values(VARIATION_COLOURS).forEach(def => { if (!def.text) def.text = pickTextColour(def.hex); });\n\nexport const getVariationColour = (state: VariationState) => VARIATION_COLOURS[state];\nexport const getVariationTrend = (state: VariationState): VariationJudgement => VARIATION_COLOURS[state].judgement || VariationJudgement.None;\n\nexport interface Point { cx: number; cy: number }\n\nexport const POINT_LAYOUTS = {\n  special: {\n    higher: [\n      { cx: 77.5, cy: 158.5 },\n      { cx: 114, cy: 175 },\n      { cx: 150.5, cy: 158.5 },\n      { cx: 188, cy: 125 },\n      { cx: 225, cy: 137 }\n    ],\n    lower: [\n      { cx: 77.5, cy: 139.5 },\n      { cx: 114, cy: 124.5 },\n      { cx: 150.5, cy: 139.5 },\n      { cx: 188, cy: 175.5 },\n      { cx: 224.5, cy: 162 }\n    ]\n  },\n  common: [\n    { cx: 76.5, cy: 149.5 },\n    { cx: 113, cy: 179.5 },\n    { cx: 149.5, cy: 117 },\n    { cx: 187, cy: 171 },\n    { cx: 223.5, cy: 158 }\n  ]\n} as const;\n\nexport function computePointPositions(state: VariationState, direction: Direction): Point[] {\n  let src;\n  if (state === VariationState.CommonCause) src = POINT_LAYOUTS.common;\n  else src = POINT_LAYOUTS.special[direction === Direction.Lower ? 'lower' : 'higher'];\n  return src.map(p => ({ ...p }));\n}\n\n// Narrow type for example payloads (matches derivation form accepted by SpcVariationIcon)\ninterface VariationExampleData {\n  judgement: VariationJudgement;\n  polarity: MetricPolarity;\n  trend?: Direction; // only required for No_Judgement / None examples\n}\n\nexport const variationExamples: { id: string; label: string; data: VariationExampleData }[] = [\n\t{ id: 'improve-higher', label: 'Improving (Higher is Better) \u2013 Trend is Higher', data: { judgement: VariationJudgement.Improving, polarity: MetricPolarity.HigherIsBetter } },\n\t{ id: 'improve-lower', label: 'Improving (Lower is Better) \u2013 Trend is Lower', data: { judgement: VariationJudgement.Improving, polarity: MetricPolarity.LowerIsBetter } },\n\t{ id: 'deteriorate-higher', label: 'Deteriorating (Higher is Better) \u2013 Trend is Lower', data: { judgement: VariationJudgement.Deteriorating, polarity: MetricPolarity.HigherIsBetter } },\n\t{ id: 'deteriorate-lower', label: 'Deteriorating (Lower is Better) \u2013 Trend is Higher', data: { judgement: VariationJudgement.Deteriorating, polarity: MetricPolarity.LowerIsBetter } },\n\t{ id: 'no-judgement-higher', label: 'Special Cause (No Judgement) \u2013 Trend is Higher', data: { judgement: VariationJudgement.No_Judgement, polarity: MetricPolarity.ContextDependent, trend: Direction.Higher } },\n\t{ id: 'no-judgement-lower', label: 'Special Cause (No Judgement) \u2013 Lower', data: { judgement: VariationJudgement.No_Judgement, polarity: MetricPolarity.ContextDependent, trend: Direction.Lower } },\n\t{ id: 'common-cause-higher', label: 'Common Cause \u2013 Higher layout', data: { judgement: VariationJudgement.None, polarity: MetricPolarity.HigherIsBetter, trend: Direction.Higher } },\n\t{ id: 'common-cause-lower', label: 'Common Cause \u2013 Lower layout', data: { judgement: VariationJudgement.None, polarity: MetricPolarity.HigherIsBetter, trend: Direction.Lower } }\n];\n\nexport const assuranceExamples = [\n\t{ id: 'assurance-pass', label: 'Assurance Pass', status: AssuranceResult.Pass },\n\t{ id: 'assurance-fail', label: 'Assurance Fail', status: AssuranceResult.Fail },\n\t{ id: 'assurance-uncertain', label: 'Assurance Uncertain', status: AssuranceResult.Uncertain }\n];\n\n// Compatibility re-exports: canonical tokens & helpers live in SPCChart logic; re-export here for older imports\nexport { VARIATION_COLOR_TOKENS } from \"../SPCChart/logic/spcDescriptors\";\nexport { getVariationColorToken, getVariationColorHex } from \"../SPCChart/logic/spcDescriptors\";\nexport type { VariationIcon } from \"../SPCChart/logic/spc\";", "import { useId } from \"react\";\nimport { getGradientOpacities } from './tokenUtils';\nimport {\n\tAssuranceResult,\n\tDEFAULT_COLOURS,\n\tDEFAULT_LETTERS,\n} from \"./SPCConstants\";\n\nexport interface AssuranceIconProps {\n\tstatus: AssuranceResult;\n\tsize?: number; // px\n\tariaLabel?: string; // override accessible label\n\tdropShadow?: boolean;\n\t/** When true apply a diagonal colour wash instead of solid white interior */\n\tgradientWash?: boolean;\n\tcolourOverride?: string; // optional single colour override for ring, letter & accent path\n\tletterOverride?: string; // optional override for displayed letter\n\tshowTrendLines?: boolean; // allow hiding decorative lines if needed\n\t\"data-testid\"?: string;\n}\n\nexport const SPCAssuranceIcon = ({\n\tstatus,\n\tsize = 44,\n\tariaLabel,\n\tdropShadow = true,\n\tcolourOverride,\n\tgradientWash = false,\n\tletterOverride,\n\tshowTrendLines = true,\n\t...rest\n}: AssuranceIconProps & Record<string, unknown>) => {\n\tconst shadowId = useId();\n\tconst washId = useId();\n\t// Gradient stop opacity tokens via shared util\n\tconst { start: gradStart, mid: gradMid, end: gradEnd } = getGradientOpacities();\n\tconst colour = colourOverride || DEFAULT_COLOURS[status];\n\tconst letter = (letterOverride || DEFAULT_LETTERS[status]).slice(0, 2); // safety \u2013 limit length\n\tconst aria = ariaLabel || `Assurance ${status}`;\n\n\treturn (\n\t\t<svg\n\t\t\twidth={size}\n\t\t\theight={size}\n\t\t\tviewBox=\"0 0 300 300\"\n\t\t\trole=\"img\"\n\t\t\taria-label={aria}\n\t\t\t{...rest}\n\t\t>\n\t\t\t<defs>\n\t\t\t\t{dropShadow && (\n\t\t\t\t\t<filter id={shadowId} filterUnits=\"objectBoundingBox\">\n\t\t\t\t\t\t<feGaussianBlur stdDeviation=\"3\" />\n\t\t\t\t\t\t<feOffset dx=\"-1\" dy=\"15\" result=\"blur\" />\n\t\t\t\t\t\t<feFlood floodColor=\"rgb(166,166,166)\" floodOpacity=\"1\" />\n\t\t\t\t\t\t<feComposite in2=\"blur\" operator=\"in\" result=\"colorShadow\" />\n\t\t\t\t\t\t<feComposite in=\"SourceGraphic\" in2=\"colorShadow\" operator=\"over\" />\n\t\t\t\t\t</filter>\n\t\t\t\t)}\n\t\t\t\t{gradientWash && (\n\t\t\t\t\t<linearGradient id={washId} x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n\t\t\t\t\t\t<stop offset=\"0%\" stopColor={colour} stopOpacity={parseFloat(gradStart)} />\n\t\t\t\t\t\t<stop offset=\"65%\" stopColor={colour} stopOpacity={parseFloat(gradMid)} />\n\t\t\t\t\t\t<stop offset=\"100%\" stopColor=\"#ffffff\" stopOpacity={parseFloat(gradEnd)} />\n\t\t\t\t\t</linearGradient>\n\t\t\t\t)}\n\t\t\t</defs>\n\t\t\t<circle\n\t\t\t\tstroke=\"none\"\n\t\t\t\tfill={gradientWash ? `url(#${washId})` : '#ffffff'}\n\t\t\t\t{...(dropShadow ? { filter: `url(#${shadowId})` } : {})}\n\t\t\t\tcx=\"150\"\n\t\t\t\tcy=\"150\"\n\t\t\t\tr=\"120\"\n\t\t\t/>\n\t\t\t{/* Letter */}\n\t\t\t<text\n\t\t\t\tfill={colour}\n\t\t\t\tfontFamily=\"Arial-BoldMT, Arial, 'Helvetica Neue', Helvetica, sans-serif\"\n\t\t\t\tfontWeight=\"bold\"\n\t\t\t\tfontSize={176}\n\t\t\t\tx={0}\n\t\t\t\ty={0}\n\t\t\t\ttransform=\"translate(121.01, 32) scale(0.5, 0.5)\"\n\t\t\t\ttextAnchor=\"middle\"\n\t\t\t>\n\t\t\t\t<tspan x={60} y={184}>\n\t\t\t\t\t{letter}\n\t\t\t\t</tspan>\n\t\t\t</text>\n\t\t\t{showTrendLines && (\n\t\t\t\t<>\n\t\t\t\t\t{/* Coloured baseline / target line (changes geometry if Fail) */}\n\t\t\t\t\t{status === AssuranceResult.Fail ? (\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tid=\"fail-line\"\n\t\t\t\t\t\t\tstroke={colour}\n\t\t\t\t\t\t\tstrokeWidth={9.5}\n\t\t\t\t\t\t\tstrokeMiterlimit={9.5}\n\t\t\t\t\t\t\tstrokeDasharray=\"35,10\"\n\t\t\t\t\t\t\tstrokeDashoffset={0}\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\td=\"M 33,143 L 268,143\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : status === AssuranceResult.Uncertain ? (\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tid=\"uncertain-line\"\n\t\t\t\t\t\t\tstroke=\"rgb(166, 166, 166)\"\n\t\t\t\t\t\t\tstrokeWidth={9.5}\n\t\t\t\t\t\t\tstrokeMiterlimit={9.5}\n\t\t\t\t\t\t\tstrokeDasharray=\"16.5,10\"\n\t\t\t\t\t\t\tstrokeDashoffset={0}\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\td=\"M 36,174 L 266,174\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tid=\"pass-line\"\n\t\t\t\t\t\t\tstroke={colour}\n\t\t\t\t\t\t\tstrokeWidth={9.5}\n\t\t\t\t\t\t\tstrokeMiterlimit={9.5}\n\t\t\t\t\t\t\tstrokeDasharray=\"35,10\"\n\t\t\t\t\t\t\tstrokeDashoffset={0}\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\td=\"M 48,204 L 254,204\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{/* Grey underlying squiggle / sparkline bezier */}\n\t\t\t\t\t<path\n\t\t\t\t\t\tid=\"data-sparkline\"\n\t\t\t\t\t\tstroke=\"rgb(166, 166, 166)\"\n\t\t\t\t\t\tstrokeWidth={12}\n\t\t\t\t\t\tstrokeMiterlimit={12}\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\td=\"M 59.9,187.91 C 72.79,171.72 87.33,158.06 104.4,157.83 121.91,158.58 140.94,187.85 153.4,189.91 164.1,192.12 163.78,171.38 169.17,170.53 172.87,169.55 174.88,187.45 184.94,189.24 197,191.86 230.54,184.47 239.01,185.9\"\n\t\t\t\t\t/>\n\t\t\t\t\t<circle\n\t\t\t\t\t\tstroke={colour}\n\t\t\t\t\t\tstrokeWidth={15}\n\t\t\t\t\t\tstrokeMiterlimit={10}\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tcx=\"150\"\n\t\t\t\t\t\tcy=\"150\"\n\t\t\t\t\t\tr=\"120\"\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</svg>\n\t);\n};\n\nSPCAssuranceIcon.displayName = \"SPCAssuranceIcon\";\n"],
  "mappings": "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",
  "names": ["classNames", "React", "x", "x", "key", "ticks", "range", "range", "range", "format", "r", "t1", "x", "y", "y", "y", "color", "rgb", "r", "x", "x", "zero", "i", "x", "number", "x", "x", "range", "r", "i", "y", "number", "x", "x", "x", "x", "x", "x", "locale", "sign", "zero", "format", "formatPrefix", "value", "linear", "date", "range", "date", "date", "date", "date", "date", "date", "date", "date", "ticks", "step", "date", "y", "locale", "formats", "pad", "format", "sign", "locale", "defaultLocale", "number", "ticks", "second", "format", "formatYear", "tickFormat", "date", "y", "constant_default", "x", "x", "y", "r", "x", "x", "y", "x", "y", "constant_default", "path", "constant_default", "path", "x", "point", "t0", "t1", "y", "range", "linear", "pad", "x", "y", "_a", "React", "_a", "_b", "React", "jsx", "React", "jsx", "_a", "_b", "React", "jsx", "jsxs", "ticks", "y", "_a", "jsx", "jsxs", "ticks", "React", "path", "hex", "x", "r", "y", "rgb", "_a", "_b", "path", "map", "hex", "copy", "React", "jsx", "React", "jsx", "xScale", "yScale", "d", "jsx", "jsxs", "_a", "path", "color", "React", "jsx", "format", "x", "y", "jsx", "jsxs", "jsx", "jsxs", "pad", "_a", "useState", "useCallback", "useRef", "jsx", "jsxs", "useState", "_a", "useRef", "useCallback", "classNames", "React", "jsx", "forwardRef", "useCallback", "useState", "React", "id", "style", "title", "ariaLabel", "ariaDescribedBy", "ariaLabelledBy", "tabIndex", "_a", "import_classnames", "import_classnames", "import_classnames", "jsx", "size", "classNames", "jsx", "jsxs", "classNames", "jsx", "jsxs", "classNames", "jsx", "jsxs", "point", "r", "_a", "React", "jsx", "jsxs", "wasHidden", "item", "label", "msg", "React", "jsx", "jsxs", "React", "jsx", "jsxs", "_a", "color", "gen", "React", "jsx", "jsxs", "_a", "_b", "explicit", "y", "barWidth", "React", "jsx", "_a", "_b", "linear", "React", "jsx", "jsxs", "React", "jsx", "React", "Fragment", "jsx", "jsxs", "unit", "isNumber", "React", "React", "y", "_a", "_b", "r", "becameTrue", "mean", "_a", "_b", "import_classnames", "jsx", "jsxs", "color", "classNames", "jsx", "jsxs", "_a", "_b", "r", "unit", "useId", "useMemo", "hex", "r", "Fragment", "jsx", "jsxs", "pickTextColour", "hex", "r", "VARIATION_COLOURS", "_a", "_b", "state", "direction", "map", "useId", "useMemo", "useId", "Fragment", "jsx", "jsxs", "useId", "Fragment", "jsx", "jsxs", "unit", "_a", "_b", "_c", "r", "mean", "map", "x", "y", "ordinal", "plotWidth"]
}
