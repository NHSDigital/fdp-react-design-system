{
  "version": 3,
  "sources": ["../../../../node_modules/classnames/index.js", "../../../../node_modules/prismjs/prism.js", "../../../../node_modules/prismjs/components/prism-typescript.js", "../../../../node_modules/prismjs/components/prism-tsx.js", "../../../../node_modules/prismjs/components/prism-json.js", "../../../../packages/nhs-fdp/dist/js/tokens.json", "../../../../src/components/DataVisualisation/charts/ChartContainer.tsx", "../../../../node_modules/clsx/dist/clsx.mjs", "../../../../src/components/DataVisualisation/charts/LineChart/LineChart.tsx", "../../../../node_modules/d3-array/src/ascending.js", "../../../../node_modules/d3-array/src/descending.js", "../../../../node_modules/d3-array/src/bisector.js", "../../../../node_modules/d3-array/src/number.js", "../../../../node_modules/d3-array/src/bisect.js", "../../../../node_modules/d3-array/src/extent.js", "../../../../node_modules/internmap/src/index.js", "../../../../node_modules/d3-array/src/ticks.js", "../../../../node_modules/d3-array/src/range.js", "../../../../node_modules/d3-scale/src/init.js", "../../../../node_modules/d3-scale/src/ordinal.js", "../../../../node_modules/d3-scale/src/band.js", "../../../../node_modules/d3-color/src/define.js", "../../../../node_modules/d3-color/src/color.js", "../../../../node_modules/d3-interpolate/src/basis.js", "../../../../node_modules/d3-interpolate/src/basisClosed.js", "../../../../node_modules/d3-interpolate/src/constant.js", "../../../../node_modules/d3-interpolate/src/color.js", "../../../../node_modules/d3-interpolate/src/rgb.js", "../../../../node_modules/d3-interpolate/src/numberArray.js", "../../../../node_modules/d3-interpolate/src/array.js", "../../../../node_modules/d3-interpolate/src/date.js", "../../../../node_modules/d3-interpolate/src/number.js", "../../../../node_modules/d3-interpolate/src/object.js", "../../../../node_modules/d3-interpolate/src/string.js", "../../../../node_modules/d3-interpolate/src/value.js", "../../../../node_modules/d3-interpolate/src/round.js", "../../../../node_modules/d3-scale/src/constant.js", "../../../../node_modules/d3-scale/src/number.js", "../../../../node_modules/d3-scale/src/continuous.js", "../../../../node_modules/d3-format/src/formatDecimal.js", "../../../../node_modules/d3-format/src/exponent.js", "../../../../node_modules/d3-format/src/formatGroup.js", "../../../../node_modules/d3-format/src/formatNumerals.js", "../../../../node_modules/d3-format/src/formatSpecifier.js", "../../../../node_modules/d3-format/src/formatTrim.js", "../../../../node_modules/d3-format/src/formatPrefixAuto.js", "../../../../node_modules/d3-format/src/formatRounded.js", "../../../../node_modules/d3-format/src/formatTypes.js", "../../../../node_modules/d3-format/src/identity.js", "../../../../node_modules/d3-format/src/locale.js", "../../../../node_modules/d3-format/src/defaultLocale.js", "../../../../node_modules/d3-format/src/precisionFixed.js", "../../../../node_modules/d3-format/src/precisionPrefix.js", "../../../../node_modules/d3-format/src/precisionRound.js", "../../../../node_modules/d3-scale/src/tickFormat.js", "../../../../node_modules/d3-scale/src/linear.js", "../../../../node_modules/d3-scale/src/nice.js", "../../../../node_modules/d3-time/src/interval.js", "../../../../node_modules/d3-time/src/millisecond.js", "../../../../node_modules/d3-time/src/duration.js", "../../../../node_modules/d3-time/src/second.js", "../../../../node_modules/d3-time/src/minute.js", "../../../../node_modules/d3-time/src/hour.js", "../../../../node_modules/d3-time/src/day.js", "../../../../node_modules/d3-time/src/week.js", "../../../../node_modules/d3-time/src/month.js", "../../../../node_modules/d3-time/src/year.js", "../../../../node_modules/d3-time/src/ticks.js", "../../../../node_modules/d3-time-format/src/locale.js", "../../../../node_modules/d3-time-format/src/defaultLocale.js", "../../../../node_modules/d3-scale/src/time.js", "../../../../node_modules/d3-shape/src/constant.js", "../../../../node_modules/d3-path/src/path.js", "../../../../node_modules/d3-shape/src/path.js", "../../../../node_modules/d3-shape/src/array.js", "../../../../node_modules/d3-shape/src/curve/linear.js", "../../../../node_modules/d3-shape/src/point.js", "../../../../node_modules/d3-shape/src/line.js", "../../../../node_modules/d3-shape/src/area.js", "../../../../node_modules/d3-shape/src/curve/monotone.js", "../../../../src/components/DataVisualisation/utils/scales.ts", "../../../../src/components/DataVisualisation/hooks/useChartDimensions.ts", "../../../../src/components/DataVisualisation/core/ChartRoot.tsx", "../../../../src/components/DataVisualisation/core/ScaleContext.tsx", "../../../../src/components/DataVisualisation/charts/Axis/Axis.tsx", "../../../../src/components/DataVisualisation/charts/GridlLines/GridLines.tsx", "../../../../src/components/DataVisualisation/series/LineSeriesPrimitive.tsx", "../../../../packages/nhs-fdp/tokens/data-viz.json", "../../../../packages/nhs-fdp/tokens/colors.json", "../../../../src/components/DataVisualisation/utils/colors.ts", "../../../../src/components/DataVisualisation/core/VisibilityContext.tsx", "../../../../src/components/DataVisualisation/core/TooltipContext.tsx", "../../../../src/components/DataVisualisation/primitives/VisuallyHiddenLiveRegion.tsx", "../../../../src/components/DataVisualisation/primitives/TooltipOverlay.tsx", "../../../../src/components/Tabs/Tabs.tsx", "../../../../src/components/Button/Button.tsx", "../../../../src/mapping/button.ts", "../../../../src/components/Tables/Table.tsx", "../../../../src/components/Panel/Panel.tsx", "../../../../src/components/Heading/Heading.tsx", "../../../../src/mapping/heading.ts", "../../../../src/components/DataVisualisation/charts/ChartWithTableTabs/ChartWithTableTabs.tsx", "../../../../src/components/DataVisualisation/charts/Legend/Legend.tsx", "../../../../src/components/DataVisualisation/FilterableLineChart.tsx", "../../../../src/components/DataVisualisation/series/AreaSeriesPrimitive.tsx", "../../../../src/components/DataVisualisation/series/BarSeriesPrimitive.tsx", "../../../../src/components/DataVisualisation/core/BandScalesProvider.tsx", "../../../../src/components/DataVisualisation/primitives/AlertThreshold.tsx", "../../../../src/components/DataVisualisation/primitives/AlertBand.tsx", "../../../../src/components/DataVisualisation/primitives/AlertMarkers.tsx", "../../../../src/components/DataVisualisation/charts/ChartNoScript/ChartNoScript.tsx", "../../../../src/components/DataVisualisation/charts/ChartEnhancer/ChartEnhancer.tsx", "../../../../src/components/DataVisualisation/components/MetricCard/MetricCard.tsx", "../../../../src/components/DataVisualisation/wizard/DataVizWizard.tsx", "../../../../src/mapping/tag.ts", "../../../../src/components/Tag/Tag.tsx", "../../../../src/components/Checkboxes/Checkboxes.tsx", "../../../../src/components/Input/Input.tsx", "../../../../src/mapping/input.ts", "../../../../src/mapping/label.ts", "../../../../src/components/Label/Label.tsx", "../../../../src/mapping/fieldset.ts", "../../../../src/components/Fieldset/Fieldset.tsx", "../../../../src/mapping/checkboxes.ts", "../../../../src/components/Radios/Radios.tsx", "../../../../src/components/Radios/Radios.render.tsx", "../../../../src/mapping/radios.ts", "../../../../src/components/Grid/Grid.tsx", "../../../../src/components/InsetText/InsetText.tsx", "../../../../src/components/SummaryList/SummaryList.tsx", "../../../../src/components/DataVisualisation/wizard/WizardProgress.tsx", "../../../../src/components/DataVisualisation/wizard/ReviewAnswers.tsx", "../../../../src/components/DataVisualisation/logic/wizardEngine.ts", "../../../../src/components/DataVisualisation/charts/SPC/SPCChart/SPCChart.tsx", "../../../../src/components/DataVisualisation/charts/SPC/SPCChart/SPCTooltipOverlay.tsx", "../../../../src/components/DataVisualisation/charts/SPC/SPCChart/logic/spcConstants.ts", "../../../../src/components/DataVisualisation/charts/SPC/SPCChart/logic/spcDescriptors.ts", "../../../../src/components/DataVisualisation/charts/SPC/SPCIcons/SPCIcon.tsx", "../../../../src/components/DataVisualisation/charts/SPC/SPCIcons/tokenUtils.ts", "../../../../src/components/DataVisualisation/charts/SPC/SPCIcons/SPCConstants.ts", "../../../../src/components/DataVisualisation/charts/SPC/SPCChart/SPCChart.constants.ts", "../../../../src/components/DataVisualisation/charts/SPC/SPCIcons/SPCAssuranceIcon.tsx", "../../../../src/components/DataVisualisation/charts/SPC/SPCChart/logic/spcUtils.ts", "../../../../src/components/DataVisualisation/charts/SPC/SPCChart/logic/spcAssurance.ts", "../../../../src/components/DataVisualisation/charts/SPC/SPCChart/logic/spcCandidates.ts", "../../../../src/components/DataVisualisation/charts/SPC/SPCChart/logic/spc.ts", "../../../../src/components/DataVisualisation/charts/SPC/SPCChart/logic/spcSqlCompat.ts", "../../../../src/components/DataVisualisation/charts/SPC/SPCChart/SPCSignalsInspector.tsx", "../../../../src/components/DataVisualisation/charts/SPC/index.ts", "../../../../src/components/DataVisualisation/charts/SPC/icons.ts"],
  "sourcesContent": ["/*!\n\tCopyright (c) 2018 Jed Watson.\n\tLicensed under the MIT License (MIT), see\n\thttp://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = '';\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (arg) {\n\t\t\t\tclasses = appendClass(classes, parseValue(arg));\n\t\t\t}\n\t\t}\n\n\t\treturn classes;\n\t}\n\n\tfunction parseValue (arg) {\n\t\tif (typeof arg === 'string' || typeof arg === 'number') {\n\t\t\treturn arg;\n\t\t}\n\n\t\tif (typeof arg !== 'object') {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (Array.isArray(arg)) {\n\t\t\treturn classNames.apply(null, arg);\n\t\t}\n\n\t\tif (arg.toString !== Object.prototype.toString && !arg.toString.toString().includes('[native code]')) {\n\t\t\treturn arg.toString();\n\t\t}\n\n\t\tvar classes = '';\n\n\t\tfor (var key in arg) {\n\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\tclasses = appendClass(classes, key);\n\t\t\t}\n\t\t}\n\n\t\treturn classes;\n\t}\n\n\tfunction appendClass (value, newClass) {\n\t\tif (!newClass) {\n\t\t\treturn value;\n\t\t}\n\t\n\t\tif (value) {\n\t\t\treturn value + ' ' + newClass;\n\t\t}\n\t\n\t\treturn value + newClass;\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n", "\n/* **********************************************\n     Begin prism-core.js\n********************************************** */\n\n/// <reference lib=\"WebWorker\"/>\n\nvar _self = (typeof window !== 'undefined')\n\t? window   // if in browser\n\t: (\n\t\t(typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope)\n\t\t\t? self // if in worker\n\t\t\t: {}   // if in node js\n\t);\n\n/**\n * Prism: Lightweight, robust, elegant syntax highlighting\n *\n * @license MIT <https://opensource.org/licenses/MIT>\n * @author Lea Verou <https://lea.verou.me>\n * @namespace\n * @public\n */\nvar Prism = (function (_self) {\n\n\t// Private helper vars\n\tvar lang = /(?:^|\\s)lang(?:uage)?-([\\w-]+)(?=\\s|$)/i;\n\tvar uniqueId = 0;\n\n\t// The grammar object for plaintext\n\tvar plainTextGrammar = {};\n\n\n\tvar _ = {\n\t\t/**\n\t\t * By default, Prism will attempt to highlight all code elements (by calling {@link Prism.highlightAll}) on the\n\t\t * current page after the page finished loading. This might be a problem if e.g. you wanted to asynchronously load\n\t\t * additional languages or plugins yourself.\n\t\t *\n\t\t * By setting this value to `true`, Prism will not automatically highlight all code elements on the page.\n\t\t *\n\t\t * You obviously have to change this value before the automatic highlighting started. To do this, you can add an\n\t\t * empty Prism object into the global scope before loading the Prism script like this:\n\t\t *\n\t\t * ```js\n\t\t * window.Prism = window.Prism || {};\n\t\t * Prism.manual = true;\n\t\t * // add a new <script> to load Prism's script\n\t\t * ```\n\t\t *\n\t\t * @default false\n\t\t * @type {boolean}\n\t\t * @memberof Prism\n\t\t * @public\n\t\t */\n\t\tmanual: _self.Prism && _self.Prism.manual,\n\t\t/**\n\t\t * By default, if Prism is in a web worker, it assumes that it is in a worker it created itself, so it uses\n\t\t * `addEventListener` to communicate with its parent instance. However, if you're using Prism manually in your\n\t\t * own worker, you don't want it to do this.\n\t\t *\n\t\t * By setting this value to `true`, Prism will not add its own listeners to the worker.\n\t\t *\n\t\t * You obviously have to change this value before Prism executes. To do this, you can add an\n\t\t * empty Prism object into the global scope before loading the Prism script like this:\n\t\t *\n\t\t * ```js\n\t\t * window.Prism = window.Prism || {};\n\t\t * Prism.disableWorkerMessageHandler = true;\n\t\t * // Load Prism's script\n\t\t * ```\n\t\t *\n\t\t * @default false\n\t\t * @type {boolean}\n\t\t * @memberof Prism\n\t\t * @public\n\t\t */\n\t\tdisableWorkerMessageHandler: _self.Prism && _self.Prism.disableWorkerMessageHandler,\n\n\t\t/**\n\t\t * A namespace for utility methods.\n\t\t *\n\t\t * All function in this namespace that are not explicitly marked as _public_ are for __internal use only__ and may\n\t\t * change or disappear at any time.\n\t\t *\n\t\t * @namespace\n\t\t * @memberof Prism\n\t\t */\n\t\tutil: {\n\t\t\tencode: function encode(tokens) {\n\t\t\t\tif (tokens instanceof Token) {\n\t\t\t\t\treturn new Token(tokens.type, encode(tokens.content), tokens.alias);\n\t\t\t\t} else if (Array.isArray(tokens)) {\n\t\t\t\t\treturn tokens.map(encode);\n\t\t\t\t} else {\n\t\t\t\t\treturn tokens.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/\\u00a0/g, ' ');\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Returns the name of the type of the given value.\n\t\t\t *\n\t\t\t * @param {any} o\n\t\t\t * @returns {string}\n\t\t\t * @example\n\t\t\t * type(null)      === 'Null'\n\t\t\t * type(undefined) === 'Undefined'\n\t\t\t * type(123)       === 'Number'\n\t\t\t * type('foo')     === 'String'\n\t\t\t * type(true)      === 'Boolean'\n\t\t\t * type([1, 2])    === 'Array'\n\t\t\t * type({})        === 'Object'\n\t\t\t * type(String)    === 'Function'\n\t\t\t * type(/abc+/)    === 'RegExp'\n\t\t\t */\n\t\t\ttype: function (o) {\n\t\t\t\treturn Object.prototype.toString.call(o).slice(8, -1);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Returns a unique number for the given object. Later calls will still return the same number.\n\t\t\t *\n\t\t\t * @param {Object} obj\n\t\t\t * @returns {number}\n\t\t\t */\n\t\t\tobjId: function (obj) {\n\t\t\t\tif (!obj['__id']) {\n\t\t\t\t\tObject.defineProperty(obj, '__id', { value: ++uniqueId });\n\t\t\t\t}\n\t\t\t\treturn obj['__id'];\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Creates a deep clone of the given object.\n\t\t\t *\n\t\t\t * The main intended use of this function is to clone language definitions.\n\t\t\t *\n\t\t\t * @param {T} o\n\t\t\t * @param {Record<number, any>} [visited]\n\t\t\t * @returns {T}\n\t\t\t * @template T\n\t\t\t */\n\t\t\tclone: function deepClone(o, visited) {\n\t\t\t\tvisited = visited || {};\n\n\t\t\t\tvar clone; var id;\n\t\t\t\tswitch (_.util.type(o)) {\n\t\t\t\t\tcase 'Object':\n\t\t\t\t\t\tid = _.util.objId(o);\n\t\t\t\t\t\tif (visited[id]) {\n\t\t\t\t\t\t\treturn visited[id];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tclone = /** @type {Record<string, any>} */ ({});\n\t\t\t\t\t\tvisited[id] = clone;\n\n\t\t\t\t\t\tfor (var key in o) {\n\t\t\t\t\t\t\tif (o.hasOwnProperty(key)) {\n\t\t\t\t\t\t\t\tclone[key] = deepClone(o[key], visited);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn /** @type {any} */ (clone);\n\n\t\t\t\t\tcase 'Array':\n\t\t\t\t\t\tid = _.util.objId(o);\n\t\t\t\t\t\tif (visited[id]) {\n\t\t\t\t\t\t\treturn visited[id];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tclone = [];\n\t\t\t\t\t\tvisited[id] = clone;\n\n\t\t\t\t\t\t(/** @type {Array} */(/** @type {any} */(o))).forEach(function (v, i) {\n\t\t\t\t\t\t\tclone[i] = deepClone(v, visited);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn /** @type {any} */ (clone);\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn o;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Returns the Prism language of the given element set by a `language-xxxx` or `lang-xxxx` class.\n\t\t\t *\n\t\t\t * If no language is set for the element or the element is `null` or `undefined`, `none` will be returned.\n\t\t\t *\n\t\t\t * @param {Element} element\n\t\t\t * @returns {string}\n\t\t\t */\n\t\t\tgetLanguage: function (element) {\n\t\t\t\twhile (element) {\n\t\t\t\t\tvar m = lang.exec(element.className);\n\t\t\t\t\tif (m) {\n\t\t\t\t\t\treturn m[1].toLowerCase();\n\t\t\t\t\t}\n\t\t\t\t\telement = element.parentElement;\n\t\t\t\t}\n\t\t\t\treturn 'none';\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Sets the Prism `language-xxxx` class of the given element.\n\t\t\t *\n\t\t\t * @param {Element} element\n\t\t\t * @param {string} language\n\t\t\t * @returns {void}\n\t\t\t */\n\t\t\tsetLanguage: function (element, language) {\n\t\t\t\t// remove all `language-xxxx` classes\n\t\t\t\t// (this might leave behind a leading space)\n\t\t\t\telement.className = element.className.replace(RegExp(lang, 'gi'), '');\n\n\t\t\t\t// add the new `language-xxxx` class\n\t\t\t\t// (using `classList` will automatically clean up spaces for us)\n\t\t\t\telement.classList.add('language-' + language);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Returns the script element that is currently executing.\n\t\t\t *\n\t\t\t * This does __not__ work for line script element.\n\t\t\t *\n\t\t\t * @returns {HTMLScriptElement | null}\n\t\t\t */\n\t\t\tcurrentScript: function () {\n\t\t\t\tif (typeof document === 'undefined') {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tif ('currentScript' in document && 1 < 2 /* hack to trip TS' flow analysis */) {\n\t\t\t\t\treturn /** @type {any} */ (document.currentScript);\n\t\t\t\t}\n\n\t\t\t\t// IE11 workaround\n\t\t\t\t// we'll get the src of the current script by parsing IE11's error stack trace\n\t\t\t\t// this will not work for inline scripts\n\n\t\t\t\ttry {\n\t\t\t\t\tthrow new Error();\n\t\t\t\t} catch (err) {\n\t\t\t\t\t// Get file src url from stack. Specifically works with the format of stack traces in IE.\n\t\t\t\t\t// A stack will look like this:\n\t\t\t\t\t//\n\t\t\t\t\t// Error\n\t\t\t\t\t//    at _.util.currentScript (http://localhost/components/prism-core.js:119:5)\n\t\t\t\t\t//    at Global code (http://localhost/components/prism-core.js:606:1)\n\n\t\t\t\t\tvar src = (/at [^(\\r\\n]*\\((.*):[^:]+:[^:]+\\)$/i.exec(err.stack) || [])[1];\n\t\t\t\t\tif (src) {\n\t\t\t\t\t\tvar scripts = document.getElementsByTagName('script');\n\t\t\t\t\t\tfor (var i in scripts) {\n\t\t\t\t\t\t\tif (scripts[i].src == src) {\n\t\t\t\t\t\t\t\treturn scripts[i];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Returns whether a given class is active for `element`.\n\t\t\t *\n\t\t\t * The class can be activated if `element` or one of its ancestors has the given class and it can be deactivated\n\t\t\t * if `element` or one of its ancestors has the negated version of the given class. The _negated version_ of the\n\t\t\t * given class is just the given class with a `no-` prefix.\n\t\t\t *\n\t\t\t * Whether the class is active is determined by the closest ancestor of `element` (where `element` itself is\n\t\t\t * closest ancestor) that has the given class or the negated version of it. If neither `element` nor any of its\n\t\t\t * ancestors have the given class or the negated version of it, then the default activation will be returned.\n\t\t\t *\n\t\t\t * In the paradoxical situation where the closest ancestor contains __both__ the given class and the negated\n\t\t\t * version of it, the class is considered active.\n\t\t\t *\n\t\t\t * @param {Element} element\n\t\t\t * @param {string} className\n\t\t\t * @param {boolean} [defaultActivation=false]\n\t\t\t * @returns {boolean}\n\t\t\t */\n\t\t\tisActive: function (element, className, defaultActivation) {\n\t\t\t\tvar no = 'no-' + className;\n\n\t\t\t\twhile (element) {\n\t\t\t\t\tvar classList = element.classList;\n\t\t\t\t\tif (classList.contains(className)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tif (classList.contains(no)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\telement = element.parentElement;\n\t\t\t\t}\n\t\t\t\treturn !!defaultActivation;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * This namespace contains all currently loaded languages and the some helper functions to create and modify languages.\n\t\t *\n\t\t * @namespace\n\t\t * @memberof Prism\n\t\t * @public\n\t\t */\n\t\tlanguages: {\n\t\t\t/**\n\t\t\t * The grammar for plain, unformatted text.\n\t\t\t */\n\t\t\tplain: plainTextGrammar,\n\t\t\tplaintext: plainTextGrammar,\n\t\t\ttext: plainTextGrammar,\n\t\t\ttxt: plainTextGrammar,\n\n\t\t\t/**\n\t\t\t * Creates a deep copy of the language with the given id and appends the given tokens.\n\t\t\t *\n\t\t\t * If a token in `redef` also appears in the copied language, then the existing token in the copied language\n\t\t\t * will be overwritten at its original position.\n\t\t\t *\n\t\t\t * ## Best practices\n\t\t\t *\n\t\t\t * Since the position of overwriting tokens (token in `redef` that overwrite tokens in the copied language)\n\t\t\t * doesn't matter, they can technically be in any order. However, this can be confusing to others that trying to\n\t\t\t * understand the language definition because, normally, the order of tokens matters in Prism grammars.\n\t\t\t *\n\t\t\t * Therefore, it is encouraged to order overwriting tokens according to the positions of the overwritten tokens.\n\t\t\t * Furthermore, all non-overwriting tokens should be placed after the overwriting ones.\n\t\t\t *\n\t\t\t * @param {string} id The id of the language to extend. This has to be a key in `Prism.languages`.\n\t\t\t * @param {Grammar} redef The new tokens to append.\n\t\t\t * @returns {Grammar} The new language created.\n\t\t\t * @public\n\t\t\t * @example\n\t\t\t * Prism.languages['css-with-colors'] = Prism.languages.extend('css', {\n\t\t\t *     // Prism.languages.css already has a 'comment' token, so this token will overwrite CSS' 'comment' token\n\t\t\t *     // at its original position\n\t\t\t *     'comment': { ... },\n\t\t\t *     // CSS doesn't have a 'color' token, so this token will be appended\n\t\t\t *     'color': /\\b(?:red|green|blue)\\b/\n\t\t\t * });\n\t\t\t */\n\t\t\textend: function (id, redef) {\n\t\t\t\tvar lang = _.util.clone(_.languages[id]);\n\n\t\t\t\tfor (var key in redef) {\n\t\t\t\t\tlang[key] = redef[key];\n\t\t\t\t}\n\n\t\t\t\treturn lang;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Inserts tokens _before_ another token in a language definition or any other grammar.\n\t\t\t *\n\t\t\t * ## Usage\n\t\t\t *\n\t\t\t * This helper method makes it easy to modify existing languages. For example, the CSS language definition\n\t\t\t * not only defines CSS highlighting for CSS documents, but also needs to define highlighting for CSS embedded\n\t\t\t * in HTML through `<style>` elements. To do this, it needs to modify `Prism.languages.markup` and add the\n\t\t\t * appropriate tokens. However, `Prism.languages.markup` is a regular JavaScript object literal, so if you do\n\t\t\t * this:\n\t\t\t *\n\t\t\t * ```js\n\t\t\t * Prism.languages.markup.style = {\n\t\t\t *     // token\n\t\t\t * };\n\t\t\t * ```\n\t\t\t *\n\t\t\t * then the `style` token will be added (and processed) at the end. `insertBefore` allows you to insert tokens\n\t\t\t * before existing tokens. For the CSS example above, you would use it like this:\n\t\t\t *\n\t\t\t * ```js\n\t\t\t * Prism.languages.insertBefore('markup', 'cdata', {\n\t\t\t *     'style': {\n\t\t\t *         // token\n\t\t\t *     }\n\t\t\t * });\n\t\t\t * ```\n\t\t\t *\n\t\t\t * ## Special cases\n\t\t\t *\n\t\t\t * If the grammars of `inside` and `insert` have tokens with the same name, the tokens in `inside`'s grammar\n\t\t\t * will be ignored.\n\t\t\t *\n\t\t\t * This behavior can be used to insert tokens after `before`:\n\t\t\t *\n\t\t\t * ```js\n\t\t\t * Prism.languages.insertBefore('markup', 'comment', {\n\t\t\t *     'comment': Prism.languages.markup.comment,\n\t\t\t *     // tokens after 'comment'\n\t\t\t * });\n\t\t\t * ```\n\t\t\t *\n\t\t\t * ## Limitations\n\t\t\t *\n\t\t\t * The main problem `insertBefore` has to solve is iteration order. Since ES2015, the iteration order for object\n\t\t\t * properties is guaranteed to be the insertion order (except for integer keys) but some browsers behave\n\t\t\t * differently when keys are deleted and re-inserted. So `insertBefore` can't be implemented by temporarily\n\t\t\t * deleting properties which is necessary to insert at arbitrary positions.\n\t\t\t *\n\t\t\t * To solve this problem, `insertBefore` doesn't actually insert the given tokens into the target object.\n\t\t\t * Instead, it will create a new object and replace all references to the target object with the new one. This\n\t\t\t * can be done without temporarily deleting properties, so the iteration order is well-defined.\n\t\t\t *\n\t\t\t * However, only references that can be reached from `Prism.languages` or `insert` will be replaced. I.e. if\n\t\t\t * you hold the target object in a variable, then the value of the variable will not change.\n\t\t\t *\n\t\t\t * ```js\n\t\t\t * var oldMarkup = Prism.languages.markup;\n\t\t\t * var newMarkup = Prism.languages.insertBefore('markup', 'comment', { ... });\n\t\t\t *\n\t\t\t * assert(oldMarkup !== Prism.languages.markup);\n\t\t\t * assert(newMarkup === Prism.languages.markup);\n\t\t\t * ```\n\t\t\t *\n\t\t\t * @param {string} inside The property of `root` (e.g. a language id in `Prism.languages`) that contains the\n\t\t\t * object to be modified.\n\t\t\t * @param {string} before The key to insert before.\n\t\t\t * @param {Grammar} insert An object containing the key-value pairs to be inserted.\n\t\t\t * @param {Object<string, any>} [root] The object containing `inside`, i.e. the object that contains the\n\t\t\t * object to be modified.\n\t\t\t *\n\t\t\t * Defaults to `Prism.languages`.\n\t\t\t * @returns {Grammar} The new grammar object.\n\t\t\t * @public\n\t\t\t */\n\t\t\tinsertBefore: function (inside, before, insert, root) {\n\t\t\t\troot = root || /** @type {any} */ (_.languages);\n\t\t\t\tvar grammar = root[inside];\n\t\t\t\t/** @type {Grammar} */\n\t\t\t\tvar ret = {};\n\n\t\t\t\tfor (var token in grammar) {\n\t\t\t\t\tif (grammar.hasOwnProperty(token)) {\n\n\t\t\t\t\t\tif (token == before) {\n\t\t\t\t\t\t\tfor (var newToken in insert) {\n\t\t\t\t\t\t\t\tif (insert.hasOwnProperty(newToken)) {\n\t\t\t\t\t\t\t\t\tret[newToken] = insert[newToken];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Do not insert token which also occur in insert. See #1525\n\t\t\t\t\t\tif (!insert.hasOwnProperty(token)) {\n\t\t\t\t\t\t\tret[token] = grammar[token];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar old = root[inside];\n\t\t\t\troot[inside] = ret;\n\n\t\t\t\t// Update references in other language definitions\n\t\t\t\t_.languages.DFS(_.languages, function (key, value) {\n\t\t\t\t\tif (value === old && key != inside) {\n\t\t\t\t\t\tthis[key] = ret;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn ret;\n\t\t\t},\n\n\t\t\t// Traverse a language definition with Depth First Search\n\t\t\tDFS: function DFS(o, callback, type, visited) {\n\t\t\t\tvisited = visited || {};\n\n\t\t\t\tvar objId = _.util.objId;\n\n\t\t\t\tfor (var i in o) {\n\t\t\t\t\tif (o.hasOwnProperty(i)) {\n\t\t\t\t\t\tcallback.call(o, i, o[i], type || i);\n\n\t\t\t\t\t\tvar property = o[i];\n\t\t\t\t\t\tvar propertyType = _.util.type(property);\n\n\t\t\t\t\t\tif (propertyType === 'Object' && !visited[objId(property)]) {\n\t\t\t\t\t\t\tvisited[objId(property)] = true;\n\t\t\t\t\t\t\tDFS(property, callback, null, visited);\n\t\t\t\t\t\t} else if (propertyType === 'Array' && !visited[objId(property)]) {\n\t\t\t\t\t\t\tvisited[objId(property)] = true;\n\t\t\t\t\t\t\tDFS(property, callback, i, visited);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tplugins: {},\n\n\t\t/**\n\t\t * This is the most high-level function in Prism\u2019s API.\n\t\t * It fetches all the elements that have a `.language-xxxx` class and then calls {@link Prism.highlightElement} on\n\t\t * each one of them.\n\t\t *\n\t\t * This is equivalent to `Prism.highlightAllUnder(document, async, callback)`.\n\t\t *\n\t\t * @param {boolean} [async=false] Same as in {@link Prism.highlightAllUnder}.\n\t\t * @param {HighlightCallback} [callback] Same as in {@link Prism.highlightAllUnder}.\n\t\t * @memberof Prism\n\t\t * @public\n\t\t */\n\t\thighlightAll: function (async, callback) {\n\t\t\t_.highlightAllUnder(document, async, callback);\n\t\t},\n\n\t\t/**\n\t\t * Fetches all the descendants of `container` that have a `.language-xxxx` class and then calls\n\t\t * {@link Prism.highlightElement} on each one of them.\n\t\t *\n\t\t * The following hooks will be run:\n\t\t * 1. `before-highlightall`\n\t\t * 2. `before-all-elements-highlight`\n\t\t * 3. All hooks of {@link Prism.highlightElement} for each element.\n\t\t *\n\t\t * @param {ParentNode} container The root element, whose descendants that have a `.language-xxxx` class will be highlighted.\n\t\t * @param {boolean} [async=false] Whether each element is to be highlighted asynchronously using Web Workers.\n\t\t * @param {HighlightCallback} [callback] An optional callback to be invoked on each element after its highlighting is done.\n\t\t * @memberof Prism\n\t\t * @public\n\t\t */\n\t\thighlightAllUnder: function (container, async, callback) {\n\t\t\tvar env = {\n\t\t\t\tcallback: callback,\n\t\t\t\tcontainer: container,\n\t\t\t\tselector: 'code[class*=\"language-\"], [class*=\"language-\"] code, code[class*=\"lang-\"], [class*=\"lang-\"] code'\n\t\t\t};\n\n\t\t\t_.hooks.run('before-highlightall', env);\n\n\t\t\tenv.elements = Array.prototype.slice.apply(env.container.querySelectorAll(env.selector));\n\n\t\t\t_.hooks.run('before-all-elements-highlight', env);\n\n\t\t\tfor (var i = 0, element; (element = env.elements[i++]);) {\n\t\t\t\t_.highlightElement(element, async === true, env.callback);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Highlights the code inside a single element.\n\t\t *\n\t\t * The following hooks will be run:\n\t\t * 1. `before-sanity-check`\n\t\t * 2. `before-highlight`\n\t\t * 3. All hooks of {@link Prism.highlight}. These hooks will be run by an asynchronous worker if `async` is `true`.\n\t\t * 4. `before-insert`\n\t\t * 5. `after-highlight`\n\t\t * 6. `complete`\n\t\t *\n\t\t * Some the above hooks will be skipped if the element doesn't contain any text or there is no grammar loaded for\n\t\t * the element's language.\n\t\t *\n\t\t * @param {Element} element The element containing the code.\n\t\t * It must have a class of `language-xxxx` to be processed, where `xxxx` is a valid language identifier.\n\t\t * @param {boolean} [async=false] Whether the element is to be highlighted asynchronously using Web Workers\n\t\t * to improve performance and avoid blocking the UI when highlighting very large chunks of code. This option is\n\t\t * [disabled by default](https://prismjs.com/faq.html#why-is-asynchronous-highlighting-disabled-by-default).\n\t\t *\n\t\t * Note: All language definitions required to highlight the code must be included in the main `prism.js` file for\n\t\t * asynchronous highlighting to work. You can build your own bundle on the\n\t\t * [Download page](https://prismjs.com/download.html).\n\t\t * @param {HighlightCallback} [callback] An optional callback to be invoked after the highlighting is done.\n\t\t * Mostly useful when `async` is `true`, since in that case, the highlighting is done asynchronously.\n\t\t * @memberof Prism\n\t\t * @public\n\t\t */\n\t\thighlightElement: function (element, async, callback) {\n\t\t\t// Find language\n\t\t\tvar language = _.util.getLanguage(element);\n\t\t\tvar grammar = _.languages[language];\n\n\t\t\t// Set language on the element, if not present\n\t\t\t_.util.setLanguage(element, language);\n\n\t\t\t// Set language on the parent, for styling\n\t\t\tvar parent = element.parentElement;\n\t\t\tif (parent && parent.nodeName.toLowerCase() === 'pre') {\n\t\t\t\t_.util.setLanguage(parent, language);\n\t\t\t}\n\n\t\t\tvar code = element.textContent;\n\n\t\t\tvar env = {\n\t\t\t\telement: element,\n\t\t\t\tlanguage: language,\n\t\t\t\tgrammar: grammar,\n\t\t\t\tcode: code\n\t\t\t};\n\n\t\t\tfunction insertHighlightedCode(highlightedCode) {\n\t\t\t\tenv.highlightedCode = highlightedCode;\n\n\t\t\t\t_.hooks.run('before-insert', env);\n\n\t\t\t\tenv.element.innerHTML = env.highlightedCode;\n\n\t\t\t\t_.hooks.run('after-highlight', env);\n\t\t\t\t_.hooks.run('complete', env);\n\t\t\t\tcallback && callback.call(env.element);\n\t\t\t}\n\n\t\t\t_.hooks.run('before-sanity-check', env);\n\n\t\t\t// plugins may change/add the parent/element\n\t\t\tparent = env.element.parentElement;\n\t\t\tif (parent && parent.nodeName.toLowerCase() === 'pre' && !parent.hasAttribute('tabindex')) {\n\t\t\t\tparent.setAttribute('tabindex', '0');\n\t\t\t}\n\n\t\t\tif (!env.code) {\n\t\t\t\t_.hooks.run('complete', env);\n\t\t\t\tcallback && callback.call(env.element);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t_.hooks.run('before-highlight', env);\n\n\t\t\tif (!env.grammar) {\n\t\t\t\tinsertHighlightedCode(_.util.encode(env.code));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (async && _self.Worker) {\n\t\t\t\tvar worker = new Worker(_.filename);\n\n\t\t\t\tworker.onmessage = function (evt) {\n\t\t\t\t\tinsertHighlightedCode(evt.data);\n\t\t\t\t};\n\n\t\t\t\tworker.postMessage(JSON.stringify({\n\t\t\t\t\tlanguage: env.language,\n\t\t\t\t\tcode: env.code,\n\t\t\t\t\timmediateClose: true\n\t\t\t\t}));\n\t\t\t} else {\n\t\t\t\tinsertHighlightedCode(_.highlight(env.code, env.grammar, env.language));\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Low-level function, only use if you know what you\u2019re doing. It accepts a string of text as input\n\t\t * and the language definitions to use, and returns a string with the HTML produced.\n\t\t *\n\t\t * The following hooks will be run:\n\t\t * 1. `before-tokenize`\n\t\t * 2. `after-tokenize`\n\t\t * 3. `wrap`: On each {@link Token}.\n\t\t *\n\t\t * @param {string} text A string with the code to be highlighted.\n\t\t * @param {Grammar} grammar An object containing the tokens to use.\n\t\t *\n\t\t * Usually a language definition like `Prism.languages.markup`.\n\t\t * @param {string} language The name of the language definition passed to `grammar`.\n\t\t * @returns {string} The highlighted HTML.\n\t\t * @memberof Prism\n\t\t * @public\n\t\t * @example\n\t\t * Prism.highlight('var foo = true;', Prism.languages.javascript, 'javascript');\n\t\t */\n\t\thighlight: function (text, grammar, language) {\n\t\t\tvar env = {\n\t\t\t\tcode: text,\n\t\t\t\tgrammar: grammar,\n\t\t\t\tlanguage: language\n\t\t\t};\n\t\t\t_.hooks.run('before-tokenize', env);\n\t\t\tif (!env.grammar) {\n\t\t\t\tthrow new Error('The language \"' + env.language + '\" has no grammar.');\n\t\t\t}\n\t\t\tenv.tokens = _.tokenize(env.code, env.grammar);\n\t\t\t_.hooks.run('after-tokenize', env);\n\t\t\treturn Token.stringify(_.util.encode(env.tokens), env.language);\n\t\t},\n\n\t\t/**\n\t\t * This is the heart of Prism, and the most low-level function you can use. It accepts a string of text as input\n\t\t * and the language definitions to use, and returns an array with the tokenized code.\n\t\t *\n\t\t * When the language definition includes nested tokens, the function is called recursively on each of these tokens.\n\t\t *\n\t\t * This method could be useful in other contexts as well, as a very crude parser.\n\t\t *\n\t\t * @param {string} text A string with the code to be highlighted.\n\t\t * @param {Grammar} grammar An object containing the tokens to use.\n\t\t *\n\t\t * Usually a language definition like `Prism.languages.markup`.\n\t\t * @returns {TokenStream} An array of strings and tokens, a token stream.\n\t\t * @memberof Prism\n\t\t * @public\n\t\t * @example\n\t\t * let code = `var foo = 0;`;\n\t\t * let tokens = Prism.tokenize(code, Prism.languages.javascript);\n\t\t * tokens.forEach(token => {\n\t\t *     if (token instanceof Prism.Token && token.type === 'number') {\n\t\t *         console.log(`Found numeric literal: ${token.content}`);\n\t\t *     }\n\t\t * });\n\t\t */\n\t\ttokenize: function (text, grammar) {\n\t\t\tvar rest = grammar.rest;\n\t\t\tif (rest) {\n\t\t\t\tfor (var token in rest) {\n\t\t\t\t\tgrammar[token] = rest[token];\n\t\t\t\t}\n\n\t\t\t\tdelete grammar.rest;\n\t\t\t}\n\n\t\t\tvar tokenList = new LinkedList();\n\t\t\taddAfter(tokenList, tokenList.head, text);\n\n\t\t\tmatchGrammar(text, tokenList, grammar, tokenList.head, 0);\n\n\t\t\treturn toArray(tokenList);\n\t\t},\n\n\t\t/**\n\t\t * @namespace\n\t\t * @memberof Prism\n\t\t * @public\n\t\t */\n\t\thooks: {\n\t\t\tall: {},\n\n\t\t\t/**\n\t\t\t * Adds the given callback to the list of callbacks for the given hook.\n\t\t\t *\n\t\t\t * The callback will be invoked when the hook it is registered for is run.\n\t\t\t * Hooks are usually directly run by a highlight function but you can also run hooks yourself.\n\t\t\t *\n\t\t\t * One callback function can be registered to multiple hooks and the same hook multiple times.\n\t\t\t *\n\t\t\t * @param {string} name The name of the hook.\n\t\t\t * @param {HookCallback} callback The callback function which is given environment variables.\n\t\t\t * @public\n\t\t\t */\n\t\t\tadd: function (name, callback) {\n\t\t\t\tvar hooks = _.hooks.all;\n\n\t\t\t\thooks[name] = hooks[name] || [];\n\n\t\t\t\thooks[name].push(callback);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Runs a hook invoking all registered callbacks with the given environment variables.\n\t\t\t *\n\t\t\t * Callbacks will be invoked synchronously and in the order in which they were registered.\n\t\t\t *\n\t\t\t * @param {string} name The name of the hook.\n\t\t\t * @param {Object<string, any>} env The environment variables of the hook passed to all callbacks registered.\n\t\t\t * @public\n\t\t\t */\n\t\t\trun: function (name, env) {\n\t\t\t\tvar callbacks = _.hooks.all[name];\n\n\t\t\t\tif (!callbacks || !callbacks.length) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfor (var i = 0, callback; (callback = callbacks[i++]);) {\n\t\t\t\t\tcallback(env);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tToken: Token\n\t};\n\t_self.Prism = _;\n\n\n\t// Typescript note:\n\t// The following can be used to import the Token type in JSDoc:\n\t//\n\t//   @typedef {InstanceType<import(\"./prism-core\")[\"Token\"]>} Token\n\n\t/**\n\t * Creates a new token.\n\t *\n\t * @param {string} type See {@link Token#type type}\n\t * @param {string | TokenStream} content See {@link Token#content content}\n\t * @param {string|string[]} [alias] The alias(es) of the token.\n\t * @param {string} [matchedStr=\"\"] A copy of the full string this token was created from.\n\t * @class\n\t * @global\n\t * @public\n\t */\n\tfunction Token(type, content, alias, matchedStr) {\n\t\t/**\n\t\t * The type of the token.\n\t\t *\n\t\t * This is usually the key of a pattern in a {@link Grammar}.\n\t\t *\n\t\t * @type {string}\n\t\t * @see GrammarToken\n\t\t * @public\n\t\t */\n\t\tthis.type = type;\n\t\t/**\n\t\t * The strings or tokens contained by this token.\n\t\t *\n\t\t * This will be a token stream if the pattern matched also defined an `inside` grammar.\n\t\t *\n\t\t * @type {string | TokenStream}\n\t\t * @public\n\t\t */\n\t\tthis.content = content;\n\t\t/**\n\t\t * The alias(es) of the token.\n\t\t *\n\t\t * @type {string|string[]}\n\t\t * @see GrammarToken\n\t\t * @public\n\t\t */\n\t\tthis.alias = alias;\n\t\t// Copy of the full string this token was created from\n\t\tthis.length = (matchedStr || '').length | 0;\n\t}\n\n\t/**\n\t * A token stream is an array of strings and {@link Token Token} objects.\n\t *\n\t * Token streams have to fulfill a few properties that are assumed by most functions (mostly internal ones) that process\n\t * them.\n\t *\n\t * 1. No adjacent strings.\n\t * 2. No empty strings.\n\t *\n\t *    The only exception here is the token stream that only contains the empty string and nothing else.\n\t *\n\t * @typedef {Array<string | Token>} TokenStream\n\t * @global\n\t * @public\n\t */\n\n\t/**\n\t * Converts the given token or token stream to an HTML representation.\n\t *\n\t * The following hooks will be run:\n\t * 1. `wrap`: On each {@link Token}.\n\t *\n\t * @param {string | Token | TokenStream} o The token or token stream to be converted.\n\t * @param {string} language The name of current language.\n\t * @returns {string} The HTML representation of the token or token stream.\n\t * @memberof Token\n\t * @static\n\t */\n\tToken.stringify = function stringify(o, language) {\n\t\tif (typeof o == 'string') {\n\t\t\treturn o;\n\t\t}\n\t\tif (Array.isArray(o)) {\n\t\t\tvar s = '';\n\t\t\to.forEach(function (e) {\n\t\t\t\ts += stringify(e, language);\n\t\t\t});\n\t\t\treturn s;\n\t\t}\n\n\t\tvar env = {\n\t\t\ttype: o.type,\n\t\t\tcontent: stringify(o.content, language),\n\t\t\ttag: 'span',\n\t\t\tclasses: ['token', o.type],\n\t\t\tattributes: {},\n\t\t\tlanguage: language\n\t\t};\n\n\t\tvar aliases = o.alias;\n\t\tif (aliases) {\n\t\t\tif (Array.isArray(aliases)) {\n\t\t\t\tArray.prototype.push.apply(env.classes, aliases);\n\t\t\t} else {\n\t\t\t\tenv.classes.push(aliases);\n\t\t\t}\n\t\t}\n\n\t\t_.hooks.run('wrap', env);\n\n\t\tvar attributes = '';\n\t\tfor (var name in env.attributes) {\n\t\t\tattributes += ' ' + name + '=\"' + (env.attributes[name] || '').replace(/\"/g, '&quot;') + '\"';\n\t\t}\n\n\t\treturn '<' + env.tag + ' class=\"' + env.classes.join(' ') + '\"' + attributes + '>' + env.content + '</' + env.tag + '>';\n\t};\n\n\t/**\n\t * @param {RegExp} pattern\n\t * @param {number} pos\n\t * @param {string} text\n\t * @param {boolean} lookbehind\n\t * @returns {RegExpExecArray | null}\n\t */\n\tfunction matchPattern(pattern, pos, text, lookbehind) {\n\t\tpattern.lastIndex = pos;\n\t\tvar match = pattern.exec(text);\n\t\tif (match && lookbehind && match[1]) {\n\t\t\t// change the match to remove the text matched by the Prism lookbehind group\n\t\t\tvar lookbehindLength = match[1].length;\n\t\t\tmatch.index += lookbehindLength;\n\t\t\tmatch[0] = match[0].slice(lookbehindLength);\n\t\t}\n\t\treturn match;\n\t}\n\n\t/**\n\t * @param {string} text\n\t * @param {LinkedList<string | Token>} tokenList\n\t * @param {any} grammar\n\t * @param {LinkedListNode<string | Token>} startNode\n\t * @param {number} startPos\n\t * @param {RematchOptions} [rematch]\n\t * @returns {void}\n\t * @private\n\t *\n\t * @typedef RematchOptions\n\t * @property {string} cause\n\t * @property {number} reach\n\t */\n\tfunction matchGrammar(text, tokenList, grammar, startNode, startPos, rematch) {\n\t\tfor (var token in grammar) {\n\t\t\tif (!grammar.hasOwnProperty(token) || !grammar[token]) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar patterns = grammar[token];\n\t\t\tpatterns = Array.isArray(patterns) ? patterns : [patterns];\n\n\t\t\tfor (var j = 0; j < patterns.length; ++j) {\n\t\t\t\tif (rematch && rematch.cause == token + ',' + j) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar patternObj = patterns[j];\n\t\t\t\tvar inside = patternObj.inside;\n\t\t\t\tvar lookbehind = !!patternObj.lookbehind;\n\t\t\t\tvar greedy = !!patternObj.greedy;\n\t\t\t\tvar alias = patternObj.alias;\n\n\t\t\t\tif (greedy && !patternObj.pattern.global) {\n\t\t\t\t\t// Without the global flag, lastIndex won't work\n\t\t\t\t\tvar flags = patternObj.pattern.toString().match(/[imsuy]*$/)[0];\n\t\t\t\t\tpatternObj.pattern = RegExp(patternObj.pattern.source, flags + 'g');\n\t\t\t\t}\n\n\t\t\t\t/** @type {RegExp} */\n\t\t\t\tvar pattern = patternObj.pattern || patternObj;\n\n\t\t\t\tfor ( // iterate the token list and keep track of the current token/string position\n\t\t\t\t\tvar currentNode = startNode.next, pos = startPos;\n\t\t\t\t\tcurrentNode !== tokenList.tail;\n\t\t\t\t\tpos += currentNode.value.length, currentNode = currentNode.next\n\t\t\t\t) {\n\n\t\t\t\t\tif (rematch && pos >= rematch.reach) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar str = currentNode.value;\n\n\t\t\t\t\tif (tokenList.length > text.length) {\n\t\t\t\t\t\t// Something went terribly wrong, ABORT, ABORT!\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (str instanceof Token) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar removeCount = 1; // this is the to parameter of removeBetween\n\t\t\t\t\tvar match;\n\n\t\t\t\t\tif (greedy) {\n\t\t\t\t\t\tmatch = matchPattern(pattern, pos, text, lookbehind);\n\t\t\t\t\t\tif (!match || match.index >= text.length) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar from = match.index;\n\t\t\t\t\t\tvar to = match.index + match[0].length;\n\t\t\t\t\t\tvar p = pos;\n\n\t\t\t\t\t\t// find the node that contains the match\n\t\t\t\t\t\tp += currentNode.value.length;\n\t\t\t\t\t\twhile (from >= p) {\n\t\t\t\t\t\t\tcurrentNode = currentNode.next;\n\t\t\t\t\t\t\tp += currentNode.value.length;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// adjust pos (and p)\n\t\t\t\t\t\tp -= currentNode.value.length;\n\t\t\t\t\t\tpos = p;\n\n\t\t\t\t\t\t// the current node is a Token, then the match starts inside another Token, which is invalid\n\t\t\t\t\t\tif (currentNode.value instanceof Token) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// find the last node which is affected by this match\n\t\t\t\t\t\tfor (\n\t\t\t\t\t\t\tvar k = currentNode;\n\t\t\t\t\t\t\tk !== tokenList.tail && (p < to || typeof k.value === 'string');\n\t\t\t\t\t\t\tk = k.next\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tremoveCount++;\n\t\t\t\t\t\t\tp += k.value.length;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tremoveCount--;\n\n\t\t\t\t\t\t// replace with the new match\n\t\t\t\t\t\tstr = text.slice(pos, p);\n\t\t\t\t\t\tmatch.index -= pos;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmatch = matchPattern(pattern, 0, str, lookbehind);\n\t\t\t\t\t\tif (!match) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// eslint-disable-next-line no-redeclare\n\t\t\t\t\tvar from = match.index;\n\t\t\t\t\tvar matchStr = match[0];\n\t\t\t\t\tvar before = str.slice(0, from);\n\t\t\t\t\tvar after = str.slice(from + matchStr.length);\n\n\t\t\t\t\tvar reach = pos + str.length;\n\t\t\t\t\tif (rematch && reach > rematch.reach) {\n\t\t\t\t\t\trematch.reach = reach;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar removeFrom = currentNode.prev;\n\n\t\t\t\t\tif (before) {\n\t\t\t\t\t\tremoveFrom = addAfter(tokenList, removeFrom, before);\n\t\t\t\t\t\tpos += before.length;\n\t\t\t\t\t}\n\n\t\t\t\t\tremoveRange(tokenList, removeFrom, removeCount);\n\n\t\t\t\t\tvar wrapped = new Token(token, inside ? _.tokenize(matchStr, inside) : matchStr, alias, matchStr);\n\t\t\t\t\tcurrentNode = addAfter(tokenList, removeFrom, wrapped);\n\n\t\t\t\t\tif (after) {\n\t\t\t\t\t\taddAfter(tokenList, currentNode, after);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (removeCount > 1) {\n\t\t\t\t\t\t// at least one Token object was removed, so we have to do some rematching\n\t\t\t\t\t\t// this can only happen if the current pattern is greedy\n\n\t\t\t\t\t\t/** @type {RematchOptions} */\n\t\t\t\t\t\tvar nestedRematch = {\n\t\t\t\t\t\t\tcause: token + ',' + j,\n\t\t\t\t\t\t\treach: reach\n\t\t\t\t\t\t};\n\t\t\t\t\t\tmatchGrammar(text, tokenList, grammar, currentNode.prev, pos, nestedRematch);\n\n\t\t\t\t\t\t// the reach might have been extended because of the rematching\n\t\t\t\t\t\tif (rematch && nestedRematch.reach > rematch.reach) {\n\t\t\t\t\t\t\trematch.reach = nestedRematch.reach;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @typedef LinkedListNode\n\t * @property {T} value\n\t * @property {LinkedListNode<T> | null} prev The previous node.\n\t * @property {LinkedListNode<T> | null} next The next node.\n\t * @template T\n\t * @private\n\t */\n\n\t/**\n\t * @template T\n\t * @private\n\t */\n\tfunction LinkedList() {\n\t\t/** @type {LinkedListNode<T>} */\n\t\tvar head = { value: null, prev: null, next: null };\n\t\t/** @type {LinkedListNode<T>} */\n\t\tvar tail = { value: null, prev: head, next: null };\n\t\thead.next = tail;\n\n\t\t/** @type {LinkedListNode<T>} */\n\t\tthis.head = head;\n\t\t/** @type {LinkedListNode<T>} */\n\t\tthis.tail = tail;\n\t\tthis.length = 0;\n\t}\n\n\t/**\n\t * Adds a new node with the given value to the list.\n\t *\n\t * @param {LinkedList<T>} list\n\t * @param {LinkedListNode<T>} node\n\t * @param {T} value\n\t * @returns {LinkedListNode<T>} The added node.\n\t * @template T\n\t */\n\tfunction addAfter(list, node, value) {\n\t\t// assumes that node != list.tail && values.length >= 0\n\t\tvar next = node.next;\n\n\t\tvar newNode = { value: value, prev: node, next: next };\n\t\tnode.next = newNode;\n\t\tnext.prev = newNode;\n\t\tlist.length++;\n\n\t\treturn newNode;\n\t}\n\t/**\n\t * Removes `count` nodes after the given node. The given node will not be removed.\n\t *\n\t * @param {LinkedList<T>} list\n\t * @param {LinkedListNode<T>} node\n\t * @param {number} count\n\t * @template T\n\t */\n\tfunction removeRange(list, node, count) {\n\t\tvar next = node.next;\n\t\tfor (var i = 0; i < count && next !== list.tail; i++) {\n\t\t\tnext = next.next;\n\t\t}\n\t\tnode.next = next;\n\t\tnext.prev = node;\n\t\tlist.length -= i;\n\t}\n\t/**\n\t * @param {LinkedList<T>} list\n\t * @returns {T[]}\n\t * @template T\n\t */\n\tfunction toArray(list) {\n\t\tvar array = [];\n\t\tvar node = list.head.next;\n\t\twhile (node !== list.tail) {\n\t\t\tarray.push(node.value);\n\t\t\tnode = node.next;\n\t\t}\n\t\treturn array;\n\t}\n\n\n\tif (!_self.document) {\n\t\tif (!_self.addEventListener) {\n\t\t\t// in Node.js\n\t\t\treturn _;\n\t\t}\n\n\t\tif (!_.disableWorkerMessageHandler) {\n\t\t\t// In worker\n\t\t\t_self.addEventListener('message', function (evt) {\n\t\t\t\tvar message = JSON.parse(evt.data);\n\t\t\t\tvar lang = message.language;\n\t\t\t\tvar code = message.code;\n\t\t\t\tvar immediateClose = message.immediateClose;\n\n\t\t\t\t_self.postMessage(_.highlight(code, _.languages[lang], lang));\n\t\t\t\tif (immediateClose) {\n\t\t\t\t\t_self.close();\n\t\t\t\t}\n\t\t\t}, false);\n\t\t}\n\n\t\treturn _;\n\t}\n\n\t// Get current script and highlight\n\tvar script = _.util.currentScript();\n\n\tif (script) {\n\t\t_.filename = script.src;\n\n\t\tif (script.hasAttribute('data-manual')) {\n\t\t\t_.manual = true;\n\t\t}\n\t}\n\n\tfunction highlightAutomaticallyCallback() {\n\t\tif (!_.manual) {\n\t\t\t_.highlightAll();\n\t\t}\n\t}\n\n\tif (!_.manual) {\n\t\t// If the document state is \"loading\", then we'll use DOMContentLoaded.\n\t\t// If the document state is \"interactive\" and the prism.js script is deferred, then we'll also use the\n\t\t// DOMContentLoaded event because there might be some plugins or languages which have also been deferred and they\n\t\t// might take longer one animation frame to execute which can create a race condition where only some plugins have\n\t\t// been loaded when Prism.highlightAll() is executed, depending on how fast resources are loaded.\n\t\t// See https://github.com/PrismJS/prism/issues/2102\n\t\tvar readyState = document.readyState;\n\t\tif (readyState === 'loading' || readyState === 'interactive' && script && script.defer) {\n\t\t\tdocument.addEventListener('DOMContentLoaded', highlightAutomaticallyCallback);\n\t\t} else {\n\t\t\tif (window.requestAnimationFrame) {\n\t\t\t\twindow.requestAnimationFrame(highlightAutomaticallyCallback);\n\t\t\t} else {\n\t\t\t\twindow.setTimeout(highlightAutomaticallyCallback, 16);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn _;\n\n}(_self));\n\nif (typeof module !== 'undefined' && module.exports) {\n\tmodule.exports = Prism;\n}\n\n// hack for components to work correctly in node.js\nif (typeof global !== 'undefined') {\n\tglobal.Prism = Prism;\n}\n\n// some additional documentation/types\n\n/**\n * The expansion of a simple `RegExp` literal to support additional properties.\n *\n * @typedef GrammarToken\n * @property {RegExp} pattern The regular expression of the token.\n * @property {boolean} [lookbehind=false] If `true`, then the first capturing group of `pattern` will (effectively)\n * behave as a lookbehind group meaning that the captured text will not be part of the matched text of the new token.\n * @property {boolean} [greedy=false] Whether the token is greedy.\n * @property {string|string[]} [alias] An optional alias or list of aliases.\n * @property {Grammar} [inside] The nested grammar of this token.\n *\n * The `inside` grammar will be used to tokenize the text value of each token of this kind.\n *\n * This can be used to make nested and even recursive language definitions.\n *\n * Note: This can cause infinite recursion. Be careful when you embed different languages or even the same language into\n * each another.\n * @global\n * @public\n */\n\n/**\n * @typedef Grammar\n * @type {Object<string, RegExp | GrammarToken | Array<RegExp | GrammarToken>>}\n * @property {Grammar} [rest] An optional grammar object that will be appended to this grammar.\n * @global\n * @public\n */\n\n/**\n * A function which will invoked after an element was successfully highlighted.\n *\n * @callback HighlightCallback\n * @param {Element} element The element successfully highlighted.\n * @returns {void}\n * @global\n * @public\n */\n\n/**\n * @callback HookCallback\n * @param {Object<string, any>} env The environment variables of the hook.\n * @returns {void}\n * @global\n * @public\n */\n\n\n/* **********************************************\n     Begin prism-markup.js\n********************************************** */\n\nPrism.languages.markup = {\n\t'comment': {\n\t\tpattern: /<!--(?:(?!<!--)[\\s\\S])*?-->/,\n\t\tgreedy: true\n\t},\n\t'prolog': {\n\t\tpattern: /<\\?[\\s\\S]+?\\?>/,\n\t\tgreedy: true\n\t},\n\t'doctype': {\n\t\t// https://www.w3.org/TR/xml/#NT-doctypedecl\n\t\tpattern: /<!DOCTYPE(?:[^>\"'[\\]]|\"[^\"]*\"|'[^']*')+(?:\\[(?:[^<\"'\\]]|\"[^\"]*\"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\\]\\s*)?>/i,\n\t\tgreedy: true,\n\t\tinside: {\n\t\t\t'internal-subset': {\n\t\t\t\tpattern: /(^[^\\[]*\\[)[\\s\\S]+(?=\\]>$)/,\n\t\t\t\tlookbehind: true,\n\t\t\t\tgreedy: true,\n\t\t\t\tinside: null // see below\n\t\t\t},\n\t\t\t'string': {\n\t\t\t\tpattern: /\"[^\"]*\"|'[^']*'/,\n\t\t\t\tgreedy: true\n\t\t\t},\n\t\t\t'punctuation': /^<!|>$|[[\\]]/,\n\t\t\t'doctype-tag': /^DOCTYPE/i,\n\t\t\t'name': /[^\\s<>'\"]+/\n\t\t}\n\t},\n\t'cdata': {\n\t\tpattern: /<!\\[CDATA\\[[\\s\\S]*?\\]\\]>/i,\n\t\tgreedy: true\n\t},\n\t'tag': {\n\t\tpattern: /<\\/?(?!\\d)[^\\s>\\/=$<%]+(?:\\s(?:\\s*[^\\s>\\/=]+(?:\\s*=\\s*(?:\"[^\"]*\"|'[^']*'|[^\\s'\">=]+(?=[\\s>]))|(?=[\\s/>])))+)?\\s*\\/?>/,\n\t\tgreedy: true,\n\t\tinside: {\n\t\t\t'tag': {\n\t\t\t\tpattern: /^<\\/?[^\\s>\\/]+/,\n\t\t\t\tinside: {\n\t\t\t\t\t'punctuation': /^<\\/?/,\n\t\t\t\t\t'namespace': /^[^\\s>\\/:]+:/\n\t\t\t\t}\n\t\t\t},\n\t\t\t'special-attr': [],\n\t\t\t'attr-value': {\n\t\t\t\tpattern: /=\\s*(?:\"[^\"]*\"|'[^']*'|[^\\s'\">=]+)/,\n\t\t\t\tinside: {\n\t\t\t\t\t'punctuation': [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpattern: /^=/,\n\t\t\t\t\t\t\talias: 'attr-equals'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpattern: /^(\\s*)[\"']|[\"']$/,\n\t\t\t\t\t\t\tlookbehind: true\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t},\n\t\t\t'punctuation': /\\/?>/,\n\t\t\t'attr-name': {\n\t\t\t\tpattern: /[^\\s>\\/]+/,\n\t\t\t\tinside: {\n\t\t\t\t\t'namespace': /^[^\\s>\\/:]+:/\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t},\n\t'entity': [\n\t\t{\n\t\t\tpattern: /&[\\da-z]{1,8};/i,\n\t\t\talias: 'named-entity'\n\t\t},\n\t\t/&#x?[\\da-f]{1,8};/i\n\t]\n};\n\nPrism.languages.markup['tag'].inside['attr-value'].inside['entity'] =\n\tPrism.languages.markup['entity'];\nPrism.languages.markup['doctype'].inside['internal-subset'].inside = Prism.languages.markup;\n\n// Plugin to make entity title show the real entity, idea by Roman Komarov\nPrism.hooks.add('wrap', function (env) {\n\n\tif (env.type === 'entity') {\n\t\tenv.attributes['title'] = env.content.replace(/&amp;/, '&');\n\t}\n});\n\nObject.defineProperty(Prism.languages.markup.tag, 'addInlined', {\n\t/**\n\t * Adds an inlined language to markup.\n\t *\n\t * An example of an inlined language is CSS with `<style>` tags.\n\t *\n\t * @param {string} tagName The name of the tag that contains the inlined language. This name will be treated as\n\t * case insensitive.\n\t * @param {string} lang The language key.\n\t * @example\n\t * addInlined('style', 'css');\n\t */\n\tvalue: function addInlined(tagName, lang) {\n\t\tvar includedCdataInside = {};\n\t\tincludedCdataInside['language-' + lang] = {\n\t\t\tpattern: /(^<!\\[CDATA\\[)[\\s\\S]+?(?=\\]\\]>$)/i,\n\t\t\tlookbehind: true,\n\t\t\tinside: Prism.languages[lang]\n\t\t};\n\t\tincludedCdataInside['cdata'] = /^<!\\[CDATA\\[|\\]\\]>$/i;\n\n\t\tvar inside = {\n\t\t\t'included-cdata': {\n\t\t\t\tpattern: /<!\\[CDATA\\[[\\s\\S]*?\\]\\]>/i,\n\t\t\t\tinside: includedCdataInside\n\t\t\t}\n\t\t};\n\t\tinside['language-' + lang] = {\n\t\t\tpattern: /[\\s\\S]+/,\n\t\t\tinside: Prism.languages[lang]\n\t\t};\n\n\t\tvar def = {};\n\t\tdef[tagName] = {\n\t\t\tpattern: RegExp(/(<__[^>]*>)(?:<!\\[CDATA\\[(?:[^\\]]|\\](?!\\]>))*\\]\\]>|(?!<!\\[CDATA\\[)[\\s\\S])*?(?=<\\/__>)/.source.replace(/__/g, function () { return tagName; }), 'i'),\n\t\t\tlookbehind: true,\n\t\t\tgreedy: true,\n\t\t\tinside: inside\n\t\t};\n\n\t\tPrism.languages.insertBefore('markup', 'cdata', def);\n\t}\n});\nObject.defineProperty(Prism.languages.markup.tag, 'addAttribute', {\n\t/**\n\t * Adds an pattern to highlight languages embedded in HTML attributes.\n\t *\n\t * An example of an inlined language is CSS with `style` attributes.\n\t *\n\t * @param {string} attrName The name of the tag that contains the inlined language. This name will be treated as\n\t * case insensitive.\n\t * @param {string} lang The language key.\n\t * @example\n\t * addAttribute('style', 'css');\n\t */\n\tvalue: function (attrName, lang) {\n\t\tPrism.languages.markup.tag.inside['special-attr'].push({\n\t\t\tpattern: RegExp(\n\t\t\t\t/(^|[\"'\\s])/.source + '(?:' + attrName + ')' + /\\s*=\\s*(?:\"[^\"]*\"|'[^']*'|[^\\s'\">=]+(?=[\\s>]))/.source,\n\t\t\t\t'i'\n\t\t\t),\n\t\t\tlookbehind: true,\n\t\t\tinside: {\n\t\t\t\t'attr-name': /^[^\\s=]+/,\n\t\t\t\t'attr-value': {\n\t\t\t\t\tpattern: /=[\\s\\S]+/,\n\t\t\t\t\tinside: {\n\t\t\t\t\t\t'value': {\n\t\t\t\t\t\t\tpattern: /(^=\\s*([\"']|(?![\"'])))\\S[\\s\\S]*(?=\\2$)/,\n\t\t\t\t\t\t\tlookbehind: true,\n\t\t\t\t\t\t\talias: [lang, 'language-' + lang],\n\t\t\t\t\t\t\tinside: Prism.languages[lang]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'punctuation': [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tpattern: /^=/,\n\t\t\t\t\t\t\t\talias: 'attr-equals'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t/\"|'/\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n});\n\nPrism.languages.html = Prism.languages.markup;\nPrism.languages.mathml = Prism.languages.markup;\nPrism.languages.svg = Prism.languages.markup;\n\nPrism.languages.xml = Prism.languages.extend('markup', {});\nPrism.languages.ssml = Prism.languages.xml;\nPrism.languages.atom = Prism.languages.xml;\nPrism.languages.rss = Prism.languages.xml;\n\n\n/* **********************************************\n     Begin prism-css.js\n********************************************** */\n\n(function (Prism) {\n\n\tvar string = /(?:\"(?:\\\\(?:\\r\\n|[\\s\\S])|[^\"\\\\\\r\\n])*\"|'(?:\\\\(?:\\r\\n|[\\s\\S])|[^'\\\\\\r\\n])*')/;\n\n\tPrism.languages.css = {\n\t\t'comment': /\\/\\*[\\s\\S]*?\\*\\//,\n\t\t'atrule': {\n\t\t\tpattern: RegExp('@[\\\\w-](?:' + /[^;{\\s\"']|\\s+(?!\\s)/.source + '|' + string.source + ')*?' + /(?:;|(?=\\s*\\{))/.source),\n\t\t\tinside: {\n\t\t\t\t'rule': /^@[\\w-]+/,\n\t\t\t\t'selector-function-argument': {\n\t\t\t\t\tpattern: /(\\bselector\\s*\\(\\s*(?![\\s)]))(?:[^()\\s]|\\s+(?![\\s)])|\\((?:[^()]|\\([^()]*\\))*\\))+(?=\\s*\\))/,\n\t\t\t\t\tlookbehind: true,\n\t\t\t\t\talias: 'selector'\n\t\t\t\t},\n\t\t\t\t'keyword': {\n\t\t\t\t\tpattern: /(^|[^\\w-])(?:and|not|only|or)(?![\\w-])/,\n\t\t\t\t\tlookbehind: true\n\t\t\t\t}\n\t\t\t\t// See rest below\n\t\t\t}\n\t\t},\n\t\t'url': {\n\t\t\t// https://drafts.csswg.org/css-values-3/#urls\n\t\t\tpattern: RegExp('\\\\burl\\\\((?:' + string.source + '|' + /(?:[^\\\\\\r\\n()\"']|\\\\[\\s\\S])*/.source + ')\\\\)', 'i'),\n\t\t\tgreedy: true,\n\t\t\tinside: {\n\t\t\t\t'function': /^url/i,\n\t\t\t\t'punctuation': /^\\(|\\)$/,\n\t\t\t\t'string': {\n\t\t\t\t\tpattern: RegExp('^' + string.source + '$'),\n\t\t\t\t\talias: 'url'\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t'selector': {\n\t\t\tpattern: RegExp('(^|[{}\\\\s])[^{}\\\\s](?:[^{};\"\\'\\\\s]|\\\\s+(?![\\\\s{])|' + string.source + ')*(?=\\\\s*\\\\{)'),\n\t\t\tlookbehind: true\n\t\t},\n\t\t'string': {\n\t\t\tpattern: string,\n\t\t\tgreedy: true\n\t\t},\n\t\t'property': {\n\t\t\tpattern: /(^|[^-\\w\\xA0-\\uFFFF])(?!\\s)[-_a-z\\xA0-\\uFFFF](?:(?!\\s)[-\\w\\xA0-\\uFFFF])*(?=\\s*:)/i,\n\t\t\tlookbehind: true\n\t\t},\n\t\t'important': /!important\\b/i,\n\t\t'function': {\n\t\t\tpattern: /(^|[^-a-z0-9])[-a-z0-9]+(?=\\()/i,\n\t\t\tlookbehind: true\n\t\t},\n\t\t'punctuation': /[(){};:,]/\n\t};\n\n\tPrism.languages.css['atrule'].inside.rest = Prism.languages.css;\n\n\tvar markup = Prism.languages.markup;\n\tif (markup) {\n\t\tmarkup.tag.addInlined('style', 'css');\n\t\tmarkup.tag.addAttribute('style', 'css');\n\t}\n\n}(Prism));\n\n\n/* **********************************************\n     Begin prism-clike.js\n********************************************** */\n\nPrism.languages.clike = {\n\t'comment': [\n\t\t{\n\t\t\tpattern: /(^|[^\\\\])\\/\\*[\\s\\S]*?(?:\\*\\/|$)/,\n\t\t\tlookbehind: true,\n\t\t\tgreedy: true\n\t\t},\n\t\t{\n\t\t\tpattern: /(^|[^\\\\:])\\/\\/.*/,\n\t\t\tlookbehind: true,\n\t\t\tgreedy: true\n\t\t}\n\t],\n\t'string': {\n\t\tpattern: /([\"'])(?:\\\\(?:\\r\\n|[\\s\\S])|(?!\\1)[^\\\\\\r\\n])*\\1/,\n\t\tgreedy: true\n\t},\n\t'class-name': {\n\t\tpattern: /(\\b(?:class|extends|implements|instanceof|interface|new|trait)\\s+|\\bcatch\\s+\\()[\\w.\\\\]+/i,\n\t\tlookbehind: true,\n\t\tinside: {\n\t\t\t'punctuation': /[.\\\\]/\n\t\t}\n\t},\n\t'keyword': /\\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\\b/,\n\t'boolean': /\\b(?:false|true)\\b/,\n\t'function': /\\b\\w+(?=\\()/,\n\t'number': /\\b0x[\\da-f]+\\b|(?:\\b\\d+(?:\\.\\d*)?|\\B\\.\\d+)(?:e[+-]?\\d+)?/i,\n\t'operator': /[<>]=?|[!=]=?=?|--?|\\+\\+?|&&?|\\|\\|?|[?*/~^%]/,\n\t'punctuation': /[{}[\\];(),.:]/\n};\n\n\n/* **********************************************\n     Begin prism-javascript.js\n********************************************** */\n\nPrism.languages.javascript = Prism.languages.extend('clike', {\n\t'class-name': [\n\t\tPrism.languages.clike['class-name'],\n\t\t{\n\t\t\tpattern: /(^|[^$\\w\\xA0-\\uFFFF])(?!\\s)[_$A-Z\\xA0-\\uFFFF](?:(?!\\s)[$\\w\\xA0-\\uFFFF])*(?=\\.(?:constructor|prototype))/,\n\t\t\tlookbehind: true\n\t\t}\n\t],\n\t'keyword': [\n\t\t{\n\t\t\tpattern: /((?:^|\\})\\s*)catch\\b/,\n\t\t\tlookbehind: true\n\t\t},\n\t\t{\n\t\t\tpattern: /(^|[^.]|\\.\\.\\.\\s*)\\b(?:as|assert(?=\\s*\\{)|async(?=\\s*(?:function\\b|\\(|[$\\w\\xA0-\\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\\s*(?:\\{|$))|for|from(?=\\s*(?:['\"]|$))|function|(?:get|set)(?=\\s*(?:[#\\[$\\w\\xA0-\\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\\b/,\n\t\t\tlookbehind: true\n\t\t},\n\t],\n\t// Allow for all non-ASCII characters (See http://stackoverflow.com/a/2008444)\n\t'function': /#?(?!\\s)[_$a-zA-Z\\xA0-\\uFFFF](?:(?!\\s)[$\\w\\xA0-\\uFFFF])*(?=\\s*(?:\\.\\s*(?:apply|bind|call)\\s*)?\\()/,\n\t'number': {\n\t\tpattern: RegExp(\n\t\t\t/(^|[^\\w$])/.source +\n\t\t\t'(?:' +\n\t\t\t(\n\t\t\t\t// constant\n\t\t\t\t/NaN|Infinity/.source +\n\t\t\t\t'|' +\n\t\t\t\t// binary integer\n\t\t\t\t/0[bB][01]+(?:_[01]+)*n?/.source +\n\t\t\t\t'|' +\n\t\t\t\t// octal integer\n\t\t\t\t/0[oO][0-7]+(?:_[0-7]+)*n?/.source +\n\t\t\t\t'|' +\n\t\t\t\t// hexadecimal integer\n\t\t\t\t/0[xX][\\dA-Fa-f]+(?:_[\\dA-Fa-f]+)*n?/.source +\n\t\t\t\t'|' +\n\t\t\t\t// decimal bigint\n\t\t\t\t/\\d+(?:_\\d+)*n/.source +\n\t\t\t\t'|' +\n\t\t\t\t// decimal number (integer or float) but no bigint\n\t\t\t\t/(?:\\d+(?:_\\d+)*(?:\\.(?:\\d+(?:_\\d+)*)?)?|\\.\\d+(?:_\\d+)*)(?:[Ee][+-]?\\d+(?:_\\d+)*)?/.source\n\t\t\t) +\n\t\t\t')' +\n\t\t\t/(?![\\w$])/.source\n\t\t),\n\t\tlookbehind: true\n\t},\n\t'operator': /--|\\+\\+|\\*\\*=?|=>|&&=?|\\|\\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\\.{3}|\\?\\?=?|\\?\\.?|[~:]/\n});\n\nPrism.languages.javascript['class-name'][0].pattern = /(\\b(?:class|extends|implements|instanceof|interface|new)\\s+)[\\w.\\\\]+/;\n\nPrism.languages.insertBefore('javascript', 'keyword', {\n\t'regex': {\n\t\tpattern: RegExp(\n\t\t\t// lookbehind\n\t\t\t// eslint-disable-next-line regexp/no-dupe-characters-character-class\n\t\t\t/((?:^|[^$\\w\\xA0-\\uFFFF.\"'\\])\\s]|\\b(?:return|yield))\\s*)/.source +\n\t\t\t// Regex pattern:\n\t\t\t// There are 2 regex patterns here. The RegExp set notation proposal added support for nested character\n\t\t\t// classes if the `v` flag is present. Unfortunately, nested CCs are both context-free and incompatible\n\t\t\t// with the only syntax, so we have to define 2 different regex patterns.\n\t\t\t/\\//.source +\n\t\t\t'(?:' +\n\t\t\t/(?:\\[(?:[^\\]\\\\\\r\\n]|\\\\.)*\\]|\\\\.|[^/\\\\\\[\\r\\n])+\\/[dgimyus]{0,7}/.source +\n\t\t\t'|' +\n\t\t\t// `v` flag syntax. This supports 3 levels of nested character classes.\n\t\t\t/(?:\\[(?:[^[\\]\\\\\\r\\n]|\\\\.|\\[(?:[^[\\]\\\\\\r\\n]|\\\\.|\\[(?:[^[\\]\\\\\\r\\n]|\\\\.)*\\])*\\])*\\]|\\\\.|[^/\\\\\\[\\r\\n])+\\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source +\n\t\t\t')' +\n\t\t\t// lookahead\n\t\t\t/(?=(?:\\s|\\/\\*(?:[^*]|\\*(?!\\/))*\\*\\/)*(?:$|[\\r\\n,.;:})\\]]|\\/\\/))/.source\n\t\t),\n\t\tlookbehind: true,\n\t\tgreedy: true,\n\t\tinside: {\n\t\t\t'regex-source': {\n\t\t\t\tpattern: /^(\\/)[\\s\\S]+(?=\\/[a-z]*$)/,\n\t\t\t\tlookbehind: true,\n\t\t\t\talias: 'language-regex',\n\t\t\t\tinside: Prism.languages.regex\n\t\t\t},\n\t\t\t'regex-delimiter': /^\\/|\\/$/,\n\t\t\t'regex-flags': /^[a-z]+$/,\n\t\t}\n\t},\n\t// This must be declared before keyword because we use \"function\" inside the look-forward\n\t'function-variable': {\n\t\tpattern: /#?(?!\\s)[_$a-zA-Z\\xA0-\\uFFFF](?:(?!\\s)[$\\w\\xA0-\\uFFFF])*(?=\\s*[=:]\\s*(?:async\\s*)?(?:\\bfunction\\b|(?:\\((?:[^()]|\\([^()]*\\))*\\)|(?!\\s)[_$a-zA-Z\\xA0-\\uFFFF](?:(?!\\s)[$\\w\\xA0-\\uFFFF])*)\\s*=>))/,\n\t\talias: 'function'\n\t},\n\t'parameter': [\n\t\t{\n\t\t\tpattern: /(function(?:\\s+(?!\\s)[_$a-zA-Z\\xA0-\\uFFFF](?:(?!\\s)[$\\w\\xA0-\\uFFFF])*)?\\s*\\(\\s*)(?!\\s)(?:[^()\\s]|\\s+(?![\\s)])|\\([^()]*\\))+(?=\\s*\\))/,\n\t\t\tlookbehind: true,\n\t\t\tinside: Prism.languages.javascript\n\t\t},\n\t\t{\n\t\t\tpattern: /(^|[^$\\w\\xA0-\\uFFFF])(?!\\s)[_$a-z\\xA0-\\uFFFF](?:(?!\\s)[$\\w\\xA0-\\uFFFF])*(?=\\s*=>)/i,\n\t\t\tlookbehind: true,\n\t\t\tinside: Prism.languages.javascript\n\t\t},\n\t\t{\n\t\t\tpattern: /(\\(\\s*)(?!\\s)(?:[^()\\s]|\\s+(?![\\s)])|\\([^()]*\\))+(?=\\s*\\)\\s*=>)/,\n\t\t\tlookbehind: true,\n\t\t\tinside: Prism.languages.javascript\n\t\t},\n\t\t{\n\t\t\tpattern: /((?:\\b|\\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\\w\\xA0-\\uFFFF]))(?:(?!\\s)[_$a-zA-Z\\xA0-\\uFFFF](?:(?!\\s)[$\\w\\xA0-\\uFFFF])*\\s*)\\(\\s*|\\]\\s*\\(\\s*)(?!\\s)(?:[^()\\s]|\\s+(?![\\s)])|\\([^()]*\\))+(?=\\s*\\)\\s*\\{)/,\n\t\t\tlookbehind: true,\n\t\t\tinside: Prism.languages.javascript\n\t\t}\n\t],\n\t'constant': /\\b[A-Z](?:[A-Z_]|\\dx?)*\\b/\n});\n\nPrism.languages.insertBefore('javascript', 'string', {\n\t'hashbang': {\n\t\tpattern: /^#!.*/,\n\t\tgreedy: true,\n\t\talias: 'comment'\n\t},\n\t'template-string': {\n\t\tpattern: /`(?:\\\\[\\s\\S]|\\$\\{(?:[^{}]|\\{(?:[^{}]|\\{[^}]*\\})*\\})+\\}|(?!\\$\\{)[^\\\\`])*`/,\n\t\tgreedy: true,\n\t\tinside: {\n\t\t\t'template-punctuation': {\n\t\t\t\tpattern: /^`|`$/,\n\t\t\t\talias: 'string'\n\t\t\t},\n\t\t\t'interpolation': {\n\t\t\t\tpattern: /((?:^|[^\\\\])(?:\\\\{2})*)\\$\\{(?:[^{}]|\\{(?:[^{}]|\\{[^}]*\\})*\\})+\\}/,\n\t\t\t\tlookbehind: true,\n\t\t\t\tinside: {\n\t\t\t\t\t'interpolation-punctuation': {\n\t\t\t\t\t\tpattern: /^\\$\\{|\\}$/,\n\t\t\t\t\t\talias: 'punctuation'\n\t\t\t\t\t},\n\t\t\t\t\trest: Prism.languages.javascript\n\t\t\t\t}\n\t\t\t},\n\t\t\t'string': /[\\s\\S]+/\n\t\t}\n\t},\n\t'string-property': {\n\t\tpattern: /((?:^|[,{])[ \\t]*)([\"'])(?:\\\\(?:\\r\\n|[\\s\\S])|(?!\\2)[^\\\\\\r\\n])*\\2(?=\\s*:)/m,\n\t\tlookbehind: true,\n\t\tgreedy: true,\n\t\talias: 'property'\n\t}\n});\n\nPrism.languages.insertBefore('javascript', 'operator', {\n\t'literal-property': {\n\t\tpattern: /((?:^|[,{])[ \\t]*)(?!\\s)[_$a-zA-Z\\xA0-\\uFFFF](?:(?!\\s)[$\\w\\xA0-\\uFFFF])*(?=\\s*:)/m,\n\t\tlookbehind: true,\n\t\talias: 'property'\n\t},\n});\n\nif (Prism.languages.markup) {\n\tPrism.languages.markup.tag.addInlined('script', 'javascript');\n\n\t// add attribute support for all DOM events.\n\t// https://developer.mozilla.org/en-US/docs/Web/Events#Standard_events\n\tPrism.languages.markup.tag.addAttribute(\n\t\t/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,\n\t\t'javascript'\n\t);\n}\n\nPrism.languages.js = Prism.languages.javascript;\n\n\n/* **********************************************\n     Begin prism-file-highlight.js\n********************************************** */\n\n(function () {\n\n\tif (typeof Prism === 'undefined' || typeof document === 'undefined') {\n\t\treturn;\n\t}\n\n\t// https://developer.mozilla.org/en-US/docs/Web/API/Element/matches#Polyfill\n\tif (!Element.prototype.matches) {\n\t\tElement.prototype.matches = Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;\n\t}\n\n\tvar LOADING_MESSAGE = 'Loading\u2026';\n\tvar FAILURE_MESSAGE = function (status, message) {\n\t\treturn '\u2716 Error ' + status + ' while fetching file: ' + message;\n\t};\n\tvar FAILURE_EMPTY_MESSAGE = '\u2716 Error: File does not exist or is empty';\n\n\tvar EXTENSIONS = {\n\t\t'js': 'javascript',\n\t\t'py': 'python',\n\t\t'rb': 'ruby',\n\t\t'ps1': 'powershell',\n\t\t'psm1': 'powershell',\n\t\t'sh': 'bash',\n\t\t'bat': 'batch',\n\t\t'h': 'c',\n\t\t'tex': 'latex'\n\t};\n\n\tvar STATUS_ATTR = 'data-src-status';\n\tvar STATUS_LOADING = 'loading';\n\tvar STATUS_LOADED = 'loaded';\n\tvar STATUS_FAILED = 'failed';\n\n\tvar SELECTOR = 'pre[data-src]:not([' + STATUS_ATTR + '=\"' + STATUS_LOADED + '\"])'\n\t\t+ ':not([' + STATUS_ATTR + '=\"' + STATUS_LOADING + '\"])';\n\n\t/**\n\t * Loads the given file.\n\t *\n\t * @param {string} src The URL or path of the source file to load.\n\t * @param {(result: string) => void} success\n\t * @param {(reason: string) => void} error\n\t */\n\tfunction loadFile(src, success, error) {\n\t\tvar xhr = new XMLHttpRequest();\n\t\txhr.open('GET', src, true);\n\t\txhr.onreadystatechange = function () {\n\t\t\tif (xhr.readyState == 4) {\n\t\t\t\tif (xhr.status < 400 && xhr.responseText) {\n\t\t\t\t\tsuccess(xhr.responseText);\n\t\t\t\t} else {\n\t\t\t\t\tif (xhr.status >= 400) {\n\t\t\t\t\t\terror(FAILURE_MESSAGE(xhr.status, xhr.statusText));\n\t\t\t\t\t} else {\n\t\t\t\t\t\terror(FAILURE_EMPTY_MESSAGE);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\txhr.send(null);\n\t}\n\n\t/**\n\t * Parses the given range.\n\t *\n\t * This returns a range with inclusive ends.\n\t *\n\t * @param {string | null | undefined} range\n\t * @returns {[number, number | undefined] | undefined}\n\t */\n\tfunction parseRange(range) {\n\t\tvar m = /^\\s*(\\d+)\\s*(?:(,)\\s*(?:(\\d+)\\s*)?)?$/.exec(range || '');\n\t\tif (m) {\n\t\t\tvar start = Number(m[1]);\n\t\t\tvar comma = m[2];\n\t\t\tvar end = m[3];\n\n\t\t\tif (!comma) {\n\t\t\t\treturn [start, start];\n\t\t\t}\n\t\t\tif (!end) {\n\t\t\t\treturn [start, undefined];\n\t\t\t}\n\t\t\treturn [start, Number(end)];\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tPrism.hooks.add('before-highlightall', function (env) {\n\t\tenv.selector += ', ' + SELECTOR;\n\t});\n\n\tPrism.hooks.add('before-sanity-check', function (env) {\n\t\tvar pre = /** @type {HTMLPreElement} */ (env.element);\n\t\tif (pre.matches(SELECTOR)) {\n\t\t\tenv.code = ''; // fast-path the whole thing and go to complete\n\n\t\t\tpre.setAttribute(STATUS_ATTR, STATUS_LOADING); // mark as loading\n\n\t\t\t// add code element with loading message\n\t\t\tvar code = pre.appendChild(document.createElement('CODE'));\n\t\t\tcode.textContent = LOADING_MESSAGE;\n\n\t\t\tvar src = pre.getAttribute('data-src');\n\n\t\t\tvar language = env.language;\n\t\t\tif (language === 'none') {\n\t\t\t\t// the language might be 'none' because there is no language set;\n\t\t\t\t// in this case, we want to use the extension as the language\n\t\t\t\tvar extension = (/\\.(\\w+)$/.exec(src) || [, 'none'])[1];\n\t\t\t\tlanguage = EXTENSIONS[extension] || extension;\n\t\t\t}\n\n\t\t\t// set language classes\n\t\t\tPrism.util.setLanguage(code, language);\n\t\t\tPrism.util.setLanguage(pre, language);\n\n\t\t\t// preload the language\n\t\t\tvar autoloader = Prism.plugins.autoloader;\n\t\t\tif (autoloader) {\n\t\t\t\tautoloader.loadLanguages(language);\n\t\t\t}\n\n\t\t\t// load file\n\t\t\tloadFile(\n\t\t\t\tsrc,\n\t\t\t\tfunction (text) {\n\t\t\t\t\t// mark as loaded\n\t\t\t\t\tpre.setAttribute(STATUS_ATTR, STATUS_LOADED);\n\n\t\t\t\t\t// handle data-range\n\t\t\t\t\tvar range = parseRange(pre.getAttribute('data-range'));\n\t\t\t\t\tif (range) {\n\t\t\t\t\t\tvar lines = text.split(/\\r\\n?|\\n/g);\n\n\t\t\t\t\t\t// the range is one-based and inclusive on both ends\n\t\t\t\t\t\tvar start = range[0];\n\t\t\t\t\t\tvar end = range[1] == null ? lines.length : range[1];\n\n\t\t\t\t\t\tif (start < 0) { start += lines.length; }\n\t\t\t\t\t\tstart = Math.max(0, Math.min(start - 1, lines.length));\n\t\t\t\t\t\tif (end < 0) { end += lines.length; }\n\t\t\t\t\t\tend = Math.max(0, Math.min(end, lines.length));\n\n\t\t\t\t\t\ttext = lines.slice(start, end).join('\\n');\n\n\t\t\t\t\t\t// add data-start for line numbers\n\t\t\t\t\t\tif (!pre.hasAttribute('data-start')) {\n\t\t\t\t\t\t\tpre.setAttribute('data-start', String(start + 1));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// highlight code\n\t\t\t\t\tcode.textContent = text;\n\t\t\t\t\tPrism.highlightElement(code);\n\t\t\t\t},\n\t\t\t\tfunction (error) {\n\t\t\t\t\t// mark as failed\n\t\t\t\t\tpre.setAttribute(STATUS_ATTR, STATUS_FAILED);\n\n\t\t\t\t\tcode.textContent = error;\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t});\n\n\tPrism.plugins.fileHighlight = {\n\t\t/**\n\t\t * Executes the File Highlight plugin for all matching `pre` elements under the given container.\n\t\t *\n\t\t * Note: Elements which are already loaded or currently loading will not be touched by this method.\n\t\t *\n\t\t * @param {ParentNode} [container=document]\n\t\t */\n\t\thighlight: function highlight(container) {\n\t\t\tvar elements = (container || document).querySelectorAll(SELECTOR);\n\n\t\t\tfor (var i = 0, element; (element = elements[i++]);) {\n\t\t\t\tPrism.highlightElement(element);\n\t\t\t}\n\t\t}\n\t};\n\n\tvar logged = false;\n\t/** @deprecated Use `Prism.plugins.fileHighlight.highlight` instead. */\n\tPrism.fileHighlight = function () {\n\t\tif (!logged) {\n\t\t\tconsole.warn('Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead.');\n\t\t\tlogged = true;\n\t\t}\n\t\tPrism.plugins.fileHighlight.highlight.apply(this, arguments);\n\t};\n\n}());\n", "(function (Prism) {\n\n\tPrism.languages.typescript = Prism.languages.extend('javascript', {\n\t\t'class-name': {\n\t\t\tpattern: /(\\b(?:class|extends|implements|instanceof|interface|new|type)\\s+)(?!keyof\\b)(?!\\s)[_$a-zA-Z\\xA0-\\uFFFF](?:(?!\\s)[$\\w\\xA0-\\uFFFF])*(?:\\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,\n\t\t\tlookbehind: true,\n\t\t\tgreedy: true,\n\t\t\tinside: null // see below\n\t\t},\n\t\t'builtin': /\\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\\b/,\n\t});\n\n\t// The keywords TypeScript adds to JavaScript\n\tPrism.languages.typescript.keyword.push(\n\t\t/\\b(?:abstract|declare|is|keyof|readonly|require)\\b/,\n\t\t// keywords that have to be followed by an identifier\n\t\t/\\b(?:asserts|infer|interface|module|namespace|type)\\b(?=\\s*(?:[{_$a-zA-Z\\xA0-\\uFFFF]|$))/,\n\t\t// This is for `import type *, {}`\n\t\t/\\btype\\b(?=\\s*(?:[\\{*]|$))/\n\t);\n\n\t// doesn't work with TS because TS is too complex\n\tdelete Prism.languages.typescript['parameter'];\n\tdelete Prism.languages.typescript['literal-property'];\n\n\t// a version of typescript specifically for highlighting types\n\tvar typeInside = Prism.languages.extend('typescript', {});\n\tdelete typeInside['class-name'];\n\n\tPrism.languages.typescript['class-name'].inside = typeInside;\n\n\tPrism.languages.insertBefore('typescript', 'function', {\n\t\t'decorator': {\n\t\t\tpattern: /@[$\\w\\xA0-\\uFFFF]+/,\n\t\t\tinside: {\n\t\t\t\t'at': {\n\t\t\t\t\tpattern: /^@/,\n\t\t\t\t\talias: 'operator'\n\t\t\t\t},\n\t\t\t\t'function': /^[\\s\\S]+/\n\t\t\t}\n\t\t},\n\t\t'generic-function': {\n\t\t\t// e.g. foo<T extends \"bar\" | \"baz\">( ...\n\t\t\tpattern: /#?(?!\\s)[_$a-zA-Z\\xA0-\\uFFFF](?:(?!\\s)[$\\w\\xA0-\\uFFFF])*\\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\\s*\\()/,\n\t\t\tgreedy: true,\n\t\t\tinside: {\n\t\t\t\t'function': /^#?(?!\\s)[_$a-zA-Z\\xA0-\\uFFFF](?:(?!\\s)[$\\w\\xA0-\\uFFFF])*/,\n\t\t\t\t'generic': {\n\t\t\t\t\tpattern: /<[\\s\\S]+/, // everything after the first <\n\t\t\t\t\talias: 'class-name',\n\t\t\t\t\tinside: typeInside\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\tPrism.languages.ts = Prism.languages.typescript;\n\n}(Prism));\n", "(function (Prism) {\n\tvar typescript = Prism.util.clone(Prism.languages.typescript);\n\tPrism.languages.tsx = Prism.languages.extend('jsx', typescript);\n\n\t// doesn't work with TS because TS is too complex\n\tdelete Prism.languages.tsx['parameter'];\n\tdelete Prism.languages.tsx['literal-property'];\n\n\t// This will prevent collisions between TSX tags and TS generic types.\n\t// Idea by https://github.com/karlhorky\n\t// Discussion: https://github.com/PrismJS/prism/issues/2594#issuecomment-710666928\n\tvar tag = Prism.languages.tsx.tag;\n\ttag.pattern = RegExp(/(^|[^\\w$]|(?=<\\/))/.source + '(?:' + tag.pattern.source + ')', tag.pattern.flags);\n\ttag.lookbehind = true;\n}(Prism));\n", "// https://www.json.org/json-en.html\nPrism.languages.json = {\n\t'property': {\n\t\tpattern: /(^|[^\\\\])\"(?:\\\\.|[^\\\\\"\\r\\n])*\"(?=\\s*:)/,\n\t\tlookbehind: true,\n\t\tgreedy: true\n\t},\n\t'string': {\n\t\tpattern: /(^|[^\\\\])\"(?:\\\\.|[^\\\\\"\\r\\n])*\"(?!\\s*:)/,\n\t\tlookbehind: true,\n\t\tgreedy: true\n\t},\n\t'comment': {\n\t\tpattern: /\\/\\/.*|\\/\\*[\\s\\S]*?(?:\\*\\/|$)/,\n\t\tgreedy: true\n\t},\n\t'number': /-?\\b\\d+(?:\\.\\d+)?(?:e[+-]?\\d+)?\\b/i,\n\t'punctuation': /[{}[\\],]/,\n\t'operator': /:/,\n\t'boolean': /\\b(?:false|true)\\b/,\n\t'null': {\n\t\tpattern: /\\bnull\\b/,\n\t\talias: 'keyword'\n\t}\n};\n\nPrism.languages.webmanifest = Prism.languages.json;\n", "{\n  \"animation\": {\n    \"duration\": {\n      \"fast\": \"150ms\",\n      \"normal\": \"300ms\",\n      \"slow\": \"500ms\"\n    },\n    \"easing\": {\n      \"ease-in\": \"cubic-bezier(0.4, 0, 1, 1)\",\n      \"ease-out\": \"cubic-bezier(0, 0, 0.2, 1)\",\n      \"ease-in-out\": \"cubic-bezier(0.4, 0, 0.2, 1)\",\n      \"bounce\": \"cubic-bezier(0.68, -0.55, 0.265, 1.55)\"\n    }\n  },\n  \"transition\": {\n    \"button\": {\n      \"default\": \"background-color 300ms cubic-bezier(0, 0, 0.2, 1)\",\n      \"shadow\": \"box-shadow 150ms cubic-bezier(0, 0, 0.2, 1)\"\n    },\n    \"input\": {\n      \"focus\": \"border-color 150ms cubic-bezier(0, 0, 0.2, 1), box-shadow 150ms cubic-bezier(0, 0, 0.2, 1)\"\n    },\n    \"card\": {\n      \"hover\": \"border-color 300ms cubic-bezier(0, 0, 0.2, 1)\"\n    }\n  },\n  \"border\": {\n    \"width\": {\n      \"default\": \"1px\",\n      \"form-element\": \"2px\",\n      \"form-element-error\": \"4px\",\n      \"card-bottom\": \"4px\",\n      \"panel\": \"8px\",\n      \"table-header\": \"2px\",\n      \"table-cell\": \"1px\",\n      \"semantic\": {\n        \"thin\": \"1px\",\n        \"standard\": \"2px\",\n        \"thick\": \"4px\"\n      }\n    },\n    \"radius\": {\n      \"none\": \"0px\",\n      \"small\": \"4px\",\n      \"medium\": \"8px\",\n      \"large\": \"12px\"\n    },\n    \"color\": {\n      \"default\": \"#d8dde0\",\n      \"form\": \"#4c6272\",\n      \"card\": \"#d8dde0\",\n      \"card-hover\": \"#aeb7bd\",\n      \"error\": \"#d5281b\"\n    }\n  },\n  \"color\": {\n    \"primary\": {\n      \"blue\": \"#005eb8\",\n      \"blue-active\": \"#002f5c\",\n      \"white\": \"#ffffff\",\n      \"black\": \"#212b32\",\n      \"green\": \"#007f3b\",\n      \"purple\": \"#330072\",\n      \"dark-pink\": \"#7c2855\",\n      \"red\": \"#d5281b\",\n      \"light-purple\": \"#880fb8\",\n      \"yellow\": \"#ffeb3b\"\n    },\n    \"secondary\": {\n      \"pale-yellow\": \"#fff9c4\",\n      \"warm-yellow\": \"#ffb81c\",\n      \"region-yellow\": \"#fae100\",\n      \"orange\": \"#ed8b00\",\n      \"tangerine\": \"#ed4f00\",\n      \"aqua-green\": \"#00a499\",\n      \"light-blue\": \"#41b6e6\",\n      \"pink\": \"#ae2573\",\n      \"bright-pink\": \"#e317aa\",\n      \"light-green\": \"#78be20\",\n      \"brown\": \"#9a6324\"\n    },\n    \"grey\": {\n      \"1\": \"#4c6272\",\n      \"2\": \"#768692\",\n      \"3\": \"#aeb7bd\",\n      \"4\": \"#d8dde0\",\n      \"5\": \"#f0f4f5\"\n    },\n    \"accessibility\": {\n      \"okabe-ito\": {\n        \"green\": \"#009e73\",\n        \"vermillion\": \"#d55e00\"\n      },\n      \"cvd-safe\": {\n        \"blue\": \"#1f77b4\",\n        \"orange\": \"#ff7f0e\"\n      },\n      \"positive\": \"#009e73\",\n      \"negative\": \"#d55e00\"\n    },\n    \"data-viz\": {\n      \"categorical\": {\n        \"1\": \"#005eb8\",\n        \"2\": \"#41b6e6\",\n        \"3\": \"#00a499\",\n        \"4\": \"#78be20\",\n        \"5\": \"#007f3b\",\n        \"6\": \"#ffb81c\",\n        \"7\": \"#ed4f00\",\n        \"8\": \"#ae2573\",\n        \"9\": \"#e317aa\",\n        \"10\": \"#880fb8\",\n        \"11\": \"#330072\",\n        \"12\": \"#9a6324\"\n      },\n      \"neutral\": {\n        \"comparison\": \"#4c6272\"\n      },\n      \"region\": {\n        \"north-east\": \"#005eb8\",\n        \"north-west\": \"#41b6e6\",\n        \"east-of-england\": \"#330072\",\n        \"midlands\": \"#ae2573\",\n        \"london\": \"#78be21\",\n        \"south-west\": \"#fae100\",\n        \"south-east\": \"#ed8b00\"\n      },\n      \"severity\": {\n        \"low\": \"#fff9c4\",\n        \"moderate\": \"#ffb81c\",\n        \"high\": \"#ed8b00\",\n        \"critical\": \"#d5281b\"\n      },\n      \"org-level\": {\n        \"trust\": \"#005eb8\",\n        \"ambulance\": \"#007f3b\",\n        \"icb\": \"#7c2855\",\n        \"region\": \"#330072\"\n      },\n      \"stroke\": {\n        \"categorical\": {\n          \"1\": \"#ffffff\",\n          \"2\": \"#212b32\",\n          \"3\": \"#212b32\",\n          \"4\": \"#212b32\",\n          \"5\": \"#ffffff\",\n          \"6\": \"#212b32\",\n          \"7\": \"#ffffff\",\n          \"8\": \"#ffffff\",\n          \"9\": \"#ffffff\",\n          \"10\": \"#ffffff\",\n          \"11\": \"#ffffff\",\n          \"12\": \"#ffffff\"\n        },\n        \"region\": {\n          \"north-east\": \"#5996d1\",\n          \"north-west\": \"#3189ad\",\n          \"east-of-england\": \"#7a59a3\",\n          \"midlands\": \"#ca71a4\",\n          \"london\": \"#5a8f19\",\n          \"south-west\": \"#bca900\",\n          \"south-east\": \"#b26800\"\n        },\n        \"severity\": {\n          \"low\": \"#212b32\",\n          \"moderate\": \"#212b32\",\n          \"high\": \"#212b32\",\n          \"critical\": \"#ffffff\"\n        },\n        \"org-level\": {\n          \"trust\": \"#ffffff\",\n          \"ambulance\": \"#ffffff\",\n          \"icb\": \"#ffffff\",\n          \"region\": \"#ffffff\"\n        }\n      },\n      \"spc\": {\n        \"improvement\": \"#00b0f0\",\n        \"concern\": \"#e46c0a\",\n        \"no-judgement\": \"#490092\",\n        \"common-cause\": \"#a6a6a6\",\n        \"assurance-pass\": \"#00823b\",\n        \"assurance-fail\": \"#da291c\",\n        \"gradient\": {\n          \"stop\": {\n            \"start-opacity\": \"0.18\",\n            \"mid-opacity\": \"0.06\",\n            \"end-opacity\": \"0\",\n            \"triangle-start-opacity\": \"0.18\",\n            \"triangle-mid-opacity\": \"0.06\",\n            \"triangle-end-opacity\": \"0\"\n          }\n        },\n        \"stroke\": {\n          \"improvement\": \"#000000\",\n          \"concern\": \"#000000\",\n          \"no-judgement\": \"#000000\",\n          \"common-cause\": \"#ffffff\",\n          \"assurance-pass\": \"#000000\",\n          \"assurance-fail\": \"#000000\"\n        }\n      }\n    }\n  },\n  \"component\": {\n    \"button\": {\n      \"padding\": {\n        \"mobile\": {\n          \"vertical\": \"8px\",\n          \"horizontal\": \"16px\"\n        },\n        \"desktop\": {\n          \"vertical\": \"12px\",\n          \"horizontal\": \"16px\"\n        }\n      },\n      \"shadow\": {\n        \"size\": \"4px\"\n      }\n    },\n    \"form\": {\n      \"input\": {\n        \"min-height\": \"40px\",\n        \"padding\": \"4px\"\n      },\n      \"checkbox\": {\n        \"size\": \"40px\",\n        \"label-padding\": \"12px\"\n      }\n    },\n    \"card\": {\n      \"padding\": {\n        \"mobile\": \"16px\",\n        \"desktop\": \"32px\"\n      },\n      \"heading-margin\": \"16px\"\n    },\n    \"panel\": {\n      \"padding\": {\n        \"mobile\": \"20px\",\n        \"desktop\": \"28px\"\n      }\n    },\n    \"breadcrumb\": {\n      \"chevron\": {\n        \"margin-left\": \"9px\",\n        \"margin-right\": \"2px\"\n      },\n      \"padding-top\": {\n        \"mobile\": \"16px\",\n        \"desktop\": \"24px\"\n      }\n    },\n    \"summary-list\": {\n      \"cell-padding\": {\n        \"vertical\": \"8px\",\n        \"horizontal\": \"24px\"\n      },\n      \"row-margin\": \"16px\"\n    },\n    \"disclosure\": {\n      \"icon-offset\": \"20px\",\n      \"icon-size\": \"32px\",\n      \"icon-position-offset\": \"16px\"\n    },\n    \"icon-text\": {\n      \"gap\": \"38px\",\n      \"gap-small\": \"26px\"\n    },\n    \"warning\": {\n      \"icon-offset\": \"33px\",\n      \"icon-offset-mobile\": \"25px\",\n      \"icon-top\": \"16px\",\n      \"icon-top-mobile\": \"8px\"\n    },\n    \"guidance\": {\n      \"icon-size\": \"34px\",\n      \"icon-position-top\": \"2px\",\n      \"icon-position-top-print\": \"4px\",\n      \"content-padding\": \"40px\",\n      \"content-padding-small\": \"32px\",\n      \"tick-size\": \"28px\"\n    },\n    \"header\": {\n      \"logo-min-width\": \"100px\",\n      \"logo-height\": \"40px\",\n      \"search-button-width\": \"44px\",\n      \"search-icon-size\": \"24px\",\n      \"menu-icon-size\": \"28px\"\n    },\n    \"task\": {\n      \"padding-adjustment\": \"4px\"\n    },\n    \"tag\": {\n      \"padding-adjustment\": \"2px\"\n    },\n    \"tabs\": {\n      \"border-width\": \"1px\",\n      \"border-compensation\": \"1px\",\n      \"padding-multiplier\": \"1.5\"\n    },\n    \"details\": \"8px\",\n    \"navigation\": {\n      \"dropdown\": {\n        \"item-padding\": \"6px\",\n        \"logo-margin\": \"32px\"\n      }\n    },\n    \"expander\": \"4px\",\n    \"print\": {\n      \"icon-adjustment\": \"4px\",\n      \"logo-height\": \"32px\"\n    },\n    \"spread\": \"4px\",\n    \"blur\": \"4px\",\n    \"link\": \"4px\",\n    \"pagination\": \"16px\"\n  },\n  \"button\": {\n    \"primary\": {\n      \"background\": {\n        \"default\": \"#007f3b\",\n        \"hover\": \"#006530\",\n        \"active\": \"#00401e\",\n        \"disabled\": \"#d8dde0\"\n      },\n      \"text\": {\n        \"default\": \"#ffffff\",\n        \"disabled\": \"#768692\"\n      },\n      \"border\": {\n        \"default\": \"#00000000\",\n        \"focus\": \"#ffeb3b\"\n      }\n    },\n    \"secondary\": {\n      \"background\": {\n        \"default\": \"#00000000\",\n        \"solid\": \"#ffffff\",\n        \"hover\": \"#d9e5f2\",\n        \"active\": \"#c7daf0\"\n      },\n      \"text\": {\n        \"default\": \"#005eb8\"\n      },\n      \"border\": {\n        \"default\": \"#005eb8\"\n      }\n    },\n    \"spacing\": {\n      \"padding-vertical-mobile\": \"8px\",\n      \"padding-horizontal-mobile\": \"16px\",\n      \"padding-vertical-desktop\": \"12px\",\n      \"padding-horizontal-desktop\": \"16px\"\n    },\n    \"border\": {\n      \"width\": \"2px\",\n      \"radius\": \"4px\"\n    },\n    \"shadow\": {\n      \"size\": \"4px\"\n    },\n    \"typography\": {\n      \"weight\": \"600\"\n    }\n  },\n  \"card\": {\n    \"background\": {\n      \"default\": \"#ffffff\"\n    },\n    \"border\": {\n      \"default\": \"#d8dde0\",\n      \"hover\": \"#aeb7bd\",\n      \"bottom\": \"#f0f4f5\"\n    },\n    \"text\": {\n      \"heading\": \"#212b32\",\n      \"description\": \"#212b32\",\n      \"link\": \"#005eb8\"\n    },\n    \"spacing\": {\n      \"padding-mobile\": \"16px\",\n      \"padding-desktop\": \"32px\",\n      \"heading-margin\": \"16px\"\n    },\n    \"border-width\": {\n      \"default\": \"1px\",\n      \"bottom\": \"4px\"\n    },\n    \"shadow\": {\n      \"default\": \"none\",\n      \"hover\": \"0 2px 4px rgba(0, 0, 0, 0.1)\"\n    }\n  },\n  \"form\": {\n    \"input\": {\n      \"background\": {\n        \"default\": \"#ffffff\",\n        \"focus\": \"#ffffff\",\n        \"disabled\": \"#f0f4f5\",\n        \"error\": \"#ffffff\"\n      },\n      \"border\": {\n        \"default\": \"#4c6272\",\n        \"focus\": \"#ffeb3b\",\n        \"error\": \"#d5281b\",\n        \"disabled\": \"#aeb7bd\"\n      },\n      \"text\": {\n        \"default\": \"#212b32\",\n        \"placeholder\": \"#4c6272\",\n        \"disabled\": \"#768692\"\n      }\n    },\n    \"label\": {\n      \"text\": {\n        \"default\": \"#212b32\",\n        \"required\": \"#d5281b\"\n      },\n      \"typography\": {\n        \"weight\": \"600\"\n      }\n    },\n    \"error\": {\n      \"text\": {\n        \"default\": \"#d5281b\"\n      },\n      \"typography\": {\n        \"weight\": \"600\"\n      }\n    },\n    \"hint\": {\n      \"text\": {\n        \"default\": \"#4c6272\"\n      }\n    },\n    \"spacing\": {\n      \"input-padding\": \"4px\",\n      \"input-min-height\": \"40px\",\n      \"checkbox-size\": \"40px\",\n      \"checkbox-label-padding\": \"12px\"\n    },\n    \"border\": {\n      \"width-default\": \"2px\",\n      \"width-error\": \"4px\",\n      \"radius\": \"0px\"\n    }\n  },\n  \"tag\": {\n    \"default\": {\n      \"background\": \"#004c96\",\n      \"border\": \"#004c96\",\n      \"text\": \"#ffffff\"\n    },\n    \"white\": {\n      \"background\": \"#ffffff\",\n      \"border\": \"#212b32\",\n      \"text\": \"#212b32\"\n    },\n    \"grey\": {\n      \"background\": \"#dbe0e3\",\n      \"border\": \"#354550\",\n      \"text\": \"#354550\"\n    },\n    \"green\": {\n      \"background\": \"#cce5d8\",\n      \"border\": \"#004c23\",\n      \"text\": \"#004c23\"\n    },\n    \"aqua-green\": {\n      \"background\": \"#ccedeb\",\n      \"border\": \"#00524d\",\n      \"text\": \"#00524d\"\n    },\n    \"blue\": {\n      \"background\": \"#ccdff1\",\n      \"border\": \"#004281\",\n      \"text\": \"#004281\"\n    },\n    \"purple\": {\n      \"background\": \"#d6cce3\",\n      \"border\": \"#240050\",\n      \"text\": \"#240050\"\n    },\n    \"pink\": {\n      \"background\": \"#efd3e3\",\n      \"border\": \"#57133a\",\n      \"text\": \"#57133a\"\n    },\n    \"red\": {\n      \"background\": \"#f7d4d1\",\n      \"border\": \"#6b140e\",\n      \"text\": \"#6b140e\"\n    },\n    \"orange\": {\n      \"background\": \"#ffdc8e\",\n      \"border\": \"#4d3708\",\n      \"text\": \"#4d3708\"\n    },\n    \"yellow\": {\n      \"background\": \"#fff59d\",\n      \"border\": \"#4d4712\",\n      \"text\": \"#4d4712\"\n    }\n  },\n  \"diagram\": {\n    \"flowchart\": {\n      \"decision\": {\n        \"fill\": \"#fff3e0\",\n        \"stroke\": \"#f57c00\",\n        \"text\": \"#4e342e\"\n      },\n      \"auto\": {\n        \"fill\": \"#e3f2fd\",\n        \"stroke\": \"#1976d2\",\n        \"text\": \"#0d47a1\"\n      },\n      \"action\": {\n        \"fill\": \"#e8f5e9\",\n        \"stroke\": \"#388e3c\",\n        \"text\": \"#1b5e20\"\n      },\n      \"warning\": {\n        \"fill\": \"#ffebee\",\n        \"stroke\": \"#d32f2f\",\n        \"text\": \"#b71c1c\"\n      }\n    },\n    \"mermaid\": {\n      \"class\": {\n        \"decision\": {\n          \"fill\": \"#fff3e0\",\n          \"stroke\": \"#f57c00\",\n          \"text\": \"#4e342e\"\n        },\n        \"auto\": {\n          \"fill\": \"#e3f2fd\",\n          \"stroke\": \"#1976d2\",\n          \"text\": \"#0d47a1\"\n        },\n        \"action\": {\n          \"fill\": \"#e8f5e9\",\n          \"stroke\": \"#388e3c\",\n          \"text\": \"#1b5e20\"\n        },\n        \"warning\": {\n          \"fill\": \"#ffebee\",\n          \"stroke\": \"#d32f2f\",\n          \"text\": \"#b71c1c\"\n        }\n      }\n    }\n  },\n  \"size\": {\n    \"icon\": {\n      \"small\": \"16px\",\n      \"medium\": \"18px\",\n      \"large\": \"24px\",\n      \"extra-large\": \"32px\",\n      \"nhs-default\": \"34px\"\n    },\n    \"form\": {\n      \"control\": {\n        \"small\": \"32px\",\n        \"medium\": \"40px\",\n        \"large\": \"48px\"\n      },\n      \"input-width\": {\n        \"xs\": \"5.4ex\",\n        \"sm\": \"7.2ex\",\n        \"md\": \"9ex\",\n        \"lg\": \"10.8ex\",\n        \"xl\": \"20ex\",\n        \"2xl\": \"38ex\",\n        \"3xl\": \"56ex\"\n      }\n    },\n    \"button\": {\n      \"min-height\": {\n        \"mobile\": \"44px\",\n        \"desktop\": \"40px\"\n      }\n    }\n  },\n  \"layout\": {\n    \"container\": {\n      \"max-width\": \"1020px\"\n    },\n    \"column\": {\n      \"full\": \"100%\",\n      \"half\": \"50%\",\n      \"third\": \"33.333%\",\n      \"quarter\": \"25%\",\n      \"actions\": \"20%\"\n    },\n    \"margin\": {\n      \"negative-thin\": \"-1px\",\n      \"negative-standard\": \"-2px\"\n    },\n    \"gap\": {\n      \"minimal\": \"1px\",\n      \"small\": \"6px\"\n    }\n  },\n  \"breakpoint\": {\n    \"small\": \"320px\",\n    \"small-max\": \"767px\",\n    \"medium\": \"768px\",\n    \"large\": \"1025px\",\n    \"xlarge\": \"1200px\",\n    \"xxlarge\": \"1440px\"\n  },\n  \"grid\": {\n    \"page-width\": \"960px\",\n    \"gutter\": \"32px\",\n    \"gutter-half\": \"16px\"\n  },\n  \"gradient\": {\n    \"metric-card\": {\n      \"primary\": \"linear-gradient(135deg, rgba(0,94,184,0.05), #ffffff)\",\n      \"secondary\": \"linear-gradient(135deg, rgba(136,15,184,0.06), #ffffff)\",\n      \"accent\": \"linear-gradient(135deg, rgba(255,184,28,0.10), #ffffff)\",\n      \"success\": \"linear-gradient(135deg, rgba(0,164,153,0.10), #ffffff)\",\n      \"warning\": \"linear-gradient(135deg, rgba(237,79,0,0.10), #ffffff)\",\n      \"error\": \"linear-gradient(135deg, rgba(213,40,27,0.10), #ffffff)\"\n    }\n  },\n  \"semantic\": {\n    \"intent-hover\": {\n      \"primary\": \"darken(#007f3b, 10%)\",\n      \"secondary\": \"darken(#005eb8, 10%)\",\n      \"warning\": \"darken(#d5281b, 10%)\"\n    },\n    \"intent-active\": {\n      \"primary\": \"darken(#007f3b, 20%)\",\n      \"secondary\": \"darken(#005eb8, 20%)\",\n      \"warning\": \"darken(#d5281b, 20%)\"\n    },\n    \"intent-light\": {\n      \"primary\": \"lighten(#007f3b, 40%)\",\n      \"secondary\": \"lighten(#005eb8, 40%)\",\n      \"warning\": \"lighten(#d5281b, 40%)\"\n    },\n    \"context\": {\n      \"form\": {\n        \"background\": {\n          \"error\": \"lighten(#d5281b, 40%)\",\n          \"success\": \"lighten(#007f3b, 40%)\",\n          \"default\": \"#ffffff\",\n          \"disabled\": \"#d8dde0\",\n          \"readonly\": \"#e8edee\"\n        },\n        \"border\": {\n          \"default\": \"#4c6272\",\n          \"focus\": \"#005eb8\",\n          \"error\": \"#d5281b\",\n          \"success\": \"#007f3b\"\n        },\n        \"text\": {\n          \"default\": \"#212b32\",\n          \"placeholder\": \"#768692\",\n          \"disabled\": \"#768692\",\n          \"error\": \"#d5281b\"\n        }\n      },\n      \"navigation\": {\n        \"background\": {\n          \"header\": \"#005eb8\",\n          \"footer\": \"#005eb8\",\n          \"sidebar\": \"#ffffff\"\n        },\n        \"text\": {\n          \"primary\": \"#ffffff\",\n          \"secondary\": \"#ffffffcc\",\n          \"active\": \"#ffeb3b\"\n        },\n        \"accent\": {\n          \"hover\": \"#ffffff1a\",\n          \"active\": \"#ffffff33\",\n          \"border\": \"#ffeb3b\"\n        }\n      },\n      \"content\": {\n        \"background\": {\n          \"primary\": \"#ffffff\",\n          \"secondary\": \"#d8dde0\",\n          \"elevated\": \"#ffffff\"\n        },\n        \"text\": {\n          \"primary\": \"#212b32\",\n          \"secondary\": \"#4c6272\",\n          \"tertiary\": \"#768692\"\n        },\n        \"accent\": {\n          \"link\": \"#005eb8\",\n          \"highlight\": \"#ffeb3b\",\n          \"border\": \"#e8edee\"\n        }\n      }\n    },\n    \"intent\": {\n      \"primary\": \"#007f3b\",\n      \"secondary\": \"#005eb8\",\n      \"warning\": \"#d5281b\",\n      \"success\": \"#007f3b\",\n      \"neutral\": \"#4c6272\",\n      \"info\": \"#005eb8\"\n    },\n    \"surface\": {\n      \"elevation\": {\n        \"0\": \"#ffffff\",\n        \"1\": \"#ffffff\",\n        \"2\": \"#ffffff\",\n        \"3\": \"#ffffff\"\n      },\n      \"interactive\": {\n        \"default\": \"#ffffff\",\n        \"hover\": \"#d8dde0\",\n        \"active\": \"#e8edee\",\n        \"selected\": \"#005eb81a\"\n      }\n    },\n    \"data-viz\": {\n      \"series\": {\n        \"1\": \"#005eb8\",\n        \"2\": \"#41b6e6\",\n        \"3\": \"#00a499\",\n        \"4\": \"#78be20\",\n        \"5\": \"#007f3b\",\n        \"6\": \"#ffb81c\",\n        \"7\": \"#ed4f00\",\n        \"8\": \"#ae2573\",\n        \"9\": \"#e317aa\",\n        \"10\": \"#880fb8\",\n        \"11\": \"#330072\",\n        \"12\": \"#9a6324\"\n      },\n      \"region\": {\n        \"north-east\": \"#005eb8\",\n        \"north-west\": \"#41b6e6\",\n        \"east-of-england\": \"#330072\",\n        \"midlands\": \"#ae2573\",\n        \"london\": \"#78be21\",\n        \"south-west\": \"#fae100\",\n        \"south-east\": \"#ed8b00\"\n      },\n      \"severity\": {\n        \"low\": \"#fff9c4\",\n        \"moderate\": \"#ffb81c\",\n        \"high\": \"#ed8b00\",\n        \"critical\": \"#d5281b\"\n      },\n      \"org-level\": {\n        \"trust\": \"#005eb8\",\n        \"ambulance\": \"#007f3b\",\n        \"icb\": \"#7c2855\",\n        \"region\": \"#330072\"\n      },\n      \"stroke\": {\n        \"series\": {\n          \"1\": \"#ffffff\",\n          \"2\": \"#212b32\",\n          \"3\": \"#212b32\",\n          \"4\": \"#212b32\",\n          \"5\": \"#ffffff\",\n          \"6\": \"#212b32\",\n          \"7\": \"#ffffff\",\n          \"8\": \"#ffffff\",\n          \"9\": \"#ffffff\",\n          \"10\": \"#ffffff\",\n          \"11\": \"#ffffff\",\n          \"12\": \"#ffffff\"\n        },\n        \"region\": {\n          \"north-east\": \"#5996d1\",\n          \"north-west\": \"#3189ad\",\n          \"east-of-england\": \"#7a59a3\",\n          \"midlands\": \"#ca71a4\",\n          \"london\": \"#5a8f19\",\n          \"south-west\": \"#bca900\",\n          \"south-east\": \"#b26800\"\n        },\n        \"severity\": {\n          \"low\": \"#212b32\",\n          \"moderate\": \"#212b32\",\n          \"high\": \"#212b32\",\n          \"critical\": \"#ffffff\"\n        },\n        \"org-level\": {\n          \"trust\": \"#ffffff\",\n          \"ambulance\": \"#ffffff\",\n          \"icb\": \"#ffffff\",\n          \"region\": \"#ffffff\"\n        }\n      }\n    },\n    \"relationship\": {\n      \"parent-child\": {\n        \"card\": {\n          \"background\": \"#ffffff\",\n          \"content\": {\n            \"background\": \"calculated-lighten(#ffffff, 2%)\",\n            \"text\": \"auto-contrast(calculated-lighten(#ffffff, 2%))\"\n          },\n          \"header\": {\n            \"background\": \"calculated-darken(#ffffff, 3%)\",\n            \"text\": \"auto-contrast(calculated-darken(#ffffff, 3%))\"\n          }\n        },\n        \"panel\": {\n          \"background\": \"#ffffff\",\n          \"border\": \"calculated-darken(#ffffff, 15%)\",\n          \"content\": {\n            \"text\": \"auto-contrast(#ffffff)\"\n          }\n        }\n      },\n      \"state-propagation\": {\n        \"interactive\": {\n          \"default\": \"#007f3b\",\n          \"hover\": \"calculated-darken(#007f3b, 10%)\",\n          \"active\": \"calculated-darken(#007f3b, 20%)\",\n          \"disabled\": \"calculated-fade(#007f3b, 40%)\"\n        },\n        \"button\": {\n          \"primary\": {\n            \"background\": \"#007f3b\",\n            \"hover\": \"calculated-darken(#007f3b, 10%)\",\n            \"active\": \"calculated-darken(#007f3b, 20%)\"\n          },\n          \"secondary\": {\n            \"background\": \"#00000000\",\n            \"border\": \"#005eb8\",\n            \"hover\": \"calculated-tint(#005eb8, 90%)\"\n          }\n        }\n      }\n    },\n    \"color\": {\n      \"text\": {\n        \"primary\": \"#212b32\",\n        \"secondary\": \"#4c6272\",\n        \"reverse\": \"#ffffff\",\n        \"print\": \"#212b32\"\n      },\n      \"link\": {\n        \"default\": \"#005eb8\",\n        \"hover\": \"#7c2855\",\n        \"active\": \"#003087\",\n        \"visited\": \"#330072\"\n      },\n      \"focus\": {\n        \"background\": \"#ffeb3b\",\n        \"text\": \"#212b32\"\n      },\n      \"border\": {\n        \"default\": \"#d8dde0\",\n        \"secondary\": \"#ffffff33\"\n      },\n      \"error\": \"#d5281b\",\n      \"form\": {\n        \"border\": \"#4c6272\",\n        \"background\": \"#ffffff\"\n      },\n      \"hover\": {\n        \"subtle\": \"#e8edee\",\n        \"header-link\": \"#3a71a6\"\n      },\n      \"active\": {\n        \"header-link\": \"#002c5c\"\n      },\n      \"button\": {\n        \"primary\": {\n          \"background\": \"#007f3b\",\n          \"text\": \"#ffffff\",\n          \"hover\": \"#006530\",\n          \"active\": \"#00401e\",\n          \"shadow\": \"#00401e\"\n        },\n        \"secondary\": {\n          \"background\": \"#00000000\",\n          \"background-solid\": \"#ffffff\",\n          \"border\": \"#005eb8\",\n          \"text\": \"#005eb8\",\n          \"hover\": \"#d9e5f2\",\n          \"active\": \"#c7daf0\",\n          \"shadow\": \"#005eb8\"\n        },\n        \"reverse\": {\n          \"background\": \"#ffffff\",\n          \"text\": \"#212b32\",\n          \"hover\": \"#d9dde0\",\n          \"active\": \"#b3bcc2\",\n          \"shadow\": \"#b3bcc2\"\n        },\n        \"warning\": {\n          \"background\": \"#d5281b\",\n          \"hover\": \"#aa2016\",\n          \"active\": \"#6a140e\",\n          \"shadow\": \"#6a140e\"\n        },\n        \"login\": {\n          \"background\": \"#005eb8\",\n          \"hover\": \"#004b93\",\n          \"active\": \"#002f5c\",\n          \"shadow\": \"#002f5c\"\n        }\n      }\n    }\n  },\n  \"shadow\": {\n    \"button\": {\n      \"default\": \"0 4px 0 #00401e\",\n      \"secondary\": \"0 4px 0 #005eb8\",\n      \"warning\": \"0 4px 0 #6a140e\",\n      \"focus\": \"0 4px 0 #ffeb3b\"\n    },\n    \"card\": {\n      \"default\": \"none\",\n      \"hover\": \"0 2px 4px rgba(0, 0, 0, 0.1)\"\n    }\n  },\n  \"focus-outline\": {\n    \"width\": \"4px\",\n    \"offset\": \"0px\",\n    \"style\": \"solid\"\n  },\n  \"focus-shadow\": {\n    \"input\": \"0 0 0 3px #ffeb3b\",\n    \"button\": \"0 0 0 3px #ffeb3b\",\n    \"link-pattern\": \"0 -2px #ffeb3b, 0 4px #212b32\"\n  },\n  \"focus-box-shadow\": {\n    \"offset-top\": \"-2px\",\n    \"offset-bottom\": \"4px\"\n  },\n  \"elevation\": {\n    \"none\": \"none\",\n    \"low\": \"0 1px 3px rgba(0, 0, 0, 0.12)\",\n    \"medium\": \"0 2px 6px rgba(0, 0, 0, 0.16)\",\n    \"high\": \"0 4px 12px rgba(0, 0, 0, 0.20)\"\n  },\n  \"spacing\": {\n    \"0\": \"0\",\n    \"1\": \"4px\",\n    \"2\": \"8px\",\n    \"3\": \"16px\",\n    \"4\": \"24px\",\n    \"5\": \"32px\",\n    \"6\": \"40px\",\n    \"7\": \"48px\",\n    \"8\": \"56px\",\n    \"9\": \"64px\"\n  },\n  \"spacing-responsive\": {\n    \"0\": {\n      \"mobile\": \"0\",\n      \"tablet\": \"0\"\n    },\n    \"1\": {\n      \"mobile\": \"4px\",\n      \"tablet\": \"4px\"\n    },\n    \"2\": {\n      \"mobile\": \"8px\",\n      \"tablet\": \"8px\"\n    },\n    \"3\": {\n      \"mobile\": \"8px\",\n      \"tablet\": \"16px\"\n    },\n    \"4\": {\n      \"mobile\": \"16px\",\n      \"tablet\": \"24px\"\n    },\n    \"5\": {\n      \"mobile\": \"24px\",\n      \"tablet\": \"32px\"\n    },\n    \"6\": {\n      \"mobile\": \"32px\",\n      \"tablet\": \"40px\"\n    },\n    \"7\": {\n      \"mobile\": \"40px\",\n      \"tablet\": \"48px\"\n    },\n    \"8\": {\n      \"mobile\": \"48px\",\n      \"tablet\": \"56px\"\n    },\n    \"9\": {\n      \"mobile\": \"56px\",\n      \"tablet\": \"64px\"\n    }\n  },\n  \"theme\": {\n    \"light\": {\n      \"semantic\": {\n        \"intent\": {\n          \"primary\": \"#007f3b\",\n          \"secondary\": \"#005eb8\",\n          \"warning\": \"#d5281b\",\n          \"success\": \"#007f3b\",\n          \"neutral\": \"#4c6272\",\n          \"info\": \"#005eb8\"\n        },\n        \"surface\": {\n          \"background\": {\n            \"primary\": \"#ffffff\",\n            \"secondary\": \"#f0f4f5\",\n            \"elevated\": \"#ffffff\"\n          },\n          \"text\": {\n            \"primary\": \"#212b32\",\n            \"secondary\": \"#4c6272\",\n            \"tertiary\": \"#768692\",\n            \"inverse\": \"#ffffff\"\n          },\n          \"border\": {\n            \"default\": \"#d8dde0\",\n            \"subtle\": \"#f0f4f5\",\n            \"strong\": \"#768692\"\n          }\n        }\n      }\n    },\n    \"dark\": {\n      \"semantic\": {\n        \"intent\": {\n          \"primary\": \"lighten(#007f3b, 20%)\",\n          \"secondary\": \"lighten(#005eb8, 25%)\",\n          \"warning\": \"lighten(#d5281b, 15%)\",\n          \"success\": \"lighten(#007f3b, 20%)\",\n          \"neutral\": \"#aeb7bd\",\n          \"info\": \"lighten(#005eb8, 25%)\"\n        },\n        \"surface\": {\n          \"background\": {\n            \"primary\": \"darken(#212b32, 5%)\",\n            \"secondary\": \"lighten(#212b32, 8%)\",\n            \"elevated\": \"lighten(#212b32, 12%)\"\n          },\n          \"text\": {\n            \"primary\": \"fade(#ffffff, 95%)\",\n            \"secondary\": \"fade(#ffffff, 80%)\",\n            \"tertiary\": \"fade(#ffffff, 60%)\",\n            \"inverse\": \"#212b32\"\n          },\n          \"border\": {\n            \"default\": \"fade(#ffffff, 20%)\",\n            \"subtle\": \"fade(#ffffff, 10%)\",\n            \"strong\": \"fade(#ffffff, 40%)\"\n          }\n        }\n      }\n    }\n  },\n  \"font\": {\n    \"family\": {\n      \"base\": \"Frutiger W01\",\n      \"fallback\": \"Arial, sans-serif\",\n      \"print\": \"sans-serif\"\n    },\n    \"weight\": {\n      \"normal\": \"400\",\n      \"bold\": \"600\",\n      \"light\": \"400\"\n    },\n    \"size\": {\n      \"14\": {\n        \"desktop\": \"14px\",\n        \"mobile\": \"12px\",\n        \"tablet\": \"14px\",\n        \"print\": \"12pt\"\n      },\n      \"16\": {\n        \"desktop\": \"16px\",\n        \"mobile\": \"14px\",\n        \"tablet\": \"16px\",\n        \"print\": \"12pt\"\n      },\n      \"19\": {\n        \"desktop\": \"19px\",\n        \"mobile\": \"16px\",\n        \"tablet\": \"19px\",\n        \"print\": \"13pt\"\n      },\n      \"22\": {\n        \"desktop\": \"22px\",\n        \"mobile\": \"19px\",\n        \"tablet\": \"22px\",\n        \"print\": \"15pt\"\n      },\n      \"26\": {\n        \"desktop\": \"26px\",\n        \"mobile\": \"22px\",\n        \"tablet\": \"26px\",\n        \"print\": \"17pt\"\n      },\n      \"36\": {\n        \"desktop\": \"36px\",\n        \"mobile\": \"27px\",\n        \"tablet\": \"36px\",\n        \"print\": \"20pt\"\n      },\n      \"48\": {\n        \"desktop\": \"48px\",\n        \"mobile\": \"33px\",\n        \"tablet\": \"48px\",\n        \"print\": \"24pt\"\n      },\n      \"base\": \"16px\"\n    },\n    \"line-height\": {\n      \"14\": {\n        \"desktop\": \"24px\",\n        \"mobile\": \"20px\",\n        \"tablet\": \"24px\",\n        \"print\": \"1.3\"\n      },\n      \"16\": {\n        \"desktop\": \"24px\",\n        \"mobile\": \"24px\",\n        \"tablet\": \"24px\",\n        \"print\": \"1.3\"\n      },\n      \"19\": {\n        \"desktop\": \"24px\",\n        \"mobile\": \"24px\",\n        \"tablet\": \"28px\",\n        \"print\": \"1.25\"\n      },\n      \"22\": {\n        \"desktop\": \"30px\",\n        \"mobile\": \"27px\",\n        \"tablet\": \"30px\",\n        \"print\": \"1.25\"\n      },\n      \"26\": {\n        \"desktop\": \"32px\",\n        \"mobile\": \"29px\",\n        \"tablet\": \"32px\",\n        \"print\": \"1.25\"\n      },\n      \"36\": {\n        \"desktop\": \"42px\",\n        \"mobile\": \"33px\",\n        \"tablet\": \"42px\",\n        \"print\": \"1.2\"\n      },\n      \"48\": {\n        \"desktop\": \"54px\",\n        \"mobile\": \"38px\",\n        \"tablet\": \"54px\",\n        \"print\": \"1.15\"\n      },\n      \"base\": \"24px\"\n    }\n  }\n}\n", "import * as React from 'react';\nimport clsx from 'clsx';\nimport '../DataVisualisation.scss';\n\nexport interface ChartContainerProps {\n  title: string;\n  description?: string;\n  source?: string;\n  children: React.ReactNode;\n  width?: number | string;\n  height?: number;\n  className?: string;\n  id?: string;\n  tabularData?: React.ReactNode;\n  showTableToggle?: boolean;\n  onToggleTable?: () => void;\n  initiallyShowTable?: boolean;\n}\n\n/**\n * Accessible chart wrapper providing figure/figcaption semantics and optional\n * table toggle pattern for data transparency.\n */\nexport const ChartContainer: React.FC<ChartContainerProps> = ({\n  title,\n  description,\n  source,\n  children,\n  width = '100%',\n  height = 320,\n  className,\n  id,\n  tabularData,\n  showTableToggle,\n  onToggleTable,\n  initiallyShowTable = false\n}) => {\n  const figureId = React.useId();\n  const resolvedId = id || figureId;\n  const descId = description ? `${resolvedId}-desc` : undefined;\n  const sourceId = source ? `${resolvedId}-src` : undefined;\n  const [showTable, setShowTable] = React.useState(initiallyShowTable);\n\n  const handleToggle = React.useCallback(() => {\n    setShowTable(s => !s);\n    onToggleTable?.();\n  }, [onToggleTable]);\n\n  return (\n    <figure\n      id={resolvedId}\n      className={clsx('fdp-chart', className)}\n      style={{ width }}\n      aria-labelledby={`${resolvedId}-title`}\n      aria-describedby={clsx(descId, sourceId)}\n    >\n      <header className=\"fdp-chart__header\">\n        <h3 id={`${resolvedId}-title`} className=\"fdp-chart__title\">{title}</h3>\n        {showTableToggle && (\n          <button\n            type=\"button\"\n            className=\"fdp-chart__toggle\"\n            aria-expanded={showTable}\n            onClick={handleToggle}\n          >\n            {showTable ? 'Hide table' : 'Show table'}\n          </button>\n        )}\n      </header>\n      {description && (\n        <p id={descId} className=\"fdp-chart__description\">\n          {description}\n        </p>\n      )}\n      <div\n        className=\"fdp-chart__viz\"\n        style={{ height }}\n        role=\"group\"\n        aria-label={title}\n      >\n        {children}\n      </div>\n      {(source || tabularData) && (\n        <figcaption className=\"fdp-chart__caption\">\n          {source && (\n            <small id={sourceId} className=\"fdp-chart__source\">\n              Source: {source}\n            </small>\n          )}\n          {showTable && tabularData}\n        </figcaption>\n      )}\n    </figure>\n  );\n};\n\nexport default ChartContainer;\n", "function r(e){var t,f,n=\"\";if(\"string\"==typeof e||\"number\"==typeof e)n+=e;else if(\"object\"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=\" \"),n+=f)}else for(f in e)e[f]&&(n&&(n+=\" \"),n+=f);return n}export function clsx(){for(var e,t,f=0,n=\"\",o=arguments.length;f<o;f++)(e=arguments[f])&&(t=r(e))&&(n&&(n+=\" \"),n+=t);return n}export default clsx;", "import * as React from 'react';\nimport { createXTimeScale, createYLinearScale } from '../../utils/scales';\nimport { scaleTime } from 'd3-scale';\nimport { useChartDimensions } from '../../hooks/useChartDimensions';\nimport { ChartRoot, useChartContext } from '../../core/ChartRoot';\nimport ScaleContext, { useScaleContext, LineScalesProvider } from '../../core/ScaleContext';\nimport Axis from '../../charts/Axis/Axis';\nimport GridLines from '../../charts/GridlLines/GridLines';\nimport LineSeriesPrimitive from '../../series/LineSeriesPrimitive';\nimport { pickSeriesColor, pickRegionColor } from '../../utils/colors';\nimport VisuallyHiddenLiveRegion from '../../primitives/VisuallyHiddenLiveRegion';\nimport { TooltipProvider } from '../../core/TooltipContext';\nimport TooltipOverlay from '../../primitives/TooltipOverlay';\nimport { useTooltipContext } from '../../core/TooltipContext';\nimport { useVisibility } from '../../core/VisibilityContext';\n\nexport interface LineDatum { x: Date | string | number; y: number; }\nexport interface LineSeries { id: string; data: LineDatum[]; color?: string; label?: string; }\nexport interface LineChartProps {\n  series: LineSeries[];\n  height?: number;\n  yLabel?: string;\n  ariaLabel?: string;\n  showPoints?: boolean;\n  focusablePoints?: boolean;\n  /** Palette selection: 'categorical' (default 12\u2011colour data-viz set) or 'region' (maps series id to region tokens if possible) */\n  palette?: 'categorical' | 'region';\n  /** Optional date tick label formatter (defaults locale month short + day) */\n  dateFormatter?: (d: Date) => string;\n  /** Optional y-value tick formatter */\n  valueFormatter?: (n: number) => string;\n  /** Explicit x-axis tick values (dates); overrides automatic ticks. */\n  xTickValues?: (Date | string | number)[];\n  /** Convenience flag: when true, x-axis ticks align exactly to the unique set of data point x values (sorted). Ignored if xTickValues supplied. */\n  alignXTicksToData?: boolean;\n  /** Announce focused point changes via an aria live region (default true). Requires TooltipProvider higher in tree for focus changes; safe no-op otherwise. */\n  announceFocus?: boolean;\n  /** Show floating tooltip overlay (circle + label). Defaults true. */\n  showTooltipOverlay?: boolean;\n  /** Pad the x-domain by half a step on each side so edge points (focus ring) are fully visible (default true). */\n  padXDomain?: boolean;\n  /** Enable wrap-around keyboard navigation for points & series (Arrow keys wrap). */\n  wrapAroundNav?: boolean;\n  /** Opt-in: enable built-in keyboard navigation handler (Arrow/Home/End/Escape). Default false for explicit adoption. */\n  keyboardNav?: boolean;\n  /** Presentation of hidden series: 'remove' (default, series omitted) or 'fade' (dim visually, non-interactive). */\n  visibilityMode?: 'remove' | 'fade';\n  /** When true and some series are hidden, recompute y-domain using only visible series. */\n  recomputeYDomainOnHidden?: boolean;\n  /** Custom stroke width for all series (passed to LineSeriesPrimitive). */\n  strokeWidth?: number;\n  /** Enable / disable curve smoothing (monotoneX). Default true. */\n  smooth?: boolean;\n  /** Light gradient wash under lines (uses series stroke color fading to transparent). Default true. */\n  gradientFills?: boolean;\n}\n\n// Internal renderer. If used inside a ChartRoot (context) it will use those dimensions; otherwise\n// it falls back to creating its own via useChartDimensions (only for legacy direct usage path).\nconst InternalLineChart: React.FC<LineChartProps & { providedDims?: ReturnType<typeof useChartDimensions> | null }> = ({\n  series,\n  yLabel,\n  ariaLabel = 'Line chart',\n  showPoints = true,\n  focusablePoints = true,\n  palette = 'categorical',\n  dateFormatter,\n  valueFormatter,\n  xTickValues,\n  alignXTicksToData = false,\n  announceFocus = true,\n  showTooltipOverlay = true,\n  padXDomain = true,\n  wrapAroundNav = false,\n  keyboardNav = false,\n  visibilityMode = 'remove',\n  recomputeYDomainOnHidden = false,\n  strokeWidth = 1,\n  smooth = true,\n  gradientFills = true,\n  providedDims\n}) => {\n  // Prefer explicit prop (legacy), then context (ChartRoot), else create local dimensions (standalone mode)\n  const contextDims = useChartContext();\n  const dims = providedDims || (contextDims as any) || useChartDimensions({ bottom: 48, left: 56, right: 16, top: 12 });\n  const scaleCtx = useScaleContext();\n  const visibility = useVisibility();\n  const visibleSeries = React.useMemo(() => {\n    if (!visibility) return series;\n    return series.filter(s => !visibility.isHidden(s.id));\n  }, [series, visibility]);\n  const allData = React.useMemo(() => {\n    if (recomputeYDomainOnHidden && visibility) return visibleSeries.flatMap(s => s.data);\n    return series.flatMap(s => s.data);\n  }, [series, visibleSeries, recomputeYDomainOnHidden, visibility]);\n  const parseX = React.useCallback((d: LineDatum) => (d.x instanceof Date ? d.x : new Date(d.x)), []);\n  const xScale = scaleCtx ? scaleCtx.xScale : React.useMemo(() => {\n    if (!padXDomain) return createXTimeScale(allData, parseX, [0, dims.innerWidth]);\n    // Derive padded domain: half typical step either side\n    const times = allData.map(d => parseX(d).getTime()).sort((a,b)=>a-b);\n    if (times.length === 0) return createXTimeScale(allData, parseX, [0, dims.innerWidth]);\n    let step: number;\n    if (times.length === 1) {\n      step = 24 * 3600 * 1000; // 1 day default\n    } else {\n      // median of diffs for robustness\n      const diffs = [] as number[];\n      for (let i=1;i<times.length;i++) diffs.push(times[i]-times[i-1]);\n      diffs.sort((a,b)=>a-b);\n      step = diffs[Math.floor(diffs.length/2)] || (times[times.length-1]-times[0])/(times.length-1);\n    }\n    const pad = step/2;\n    const domain: [Date, Date] = [new Date(times[0]-pad), new Date(times[times.length-1]+pad)];\n    return scaleTime().domain(domain).range([0, dims.innerWidth]);\n  }, [allData, parseX, dims.innerWidth, padXDomain]);\n  const yScale = scaleCtx ? scaleCtx.yScale : React.useMemo(() => createYLinearScale(allData, d => d.y, [dims.innerHeight, 0]), [allData, dims.innerHeight]);\n  const formatDate = dateFormatter || ((d: Date) => d.toLocaleDateString(undefined,{ month:'short', day:'numeric'}));\n  const computedDataTickValues: Date[] = React.useMemo(() => {\n    if (xTickValues && xTickValues.length) return xTickValues.map(v => v instanceof Date ? v : new Date(v));\n    if (!alignXTicksToData) return [];\n    const set = new Set<number>();\n    for (const d of allData) set.add(parseX(d).getTime());\n    return Array.from(set).sort((a,b)=>a-b).map(ms => new Date(ms));\n  }, [xTickValues, alignXTicksToData, allData, parseX]);\n  const formatValue = valueFormatter || ((v: number) => String(v));\n  const gradientIds = React.useMemo(() => series.map(s => `fdp-line-grad-${s.id}`), [series]);\n  const svgContent = (\n    <svg width={dims.width} height={dims.height} role=\"img\">\n      <g transform={`translate(${dims.margin.left},${dims.margin.top})`}>\n        {gradientFills && (\n          <defs>\n            {series.map((s, i) => {\n              const lineColor = s.color || (palette === 'region' ? pickRegionColor(s.id, i) : pickSeriesColor(i));\n              return (\n                <linearGradient key={s.id} id={gradientIds[i]} x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n                  <stop offset=\"0%\" stopColor={lineColor} stopOpacity={0.25} />\n                  <stop offset=\"100%\" stopColor={lineColor} stopOpacity={0} />\n                </linearGradient>\n              );\n            })}\n          </defs>\n        )}\n        <Axis type=\"x\" formatTick={formatDate} tickValues={computedDataTickValues.length ? computedDataTickValues : undefined} />\n        <Axis type=\"y\" formatTick={formatValue} label={yLabel} />\n        <GridLines axis=\"y\" />\n  {series.map((s, si) => (\n          <LineSeriesPrimitive\n            key={s.id}\n            series={s as any}\n            seriesIndex={si}\n            palette={palette}\n            showPoints={showPoints}\n            focusablePoints={focusablePoints}\n            focusIndex={-1} // legacy prop no longer used; tooltip context drives focus\n            parseX={parseX}\n      visibilityMode={visibilityMode}\n      strokeWidth={strokeWidth}\n      smooth={smooth}\n      gradientFillId={gradientFills ? gradientIds[si] : undefined}\n          />\n        ))}\n        {showTooltipOverlay && <TooltipOverlay />}\n      </g>\n    </svg>\n  );\n\n  const KeyboardNavWrapper: React.FC<{ children: React.ReactNode }> = ({ children }) => {\n    const t = useTooltipContext();\n    const onKeyDown = React.useCallback((e: React.KeyboardEvent) => {\n      if (!t) return;\n      switch (e.key) {\n        case 'ArrowRight': t.focusNextPoint(); e.preventDefault(); break;\n        case 'ArrowLeft': t.focusPrevPoint(); e.preventDefault(); break;\n        case 'ArrowDown': t.focusNextSeries(); e.preventDefault(); break;\n        case 'ArrowUp': t.focusPrevSeries(); e.preventDefault(); break;\n        case 'Home': t.focusFirstPoint(); e.preventDefault(); break;\n        case 'End': t.focusLastPoint(); e.preventDefault(); break;\n        case 'Escape': t.clear(); e.preventDefault(); break;\n        default: break;\n      }\n    }, [t]);\n    return (\n      <div className=\"fdp-line-chart\" role=\"group\" aria-label={ariaLabel} tabIndex={0} onKeyDown={onKeyDown}>\n        {children}\n      </div>\n    );\n  };\n\n  const body = (\n    <TooltipProvider wrapAround={wrapAroundNav}>\n      {keyboardNav ? (\n        <KeyboardNavWrapper>\n          {svgContent}\n          {announceFocus && <VisuallyHiddenLiveRegion />}\n        </KeyboardNavWrapper>\n      ) : (\n        <div className=\"fdp-line-chart\" role=\"group\" aria-label={ariaLabel}>\n          {svgContent}\n          {announceFocus && <VisuallyHiddenLiveRegion />}\n        </div>\n      )}\n    </TooltipProvider>\n  );\n  if (scaleCtx) return body;\n  // Provide ad-hoc ScaleContext so Axis/GridLines can function when no external provider.\n  const value = {\n    xScale,\n    yScale,\n    getXTicks: (c = 6) => xScale.ticks(c),\n    getYTicks: (c = 5) => yScale.ticks(c)\n  };\n  return <ScaleContext.Provider value={value}>{body}</ScaleContext.Provider>;\n};\n\nexport const LineChart: React.FC<LineChartProps> = (props) => {\n  const ctx = useChartContext();\n  const content = <InternalLineChart {...props} providedDims={ctx as any} />;\n  if (ctx) {\n    // If already inside ChartRoot and no ScaleContext provided higher up, mount a provider here.\n    return useScaleContext() ? content : (\n      <LineScalesProvider series={props.series} innerWidth={ctx.innerWidth} innerHeight={ctx.innerHeight}>\n        {content}\n      </LineScalesProvider>\n    );\n  }\n  // Standalone: create ChartRoot then provide scales then render internal\n  const ariaLabel = (props as any).ariaLabel;\n  return (\n    <ChartRoot height={(props as any).height ?? 240} ariaLabel={ariaLabel} margin={{ bottom: 48, left: 56, right: 16, top: 12 }}>\n  {/* No ScaleContext in standalone mode so InternalLineChart builds its own scales with measured dims */}\n  <InternalLineChart {...props} />\n    </ChartRoot>\n  );\n};\n\nexport default LineChart;\n", "export default function ascending(a, b) {\n  return a == null || b == null ? NaN : a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n", "export default function descending(a, b) {\n  return a == null || b == null ? NaN\n    : b < a ? -1\n    : b > a ? 1\n    : b >= a ? 0\n    : NaN;\n}\n", "import ascending from \"./ascending.js\";\nimport descending from \"./descending.js\";\n\nexport default function bisector(f) {\n  let compare1, compare2, delta;\n\n  // If an accessor is specified, promote it to a comparator. In this case we\n  // can test whether the search value is (self-) comparable. We can\u2019t do this\n  // for a comparator (except for specific, known comparators) because we can\u2019t\n  // tell if the comparator is symmetric, and an asymmetric comparator can\u2019t be\n  // used to test whether a single value is comparable.\n  if (f.length !== 2) {\n    compare1 = ascending;\n    compare2 = (d, x) => ascending(f(d), x);\n    delta = (d, x) => f(d) - x;\n  } else {\n    compare1 = f === ascending || f === descending ? f : zero;\n    compare2 = f;\n    delta = f;\n  }\n\n  function left(a, x, lo = 0, hi = a.length) {\n    if (lo < hi) {\n      if (compare1(x, x) !== 0) return hi;\n      do {\n        const mid = (lo + hi) >>> 1;\n        if (compare2(a[mid], x) < 0) lo = mid + 1;\n        else hi = mid;\n      } while (lo < hi);\n    }\n    return lo;\n  }\n\n  function right(a, x, lo = 0, hi = a.length) {\n    if (lo < hi) {\n      if (compare1(x, x) !== 0) return hi;\n      do {\n        const mid = (lo + hi) >>> 1;\n        if (compare2(a[mid], x) <= 0) lo = mid + 1;\n        else hi = mid;\n      } while (lo < hi);\n    }\n    return lo;\n  }\n\n  function center(a, x, lo = 0, hi = a.length) {\n    const i = left(a, x, lo, hi - 1);\n    return i > lo && delta(a[i - 1], x) > -delta(a[i], x) ? i - 1 : i;\n  }\n\n  return {left, center, right};\n}\n\nfunction zero() {\n  return 0;\n}\n", "export default function number(x) {\n  return x === null ? NaN : +x;\n}\n\nexport function* numbers(values, valueof) {\n  if (valueof === undefined) {\n    for (let value of values) {\n      if (value != null && (value = +value) >= value) {\n        yield value;\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null && (value = +value) >= value) {\n        yield value;\n      }\n    }\n  }\n}\n", "import ascending from \"./ascending.js\";\nimport bisector from \"./bisector.js\";\nimport number from \"./number.js\";\n\nconst ascendingBisect = bisector(ascending);\nexport const bisectRight = ascendingBisect.right;\nexport const bisectLeft = ascendingBisect.left;\nexport const bisectCenter = bisector(number).center;\nexport default bisectRight;\n", "export default function extent(values, valueof) {\n  let min;\n  let max;\n  if (valueof === undefined) {\n    for (const value of values) {\n      if (value != null) {\n        if (min === undefined) {\n          if (value >= value) min = max = value;\n        } else {\n          if (min > value) min = value;\n          if (max < value) max = value;\n        }\n      }\n    }\n  } else {\n    let index = -1;\n    for (let value of values) {\n      if ((value = valueof(value, ++index, values)) != null) {\n        if (min === undefined) {\n          if (value >= value) min = max = value;\n        } else {\n          if (min > value) min = value;\n          if (max < value) max = value;\n        }\n      }\n    }\n  }\n  return [min, max];\n}\n", "export class InternMap extends Map {\n  constructor(entries, key = keyof) {\n    super();\n    Object.defineProperties(this, {_intern: {value: new Map()}, _key: {value: key}});\n    if (entries != null) for (const [key, value] of entries) this.set(key, value);\n  }\n  get(key) {\n    return super.get(intern_get(this, key));\n  }\n  has(key) {\n    return super.has(intern_get(this, key));\n  }\n  set(key, value) {\n    return super.set(intern_set(this, key), value);\n  }\n  delete(key) {\n    return super.delete(intern_delete(this, key));\n  }\n}\n\nexport class InternSet extends Set {\n  constructor(values, key = keyof) {\n    super();\n    Object.defineProperties(this, {_intern: {value: new Map()}, _key: {value: key}});\n    if (values != null) for (const value of values) this.add(value);\n  }\n  has(value) {\n    return super.has(intern_get(this, value));\n  }\n  add(value) {\n    return super.add(intern_set(this, value));\n  }\n  delete(value) {\n    return super.delete(intern_delete(this, value));\n  }\n}\n\nfunction intern_get({_intern, _key}, value) {\n  const key = _key(value);\n  return _intern.has(key) ? _intern.get(key) : value;\n}\n\nfunction intern_set({_intern, _key}, value) {\n  const key = _key(value);\n  if (_intern.has(key)) return _intern.get(key);\n  _intern.set(key, value);\n  return value;\n}\n\nfunction intern_delete({_intern, _key}, value) {\n  const key = _key(value);\n  if (_intern.has(key)) {\n    value = _intern.get(key);\n    _intern.delete(key);\n  }\n  return value;\n}\n\nfunction keyof(value) {\n  return value !== null && typeof value === \"object\" ? value.valueOf() : value;\n}\n", "const e10 = Math.sqrt(50),\n    e5 = Math.sqrt(10),\n    e2 = Math.sqrt(2);\n\nfunction tickSpec(start, stop, count) {\n  const step = (stop - start) / Math.max(0, count),\n      power = Math.floor(Math.log10(step)),\n      error = step / Math.pow(10, power),\n      factor = error >= e10 ? 10 : error >= e5 ? 5 : error >= e2 ? 2 : 1;\n  let i1, i2, inc;\n  if (power < 0) {\n    inc = Math.pow(10, -power) / factor;\n    i1 = Math.round(start * inc);\n    i2 = Math.round(stop * inc);\n    if (i1 / inc < start) ++i1;\n    if (i2 / inc > stop) --i2;\n    inc = -inc;\n  } else {\n    inc = Math.pow(10, power) * factor;\n    i1 = Math.round(start / inc);\n    i2 = Math.round(stop / inc);\n    if (i1 * inc < start) ++i1;\n    if (i2 * inc > stop) --i2;\n  }\n  if (i2 < i1 && 0.5 <= count && count < 2) return tickSpec(start, stop, count * 2);\n  return [i1, i2, inc];\n}\n\nexport default function ticks(start, stop, count) {\n  stop = +stop, start = +start, count = +count;\n  if (!(count > 0)) return [];\n  if (start === stop) return [start];\n  const reverse = stop < start, [i1, i2, inc] = reverse ? tickSpec(stop, start, count) : tickSpec(start, stop, count);\n  if (!(i2 >= i1)) return [];\n  const n = i2 - i1 + 1, ticks = new Array(n);\n  if (reverse) {\n    if (inc < 0) for (let i = 0; i < n; ++i) ticks[i] = (i2 - i) / -inc;\n    else for (let i = 0; i < n; ++i) ticks[i] = (i2 - i) * inc;\n  } else {\n    if (inc < 0) for (let i = 0; i < n; ++i) ticks[i] = (i1 + i) / -inc;\n    else for (let i = 0; i < n; ++i) ticks[i] = (i1 + i) * inc;\n  }\n  return ticks;\n}\n\nexport function tickIncrement(start, stop, count) {\n  stop = +stop, start = +start, count = +count;\n  return tickSpec(start, stop, count)[2];\n}\n\nexport function tickStep(start, stop, count) {\n  stop = +stop, start = +start, count = +count;\n  const reverse = stop < start, inc = reverse ? tickIncrement(stop, start, count) : tickIncrement(start, stop, count);\n  return (reverse ? -1 : 1) * (inc < 0 ? 1 / -inc : inc);\n}\n", "export default function range(start, stop, step) {\n  start = +start, stop = +stop, step = (n = arguments.length) < 2 ? (stop = start, start = 0, 1) : n < 3 ? 1 : +step;\n\n  var i = -1,\n      n = Math.max(0, Math.ceil((stop - start) / step)) | 0,\n      range = new Array(n);\n\n  while (++i < n) {\n    range[i] = start + i * step;\n  }\n\n  return range;\n}\n", "export function initRange(domain, range) {\n  switch (arguments.length) {\n    case 0: break;\n    case 1: this.range(domain); break;\n    default: this.range(range).domain(domain); break;\n  }\n  return this;\n}\n\nexport function initInterpolator(domain, interpolator) {\n  switch (arguments.length) {\n    case 0: break;\n    case 1: {\n      if (typeof domain === \"function\") this.interpolator(domain);\n      else this.range(domain);\n      break;\n    }\n    default: {\n      this.domain(domain);\n      if (typeof interpolator === \"function\") this.interpolator(interpolator);\n      else this.range(interpolator);\n      break;\n    }\n  }\n  return this;\n}\n", "import {InternMap} from \"d3-array\";\nimport {initRange} from \"./init.js\";\n\nexport const implicit = Symbol(\"implicit\");\n\nexport default function ordinal() {\n  var index = new InternMap(),\n      domain = [],\n      range = [],\n      unknown = implicit;\n\n  function scale(d) {\n    let i = index.get(d);\n    if (i === undefined) {\n      if (unknown !== implicit) return unknown;\n      index.set(d, i = domain.push(d) - 1);\n    }\n    return range[i % range.length];\n  }\n\n  scale.domain = function(_) {\n    if (!arguments.length) return domain.slice();\n    domain = [], index = new InternMap();\n    for (const value of _) {\n      if (index.has(value)) continue;\n      index.set(value, domain.push(value) - 1);\n    }\n    return scale;\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = Array.from(_), scale) : range.slice();\n  };\n\n  scale.unknown = function(_) {\n    return arguments.length ? (unknown = _, scale) : unknown;\n  };\n\n  scale.copy = function() {\n    return ordinal(domain, range).unknown(unknown);\n  };\n\n  initRange.apply(scale, arguments);\n\n  return scale;\n}\n", "import {range as sequence} from \"d3-array\";\nimport {initRange} from \"./init.js\";\nimport ordinal from \"./ordinal.js\";\n\nexport default function band() {\n  var scale = ordinal().unknown(undefined),\n      domain = scale.domain,\n      ordinalRange = scale.range,\n      r0 = 0,\n      r1 = 1,\n      step,\n      bandwidth,\n      round = false,\n      paddingInner = 0,\n      paddingOuter = 0,\n      align = 0.5;\n\n  delete scale.unknown;\n\n  function rescale() {\n    var n = domain().length,\n        reverse = r1 < r0,\n        start = reverse ? r1 : r0,\n        stop = reverse ? r0 : r1;\n    step = (stop - start) / Math.max(1, n - paddingInner + paddingOuter * 2);\n    if (round) step = Math.floor(step);\n    start += (stop - start - step * (n - paddingInner)) * align;\n    bandwidth = step * (1 - paddingInner);\n    if (round) start = Math.round(start), bandwidth = Math.round(bandwidth);\n    var values = sequence(n).map(function(i) { return start + step * i; });\n    return ordinalRange(reverse ? values.reverse() : values);\n  }\n\n  scale.domain = function(_) {\n    return arguments.length ? (domain(_), rescale()) : domain();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? ([r0, r1] = _, r0 = +r0, r1 = +r1, rescale()) : [r0, r1];\n  };\n\n  scale.rangeRound = function(_) {\n    return [r0, r1] = _, r0 = +r0, r1 = +r1, round = true, rescale();\n  };\n\n  scale.bandwidth = function() {\n    return bandwidth;\n  };\n\n  scale.step = function() {\n    return step;\n  };\n\n  scale.round = function(_) {\n    return arguments.length ? (round = !!_, rescale()) : round;\n  };\n\n  scale.padding = function(_) {\n    return arguments.length ? (paddingInner = Math.min(1, paddingOuter = +_), rescale()) : paddingInner;\n  };\n\n  scale.paddingInner = function(_) {\n    return arguments.length ? (paddingInner = Math.min(1, _), rescale()) : paddingInner;\n  };\n\n  scale.paddingOuter = function(_) {\n    return arguments.length ? (paddingOuter = +_, rescale()) : paddingOuter;\n  };\n\n  scale.align = function(_) {\n    return arguments.length ? (align = Math.max(0, Math.min(1, _)), rescale()) : align;\n  };\n\n  scale.copy = function() {\n    return band(domain(), [r0, r1])\n        .round(round)\n        .paddingInner(paddingInner)\n        .paddingOuter(paddingOuter)\n        .align(align);\n  };\n\n  return initRange.apply(rescale(), arguments);\n}\n\nfunction pointish(scale) {\n  var copy = scale.copy;\n\n  scale.padding = scale.paddingOuter;\n  delete scale.paddingInner;\n  delete scale.paddingOuter;\n\n  scale.copy = function() {\n    return pointish(copy());\n  };\n\n  return scale;\n}\n\nexport function point() {\n  return pointish(band.apply(null, arguments).paddingInner(1));\n}\n", "export default function(constructor, factory, prototype) {\n  constructor.prototype = factory.prototype = prototype;\n  prototype.constructor = constructor;\n}\n\nexport function extend(parent, definition) {\n  var prototype = Object.create(parent.prototype);\n  for (var key in definition) prototype[key] = definition[key];\n  return prototype;\n}\n", "import define, {extend} from \"./define.js\";\n\nexport function Color() {}\n\nexport var darker = 0.7;\nexport var brighter = 1 / darker;\n\nvar reI = \"\\\\s*([+-]?\\\\d+)\\\\s*\",\n    reN = \"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",\n    reP = \"\\\\s*([+-]?(?:\\\\d*\\\\.)?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",\n    reHex = /^#([0-9a-f]{3,8})$/,\n    reRgbInteger = new RegExp(`^rgb\\\\(${reI},${reI},${reI}\\\\)$`),\n    reRgbPercent = new RegExp(`^rgb\\\\(${reP},${reP},${reP}\\\\)$`),\n    reRgbaInteger = new RegExp(`^rgba\\\\(${reI},${reI},${reI},${reN}\\\\)$`),\n    reRgbaPercent = new RegExp(`^rgba\\\\(${reP},${reP},${reP},${reN}\\\\)$`),\n    reHslPercent = new RegExp(`^hsl\\\\(${reN},${reP},${reP}\\\\)$`),\n    reHslaPercent = new RegExp(`^hsla\\\\(${reN},${reP},${reP},${reN}\\\\)$`);\n\nvar named = {\n  aliceblue: 0xf0f8ff,\n  antiquewhite: 0xfaebd7,\n  aqua: 0x00ffff,\n  aquamarine: 0x7fffd4,\n  azure: 0xf0ffff,\n  beige: 0xf5f5dc,\n  bisque: 0xffe4c4,\n  black: 0x000000,\n  blanchedalmond: 0xffebcd,\n  blue: 0x0000ff,\n  blueviolet: 0x8a2be2,\n  brown: 0xa52a2a,\n  burlywood: 0xdeb887,\n  cadetblue: 0x5f9ea0,\n  chartreuse: 0x7fff00,\n  chocolate: 0xd2691e,\n  coral: 0xff7f50,\n  cornflowerblue: 0x6495ed,\n  cornsilk: 0xfff8dc,\n  crimson: 0xdc143c,\n  cyan: 0x00ffff,\n  darkblue: 0x00008b,\n  darkcyan: 0x008b8b,\n  darkgoldenrod: 0xb8860b,\n  darkgray: 0xa9a9a9,\n  darkgreen: 0x006400,\n  darkgrey: 0xa9a9a9,\n  darkkhaki: 0xbdb76b,\n  darkmagenta: 0x8b008b,\n  darkolivegreen: 0x556b2f,\n  darkorange: 0xff8c00,\n  darkorchid: 0x9932cc,\n  darkred: 0x8b0000,\n  darksalmon: 0xe9967a,\n  darkseagreen: 0x8fbc8f,\n  darkslateblue: 0x483d8b,\n  darkslategray: 0x2f4f4f,\n  darkslategrey: 0x2f4f4f,\n  darkturquoise: 0x00ced1,\n  darkviolet: 0x9400d3,\n  deeppink: 0xff1493,\n  deepskyblue: 0x00bfff,\n  dimgray: 0x696969,\n  dimgrey: 0x696969,\n  dodgerblue: 0x1e90ff,\n  firebrick: 0xb22222,\n  floralwhite: 0xfffaf0,\n  forestgreen: 0x228b22,\n  fuchsia: 0xff00ff,\n  gainsboro: 0xdcdcdc,\n  ghostwhite: 0xf8f8ff,\n  gold: 0xffd700,\n  goldenrod: 0xdaa520,\n  gray: 0x808080,\n  green: 0x008000,\n  greenyellow: 0xadff2f,\n  grey: 0x808080,\n  honeydew: 0xf0fff0,\n  hotpink: 0xff69b4,\n  indianred: 0xcd5c5c,\n  indigo: 0x4b0082,\n  ivory: 0xfffff0,\n  khaki: 0xf0e68c,\n  lavender: 0xe6e6fa,\n  lavenderblush: 0xfff0f5,\n  lawngreen: 0x7cfc00,\n  lemonchiffon: 0xfffacd,\n  lightblue: 0xadd8e6,\n  lightcoral: 0xf08080,\n  lightcyan: 0xe0ffff,\n  lightgoldenrodyellow: 0xfafad2,\n  lightgray: 0xd3d3d3,\n  lightgreen: 0x90ee90,\n  lightgrey: 0xd3d3d3,\n  lightpink: 0xffb6c1,\n  lightsalmon: 0xffa07a,\n  lightseagreen: 0x20b2aa,\n  lightskyblue: 0x87cefa,\n  lightslategray: 0x778899,\n  lightslategrey: 0x778899,\n  lightsteelblue: 0xb0c4de,\n  lightyellow: 0xffffe0,\n  lime: 0x00ff00,\n  limegreen: 0x32cd32,\n  linen: 0xfaf0e6,\n  magenta: 0xff00ff,\n  maroon: 0x800000,\n  mediumaquamarine: 0x66cdaa,\n  mediumblue: 0x0000cd,\n  mediumorchid: 0xba55d3,\n  mediumpurple: 0x9370db,\n  mediumseagreen: 0x3cb371,\n  mediumslateblue: 0x7b68ee,\n  mediumspringgreen: 0x00fa9a,\n  mediumturquoise: 0x48d1cc,\n  mediumvioletred: 0xc71585,\n  midnightblue: 0x191970,\n  mintcream: 0xf5fffa,\n  mistyrose: 0xffe4e1,\n  moccasin: 0xffe4b5,\n  navajowhite: 0xffdead,\n  navy: 0x000080,\n  oldlace: 0xfdf5e6,\n  olive: 0x808000,\n  olivedrab: 0x6b8e23,\n  orange: 0xffa500,\n  orangered: 0xff4500,\n  orchid: 0xda70d6,\n  palegoldenrod: 0xeee8aa,\n  palegreen: 0x98fb98,\n  paleturquoise: 0xafeeee,\n  palevioletred: 0xdb7093,\n  papayawhip: 0xffefd5,\n  peachpuff: 0xffdab9,\n  peru: 0xcd853f,\n  pink: 0xffc0cb,\n  plum: 0xdda0dd,\n  powderblue: 0xb0e0e6,\n  purple: 0x800080,\n  rebeccapurple: 0x663399,\n  red: 0xff0000,\n  rosybrown: 0xbc8f8f,\n  royalblue: 0x4169e1,\n  saddlebrown: 0x8b4513,\n  salmon: 0xfa8072,\n  sandybrown: 0xf4a460,\n  seagreen: 0x2e8b57,\n  seashell: 0xfff5ee,\n  sienna: 0xa0522d,\n  silver: 0xc0c0c0,\n  skyblue: 0x87ceeb,\n  slateblue: 0x6a5acd,\n  slategray: 0x708090,\n  slategrey: 0x708090,\n  snow: 0xfffafa,\n  springgreen: 0x00ff7f,\n  steelblue: 0x4682b4,\n  tan: 0xd2b48c,\n  teal: 0x008080,\n  thistle: 0xd8bfd8,\n  tomato: 0xff6347,\n  turquoise: 0x40e0d0,\n  violet: 0xee82ee,\n  wheat: 0xf5deb3,\n  white: 0xffffff,\n  whitesmoke: 0xf5f5f5,\n  yellow: 0xffff00,\n  yellowgreen: 0x9acd32\n};\n\ndefine(Color, color, {\n  copy(channels) {\n    return Object.assign(new this.constructor, this, channels);\n  },\n  displayable() {\n    return this.rgb().displayable();\n  },\n  hex: color_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: color_formatHex,\n  formatHex8: color_formatHex8,\n  formatHsl: color_formatHsl,\n  formatRgb: color_formatRgb,\n  toString: color_formatRgb\n});\n\nfunction color_formatHex() {\n  return this.rgb().formatHex();\n}\n\nfunction color_formatHex8() {\n  return this.rgb().formatHex8();\n}\n\nfunction color_formatHsl() {\n  return hslConvert(this).formatHsl();\n}\n\nfunction color_formatRgb() {\n  return this.rgb().formatRgb();\n}\n\nexport default function color(format) {\n  var m, l;\n  format = (format + \"\").trim().toLowerCase();\n  return (m = reHex.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn(m) // #ff0000\n      : l === 3 ? new Rgb((m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), ((m & 0xf) << 4) | (m & 0xf), 1) // #f00\n      : l === 8 ? rgba(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000\n      : l === 4 ? rgba((m >> 12 & 0xf) | (m >> 8 & 0xf0), (m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), (((m & 0xf) << 4) | (m & 0xf)) / 0xff) // #f000\n      : null) // invalid hex\n      : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) // rgb(255, 0, 0)\n      : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)\n      : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)\n      : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)\n      : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)\n      : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)\n      : named.hasOwnProperty(format) ? rgbn(named[format]) // eslint-disable-line no-prototype-builtins\n      : format === \"transparent\" ? new Rgb(NaN, NaN, NaN, 0)\n      : null;\n}\n\nfunction rgbn(n) {\n  return new Rgb(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);\n}\n\nfunction rgba(r, g, b, a) {\n  if (a <= 0) r = g = b = NaN;\n  return new Rgb(r, g, b, a);\n}\n\nexport function rgbConvert(o) {\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Rgb;\n  o = o.rgb();\n  return new Rgb(o.r, o.g, o.b, o.opacity);\n}\n\nexport function rgb(r, g, b, opacity) {\n  return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b, opacity == null ? 1 : opacity);\n}\n\nexport function Rgb(r, g, b, opacity) {\n  this.r = +r;\n  this.g = +g;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Rgb, rgb, extend(Color, {\n  brighter(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  darker(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  rgb() {\n    return this;\n  },\n  clamp() {\n    return new Rgb(clampi(this.r), clampi(this.g), clampi(this.b), clampa(this.opacity));\n  },\n  displayable() {\n    return (-0.5 <= this.r && this.r < 255.5)\n        && (-0.5 <= this.g && this.g < 255.5)\n        && (-0.5 <= this.b && this.b < 255.5)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  hex: rgb_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: rgb_formatHex,\n  formatHex8: rgb_formatHex8,\n  formatRgb: rgb_formatRgb,\n  toString: rgb_formatRgb\n}));\n\nfunction rgb_formatHex() {\n  return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}`;\n}\n\nfunction rgb_formatHex8() {\n  return `#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity) ? 1 : this.opacity) * 255)}`;\n}\n\nfunction rgb_formatRgb() {\n  const a = clampa(this.opacity);\n  return `${a === 1 ? \"rgb(\" : \"rgba(\"}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${a === 1 ? \")\" : `, ${a})`}`;\n}\n\nfunction clampa(opacity) {\n  return isNaN(opacity) ? 1 : Math.max(0, Math.min(1, opacity));\n}\n\nfunction clampi(value) {\n  return Math.max(0, Math.min(255, Math.round(value) || 0));\n}\n\nfunction hex(value) {\n  value = clampi(value);\n  return (value < 16 ? \"0\" : \"\") + value.toString(16);\n}\n\nfunction hsla(h, s, l, a) {\n  if (a <= 0) h = s = l = NaN;\n  else if (l <= 0 || l >= 1) h = s = NaN;\n  else if (s <= 0) h = NaN;\n  return new Hsl(h, s, l, a);\n}\n\nexport function hslConvert(o) {\n  if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Hsl;\n  if (o instanceof Hsl) return o;\n  o = o.rgb();\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      min = Math.min(r, g, b),\n      max = Math.max(r, g, b),\n      h = NaN,\n      s = max - min,\n      l = (max + min) / 2;\n  if (s) {\n    if (r === max) h = (g - b) / s + (g < b) * 6;\n    else if (g === max) h = (b - r) / s + 2;\n    else h = (r - g) / s + 4;\n    s /= l < 0.5 ? max + min : 2 - max - min;\n    h *= 60;\n  } else {\n    s = l > 0 && l < 1 ? 0 : h;\n  }\n  return new Hsl(h, s, l, o.opacity);\n}\n\nexport function hsl(h, s, l, opacity) {\n  return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity == null ? 1 : opacity);\n}\n\nfunction Hsl(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Hsl, hsl, extend(Color, {\n  brighter(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb() {\n    var h = this.h % 360 + (this.h < 0) * 360,\n        s = isNaN(h) || isNaN(this.s) ? 0 : this.s,\n        l = this.l,\n        m2 = l + (l < 0.5 ? l : 1 - l) * s,\n        m1 = 2 * l - m2;\n    return new Rgb(\n      hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2),\n      hsl2rgb(h, m1, m2),\n      hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2),\n      this.opacity\n    );\n  },\n  clamp() {\n    return new Hsl(clamph(this.h), clampt(this.s), clampt(this.l), clampa(this.opacity));\n  },\n  displayable() {\n    return (0 <= this.s && this.s <= 1 || isNaN(this.s))\n        && (0 <= this.l && this.l <= 1)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  formatHsl() {\n    const a = clampa(this.opacity);\n    return `${a === 1 ? \"hsl(\" : \"hsla(\"}${clamph(this.h)}, ${clampt(this.s) * 100}%, ${clampt(this.l) * 100}%${a === 1 ? \")\" : `, ${a})`}`;\n  }\n}));\n\nfunction clamph(value) {\n  value = (value || 0) % 360;\n  return value < 0 ? value + 360 : value;\n}\n\nfunction clampt(value) {\n  return Math.max(0, Math.min(1, value || 0));\n}\n\n/* From FvD 13.37, CSS Color Module Level 3 */\nfunction hsl2rgb(h, m1, m2) {\n  return (h < 60 ? m1 + (m2 - m1) * h / 60\n      : h < 180 ? m2\n      : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60\n      : m1) * 255;\n}\n", "export function basis(t1, v0, v1, v2, v3) {\n  var t2 = t1 * t1, t3 = t2 * t1;\n  return ((1 - 3 * t1 + 3 * t2 - t3) * v0\n      + (4 - 6 * t2 + 3 * t3) * v1\n      + (1 + 3 * t1 + 3 * t2 - 3 * t3) * v2\n      + t3 * v3) / 6;\n}\n\nexport default function(values) {\n  var n = values.length - 1;\n  return function(t) {\n    var i = t <= 0 ? (t = 0) : t >= 1 ? (t = 1, n - 1) : Math.floor(t * n),\n        v1 = values[i],\n        v2 = values[i + 1],\n        v0 = i > 0 ? values[i - 1] : 2 * v1 - v2,\n        v3 = i < n - 1 ? values[i + 2] : 2 * v2 - v1;\n    return basis((t - i / n) * n, v0, v1, v2, v3);\n  };\n}\n", "import {basis} from \"./basis.js\";\n\nexport default function(values) {\n  var n = values.length;\n  return function(t) {\n    var i = Math.floor(((t %= 1) < 0 ? ++t : t) * n),\n        v0 = values[(i + n - 1) % n],\n        v1 = values[i % n],\n        v2 = values[(i + 1) % n],\n        v3 = values[(i + 2) % n];\n    return basis((t - i / n) * n, v0, v1, v2, v3);\n  };\n}\n", "export default x => () => x;\n", "import constant from \"./constant.js\";\n\nfunction linear(a, d) {\n  return function(t) {\n    return a + t * d;\n  };\n}\n\nfunction exponential(a, b, y) {\n  return a = Math.pow(a, y), b = Math.pow(b, y) - a, y = 1 / y, function(t) {\n    return Math.pow(a + t * b, y);\n  };\n}\n\nexport function hue(a, b) {\n  var d = b - a;\n  return d ? linear(a, d > 180 || d < -180 ? d - 360 * Math.round(d / 360) : d) : constant(isNaN(a) ? b : a);\n}\n\nexport function gamma(y) {\n  return (y = +y) === 1 ? nogamma : function(a, b) {\n    return b - a ? exponential(a, b, y) : constant(isNaN(a) ? b : a);\n  };\n}\n\nexport default function nogamma(a, b) {\n  var d = b - a;\n  return d ? linear(a, d) : constant(isNaN(a) ? b : a);\n}\n", "import {rgb as colorRgb} from \"d3-color\";\nimport basis from \"./basis.js\";\nimport basisClosed from \"./basisClosed.js\";\nimport nogamma, {gamma} from \"./color.js\";\n\nexport default (function rgbGamma(y) {\n  var color = gamma(y);\n\n  function rgb(start, end) {\n    var r = color((start = colorRgb(start)).r, (end = colorRgb(end)).r),\n        g = color(start.g, end.g),\n        b = color(start.b, end.b),\n        opacity = nogamma(start.opacity, end.opacity);\n    return function(t) {\n      start.r = r(t);\n      start.g = g(t);\n      start.b = b(t);\n      start.opacity = opacity(t);\n      return start + \"\";\n    };\n  }\n\n  rgb.gamma = rgbGamma;\n\n  return rgb;\n})(1);\n\nfunction rgbSpline(spline) {\n  return function(colors) {\n    var n = colors.length,\n        r = new Array(n),\n        g = new Array(n),\n        b = new Array(n),\n        i, color;\n    for (i = 0; i < n; ++i) {\n      color = colorRgb(colors[i]);\n      r[i] = color.r || 0;\n      g[i] = color.g || 0;\n      b[i] = color.b || 0;\n    }\n    r = spline(r);\n    g = spline(g);\n    b = spline(b);\n    color.opacity = 1;\n    return function(t) {\n      color.r = r(t);\n      color.g = g(t);\n      color.b = b(t);\n      return color + \"\";\n    };\n  };\n}\n\nexport var rgbBasis = rgbSpline(basis);\nexport var rgbBasisClosed = rgbSpline(basisClosed);\n", "export default function(a, b) {\n  if (!b) b = [];\n  var n = a ? Math.min(b.length, a.length) : 0,\n      c = b.slice(),\n      i;\n  return function(t) {\n    for (i = 0; i < n; ++i) c[i] = a[i] * (1 - t) + b[i] * t;\n    return c;\n  };\n}\n\nexport function isNumberArray(x) {\n  return ArrayBuffer.isView(x) && !(x instanceof DataView);\n}\n", "import value from \"./value.js\";\nimport numberArray, {isNumberArray} from \"./numberArray.js\";\n\nexport default function(a, b) {\n  return (isNumberArray(b) ? numberArray : genericArray)(a, b);\n}\n\nexport function genericArray(a, b) {\n  var nb = b ? b.length : 0,\n      na = a ? Math.min(nb, a.length) : 0,\n      x = new Array(na),\n      c = new Array(nb),\n      i;\n\n  for (i = 0; i < na; ++i) x[i] = value(a[i], b[i]);\n  for (; i < nb; ++i) c[i] = b[i];\n\n  return function(t) {\n    for (i = 0; i < na; ++i) c[i] = x[i](t);\n    return c;\n  };\n}\n", "export default function(a, b) {\n  var d = new Date;\n  return a = +a, b = +b, function(t) {\n    return d.setTime(a * (1 - t) + b * t), d;\n  };\n}\n", "export default function(a, b) {\n  return a = +a, b = +b, function(t) {\n    return a * (1 - t) + b * t;\n  };\n}\n", "import value from \"./value.js\";\n\nexport default function(a, b) {\n  var i = {},\n      c = {},\n      k;\n\n  if (a === null || typeof a !== \"object\") a = {};\n  if (b === null || typeof b !== \"object\") b = {};\n\n  for (k in b) {\n    if (k in a) {\n      i[k] = value(a[k], b[k]);\n    } else {\n      c[k] = b[k];\n    }\n  }\n\n  return function(t) {\n    for (k in i) c[k] = i[k](t);\n    return c;\n  };\n}\n", "import number from \"./number.js\";\n\nvar reA = /[-+]?(?:\\d+\\.?\\d*|\\.?\\d+)(?:[eE][-+]?\\d+)?/g,\n    reB = new RegExp(reA.source, \"g\");\n\nfunction zero(b) {\n  return function() {\n    return b;\n  };\n}\n\nfunction one(b) {\n  return function(t) {\n    return b(t) + \"\";\n  };\n}\n\nexport default function(a, b) {\n  var bi = reA.lastIndex = reB.lastIndex = 0, // scan index for next number in b\n      am, // current match in a\n      bm, // current match in b\n      bs, // string preceding current number in b, if any\n      i = -1, // index in s\n      s = [], // string constants and placeholders\n      q = []; // number interpolators\n\n  // Coerce inputs to strings.\n  a = a + \"\", b = b + \"\";\n\n  // Interpolate pairs of numbers in a & b.\n  while ((am = reA.exec(a))\n      && (bm = reB.exec(b))) {\n    if ((bs = bm.index) > bi) { // a string precedes the next number in b\n      bs = b.slice(bi, bs);\n      if (s[i]) s[i] += bs; // coalesce with previous string\n      else s[++i] = bs;\n    }\n    if ((am = am[0]) === (bm = bm[0])) { // numbers in a & b match\n      if (s[i]) s[i] += bm; // coalesce with previous string\n      else s[++i] = bm;\n    } else { // interpolate non-matching numbers\n      s[++i] = null;\n      q.push({i: i, x: number(am, bm)});\n    }\n    bi = reB.lastIndex;\n  }\n\n  // Add remains of b.\n  if (bi < b.length) {\n    bs = b.slice(bi);\n    if (s[i]) s[i] += bs; // coalesce with previous string\n    else s[++i] = bs;\n  }\n\n  // Special optimization for only a single match.\n  // Otherwise, interpolate each of the numbers and rejoin the string.\n  return s.length < 2 ? (q[0]\n      ? one(q[0].x)\n      : zero(b))\n      : (b = q.length, function(t) {\n          for (var i = 0, o; i < b; ++i) s[(o = q[i]).i] = o.x(t);\n          return s.join(\"\");\n        });\n}\n", "import {color} from \"d3-color\";\nimport rgb from \"./rgb.js\";\nimport {genericArray} from \"./array.js\";\nimport date from \"./date.js\";\nimport number from \"./number.js\";\nimport object from \"./object.js\";\nimport string from \"./string.js\";\nimport constant from \"./constant.js\";\nimport numberArray, {isNumberArray} from \"./numberArray.js\";\n\nexport default function(a, b) {\n  var t = typeof b, c;\n  return b == null || t === \"boolean\" ? constant(b)\n      : (t === \"number\" ? number\n      : t === \"string\" ? ((c = color(b)) ? (b = c, rgb) : string)\n      : b instanceof color ? rgb\n      : b instanceof Date ? date\n      : isNumberArray(b) ? numberArray\n      : Array.isArray(b) ? genericArray\n      : typeof b.valueOf !== \"function\" && typeof b.toString !== \"function\" || isNaN(b) ? object\n      : number)(a, b);\n}\n", "export default function(a, b) {\n  return a = +a, b = +b, function(t) {\n    return Math.round(a * (1 - t) + b * t);\n  };\n}\n", "export default function constants(x) {\n  return function() {\n    return x;\n  };\n}\n", "export default function number(x) {\n  return +x;\n}\n", "import {bisect} from \"d3-array\";\nimport {interpolate as interpolateValue, interpolateNumber, interpolateRound} from \"d3-interpolate\";\nimport constant from \"./constant.js\";\nimport number from \"./number.js\";\n\nvar unit = [0, 1];\n\nexport function identity(x) {\n  return x;\n}\n\nfunction normalize(a, b) {\n  return (b -= (a = +a))\n      ? function(x) { return (x - a) / b; }\n      : constant(isNaN(b) ? NaN : 0.5);\n}\n\nfunction clamper(a, b) {\n  var t;\n  if (a > b) t = a, a = b, b = t;\n  return function(x) { return Math.max(a, Math.min(b, x)); };\n}\n\n// normalize(a, b)(x) takes a domain value x in [a,b] and returns the corresponding parameter t in [0,1].\n// interpolate(a, b)(t) takes a parameter t in [0,1] and returns the corresponding range value x in [a,b].\nfunction bimap(domain, range, interpolate) {\n  var d0 = domain[0], d1 = domain[1], r0 = range[0], r1 = range[1];\n  if (d1 < d0) d0 = normalize(d1, d0), r0 = interpolate(r1, r0);\n  else d0 = normalize(d0, d1), r0 = interpolate(r0, r1);\n  return function(x) { return r0(d0(x)); };\n}\n\nfunction polymap(domain, range, interpolate) {\n  var j = Math.min(domain.length, range.length) - 1,\n      d = new Array(j),\n      r = new Array(j),\n      i = -1;\n\n  // Reverse descending domains.\n  if (domain[j] < domain[0]) {\n    domain = domain.slice().reverse();\n    range = range.slice().reverse();\n  }\n\n  while (++i < j) {\n    d[i] = normalize(domain[i], domain[i + 1]);\n    r[i] = interpolate(range[i], range[i + 1]);\n  }\n\n  return function(x) {\n    var i = bisect(domain, x, 1, j) - 1;\n    return r[i](d[i](x));\n  };\n}\n\nexport function copy(source, target) {\n  return target\n      .domain(source.domain())\n      .range(source.range())\n      .interpolate(source.interpolate())\n      .clamp(source.clamp())\n      .unknown(source.unknown());\n}\n\nexport function transformer() {\n  var domain = unit,\n      range = unit,\n      interpolate = interpolateValue,\n      transform,\n      untransform,\n      unknown,\n      clamp = identity,\n      piecewise,\n      output,\n      input;\n\n  function rescale() {\n    var n = Math.min(domain.length, range.length);\n    if (clamp !== identity) clamp = clamper(domain[0], domain[n - 1]);\n    piecewise = n > 2 ? polymap : bimap;\n    output = input = null;\n    return scale;\n  }\n\n  function scale(x) {\n    return x == null || isNaN(x = +x) ? unknown : (output || (output = piecewise(domain.map(transform), range, interpolate)))(transform(clamp(x)));\n  }\n\n  scale.invert = function(y) {\n    return clamp(untransform((input || (input = piecewise(range, domain.map(transform), interpolateNumber)))(y)));\n  };\n\n  scale.domain = function(_) {\n    return arguments.length ? (domain = Array.from(_, number), rescale()) : domain.slice();\n  };\n\n  scale.range = function(_) {\n    return arguments.length ? (range = Array.from(_), rescale()) : range.slice();\n  };\n\n  scale.rangeRound = function(_) {\n    return range = Array.from(_), interpolate = interpolateRound, rescale();\n  };\n\n  scale.clamp = function(_) {\n    return arguments.length ? (clamp = _ ? true : identity, rescale()) : clamp !== identity;\n  };\n\n  scale.interpolate = function(_) {\n    return arguments.length ? (interpolate = _, rescale()) : interpolate;\n  };\n\n  scale.unknown = function(_) {\n    return arguments.length ? (unknown = _, scale) : unknown;\n  };\n\n  return function(t, u) {\n    transform = t, untransform = u;\n    return rescale();\n  };\n}\n\nexport default function continuous() {\n  return transformer()(identity, identity);\n}\n", "export default function(x) {\n  return Math.abs(x = Math.round(x)) >= 1e21\n      ? x.toLocaleString(\"en\").replace(/,/g, \"\")\n      : x.toString(10);\n}\n\n// Computes the decimal coefficient and exponent of the specified number x with\n// significant digits p, where x is positive and p is in [1, 21] or undefined.\n// For example, formatDecimalParts(1.23) returns [\"123\", 0].\nexport function formatDecimalParts(x, p) {\n  if ((i = (x = p ? x.toExponential(p - 1) : x.toExponential()).indexOf(\"e\")) < 0) return null; // NaN, \u00B1Infinity\n  var i, coefficient = x.slice(0, i);\n\n  // The string returned by toExponential either has the form \\d\\.\\d+e[-+]\\d+\n  // (e.g., 1.2e+3) or the form \\de[-+]\\d+ (e.g., 1e+3).\n  return [\n    coefficient.length > 1 ? coefficient[0] + coefficient.slice(2) : coefficient,\n    +x.slice(i + 1)\n  ];\n}\n", "import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport default function(x) {\n  return x = formatDecimalParts(Math.abs(x)), x ? x[1] : NaN;\n}\n", "export default function(grouping, thousands) {\n  return function(value, width) {\n    var i = value.length,\n        t = [],\n        j = 0,\n        g = grouping[0],\n        length = 0;\n\n    while (i > 0 && g > 0) {\n      if (length + g + 1 > width) g = Math.max(1, width - length);\n      t.push(value.substring(i -= g, i + g));\n      if ((length += g + 1) > width) break;\n      g = grouping[j = (j + 1) % grouping.length];\n    }\n\n    return t.reverse().join(thousands);\n  };\n}\n", "export default function(numerals) {\n  return function(value) {\n    return value.replace(/[0-9]/g, function(i) {\n      return numerals[+i];\n    });\n  };\n}\n", "// [[fill]align][sign][symbol][0][width][,][.precision][~][type]\nvar re = /^(?:(.)?([<>=^]))?([+\\-( ])?([$#])?(0)?(\\d+)?(,)?(\\.\\d+)?(~)?([a-z%])?$/i;\n\nexport default function formatSpecifier(specifier) {\n  if (!(match = re.exec(specifier))) throw new Error(\"invalid format: \" + specifier);\n  var match;\n  return new FormatSpecifier({\n    fill: match[1],\n    align: match[2],\n    sign: match[3],\n    symbol: match[4],\n    zero: match[5],\n    width: match[6],\n    comma: match[7],\n    precision: match[8] && match[8].slice(1),\n    trim: match[9],\n    type: match[10]\n  });\n}\n\nformatSpecifier.prototype = FormatSpecifier.prototype; // instanceof\n\nexport function FormatSpecifier(specifier) {\n  this.fill = specifier.fill === undefined ? \" \" : specifier.fill + \"\";\n  this.align = specifier.align === undefined ? \">\" : specifier.align + \"\";\n  this.sign = specifier.sign === undefined ? \"-\" : specifier.sign + \"\";\n  this.symbol = specifier.symbol === undefined ? \"\" : specifier.symbol + \"\";\n  this.zero = !!specifier.zero;\n  this.width = specifier.width === undefined ? undefined : +specifier.width;\n  this.comma = !!specifier.comma;\n  this.precision = specifier.precision === undefined ? undefined : +specifier.precision;\n  this.trim = !!specifier.trim;\n  this.type = specifier.type === undefined ? \"\" : specifier.type + \"\";\n}\n\nFormatSpecifier.prototype.toString = function() {\n  return this.fill\n      + this.align\n      + this.sign\n      + this.symbol\n      + (this.zero ? \"0\" : \"\")\n      + (this.width === undefined ? \"\" : Math.max(1, this.width | 0))\n      + (this.comma ? \",\" : \"\")\n      + (this.precision === undefined ? \"\" : \".\" + Math.max(0, this.precision | 0))\n      + (this.trim ? \"~\" : \"\")\n      + this.type;\n};\n", "// Trims insignificant zeros, e.g., replaces 1.2000k with 1.2k.\nexport default function(s) {\n  out: for (var n = s.length, i = 1, i0 = -1, i1; i < n; ++i) {\n    switch (s[i]) {\n      case \".\": i0 = i1 = i; break;\n      case \"0\": if (i0 === 0) i0 = i; i1 = i; break;\n      default: if (!+s[i]) break out; if (i0 > 0) i0 = 0; break;\n    }\n  }\n  return i0 > 0 ? s.slice(0, i0) + s.slice(i1 + 1) : s;\n}\n", "import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport var prefixExponent;\n\nexport default function(x, p) {\n  var d = formatDecimalParts(x, p);\n  if (!d) return x + \"\";\n  var coefficient = d[0],\n      exponent = d[1],\n      i = exponent - (prefixExponent = Math.max(-8, Math.min(8, Math.floor(exponent / 3))) * 3) + 1,\n      n = coefficient.length;\n  return i === n ? coefficient\n      : i > n ? coefficient + new Array(i - n + 1).join(\"0\")\n      : i > 0 ? coefficient.slice(0, i) + \".\" + coefficient.slice(i)\n      : \"0.\" + new Array(1 - i).join(\"0\") + formatDecimalParts(x, Math.max(0, p + i - 1))[0]; // less than 1y!\n}\n", "import {formatDecimalParts} from \"./formatDecimal.js\";\n\nexport default function(x, p) {\n  var d = formatDecimalParts(x, p);\n  if (!d) return x + \"\";\n  var coefficient = d[0],\n      exponent = d[1];\n  return exponent < 0 ? \"0.\" + new Array(-exponent).join(\"0\") + coefficient\n      : coefficient.length > exponent + 1 ? coefficient.slice(0, exponent + 1) + \".\" + coefficient.slice(exponent + 1)\n      : coefficient + new Array(exponent - coefficient.length + 2).join(\"0\");\n}\n", "import formatDecimal from \"./formatDecimal.js\";\nimport formatPrefixAuto from \"./formatPrefixAuto.js\";\nimport formatRounded from \"./formatRounded.js\";\n\nexport default {\n  \"%\": (x, p) => (x * 100).toFixed(p),\n  \"b\": (x) => Math.round(x).toString(2),\n  \"c\": (x) => x + \"\",\n  \"d\": formatDecimal,\n  \"e\": (x, p) => x.toExponential(p),\n  \"f\": (x, p) => x.toFixed(p),\n  \"g\": (x, p) => x.toPrecision(p),\n  \"o\": (x) => Math.round(x).toString(8),\n  \"p\": (x, p) => formatRounded(x * 100, p),\n  \"r\": formatRounded,\n  \"s\": formatPrefixAuto,\n  \"X\": (x) => Math.round(x).toString(16).toUpperCase(),\n  \"x\": (x) => Math.round(x).toString(16)\n};\n", "export default function(x) {\n  return x;\n}\n", "import exponent from \"./exponent.js\";\nimport formatGroup from \"./formatGroup.js\";\nimport formatNumerals from \"./formatNumerals.js\";\nimport formatSpecifier from \"./formatSpecifier.js\";\nimport formatTrim from \"./formatTrim.js\";\nimport formatTypes from \"./formatTypes.js\";\nimport {prefixExponent} from \"./formatPrefixAuto.js\";\nimport identity from \"./identity.js\";\n\nvar map = Array.prototype.map,\n    prefixes = [\"y\",\"z\",\"a\",\"f\",\"p\",\"n\",\"\u00B5\",\"m\",\"\",\"k\",\"M\",\"G\",\"T\",\"P\",\"E\",\"Z\",\"Y\"];\n\nexport default function(locale) {\n  var group = locale.grouping === undefined || locale.thousands === undefined ? identity : formatGroup(map.call(locale.grouping, Number), locale.thousands + \"\"),\n      currencyPrefix = locale.currency === undefined ? \"\" : locale.currency[0] + \"\",\n      currencySuffix = locale.currency === undefined ? \"\" : locale.currency[1] + \"\",\n      decimal = locale.decimal === undefined ? \".\" : locale.decimal + \"\",\n      numerals = locale.numerals === undefined ? identity : formatNumerals(map.call(locale.numerals, String)),\n      percent = locale.percent === undefined ? \"%\" : locale.percent + \"\",\n      minus = locale.minus === undefined ? \"\u2212\" : locale.minus + \"\",\n      nan = locale.nan === undefined ? \"NaN\" : locale.nan + \"\";\n\n  function newFormat(specifier) {\n    specifier = formatSpecifier(specifier);\n\n    var fill = specifier.fill,\n        align = specifier.align,\n        sign = specifier.sign,\n        symbol = specifier.symbol,\n        zero = specifier.zero,\n        width = specifier.width,\n        comma = specifier.comma,\n        precision = specifier.precision,\n        trim = specifier.trim,\n        type = specifier.type;\n\n    // The \"n\" type is an alias for \",g\".\n    if (type === \"n\") comma = true, type = \"g\";\n\n    // The \"\" type, and any invalid type, is an alias for \".12~g\".\n    else if (!formatTypes[type]) precision === undefined && (precision = 12), trim = true, type = \"g\";\n\n    // If zero fill is specified, padding goes after sign and before digits.\n    if (zero || (fill === \"0\" && align === \"=\")) zero = true, fill = \"0\", align = \"=\";\n\n    // Compute the prefix and suffix.\n    // For SI-prefix, the suffix is lazily computed.\n    var prefix = symbol === \"$\" ? currencyPrefix : symbol === \"#\" && /[boxX]/.test(type) ? \"0\" + type.toLowerCase() : \"\",\n        suffix = symbol === \"$\" ? currencySuffix : /[%p]/.test(type) ? percent : \"\";\n\n    // What format function should we use?\n    // Is this an integer type?\n    // Can this type generate exponential notation?\n    var formatType = formatTypes[type],\n        maybeSuffix = /[defgprs%]/.test(type);\n\n    // Set the default precision if not specified,\n    // or clamp the specified precision to the supported range.\n    // For significant precision, it must be in [1, 21].\n    // For fixed precision, it must be in [0, 20].\n    precision = precision === undefined ? 6\n        : /[gprs]/.test(type) ? Math.max(1, Math.min(21, precision))\n        : Math.max(0, Math.min(20, precision));\n\n    function format(value) {\n      var valuePrefix = prefix,\n          valueSuffix = suffix,\n          i, n, c;\n\n      if (type === \"c\") {\n        valueSuffix = formatType(value) + valueSuffix;\n        value = \"\";\n      } else {\n        value = +value;\n\n        // Determine the sign. -0 is not less than 0, but 1 / -0 is!\n        var valueNegative = value < 0 || 1 / value < 0;\n\n        // Perform the initial formatting.\n        value = isNaN(value) ? nan : formatType(Math.abs(value), precision);\n\n        // Trim insignificant zeros.\n        if (trim) value = formatTrim(value);\n\n        // If a negative value rounds to zero after formatting, and no explicit positive sign is requested, hide the sign.\n        if (valueNegative && +value === 0 && sign !== \"+\") valueNegative = false;\n\n        // Compute the prefix and suffix.\n        valuePrefix = (valueNegative ? (sign === \"(\" ? sign : minus) : sign === \"-\" || sign === \"(\" ? \"\" : sign) + valuePrefix;\n        valueSuffix = (type === \"s\" ? prefixes[8 + prefixExponent / 3] : \"\") + valueSuffix + (valueNegative && sign === \"(\" ? \")\" : \"\");\n\n        // Break the formatted value into the integer \u201Cvalue\u201D part that can be\n        // grouped, and fractional or exponential \u201Csuffix\u201D part that is not.\n        if (maybeSuffix) {\n          i = -1, n = value.length;\n          while (++i < n) {\n            if (c = value.charCodeAt(i), 48 > c || c > 57) {\n              valueSuffix = (c === 46 ? decimal + value.slice(i + 1) : value.slice(i)) + valueSuffix;\n              value = value.slice(0, i);\n              break;\n            }\n          }\n        }\n      }\n\n      // If the fill character is not \"0\", grouping is applied before padding.\n      if (comma && !zero) value = group(value, Infinity);\n\n      // Compute the padding.\n      var length = valuePrefix.length + value.length + valueSuffix.length,\n          padding = length < width ? new Array(width - length + 1).join(fill) : \"\";\n\n      // If the fill character is \"0\", grouping is applied after padding.\n      if (comma && zero) value = group(padding + value, padding.length ? width - valueSuffix.length : Infinity), padding = \"\";\n\n      // Reconstruct the final output based on the desired alignment.\n      switch (align) {\n        case \"<\": value = valuePrefix + value + valueSuffix + padding; break;\n        case \"=\": value = valuePrefix + padding + value + valueSuffix; break;\n        case \"^\": value = padding.slice(0, length = padding.length >> 1) + valuePrefix + value + valueSuffix + padding.slice(length); break;\n        default: value = padding + valuePrefix + value + valueSuffix; break;\n      }\n\n      return numerals(value);\n    }\n\n    format.toString = function() {\n      return specifier + \"\";\n    };\n\n    return format;\n  }\n\n  function formatPrefix(specifier, value) {\n    var f = newFormat((specifier = formatSpecifier(specifier), specifier.type = \"f\", specifier)),\n        e = Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3,\n        k = Math.pow(10, -e),\n        prefix = prefixes[8 + e / 3];\n    return function(value) {\n      return f(k * value) + prefix;\n    };\n  }\n\n  return {\n    format: newFormat,\n    formatPrefix: formatPrefix\n  };\n}\n", "import formatLocale from \"./locale.js\";\n\nvar locale;\nexport var format;\nexport var formatPrefix;\n\ndefaultLocale({\n  thousands: \",\",\n  grouping: [3],\n  currency: [\"$\", \"\"]\n});\n\nexport default function defaultLocale(definition) {\n  locale = formatLocale(definition);\n  format = locale.format;\n  formatPrefix = locale.formatPrefix;\n  return locale;\n}\n", "import exponent from \"./exponent.js\";\n\nexport default function(step) {\n  return Math.max(0, -exponent(Math.abs(step)));\n}\n", "import exponent from \"./exponent.js\";\n\nexport default function(step, value) {\n  return Math.max(0, Math.max(-8, Math.min(8, Math.floor(exponent(value) / 3))) * 3 - exponent(Math.abs(step)));\n}\n", "import exponent from \"./exponent.js\";\n\nexport default function(step, max) {\n  step = Math.abs(step), max = Math.abs(max) - step;\n  return Math.max(0, exponent(max) - exponent(step)) + 1;\n}\n", "import {tickStep} from \"d3-array\";\nimport {format, formatPrefix, formatSpecifier, precisionFixed, precisionPrefix, precisionRound} from \"d3-format\";\n\nexport default function tickFormat(start, stop, count, specifier) {\n  var step = tickStep(start, stop, count),\n      precision;\n  specifier = formatSpecifier(specifier == null ? \",f\" : specifier);\n  switch (specifier.type) {\n    case \"s\": {\n      var value = Math.max(Math.abs(start), Math.abs(stop));\n      if (specifier.precision == null && !isNaN(precision = precisionPrefix(step, value))) specifier.precision = precision;\n      return formatPrefix(specifier, value);\n    }\n    case \"\":\n    case \"e\":\n    case \"g\":\n    case \"p\":\n    case \"r\": {\n      if (specifier.precision == null && !isNaN(precision = precisionRound(step, Math.max(Math.abs(start), Math.abs(stop))))) specifier.precision = precision - (specifier.type === \"e\");\n      break;\n    }\n    case \"f\":\n    case \"%\": {\n      if (specifier.precision == null && !isNaN(precision = precisionFixed(step))) specifier.precision = precision - (specifier.type === \"%\") * 2;\n      break;\n    }\n  }\n  return format(specifier);\n}\n", "import {ticks, tickIncrement} from \"d3-array\";\nimport continuous, {copy} from \"./continuous.js\";\nimport {initRange} from \"./init.js\";\nimport tickFormat from \"./tickFormat.js\";\n\nexport function linearish(scale) {\n  var domain = scale.domain;\n\n  scale.ticks = function(count) {\n    var d = domain();\n    return ticks(d[0], d[d.length - 1], count == null ? 10 : count);\n  };\n\n  scale.tickFormat = function(count, specifier) {\n    var d = domain();\n    return tickFormat(d[0], d[d.length - 1], count == null ? 10 : count, specifier);\n  };\n\n  scale.nice = function(count) {\n    if (count == null) count = 10;\n\n    var d = domain();\n    var i0 = 0;\n    var i1 = d.length - 1;\n    var start = d[i0];\n    var stop = d[i1];\n    var prestep;\n    var step;\n    var maxIter = 10;\n\n    if (stop < start) {\n      step = start, start = stop, stop = step;\n      step = i0, i0 = i1, i1 = step;\n    }\n    \n    while (maxIter-- > 0) {\n      step = tickIncrement(start, stop, count);\n      if (step === prestep) {\n        d[i0] = start\n        d[i1] = stop\n        return domain(d);\n      } else if (step > 0) {\n        start = Math.floor(start / step) * step;\n        stop = Math.ceil(stop / step) * step;\n      } else if (step < 0) {\n        start = Math.ceil(start * step) / step;\n        stop = Math.floor(stop * step) / step;\n      } else {\n        break;\n      }\n      prestep = step;\n    }\n\n    return scale;\n  };\n\n  return scale;\n}\n\nexport default function linear() {\n  var scale = continuous();\n\n  scale.copy = function() {\n    return copy(scale, linear());\n  };\n\n  initRange.apply(scale, arguments);\n\n  return linearish(scale);\n}\n", "export default function nice(domain, interval) {\n  domain = domain.slice();\n\n  var i0 = 0,\n      i1 = domain.length - 1,\n      x0 = domain[i0],\n      x1 = domain[i1],\n      t;\n\n  if (x1 < x0) {\n    t = i0, i0 = i1, i1 = t;\n    t = x0, x0 = x1, x1 = t;\n  }\n\n  domain[i0] = interval.floor(x0);\n  domain[i1] = interval.ceil(x1);\n  return domain;\n}\n", "const t0 = new Date, t1 = new Date;\n\nexport function timeInterval(floori, offseti, count, field) {\n\n  function interval(date) {\n    return floori(date = arguments.length === 0 ? new Date : new Date(+date)), date;\n  }\n\n  interval.floor = (date) => {\n    return floori(date = new Date(+date)), date;\n  };\n\n  interval.ceil = (date) => {\n    return floori(date = new Date(date - 1)), offseti(date, 1), floori(date), date;\n  };\n\n  interval.round = (date) => {\n    const d0 = interval(date), d1 = interval.ceil(date);\n    return date - d0 < d1 - date ? d0 : d1;\n  };\n\n  interval.offset = (date, step) => {\n    return offseti(date = new Date(+date), step == null ? 1 : Math.floor(step)), date;\n  };\n\n  interval.range = (start, stop, step) => {\n    const range = [];\n    start = interval.ceil(start);\n    step = step == null ? 1 : Math.floor(step);\n    if (!(start < stop) || !(step > 0)) return range; // also handles Invalid Date\n    let previous;\n    do range.push(previous = new Date(+start)), offseti(start, step), floori(start);\n    while (previous < start && start < stop);\n    return range;\n  };\n\n  interval.filter = (test) => {\n    return timeInterval((date) => {\n      if (date >= date) while (floori(date), !test(date)) date.setTime(date - 1);\n    }, (date, step) => {\n      if (date >= date) {\n        if (step < 0) while (++step <= 0) {\n          while (offseti(date, -1), !test(date)) {} // eslint-disable-line no-empty\n        } else while (--step >= 0) {\n          while (offseti(date, +1), !test(date)) {} // eslint-disable-line no-empty\n        }\n      }\n    });\n  };\n\n  if (count) {\n    interval.count = (start, end) => {\n      t0.setTime(+start), t1.setTime(+end);\n      floori(t0), floori(t1);\n      return Math.floor(count(t0, t1));\n    };\n\n    interval.every = (step) => {\n      step = Math.floor(step);\n      return !isFinite(step) || !(step > 0) ? null\n          : !(step > 1) ? interval\n          : interval.filter(field\n              ? (d) => field(d) % step === 0\n              : (d) => interval.count(0, d) % step === 0);\n    };\n  }\n\n  return interval;\n}\n", "import {timeInterval} from \"./interval.js\";\n\nexport const millisecond = timeInterval(() => {\n  // noop\n}, (date, step) => {\n  date.setTime(+date + step);\n}, (start, end) => {\n  return end - start;\n});\n\n// An optimized implementation for this simple case.\nmillisecond.every = (k) => {\n  k = Math.floor(k);\n  if (!isFinite(k) || !(k > 0)) return null;\n  if (!(k > 1)) return millisecond;\n  return timeInterval((date) => {\n    date.setTime(Math.floor(date / k) * k);\n  }, (date, step) => {\n    date.setTime(+date + step * k);\n  }, (start, end) => {\n    return (end - start) / k;\n  });\n};\n\nexport const milliseconds = millisecond.range;\n", "export const durationSecond = 1000;\nexport const durationMinute = durationSecond * 60;\nexport const durationHour = durationMinute * 60;\nexport const durationDay = durationHour * 24;\nexport const durationWeek = durationDay * 7;\nexport const durationMonth = durationDay * 30;\nexport const durationYear = durationDay * 365;\n", "import {timeInterval} from \"./interval.js\";\nimport {durationSecond} from \"./duration.js\";\n\nexport const second = timeInterval((date) => {\n  date.setTime(date - date.getMilliseconds());\n}, (date, step) => {\n  date.setTime(+date + step * durationSecond);\n}, (start, end) => {\n  return (end - start) / durationSecond;\n}, (date) => {\n  return date.getUTCSeconds();\n});\n\nexport const seconds = second.range;\n", "import {timeInterval} from \"./interval.js\";\nimport {durationMinute, durationSecond} from \"./duration.js\";\n\nexport const timeMinute = timeInterval((date) => {\n  date.setTime(date - date.getMilliseconds() - date.getSeconds() * durationSecond);\n}, (date, step) => {\n  date.setTime(+date + step * durationMinute);\n}, (start, end) => {\n  return (end - start) / durationMinute;\n}, (date) => {\n  return date.getMinutes();\n});\n\nexport const timeMinutes = timeMinute.range;\n\nexport const utcMinute = timeInterval((date) => {\n  date.setUTCSeconds(0, 0);\n}, (date, step) => {\n  date.setTime(+date + step * durationMinute);\n}, (start, end) => {\n  return (end - start) / durationMinute;\n}, (date) => {\n  return date.getUTCMinutes();\n});\n\nexport const utcMinutes = utcMinute.range;\n", "import {timeInterval} from \"./interval.js\";\nimport {durationHour, durationMinute, durationSecond} from \"./duration.js\";\n\nexport const timeHour = timeInterval((date) => {\n  date.setTime(date - date.getMilliseconds() - date.getSeconds() * durationSecond - date.getMinutes() * durationMinute);\n}, (date, step) => {\n  date.setTime(+date + step * durationHour);\n}, (start, end) => {\n  return (end - start) / durationHour;\n}, (date) => {\n  return date.getHours();\n});\n\nexport const timeHours = timeHour.range;\n\nexport const utcHour = timeInterval((date) => {\n  date.setUTCMinutes(0, 0, 0);\n}, (date, step) => {\n  date.setTime(+date + step * durationHour);\n}, (start, end) => {\n  return (end - start) / durationHour;\n}, (date) => {\n  return date.getUTCHours();\n});\n\nexport const utcHours = utcHour.range;\n", "import {timeInterval} from \"./interval.js\";\nimport {durationDay, durationMinute} from \"./duration.js\";\n\nexport const timeDay = timeInterval(\n  date => date.setHours(0, 0, 0, 0),\n  (date, step) => date.setDate(date.getDate() + step),\n  (start, end) => (end - start - (end.getTimezoneOffset() - start.getTimezoneOffset()) * durationMinute) / durationDay,\n  date => date.getDate() - 1\n);\n\nexport const timeDays = timeDay.range;\n\nexport const utcDay = timeInterval((date) => {\n  date.setUTCHours(0, 0, 0, 0);\n}, (date, step) => {\n  date.setUTCDate(date.getUTCDate() + step);\n}, (start, end) => {\n  return (end - start) / durationDay;\n}, (date) => {\n  return date.getUTCDate() - 1;\n});\n\nexport const utcDays = utcDay.range;\n\nexport const unixDay = timeInterval((date) => {\n  date.setUTCHours(0, 0, 0, 0);\n}, (date, step) => {\n  date.setUTCDate(date.getUTCDate() + step);\n}, (start, end) => {\n  return (end - start) / durationDay;\n}, (date) => {\n  return Math.floor(date / durationDay);\n});\n\nexport const unixDays = unixDay.range;\n", "import {timeInterval} from \"./interval.js\";\nimport {durationMinute, durationWeek} from \"./duration.js\";\n\nfunction timeWeekday(i) {\n  return timeInterval((date) => {\n    date.setDate(date.getDate() - (date.getDay() + 7 - i) % 7);\n    date.setHours(0, 0, 0, 0);\n  }, (date, step) => {\n    date.setDate(date.getDate() + step * 7);\n  }, (start, end) => {\n    return (end - start - (end.getTimezoneOffset() - start.getTimezoneOffset()) * durationMinute) / durationWeek;\n  });\n}\n\nexport const timeSunday = timeWeekday(0);\nexport const timeMonday = timeWeekday(1);\nexport const timeTuesday = timeWeekday(2);\nexport const timeWednesday = timeWeekday(3);\nexport const timeThursday = timeWeekday(4);\nexport const timeFriday = timeWeekday(5);\nexport const timeSaturday = timeWeekday(6);\n\nexport const timeSundays = timeSunday.range;\nexport const timeMondays = timeMonday.range;\nexport const timeTuesdays = timeTuesday.range;\nexport const timeWednesdays = timeWednesday.range;\nexport const timeThursdays = timeThursday.range;\nexport const timeFridays = timeFriday.range;\nexport const timeSaturdays = timeSaturday.range;\n\nfunction utcWeekday(i) {\n  return timeInterval((date) => {\n    date.setUTCDate(date.getUTCDate() - (date.getUTCDay() + 7 - i) % 7);\n    date.setUTCHours(0, 0, 0, 0);\n  }, (date, step) => {\n    date.setUTCDate(date.getUTCDate() + step * 7);\n  }, (start, end) => {\n    return (end - start) / durationWeek;\n  });\n}\n\nexport const utcSunday = utcWeekday(0);\nexport const utcMonday = utcWeekday(1);\nexport const utcTuesday = utcWeekday(2);\nexport const utcWednesday = utcWeekday(3);\nexport const utcThursday = utcWeekday(4);\nexport const utcFriday = utcWeekday(5);\nexport const utcSaturday = utcWeekday(6);\n\nexport const utcSundays = utcSunday.range;\nexport const utcMondays = utcMonday.range;\nexport const utcTuesdays = utcTuesday.range;\nexport const utcWednesdays = utcWednesday.range;\nexport const utcThursdays = utcThursday.range;\nexport const utcFridays = utcFriday.range;\nexport const utcSaturdays = utcSaturday.range;\n", "import {timeInterval} from \"./interval.js\";\n\nexport const timeMonth = timeInterval((date) => {\n  date.setDate(1);\n  date.setHours(0, 0, 0, 0);\n}, (date, step) => {\n  date.setMonth(date.getMonth() + step);\n}, (start, end) => {\n  return end.getMonth() - start.getMonth() + (end.getFullYear() - start.getFullYear()) * 12;\n}, (date) => {\n  return date.getMonth();\n});\n\nexport const timeMonths = timeMonth.range;\n\nexport const utcMonth = timeInterval((date) => {\n  date.setUTCDate(1);\n  date.setUTCHours(0, 0, 0, 0);\n}, (date, step) => {\n  date.setUTCMonth(date.getUTCMonth() + step);\n}, (start, end) => {\n  return end.getUTCMonth() - start.getUTCMonth() + (end.getUTCFullYear() - start.getUTCFullYear()) * 12;\n}, (date) => {\n  return date.getUTCMonth();\n});\n\nexport const utcMonths = utcMonth.range;\n", "import {timeInterval} from \"./interval.js\";\n\nexport const timeYear = timeInterval((date) => {\n  date.setMonth(0, 1);\n  date.setHours(0, 0, 0, 0);\n}, (date, step) => {\n  date.setFullYear(date.getFullYear() + step);\n}, (start, end) => {\n  return end.getFullYear() - start.getFullYear();\n}, (date) => {\n  return date.getFullYear();\n});\n\n// An optimized implementation for this simple case.\ntimeYear.every = (k) => {\n  return !isFinite(k = Math.floor(k)) || !(k > 0) ? null : timeInterval((date) => {\n    date.setFullYear(Math.floor(date.getFullYear() / k) * k);\n    date.setMonth(0, 1);\n    date.setHours(0, 0, 0, 0);\n  }, (date, step) => {\n    date.setFullYear(date.getFullYear() + step * k);\n  });\n};\n\nexport const timeYears = timeYear.range;\n\nexport const utcYear = timeInterval((date) => {\n  date.setUTCMonth(0, 1);\n  date.setUTCHours(0, 0, 0, 0);\n}, (date, step) => {\n  date.setUTCFullYear(date.getUTCFullYear() + step);\n}, (start, end) => {\n  return end.getUTCFullYear() - start.getUTCFullYear();\n}, (date) => {\n  return date.getUTCFullYear();\n});\n\n// An optimized implementation for this simple case.\nutcYear.every = (k) => {\n  return !isFinite(k = Math.floor(k)) || !(k > 0) ? null : timeInterval((date) => {\n    date.setUTCFullYear(Math.floor(date.getUTCFullYear() / k) * k);\n    date.setUTCMonth(0, 1);\n    date.setUTCHours(0, 0, 0, 0);\n  }, (date, step) => {\n    date.setUTCFullYear(date.getUTCFullYear() + step * k);\n  });\n};\n\nexport const utcYears = utcYear.range;\n", "import {bisector, tickStep} from \"d3-array\";\nimport {durationDay, durationHour, durationMinute, durationMonth, durationSecond, durationWeek, durationYear} from \"./duration.js\";\nimport {millisecond} from \"./millisecond.js\";\nimport {second} from \"./second.js\";\nimport {timeMinute, utcMinute} from \"./minute.js\";\nimport {timeHour, utcHour} from \"./hour.js\";\nimport {timeDay, unixDay} from \"./day.js\";\nimport {timeSunday, utcSunday} from \"./week.js\";\nimport {timeMonth, utcMonth} from \"./month.js\";\nimport {timeYear, utcYear} from \"./year.js\";\n\nfunction ticker(year, month, week, day, hour, minute) {\n\n  const tickIntervals = [\n    [second,  1,      durationSecond],\n    [second,  5,  5 * durationSecond],\n    [second, 15, 15 * durationSecond],\n    [second, 30, 30 * durationSecond],\n    [minute,  1,      durationMinute],\n    [minute,  5,  5 * durationMinute],\n    [minute, 15, 15 * durationMinute],\n    [minute, 30, 30 * durationMinute],\n    [  hour,  1,      durationHour  ],\n    [  hour,  3,  3 * durationHour  ],\n    [  hour,  6,  6 * durationHour  ],\n    [  hour, 12, 12 * durationHour  ],\n    [   day,  1,      durationDay   ],\n    [   day,  2,  2 * durationDay   ],\n    [  week,  1,      durationWeek  ],\n    [ month,  1,      durationMonth ],\n    [ month,  3,  3 * durationMonth ],\n    [  year,  1,      durationYear  ]\n  ];\n\n  function ticks(start, stop, count) {\n    const reverse = stop < start;\n    if (reverse) [start, stop] = [stop, start];\n    const interval = count && typeof count.range === \"function\" ? count : tickInterval(start, stop, count);\n    const ticks = interval ? interval.range(start, +stop + 1) : []; // inclusive stop\n    return reverse ? ticks.reverse() : ticks;\n  }\n\n  function tickInterval(start, stop, count) {\n    const target = Math.abs(stop - start) / count;\n    const i = bisector(([,, step]) => step).right(tickIntervals, target);\n    if (i === tickIntervals.length) return year.every(tickStep(start / durationYear, stop / durationYear, count));\n    if (i === 0) return millisecond.every(Math.max(tickStep(start, stop, count), 1));\n    const [t, step] = tickIntervals[target / tickIntervals[i - 1][2] < tickIntervals[i][2] / target ? i - 1 : i];\n    return t.every(step);\n  }\n\n  return [ticks, tickInterval];\n}\n\nconst [utcTicks, utcTickInterval] = ticker(utcYear, utcMonth, utcSunday, unixDay, utcHour, utcMinute);\nconst [timeTicks, timeTickInterval] = ticker(timeYear, timeMonth, timeSunday, timeDay, timeHour, timeMinute);\n\nexport {utcTicks, utcTickInterval, timeTicks, timeTickInterval};\n", "import {\n  timeDay,\n  timeSunday,\n  timeMonday,\n  timeThursday,\n  timeYear,\n  utcDay,\n  utcSunday,\n  utcMonday,\n  utcThursday,\n  utcYear\n} from \"d3-time\";\n\nfunction localDate(d) {\n  if (0 <= d.y && d.y < 100) {\n    var date = new Date(-1, d.m, d.d, d.H, d.M, d.S, d.L);\n    date.setFullYear(d.y);\n    return date;\n  }\n  return new Date(d.y, d.m, d.d, d.H, d.M, d.S, d.L);\n}\n\nfunction utcDate(d) {\n  if (0 <= d.y && d.y < 100) {\n    var date = new Date(Date.UTC(-1, d.m, d.d, d.H, d.M, d.S, d.L));\n    date.setUTCFullYear(d.y);\n    return date;\n  }\n  return new Date(Date.UTC(d.y, d.m, d.d, d.H, d.M, d.S, d.L));\n}\n\nfunction newDate(y, m, d) {\n  return {y: y, m: m, d: d, H: 0, M: 0, S: 0, L: 0};\n}\n\nexport default function formatLocale(locale) {\n  var locale_dateTime = locale.dateTime,\n      locale_date = locale.date,\n      locale_time = locale.time,\n      locale_periods = locale.periods,\n      locale_weekdays = locale.days,\n      locale_shortWeekdays = locale.shortDays,\n      locale_months = locale.months,\n      locale_shortMonths = locale.shortMonths;\n\n  var periodRe = formatRe(locale_periods),\n      periodLookup = formatLookup(locale_periods),\n      weekdayRe = formatRe(locale_weekdays),\n      weekdayLookup = formatLookup(locale_weekdays),\n      shortWeekdayRe = formatRe(locale_shortWeekdays),\n      shortWeekdayLookup = formatLookup(locale_shortWeekdays),\n      monthRe = formatRe(locale_months),\n      monthLookup = formatLookup(locale_months),\n      shortMonthRe = formatRe(locale_shortMonths),\n      shortMonthLookup = formatLookup(locale_shortMonths);\n\n  var formats = {\n    \"a\": formatShortWeekday,\n    \"A\": formatWeekday,\n    \"b\": formatShortMonth,\n    \"B\": formatMonth,\n    \"c\": null,\n    \"d\": formatDayOfMonth,\n    \"e\": formatDayOfMonth,\n    \"f\": formatMicroseconds,\n    \"g\": formatYearISO,\n    \"G\": formatFullYearISO,\n    \"H\": formatHour24,\n    \"I\": formatHour12,\n    \"j\": formatDayOfYear,\n    \"L\": formatMilliseconds,\n    \"m\": formatMonthNumber,\n    \"M\": formatMinutes,\n    \"p\": formatPeriod,\n    \"q\": formatQuarter,\n    \"Q\": formatUnixTimestamp,\n    \"s\": formatUnixTimestampSeconds,\n    \"S\": formatSeconds,\n    \"u\": formatWeekdayNumberMonday,\n    \"U\": formatWeekNumberSunday,\n    \"V\": formatWeekNumberISO,\n    \"w\": formatWeekdayNumberSunday,\n    \"W\": formatWeekNumberMonday,\n    \"x\": null,\n    \"X\": null,\n    \"y\": formatYear,\n    \"Y\": formatFullYear,\n    \"Z\": formatZone,\n    \"%\": formatLiteralPercent\n  };\n\n  var utcFormats = {\n    \"a\": formatUTCShortWeekday,\n    \"A\": formatUTCWeekday,\n    \"b\": formatUTCShortMonth,\n    \"B\": formatUTCMonth,\n    \"c\": null,\n    \"d\": formatUTCDayOfMonth,\n    \"e\": formatUTCDayOfMonth,\n    \"f\": formatUTCMicroseconds,\n    \"g\": formatUTCYearISO,\n    \"G\": formatUTCFullYearISO,\n    \"H\": formatUTCHour24,\n    \"I\": formatUTCHour12,\n    \"j\": formatUTCDayOfYear,\n    \"L\": formatUTCMilliseconds,\n    \"m\": formatUTCMonthNumber,\n    \"M\": formatUTCMinutes,\n    \"p\": formatUTCPeriod,\n    \"q\": formatUTCQuarter,\n    \"Q\": formatUnixTimestamp,\n    \"s\": formatUnixTimestampSeconds,\n    \"S\": formatUTCSeconds,\n    \"u\": formatUTCWeekdayNumberMonday,\n    \"U\": formatUTCWeekNumberSunday,\n    \"V\": formatUTCWeekNumberISO,\n    \"w\": formatUTCWeekdayNumberSunday,\n    \"W\": formatUTCWeekNumberMonday,\n    \"x\": null,\n    \"X\": null,\n    \"y\": formatUTCYear,\n    \"Y\": formatUTCFullYear,\n    \"Z\": formatUTCZone,\n    \"%\": formatLiteralPercent\n  };\n\n  var parses = {\n    \"a\": parseShortWeekday,\n    \"A\": parseWeekday,\n    \"b\": parseShortMonth,\n    \"B\": parseMonth,\n    \"c\": parseLocaleDateTime,\n    \"d\": parseDayOfMonth,\n    \"e\": parseDayOfMonth,\n    \"f\": parseMicroseconds,\n    \"g\": parseYear,\n    \"G\": parseFullYear,\n    \"H\": parseHour24,\n    \"I\": parseHour24,\n    \"j\": parseDayOfYear,\n    \"L\": parseMilliseconds,\n    \"m\": parseMonthNumber,\n    \"M\": parseMinutes,\n    \"p\": parsePeriod,\n    \"q\": parseQuarter,\n    \"Q\": parseUnixTimestamp,\n    \"s\": parseUnixTimestampSeconds,\n    \"S\": parseSeconds,\n    \"u\": parseWeekdayNumberMonday,\n    \"U\": parseWeekNumberSunday,\n    \"V\": parseWeekNumberISO,\n    \"w\": parseWeekdayNumberSunday,\n    \"W\": parseWeekNumberMonday,\n    \"x\": parseLocaleDate,\n    \"X\": parseLocaleTime,\n    \"y\": parseYear,\n    \"Y\": parseFullYear,\n    \"Z\": parseZone,\n    \"%\": parseLiteralPercent\n  };\n\n  // These recursive directive definitions must be deferred.\n  formats.x = newFormat(locale_date, formats);\n  formats.X = newFormat(locale_time, formats);\n  formats.c = newFormat(locale_dateTime, formats);\n  utcFormats.x = newFormat(locale_date, utcFormats);\n  utcFormats.X = newFormat(locale_time, utcFormats);\n  utcFormats.c = newFormat(locale_dateTime, utcFormats);\n\n  function newFormat(specifier, formats) {\n    return function(date) {\n      var string = [],\n          i = -1,\n          j = 0,\n          n = specifier.length,\n          c,\n          pad,\n          format;\n\n      if (!(date instanceof Date)) date = new Date(+date);\n\n      while (++i < n) {\n        if (specifier.charCodeAt(i) === 37) {\n          string.push(specifier.slice(j, i));\n          if ((pad = pads[c = specifier.charAt(++i)]) != null) c = specifier.charAt(++i);\n          else pad = c === \"e\" ? \" \" : \"0\";\n          if (format = formats[c]) c = format(date, pad);\n          string.push(c);\n          j = i + 1;\n        }\n      }\n\n      string.push(specifier.slice(j, i));\n      return string.join(\"\");\n    };\n  }\n\n  function newParse(specifier, Z) {\n    return function(string) {\n      var d = newDate(1900, undefined, 1),\n          i = parseSpecifier(d, specifier, string += \"\", 0),\n          week, day;\n      if (i != string.length) return null;\n\n      // If a UNIX timestamp is specified, return it.\n      if (\"Q\" in d) return new Date(d.Q);\n      if (\"s\" in d) return new Date(d.s * 1000 + (\"L\" in d ? d.L : 0));\n\n      // If this is utcParse, never use the local timezone.\n      if (Z && !(\"Z\" in d)) d.Z = 0;\n\n      // The am-pm flag is 0 for AM, and 1 for PM.\n      if (\"p\" in d) d.H = d.H % 12 + d.p * 12;\n\n      // If the month was not specified, inherit from the quarter.\n      if (d.m === undefined) d.m = \"q\" in d ? d.q : 0;\n\n      // Convert day-of-week and week-of-year to day-of-year.\n      if (\"V\" in d) {\n        if (d.V < 1 || d.V > 53) return null;\n        if (!(\"w\" in d)) d.w = 1;\n        if (\"Z\" in d) {\n          week = utcDate(newDate(d.y, 0, 1)), day = week.getUTCDay();\n          week = day > 4 || day === 0 ? utcMonday.ceil(week) : utcMonday(week);\n          week = utcDay.offset(week, (d.V - 1) * 7);\n          d.y = week.getUTCFullYear();\n          d.m = week.getUTCMonth();\n          d.d = week.getUTCDate() + (d.w + 6) % 7;\n        } else {\n          week = localDate(newDate(d.y, 0, 1)), day = week.getDay();\n          week = day > 4 || day === 0 ? timeMonday.ceil(week) : timeMonday(week);\n          week = timeDay.offset(week, (d.V - 1) * 7);\n          d.y = week.getFullYear();\n          d.m = week.getMonth();\n          d.d = week.getDate() + (d.w + 6) % 7;\n        }\n      } else if (\"W\" in d || \"U\" in d) {\n        if (!(\"w\" in d)) d.w = \"u\" in d ? d.u % 7 : \"W\" in d ? 1 : 0;\n        day = \"Z\" in d ? utcDate(newDate(d.y, 0, 1)).getUTCDay() : localDate(newDate(d.y, 0, 1)).getDay();\n        d.m = 0;\n        d.d = \"W\" in d ? (d.w + 6) % 7 + d.W * 7 - (day + 5) % 7 : d.w + d.U * 7 - (day + 6) % 7;\n      }\n\n      // If a time zone is specified, all fields are interpreted as UTC and then\n      // offset according to the specified time zone.\n      if (\"Z\" in d) {\n        d.H += d.Z / 100 | 0;\n        d.M += d.Z % 100;\n        return utcDate(d);\n      }\n\n      // Otherwise, all fields are in local time.\n      return localDate(d);\n    };\n  }\n\n  function parseSpecifier(d, specifier, string, j) {\n    var i = 0,\n        n = specifier.length,\n        m = string.length,\n        c,\n        parse;\n\n    while (i < n) {\n      if (j >= m) return -1;\n      c = specifier.charCodeAt(i++);\n      if (c === 37) {\n        c = specifier.charAt(i++);\n        parse = parses[c in pads ? specifier.charAt(i++) : c];\n        if (!parse || ((j = parse(d, string, j)) < 0)) return -1;\n      } else if (c != string.charCodeAt(j++)) {\n        return -1;\n      }\n    }\n\n    return j;\n  }\n\n  function parsePeriod(d, string, i) {\n    var n = periodRe.exec(string.slice(i));\n    return n ? (d.p = periodLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;\n  }\n\n  function parseShortWeekday(d, string, i) {\n    var n = shortWeekdayRe.exec(string.slice(i));\n    return n ? (d.w = shortWeekdayLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;\n  }\n\n  function parseWeekday(d, string, i) {\n    var n = weekdayRe.exec(string.slice(i));\n    return n ? (d.w = weekdayLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;\n  }\n\n  function parseShortMonth(d, string, i) {\n    var n = shortMonthRe.exec(string.slice(i));\n    return n ? (d.m = shortMonthLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;\n  }\n\n  function parseMonth(d, string, i) {\n    var n = monthRe.exec(string.slice(i));\n    return n ? (d.m = monthLookup.get(n[0].toLowerCase()), i + n[0].length) : -1;\n  }\n\n  function parseLocaleDateTime(d, string, i) {\n    return parseSpecifier(d, locale_dateTime, string, i);\n  }\n\n  function parseLocaleDate(d, string, i) {\n    return parseSpecifier(d, locale_date, string, i);\n  }\n\n  function parseLocaleTime(d, string, i) {\n    return parseSpecifier(d, locale_time, string, i);\n  }\n\n  function formatShortWeekday(d) {\n    return locale_shortWeekdays[d.getDay()];\n  }\n\n  function formatWeekday(d) {\n    return locale_weekdays[d.getDay()];\n  }\n\n  function formatShortMonth(d) {\n    return locale_shortMonths[d.getMonth()];\n  }\n\n  function formatMonth(d) {\n    return locale_months[d.getMonth()];\n  }\n\n  function formatPeriod(d) {\n    return locale_periods[+(d.getHours() >= 12)];\n  }\n\n  function formatQuarter(d) {\n    return 1 + ~~(d.getMonth() / 3);\n  }\n\n  function formatUTCShortWeekday(d) {\n    return locale_shortWeekdays[d.getUTCDay()];\n  }\n\n  function formatUTCWeekday(d) {\n    return locale_weekdays[d.getUTCDay()];\n  }\n\n  function formatUTCShortMonth(d) {\n    return locale_shortMonths[d.getUTCMonth()];\n  }\n\n  function formatUTCMonth(d) {\n    return locale_months[d.getUTCMonth()];\n  }\n\n  function formatUTCPeriod(d) {\n    return locale_periods[+(d.getUTCHours() >= 12)];\n  }\n\n  function formatUTCQuarter(d) {\n    return 1 + ~~(d.getUTCMonth() / 3);\n  }\n\n  return {\n    format: function(specifier) {\n      var f = newFormat(specifier += \"\", formats);\n      f.toString = function() { return specifier; };\n      return f;\n    },\n    parse: function(specifier) {\n      var p = newParse(specifier += \"\", false);\n      p.toString = function() { return specifier; };\n      return p;\n    },\n    utcFormat: function(specifier) {\n      var f = newFormat(specifier += \"\", utcFormats);\n      f.toString = function() { return specifier; };\n      return f;\n    },\n    utcParse: function(specifier) {\n      var p = newParse(specifier += \"\", true);\n      p.toString = function() { return specifier; };\n      return p;\n    }\n  };\n}\n\nvar pads = {\"-\": \"\", \"_\": \" \", \"0\": \"0\"},\n    numberRe = /^\\s*\\d+/, // note: ignores next directive\n    percentRe = /^%/,\n    requoteRe = /[\\\\^$*+?|[\\]().{}]/g;\n\nfunction pad(value, fill, width) {\n  var sign = value < 0 ? \"-\" : \"\",\n      string = (sign ? -value : value) + \"\",\n      length = string.length;\n  return sign + (length < width ? new Array(width - length + 1).join(fill) + string : string);\n}\n\nfunction requote(s) {\n  return s.replace(requoteRe, \"\\\\$&\");\n}\n\nfunction formatRe(names) {\n  return new RegExp(\"^(?:\" + names.map(requote).join(\"|\") + \")\", \"i\");\n}\n\nfunction formatLookup(names) {\n  return new Map(names.map((name, i) => [name.toLowerCase(), i]));\n}\n\nfunction parseWeekdayNumberSunday(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 1));\n  return n ? (d.w = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseWeekdayNumberMonday(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 1));\n  return n ? (d.u = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseWeekNumberSunday(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.U = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseWeekNumberISO(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.V = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseWeekNumberMonday(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.W = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseFullYear(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 4));\n  return n ? (d.y = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseYear(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.y = +n[0] + (+n[0] > 68 ? 1900 : 2000), i + n[0].length) : -1;\n}\n\nfunction parseZone(d, string, i) {\n  var n = /^(Z)|([+-]\\d\\d)(?::?(\\d\\d))?/.exec(string.slice(i, i + 6));\n  return n ? (d.Z = n[1] ? 0 : -(n[2] + (n[3] || \"00\")), i + n[0].length) : -1;\n}\n\nfunction parseQuarter(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 1));\n  return n ? (d.q = n[0] * 3 - 3, i + n[0].length) : -1;\n}\n\nfunction parseMonthNumber(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.m = n[0] - 1, i + n[0].length) : -1;\n}\n\nfunction parseDayOfMonth(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.d = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseDayOfYear(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 3));\n  return n ? (d.m = 0, d.d = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseHour24(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.H = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseMinutes(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.M = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseSeconds(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 2));\n  return n ? (d.S = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseMilliseconds(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 3));\n  return n ? (d.L = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseMicroseconds(d, string, i) {\n  var n = numberRe.exec(string.slice(i, i + 6));\n  return n ? (d.L = Math.floor(n[0] / 1000), i + n[0].length) : -1;\n}\n\nfunction parseLiteralPercent(d, string, i) {\n  var n = percentRe.exec(string.slice(i, i + 1));\n  return n ? i + n[0].length : -1;\n}\n\nfunction parseUnixTimestamp(d, string, i) {\n  var n = numberRe.exec(string.slice(i));\n  return n ? (d.Q = +n[0], i + n[0].length) : -1;\n}\n\nfunction parseUnixTimestampSeconds(d, string, i) {\n  var n = numberRe.exec(string.slice(i));\n  return n ? (d.s = +n[0], i + n[0].length) : -1;\n}\n\nfunction formatDayOfMonth(d, p) {\n  return pad(d.getDate(), p, 2);\n}\n\nfunction formatHour24(d, p) {\n  return pad(d.getHours(), p, 2);\n}\n\nfunction formatHour12(d, p) {\n  return pad(d.getHours() % 12 || 12, p, 2);\n}\n\nfunction formatDayOfYear(d, p) {\n  return pad(1 + timeDay.count(timeYear(d), d), p, 3);\n}\n\nfunction formatMilliseconds(d, p) {\n  return pad(d.getMilliseconds(), p, 3);\n}\n\nfunction formatMicroseconds(d, p) {\n  return formatMilliseconds(d, p) + \"000\";\n}\n\nfunction formatMonthNumber(d, p) {\n  return pad(d.getMonth() + 1, p, 2);\n}\n\nfunction formatMinutes(d, p) {\n  return pad(d.getMinutes(), p, 2);\n}\n\nfunction formatSeconds(d, p) {\n  return pad(d.getSeconds(), p, 2);\n}\n\nfunction formatWeekdayNumberMonday(d) {\n  var day = d.getDay();\n  return day === 0 ? 7 : day;\n}\n\nfunction formatWeekNumberSunday(d, p) {\n  return pad(timeSunday.count(timeYear(d) - 1, d), p, 2);\n}\n\nfunction dISO(d) {\n  var day = d.getDay();\n  return (day >= 4 || day === 0) ? timeThursday(d) : timeThursday.ceil(d);\n}\n\nfunction formatWeekNumberISO(d, p) {\n  d = dISO(d);\n  return pad(timeThursday.count(timeYear(d), d) + (timeYear(d).getDay() === 4), p, 2);\n}\n\nfunction formatWeekdayNumberSunday(d) {\n  return d.getDay();\n}\n\nfunction formatWeekNumberMonday(d, p) {\n  return pad(timeMonday.count(timeYear(d) - 1, d), p, 2);\n}\n\nfunction formatYear(d, p) {\n  return pad(d.getFullYear() % 100, p, 2);\n}\n\nfunction formatYearISO(d, p) {\n  d = dISO(d);\n  return pad(d.getFullYear() % 100, p, 2);\n}\n\nfunction formatFullYear(d, p) {\n  return pad(d.getFullYear() % 10000, p, 4);\n}\n\nfunction formatFullYearISO(d, p) {\n  var day = d.getDay();\n  d = (day >= 4 || day === 0) ? timeThursday(d) : timeThursday.ceil(d);\n  return pad(d.getFullYear() % 10000, p, 4);\n}\n\nfunction formatZone(d) {\n  var z = d.getTimezoneOffset();\n  return (z > 0 ? \"-\" : (z *= -1, \"+\"))\n      + pad(z / 60 | 0, \"0\", 2)\n      + pad(z % 60, \"0\", 2);\n}\n\nfunction formatUTCDayOfMonth(d, p) {\n  return pad(d.getUTCDate(), p, 2);\n}\n\nfunction formatUTCHour24(d, p) {\n  return pad(d.getUTCHours(), p, 2);\n}\n\nfunction formatUTCHour12(d, p) {\n  return pad(d.getUTCHours() % 12 || 12, p, 2);\n}\n\nfunction formatUTCDayOfYear(d, p) {\n  return pad(1 + utcDay.count(utcYear(d), d), p, 3);\n}\n\nfunction formatUTCMilliseconds(d, p) {\n  return pad(d.getUTCMilliseconds(), p, 3);\n}\n\nfunction formatUTCMicroseconds(d, p) {\n  return formatUTCMilliseconds(d, p) + \"000\";\n}\n\nfunction formatUTCMonthNumber(d, p) {\n  return pad(d.getUTCMonth() + 1, p, 2);\n}\n\nfunction formatUTCMinutes(d, p) {\n  return pad(d.getUTCMinutes(), p, 2);\n}\n\nfunction formatUTCSeconds(d, p) {\n  return pad(d.getUTCSeconds(), p, 2);\n}\n\nfunction formatUTCWeekdayNumberMonday(d) {\n  var dow = d.getUTCDay();\n  return dow === 0 ? 7 : dow;\n}\n\nfunction formatUTCWeekNumberSunday(d, p) {\n  return pad(utcSunday.count(utcYear(d) - 1, d), p, 2);\n}\n\nfunction UTCdISO(d) {\n  var day = d.getUTCDay();\n  return (day >= 4 || day === 0) ? utcThursday(d) : utcThursday.ceil(d);\n}\n\nfunction formatUTCWeekNumberISO(d, p) {\n  d = UTCdISO(d);\n  return pad(utcThursday.count(utcYear(d), d) + (utcYear(d).getUTCDay() === 4), p, 2);\n}\n\nfunction formatUTCWeekdayNumberSunday(d) {\n  return d.getUTCDay();\n}\n\nfunction formatUTCWeekNumberMonday(d, p) {\n  return pad(utcMonday.count(utcYear(d) - 1, d), p, 2);\n}\n\nfunction formatUTCYear(d, p) {\n  return pad(d.getUTCFullYear() % 100, p, 2);\n}\n\nfunction formatUTCYearISO(d, p) {\n  d = UTCdISO(d);\n  return pad(d.getUTCFullYear() % 100, p, 2);\n}\n\nfunction formatUTCFullYear(d, p) {\n  return pad(d.getUTCFullYear() % 10000, p, 4);\n}\n\nfunction formatUTCFullYearISO(d, p) {\n  var day = d.getUTCDay();\n  d = (day >= 4 || day === 0) ? utcThursday(d) : utcThursday.ceil(d);\n  return pad(d.getUTCFullYear() % 10000, p, 4);\n}\n\nfunction formatUTCZone() {\n  return \"+0000\";\n}\n\nfunction formatLiteralPercent() {\n  return \"%\";\n}\n\nfunction formatUnixTimestamp(d) {\n  return +d;\n}\n\nfunction formatUnixTimestampSeconds(d) {\n  return Math.floor(+d / 1000);\n}\n", "import formatLocale from \"./locale.js\";\n\nvar locale;\nexport var timeFormat;\nexport var timeParse;\nexport var utcFormat;\nexport var utcParse;\n\ndefaultLocale({\n  dateTime: \"%x, %X\",\n  date: \"%-m/%-d/%Y\",\n  time: \"%-I:%M:%S %p\",\n  periods: [\"AM\", \"PM\"],\n  days: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\n  shortDays: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n  months: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\n  shortMonths: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"]\n});\n\nexport default function defaultLocale(definition) {\n  locale = formatLocale(definition);\n  timeFormat = locale.format;\n  timeParse = locale.parse;\n  utcFormat = locale.utcFormat;\n  utcParse = locale.utcParse;\n  return locale;\n}\n", "import {timeYear, timeMonth, timeWeek, timeDay, timeHour, timeMinute, timeSecond, timeTicks, timeTickInterval} from \"d3-time\";\nimport {timeFormat} from \"d3-time-format\";\nimport continuous, {copy} from \"./continuous.js\";\nimport {initRange} from \"./init.js\";\nimport nice from \"./nice.js\";\n\nfunction date(t) {\n  return new Date(t);\n}\n\nfunction number(t) {\n  return t instanceof Date ? +t : +new Date(+t);\n}\n\nexport function calendar(ticks, tickInterval, year, month, week, day, hour, minute, second, format) {\n  var scale = continuous(),\n      invert = scale.invert,\n      domain = scale.domain;\n\n  var formatMillisecond = format(\".%L\"),\n      formatSecond = format(\":%S\"),\n      formatMinute = format(\"%I:%M\"),\n      formatHour = format(\"%I %p\"),\n      formatDay = format(\"%a %d\"),\n      formatWeek = format(\"%b %d\"),\n      formatMonth = format(\"%B\"),\n      formatYear = format(\"%Y\");\n\n  function tickFormat(date) {\n    return (second(date) < date ? formatMillisecond\n        : minute(date) < date ? formatSecond\n        : hour(date) < date ? formatMinute\n        : day(date) < date ? formatHour\n        : month(date) < date ? (week(date) < date ? formatDay : formatWeek)\n        : year(date) < date ? formatMonth\n        : formatYear)(date);\n  }\n\n  scale.invert = function(y) {\n    return new Date(invert(y));\n  };\n\n  scale.domain = function(_) {\n    return arguments.length ? domain(Array.from(_, number)) : domain().map(date);\n  };\n\n  scale.ticks = function(interval) {\n    var d = domain();\n    return ticks(d[0], d[d.length - 1], interval == null ? 10 : interval);\n  };\n\n  scale.tickFormat = function(count, specifier) {\n    return specifier == null ? tickFormat : format(specifier);\n  };\n\n  scale.nice = function(interval) {\n    var d = domain();\n    if (!interval || typeof interval.range !== \"function\") interval = tickInterval(d[0], d[d.length - 1], interval == null ? 10 : interval);\n    return interval ? domain(nice(d, interval)) : scale;\n  };\n\n  scale.copy = function() {\n    return copy(scale, calendar(ticks, tickInterval, year, month, week, day, hour, minute, second, format));\n  };\n\n  return scale;\n}\n\nexport default function time() {\n  return initRange.apply(calendar(timeTicks, timeTickInterval, timeYear, timeMonth, timeWeek, timeDay, timeHour, timeMinute, timeSecond, timeFormat).domain([new Date(2000, 0, 1), new Date(2000, 0, 2)]), arguments);\n}\n", "export default function(x) {\n  return function constant() {\n    return x;\n  };\n}\n", "const pi = Math.PI,\n    tau = 2 * pi,\n    epsilon = 1e-6,\n    tauEpsilon = tau - epsilon;\n\nfunction append(strings) {\n  this._ += strings[0];\n  for (let i = 1, n = strings.length; i < n; ++i) {\n    this._ += arguments[i] + strings[i];\n  }\n}\n\nfunction appendRound(digits) {\n  let d = Math.floor(digits);\n  if (!(d >= 0)) throw new Error(`invalid digits: ${digits}`);\n  if (d > 15) return append;\n  const k = 10 ** d;\n  return function(strings) {\n    this._ += strings[0];\n    for (let i = 1, n = strings.length; i < n; ++i) {\n      this._ += Math.round(arguments[i] * k) / k + strings[i];\n    }\n  };\n}\n\nexport class Path {\n  constructor(digits) {\n    this._x0 = this._y0 = // start of current subpath\n    this._x1 = this._y1 = null; // end of current subpath\n    this._ = \"\";\n    this._append = digits == null ? append : appendRound(digits);\n  }\n  moveTo(x, y) {\n    this._append`M${this._x0 = this._x1 = +x},${this._y0 = this._y1 = +y}`;\n  }\n  closePath() {\n    if (this._x1 !== null) {\n      this._x1 = this._x0, this._y1 = this._y0;\n      this._append`Z`;\n    }\n  }\n  lineTo(x, y) {\n    this._append`L${this._x1 = +x},${this._y1 = +y}`;\n  }\n  quadraticCurveTo(x1, y1, x, y) {\n    this._append`Q${+x1},${+y1},${this._x1 = +x},${this._y1 = +y}`;\n  }\n  bezierCurveTo(x1, y1, x2, y2, x, y) {\n    this._append`C${+x1},${+y1},${+x2},${+y2},${this._x1 = +x},${this._y1 = +y}`;\n  }\n  arcTo(x1, y1, x2, y2, r) {\n    x1 = +x1, y1 = +y1, x2 = +x2, y2 = +y2, r = +r;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(`negative radius: ${r}`);\n\n    let x0 = this._x1,\n        y0 = this._y1,\n        x21 = x2 - x1,\n        y21 = y2 - y1,\n        x01 = x0 - x1,\n        y01 = y0 - y1,\n        l01_2 = x01 * x01 + y01 * y01;\n\n    // Is this path empty? Move to (x1,y1).\n    if (this._x1 === null) {\n      this._append`M${this._x1 = x1},${this._y1 = y1}`;\n    }\n\n    // Or, is (x1,y1) coincident with (x0,y0)? Do nothing.\n    else if (!(l01_2 > epsilon));\n\n    // Or, are (x0,y0), (x1,y1) and (x2,y2) collinear?\n    // Equivalently, is (x1,y1) coincident with (x2,y2)?\n    // Or, is the radius zero? Line to (x1,y1).\n    else if (!(Math.abs(y01 * x21 - y21 * x01) > epsilon) || !r) {\n      this._append`L${this._x1 = x1},${this._y1 = y1}`;\n    }\n\n    // Otherwise, draw an arc!\n    else {\n      let x20 = x2 - x0,\n          y20 = y2 - y0,\n          l21_2 = x21 * x21 + y21 * y21,\n          l20_2 = x20 * x20 + y20 * y20,\n          l21 = Math.sqrt(l21_2),\n          l01 = Math.sqrt(l01_2),\n          l = r * Math.tan((pi - Math.acos((l21_2 + l01_2 - l20_2) / (2 * l21 * l01))) / 2),\n          t01 = l / l01,\n          t21 = l / l21;\n\n      // If the start tangent is not coincident with (x0,y0), line to.\n      if (Math.abs(t01 - 1) > epsilon) {\n        this._append`L${x1 + t01 * x01},${y1 + t01 * y01}`;\n      }\n\n      this._append`A${r},${r},0,0,${+(y01 * x20 > x01 * y20)},${this._x1 = x1 + t21 * x21},${this._y1 = y1 + t21 * y21}`;\n    }\n  }\n  arc(x, y, r, a0, a1, ccw) {\n    x = +x, y = +y, r = +r, ccw = !!ccw;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(`negative radius: ${r}`);\n\n    let dx = r * Math.cos(a0),\n        dy = r * Math.sin(a0),\n        x0 = x + dx,\n        y0 = y + dy,\n        cw = 1 ^ ccw,\n        da = ccw ? a0 - a1 : a1 - a0;\n\n    // Is this path empty? Move to (x0,y0).\n    if (this._x1 === null) {\n      this._append`M${x0},${y0}`;\n    }\n\n    // Or, is (x0,y0) not coincident with the previous point? Line to (x0,y0).\n    else if (Math.abs(this._x1 - x0) > epsilon || Math.abs(this._y1 - y0) > epsilon) {\n      this._append`L${x0},${y0}`;\n    }\n\n    // Is this arc empty? We\u2019re done.\n    if (!r) return;\n\n    // Does the angle go the wrong way? Flip the direction.\n    if (da < 0) da = da % tau + tau;\n\n    // Is this a complete circle? Draw two arcs to complete the circle.\n    if (da > tauEpsilon) {\n      this._append`A${r},${r},0,1,${cw},${x - dx},${y - dy}A${r},${r},0,1,${cw},${this._x1 = x0},${this._y1 = y0}`;\n    }\n\n    // Is this arc non-empty? Draw an arc!\n    else if (da > epsilon) {\n      this._append`A${r},${r},0,${+(da >= pi)},${cw},${this._x1 = x + r * Math.cos(a1)},${this._y1 = y + r * Math.sin(a1)}`;\n    }\n  }\n  rect(x, y, w, h) {\n    this._append`M${this._x0 = this._x1 = +x},${this._y0 = this._y1 = +y}h${w = +w}v${+h}h${-w}Z`;\n  }\n  toString() {\n    return this._;\n  }\n}\n\nexport function path() {\n  return new Path;\n}\n\n// Allow instanceof d3.path\npath.prototype = Path.prototype;\n\nexport function pathRound(digits = 3) {\n  return new Path(+digits);\n}\n", "import {Path} from \"d3-path\";\n\nexport function withPath(shape) {\n  let digits = 3;\n\n  shape.digits = function(_) {\n    if (!arguments.length) return digits;\n    if (_ == null) {\n      digits = null;\n    } else {\n      const d = Math.floor(_);\n      if (!(d >= 0)) throw new RangeError(`invalid digits: ${_}`);\n      digits = d;\n    }\n    return shape;\n  };\n\n  return () => new Path(digits);\n}\n", "export var slice = Array.prototype.slice;\n\nexport default function(x) {\n  return typeof x === \"object\" && \"length\" in x\n    ? x // Array, TypedArray, NodeList, array-like\n    : Array.from(x); // Map, Set, iterable, string, or anything else\n}\n", "function Linear(context) {\n  this._context = context;\n}\n\nLinear.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; // falls through\n      default: this._context.lineTo(x, y); break;\n    }\n  }\n};\n\nexport default function(context) {\n  return new Linear(context);\n}\n", "export function x(p) {\n  return p[0];\n}\n\nexport function y(p) {\n  return p[1];\n}\n", "import array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport curveLinear from \"./curve/linear.js\";\nimport {withPath} from \"./path.js\";\nimport {x as pointX, y as pointY} from \"./point.js\";\n\nexport default function(x, y) {\n  var defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null,\n      path = withPath(line);\n\n  x = typeof x === \"function\" ? x : (x === undefined) ? pointX : constant(x);\n  y = typeof y === \"function\" ? y : (y === undefined) ? pointY : constant(y);\n\n  function line(data) {\n    var i,\n        n = (data = array(data)).length,\n        d,\n        defined0 = false,\n        buffer;\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) output.lineStart();\n        else output.lineEnd();\n      }\n      if (defined0) output.point(+x(d, i, data), +y(d, i, data));\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  line.x = function(_) {\n    return arguments.length ? (x = typeof _ === \"function\" ? _ : constant(+_), line) : x;\n  };\n\n  line.y = function(_) {\n    return arguments.length ? (y = typeof _ === \"function\" ? _ : constant(+_), line) : y;\n  };\n\n  line.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), line) : defined;\n  };\n\n  line.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), line) : curve;\n  };\n\n  line.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), line) : context;\n  };\n\n  return line;\n}\n", "import array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport curveLinear from \"./curve/linear.js\";\nimport line from \"./line.js\";\nimport {withPath} from \"./path.js\";\nimport {x as pointX, y as pointY} from \"./point.js\";\n\nexport default function(x0, y0, y1) {\n  var x1 = null,\n      defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null,\n      path = withPath(area);\n\n  x0 = typeof x0 === \"function\" ? x0 : (x0 === undefined) ? pointX : constant(+x0);\n  y0 = typeof y0 === \"function\" ? y0 : (y0 === undefined) ? constant(0) : constant(+y0);\n  y1 = typeof y1 === \"function\" ? y1 : (y1 === undefined) ? pointY : constant(+y1);\n\n  function area(data) {\n    var i,\n        j,\n        k,\n        n = (data = array(data)).length,\n        d,\n        defined0 = false,\n        buffer,\n        x0z = new Array(n),\n        y0z = new Array(n);\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) {\n          j = i;\n          output.areaStart();\n          output.lineStart();\n        } else {\n          output.lineEnd();\n          output.lineStart();\n          for (k = i - 1; k >= j; --k) {\n            output.point(x0z[k], y0z[k]);\n          }\n          output.lineEnd();\n          output.areaEnd();\n        }\n      }\n      if (defined0) {\n        x0z[i] = +x0(d, i, data), y0z[i] = +y0(d, i, data);\n        output.point(x1 ? +x1(d, i, data) : x0z[i], y1 ? +y1(d, i, data) : y0z[i]);\n      }\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  function arealine() {\n    return line().defined(defined).curve(curve).context(context);\n  }\n\n  area.x = function(_) {\n    return arguments.length ? (x0 = typeof _ === \"function\" ? _ : constant(+_), x1 = null, area) : x0;\n  };\n\n  area.x0 = function(_) {\n    return arguments.length ? (x0 = typeof _ === \"function\" ? _ : constant(+_), area) : x0;\n  };\n\n  area.x1 = function(_) {\n    return arguments.length ? (x1 = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), area) : x1;\n  };\n\n  area.y = function(_) {\n    return arguments.length ? (y0 = typeof _ === \"function\" ? _ : constant(+_), y1 = null, area) : y0;\n  };\n\n  area.y0 = function(_) {\n    return arguments.length ? (y0 = typeof _ === \"function\" ? _ : constant(+_), area) : y0;\n  };\n\n  area.y1 = function(_) {\n    return arguments.length ? (y1 = _ == null ? null : typeof _ === \"function\" ? _ : constant(+_), area) : y1;\n  };\n\n  area.lineX0 =\n  area.lineY0 = function() {\n    return arealine().x(x0).y(y0);\n  };\n\n  area.lineY1 = function() {\n    return arealine().x(x0).y(y1);\n  };\n\n  area.lineX1 = function() {\n    return arealine().x(x1).y(y0);\n  };\n\n  area.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), area) : defined;\n  };\n\n  area.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), area) : curve;\n  };\n\n  area.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), area) : context;\n  };\n\n  return area;\n}\n", "function sign(x) {\n  return x < 0 ? -1 : 1;\n}\n\n// Calculate the slopes of the tangents (Hermite-type interpolation) based on\n// the following paper: Steffen, M. 1990. A Simple Method for Monotonic\n// Interpolation in One Dimension. Astronomy and Astrophysics, Vol. 239, NO.\n// NOV(II), P. 443, 1990.\nfunction slope3(that, x2, y2) {\n  var h0 = that._x1 - that._x0,\n      h1 = x2 - that._x1,\n      s0 = (that._y1 - that._y0) / (h0 || h1 < 0 && -0),\n      s1 = (y2 - that._y1) / (h1 || h0 < 0 && -0),\n      p = (s0 * h1 + s1 * h0) / (h0 + h1);\n  return (sign(s0) + sign(s1)) * Math.min(Math.abs(s0), Math.abs(s1), 0.5 * Math.abs(p)) || 0;\n}\n\n// Calculate a one-sided slope.\nfunction slope2(that, t) {\n  var h = that._x1 - that._x0;\n  return h ? (3 * (that._y1 - that._y0) / h - t) / 2 : t;\n}\n\n// According to https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Representations\n// \"you can express cubic Hermite interpolation in terms of cubic B\u00E9zier curves\n// with respect to the four values p0, p0 + m0 / 3, p1 - m1 / 3, p1\".\nfunction point(that, t0, t1) {\n  var x0 = that._x0,\n      y0 = that._y0,\n      x1 = that._x1,\n      y1 = that._y1,\n      dx = (x1 - x0) / 3;\n  that._context.bezierCurveTo(x0 + dx, y0 + dx * t0, x1 - dx, y1 - dx * t1, x1, y1);\n}\n\nfunction MonotoneX(context) {\n  this._context = context;\n}\n\nMonotoneX.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._x0 = this._x1 =\n    this._y0 = this._y1 =\n    this._t0 = NaN;\n    this._point = 0;\n  },\n  lineEnd: function() {\n    switch (this._point) {\n      case 2: this._context.lineTo(this._x1, this._y1); break;\n      case 3: point(this, this._t0, slope2(this, this._t0)); break;\n    }\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    var t1 = NaN;\n\n    x = +x, y = +y;\n    if (x === this._x1 && y === this._y1) return; // Ignore coincident points.\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; break;\n      case 2: this._point = 3; point(this, slope2(this, t1 = slope3(this, x, y)), t1); break;\n      default: point(this, this._t0, t1 = slope3(this, x, y)); break;\n    }\n\n    this._x0 = this._x1, this._x1 = x;\n    this._y0 = this._y1, this._y1 = y;\n    this._t0 = t1;\n  }\n}\n\nfunction MonotoneY(context) {\n  this._context = new ReflectContext(context);\n}\n\n(MonotoneY.prototype = Object.create(MonotoneX.prototype)).point = function(x, y) {\n  MonotoneX.prototype.point.call(this, y, x);\n};\n\nfunction ReflectContext(context) {\n  this._context = context;\n}\n\nReflectContext.prototype = {\n  moveTo: function(x, y) { this._context.moveTo(y, x); },\n  closePath: function() { this._context.closePath(); },\n  lineTo: function(x, y) { this._context.lineTo(y, x); },\n  bezierCurveTo: function(x1, y1, x2, y2, x, y) { this._context.bezierCurveTo(y1, x1, y2, x2, y, x); }\n};\n\nexport function monotoneX(context) {\n  return new MonotoneX(context);\n}\n\nexport function monotoneY(context) {\n  return new MonotoneY(context);\n}\n", "import { scaleLinear, scaleTime } from 'd3-scale';\nimport { extent } from 'd3-array';\nimport { line as d3Line, curveMonotoneX } from 'd3-shape';\n\nexport function createXTimeScale<T>(data: T[], accessor: (d: T) => Date, range: [number, number]) {\n  const domain = extent(data, accessor) as [Date, Date];\n  return scaleTime().domain(domain).range(range);\n}\n\nexport function createYLinearScale<T>(data: T[], accessor: (d: T) => number, range: [number, number]) {\n  const [min, max] = extent(data, accessor) as [number, number];\n  // We want a small visual gap below the lowest plotted value when the series is strictly positive,\n  // instead of always anchoring at zero (which can waste vertical space if min is far from 0) or\n  // sitting the lowest point flush on the axis. If the minimum value is 0 or negative we keep the\n  // natural lower bound (no enforced gap) because the user explicitly allows that case.\n  const hasData = Number.isFinite(min) && Number.isFinite(max);\n  if (!hasData) {\n    return scaleLinear().domain([0, 0]).range(range); // empty / invalid fallback\n  }\n  let lower: number;\n  if (min <= 0) {\n    // Keep original behaviour for datasets that include zero or negative values.\n    lower = Math.min(0, min);\n  } else {\n    const span = max - min;\n    // Padding is 5% of span, with a fallback to 10% of min when span is tiny / zero.\n    const pad = (span > 0 ? span : min) * 0.1;\n    lower = Math.max(0, min - pad);\n    // Guard against floating precision causing lower == min.\n    if (lower === min) lower = Math.max(0, min * 0.9);\n  }\n  const upper = max ?? 0;\n  return scaleLinear()\n    .domain([lower, upper])\n    .nice()\n    .range(range);\n}\n\nexport function createLinePath<T>(\n  data: T[],\n  x: (d: T) => number,\n  y: (d: T) => number,\n  options?: { smooth?: boolean }\n) {\n  const lineGen = d3Line<T>()\n    .x(x)\n    .y(y);\n  if (options?.smooth !== false) {\n    lineGen.curve(curveMonotoneX);\n  }\n  return lineGen(data) ?? '';\n}\n", "import * as React from 'react';\n\nexport interface ChartDimensions {\n  width: number;\n  height: number;\n  innerWidth: number;\n  innerHeight: number;\n  margin: { top: number; right: number; bottom: number; left: number };\n  ref: React.RefObject<HTMLDivElement | null>;\n}\n\nexport function useChartDimensions(initial: Partial<ChartDimensions['margin']> = {}): ChartDimensions {\n  const ref = React.useRef<HTMLDivElement>(null);\n  const margin = React.useMemo(() => ({\n    top: initial.top ?? 16,\n    right: initial.right ?? 16,\n    bottom: initial.bottom ?? 32,\n    left: initial.left ?? 48\n  }), [initial.bottom, initial.left, initial.right, initial.top]);\n\n  const [dims, setDims] = React.useState({ width: 0, height: 0 });\n\n  React.useLayoutEffect(() => {\n    if (!ref.current) return;    \n    const ro = new ResizeObserver(entries => {\n      for (const entry of entries) {\n        const { width, height } = entry.contentRect;\n        setDims({ width, height });\n      }\n    });\n    ro.observe(ref.current);\n    return () => ro.disconnect();\n  }, []);\n\n  const innerWidth = Math.max(0, dims.width - margin.left - margin.right);\n  const innerHeight = Math.max(0, dims.height - margin.top - margin.bottom);\n\n  return { width: dims.width, height: dims.height, innerWidth, innerHeight, margin, ref };\n}\n", "import * as React from 'react';\nimport { useChartDimensions, type ChartDimensions } from '../hooks/useChartDimensions';\n\nexport interface ChartRootProps {\n  /** Explicit height (px). Width is responsive to parent unless set via style */\n  height?: number;\n  /** Override margins (top,right,bottom,left) */\n  margin?: Partial<ChartDimensions['margin']>;\n  /** Optional explicit width; otherwise flex/parent controlled */\n  width?: number | string;\n  className?: string;\n  children: React.ReactNode;\n  role?: string;\n  ariaLabel?: string;\n}\n\ninterface ChartContextValue extends ChartDimensions {}\n\nconst ChartContext = React.createContext<ChartContextValue | null>(null);\nexport function useChartContext(): ChartContextValue | null { return React.useContext(ChartContext); }\n\nexport const ChartRoot: React.FC<ChartRootProps> = ({\n  height = 240,\n  margin,\n  width,\n  className = 'fdp-chart', // align with SCSS token application (.fdp-chart)\n  children,\n  role = 'group',\n  ariaLabel\n}) => {\n  const dims = useChartDimensions(margin);\n  const style: React.CSSProperties = { height, position: 'relative' };\n  if (width !== undefined) style.width = typeof width === 'number' ? `${width}px` : width;\n\n  return (\n    <div ref={dims.ref as any} className={className} style={style} role={role} aria-label={ariaLabel}>\n      <ChartContext.Provider value={dims}>\n        {children}\n      </ChartContext.Provider>\n    </div>\n  );\n};\n\nexport default ChartRoot;\n", "import * as React from 'react';\nimport { createXTimeScale, createYLinearScale } from '../utils/scales';\nimport { useChartContext } from './ChartRoot';\n\n// Provides d3 x/y scales + tick helpers for time-series line charts (initial scope).\nexport interface ScaleContextValue {\n  xScale: any; // d3 ScaleTime\n  yScale: any; // d3 ScaleLinear\n  getXTicks: (count?: number) => Date[];\n  getYTicks: (count?: number) => number[];\n}\n\nconst ScaleContext = React.createContext<ScaleContextValue | null>(null);\nexport const useScaleContext = () => React.useContext(ScaleContext);\n\nexport interface LineScalesProviderProps<Datum extends { x: any; y: number }> {\n  series: { data: Datum[] }[];\n  /** Explicit inner width; if omitted, derived from ChartRoot context (if available) */\n  innerWidth?: number; // width excluding margins\n  /** Explicit inner height; if omitted, derived from ChartRoot context (if available) */\n  innerHeight?: number; // height excluding margins\n  parseX?: (d: Datum) => Date; // custom accessor override\n  children: React.ReactNode;\n  xTickCount?: number; // preferred default counts\n  yTickCount?: number;\n  /** Optional explicit y domain override (e.g. stacked totals). */\n  yDomain?: [number, number];\n  /** Inner padding (px) to leave between axis and plotted points \u2014 improves hover targets near edges. Default: 6px */\n  xPadding?: number;\n  yPadding?: number;\n}\n\nexport const LineScalesProvider = <Datum extends { x: any; y: number }>({\n  series,\n  innerWidth: innerWidthProp,\n  innerHeight: innerHeightProp,\n  parseX: parseXProp,\n  children,\n  xTickCount = 6,\n  yTickCount = 5,\n  yDomain\n  , xPadding, yPadding\n}: LineScalesProviderProps<Datum>) => {\n  const chartDims = useChartContext();\n  // Prefer explicit values; fallback to chart context; final fallback 0 (will update on re-measure)\n  const innerWidth = innerWidthProp ?? chartDims?.innerWidth ?? 0;\n  const innerHeight = innerHeightProp ?? chartDims?.innerHeight ?? 0;\n  const allData = React.useMemo(() => series.flatMap(s => s.data), [series]);\n  const parseX = React.useCallback((d: Datum) => {\n    if (parseXProp) return parseXProp(d);\n    const raw = (d as any).x;\n    return raw instanceof Date ? raw : new Date(raw);\n  }, [parseXProp]);\n\n  const xPad = xPadding ?? 6;\n  const yPad = yPadding ?? 6;\n\n  const xScale = React.useMemo(() => createXTimeScale(allData, parseX as any, [xPad, Math.max(0, innerWidth - xPad)]), [allData, parseX, innerWidth, xPad]);\n  const yScale = React.useMemo(() => {\n    if (yDomain) {\n      const scale = createYLinearScale([], (d: any) => d.y, [Math.max(0, innerHeight - yPad), yPad]);\n      scale.domain(yDomain);\n      return scale;\n    }\n    return createYLinearScale(allData, (d: any) => d.y, [Math.max(0, innerHeight - yPad), yPad]);\n  }, [allData, innerHeight, yDomain]);\n\n  const value: ScaleContextValue = React.useMemo(() => ({\n    xScale,\n    yScale,\n    getXTicks: (count = xTickCount) => xScale.ticks(count),\n    getYTicks: (count = yTickCount) => yScale.ticks(count)\n  }), [xScale, yScale, xTickCount, yTickCount]);\n\n  return <ScaleContext.Provider value={value}>{children}</ScaleContext.Provider>;\n};\n\nexport default ScaleContext;\n", "import * as React from 'react';\nimport { useScaleContext } from '../../core/ScaleContext';\nimport { useChartContext } from '../../core/ChartRoot';\n\nexport interface AxisProps {\n  type: 'x' | 'y';\n  scale?: any; // user-supplied override\n  tickCount?: number;\n  /** Explicit tick values; if provided overrides tickCount/ticks() generation */\n  tickValues?: any[];\n  formatTick?: (v: any) => string;\n  label?: string; // used for y\n  offset?: number; // x axis vertical offset (defaults to innerHeight)\n  className?: string;\n  /** Minimum pixel spacing between adjacent tick labels (x axis only). If labels would overlap, intermediate ticks are dropped. Default 0 (no filtering). */\n  minLabelSpacing?: number;\n  /** Truncate tick label text to this many characters (adds ellipsis). Full value kept in <title> for tooltip/a11y. */\n  maxTickLabelLength?: number;\n  /** Auto-compute a reasonable minLabelSpacing based on average label length if explicit minLabelSpacing not provided. */\n  autoMinLabelSpacing?: boolean;\n  /** Rotate x-axis tick labels (degrees). Negative leans left, positive right. */\n  labelAngle?: number;\n  /** If true, split labels containing \\n into multiple tspans (multi-line). */\n  allowLabelWrap?: boolean;\n  /** Preset date/time formatting helper (applies only if formatTick not provided). */\n  tickFormatPreset?: 'dayShortMonth' | 'dayShortMonthYear' | 'shortMonth' | 'shortMonthYear' | 'hourMinute';\n}\n\nexport const Axis: React.FC<AxisProps> = ({\n  type,\n  scale,\n  tickCount,\n  tickValues,\n  formatTick: rawFormatTick,\n  label,\n  offset,\n  className,\n  minLabelSpacing,\n  maxTickLabelLength,\n  autoMinLabelSpacing = type === 'x' ? true : false,\n  labelAngle = 0,\n  allowLabelWrap = true,\n  tickFormatPreset\n}) => {\n  const scaleCtx = useScaleContext();\n  const dims = useChartContext();\n  const resolvedScale = scale || (type === 'x' ? scaleCtx?.xScale : scaleCtx?.yScale);\n  const defaultCount = tickCount ?? (type === 'x' ? 6 : 5);\n  // Derive formatter from preset if provided and no explicit formatter\n  const hasUserFormatter = typeof rawFormatTick === 'function';\n  const presetFormatter: ((v: any) => string) | undefined = React.useMemo(() => {\n    if (hasUserFormatter) return undefined;\n    if (!tickFormatPreset) return undefined;\n    const dtf = (opts: Intl.DateTimeFormatOptions) => new Intl.DateTimeFormat(undefined, opts);\n    switch (tickFormatPreset) {\n      case 'dayShortMonth':\n        return (v: any) => {\n          const d = v instanceof Date ? v : new Date(v);\n          return `${d.getDate()}\\n${dtf({ month: 'short' }).format(d)}`;\n        };\n      case 'dayShortMonthYear':\n        return (v: any) => {\n          const d = v instanceof Date ? v : new Date(v);\n            return `${d.getDate()}\\n${dtf({ month: 'short' }).format(d)} ${d.getFullYear()}`;\n        };\n      case 'shortMonth':\n        return (v: any) => {\n          const d = v instanceof Date ? v : new Date(v);\n          return dtf({ month: 'short' }).format(d);\n        };\n      case 'shortMonthYear':\n        return (v: any) => {\n          const d = v instanceof Date ? v : new Date(v);\n          return `${dtf({ month: 'short' }).format(d)} ${d.getFullYear()}`;\n        };\n      case 'hourMinute':\n        return (v: any) => {\n          const d = v instanceof Date ? v : new Date(v);\n          return dtf({ hour: '2-digit', minute: '2-digit' }).format(d);\n        };\n      default:\n        return undefined;\n    }\n  }, [hasUserFormatter, tickFormatPreset]);\n  let effectiveFormatTick: (v:any)=>string = hasUserFormatter ? (rawFormatTick as (v:any)=>string) : (presetFormatter || ((v: any) => String(v)));\n  const ticks: any[] = React.useMemo(() => {\n    if (tickValues && Array.isArray(tickValues)) return tickValues;\n    if (!resolvedScale) return [];\n    if (typeof resolvedScale.ticks === 'function') return resolvedScale.ticks(defaultCount);\n    return resolvedScale.domain ? resolvedScale.domain() : [];\n  }, [resolvedScale, defaultCount, tickValues]);\n\n  // Auto date formatting heuristic for x-axis when using time scale and no user/preset format provided\n  if (type === 'x' && !hasUserFormatter && !tickFormatPreset && ticks.length && ticks.every(t => t instanceof Date)) {\n    const first = ticks[0] as Date;\n    const last = ticks[ticks.length - 1] as Date;\n    const spanMs = last.getTime() - first.getTime();\n    const oneDay = 24*3600*1000;\n    const oneYear = 365*oneDay;\n    const sameYear = first.getFullYear() === last.getFullYear();\n    const dtfMonth = new Intl.DateTimeFormat(undefined, { month: 'short' });\n    if (spanMs < 2*oneDay) {\n      const dtfTime = new Intl.DateTimeFormat(undefined, { hour: '2-digit', minute: '2-digit' });\n      effectiveFormatTick = (v:any) => dtfTime.format(v as Date);\n    } else if (spanMs < 32*oneDay) {\n      // Show day + short month\n      effectiveFormatTick = (v:any) => {\n        const d = v as Date; return `${d.getDate()} ${dtfMonth.format(d)}`;\n      };\n    } else if (spanMs < oneYear && sameYear) {\n      // Show short month (year implied)\n      effectiveFormatTick = (v:any) => dtfMonth.format(v as Date);\n    } else if (spanMs < 2*oneYear) {\n      // Show short month + year on first month of each year maybe; keep simple: Mon YYYY\n      const seenMonths = new Set<number>();\n      effectiveFormatTick = (v:any) => {\n        const d = v as Date; const key = d.getMonth();\n        if (!seenMonths.has(key)) { seenMonths.add(key); }\n        return `${dtfMonth.format(d)} ${d.getFullYear()}`;\n      };\n    } else {\n      // Multi-year span \u2013 show year only\n      effectiveFormatTick = (v:any) => String((v as Date).getFullYear());\n    }\n  }\n\n  if (!resolvedScale || !dims) return null;\n\n  if (type === 'x') {\n    const y = offset ?? dims.innerHeight;\n    const isBandScale = typeof (resolvedScale as any).bandwidth === 'function';\n    const bandwidth = isBandScale ? (resolvedScale as any).bandwidth() : 0;\n    const tickPos = (t: any) => {\n      const base = resolvedScale(t);\n      return isBandScale ? base + bandwidth / 2 : base;\n    };\n    // Determine min spacing (auto or explicit)\n    let resolvedMinSpacing = minLabelSpacing ?? 0;\n    if (autoMinLabelSpacing && (minLabelSpacing === undefined || minLabelSpacing === null)) {\n      // Approximate per-label pixel width = avg length * 6 (rough chars * px). Add padding.\n      const labels = ticks.map(t => effectiveFormatTick(t).replace(/\\n.*/g, '')); // first line only for width\n      const avgLen = labels.length ? labels.reduce((a,b)=>a+b.length,0)/labels.length : 0;\n      resolvedMinSpacing = Math.max(12, Math.round(avgLen * 6 + 4));\n    }\n    // Optionally filter ticks to avoid overlap based on pixel distance\n  const filteredTicks = React.useMemo(() => {\n      // If user supplied explicit tickValues we render them all (no auto thinning) to keep alignment with data points.\n      if (tickValues && Array.isArray(tickValues)) return ticks;\n      if (resolvedMinSpacing <= 0) return ticks;\n      const accepted: any[] = [];\n      let lastPos = -Infinity;\n      for (const t of ticks) {\n    const pos = tickPos(t);\n        if (pos - lastPos >= resolvedMinSpacing) {\n          accepted.push(t);\n          lastPos = pos;\n        }\n      }\n      return accepted;\n  }, [ticks, resolvedScale, resolvedMinSpacing, tickValues, isBandScale, bandwidth]);\n    return (\n  <g className={['fdp-axis','fdp-axis--x', className].filter(Boolean).join(' ')} transform={`translate(0,${y})`} fontFamily=\"var(--nhs-fdp-font-family-base, var(--fdp-chart-font-family))\">\n        <line x1={0} x2={dims.innerWidth} y1={0} y2={0} stroke=\"currentColor\" />\n        {filteredTicks.map((t, i) => {\n          const rawLabel = effectiveFormatTick(t);\n            const displayLabel = (maxTickLabelLength && rawLabel.length > maxTickLabelLength)\n              ? rawLabel.slice(0, Math.max(1, maxTickLabelLength - 1)) + '\u2026'\n              : rawLabel;\n          const lines = allowLabelWrap ? displayLabel.split(/\\n/) : [displayLabel.replace(/\\n/g,' ' )];\n          const anchor = labelAngle < 0 ? 'end' : labelAngle > 0 ? 'start' : 'middle';\n          return (\n      <g key={t?.toString?.() || i} transform={`translate(${tickPos(t)},0)`}>\n              <line y2={6} stroke=\"currentColor\" />\n              <text y={9} textAnchor={anchor} className=\"fdp-axis__tick\" dominantBaseline=\"hanging\" transform={labelAngle ? `rotate(${labelAngle})` : undefined} fontFamily=\"inherit\">\n                {lines.map((ln, li) => (\n                  <tspan key={li} x={0} dy={li===0?0:'1.1em'}>{ln}</tspan>\n                ))}\n                {displayLabel !== rawLabel && <title>{rawLabel}</title>}\n              </text>\n            </g>\n          );\n        })}\n      </g>\n    );\n  }\n\n  return (\n  <g className={['fdp-axis','fdp-axis--y', className].filter(Boolean).join(' ')} fontFamily=\"var(--nhs-fdp-font-family-base, var(--fdp-chart-font-family))\">\n      {ticks.map((t, i) => {\n        const rawLabel = effectiveFormatTick(t);\n        const displayLabel = (maxTickLabelLength && rawLabel.length > maxTickLabelLength)\n          ? rawLabel.slice(0, Math.max(1, maxTickLabelLength - 1)) + '\u2026'\n          : rawLabel;\n        const lines = allowLabelWrap ? displayLabel.split(/\\n/) : [displayLabel.replace(/\\n/g,' ')];\n        return (\n          <g key={t?.toString?.() || i} transform={`translate(0,${resolvedScale(t)})`}>\n            <line x2={-6} stroke=\"currentColor\" />\n            <text x={-9} dy=\"0.32em\" textAnchor=\"end\" className=\"fdp-axis__tick\" fontFamily=\"inherit\">\n              {lines.map((ln, li) => (\n                <tspan key={li} x={-9} dy={li===0?0:'1.1em'}>{ln}</tspan>\n              ))}\n              {displayLabel !== rawLabel && <title>{rawLabel}</title>}\n            </text>\n          </g>\n        );\n      })}\n      {label && (\n        <text transform=\"rotate(-90)\" x={-dims.innerHeight / 2} y={-dims.margin.left + 12} textAnchor=\"middle\" className=\"fdp-axis__label\" fontFamily=\"inherit\">{label}</text>\n      )}\n    </g>\n  );\n};\n\nexport default Axis;\n", "import * as React from 'react';\nimport { useScaleContext } from '../../core/ScaleContext';\nimport { useChartContext } from '../../core/ChartRoot';\n\nexport interface GridLinesProps {\n  axis?: 'x' | 'y'; // draw lines perpendicular to specified axis ticks (default y -> horizontal lines)\n  tickCount?: number;\n  stroke?: string;\n  dasharray?: string;\n  className?: string;\n}\n\nexport const GridLines: React.FC<GridLinesProps> = ({\n  axis = 'y',\n  tickCount,\n  stroke = 'var(--fdp-chart-grid,#e5e5e5)',\n  dasharray = '2 4',\n  className\n}) => {\n  const scaleCtx = useScaleContext();\n  const dims = useChartContext();\n  if (!scaleCtx || !dims) return null;\n  const ticks = axis === 'y' ? scaleCtx.getYTicks(tickCount) : scaleCtx.getXTicks(tickCount);\n  return (\n    <g className={['fdp-grid', className].filter(Boolean).join(' ')}>\n      {axis === 'y' && ticks.map((t, i) => (\n        <line key={i} x1={0} x2={dims.innerWidth} y1={scaleCtx.yScale(t)} y2={scaleCtx.yScale(t)} stroke={stroke} strokeDasharray={dasharray} />\n      ))}\n      {axis === 'x' && ticks.map((t, i) => (\n        <line key={i} y1={0} y2={dims.innerHeight} x1={scaleCtx.xScale(t)} x2={scaleCtx.xScale(t)} stroke={stroke} strokeDasharray={dasharray} />\n      ))}\n    </g>\n  );\n};\n\nexport default GridLines;\n", "import * as React from \"react\";\nimport { createLinePath } from \"../utils/scales\";\nimport { area as d3Area, curveMonotoneX } from \"d3-shape\";\nimport {\n\tpickSeriesColor,\n\tpickRegionColor,\n\tpickSeriesStroke,\n\tpickRegionStroke,\n} from \"../utils/colors\";\nimport { useScaleContext } from \"../core/ScaleContext\";\nimport { useVisibility } from \"../core/VisibilityContext\";\nimport { useTooltipContext } from \"../core/TooltipContext\";\n\nexport interface LineDatum {\n\tx: Date | string | number;\n\ty: number;\n}\nexport interface LineSeries {\n\tid: string;\n\tdata: LineDatum[];\n\tcolor?: string;\n\tlabel?: string;\n}\n\nexport interface LineSeriesPrimitiveProps {\n\tseries: LineSeries;\n\tseriesIndex: number;\n\tpalette: \"categorical\" | \"region\";\n\tshowPoints: boolean;\n\tfocusablePoints: boolean;\n\tfocusIndex: number;\n\t/** Provide parseX to avoid reallocation across series */\n\tparseX: (d: LineDatum) => Date;\n\t/** Presentation for hidden series (inherited via LineChart). */\n\tvisibilityMode?: \"remove\" | \"fade\";\n\t/** Custom stroke width for the series line (defaults to 1). */\n\tstrokeWidth?: number;\n\t/** Enable curve smoothing (monotoneX). Defaults to true. */\n\tsmooth?: boolean;\n\t/** Optional gradient fill id (linearGradient) for subtle wash under line. */\n\tgradientFillId?: string;\n\t/** Optional explicit colour palette overriding default pickSeriesColor / pickRegionColor logic.\n\t *  Precedence: series.color > colors[seriesIndex] > internal palette pickers. */\n\tcolors?: string[];\n}\n\n/** Low-level renderer for a single line series (no axes, assumes ScaleContext present). */\nexport const LineSeriesPrimitive: React.FC<LineSeriesPrimitiveProps> = ({\n\tseries,\n\tseriesIndex,\n\tpalette,\n\tshowPoints,\n\tfocusablePoints,\n\tfocusIndex,\n\tparseX,\n\tvisibilityMode = \"remove\",\n\tstrokeWidth = 1,\n\tsmooth = true,\n\tgradientFillId,\n\tcolors,\n}) => {\n\tconst scaleCtx = useScaleContext();\n\tif (!scaleCtx) return null; // safeguard\n\tconst { xScale, yScale } = scaleCtx;\n\tconst visibility = useVisibility();\n\tconst isHidden = visibility?.isHidden(series.id) ?? false;\n\tconst faded = isHidden && visibilityMode === \"fade\";\n\tif (isHidden && visibilityMode === \"remove\") {\n\t\treturn null;\n\t}\n\tconst tooltip = useTooltipContext();\n\n\t// Register series with tooltip context for nearest-point computation\n\tReact.useEffect(() => {\n\t\tif (!tooltip) return;\n\t\tconst normalized = series.data.map((d) => ({ x: parseX(d), y: d.y }));\n\t\ttooltip.registerSeries(series.id, normalized);\n\t\treturn () => tooltip.unregisterSeries(series.id);\n\t}, [tooltip, series.id, series.data, parseX]);\n\tconst path = React.useMemo(\n\t\t() =>\n\t\t\tcreateLinePath(\n\t\t\t\tseries.data,\n\t\t\t\t(d) => xScale(parseX(d)),\n\t\t\t\t(d) => yScale(d.y),\n\t\t\t\t{ smooth }\n\t\t\t),\n\t\t[series.data, xScale, yScale, parseX, smooth]\n\t);\n\t// Build an area path from the scale's lower domain bound (visual baseline) up to the series line so the gradient wash fills \"down\" fully.\n\tconst areaPath = React.useMemo(() => {\n\t\tif (!series.data.length) return \"\";\n\t\tconst [domainMin] = yScale.domain();\n\t\tconst gen = d3Area<LineDatum>()\n\t\t\t.x((d) => xScale(parseX(d)))\n\t\t\t.y0(() => yScale(domainMin))\n\t\t\t.y1((d) => yScale(d.y));\n\t\tif (smooth) gen.curve(curveMonotoneX);\n\t\treturn gen(series.data) || \"\";\n\t}, [series.data, xScale, yScale, parseX, smooth]);\n\tconst paletteOverride = colors && colors[seriesIndex];\n\tconst color =\n\t\tseries.color ||\n\t\tpaletteOverride ||\n\t\t(palette === \"region\"\n\t\t\t? pickRegionColor(series.id, seriesIndex)\n\t\t\t: pickSeriesColor(seriesIndex));\n\tconst stroke =\n\t\tpalette === \"region\"\n\t\t\t? pickRegionStroke(series.id, seriesIndex)\n\t\t\t: pickSeriesStroke(seriesIndex);\n\n\treturn (\n\t\t<g\n\t\t\tclassName=\"fdp-line-series\"\n\t\t\tdata-series={series.id}\n\t\t\topacity={faded ? 0.25 : 1}\n\t\t\taria-hidden={faded ? true : undefined}\n\t\t>\n\t\t\t{gradientFillId && (\n\t\t\t\t<path\n\t\t\t\t\td={areaPath}\n\t\t\t\t\tfill={`url(#${gradientFillId})`}\n\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\trole=\"presentation\"\n\t\t\t\t\tclassName=\"fdp-line-series__gradient\"\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t<path\n\t\t\t\td={path}\n\t\t\t\tfill=\"none\"\n\t\t\t\tstroke={color}\n\t\t\t\tstrokeWidth={strokeWidth}\n\t\t\t\trole=\"presentation\"\n\t\t\t/>\n\t\t\t{showPoints &&\n\t\t\t\tseries.data.map((d, di) => {\n\t\t\t\t\tconst cx = xScale(parseX(d));\n\t\t\t\t\tconst cy = yScale(d.y);\n\t\t\t\t\tconst tabIndex = focusablePoints ? 0 : -1;\n\t\t\t\t\tconst isFocusedPoint =\n\t\t\t\t\t\t!faded &&\n\t\t\t\t\t\t((focusablePoints && di === focusIndex) ||\n\t\t\t\t\t\t\t(tooltip?.focused?.seriesId === series.id &&\n\t\t\t\t\t\t\t\ttooltip.focused.index === di));\n\t\t\t\t\tconst handleEnter = () => {\n\t\t\t\t\t\tif (tooltip && !faded) {\n\t\t\t\t\t\t\ttooltip.setFocused({\n\t\t\t\t\t\t\t\tseriesId: series.id,\n\t\t\t\t\t\t\t\tindex: di,\n\t\t\t\t\t\t\t\tx: parseX(d),\n\t\t\t\t\t\t\t\ty: d.y,\n\t\t\t\t\t\t\t\tclientX: cx,\n\t\t\t\t\t\t\t\tclientY: cy,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tconst handleLeave = () => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\ttooltip &&\n\t\t\t\t\t\t\ttooltip.focused?.seriesId === series.id &&\n\t\t\t\t\t\t\ttooltip.focused.index === di\n\t\t\t\t\t\t)\n\t\t\t\t\t\t\ttooltip.clear();\n\t\t\t\t\t};\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<circle\n\t\t\t\t\t\t\tkey={di}\n\t\t\t\t\t\t\tcx={cx}\n\t\t\t\t\t\t\tcy={cy}\n\t\t\t\t\t\t\tr={isFocusedPoint ? 5 : 3.5}\n\t\t\t\t\t\t\tstroke={\n\t\t\t\t\t\t\t\tisFocusedPoint ? \"var(--nhs-fdp-color-primary-yellow, #ffeb3b)\" : stroke\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tstrokeWidth={isFocusedPoint ? 2 : 1}\n\t\t\t\t\t\t\tfill={\n\t\t\t\t\t\t\t\tisFocusedPoint ? \"var(--nhs-fdp-color-grey-3, #aeb7bd)\" : color\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tclassName=\"fdp-line-point\"\n\t\t\t\t\t\t\ttabIndex={faded ? -1 : tabIndex}\n\t\t\t\t\t\t\taria-label={`${series.label || series.id} ${parseX(d).toDateString()} value ${d.y}`}\n\t\t\t\t\t\t\tdata-series={series.id}\n\t\t\t\t\t\t\tdata-index={di}\n\t\t\t\t\t\t\tonMouseEnter={handleEnter}\n\t\t\t\t\t\t\tonFocus={handleEnter}\n\t\t\t\t\t\t\tonMouseLeave={handleLeave}\n\t\t\t\t\t\t\tonBlur={handleLeave}\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t</g>\n\t);\n};\n\nexport default LineSeriesPrimitive;\n", "{\n  \"color\": {\n    \"data-viz\": {\n      \"$type\": \"color\",\n      \"categorical\": {\n        \"1\": { \"$value\": \"{color.primary.blue}\", \"$description\": \"Series 1 \u2013 NHS Blue (brand core)\" },\n        \"2\": { \"$value\": \"#41B6E6\", \"$description\": \"Series 2 \u2013 NHS Light Blue (new)\" },\n        \"3\": { \"$value\": \"{color.secondary.aqua-green}\", \"$description\": \"Series 3 \u2013 NHS Aqua Green (existing)\" },\n        \"4\": { \"$value\": \"#78BE20\", \"$description\": \"Series 4 \u2013 NHS Light Green (new)\" },\n        \"5\": { \"$value\": \"{color.primary.green}\", \"$description\": \"Series 5 \u2013 NHS Green (existing)\" },\n        \"6\": { \"$value\": \"{color.secondary.warm-yellow}\", \"$description\": \"Series 6 \u2013 NHS Warm Yellow (existing; distinct from focus yellow)\" },\n        \"7\": { \"$value\": \"#ED4F00\", \"$description\": \"Series 7 \u2013 NHS Tangerine (new; warmer/deeper than existing orange)\" },\n        \"8\": { \"$value\": \"{color.secondary.pink}\", \"$description\": \"Series 8 \u2013 NHS Pink (existing)\" },\n        \"9\": { \"$value\": \"#E317AA\", \"$description\": \"Series 9 \u2013 NHS Bright Pink (new vivid accent)\" },\n        \"10\": { \"$value\": \"#880FB8\", \"$description\": \"Series 10 \u2013 NHS Light Purple (new mid purple)\" },\n        \"11\": { \"$value\": \"{color.primary.purple}\", \"$description\": \"Series 11 \u2013 NHS Purple (existing dark purple)\" },\n        \"12\": { \"$value\": \"#9A6324\", \"$description\": \"Series 12 \u2013 NHS Brown (new; earth neutral)\" }\n      },\n      \"neutral\": {\n        \"comparison\": { \"$value\": \"{color.grey.1}\", \"$description\": \"Neutral comparison series (optional)\" }\n      },\n      \"region\": {\n        \"$comment\": \"Fixed colours for NHS geographical regions; prefer stable mapping for maps. London colour updated (#78BE21 \u2013 light green).\",\n        \"north-east\": { \"$value\": \"{color.primary.blue}\", \"$description\": \"North East \u2013 NHS Blue\" },\n        \"north-west\": { \"$value\": \"#41B6E6\", \"$description\": \"North West \u2013 NHS Light Blue\" },\n        \"east-of-england\": { \"$value\": \"{color.primary.purple}\", \"$description\": \"East of England \u2013 NHS Purple\" },\n        \"midlands\": { \"$value\": \"{color.secondary.pink}\", \"$description\": \"Midlands \u2013 NHS Pink\" },\n  \t\t\"london\": { \"$value\": \"#78BE21\", \"$description\": \"London \u2013 NHS Light Green (new)\" },\n        \"south-west\": { \"$value\": \"#FAE100\", \"$description\": \"South West \u2013 NHS Yellow variant (new)\" },\n        \"south-east\": { \"$value\": \"#ed8b00\", \"$description\": \"South East \u2013 NHS Orange (existing base orange)\" }\n      },\n      \"severity\": {\n        \"$comment\": \"Semantic severity / alert colours (light background ramp \u2192 critical).\",\n        \"low\": { \"$value\": \"{color.secondary.pale-yellow}\", \"$description\": \"Low severity \u2013 pale yellow background\" },\n        \"moderate\": { \"$value\": \"{color.secondary.warm-yellow}\", \"$description\": \"Moderate severity \u2013 warm yellow\" },\n        \"high\": { \"$value\": \"{color.secondary.orange}\", \"$description\": \"High severity \u2013 orange\" },\n        \"critical\": { \"$value\": \"{color.primary.red}\", \"$description\": \"Critical severity \u2013 red\" }\n      },\n      \"org-level\": {\n        \"$comment\": \"Organisational level semantic colours (stable NHS brand mappings).\",\n        \"trust\": { \"$value\": \"{color.primary.blue}\", \"$description\": \"Trust \u2013 NHS Blue\" },\n        \"ambulance\": { \"$value\": \"{color.primary.green}\", \"$description\": \"Ambulance \u2013 NHS Green\" },\n        \"icb\": { \"$value\": \"{color.primary.dark-pink}\", \"$description\": \"ICB \u2013 NHS Dark Pink\" },\n        \"region\": { \"$value\": \"{color.primary.purple}\", \"$description\": \"Region \u2013 NHS Purple\" }\n      },\n      \"stroke\": {\n        \"$comment\": \"Automatic contrast stroke colours for overlays / borders. Light fills get dark stroke; dark fills get white stroke.\",\n        \"categorical\": {\n          \"1\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for series 1 (blue)\" },\n          \"2\": { \"$value\": \"#212b32\", \"$description\": \"Stroke for series 2 (light blue)\" },\n          \"3\": { \"$value\": \"#212b32\", \"$description\": \"Stroke for series 3 (aqua green)\" },\n          \"4\": { \"$value\": \"#212b32\", \"$description\": \"Stroke for series 4 (light green)\" },\n          \"5\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for series 5 (green)\" },\n          \"6\": { \"$value\": \"#212b32\", \"$description\": \"Stroke for series 6 (warm yellow)\" },\n          \"7\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for series 7 (tangerine)\" },\n          \"8\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for series 8 (pink)\" },\n          \"9\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for series 9 (bright pink)\" },\n          \"10\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for series 10 (light purple)\" },\n          \"11\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for series 11 (purple)\" },\n          \"12\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for series 12 (brown)\" }\n        },\n        \"region\": {\n          \"$comment\": \"Region stroke colours derived from fill colours: dark fills lightened ~35%; light fills darkened ~25% for consistent contrast without defaulting to pure white/black.\",\n          \"north-east\": { \"$value\": \"#5996D1\", \"$description\": \"Stroke for North East (blue lightened 35%)\" },\n          \"north-west\": { \"$value\": \"#3189AD\", \"$description\": \"Stroke for North West (light blue darkened 25%)\" },\n          \"east-of-england\": { \"$value\": \"#7A59A3\", \"$description\": \"Stroke for East of England (purple lightened 35%)\" },\n          \"midlands\": { \"$value\": \"#CA71A4\", \"$description\": \"Stroke for Midlands (pink lightened 35%)\" },\n          \"london\": { \"$value\": \"#5A8F19\", \"$description\": \"Stroke for London (light green darkened 25%)\" },\n          \"south-west\": { \"$value\": \"#BCA900\", \"$description\": \"Stroke for South West (yellow darkened 25%)\" },\n          \"south-east\": { \"$value\": \"#B26800\", \"$description\": \"Stroke for South East (orange darkened 25%)\" }\n        },\n        \"severity\": {\n          \"$comment\": \"Contrast strokes for severity colours (light backgrounds use dark stroke; dark backgrounds use white).\",\n          \"low\": { \"$value\": \"#212b32\", \"$description\": \"Stroke for low severity (pale yellow fill)\" },\n          \"moderate\": { \"$value\": \"#212b32\", \"$description\": \"Stroke for moderate severity (warm yellow fill)\" },\n          \"high\": { \"$value\": \"#212b32\", \"$description\": \"Stroke for high severity (orange fill)\" },\n          \"critical\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for critical severity (red fill)\" }\n        },\n        \"org-level\": {\n          \"$comment\": \"Contrast strokes for organisational level colours (all dark brand fills so white stroke for consistency).\",\n          \"trust\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for trust (blue fill)\" },\n          \"ambulance\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for ambulance (green fill)\" },\n          \"icb\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for ICB (dark pink fill)\" },\n          \"region\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for region (purple fill)\" }\n        }\n      }\n      ,\n      \"spc\": {\n        \"$comment\": \"SPC (Statistical Process Control) semantic variation colours aligned to SPCChart.scss and SPCIcons.\",\n        \"improvement\": { \"$value\": \"#00B0F0\", \"$description\": \"SPC special cause improvement (favourable)\" },\n        \"concern\": { \"$value\": \"#E46C0A\", \"$description\": \"SPC special cause concern (deteriorating)\" },\n        \"no-judgement\": { \"$value\": \"#490092\", \"$description\": \"SPC special cause (no directional judgement)\" },\n        \"common-cause\": { \"$value\": \"#A6A6A6\", \"$description\": \"SPC common cause (baseline variation)\" },\n        \"assurance-pass\": { \"$value\": \"#00823B\", \"$description\": \"SPC assurance pass indicator (process capable)\" },\n        \"assurance-fail\": { \"$value\": \"#DA291C\", \"$description\": \"SPC assurance fail indicator (process not capable)\" },\n        \"gradient\": {\n          \"$comment\": \"Opacity stops for SPC icon gradient wash (applied top-left -> bottom-right). Consumers build gradients using these opacities + base colour.\",\n          \"stop\": {\n            \"start-opacity\": { \"$value\": \"0.18\", \"$description\": \"Start stop opacity (0%) for classic variant wash\" },\n            \"mid-opacity\": { \"$value\": \"0.06\", \"$description\": \"Mid stop opacity (~65-75%)\" },\n            \"end-opacity\": { \"$value\": \"0\", \"$description\": \"End stop opacity (100%)\" },\n            \"triangle-start-opacity\": { \"$value\": \"0.18\", \"$description\": \"Start opacity for triangle variants (kept aligned)\" },\n            \"triangle-mid-opacity\": { \"$value\": \"0.06\", \"$description\": \"Mid opacity for triangle variants\" },\n            \"triangle-end-opacity\": { \"$value\": \"0\", \"$description\": \"End opacity for triangle variants\" }\n          }\n        },\n        \"stroke\": {\n          \"$comment\": \"Contrast stroke colours for SPC variation fills.\",\n          \"improvement\": { \"$value\": \"#000000\", \"$description\": \"Stroke for improvement points\" },\n          \"concern\": { \"$value\": \"#000000\", \"$description\": \"Stroke for concern points\" },\n          \"no-judgement\": { \"$value\": \"#000000\", \"$description\": \"Stroke for no-judgement points\" },\n          \"common-cause\": { \"$value\": \"#ffffff\", \"$description\": \"Stroke for common cause points\" },\n          \"assurance-pass\": { \"$value\": \"#000000\", \"$description\": \"Stroke for assurance pass points\" },\n          \"assurance-fail\": { \"$value\": \"#000000\", \"$description\": \"Stroke for assurance fail points\" }\n        }\n      }\n    }\n  }\n}\n", "{\n  \"color\": {\n\t\"primary\": {\n\t  \"$type\": \"color\",\n\t  \"blue\": {\n\t\t\"$value\": \"#005eb8\",\n\t\t\"$description\": \"NHS Blue - Primary brand color\"\n\t  },\n\t  \"blue-active\": {\n\t\t\"$value\": \"#002f5c\",\n\t\t\"$description\": \"NHS Active Blue (50% shade) \u2013 alias of button/login active; promoted for general reuse\"\n\t  },\n\t  \"white\": {\n\t\t\"$value\": \"#ffffff\",\n\t\t\"$description\": \"NHS White\"\n\t  },\n\t  \"black\": {\n\t\t\"$value\": \"#212b32\",\n\t\t\"$description\": \"NHS Black\"\n\t  },\n\t  \"green\": {\n\t\t\"$value\": \"#007f3b\",\n\t\t\"$description\": \"NHS Green\"\n\t  },\n\t  \"purple\": {\n\t\t\"$value\": \"#330072\",\n\t\t\"$description\": \"NHS Purple\"\n\t  },\n\t  \"dark-pink\": {\n\t\t\"$value\": \"#7c2855\",\n\t\t\"$description\": \"NHS Dark Pink\"\n\t  },\n\t  \"red\": {\n\t\t\"$value\": \"#d5281b\",\n\t\t\"$description\": \"NHS Red\"\n\t  },\n\t  \"light-purple\": {\n\t\t\"$value\": \"#880FB8\",\n\t\t\"$description\": \"NHS Light Purple (data viz promoted)\"\n\t  },\n\t  \"yellow\": {\n\t\t\"$value\": \"#ffeb3b\",\n\t\t\"$description\": \"NHS Yellow\"\n\t  }\n\t},\n\t\"secondary\": {\n\t  \"$type\": \"color\",\n\t  \"pale-yellow\": {\n\t\t\"$value\": \"#fff9c4\",\n\t\t\"$description\": \"NHS Pale Yellow\"\n\t  },\n\t  \"warm-yellow\": {\n\t\t\"$value\": \"#ffb81c\",\n\t\t\"$description\": \"NHS Warm Yellow\"\n\t  },\n\t  \"region-yellow\": {\n\t\t\"$value\": \"#FAE100\",\n\t\t\"$description\": \"NHS Region Yellow (maps)\"\n\t  },\n\t  \"orange\": {\n\t\t\"$value\": \"#ed8b00\",\n\t\t\"$description\": \"NHS Orange\"\n\t  },\n\t  \"tangerine\": {\n\t\t\"$value\": \"#ED4F00\",\n\t\t\"$description\": \"NHS Tangerine (data viz promoted)\"\n\t  },\n\t  \"aqua-green\": {\n\t\t\"$value\": \"#00a499\",\n\t\t\"$description\": \"NHS Aqua Green\"\n\t  },\n\t  \"light-blue\": {\n\t\t\"$value\": \"#41B6E6\",\n\t\t\"$description\": \"NHS Light Blue (data viz promoted)\"\n\t  },\n\t  \"pink\": {\n\t\t\"$value\": \"#ae2573\",\n\t\t\"$description\": \"NHS Pink\"\n\t  },\n\t  \"bright-pink\": {\n\t\t\"$value\": \"#E317AA\",\n\t\t\"$description\": \"NHS Bright Pink (data viz promoted)\"\n\t  },\n\t  \"light-green\": {\n\t\t\"$value\": \"#78BE20\",\n\t\t\"$description\": \"NHS Light Green (data viz promoted)\"\n\t  },\n\t  \"brown\": {\n\t\t\"$value\": \"#9A6324\",\n\t\t\"$description\": \"NHS Brown (data viz promoted neutral)\"\n\t  }\n\t},\n\t\"grey\": {\n\t  \"$type\": \"color\",\n\t  \"1\": {\n\t\t\"$value\": \"#4c6272\",\n\t\t\"$description\": \"NHS Grey 1 - Darkest grey\"\n\t  },\n\t  \"2\": {\n\t\t\"$value\": \"#768692\",\n\t\t\"$description\": \"NHS Grey 2 - Darker grey\"\n\t  },\n\t  \"3\": {\n\t\t\"$value\": \"#aeb7bd\",\n\t\t\"$description\": \"NHS Grey 3 - Medium grey\"\n\t  },\n\t  \"4\": {\n\t\t\"$value\": \"#d8dde0\",\n\t\t\"$description\": \"NHS Grey 4 - Light grey\"\n\t  },\n\t  \"5\": {\n\t\t\"$value\": \"#f0f4f5\",\n\t\t\"$description\": \"NHS Grey 5 - Lightest grey\"\n\t  }\n\t},\n\t\"accessibility\": {\n\t  \"$type\": \"color\",\n\t  \"$comment\": \"Accessibility-oriented color tokens. Includes CVD-safe pairs and Okabe\u2013Ito colors. Use these for positive/negative semantics and colour-blind\u2013friendly defaults.\",\n\t  \"okabe-ito\": {\n\t\t\"green\": {\n\t\t  \"$value\": \"#009E73\",\n\t\t  \"$description\": \"Okabe\u2013Ito green (CVD-safe) \u2013 recommended positive\"\n\t\t},\n\t\t\"vermillion\": {\n\t\t  \"$value\": \"#D55E00\",\n\t\t  \"$description\": \"Okabe\u2013Ito vermillion / red\u2013orange (CVD-safe) \u2013 recommended negative\"\n\t\t}\n\t  },\n\t  \"cvd-safe\": {\n\t\t\"blue\": {\n\t\t  \"$value\": \"#1f77b4\",\n\t\t  \"$description\": \"CVD-safe blue (pairs with orange); widely used in Matplotlib/Tableau sets\"\n\t\t},\n\t\t\"orange\": {\n\t\t  \"$value\": \"#ff7f0e\",\n\t\t  \"$description\": \"CVD-safe orange (pairs with blue)\"\n\t\t}\n\t  },\n\t  \"positive\": {\n\t\t\"$value\": \"{color.accessibility.okabe-ito.green}\",\n\t\t\"$description\": \"Accessibility semantic alias \u2013 positive\"\n\t  },\n\t  \"negative\": {\n\t\t\"$value\": \"{color.accessibility.okabe-ito.vermillion}\",\n\t\t\"$description\": \"Accessibility semantic alias \u2013 negative\"\n\t  }\n\t}\n  }\n}\n", "// Attempt to source colours from design tokens (data-viz categorical 1..12).\n// We now use static ESM JSON imports (TS resolveJsonModule) so build will surface errors\n// instead of silently swallowing them with dynamic require.\n\nimport dataVizTokens from '../../../../packages/nhs-fdp/tokens/data-viz.json';\nimport colorTokens from '../../../../packages/nhs-fdp/tokens/colors.json';\n\n// Legacy fallback (previous implementation) \u2013 retained to avoid breaking consumers\nconst legacyCategorical = [\n  '#005eb8', '#0072ce', '#41b6e6', '#00a499',\n  '#7c2855', '#330072', '#d5281b', '#ffb81c',\n  '#fae100', '#4c6272', '#768692', '#aeb7bd'\n];\n\nlet categoricalPalette: string[] | null = null;\nlet optimizedCategoricalPalette: string[] | null = null; // reordered for maximal early distinctness\nlet extendedPaletteCache: string[] | null = null; // cache including generated variants beyond base length\n\ntype CategoricalStrategy = 'optimized' | 'raw';\nlet categoricalStrategy: CategoricalStrategy = 'optimized';\n\nexport function setCategoricalColorStrategy(strategy: CategoricalStrategy) {\n  categoricalStrategy = strategy;\n}\nexport function getCategoricalColorStrategy(): CategoricalStrategy { return categoricalStrategy; }\n\nfunction buildPalette(): string[] {\n  const root: any = { color: { ...(colorTokens as any).color, ...(dataVizTokens as any).color } };\n\n    const resolve = (path: string, seen: Set<string> = new Set()): string | undefined => {\n      if (seen.has(path)) return undefined; // circular guard\n      seen.add(path);\n      const node = path.split('.').reduce((acc: any, k) => (acc ? acc[k] : undefined), root);\n      if (!node) return undefined;\n      const value = node.$value || node.value; // support raw & built forms\n      if (typeof value === 'string' && /^\\{.+\\}$/.test(value)) {\n        return resolve(value.slice(1, -1), seen);\n      }\n      if (typeof value === 'string') return value;\n      return undefined;\n    };\n\n    const palette: string[] = [];\n    try {\n      for (let i = 1; i <= 12; i++) {\n        const tokenPath = `color.data-viz.categorical.${i}`;\n        const hex = resolve(tokenPath);\n        if (!hex) throw new Error(`Missing token ${tokenPath}`);\n        palette.push(hex);\n      }\n      return palette;\n    } catch (e) {\n      return legacyCategorical; // hard fallback if tokens unexpectedly incomplete\n    }\n}\n\nfunction getPalette(): string[] {\n  if (!categoricalPalette) categoricalPalette = buildPalette();\n  return categoricalPalette;\n}\n\n// --- Perceptual distinctness optimisation (CIE Lab farthest-point sampling) ---\n// We keep this lightweight (no external deps) with approximate conversions; sufficient for ordering.\ninterface Lab { L: number; a: number; b: number }\n\nfunction hexToRgb(hex: string): { r: number; g: number; b: number } | null {\n  const m = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex.trim());\n  if (!m) return null;\n  return { r: parseInt(m[1], 16), g: parseInt(m[2], 16), b: parseInt(m[3], 16) };\n}\n\n// sRGB -> linear\nfunction srgbToLinear(x: number): number { x /= 255; return x <= 0.04045 ? x / 12.92 : Math.pow((x + 0.055) / 1.055, 2.4); }\n\nfunction rgbToXyz(r: number, g: number, b: number): { x: number; y: number; z: number } {\n  const R = srgbToLinear(r); const G = srgbToLinear(g); const B = srgbToLinear(b);\n  // Observer = 2\u00B0, Illuminant = D65\n  const x = R * 0.4124 + G * 0.3576 + B * 0.1805;\n  const y = R * 0.2126 + G * 0.7152 + B * 0.0722;\n  const z = R * 0.0193 + G * 0.1192 + B * 0.9505;\n  return { x: x * 100, y: y * 100, z: z * 100 };\n}\n\nfunction xyzToLab(x: number, y: number, z: number): Lab {\n  // D65 reference white\n  const refX = 95.047, refY = 100.0, refZ = 108.883;\n  let X = x / refX, Y = y / refY, Z = z / refZ;\n  const f = (t: number) => (t > 0.008856 ? Math.cbrt(t) : (7.787 * t) + 16 / 116);\n  X = f(X); Y = f(Y); Z = f(Z);\n  return { L: (116 * Y) - 16, a: 500 * (X - Y), b: 200 * (Y - Z) };\n}\n\nfunction hexToLab(hex: string): Lab | null {\n  const rgb = hexToRgb(hex);\n  if (!rgb) return null;\n  const xyz = rgbToXyz(rgb.r, rgb.g, rgb.b);\n  return xyzToLab(xyz.x, xyz.y, xyz.z);\n}\n\nfunction deltaE76(c1: Lab, c2: Lab): number {\n  const dL = c1.L - c2.L; const da = c1.a - c2.a; const db = c1.b - c2.b;\n  return Math.sqrt(dL * dL + da * da + db * db);\n}\n\nfunction buildOptimizedCategoricalPalette(): string[] {\n  const base = getPalette();\n  if (base.length <= 2) return base.slice();\n  const labs = base.map(c => hexToLab(c));\n  // Farthest-point sampling: start with colour having max average distance (more central choice) to others.\n  let bestStartIdx = 0; let bestAvg = -1;\n  for (let i = 0; i < base.length; i++) {\n    const li = labs[i]; if (!li) continue;\n    let total = 0; let count = 0;\n    for (let j = 0; j < base.length; j++) if (i !== j && labs[j]) { total += deltaE76(li, labs[j]!); count++; }\n    const avg = total / Math.max(1, count);\n    if (avg > bestAvg) { bestAvg = avg; bestStartIdx = i; }\n  }\n  const remaining = new Set<number>(base.map((_, i) => i));\n  const order: number[] = [];\n  order.push(bestStartIdx); remaining.delete(bestStartIdx);\n  while (remaining.size) {\n    let nextIdx = Array.from(remaining)[0];\n    let bestMin = -1;\n    for (const idx of remaining) {\n      const l = labs[idx]; if (!l) continue;\n      // Distance to closest already-picked colour\n      let minD = Infinity;\n      for (const o of order) {\n        const lo = labs[o]; if (lo) { const d = deltaE76(l, lo); if (d < minD) minD = d; }\n      }\n      if (minD > bestMin) { bestMin = minD; nextIdx = idx; }\n    }\n    order.push(nextIdx); remaining.delete(nextIdx);\n  }\n  return order.map(i => base[i]);\n}\n\nfunction getOptimizedPalette(): string[] {\n  if (!optimizedCategoricalPalette) optimizedCategoricalPalette = buildOptimizedCategoricalPalette();\n  return optimizedCategoricalPalette;\n}\n\nfunction getRawPalette(): string[] { return getPalette(); }\n\n// --- Extended palette generation for > base length ---\n// Creates lightened/darkened variants per base colour cycle while attempting to keep DeltaE separation.\ninterface RGB { r:number; g:number; b:number }\nfunction labToXyz(L:number,a:number,b:number){\n  const y = (L + 16) / 116; const x = a / 500 + y; const z = y - b / 200;\n  const f = (t:number)=>{ const t3 = t*t*t; return t3 > 0.008856 ? t3 : (t - 16/116)/7.787; };\n  const X = f(x) * 95.047; const Y = f(y) * 100; const Z = f(z) * 108.883; return {X,Y,Z};\n}\nfunction xyzToRgb(x:number,y:number,z:number): RGB {\n  x/=100; y/=100; z/=100;\n  let R = x*3.2406 + y*-1.5372 + z*-0.4986;\n  let G = x*-0.9689 + y*1.8758 + z*0.0415;\n  let B = x*0.0557 + y*-0.2040 + z*1.0570;\n  const linToSrgb = (c:number)=> c <= 0.0031308 ? 12.92*c : 1.055*Math.pow(c,1/2.4)-0.055;\n  R = Math.min(1, Math.max(0, linToSrgb(R)));\n  G = Math.min(1, Math.max(0, linToSrgb(G)));\n  B = Math.min(1, Math.max(0, linToSrgb(B)));\n  return { r: Math.round(R*255), g: Math.round(G*255), b: Math.round(B*255) };\n}\nfunction rgbToHex(r:number,g:number,b:number){ return `#${[r,g,b].map(v=>v.toString(16).padStart(2,'0')).join('')}`; }\nfunction adjustLightness(hex:string, deltaL:number): string {\n  const lab = hexToLab(hex); if(!lab) return hex;\n  const L = Math.min(100, Math.max(0, lab.L + deltaL));\n  const {X,Y,Z} = labToXyz(L, lab.a, lab.b);\n  const rgb = xyzToRgb(X,Y,Z);\n  return rgbToHex(rgb.r,rgb.g,rgb.b);\n}\n\nfunction buildExtendedPalette(): string[] {\n  const base = categoricalStrategy === 'raw' ? getRawPalette() : getOptimizedPalette();\n  // Precompute a couple of variant rounds (lighten, darken, lighten+, darken+)\n  const deltas = [12, -12, 24, -24];\n  const variants: string[][] = deltas.map(d => base.map(c => adjustLightness(c, d)));\n  // Interleave: base first, then for each variant level append its colours in optimized order.\n  const extended: string[] = [...base];\n  variants.forEach(v => extended.push(...v));\n  return extended;\n}\n\nfunction getExtendedPalette(): string[] {\n  if (!extendedPaletteCache || extendedPaletteCacheStrategyMismatch()) {\n    extendedPaletteCache = buildExtendedPalette();\n    lastExtendedStrategy = categoricalStrategy;\n  }\n  return extendedPaletteCache;\n}\nlet lastExtendedStrategy: CategoricalStrategy | null = null;\nfunction extendedPaletteCacheStrategyMismatch() { return lastExtendedStrategy !== categoricalStrategy; }\n\nexport function pickSeriesColor(i: number) {\n  const ext = getExtendedPalette();\n  return ext[i % ext.length];\n}\n\n// Export for potential external inspection/testing\nexport function getCategoricalPalette(): string[] { return [...getPalette()]; }\nexport function getOptimizedCategoricalPalette(): string[] { return [...getOptimizedPalette()]; }\nexport function getRawCategoricalPalette(): string[] { return [...getRawPalette()]; }\nexport function getExtendedCategoricalPalette(): string[] { return [...getExtendedPalette()]; }\n\n// Stroke (contrast outline) tokens\nlet categoricalStrokeMap: string[] | null = null;\nlet regionStrokeMap: Record<string,string> | null = null;\nlet severityStrokeMap: Record<string,string> | null = null;\nlet orgLevelStrokeMap: Record<string,string> | null = null;\n\nfunction buildStrokeMaps() {\n  const stroke = (dataVizTokens as any)?.color?.['data-viz']?.stroke;\n  if (stroke) {\n    const cat = stroke.categorical || {};\n    categoricalStrokeMap = [];\n    for (let i=1;i<=12;i++) {\n      const v = cat[String(i)]?.$value || cat[String(i)]?.value;\n      categoricalStrokeMap.push(typeof v === 'string' ? v : '#212b32');\n    }\n    const reg = stroke.region || {};\n    regionStrokeMap = {};\n    Object.keys(reg).forEach(k => {\n      const v = reg[k]?.$value || reg[k]?.value;\n      if (typeof v === 'string') regionStrokeMap![k] = v;\n    });\n    const sev = stroke.severity || {};\n    const org = stroke['org-level'] || {};\n    orgLevelStrokeMap = {};\n    Object.keys(org).forEach(k => {\n      const v = org[k]?.$value || org[k]?.value;\n      if (typeof v === 'string') orgLevelStrokeMap![k] = v;\n    });\n    severityStrokeMap = {};\n    Object.keys(sev).forEach(k => {\n      const v = sev[k]?.$value || sev[k]?.value;\n      if (typeof v === 'string') severityStrokeMap![k] = v;\n    });\n  }\n}\n\nfunction ensureStrokeMaps() {\n  if (!categoricalStrokeMap || !regionStrokeMap || !severityStrokeMap || !orgLevelStrokeMap) buildStrokeMaps();\n}\n\nexport function pickSeriesStroke(i: number) {\n  ensureStrokeMaps();\n  if (!categoricalStrokeMap) return '#212b32';\n  return categoricalStrokeMap[i % categoricalStrokeMap.length];\n}\n\nexport function getRegionStroke(id: string): string | undefined {\n  ensureStrokeMaps();\n  return regionStrokeMap ? regionStrokeMap[id] : undefined;\n}\n\nexport function pickRegionStroke(id: string, fallbackIndex: number): string {\n  return getRegionStroke(id) || pickSeriesStroke(fallbackIndex);\n}\n\n// Severity colours \u2013 semantic alert levels\nexport const SEVERITY_IDS = [ 'low', 'moderate', 'high', 'critical' ] as const;\nexport type SeverityId = typeof SEVERITY_IDS[number];\nlet severityMap: Record<string,string> | null = null;\n\nfunction buildSeverityMap(): Record<string,string> {\n  const root: any = { color: { ...(colorTokens as any).color, ...(dataVizTokens as any).color } };\n  const resolve = (path: string, seen: Set<string> = new Set()): string | undefined => {\n    if (seen.has(path)) return undefined;\n    seen.add(path);\n    const node = path.split('.').reduce((acc: any, k) => (acc ? acc[k] : undefined), root);\n    if (!node) return undefined;\n    const value = node.$value || node.value;\n    if (typeof value === 'string' && /^\\{.+\\}$/.test(value)) return resolve(value.slice(1,-1), seen);\n    return typeof value === 'string' ? value : undefined;\n  };\n  const map: Record<string,string> = {};\n  SEVERITY_IDS.forEach(id => {\n    const hex = resolve(`color.data-viz.severity.${id}`);\n    if (hex) map[id] = hex;\n  });\n  return map;\n}\n\nfunction getSeverityMap(): Record<string,string> { if (!severityMap) severityMap = buildSeverityMap(); return severityMap; }\nexport function getSeverityColor(id: string): string | undefined { return getSeverityMap()[id.toLowerCase()]; }\nexport function pickSeverityColor(id: string, fallbackIndex: number): string {\n  return getSeverityColor(id) || getSeverityMap()[SEVERITY_IDS[fallbackIndex % SEVERITY_IDS.length]] || pickSeriesColor(fallbackIndex);\n}\nexport function getSeverityStroke(id: string): string | undefined { ensureStrokeMaps(); return severityStrokeMap ? severityStrokeMap[id] : undefined; }\nexport function pickSeverityStroke(id: string, fallbackIndex: number): string {\n  return getSeverityStroke(id) || pickSeriesStroke(fallbackIndex);\n}\n\n// Org-level colours (trust, ambulance, icb, region)\nexport const ORG_LEVEL_IDS = [ 'trust', 'ambulance', 'icb', 'region' ] as const;\nexport type OrgLevelId = typeof ORG_LEVEL_IDS[number];\nlet orgLevelMap: Record<string,string> | null = null;\n\nfunction buildOrgLevelMap(): Record<string,string> {\n  const root: any = { color: { ...(colorTokens as any).color, ...(dataVizTokens as any).color } };\n  const resolve = (path: string, seen: Set<string> = new Set()): string | undefined => {\n    if (seen.has(path)) return undefined;\n    seen.add(path);\n    const node = path.split('.').reduce((acc: any, k) => (acc ? acc[k] : undefined), root);\n    if (!node) return undefined;\n    const value = node.$value || node.value;\n    if (typeof value === 'string' && /^\\{.+\\}$/.test(value)) return resolve(value.slice(1,-1), seen);\n    return typeof value === 'string' ? value : undefined;\n  };\n  const map: Record<string,string> = {};\n  ORG_LEVEL_IDS.forEach(id => {\n    const hex = resolve(`color.data-viz.org-level.${id}`);\n    if (hex) map[id] = hex;\n  });\n  return map;\n}\n\nfunction getOrgLevelMap(): Record<string,string> { if (!orgLevelMap) orgLevelMap = buildOrgLevelMap(); return orgLevelMap; }\nexport function getOrgLevelColor(id: string): string | undefined { return getOrgLevelMap()[id.toLowerCase()]; }\nexport function pickOrgLevelColor(id: string, fallbackIndex: number): string {\n  return getOrgLevelColor(id) || getOrgLevelMap()[ORG_LEVEL_IDS[fallbackIndex % ORG_LEVEL_IDS.length]] || pickSeriesColor(fallbackIndex);\n}\nexport function getOrgLevelStroke(id: string): string | undefined { ensureStrokeMaps(); return orgLevelStrokeMap ? orgLevelStrokeMap[id] : undefined; }\nexport function pickOrgLevelStroke(id: string, fallbackIndex: number): string {\n  return getOrgLevelStroke(id) || pickSeriesStroke(fallbackIndex);\n}\n\n// Region colours \u2013 resolved from tokens; key by region token id (kebab-case)\nlet regionMap: Record<string,string> | null = null;\n\n// Canonical list of region token ids we currently support (order stable)\nexport const REGION_IDS = [\n  'north-east',\n  'north-west',\n  'east-of-england',\n  'midlands',\n  'london',\n  'south-west',\n  'south-east'\n] as const;\nexport type RegionId = typeof REGION_IDS[number];\n\n// Normalise user supplied id variants (e.g. \"North East\", \"north_east\", \"NORTH-EAST\") to kebab-case token id.\nexport function normalizeRegionId(id: string): string {\n  return id\n    .trim()\n    .toLowerCase()\n    .replace(/&/g, 'and')\n    .replace(/[^a-z0-9]+/g, '-') // collapse any separator chars/spaces/underscores\n    .replace(/^-+|-+$/g, '');\n}\n\nfunction buildRegionMap(): Record<string,string> {\n  const root: any = { color: { ...(colorTokens as any).color, ...(dataVizTokens as any).color } };\n  const resolve = (path: string, seen: Set<string> = new Set()): string | undefined => {\n    if (seen.has(path)) return undefined;\n    seen.add(path);\n    const node = path.split('.').reduce((acc: any, k) => (acc ? acc[k] : undefined), root);\n    if (!node) return undefined;\n    const value = node.$value || node.value;\n    if (typeof value === 'string' && /^\\{.+\\}$/.test(value)) return resolve(value.slice(1,-1), seen);\n    return typeof value === 'string' ? value : undefined;\n  };\n  const map: Record<string,string> = {};\n  const missing: string[] = [];\n  REGION_IDS.forEach(id => {\n    const hex = resolve(`color.data-viz.region.${id}`);\n    if (hex) map[id] = hex; else missing.push(id);\n  });\n  if (process.env.NODE_ENV !== 'production') {\n    if (Object.keys(map).length === 0) {\n      console.warn('[DataViz] Region colour tokens unresolved \u0013 falling back to categorical colours.');\n    } else if (missing.length) {\n      console.warn(`[DataViz] Missing region colour tokens: ${missing.join(', ')}.`);\n    }\n  }\n  return map;\n}\n\nfunction getRegionMap(): Record<string,string> {\n  if (!regionMap) regionMap = buildRegionMap();\n  return regionMap;\n}\n\nexport function getRegionColor(id: string): string | undefined {\n  return getRegionMap()[normalizeRegionId(id)];\n}\n\n// Convenience: if consumer passes a region-like id we can attempt to auto-map (normalising first).\nexport function pickRegionColor(id: string, fallbackIndex: number): string {\n  return getRegionColor(id) || pickSeriesColor(fallbackIndex);\n}\n\n// Access / maintenance helpers\nexport function getAvailableRegionIds(): string[] { return [...REGION_IDS]; }\n\n// Allow consumers (e.g. during HMR in Storybook) to clear caches if token file changes at runtime.\nexport function invalidateColorCaches(options: { regions?: boolean; categorical?: boolean; strokes?: boolean } = {}) {\n  const { regions = true, categorical = false, strokes = false } = options;\n  if (regions) regionMap = null;\n  if (categorical) {\n    categoricalPalette = null;\n    optimizedCategoricalPalette = null;\n    extendedPaletteCache = null;\n  }\n  if (strokes) {\n    categoricalStrokeMap = null;\n    regionStrokeMap = null;\n  severityStrokeMap = null;\n  orgLevelStrokeMap = null;\n  }\n}\n\nexport interface AssignColorOptions {\n  palette?: 'categorical' | 'region' | 'severity' | 'org-level';\n  random?: boolean; // if true, shuffle palette order before assignment (stable per call)\n}\n\n// Assign colours to a mutable copy of the provided series objects; existing explicit s.color is preserved.\nexport function assignSeriesColors<T extends { id: string; color?: string }>(\n  series: T[],\n  { palette = 'categorical', random = false }: AssignColorOptions = {}\n): T[] {\n  const copy = series.map(s => ({ ...s }));\n  const paletteValues = palette === 'region'\n    ? copy.map((s, i) => pickRegionColor(s.id, i))\n    : palette === 'severity'\n      ? copy.map((s,i)=> pickSeverityColor(s.id, i))\n      : palette === 'org-level'\n        ? copy.map((s,i)=> pickOrgLevelColor(s.id, i))\n    : (series.length > getOptimizedCategoricalPalette().length\n        ? getExtendedCategoricalPalette()\n        : (categoricalStrategy === 'optimized'\n            ? getOptimizedCategoricalPalette()\n            : getRawCategoricalPalette()));\n\n  let order: number[] = palette === 'region'\n    ? copy.map((_, i) => i) // region colours already derived per id position\n    : palette === 'severity'\n      ? copy.map((_, i) => i)\n      : palette === 'org-level'\n        ? copy.map((_, i) => i)\n    : [...Array(paletteValues.length).keys()];\n  if (random) {\n    // Fisher\u2013Yates\n    for (let i = order.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [order[i], order[j]] = [order[j], order[i]];\n    }\n  }\n  let cursor = 0;\n  copy.forEach((s, si) => {\n    if (!s.color) {\n      if (palette === 'region') {\n        s.color = paletteValues[si];\n      } else {\n        const idx = order[cursor % order.length];\n        s.color = paletteValues[idx];\n        cursor++;\n      }\n    }\n  });\n  return copy;\n}\n\n// ---------------------------------------------------------------------------\n// Sequential & Diverging Colour Scale Utilities (token\u2011agnostic helpers)\n// ---------------------------------------------------------------------------\n\n// We intentionally keep these lightweight (no d3 dependency) by reusing the\n// CIE Lab helpers above for perceptual interpolation between arbitrary hexes.\n\nfunction labToHex(L: number, a: number, b: number): string {\n  const {X,Y,Z} = labToXyz(L,a,b);\n  const { r, g, b: bb } = xyzToRgb(X,Y,Z);\n  return rgbToHex(r,g,bb);\n}\n\nfunction interpolateLab(hexA: string, hexB: string, t: number): string {\n  const la = hexToLab(hexA); const lb = hexToLab(hexB);\n  if (!la || !lb) return t < 0.5 ? hexA : hexB;\n  const L = la.L + (lb.L - la.L) * t;\n  const a = la.a + (lb.a - la.a) * t;\n  const b = la.b + (lb.b - la.b) * t;\n  return labToHex(L, a, b);\n}\n\n// Piecewise interpolate across an ordered colour array. t in [0,1].\nfunction interpolateMulti(colors: string[], t: number): string {\n  if (colors.length === 0) return '#000000';\n  if (colors.length === 1) return colors[0];\n  const n = colors.length - 1;\n  const scaled = t * n;\n  const i = Math.min(n - 1, Math.max(0, Math.floor(scaled)));\n  const localT = scaled - i;\n  return interpolateLab(colors[i], colors[i + 1], localT);\n}\n\nexport interface SequentialScaleOptions {\n  domain: [number, number];\n  colors?: string[]; // ordered light -> dark (or vice versa; interpolation is linear across array)\n  steps?: number; // if provided with base colours length === 1 generate light/dark variants\n  clamp?: boolean;\n  baseColor?: string; // fallback single colour (default brand blue)\n  lightnessSpan?: number; // total L* delta to distribute either side when auto\u2011generating\n}\n\n/** Create a sequential colour scale (continuous). */\nexport function createSequentialColorScale({\n  domain,\n  colors,\n  steps = 7,\n  clamp = true,\n  baseColor = '#005eb8',\n  lightnessSpan = 60\n}: SequentialScaleOptions) {\n  let [d0, d1] = domain;\n  if (d0 === d1) { d1 = d0 + 1; } // guard zero range\n  if (d1 < d0) { const tmp = d0; d0 = d1; d1 = tmp; }\n\n  let palette: string[] = [];\n  if (colors && colors.length > 1) palette = colors.slice();\n  else if (colors && colors.length === 1) { baseColor = colors[0]; }\n  if (!palette.length) {\n    // Auto\u2011generate by sampling lightness around the base colour.\n    const lab = hexToLab(baseColor) || { L: 50, a: 0, b: 0 };\n    const half = lightnessSpan / 2;\n    // Distribute steps from light (higher L) to dark (lower L)\n    const minL = Math.max(2, lab.L - half);\n    const maxL = Math.min(98, lab.L + half);\n    palette = Array.from({ length: steps }).map((_, i) => {\n      const t = i / Math.max(1, steps - 1); // 0..1\n      const L = maxL - (maxL - minL) * t; // descending light->dark\n      return labToHex(L, lab.a, lab.b);\n    });\n  }\n\n  const range = d1 - d0;\n  return (value: number) => {\n    let t = (value - d0) / range; // may be <0 or >1\n    if (clamp) t = Math.min(1, Math.max(0, t));\n    return interpolateMulti(palette, t);\n  };\n}\n\nexport interface DivergingScaleOptions {\n  domain: [number, number, number]; // [min, mid, max]; mid acts as neutral pivot\n  colors?: string[]; // >=3 colours; if exactly 3 => [negative, neutral, positive]\n  negativeColor?: string; // used if no explicit colours\n  positiveColor?: string;\n  neutralColor?: string;\n  stepsPerSide?: number; // used when auto\u2011generating from neg/pos + neutral\n  clamp?: boolean;\n}\n\n/** Create a diverging colour scale. */\nexport function createDivergingColorScale({\n  domain,\n  colors,\n  negativeColor = '#d5281b', // NHS error/red\n  positiveColor = '#007f3b', // NHS green\n  neutralColor = '#f2f2f2',\n  stepsPerSide = 3,\n  clamp = true\n}: DivergingScaleOptions) {\n  let [d0, dm, d1] = domain;\n  // Ensure ordering\n  if (!(d0 <= dm && dm <= d1)) {\n    const sorted = [d0, dm, d1].sort((a,b)=>a-b);\n    [d0, dm, d1] = sorted as [number, number, number];\n  }\n  if (d0 === d1) { d1 = d0 + 1; dm = d0 + 0.5; }\n  if (dm === d0) dm = d0 + (d1 - d0) / 2;\n  if (dm === d1) dm = d0 + (d1 - d0) / 2;\n\n  let palette: string[] = [];\n  if (colors && colors.length >= 3) palette = colors.slice();\n  if (!palette.length) {\n    // Auto\u2011generate side ramps from neg/pos towards neutral (lightening each side)\n    const negLab = hexToLab(negativeColor) || { L: 40, a: 60, b: 40 } as any;\n    const posLab = hexToLab(positiveColor) || { L: 40, a: -60, b: 40 } as any;\n    const neuLab = hexToLab(neutralColor) || { L: 96, a: 0, b: 0 } as any;\n    const negRamp = Array.from({ length: stepsPerSide }).map((_, i) => {\n      const t = i / Math.max(1, stepsPerSide - 1); // 0..1 towards neutral\n      return labToHex(\n        negLab.L + (neuLab.L - negLab.L) * t,\n        negLab.a + (neuLab.a - negLab.a) * t,\n        negLab.b + (neuLab.b - negLab.b) * t\n      );\n    });\n    const posRamp = Array.from({ length: stepsPerSide }).map((_, i) => {\n      const t = i / Math.max(1, stepsPerSide - 1);\n      return labToHex(\n        neuLab.L + (posLab.L - neuLab.L) * t,\n        neuLab.a + (posLab.a - neuLab.a) * t,\n        neuLab.b + (posLab.b - neuLab.b) * t\n      );\n    });\n    // Combine, ensuring single neutral duplicate removal\n    palette = [...negRamp.slice(0, -1), ...posRamp];\n  }\n\n  // Build two segments: [d0..dm] and [dm..d1]. We normalise t separately for each half.\n  const left = palette.slice(0, Math.ceil(palette.length / 2));\n  const right = palette.slice(Math.floor(palette.length / 2));\n  return (value: number) => {\n    if (clamp) value = Math.min(d1, Math.max(d0, value));\n    if (value <= dm) {\n      const t = (value - d0) / (dm - d0 || 1);\n      return interpolateMulti(left, t);\n    }\n    const t = (value - dm) / (d1 - dm || 1);\n    return interpolateMulti(right, t);\n  };\n}\n\n// Convenience categorical wrapper that selects between scale factories based on config.\nexport type ColorScale = (value: number) => string;\nexport type ColorScaleConfig =\n  | ({ type: 'sequential' } & SequentialScaleOptions)\n  | ({ type: 'diverging' } & DivergingScaleOptions);\n\nexport function createColorScale(config: ColorScaleConfig): ColorScale {\n  if (config.type === 'sequential') return createSequentialColorScale(config);\n  return createDivergingColorScale(config);\n}\n\n", "import * as React from 'react';\n\nexport interface VisibilityContextValue {\n  hiddenIds: Set<string>;\n  isHidden: (id: string) => boolean;\n  toggle: (id: string) => void;\n  showOnly: (id: string) => void;\n  showAll: () => void;\n  setHidden: (ids: string[] | Set<string>) => void;\n}\n\nconst VisibilityContext = React.createContext<VisibilityContextValue | null>(null);\nexport const useVisibility = () => React.useContext(VisibilityContext);\n\nexport interface VisibilityProviderProps {\n  initialHiddenIds?: string[];\n  children: React.ReactNode;\n  /** Optional controlled hidden set (if provided, component becomes controlled) */\n  hiddenIds?: string[];\n  onChange?: (hidden: string[]) => void;\n}\n\nexport const VisibilityProvider: React.FC<VisibilityProviderProps> = ({\n  initialHiddenIds = [],\n  children,\n  hiddenIds: controlledHidden,\n  onChange\n}) => {\n  const [uncontrolled, setUncontrolled] = React.useState<Set<string>>(() => new Set(initialHiddenIds));\n  const isControlled = controlledHidden !== undefined;\n  const hiddenSet = React.useMemo(() => isControlled ? new Set(controlledHidden) : uncontrolled, [isControlled, controlledHidden, uncontrolled]);\n\n  const update = React.useCallback((next: Set<string>) => {\n    if (!isControlled) setUncontrolled(new Set(next));\n    onChange?.(Array.from(next));\n  }, [isControlled, onChange]);\n\n  const api: VisibilityContextValue = React.useMemo(() => ({\n    hiddenIds: hiddenSet,\n    isHidden: (id: string) => hiddenSet.has(id),\n    toggle: (id: string) => {\n      const next = new Set(hiddenSet);\n      next.has(id) ? next.delete(id) : next.add(id);\n      update(next);\n    },\n  showOnly: (_id: string) => {\n      // Future: require full ids set to hide others. For now just clear hidden set making all visible.\n      update(new Set());\n    },\n    showAll: () => update(new Set()),\n    setHidden: (ids) => update(new Set(Array.isArray(ids) ? ids : Array.from(ids)))\n  }), [hiddenSet, update]);\n\n  return <VisibilityContext.Provider value={api}>{children}</VisibilityContext.Provider>;\n};\n\nexport default VisibilityContext;\n", "import * as React from \"react\";\nimport { useScaleContext } from \"./ScaleContext\";\nimport { useVisibility } from \"./VisibilityContext\";\n\nexport interface TooltipDatum {\n\tseriesId: string;\n\tindex: number; // index within series\n\tx: Date | string | number; // allow categorical values\n\ty: number;\n\tclientX: number; // scaled x position within plot area\n\tclientY: number; // scaled y position within plot area\n}\n\nexport interface TooltipContextValue {\n\tfocused: TooltipDatum | null;\n\tsetFocused: (d: TooltipDatum | null) => void;\n\t/** All series points sharing the focused x (including focused point) when multiple series align. Length 0 when no focus, 1 when single. */\n\taggregated: TooltipDatum[];\n\t/** Programmatic focus of nearest datum to given SVG plot coordinates (already in inner coordinate space). */\n\tfocusNearest: (plotX: number, plotY: number) => void;\n\t/** Clear current focus */\n\tclear: () => void;\n\t/** Register series data for nearest-point lookup */\n\tregisterSeries: (\n\t\tseriesId: string,\n\t\tdata: { x: Date | string | number; y: number }[]\n\t) => void;\n\tunregisterSeries: (seriesId: string) => void;\n\t/** Move focus to next point in same series */\n\tfocusNextPoint: () => void;\n\t/** Move focus to previous point in same series */\n\tfocusPrevPoint: () => void;\n\t/** Cycle to next series at same index (if exists) */\n\tfocusNextSeries: () => void;\n\t/** Cycle to previous series at same index (if exists) */\n\tfocusPrevSeries: () => void;\n\t/** Jump to first point in current (or first) series */\n\tfocusFirstPoint: () => void;\n\t/** Jump to last point in current (or first) series */\n\tfocusLastPoint: () => void;\n}\n\nconst TooltipContext = React.createContext<TooltipContextValue | null>(null);\nexport const useTooltipContext = () => React.useContext(TooltipContext);\n\ninterface TooltipProviderProps {\n\tchildren: React.ReactNode;\n\t/** Maximum pixel distance to accept a nearest match (otherwise focus cleared) */\n\tmaxDistance?: number;\n\t/** Allow wrap-around when navigating past start/end of points or series */\n\twrapAround?: boolean;\n}\n\n/** Shared tooltip / focus context: unifies pointer & keyboard focus of a single datum across chart primitives. */\nexport const TooltipProvider: React.FC<TooltipProviderProps> = ({\n\tchildren,\n\tmaxDistance = 40,\n\twrapAround = false,\n}) => {\n\tconst scaleCtx = useScaleContext();\n\tconst visibility = useVisibility();\n\tconst [focused, setFocused] = React.useState<TooltipDatum | null>(null);\n\tconst seriesRef = React.useRef<\n\t\tMap<string, { x: Date | string | number; y: number }[]>\n\t>(new Map());\n\tconst [aggregated, setAggregated] = React.useState<TooltipDatum[]>([]);\n\n\tconst registerSeries = React.useCallback(\n\t\t(seriesId: string, data: { x: Date | string | number; y: number }[]) => {\n\t\t\tseriesRef.current.set(seriesId, data);\n\t\t},\n\t\t[]\n\t);\n\tconst unregisterSeries = React.useCallback((seriesId: string) => {\n\t\tseriesRef.current.delete(seriesId);\n\t}, []);\n\n\tconst focusNearest = React.useCallback(\n\t\t(plotX: number, plotY: number) => {\n\t\t\tif (!scaleCtx) return;\n\t\t\tconst { xScale, yScale } = scaleCtx;\n\t\t\tlet best: TooltipDatum | null = null;\n\t\t\tlet bestDist = Infinity;\n\t\t\tseriesRef.current.forEach((data, sid) => {\n\t\t\t\tdata.forEach((d, i) => {\n\t\t\t\t\tconst px = xScale(d.x);\n\t\t\t\t\tconst py = yScale(d.y);\n\t\t\t\t\tconst dx = px - plotX;\n\t\t\t\t\tconst dy = py - plotY;\n\t\t\t\t\tconst dist = Math.sqrt(dx * dx + dy * dy);\n\t\t\t\t\tif (dist < bestDist) {\n\t\t\t\t\t\tbestDist = dist;\n\t\t\t\t\t\tbest = {\n\t\t\t\t\t\t\tseriesId: sid,\n\t\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\t\tx: d.x,\n\t\t\t\t\t\t\ty: d.y,\n\t\t\t\t\t\t\tclientX: px,\n\t\t\t\t\t\t\tclientY: py,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tif (best && bestDist <= maxDistance) setFocused(best);\n\t\t\telse setFocused(null);\n\t\t},\n\t\t[scaleCtx, maxDistance]\n\t);\n\n\tconst clear = React.useCallback(() => setFocused(null), []);\n\n\t// Recompute aggregated aligned points whenever focused changes\n\tReact.useEffect(() => {\n\t\tif (!focused) {\n\t\t\tsetAggregated([]);\n\t\t\treturn;\n\t\t}\n\t\t// Collect all points with identical x timestamp (exact match) across visible (registered) series\n\t\tif (!scaleCtx) return;\n\t\tconst { xScale, yScale } = scaleCtx;\n\t\tconst agg: TooltipDatum[] = [];\n\t\tseriesRef.current.forEach((data, sid) => {\n\t\t\tdata.forEach((d, i) => {\n\t\t\t\tconst match = ((): boolean => {\n\t\t\t\t\tif (focused.x instanceof Date && d.x instanceof Date)\n\t\t\t\t\t\treturn d.x.getTime() === focused.x.getTime();\n\t\t\t\t\treturn d.x === focused.x; // strict equality for non-dates\n\t\t\t\t})();\n\t\t\t\tif (match) {\n\t\t\t\t\tagg.push({\n\t\t\t\t\t\tseriesId: sid,\n\t\t\t\t\t\tindex: i,\n\t\t\t\t\t\tx: d.x,\n\t\t\t\t\t\ty: d.y,\n\t\t\t\t\t\tclientX: xScale(d.x as any),\n\t\t\t\t\t\tclientY: yScale(d.y),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\t// Sort by seriesId for stable output\n\t\tagg.sort((a, b) => a.seriesId.localeCompare(b.seriesId));\n\t\tsetAggregated(agg);\n\t}, [focused, scaleCtx]);\n\n\tconst focusRelativePoint = React.useCallback(\n\t\t(delta: 1 | -1) => {\n\t\t\tif (!focused) return;\n\t\t\tconst data = seriesRef.current.get(focused.seriesId);\n\t\t\tif (!data) return;\n\t\t\tlet nextIndex = focused.index + delta;\n\t\t\tif (nextIndex < 0 || nextIndex >= data.length) {\n\t\t\t\tif (!wrapAround) return;\n\t\t\t\t// wrap\n\t\t\t\tnextIndex = (nextIndex + data.length) % data.length;\n\t\t\t}\n\t\t\tconst d = data[nextIndex];\n\t\t\tif (!scaleCtx) return;\n\t\t\tconst { xScale, yScale } = scaleCtx;\n\t\t\tsetFocused({\n\t\t\t\tseriesId: focused.seriesId,\n\t\t\t\tindex: nextIndex,\n\t\t\t\tx: d.x,\n\t\t\t\ty: d.y,\n\t\t\t\tclientX: xScale(d.x),\n\t\t\t\tclientY: yScale(d.y),\n\t\t\t});\n\t\t},\n\t\t[focused, scaleCtx, wrapAround]\n\t);\n\n\tconst focusSeriesAtIndex = React.useCallback( (seriesDelta: 1 | -1) => {\n\t\t\tlet ids = Array.from(seriesRef.current.keys());\n\t\t\t// Skip hidden series (if visibility context present)\n\t\t\tif (visibility) ids = ids.filter((id) => !visibility.isHidden(id));\n\t\t\tif (ids.length === 0) return;\n\t\t\tif (!focused) {\n\t\t\t\t// pick first series first point\n\t\t\t\tconst first = ids[0];\n\t\t\t\tconst data = seriesRef.current.get(first);\n\t\t\t\tif (!data || !scaleCtx) return;\n\t\t\t\tconst { xScale, yScale } = scaleCtx;\n\t\t\t\tconst d = data[0];\n\t\t\t\tsetFocused({\n\t\t\t\t\tseriesId: first,\n\t\t\t\t\tindex: 0,\n\t\t\t\t\tx: d.x,\n\t\t\t\t\ty: d.y,\n\t\t\t\t\tclientX: xScale(d.x),\n\t\t\t\t\tclientY: yScale(d.y),\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst currentSeriesIdx = ids.indexOf(focused.seriesId);\n\t\t\tif (currentSeriesIdx === -1) return;\n\t\t\tlet nextSeriesIdx = currentSeriesIdx + seriesDelta;\n\t\t\tif (nextSeriesIdx < 0 || nextSeriesIdx >= ids.length) {\n\t\t\t\tif (!wrapAround) return; // clamp\n\t\t\t\tnextSeriesIdx = (nextSeriesIdx + ids.length) % ids.length;\n\t\t\t}\n\t\t\tconst nextSeriesId = ids[nextSeriesIdx];\n\t\t\tconst nextData = seriesRef.current.get(nextSeriesId);\n\t\t\tif (!nextData || !scaleCtx) return;\n\t\t\tconst idx = Math.min(focused.index, nextData.length - 1);\n\t\t\tconst d = nextData[idx];\n\t\t\tconst { xScale, yScale } = scaleCtx;\n\t\t\tsetFocused({\n\t\t\t\tseriesId: nextSeriesId,\n\t\t\t\tindex: idx,\n\t\t\t\tx: d.x,\n\t\t\t\ty: d.y,\n\t\t\t\tclientX: xScale(d.x),\n\t\t\t\tclientY: yScale(d.y),\n\t\t\t});\n\t\t},\n\t\t[focused, scaleCtx, wrapAround, visibility]\n\t);\n\tconst focusFirstPoint = React.useCallback(() => {\n\t\t// Within current focused series; if none, pick first visible series\n\t\tlet ids = Array.from(seriesRef.current.keys());\n\t\tif (visibility) ids = ids.filter((id) => !visibility.isHidden(id));\n\t\tif (ids.length === 0) return;\n\t\tconst targetSeriesId = focused ? focused.seriesId : ids[0];\n\t\tconst data = seriesRef.current.get(targetSeriesId);\n\t\tif (!data || data.length === 0 || !scaleCtx) return;\n\t\tconst d = data[0];\n\t\tconst { xScale, yScale } = scaleCtx;\n\t\tsetFocused({\n\t\t\tseriesId: targetSeriesId,\n\t\t\tindex: 0,\n\t\t\tx: d.x,\n\t\t\ty: d.y,\n\t\t\tclientX: xScale(d.x),\n\t\t\tclientY: yScale(d.y),\n\t\t});\n\t}, [focused, scaleCtx, visibility]);\n\n\tconst focusLastPoint = React.useCallback(() => {\n\t\tlet ids = Array.from(seriesRef.current.keys());\n\t\tif (visibility) ids = ids.filter((id) => !visibility.isHidden(id));\n\t\tif (ids.length === 0) return;\n\t\tconst targetSeriesId = focused ? focused.seriesId : ids[0];\n\t\tconst data = seriesRef.current.get(targetSeriesId);\n\t\tif (!data || data.length === 0 || !scaleCtx) return;\n\t\tconst lastIndex = data.length - 1;\n\t\tconst d = data[lastIndex];\n\t\tconst { xScale, yScale } = scaleCtx;\n\t\tsetFocused({\n\t\t\tseriesId: targetSeriesId,\n\t\t\tindex: lastIndex,\n\t\t\tx: d.x,\n\t\t\ty: d.y,\n\t\t\tclientX: xScale(d.x),\n\t\t\tclientY: yScale(d.y),\n\t\t});\n\t}, [focused, scaleCtx, visibility]);\n\n\tconst focusNextPoint = React.useCallback(\n\t\t() => focusRelativePoint(1),\n\t\t[focusRelativePoint]\n\t);\n\tconst focusPrevPoint = React.useCallback(\n\t\t() => focusRelativePoint(-1),\n\t\t[focusRelativePoint]\n\t);\n\tconst focusNextSeries = React.useCallback(\n\t\t() => focusSeriesAtIndex(1),\n\t\t[focusSeriesAtIndex]\n\t);\n\tconst focusPrevSeries = React.useCallback(\n\t\t() => focusSeriesAtIndex(-1),\n\t\t[focusSeriesAtIndex]\n\t);\n\n\tconst value: TooltipContextValue = React.useMemo(\n\t\t() => ({\n\t\t\tfocused,\n\t\t\tsetFocused,\n\t\t\taggregated,\n\t\t\tfocusNearest,\n\t\t\tclear,\n\t\t\tregisterSeries,\n\t\t\tunregisterSeries,\n\t\t\tfocusNextPoint,\n\t\t\tfocusPrevPoint,\n\t\t\tfocusNextSeries,\n\t\t\tfocusPrevSeries,\n\t\t\tfocusFirstPoint,\n\t\t\tfocusLastPoint,\n\t\t}),\n\t\t[\n\t\t\tfocused,\n\t\t\taggregated,\n\t\t\tfocusNearest,\n\t\t\tclear,\n\t\t\tregisterSeries,\n\t\t\tunregisterSeries,\n\t\t\tfocusNextPoint,\n\t\t\tfocusPrevPoint,\n\t\t\tfocusNextSeries,\n\t\t\tfocusPrevSeries,\n\t\t\tfocusFirstPoint,\n\t\t\tfocusLastPoint,\n\t\t]\n\t);\n\n\treturn (\n\t\t<TooltipContext.Provider value={value}>{children}</TooltipContext.Provider>\n\t);\n};\n\nexport default TooltipContext;\n", "import * as React from 'react';\nimport { useTooltipContext } from '../core/TooltipContext';\n\n/**\n * ARIA live region announcing the currently focused data point for screen reader users.\n * Mount inside TooltipProvider scope (e.g. within LineChart). Hidden visually.\n */\nconst VisuallyHiddenLiveRegion: React.FC<{ polite?: boolean; format?: (d: { seriesId: string; x: Date | string | number; y: number; index: number }) => string }>\n  = ({ polite = true, format }) => {\n  const tooltip = useTooltipContext();\n  const [message, setMessage] = React.useState('');\n  const lastRef = React.useRef<string>('');\n\n  React.useEffect(() => {\n    if (!tooltip?.focused) return;\n    const { focused, aggregated } = tooltip;\n    let msg: string;\n    if (aggregated && aggregated.length > 1) {\n      // Aggregate announcement\n      const parts = aggregated.map(a => `${a.seriesId} ${a.y}`).join('; ');\n  const xLabel = focused.x instanceof Date ? focused.x.toDateString() : String(focused.x);\n  msg = `${xLabel} \u2013 ${parts}`;\n    } else {\n      msg = format ? format({ seriesId: focused.seriesId, x: focused.x, y: focused.y, index: focused.index })\n        : defaultFormatter(focused.seriesId, focused.x, focused.y, focused.index);\n    }\n    if (msg !== lastRef.current) {\n      lastRef.current = msg;\n      // Force screen reader to re-announce by clearing then setting (some AT benefit from refresh)\n      setMessage('');\n      const timeout = setTimeout(() => setMessage(msg), 10);\n      return () => clearTimeout(timeout);\n    }\n  }, [tooltip?.focused, format]);\n\n  return (\n    <div\n      aria-live={polite ? 'polite' : 'assertive'}\n      aria-atomic=\"true\"\n      style={{ position: 'absolute', width: 1, height: 1, margin: -1, padding: 0, overflow: 'hidden', clip: 'rect(0 0 0 0)', border: 0 }}\n    >\n      {message}\n    </div>\n  );\n};\n\nfunction defaultFormatter(seriesId: string, x: Date | string | number, y: number, index: number) {\n  const xLabel = x instanceof Date ? x.toDateString() : String(x);\n  return `Series ${seriesId}, point ${index + 1}, ${xLabel}, value ${y}`;\n}\n\nexport default VisuallyHiddenLiveRegion;\n", "import * as React from 'react';\nimport { useTooltipContext } from '../core/TooltipContext';\nimport { useChartContext } from '../core/ChartRoot';\nimport { pickSeriesColor } from '../utils/colors';\n\n/** Basic overlay showing a single focused datum (from TooltipContext). */\nexport const TooltipOverlay: React.FC = () => {\n  const tooltip = useTooltipContext();\n  const chart = useChartContext();\n  if (!tooltip || !chart || !tooltip.focused) return null;\n  const { focused, aggregated } = tooltip;\n  const { innerWidth, innerHeight } = chart;\n  const clampX = Math.min(Math.max(focused.clientX, 0), innerWidth);\n  const clampY = Math.min(Math.max(focused.clientY, 0), innerHeight);\n  const bgX = clampX + 8;\n  const bgY = clampY - 8;\n  const multi = aggregated.length > 1;\n  const dateLabel = focused.x instanceof Date ? focused.x.toDateString() : String(focused.x);\n  const label = multi ? dateLabel : `${dateLabel} \u2022 ${focused.y}`;\n  // Derive base series colour (fallback to NHS blue if util absent)\n  // We only have seriesId; attempt to parse trailing digits else fallback index 0\n  const idDigits = /\\d+$/.exec(focused.seriesId || '');\n  const seriesIdx = idDigits ? parseInt(idDigits[0], 10) - 1 : 0;\n  const seriesColor = pickSeriesColor(seriesIdx >=0 ? seriesIdx : 0) || '#005eb8';\n  // NHS focus yellow via CSS variable with fallback\n  const focusYellow = 'var(--nhs-fdp-color-primary-yellow,#ffeb3b)';\n  return (\n    <g className=\"fdp-tooltip-layer\" pointerEvents=\"none\">\n  {/* Reduced outer focus ring close to point size */}\n  <circle cx={clampX} cy={clampY} r={7} fill=\"none\" stroke={focusYellow} strokeWidth={3} />\n  {/* Inner white core with yellow stroke hugging point */}\n  <circle cx={clampX} cy={clampY} r={5} fill=\"#000\" stroke={focusYellow} strokeWidth={1.5} />\n  {/* Centre dot in series colour */}\n  <circle cx={clampX} cy={clampY} r={2.5} fill={seriesColor} stroke=\"#fff\" strokeWidth={0.5} />\n      {multi ? (\n        (() => {\n          const lineHeight = 16;\n          const rows = aggregated.map(a => `${a.seriesId}: ${a.y}`);\n          const content = [label, ...rows];\n          const maxChars = content.reduce((m,s)=>Math.max(m,s.length),0);\n          const width = Math.max(90, maxChars * 6.2 + 16);\n          const height = lineHeight * content.length + 8;\n          return (\n            <g>\n              <rect x={bgX} y={bgY - height} rx={4} ry={4} width={width} height={height} fill=\"#212b32\" opacity={0.92} />\n              {content.map((t,i) => (\n                <text key={i} x={bgX + 8} y={bgY - height + 6 + lineHeight*(i+0.7)} fill=\"#fff\" fontSize={12}>{t}</text>\n              ))}\n            </g>\n          );\n        })()\n      ) : (\n        <g>\n          <rect x={bgX} y={bgY - 24} rx={4} ry={4} width={Math.max(60, label.length * 6.2)} height={24} fill=\"#212b32\" opacity={0.92} />\n          <text x={bgX + 8} y={bgY - 8} fill=\"#fff\" fontSize={12}>{label}</text>\n        </g>\n      )}\n    </g>\n  );\n};\n\nexport default TooltipOverlay;\n", "import React, { useState, useCallback, useRef, forwardRef, useImperativeHandle } from 'react';\nimport classNames from 'classnames';\nimport { TabsProps, TabItemId, TabsHandle, TabItem } from './Tabs.types';\nimport './Tabs.scss';\n\n// Export TabsHandle type for external use\nexport type { TabsHandle } from './Tabs.types';\n\n/**\n * NHS Tabs Component\n * \n * A tabs component for organizing related content into separate views.\n * Follows NHS design guidelines and accessibility standards.\n * \n * @param props - Tabs component props\n * @returns JSX element\n */\nexport const Tabs = forwardRef<TabsHandle, TabsProps>(({\n  items,\n  defaultActiveTab,\n  activeTab: controlledActiveTab,\n  onTabChange,\n  onTabFocus,\n  onTabListBlur,\n  onEscape,\n  autoActivate = true,\n  className,\n  id,\n  'data-testid': testId,\n  ...props\n}, ref) => {\n  // Determine if component is controlled or uncontrolled\n  const isControlled = controlledActiveTab !== undefined;\n  \n  // Internal state for uncontrolled mode\n  const [internalActiveTab, setInternalActiveTab] = useState<TabItemId>(() => {\n    return defaultActiveTab || items[0]?.id || '';\n  });\n  \n  // Current active tab (controlled or uncontrolled)\n  const activeTab = isControlled ? controlledActiveTab : internalActiveTab;\n  \n  // Refs for keyboard navigation\n  const tabListRef = useRef<HTMLDivElement>(null);\n  const tabRefs = useRef<Map<TabItemId, HTMLButtonElement>>(new Map());\n  \n  // Handle tab selection\n  const handleTabClick = useCallback((tabId: TabItemId) => {\n    if (!isControlled) {\n      setInternalActiveTab(tabId);\n    }\n    onTabChange?.(tabId);\n  }, [isControlled, onTabChange]);\n  \n  // Handle tab focus\n  const handleTabFocus = useCallback((tabId: TabItemId) => {\n    onTabFocus?.(tabId);\n    if (autoActivate) {\n      handleTabClick(tabId);\n    }\n  }, [onTabFocus, autoActivate, handleTabClick]);\n  \n  // Keyboard navigation\n  const handleKeyDown = useCallback((event: React.KeyboardEvent, tabId: TabItemId) => {\n    const tabIds = items.filter((item: TabItem) => !item.disabled).map((item: TabItem) => item.id);\n    const currentIndex = tabIds.indexOf(tabId);\n    \n    let newIndex: number | null = null;\n    \n    switch (event.key) {\n      case 'ArrowLeft':\n        newIndex = currentIndex > 0 ? currentIndex - 1 : tabIds.length - 1;\n        break;\n      case 'ArrowRight':\n        newIndex = currentIndex < tabIds.length - 1 ? currentIndex + 1 : 0;\n        break;\n      case 'Home':\n        newIndex = 0;\n        break;\n      case 'End':\n        newIndex = tabIds.length - 1;\n        break;\n      case 'Escape':\n        event.preventDefault();\n        onEscape?.();\n        return;\n      default:\n        return;\n    }\n    \n    if (newIndex !== null) {\n      event.preventDefault();\n      const newTabId = tabIds[newIndex];\n      const newTabRef = tabRefs.current.get(newTabId);\n      if (newTabRef) {\n        newTabRef.focus();\n        handleTabFocus(newTabId);\n      }\n    }\n  }, [items, handleTabFocus, onEscape]);\n  \n  // Set tab ref\n  const setTabRef = useCallback((tabId: TabItemId, element: HTMLButtonElement | null) => {\n    if (element) {\n      tabRefs.current.set(tabId, element);\n    } else {\n      tabRefs.current.delete(tabId);\n    }\n  }, []);\n  \n  // Focus a specific tab (for external control)\n  const focusTab = useCallback((tabId: TabItemId) => {\n    const tabRef = tabRefs.current.get(tabId);\n    if (tabRef) {\n      tabRef.focus();\n    }\n  }, []);\n  \n  // Expose ref methods\n  useImperativeHandle(ref, () => ({\n    focusTab,\n    getActiveTab: () => activeTab,\n    getTabListElement: () => tabListRef.current,\n  }), [focusTab, activeTab]);\n  \n  // Handle blur from tablist\n  const handleTabListBlur = useCallback((event: React.FocusEvent) => {\n    // Check if focus is moving outside the tablist\n    const relatedTarget = event.relatedTarget as Element;\n    if (!tabListRef.current?.contains(relatedTarget)) {\n      onTabListBlur?.();\n    }\n  }, [onTabListBlur]);\n  \n  // Build CSS classes\n  const tabsClasses = classNames('nhsuk-tabs', className);\n  \n  return (\n    <div \n      className={tabsClasses}\n      id={id}\n      data-testid={testId}\n      {...props}\n    >\n      <h2 className=\"nhsuk-tabs__title\">Contents</h2>\n      \n      <div \n        className=\"nhsuk-tabs__list-container\"\n        ref={tabListRef}\n      >\n        <ul \n          className=\"nhsuk-tabs__list\"\n          role=\"tablist\"\n          onBlur={handleTabListBlur}\n        >\n          {items.map((item: TabItem) => {\n            const isActive = item.id === activeTab;\n            const isDisabled = item.disabled;\n            \n            const tabClasses = classNames('nhsuk-tabs__list-item', {\n              'nhsuk-tabs__list-item--selected': isActive,\n              'nhsuk-tabs__list-item--disabled': isDisabled,\n            });\n            \n            return (\n              <li key={item.id} className={tabClasses} role=\"presentation\">\n                <button\n                  ref={(element) => setTabRef(item.id, element)}\n                  className=\"nhsuk-tabs__tab\"\n                  role=\"tab\"\n                  aria-selected={isActive}\n                  aria-controls={`${item.id}-panel`}\n                  id={`${item.id}-tab`}\n                  tabIndex={isActive ? 0 : -1}\n                  disabled={isDisabled}\n                  onClick={() => !isDisabled && handleTabClick(item.id)}\n                  onKeyDown={(event) => !isDisabled && handleKeyDown(event, item.id)}\n                  onFocus={() => !isDisabled && handleTabFocus(item.id)}\n                  {...item.attributes}\n                >\n                  {item.label}\n                </button>\n              </li>\n            );\n          })}\n        </ul>\n      </div>\n      \n      {items.map((item: TabItem) => {\n        const isActive = item.id === activeTab;\n        \n        return (\n          <div\n            key={item.id}\n            className=\"nhsuk-tabs__panel\"\n            role=\"tabpanel\"\n            aria-labelledby={`${item.id}-tab`}\n            id={`${item.id}-panel`}\n            hidden={!isActive}\n          >\n            {item.content}\n          </div>\n        );\n      })}\n    </div>\n  );\n});\n", "import * as React from \"react\";\nconst { forwardRef, useCallback, useState } = React;\nimport { ButtonVariant, ButtonSize, ButtonVariantLike, ButtonSizeLike } from \"./Button.types\";\nimport \"./Button.scss\";\nimport { mapButtonProps } from \"../../mapping/button\";\n\n/**\n * Base props for NHS Button component\n */\ninterface BaseButtonProps {\n\t/**\n\t * The variant of the button\n\t * @default 'primary'\n\t */\n\tvariant?: ButtonVariantLike;\n\n\t/**\n\t * The size of the button\n\t * @default 'default'\n\t */\n\tsize?: ButtonSizeLike;\n\n\t/**\n\t * Whether the button should take up the full width of its container\n\t * @default false\n\t */\n\tfullWidth?: boolean;\n\n\t/**\n\t * Additional CSS class names\n\t */\n\tclassName?: string;\n\n\t/**\n\t * Button content\n\t */\n\tchildren: React.ReactNode;\n\n\t/**\n\t * Prevent double click submissions (adds debouncing)\n\t * @default false\n\t */\n\tpreventDoubleClick?: boolean;\n}\n\n/**\n * Props when rendering as button element (no href)\n */\nexport interface ButtonAsButtonProps\n\textends BaseButtonProps,\n\t\tOmit<React.ButtonHTMLAttributes<HTMLButtonElement>, keyof BaseButtonProps> {\n\t/**\n\t * Button type\n\t * @default 'button'\n\t */\n\ttype?: \"button\" | \"submit\" | \"reset\";\n}\n\n/**\n * Props when rendering as anchor element (with href)\n */\nexport interface ButtonAsLinkProps\n\textends BaseButtonProps,\n\t\tOmit<\n\t\t\tReact.AnchorHTMLAttributes<HTMLAnchorElement>,\n\t\t\tkeyof BaseButtonProps | \"role\" | \"type\"\n\t\t> {\n\t/**\n\t * When provided, renders as anchor link instead of button\n\t */\n\thref: string;\n\n\t/**\n\t * Link target\n\t */\n\ttarget?: string;\n\n\t/**\n\t * Link rel attribute\n\t */\n\trel?: string;\n\n\t/**\n\t * Use aria-disabled for anchor elements (no native disabled support)\n\t * Use disabled prop instead for button elements\n\t */\n\t\"aria-disabled\"?: \"true\" | \"false\";\n}\n\n/**\n * NHS Button Component\n *\n * A button component that provides excellent accessibility out of the box\n * while following NHS design guidelines. Based on NHS.UK button patterns.\n *\n * Features:\n * - Full keyboard navigation support (Enter and Space key activation)\n * - Screen reader compatibility\n * - Focus management\n * - Proper ARIA attributes\n * - Double-click prevention\n * - Support for button and link variants\n *\n * @example\n * ```tsx\n * <Button variant=\"primary\" size=\"default\">\n *\t Continue\n * </Button>\n *\n * <Button href=\"/next-page\" variant=\"secondary\">\n *\t Go to next page\n * </Button>\n * ```\n */\n\n// Implementation function\nfunction ButtonComponent(\n\tprops: ButtonAsButtonProps | ButtonAsLinkProps,\n\tref: React.Ref<HTMLButtonElement | HTMLAnchorElement>\n): React.ReactElement {\n\tconst {\n\t\tchildren,\n\t\tvariant = ButtonVariant.Primary,\n\t\tsize = ButtonSize.Default,\n\t\tfullWidth = false,\n\t\tclassName = \"\",\n\t\tpreventDoubleClick = false,\n\t\t...rest\n\t} = props;\n\n\t// State for interactive data attributes (replaces React Aria state management)\n\tconst [isPressed, setIsPressed] = useState(false);\n\tconst [isHovered, setIsHovered] = useState(false);\n\tconst [isFocused, setIsFocused] = useState(false);\n\n\t// Normalised model (future shared with macro generator)\n\tconst model = mapButtonProps({\n\t\tvariant,\n\t\tsize,\n\t\tfullWidth,\n\t\tclassName,\n\t\tpreventDoubleClick,\n\t\thref: \"href\" in rest ? (rest as any).href : undefined,\n\t});\n\n\t// Build data attributes for styling (replaces React Aria data attributes)\n\tconst isDisabled =\n\t\t\"disabled\" in rest ? rest.disabled : rest[\"aria-disabled\"] === \"true\";\n\tconst dataAttributes = {\n\t\t...(isPressed && { \"data-pressed\": \"true\" }),\n\t\t...(isHovered && { \"data-hovered\": \"true\" }),\n\t\t...(isFocused && { \"data-focused\": \"true\" }),\n\t\t...(isDisabled && { \"data-disabled\": \"true\" }),\n\t};\n\n\t// Event handlers for state management\n\tconst handleMouseDown = useCallback(\n\t\t() => !isDisabled && setIsPressed(true),\n\t\t[isDisabled]\n\t);\n\tconst handleMouseUp = useCallback(() => setIsPressed(false), []);\n\tconst handleMouseEnter = useCallback(\n\t\t() => !isDisabled && setIsHovered(true),\n\t\t[isDisabled]\n\t);\n\tconst handleMouseLeave = useCallback(() => {\n\t\tsetIsHovered(false);\n\t\tsetIsPressed(false); // Reset pressed state when leaving\n\t}, []);\n\tconst handleFocus = useCallback(() => setIsFocused(true), []);\n\tconst handleBlur = useCallback(() => setIsFocused(false), []);\n\n\t// Handle keyboard navigation (Space key support for buttons and links with role=\"button\")\n\tconst handleKeyDown = useCallback(\n\t\t(event: React.KeyboardEvent<HTMLElement>) => {\n\t\t\t// Handle space bar activation for button role elements\n\t\t\tif (\n\t\t\t\tevent.key === \" \" &&\n\t\t\t\t(\"href\" in rest ||\n\t\t\t\t\tevent.currentTarget.getAttribute(\"role\") === \"button\")\n\t\t\t) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\t(event.currentTarget as HTMLElement).click();\n\t\t\t}\n\t\t},\n\t\t[rest]\n\t);\n\n\t// Handle click with double-click prevention\n\tconst handleClick = useCallback(\n\t\t(event: React.MouseEvent<HTMLElement>) => {\n\t\t\t// Double-click prevention logic (following NHS.UK pattern)\n\t\t\tif (preventDoubleClick) {\n\t\t\t\tconst target = event.currentTarget as HTMLElement;\n\t\t\t\tconst isAlreadyProcessing =\n\t\t\t\t\ttarget.getAttribute(\"data-processing\") === \"true\";\n\n\t\t\t\tif (isAlreadyProcessing) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Mark as processing\n\t\t\t\ttarget.setAttribute(\"data-processing\", \"true\");\n\n\t\t\t\t// Clear processing state after 1 second\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\ttarget.removeAttribute(\"data-processing\");\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t},\n\t\t[preventDoubleClick]\n\t);\n\n\t// Render as anchor link if href is provided\n\tif (\"href\" in rest && rest.href) {\n\t\tconst {\n\t\t\tid,\n\t\t\tstyle,\n\t\t\ttitle,\n\t\t\t[\"aria-label\"]: ariaLabel,\n\t\t\t[\"aria-describedby\"]: ariaDescribedBy,\n\t\t\t[\"aria-labelledby\"]: ariaLabelledBy,\n\t\t\ttabIndex,\n\t\t\t...anchorRest\n\t\t} = rest as ButtonAsLinkProps as any;\n\t\tconst anchorProps = rest as ButtonAsLinkProps;\n\t\treturn (\n\t\t\t<a\n\t\t\t\tref={ref as React.Ref<HTMLAnchorElement>}\n\t\t\t\thref={anchorProps.href}\n\t\t\t\ttarget={anchorProps.target}\n\t\t\t\trel={anchorProps.rel}\n\t\t\t\tclassName={model.classes}\n\t\t\t\trole=\"button\"\n\t\t\t\tdraggable=\"false\"\n\t\t\t\tdata-module=\"nhs-button\"\n\t\t\t\t{...dataAttributes}\n\t\t\t\t{...(preventDoubleClick && { \"data-prevent-double-click\": \"true\" })}\n\t\t\t\t{...anchorRest}\n\t\t\t\tonKeyDown={(event) => {\n\t\t\t\t\tanchorProps.onKeyDown?.(event);\n\t\t\t\t\thandleKeyDown(event);\n\t\t\t\t}}\n\t\t\t\tonClick={(event) => {\n\t\t\t\t\tanchorProps.onClick?.(event);\n\t\t\t\t\thandleClick(event);\n\t\t\t\t}}\n\t\t\t\tonMouseDown={(event) => {\n\t\t\t\t\tanchorProps.onMouseDown?.(event);\n\t\t\t\t\thandleMouseDown();\n\t\t\t\t}}\n\t\t\t\tonMouseUp={(event) => {\n\t\t\t\t\tanchorProps.onMouseUp?.(event);\n\t\t\t\t\thandleMouseUp();\n\t\t\t\t}}\n\t\t\t\tonMouseEnter={(event) => {\n\t\t\t\t\tanchorProps.onMouseEnter?.(event);\n\t\t\t\t\thandleMouseEnter();\n\t\t\t\t}}\n\t\t\t\tonMouseLeave={(event) => {\n\t\t\t\t\tanchorProps.onMouseLeave?.(event);\n\t\t\t\t\thandleMouseLeave();\n\t\t\t\t}}\n\t\t\t\tonFocus={(event) => {\n\t\t\t\t\tanchorProps.onFocus?.(event);\n\t\t\t\t\thandleFocus();\n\t\t\t\t}}\n\t\t\t\tonBlur={(event) => {\n\t\t\t\t\tanchorProps.onBlur?.(event);\n\t\t\t\t\thandleBlur();\n\t\t\t\t}}\n\t\t\t\t// Note: anchor links don't support disabled, but we can simulate it with aria-disabled\n\t\t\t\taria-disabled={anchorProps[\"aria-disabled\"]}\n\t\t\t\t{...(anchorProps[\"aria-disabled\"] === \"true\" && { tabIndex: -1 })}\n\t\t\t\t// Extract relevant props excluding our custom ones\n\t\t\t\tid={id}\n\t\t\t\tstyle={style}\n\t\t\t\ttitle={title}\n\t\t\t\taria-label={ariaLabel}\n\t\t\t\taria-describedby={ariaDescribedBy}\n\t\t\t\taria-labelledby={ariaLabelledBy}\n\t\t\t\ttabIndex={tabIndex}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</a>\n\t\t);\n\t}\n\n\t// Render as button element\n\tconst {\n\t\tid,\n\t\tstyle,\n\t\ttitle,\n\t\t[\"aria-label\"]: ariaLabel,\n\t\t[\"aria-describedby\"]: ariaDescribedBy,\n\t\t[\"aria-labelledby\"]: ariaLabelledBy,\n\t\ttabIndex,\n\t\tname,\n\t\tvalue: valueProp,\n\t\tform,\n\t\tformAction,\n\t\tformEncType,\n\t\tformMethod,\n\t\tformNoValidate,\n\t\tformTarget,\n\t\tautoFocus,\n\t\t...buttonRest\n\t} = rest as any as ButtonAsButtonProps;\n\tconst buttonProps = rest as ButtonAsButtonProps;\n\treturn (\n\t\t<button\n\t\t\tref={ref as React.Ref<HTMLButtonElement>}\n\t\t\ttype={buttonProps.type || \"button\"}\n\t\t\tdisabled={buttonProps.disabled}\n\t\t\tclassName={model.classes}\n\t\t\tdata-module=\"nhs-button\"\n\t\t\t{...dataAttributes}\n\t\t\t{...(preventDoubleClick && { \"data-prevent-double-click\": \"true\" })}\n\t\t\t{...(buttonProps.disabled && { \"aria-disabled\": \"true\" })}\n\t\t\t{...buttonRest}\n\t\t\tonKeyDown={(event) => {\n\t\t\t\tbuttonProps.onKeyDown?.(event);\n\t\t\t\thandleKeyDown(event);\n\t\t\t}}\n\t\t\tonClick={(event) => {\n\t\t\t\tbuttonProps.onClick?.(event);\n\t\t\t\thandleClick(event);\n\t\t\t}}\n\t\t\tonMouseDown={(event) => {\n\t\t\t\tbuttonProps.onMouseDown?.(event);\n\t\t\t\thandleMouseDown();\n\t\t\t}}\n\t\t\tonMouseUp={(event) => {\n\t\t\t\tbuttonProps.onMouseUp?.(event);\n\t\t\t\thandleMouseUp();\n\t\t\t}}\n\t\t\tonMouseEnter={(event) => {\n\t\t\t\tbuttonProps.onMouseEnter?.(event);\n\t\t\t\thandleMouseEnter();\n\t\t\t}}\n\t\t\tonMouseLeave={(event) => {\n\t\t\t\tbuttonProps.onMouseLeave?.(event);\n\t\t\t\thandleMouseLeave();\n\t\t\t}}\n\t\t\tonFocus={(event) => {\n\t\t\t\tbuttonProps.onFocus?.(event);\n\t\t\t\thandleFocus();\n\t\t\t}}\n\t\t\tonBlur={(event) => {\n\t\t\t\tbuttonProps.onBlur?.(event);\n\t\t\t\thandleBlur();\n\t\t\t}}\n\t\t\t// Extract relevant props\n\t\t\tid={id}\n\t\t\tstyle={style}\n\t\t\ttitle={title}\n\t\t\taria-label={ariaLabel}\n\t\t\taria-describedby={ariaDescribedBy}\n\t\t\taria-labelledby={ariaLabelledBy}\n\t\t\ttabIndex={tabIndex}\n\t\t\tname={name}\n\t\t\tvalue={valueProp}\n\t\t\tform={form}\n\t\t\tformAction={formAction}\n\t\t\tformEncType={formEncType}\n\t\t\tformMethod={formMethod}\n\t\t\tformNoValidate={formNoValidate}\n\t\t\tformTarget={formTarget}\n\t\t\tautoFocus={autoFocus}\n\t\t>\n\t\t\t{children}\n\t\t</button>\n\t);\n}\n\n// Define overloaded function signatures\ninterface ButtonComponent {\n\t(\n\t\tprops: ButtonAsButtonProps & { ref?: React.Ref<HTMLButtonElement> }\n\t): React.ReactElement;\n\t(\n\t\tprops: ButtonAsLinkProps & { ref?: React.Ref<HTMLAnchorElement> }\n\t): React.ReactElement;\n\tdisplayName?: string;\n}\n\nexport const Button = forwardRef(ButtonComponent) as ButtonComponent;\nButton.displayName = \"Button\";\n\n// Export union type for compatibility\nexport type NHSButtonProps = ButtonAsButtonProps | ButtonAsLinkProps;\n\nexport default Button;\n", "// Pure mapping logic for Button. Converts external props to a normalised model\n// used by both React & Nunjucks renderers (future).\n\nexport interface ButtonInputProps {\n  variant?: string; // Accepts ButtonVariant enum values (string)\n  size?: string;    // Accepts ButtonSize enum values (string)\n  fullWidth?: boolean;\n  className?: string;\n  preventDoubleClick?: boolean;\n  href?: string;\n}\n\nexport interface NormalisedButtonModel {\n  tag: 'button' | 'a';\n  classes: string;\n  data: Record<string, string>;\n  attrs: Record<string, any>;\n  preventDoubleClick: boolean;\n}\n\nexport function mapButtonProps(input: ButtonInputProps): NormalisedButtonModel {\n  const variant = input.variant || 'primary';\n  const size = input.size || 'default';\n  const fullWidth = !!input.fullWidth;\n  const classes = [\n    'nhs-aria-button',\n    `nhs-aria-button--${variant}`,\n    size !== 'default' ? `nhs-aria-button--${size}` : '',\n    fullWidth ? 'nhs-aria-button--full-width' : '',\n    input.className || ''\n  ].filter(Boolean).join(' ');\n\n  const tag = input.href ? 'a' : 'button';\n  return {\n    tag,\n    classes,\n    data: { module: 'nhs-button' },\n    attrs: input.href ? { href: input.href, role: 'button' } : { type: 'button' },\n    preventDoubleClick: !!input.preventDoubleClick\n  };\n}\n", "import React from \"react\";\nimport classNames from \"classnames\";\nimport type {\n\tTableProps,\n\tTableCellData,\n\tTableHeaderCellType,\n\tTableCaptionProps,\n\tTableBodyRowProps,\n\tTableHeaderCellComponentProps,\n\tTableDataCellComponentProps,\n} from \"./Table.types\";\nimport \"./Table.scss\";\nimport { Panel } from \"../Panel\";\nimport { Heading } from \"../Heading\";\n\n/**\n * Table component for displaying structured data\n *\n * Features:\n * - Responsive design with mobile-friendly stacked layout\n * - Accessible table structure with proper headers\n * - Support for complex cell types (headers, numeric, spans)\n * - Optional panel wrapper with heading\n * - Customisable caption and styling\n *\n * @param props - Table component props\n * @returns JSX element\n */\n// Shared highlighting utilities (module scope so all sub-components can use)\nconst prismGlobalRef: { current: any | null } = { current: null };\nconst ensurePrismGlobal = () => {\n\tif (prismGlobalRef.current) return prismGlobalRef.current;\n\ttry {\n\t\tprismGlobalRef.current = require('prismjs');\n\t\ttry { require('prismjs/components/prism-typescript'); } catch {}\n\t\ttry { require('prismjs/components/prism-tsx'); } catch {}\n\t\ttry { require('prismjs/components/prism-json'); } catch {}\n\t} catch { prismGlobalRef.current = null; }\n\treturn prismGlobalRef.current;\n};\nexport const fallbackHighlight = (code: string) => {\n\tconst patterns: { regex: RegExp; cls: string }[] = [\n\t\t{ regex: /\\b(import|from|export|const|let|var|return|if|else|for|while|switch|case|break|new|throw|try|catch|finally|class|extends|implements|interface|type|as|async|await|function)\\b/g, cls: 'kw' },\n\t\t{ regex: /(['\"`])(?:\\\\.|(?!\\1).)*\\1/g, cls: 'str' },\n\t\t{ regex: /\\/\\*[^]*?\\*\\/|\\/\\/.*$/gm, cls: 'com' },\n\t\t{ regex: /\\b([0-9]+(?:\\.[0-9]+)?)\\b/g, cls: 'num' },\n\t];\n\tlet html = code;\n\tpatterns.forEach(p => { html = html.replace(p.regex, m => `<span class=\\\"nhsuk-code-${p.cls}\\\">${m}</span>`); });\n\treturn html;\n};\nexport const highlightCode = (code: string, lang?: string, disable?: boolean) => {\n\tif (disable) return code;\n\tif (!lang) return code;\n\tconst Prism = ensurePrismGlobal();\n\tif (Prism && Prism.languages) {\n\t\tconst resolvedLang = Prism.languages[lang]\n\t\t\t? lang\n\t\t\t: (Prism.languages.typescript && (lang === 'ts' || lang === 'tsx' || lang === 'typescript')\n\t\t\t\t? 'typescript'\n\t\t\t\t: (Prism.languages.json && lang === 'json' ? 'json' : undefined));\n\t\tif (resolvedLang) {\n\t\t\ttry { return Prism.highlight(code, Prism.languages[resolvedLang], resolvedLang); } catch {}\n\t\t}\n\t}\n\treturn fallbackHighlight(code);\n};\n\nconst TableBase: React.FC<TableProps> = ({\n\trows,\n\thead,\n\tcaption,\n\tcaptionSize,\n\tfirstCellIsHeader = false,\n\tresponsive = false,\n\theading,\n\theadingLevel = 3,\n\tpanel = false,\n\tpanelClasses,\n\ttableClasses,\n\tclasses,\n\tattributes,\n\t\"data-testid\": testId,\n\tcolumns,\n\tdata,\n\tvisuallyHiddenCaption = false,\n}) => {\n\t// Build caption classes\n\tconst captionClass =\n\t\t`nhsuk-table__caption ${captionSize ? `nhsuk-table__caption--${captionSize}` : \"\"}`.trim();\n\n\t// Build table classes\n\tconst tableClassList = classNames(\n\t\t\"nhsuk-table\",\n\t\t{\n\t\t\t\"nhsuk-table-responsive\": responsive,\n\t\t},\n\t\ttableClasses\n\t);\n\n\t// Build container classes\n\tconst containerClassList = classNames(classes);\n\n\n\tconst renderHeaderCell = (cell: TableHeaderCellType, index: number) => {\n\tconst headerClasses = classNames(\n\t\t\"nhsuk-table__header\",\n\t\t{\n\t\t\t[`nhsuk-table__header--${cell.format}`]: cell.format,\n\t\t},\n\t\tcell.classes\n\t);\n\n\tconst headerAttributes = {\n\t\tscope: \"col\" as const,\n\t\t...(cell.colspan && { colSpan: cell.colspan }),\n\t\t...(cell.rowspan && { rowSpan: cell.rowspan }),\n\t\t...(responsive && { role: \"columnheader\" }),\n\t\t...cell.attributes,\n\t};\n\n\t\t// Determine content precedence: node > html > code > text\n\t\tlet content: React.ReactNode;\n\t\tif (cell.node != null) {\n\t\t\tcontent = <>{cell.node}</>;\n\t\t} else if (cell.html) {\n\t\t\tcontent = <span dangerouslySetInnerHTML={{ __html: cell.html }} />;\n\t\t} else if (cell.code != null) {\n\t\t\tconst isArray = Array.isArray(cell.code);\n\t\t\tconst codeString = isArray\n\t\t\t\t? (cell.code as string[]).join(\"\\n\")\n\t\t\t\t: (cell.code as string);\n\t\t\tconst isMultiline = isArray || codeString.includes(\"\\n\");\n\t\t\tconst codeProps = {\n\t\t\t\tclassName: classNames(\"nhsuk-table__code\", cell.codeClassName, {\n\t\t\t\t\t\"nhsuk-table__code--block\": isMultiline,\n\t\t\t\t\t\"nhsuk-table__code--inline\": !isMultiline,\n\t\t\t\t}),\n\t\t\t\t...(cell.codeLanguage ? { \"data-language\": cell.codeLanguage } : {}),\n\t\t\t};\n\t\t\tconst highlighted = highlightCode(codeString, (cell as any).codeLanguage); // header cells don't support disableHighlight currently\n\t\t\tcontent = isMultiline ? (\n\t\t\t\t<pre className=\"nhsuk-table__pre\">\n\t\t\t\t\t<code\n\t\t\t\t\t\t{...codeProps}\n\t\t\t\t\t\tdangerouslySetInnerHTML={{ __html: highlighted }}\n\t\t\t\t\t/>\n\t\t\t\t</pre>\n\t\t\t) : (\n\t\t\t\t<code\n\t\t\t\t\t{...codeProps}\n\t\t\t\t\tdangerouslySetInnerHTML={{ __html: highlighted }}\n\t\t\t\t/>\n\t\t\t);\n\t\t} else {\n\t\t\tcontent = cell.text;\n\t\t}\n\t\treturn (\n\t\t\t<th key={index} className={headerClasses} {...headerAttributes}>\n\t\t\t\t{content}\n\t\t\t</th>\n\t\t);\n\t};\n\n\tconst renderCell = (\n\t\tcell: TableCellData,\n\t\tcellIndex: number,\n\t\tisFirstCell: boolean\n\t) => {\n\t\t// Determine if this cell should be a row header either via global firstCellIsHeader or per-cell rowHeader flag\n\t\tconst isHeaderCell = (firstCellIsHeader && isFirstCell) || (cell as any).rowHeader;\n\n\t\tconst cellClasses = classNames(\n\t\t\tisHeaderCell ? \"nhsuk-table__header\" : \"nhsuk-table__cell\",\n\t\t\t{\n\t\t\t\t[`nhsuk-table__${isHeaderCell ? \"header\" : \"cell\"}--${cell.format}`]:\n\t\t\t\t\tcell.format,\n\t\t\t},\n\t\t\tcell.classes\n\t\t);\n\n\t\tconst cellAttributes = {\n\t\t\t...(isHeaderCell && { scope: \"row\" as const }),\n\t\t\t...(cell.colspan && { colSpan: cell.colspan }),\n\t\t\t...(cell.rowspan && { rowSpan: cell.rowspan }),\n\t\t\t...(responsive && {\n\t\t\t\trole: isHeaderCell ? \"rowheader\" : \"cell\",\n\t\t\t\t...(cell.header && { \"data-label\": cell.header }),\n\t\t\t}),\n\t\t\t...cell.attributes,\n\t\t};\n\n\t\tlet inner: React.ReactNode;\n\t\t// (highlighting utilities now hoisted above)\n\n\t\tif (cell.node != null) {\n\t\t\tinner = <>{cell.node}</>;\n\t\t} else if (cell.html) {\n\t\t\tinner = <span dangerouslySetInnerHTML={{ __html: cell.html }} />;\n\t\t} else if (cell.code != null) {\n\t\t\tconst isArray = Array.isArray(cell.code);\n\t\t\tconst codeString = isArray\n\t\t\t\t? (cell.code as string[]).join(\"\\n\")\n\t\t\t\t: (cell.code as string);\n\t\t\tconst isMultiline = isArray || codeString.includes(\"\\n\");\n\t\t\tconst codeProps = {\n\t\t\t\tclassName: classNames(\"nhsuk-table__code\", cell.codeClassName, {\n\t\t\t\t\t\"nhsuk-table__code--block\": isMultiline,\n\t\t\t\t\t\"nhsuk-table__code--inline\": !isMultiline,\n\t\t\t\t}),\n\t\t\t\t...(cell.codeLanguage ? { \"data-language\": cell.codeLanguage } : {}),\n\t\t\t};\n\t\t\tconst highlighted = highlightCode(\n\t\t\t\tcodeString,\n\t\t\t\tcell.codeLanguage,\n\t\t\t\tcell.disableHighlight\n\t\t\t);\n\t\t\tinner = isMultiline ? (\n\t\t\t\t<pre className=\"nhsuk-table__pre\">\n\t\t\t\t\t<code\n\t\t\t\t\t\t{...codeProps}\n\t\t\t\t\t\tdangerouslySetInnerHTML={{ __html: highlighted }}\n\t\t\t\t\t/>\n\t\t\t\t</pre>\n\t\t\t) : (\n\t\t\t\t<code\n\t\t\t\t\t{...codeProps}\n\t\t\t\t\tdangerouslySetInnerHTML={{ __html: highlighted }}\n\t\t\t\t/>\n\t\t\t);\n\t\t} else {\n\t\t\tinner = cell.text;\n\t\t}\n\n\t\tconst cellContent = (\n\t\t\t<>\n\t\t\t\t{responsive && cell.header && (\n\t\t\t\t\t<span className=\"nhsuk-table-responsive__heading\" aria-hidden=\"true\">\n\t\t\t\t\t\t{cell.header}{\" \"}\n\t\t\t\t\t</span>\n\t\t\t\t)}\n\t\t\t\t{inner}\n\t\t\t</>\n\t\t);\n\n\t\tconst Component = isHeaderCell ? \"th\" : \"td\";\n\n\t\treturn (\n\t\t\t<Component key={cellIndex} className={cellClasses} {...cellAttributes}>\n\t\t\t\t{cellContent}\n\t\t\t</Component>\n\t\t);\n\t};\n\n\t// Auto-build head/rows from columns + data if provided and explicit head/rows absent\n\tlet derivedHead = head;\n\tlet derivedRows = rows;\n\tif (!derivedHead && columns && columns.length) {\n\t\tderivedHead = columns.map((c) => ({\n\t\t\ttext: c.title,\n\t\t\tformat: c.format,\n\t\t\tclasses: c.headerClasses,\n\t\t\tattributes: c.headerAttributes,\n\t\t}));\n\t}\n\tif (!derivedRows && columns && data && data.length) {\n\t\tderivedRows = data.map((rowObj, rIdx) => {\n\t\t\treturn columns.map((c) => {\n\t\t\t\tconst raw = c.accessor ? c.accessor(rowObj, rIdx) : (rowObj as any)[c.key];\n\t\t\t\tlet base: any = { format: c.format, classes: c.cellClasses, attributes: c.cellAttributes };\n\t\t\t\tif (c.rowHeader) base.rowHeader = true;\n\t\t\t\tif (c.render) {\n\t\t\t\t\tconst rendered = c.render(raw, rowObj, rIdx, c);\n\t\t\t\t\tif (rendered == null || typeof rendered === 'boolean') return { ...base, text: '' };\n\t\t\t\t\tif (typeof rendered === 'string' || typeof rendered === 'number') {\n\t\t\t\t\t\treturn { ...base, text: String(rendered) };\n\t\t\t\t\t}\n\t\t\t\t\treturn { ...base, ...(rendered as any) };\n\t\t\t\t}\n\t\t\t\treturn { ...base, text: raw != null ? String(raw) : '' };\n\t\t\t});\n\t\t});\n\t}\n\n\tconst renderTable = () => (\n\t\t<table\n\t\t\tclassName={tableClassList}\n\t\t\t{...(responsive && { role: \"table\" })}\n\t\t\t{...attributes}\n\t\t\t{...(testId && { \"data-testid\": testId })}\n\t\t>\n\t\t\t{caption && (\n\t\t\t\t<caption className={classNames(captionClass, visuallyHiddenCaption && 'nhsuk-u-visually-hidden')}>\n\t\t\t\t\t{caption}\n\t\t\t\t</caption>\n\t\t\t)}\n\n\t\t\t{derivedHead && derivedHead.length > 0 && (\n\t\t\t\t<thead\n\t\t\t\t\tclassName=\"nhsuk-table__head\"\n\t\t\t\t\t{...(responsive && { role: \"rowgroup\" })}\n\t\t\t\t>\n\t\t\t\t\t<tr {...(responsive && { role: \"row\" })}>\n\t\t\t\t\t\t{derivedHead.map((cell: any, index: number) =>\n\t\t\t\t\t\t\trenderHeaderCell(cell, index)\n\t\t\t\t\t\t)}\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t)}\n\n\t\t\t<tbody className=\"nhsuk-table__body\">\n\t\t\t\t{derivedRows &&\n\t\t\t\t\tderivedRows.map((row: any, rowIndex: number) => (\n\t\t\t\t\t\t<tr\n\t\t\t\t\t\t\tkey={rowIndex}\n\t\t\t\t\t\t\tclassName=\"nhsuk-table__row\"\n\t\t\t\t\t\t\t{...(responsive && { role: \"row\" })}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{row.map((cell: any, cellIndex: number) =>\n\t\t\t\t\t\t\t\trenderCell(cell, cellIndex, cellIndex === 0)\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t))}\n\t\t\t</tbody>\n\t\t</table>\n\t);\n\n\tif (panel) {\n\t\treturn (\n\t\t\t<Panel className={panelClasses}>\n\t\t\t\t{heading && (\n\t\t\t\t\t<Heading level={headingLevel} className=\"nhsuk-table__heading-tab\">\n\t\t\t\t\t\t{heading}\n\t\t\t\t\t</Heading>\n\t\t\t\t)}\n\t\t\t\t{renderTable()}\n\t\t\t</Panel>\n\t\t);\n\t}\n\n\tif (containerClassList) {\n\t\treturn <div className={containerClassList}>{renderTable()}</div>;\n\t}\n\n\treturn renderTable();\n};\n\n// --- Sub-components ---\n\nexport const TableCaption: React.FC<TableCaptionProps> = ({\n\tchildren,\n\tsize,\n\tclassName,\n}) => {\n\tconst cls = classNames(\n\t\t\"nhsuk-table__caption\",\n\t\tsize && `nhsuk-table__caption--${size}`,\n\t\tclassName\n\t);\n\treturn <caption className={cls}>{children}</caption>;\n};\n\nexport const TableBodyRow: React.FC<TableBodyRowProps> = ({\n\tresponsive,\n\tclassName,\n\tchildren,\n\t...rest\n}) => {\n\tconst roleAttrs = responsive ? { role: \"row\" } : {};\n\treturn (\n\t\t<tr className={className} {...roleAttrs} {...rest}>\n\t\t\t{children}\n\t\t</tr>\n\t);\n};\n\nexport const TableHeaderCell: React.FC<TableHeaderCellComponentProps> = ({\n\ttext,\n\thtml,\n\tnode,\n\tcode,\n\tcodeLanguage,\n\tcodeClassName,\n\tdisableHighlight,\n\tformat,\n\tclasses,\n\tcolspan,\n\trowspan,\n\tattributes,\n\tresponsive,\n\tas = \"th\",\n}) => {\n\t// Uses shared highlightCode / fallbackHighlight utilities declared above\n\tconst headerClasses = classNames(\n\t\t\"nhsuk-table__header\",\n\t\t{ [`nhsuk-table__header--${format}`]: format },\n\t\tclasses\n\t);\n\tconst headerAttributes: any = {\n\t\tscope: \"col\",\n\t\t...(colspan && { colSpan: colspan }),\n\t\t...(rowspan && { rowSpan: rowspan }),\n\t\t...(responsive && { role: \"columnheader\" }),\n\t\t...attributes,\n\t};\n\tlet content: React.ReactNode;\n\tif (node != null) content = <>{node}</>;\n\telse if (html) content = <span dangerouslySetInnerHTML={{ __html: html }} />;\n\telse if (code != null) {\n\t\tconst isArray = Array.isArray(code);\n\t\tconst codeString = isArray\n\t\t\t? (code as string[]).join(\"\\n\")\n\t\t\t: (code as string);\n\t\tconst isMultiline = isArray || codeString.includes(\"\\n\");\n\t\tconst codeProps = {\n\t\t\tclassName: classNames(\"nhsuk-table__code\", codeClassName, {\n\t\t\t\t\"nhsuk-table__code--block\": isMultiline,\n\t\t\t\t\"nhsuk-table__code--inline\": !isMultiline,\n\t\t\t}),\n\t\t\t...(codeLanguage ? { \"data-language\": codeLanguage } : {}),\n\t\t};\n\t\tconst highlighted = highlightCode(\n\t\t\tcodeString,\n\t\t\tcodeLanguage,\n\t\t\tdisableHighlight\n\t\t);\n\t\tcontent = isMultiline ? (\n\t\t\t<pre className=\"nhsuk-table__pre\">\n\t\t\t\t<code\n\t\t\t\t\t{...codeProps}\n\t\t\t\t\tdangerouslySetInnerHTML={{ __html: highlighted }}\n\t\t\t\t/>\n\t\t\t</pre>\n\t\t) : (\n\t\t\t<code {...codeProps} dangerouslySetInnerHTML={{ __html: highlighted }} />\n\t\t);\n\t} else content = text;\n\tconst Component: any = as;\n\treturn (\n\t\t<Component className={headerClasses} {...headerAttributes}>\n\t\t\t{content}\n\t\t</Component>\n\t);\n};\n\nexport const TableCell: React.FC<TableDataCellComponentProps> = ({\n\ttext,\n\thtml,\n\tnode,\n\tcode,\n\tcodeLanguage,\n\tcodeClassName,\n\tdisableHighlight,\n\tformat,\n\tclasses,\n\tcolspan,\n\trowspan,\n\tattributes,\n\tresponsive,\n\trowHeader,\n}) => {\n\tconst isHeader = !!rowHeader;\n\tconst Tag: any = isHeader ? 'th' : 'td';\n\tconst cls = classNames(\n\t\tisHeader ? 'nhsuk-table__header' : 'nhsuk-table__cell',\n\t\tformat && `nhsuk-table__${isHeader ? 'header' : 'cell'}--${format}`,\n\t\tclasses\n\t);\n\tconst cellAttrs: any = {\n\t\t...(colspan && { colSpan: colspan }),\n\t\t...(rowspan && { rowSpan: rowspan }),\n\t\t...(isHeader && { scope: 'row' }),\n\t\t...(responsive && { role: isHeader ? 'rowheader' : 'cell' }),\n\t\t...attributes,\n\t};\n\tlet content: React.ReactNode;\n\tif (node != null) content = <>{node}</>;\n\telse if (html) content = <span dangerouslySetInnerHTML={{ __html: html }} />;\n\telse if (code != null) {\n\t\tconst isArray = Array.isArray(code);\n\t\tconst codeString = isArray ? (code as string[]).join('\\n') : (code as string);\n\t\tconst isMultiline = isArray || codeString.includes('\\n');\n\t\tconst codeProps = {\n\t\t\tclassName: classNames('nhsuk-table__code', codeClassName, {\n\t\t\t\t'nhsuk-table__code--block': isMultiline,\n\t\t\t\t'nhsuk-table__code--inline': !isMultiline,\n\t\t\t}),\n\t\t\t...(codeLanguage ? { 'data-language': codeLanguage } : {}),\n\t\t};\n\t\tconst highlighted = highlightCode(codeString, codeLanguage, disableHighlight);\n\t\tcontent = isMultiline ? (\n\t\t\t<pre className=\"nhsuk-table__pre\"><code {...codeProps} dangerouslySetInnerHTML={{ __html: highlighted }} /></pre>\n\t\t) : (\n\t\t\t<code {...codeProps} dangerouslySetInnerHTML={{ __html: highlighted }} />\n\t\t);\n\t} else content = text;\n\treturn <Tag className={cls} {...cellAttrs}>{content}</Tag>;\n};\n\n// Compose export with static properties for ergonomics: Table.Caption / Table.BodyRow / Table.HeaderCell / Table.Cell\nexport interface TableComposite extends React.FC<TableProps> {\n\tCaption: typeof TableCaption;\n\tBodyRow: typeof TableBodyRow;\n\tHeaderCell: typeof TableHeaderCell;\n\tCell: typeof TableCell;\n\t// Backwards compat (deprecated) aliases\n\tRow: typeof TableBodyRow;\n\tTH: typeof TableHeaderCell;\n}\n\nconst Table = TableBase as TableComposite;\nTable.Caption = TableCaption;\nTable.BodyRow = TableBodyRow;\nTable.HeaderCell = TableHeaderCell;\nTable.Cell = TableCell;\n// Legacy aliases (deprecated): expose as lazy getters so we warn only on access\nlet __warnedRow = false;\nlet __warnedTH = false;\nObject.defineProperty(Table, 'Row', {\n\tconfigurable: true,\n\tenumerable: false,\n\tget() {\n\t\tif (process.env.NODE_ENV !== 'production' && !__warnedRow) {\n\t\t\tconsole.warn('Table.Row is deprecated. Use Table.BodyRow instead.');\n\t\t\t__warnedRow = true;\n\t\t}\n\t\treturn TableBodyRow;\n\t},\n});\nObject.defineProperty(Table, 'TH', {\n\tconfigurable: true,\n\tenumerable: false,\n\tget() {\n\t\tif (process.env.NODE_ENV !== 'production' && !__warnedTH) {\n\t\t\tconsole.warn('Table.TH is deprecated. Use Table.HeaderCell instead.');\n\t\t\t__warnedTH = true;\n\t\t}\n\t\treturn TableHeaderCell;\n\t},\n});\n\nexport default Table;\n", "import React from 'react';\nimport classNames from 'classnames';\nimport './Panel.scss';\nimport { PanelProps } from './Panel.types';\nimport { Heading } from '../Heading';\n\nexport const Panel: React.FC<PanelProps> = ({\n  id,\n  className,\n  headingText,\n  headingHtml,\n  headingLevel = 2,\n  bodyText,\n  bodyHtml,\n  children,\n  ...props\n}) => {\n  const panelClasses = classNames(\n    'nhsuk-panel',\n    className\n  );\n\n  const renderHeading = () => {\n    if (!headingText && !headingHtml && !children) return null;\n\n    if (headingHtml) {\n      return (\n        <Heading\n          level={headingLevel}\n          className=\"nhsuk-panel__heading\"\n          html={headingHtml}\n          marginBottom=\"var(--panel-heading-margin, 24px)\"\n        />\n      );\n    }\n\n    if (headingText) {\n      return (\n        <Heading\n          level={headingLevel}\n          className=\"nhsuk-panel__heading\"\n          text={headingText}\n          marginBottom=\"var(--panel-heading-margin, 24px)\"\n        />\n      );\n    }\n\n    return null;\n  };\n\n  const renderBody = () => {\n    if (children) {\n      return <div className=\"nhsuk-panel__body\">{children}</div>;\n    }\n\n    if (bodyHtml) {\n      return (\n        <div \n          className=\"nhsuk-panel__body\"\n          dangerouslySetInnerHTML={{ __html: bodyHtml }}\n        />\n      );\n    }\n\n    if (bodyText) {\n      return (\n        <div className=\"nhsuk-panel__body\">\n          <p>{bodyText}</p>\n        </div>\n      );\n    }\n\n    return null;\n  };\n\n  return (\n    <div className={panelClasses} id={id} {...props}>\n      {renderHeading()}\n      {renderBody()}\n    </div>\n  );\n};\n", "import React, { createElement } from 'react';\nimport './Heading.scss';\nimport { HeadingProps } from './Heading.types';\nimport { mapHeadingProps } from '../../mapping/heading';\n\n/**\n * A reusable Heading component that abstracts heading level logic and provides consistent styling.\n * Separates semantic meaning (level) from visual appearance (size).\n * \n * If level is not provided, it will be automatically determined from the size prop:\n * - xxl/xl \u2192 h1\n * - l \u2192 h2 \n * - m \u2192 h3\n * - s \u2192 h4\n * - xs \u2192 h5\n * \n * @example\n * <Heading level={1} size=\"xl\">Page Title</Heading>\n * <Heading level={2} size=\"l\" text=\"Section Title\" />\n * <Heading size=\"xl\" text=\"Auto h1 from size\" />\n * <Heading size=\"m\" text=\"Auto h3 from size\" />\n * <Heading level={2} text=\"Custom Spacing\" marginBottom=\"32px\" />\n */\nexport const Heading: React.FC<HeadingProps> = ({ level, className, text, html, children, size, marginBottom, ...rest }) => {\n  const model = mapHeadingProps({ level, size, className, marginBottom });\n  const content = children || (html ? <span dangerouslySetInnerHTML={{ __html: html }} /> : text);\n  return createElement(model.tag, { className: model.classes, style: model.style, ...rest }, content);\n};\n", "export interface HeadingInputProps {\n  level?: 1|2|3|4|5|6;\n  size?: 'xs'|'s'|'m'|'l'|'xl'|'xxl';\n  className?: string;\n  marginBottom?: string;\n}\n\nexport interface NormalisedHeadingModel {\n  tag: 'h1'|'h2'|'h3'|'h4'|'h5'|'h6';\n  classes: string;\n  style: Record<string, any> | undefined;\n}\n\nfunction deriveLevel(size?: string): 1|2|3|4|5|6 {\n  switch(size){\n    case 'xxl':\n    case 'xl': return 1;\n    case 'l': return 2;\n    case 'm': return 3;\n    case 's': return 4;\n    case 'xs': return 5;\n    default: return 2;\n  }\n}\n\nexport function mapHeadingProps(input: HeadingInputProps): NormalisedHeadingModel {\n  const level = input.level ?? deriveLevel(input.size);\n  const classes = [\n    'nhsuk-heading',\n    input.size ? `nhsuk-heading--${input.size}` : '',\n    input.className || ''\n  ].filter(Boolean).join(' ');\n  const style = input.marginBottom ? { marginBottom: input.marginBottom } : undefined;\n  return { tag: `h${level}` as any, classes, style };\n}\n", "import * as React from \"react\";\nimport { Tabs } from \"../../../Tabs/Tabs\";\nimport { Button } from \"../../../Button\";\nimport type { TabItem } from \"../../../Tabs/Tabs.types\";\nimport {\n\tChartContainer,\n\ttype ChartContainerProps,\n\ttype LineSeries,\n} from \"../../index\";\nimport Table from \"../../../Tables/Table\";\n\nexport interface ChartWithTableTabsProps\n\textends Omit<\n\t\tChartContainerProps,\n\t\t\"children\" | \"tabularData\" | \"showTableToggle\"\n\t> {\n\t/** The chart element to render */\n\tchart: React.ReactNode;\n\t/** Accessible data table (required for tabs; if omitted tabs are disabled) */\n\ttable?: React.ReactNode;\n\t/** Provide line series for auto table generation when table not manually supplied */\n\tautoTableFromSeries?: LineSeries[];\n\t/** Alignment for auto-generated (and optional consumer provided) table columns.\n\t * Provide an array matching column order (including Date/time column if auto generated).\n\t * Values: 'left' | 'center' | 'right'. Missing entries default to 'left'.\n\t */\n\tcolumnAlign?: Array<\"left\" | \"center\" | \"right\">;\n\t/** Enable CSV download button for auto-generated table */\n\tenableDownload?: boolean;\n\t/** Override default generated filename (without extension) */\n\tdownloadFilename?: string;\n\t/** Label for the chart tab */\n\tchartTabLabel?: string;\n\t/** Label for the table tab */\n\ttableTabLabel?: string;\n\t/** Start on table instead of chart */\n\tinitialView?: \"chart\" | \"table\";\n\t/** Disable tabs and render only the chart (ignores table) */\n\tdisableTabs?: boolean;\n\t/** Force hide the table even if provided (e.g. embed contexts) */\n\thideTable?: boolean;\n\t/** Pass extra tab items (appended after built-ins) */\n\tadditionalTabs?: TabItem[];\n\t/** Callback when active tab changes */\n\tonViewChange?: (view: \"chart\" | \"table\" | string) => void;\n}\n\n/**\n * Wrapper providing NHS/GDS style accessible fallback: a tabset switching between chart and underlying data table.\n * Falls back to a single chart view when table not supplied or tabs disabled.\n */\nexport const ChartWithTableTabs: React.FC<ChartWithTableTabsProps> = ({\n\tchart,\n\ttable,\n\tautoTableFromSeries,\n\tcolumnAlign,\n\tenableDownload = false,\n\tdownloadFilename,\n\tchartTabLabel = \"Chart\",\n\ttableTabLabel = \"Data table\",\n\tinitialView = \"chart\",\n\tdisableTabs = false,\n\thideTable = false,\n\tadditionalTabs,\n\tonViewChange,\n\ttitle,\n\tdescription,\n\tsource,\n\twidth,\n\theight,\n\tclassName,\n\tid,\n\tinitiallyShowTable,\n\t...restContainer\n}) => {\n\tlet resolvedTable = table;\n\tif (\n\t\t!resolvedTable &&\n\t\tautoTableFromSeries &&\n\t\tautoTableFromSeries.length > 0 &&\n\t\t!hideTable\n\t) {\n\t\t// All columns forced left-aligned (colAlign no longer needed)\n\n\t\t// Build multi-series table: first column Date, subsequent per series\n\t\tconst heads = [\n\t\t\t{ text: \"Date\", classes: \"nhsuk-table__header--align-left\" },\n\t\t\t...autoTableFromSeries.map((s) => ({\n\t\t\t\ttext: s.label || s.id,\n\t\t\t\tclasses: \"nhsuk-table__header--align-left\",\n\t\t\t})),\n\t\t];\n\n\t\t// Assume all series share x domain; use longest series for rows\n\t\tconst longest = autoTableFromSeries.reduce(\n\t\t\t(a, b) => (b.data.length > a.data.length ? b : a),\n\t\t\tautoTableFromSeries[0]\n\t\t);\n\n\t\tconst rows = longest.data.map((d, rowIdx) => {\n\t\t\tconst dateCell = {\n\t\t\t\ttext: new Date(d.x as any).toLocaleDateString(),\n\t\t\t\tclasses: \"nhsuk-table__cell--align-left\",\n\t\t\t};\n\t\t\tconst seriesCells = autoTableFromSeries.map((s) => {\n\t\t\t\tconst point = s.data[rowIdx];\n\t\t\t\tconst yVal = point ? point.y : undefined;\n\t\t\t\treturn {\n\t\t\t\t\ttext: yVal === undefined || yVal === null ? \"\u2013\" : String(yVal),\n\t\t\t\t\tclasses: \"nhsuk-table__cell--align-left\",\n\t\t\t\t\theader: s.label || s.id,\n\t\t\t\t};\n\t\t\t});\n\t\t\treturn [dateCell, ...seriesCells];\n\t\t});\n\n\t\tconst filenameBase =\n\t\t\tdownloadFilename ||\n\t\t\t(title ? title.replace(/[^a-z0-9]+/gi, \"-\").toLowerCase() : \"chart-data\");\n\t\tconst toCsv = () => {\n\t\t\tconst headerLine = heads.map((h) => '\"' + (h.text || \"\") + '\"').join(\",\");\n\t\t\tconst body = rows\n\t\t\t\t.map((r) => r.map((c) => '\"' + (c.text ?? \"\") + '\"').join(\",\"))\n\t\t\t\t.join(\"\\n\");\n\t\t\treturn headerLine + \"\\n\" + body + \"\\n\";\n\t\t};\n\t\tconst handleDownload = () => {\n\t\t\t// Guard for SSR/non-browser environments\n\t\t\tif (\n\t\t\t\ttypeof window === \"undefined\" ||\n\t\t\t\ttypeof document === \"undefined\" ||\n\t\t\t\ttypeof URL === \"undefined\" ||\n\t\t\t\ttypeof Blob === \"undefined\"\n\t\t\t) {\n\t\t\t\t// Silently no-op server-side; optionally log in dev\n\t\t\t\tif (process.env.NODE_ENV !== \"production\") {\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t\"CSV download is only available in the browser environment.\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tconst blob = new Blob([toCsv()], { type: \"text/csv;charset=utf-8;\" });\n\t\t\t\tconst link = document.createElement(\"a\");\n\t\t\t\tconst url = URL.createObjectURL(blob);\n\t\t\t\tlink.href = url;\n\t\t\t\tlink.download = `${filenameBase}.csv`;\n\t\t\t\tlink.style.display = \"none\";\n\t\t\t\tconst parent: HTMLElement | null = (document.body as HTMLElement | null) || (document.documentElement as HTMLElement | null);\n\t\t\t\tif (parent) {\n\t\t\t\t\tparent.appendChild(link);\n\t\t\t\t\tlink.click();\n\t\t\t\t\tparent.removeChild(link);\n\t\t\t\t} else {\n\t\t\t\t\t// Fallback: try clicking without attaching to DOM\n\t\t\t\t\tlink.click();\n\t\t\t\t}\n\t\t\t\tURL.revokeObjectURL(url);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.warn(\"CSV download failed\", e);\n\t\t\t}\n\t\t};\n\t\tresolvedTable = (\n\t\t\t<div className=\"fdp-chart__auto-table\">\n\t\t\t\t{enableDownload && (\n\t\t\t\t\t<div className=\"fdp-chart__download-row\">\n\t\t\t\t\t\t<Button variant=\"secondary\" onClick={handleDownload} size=\"small\">\n\t\t\t\t\t\t\tDownload CSV\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t<Table caption={`${title} data`} head={heads} rows={rows} responsive />\n\t\t\t</div>\n\t\t);\n\t}\n\n\tconst hasTable = !!resolvedTable && !hideTable;\n\tconst shouldUseTabs = !disableTabs && hasTable;\n\n\tif (!shouldUseTabs) {\n\t\treturn (\n\t\t\t<ChartContainer\n\t\t\t\ttitle={title}\n\t\t\t\tdescription={description}\n\t\t\t\tsource={source}\n\t\t\t\twidth={width}\n\t\t\t\theight={height}\n\t\t\t\tclassName={className}\n\t\t\t\tid={id}\n\t\t\t\tinitiallyShowTable={false}\n\t\t\t\t{...restContainer}\n\t\t\t>\n\t\t\t\t{chart}\n\t\t\t</ChartContainer>\n\t\t);\n\t}\n\n\tconst baseTabs: TabItem[] = [\n\t\t{\n\t\t\tid: \"chart\",\n\t\t\tlabel: chartTabLabel,\n\t\t\tcontent: (\n\t\t\t\t<ChartContainer\n\t\t\t\t\ttitle={title}\n\t\t\t\t\tdescription={description}\n\t\t\t\t\tsource={source}\n\t\t\t\t\twidth={width}\n\t\t\t\t\theight={height}\n\t\t\t\t\tclassName={className}\n\t\t\t\t\tid={id}\n\t\t\t\t\tinitiallyShowTable={false}\n\t\t\t\t\t{...restContainer}\n\t\t\t\t>\n\t\t\t\t\t{chart}\n\t\t\t\t</ChartContainer>\n\t\t\t),\n\t\t},\n\t\t{\n\t\t\tid: \"table\",\n\t\t\tlabel: tableTabLabel,\n\t\t\tcontent: (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"fdp-chart-table-wrapper\"\n\t\t\t\t\taria-label={`${title} data table`}\n\t\t\t\t>\n\t\t\t\t\t{resolvedTable}\n\t\t\t\t</div>\n\t\t\t),\n\t\t},\n\t];\n\n\tconst items: TabItem[] = additionalTabs\n\t\t? [...baseTabs, ...additionalTabs]\n\t\t: baseTabs;\n\n\treturn (\n\t\t<div className=\"fdp-chart-tabs\" data-chart-with-table>\n\t\t\t<Tabs\n\t\t\t\titems={items}\n\t\t\t\tdefaultActiveTab={initialView}\n\t\t\t\tonTabChange={(tabId: string) => {\n\t\t\t\t\tif (tabId === \"chart\" || tabId === \"table\") {\n\t\t\t\t\t\tonViewChange?.(tabId);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tonViewChange?.(tabId as any);\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t/>\n\t\t</div>\n\t);\n};\n\nexport default ChartWithTableTabs;\n", "import * as React from 'react';\nimport { pickSeriesColor, pickSeriesStroke, pickRegionColor, pickRegionStroke, pickSeverityColor, pickSeverityStroke, pickOrgLevelColor, pickOrgLevelStroke } from '../../utils/colors';\nimport { useVisibility } from '../../core/VisibilityContext';\n\nexport interface LegendItem {\n  id: string;\n  label: string;\n  color?: string; // explicit override fill colour\n  stroke?: string; // explicit stroke\n  palette?: 'categorical' | 'region' | 'severity' | 'org-level';\n  description?: string; // optional accessible description / tooltip (future)\n  /** Optional pattern data URI (e.g. from patternDataUrl). When provided overlays on top of colour for CVD-friendly distinction. */\n  patternDataUrl?: string;\n}\n\nexport interface LegendProps {\n  /** Legend items. If omitted and a VisibilityProvider is present, auto inference may be added later. */\n  items?: LegendItem[];\n  palette?: 'categorical' | 'region' | 'severity';\n  direction?: 'row' | 'column';\n  /** Make legend interactive \u2013 clicking toggles series visibility */\n  interactive?: boolean;\n  /** If true (default) adjust a white stroke token to dark on white page backgrounds for visibility */\n  adjustStrokeForWhiteBackground?: boolean;\n  /** Controlled hidden ids (when supplied component is controlled) */\n  hiddenIds?: string[];\n  /** Default hidden ids (uncontrolled) */\n  defaultHiddenIds?: string[];\n  /** Callback whenever visibility changes */\n  onVisibilityChange?: (visibleIds: string[], hiddenIds: string[]) => void;\n  /** Optional announcement override; return string describing change */\n  formatAnnouncement?: (id: string, nowVisible: boolean, label: string) => string;\n}\n\n/** Legend with optional interactive show/hide toggling and aria-live announcements */\nexport const Legend: React.FC<LegendProps> = ({\n  items: itemsProp,\n  palette = 'categorical',\n  direction = 'row',\n  interactive = false,\n  adjustStrokeForWhiteBackground = true,\n  hiddenIds,\n  defaultHiddenIds = [],\n  onVisibilityChange,\n  formatAnnouncement\n}) => {\n  const visibility = useVisibility();\n  const contextInteractive = !!(visibility && !interactive && !onVisibilityChange && hiddenIds === undefined);\n  const effectiveInteractive = interactive || contextInteractive;\n  const items = itemsProp || [];\n  const controlled = hiddenIds !== undefined;\n  const [internalHidden, setInternalHidden] = React.useState<Set<string>>(new Set(defaultHiddenIds));\n  const effectiveHidden = controlled ? new Set(hiddenIds) : internalHidden;\n  const [announcement, setAnnouncement] = React.useState('');\n\n  const toggle = (id: string) => {\n    if (contextInteractive && visibility) {\n      const wasHidden = visibility.isHidden(id);\n      visibility.toggle(id);\n      const item = items.find(i => i.id === id);\n      const label = item?.label || id;\n      const msg = formatAnnouncement\n        ? formatAnnouncement(id, wasHidden, label)\n        : `${label} ${wasHidden ? 'shown' : 'hidden'}`;\n      setAnnouncement(msg);\n      return;\n    }\n    if (!effectiveInteractive) return;\n    const next = new Set(effectiveHidden);\n    const wasHidden = next.has(id);\n    if (wasHidden) next.delete(id); else next.add(id);\n    if (!controlled) setInternalHidden(next);\n    const visibleIds = items.filter(i => !next.has(i.id)).map(i => i.id);\n    const hiddenNow = Array.from(next);\n    onVisibilityChange?.(visibleIds, hiddenNow);\n    const item = items.find(i => i.id === id);\n    const label = item?.label || id;\n    const msg = formatAnnouncement\n      ? formatAnnouncement(id, wasHidden, label)\n      : `${label} ${wasHidden ? 'shown' : 'hidden'}`;\n    setAnnouncement(msg);\n  };\n\n  return (\n    <div className=\"fdp-legend-wrapper\">\n      <ul className={`fdp-legend fdp-legend--${direction}`}> \n        {items.map((item, i) => {\n          const effectivePalette = item.palette || palette;\n          const fill = item.color || (\n            effectivePalette === 'region' ? pickRegionColor(item.id, i)\n            : effectivePalette === 'severity' ? pickSeverityColor(item.id, i)\n            : effectivePalette === 'org-level' ? pickOrgLevelColor(item.id, i)\n            : pickSeriesColor(i)\n          );\n          let stroke = item.stroke || (\n            effectivePalette === 'region' ? pickRegionStroke(item.id, i)\n            : effectivePalette === 'severity' ? pickSeverityStroke(item.id, i)\n            : effectivePalette === 'org-level' ? pickOrgLevelStroke(item.id, i)\n            : pickSeriesStroke(i)\n          );\n          if (adjustStrokeForWhiteBackground && stroke) {\n            const norm = stroke.trim().toLowerCase();\n            if (norm === '#fff' || norm === '#ffffff' || norm === 'white' || /^rgb\\(\\s*255\\s*,\\s*255\\s*,\\s*255\\s*\\)$/.test(norm)) {\n              // Override to dark neutral for visibility against white legend background.\n              stroke = '#212b32';\n            }\n          }\n          const hidden = contextInteractive && visibility ? visibility.isHidden(item.id) : effectiveHidden.has(item.id);\n          const btnProps: React.ButtonHTMLAttributes<HTMLButtonElement> = effectiveInteractive ? {\n            'aria-pressed': !hidden,\n            'aria-label': `${item.label} (${hidden ? 'show' : 'hide'})`,\n            onClick: () => toggle(item.id)\n          } : { 'aria-label': item.label };\n          return (\n            <li key={item.id} className={`fdp-legend__item${hidden ? ' fdp-legend__item--hidden' : ''}`}> \n              <button\n                type=\"button\"\n                className=\"fdp-legend__swatch\"\n                style={{\n                  backgroundColor: fill,\n                  backgroundImage: item.patternDataUrl ? `url(${item.patternDataUrl})` : undefined,\n                  backgroundSize: item.patternDataUrl ? 'auto' : undefined,\n                  borderColor: stroke\n                }}\n                {...btnProps}\n              />\n              <span className=\"fdp-legend__label\">{item.label}</span>\n            </li>\n          );\n        })}\n      </ul>\n  {effectiveInteractive && (\n        <div className=\"fdp-visually-hidden\" aria-live=\"polite\" aria-atomic=\"true\">{announcement}</div>\n      )}\n    </div>\n  );\n};\n\nexport default Legend;\n", "import * as React from 'react';\nimport LineChart, { type LineChartProps, type LineSeries } from './charts/LineChart/LineChart';\nimport Legend, { type LegendProps } from './charts/Legend/Legend';\nimport { assignSeriesColors } from './utils/colors';\n\nexport interface FilterableLineChartProps extends Omit<LineChartProps, 'series'> {\n  series: LineSeries[];\n  legendPosition?: 'top' | 'bottom';\n  initialHiddenIds?: string[];\n  hiddenIds?: string[];\n  onHiddenChange?: (hiddenIds: string[], visibleIds: string[]) => void;\n  legendProps?: Omit<LegendProps, 'items' | 'interactive' | 'hiddenIds' | 'onVisibilityChange'>;\n  assignColors?: boolean;\n}\n\nexport const FilterableLineChart: React.FC<FilterableLineChartProps> = ({\n  series,\n  legendPosition = 'top',\n  initialHiddenIds = [],\n  hiddenIds,\n  onHiddenChange,\n  legendProps,\n  assignColors = true,\n  palette = 'categorical',\n  ...lineChartProps\n}) => {\n  const coloured = React.useMemo(() => assignColors ? assignSeriesColors(series, { palette }) : series, [series, assignColors, palette]);\n  const controlled = hiddenIds !== undefined;\n  const [internalHidden, setInternalHidden] = React.useState<Set<string>>(new Set(initialHiddenIds));\n  const hiddenSet = controlled ? new Set(hiddenIds) : internalHidden;\n  const visibleSeries = React.useMemo(() => coloured.filter(s => !hiddenSet.has(s.id)), [coloured, hiddenSet]);\n\n  const handleVisibilityChange = React.useCallback((_visibleIds: string[], nextHiddenIds: string[]) => {\n    if (!controlled) setInternalHidden(new Set(nextHiddenIds));\n    const visibleIds = coloured.filter(s => !nextHiddenIds.includes(s.id)).map(s => s.id);\n    onHiddenChange?.(nextHiddenIds, visibleIds);\n  }, [controlled, coloured, onHiddenChange]);\n\n  const legendItems = React.useMemo(() => coloured.map(s => ({ id: s.id, label: s.label || s.id, color: s.color })), [coloured]);\n\n  const chartEl = <LineChart {...lineChartProps} series={visibleSeries} palette={palette} />;\n  const legendEl = (\n    <Legend\n      {...legendProps}\n      palette={palette}\n      items={legendItems}\n      interactive\n      hiddenIds={Array.from(hiddenSet)}\n      onVisibilityChange={(visible, hidden) => handleVisibilityChange(visible, hidden)}\n    />\n  );\n\n  return (\n    <div className=\"fdp-filterable-line-chart\">\n      {legendPosition === 'top' && legendEl}\n      {chartEl}\n      {legendPosition === 'bottom' && legendEl}\n    </div>\n  );\n};\n\nexport default FilterableLineChart;\n", "import * as React from \"react\";\nimport { createLinePath } from \"../utils/scales\";\nimport { pickSeriesColor, pickRegionColor } from \"../utils/colors\";\nimport { useScaleContext } from \"../core/ScaleContext\";\nimport { useVisibility } from \"../core/VisibilityContext\";\nimport { useTooltipContext } from \"../core/TooltipContext\";\nimport { area as d3Area, curveMonotoneX } from \"d3-shape\";\n\nexport interface AreaDatum {\n\tx: Date | string | number;\n\ty: number;\n}\nexport interface AreaSeries {\n\tid: string;\n\tdata: AreaDatum[];\n\tcolor?: string;\n\tlabel?: string;\n}\n\nexport interface AreaSeriesPrimitiveProps {\n\tseries: AreaSeries;\n\tseriesIndex: number;\n\tpalette: \"categorical\" | \"region\";\n\tfocusablePoints?: boolean; // reserved for future parity with line points\n\tfocusIndex?: number; // reserved for future keyboard focus impl\n\tparseX: (d: AreaDatum) => Date;\n\t/** If true, draws only the area fill (no outline). Default renders both. */\n\tareaOnly?: boolean;\n\t/** Hidden presentation mirrors LineSeriesPrimitive behaviour. */\n\tvisibilityMode?: \"remove\" | \"fade\";\n\t/** Optional baseline (y value) for stacked / diverging future use. Defaults to 0. */\n\tbaselineY?: number;\n\t/** Enable curve smoothing (monotoneX). Defaults to true. */\n\tsmooth?: boolean;\n\t/** Optional stacked data providing per-datum y0/y1 (overrides baselineY & raw y). Length must match series.data. */\n\tstacked?: { y0: number; y1: number }[];\n\t/** When true, uses a vertical gradient (solid at line, transparent at baseline) instead of flat fill. */\n\tgradientFill?: boolean;\n\t/** Optional explicit colour palette overriding default pickSeriesColor / pickRegionColor logic.\n\t *  Precedence: series.color > colors[seriesIndex] > internal palette. */\n\tcolors?: string[];\n}\n\n/** Renders an area under a line (baseline -> series y). Provides tooltip registration like LineSeriesPrimitive. */\nexport const AreaSeriesPrimitive: React.FC<AreaSeriesPrimitiveProps> = ({\n\tseries,\n\tseriesIndex,\n\tpalette,\n\tparseX,\n\tareaOnly = false,\n\tvisibilityMode = \"remove\",\n\tbaselineY = 0,\n\tsmooth = true,\n\tstacked,\n\tgradientFill = true,\n\tcolors,\n}) => {\n\tconst scaleCtx = useScaleContext();\n\tif (!scaleCtx) return null;\n\tconst { xScale, yScale } = scaleCtx;\n\tconst visibility = useVisibility();\n\tconst isHidden = visibility?.isHidden(series.id) ?? false;\n\tconst faded = isHidden && visibilityMode === \"fade\";\n\tif (isHidden && visibilityMode === \"remove\") return null;\n\tconst tooltip = useTooltipContext();\n\n\tReact.useEffect(() => {\n\t\tif (!tooltip) return;\n\t\tconst normalized = series.data.map((d) => ({ x: parseX(d), y: d.y }));\n\t\ttooltip.registerSeries(series.id, normalized);\n\t\treturn () => tooltip.unregisterSeries(series.id);\n\t}, [tooltip, series.id, series.data, parseX]);\n\n\tconst paletteOverride = colors && colors[seriesIndex];\n\tconst color =\n\t\tseries.color ||\n\t\tpaletteOverride ||\n\t\t(palette === \"region\"\n\t\t\t? pickRegionColor(series.id, seriesIndex)\n\t\t\t: pickSeriesColor(seriesIndex));\n\n\t// Build area + optional line with smoothing toggle.\n\t// For stacked series we want the line to trace the TOP boundary (y1), not the raw datum y.\n\tconst linePath = React.useMemo(() => {\n\t\tif (stacked && stacked.length === series.data.length) {\n\t\t\t// createLinePath expects (d: AreaDatum) => number; we derive index via reference equality.\n\t\t\treturn createLinePath(\n\t\t\t\tseries.data,\n\t\t\t\t(d) => xScale(parseX(d)),\n\t\t\t\t(d) => {\n\t\t\t\t\tconst idx = series.data.indexOf(d);\n\t\t\t\t\treturn yScale(stacked[idx].y1);\n\t\t\t\t},\n\t\t\t\t{ smooth }\n\t\t\t);\n\t\t}\n\t\treturn createLinePath(\n\t\t\tseries.data,\n\t\t\t(d) => xScale(parseX(d)),\n\t\t\t(d) => yScale(d.y),\n\t\t\t{ smooth }\n\t\t);\n\t}, [series.data, stacked, xScale, yScale, parseX, smooth]);\n\tconst areaPath = React.useMemo(() => {\n\t\tif (stacked && stacked.length === series.data.length) {\n\t\t\tconst gen = d3Area<AreaDatum & { __y0: number; __y1: number }>()\n\t\t\t\t.x((d) => xScale(parseX(d)))\n\t\t\t\t.y0((_, i) => yScale(stacked[i].y0))\n\t\t\t\t.y1((_, i) => yScale(stacked[i].y1));\n\t\t\tif (smooth) gen.curve(curveMonotoneX);\n\t\t\treturn gen(series.data as any) || \"\";\n\t\t}\n\t\t// Clamp baseline so it never falls below the current y-domain minimum (otherwise the path\n\t\t// can extrapolate off the bottom when the domain has a positive lower bound).\n\t\tconst [domainMin, domainMax] = yScale.domain();\n\t\tlet effectiveBaseline = baselineY;\n\t\tif (effectiveBaseline < domainMin) effectiveBaseline = domainMin;\n\t\telse if (effectiveBaseline > domainMax) effectiveBaseline = domainMax; // safety clamp\n\t\tconst gen = d3Area<AreaDatum>()\n\t\t\t.x((d) => xScale(parseX(d)))\n\t\t\t.y0(() => yScale(effectiveBaseline))\n\t\t\t.y1((d) => yScale(d.y));\n\t\tif (smooth) gen.curve(curveMonotoneX);\n\t\treturn gen(series.data) || \"\";\n\t}, [series.data, stacked, xScale, yScale, parseX, baselineY, smooth]);\n\n\tconst gradientId = React.useId();\n\treturn (\n\t\t<g\n\t\t\tclassName=\"fdp-area-series\"\n\t\t\tdata-series={series.id}\n\t\t\topacity={faded ? 0.25 : 1}\n\t\t\taria-hidden={faded ? true : undefined}\n\t\t>\n\t\t\t{gradientFill && (\n\t\t\t\t<defs>\n\t\t\t\t\t<linearGradient id={gradientId} x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n\t\t\t\t\t\t<stop offset=\"0%\" stopColor={color} stopOpacity={0.25} />\n\t\t\t\t\t\t<stop offset=\"100%\" stopColor={color} stopOpacity={0} />\n\t\t\t\t\t</linearGradient>\n\t\t\t\t</defs>\n\t\t\t)}\n\t\t\t<path\n\t\t\t\tclassName=\"fdp-area-series__fill\"\n\t\t\t\td={areaPath}\n\t\t\t\tfill={gradientFill ? `url(#${gradientId})` : color}\n\t\t\t\t{...(gradientFill ? {} : { fillOpacity: 0.25 })}\n\t\t\t\tstroke=\"none\"\n\t\t\t/>\n\t\t\t{!areaOnly && (\n\t\t\t\t<path d={linePath} fill=\"none\" stroke={color} strokeWidth={1} />\n\t\t\t)}\n\t\t</g>\n\t);\n};\n\nexport default AreaSeriesPrimitive;\n", "import * as React from \"react\";\nimport { useScaleContext } from \"../core/ScaleContext\";\nimport { useVisibility } from \"../core/VisibilityContext\";\nimport { useTooltipContext } from \"../core/TooltipContext\";\nimport { useChartContext } from \"../core/ChartRoot\";\nimport {\n\tpickSeriesColor,\n\tpickRegionColor,\n\tpickSeriesStroke,\n\tpickRegionStroke,\n} from \"../utils/colors\";\n\nexport interface BarDatum {\n\tx: Date | string | number;\n\ty: number;\n}\nexport interface BarSeries {\n\tid: string;\n\tdata: BarDatum[];\n\tcolor?: string;\n\tlabel?: string;\n\tbarWidth?: number;\n}\n\nexport interface BarSeriesPrimitiveProps {\n\tseries: BarSeries;\n\tseriesIndex: number;\n\tseriesCount: number; // total number of bar series rendered in the group (for width partitioning)\n\tpalette: \"categorical\" | \"region\";\n\t/** Provide parseX so callers can reuse memoised function across series */\n\tparseX: (d: BarDatum) => Date;\n\t/** All series in the grouped chart (used for global x step inference on continuous scales to avoid overlap). */\n\tallSeries?: BarSeries[];\n\t/** Focusable bars (keyboard tab). For large sets you may disable. */\n\tfocusable?: boolean;\n\t/** Width fill factor inside inferred step (0..1) */\n\twidthFactor?: number;\n\t/** Gap (px) between grouped bars (apportioned inside step) */\n\tgroupGap?: number;\n\t/** Dynamic gap ratio (gap = barWidth * gapRatio) for grouped bars. Overrides static groupGap when provided. Default 0.15 */\n\tgapRatio?: number;\n\t/** Explicit per-bar width override (px). If provided, inference is skipped (continuous scales). For band scales this is clamped to available slot. */\n\tbarWidth?: number;\n\t/** Adaptive mode: dynamically fill available step width up to an occupancy factor, ignoring widthFactor when continuous. */\n\tadaptive?: boolean;\n\t/** Fraction (0-1] of the step (distance to next category midpoint) to occupy as total group width in adaptive mode. Default 0.9 */\n\tadaptiveGroupOccupancy?: number;\n\t/** Minimum bar width (px) for continuous scales. If the inferred uniform bar width would be smaller and it is possible to satisfy the constraint within slot bounds, it will be raised to this value. (No effect for band scales or when explicit barWidth provided.) */\n\tminBarWidth?: number;\n\t/** Presentation for hidden series (consistency with line). */\n\tvisibilityMode?: \"remove\" | \"fade\";\n\t/** Color assignment mode: by entire series (default) or per category (datum index within a single series). */\n\tcolorMode?: \"series\" | \"category\";\n\t/** Optional stacked data: for a stacked vertical bar each datum gets y0,y1 absolute values (pre-normalised if percent). Mutually exclusive with grouped multi-series at same x (i.e., set seriesCount=1 for stacked multi-layer). */\n\tstacked?: { y0: number; y1: number }[];\n\t/** If true, renders stacked segments individually instead of grouping across series. Provided mainly for future extension (multi-encoded). */\n\tstackedMode?: boolean;\n\t/** Apply vertical gradient wash (solid at top -> transparent at baseline). Default true. */\n\tgradientFill?: boolean;\n\t/** When gradientFill is true, match stroke to primary bar colour. If false, fall back to token/dark stroke. Default true. */\n\tgradientStrokeMatch?: boolean;\n\t/** Overall opacity for visible bars (applied to wrapper group). Default 1 (was previously 0.25 in some non\u2011gradient cases). */\n\topacity?: number;\n\t/** Opacity applied when visibilityMode === 'fade'. Default 0.25 (existing visual behaviour). */\n\tfadedOpacity?: number;\n\t/** Fill opacity when gradientFill = false (flat colour mode). Default 1 (previously hard\u2011coded to 0.25). */\n\tflatFillOpacity?: number;\n\t/** Optional explicit colour palette overriding default pickSeriesColor / pickRegionColor logic.\n\t *  Precedence: series.color (single override) > colors[index] > internal palette.\n\t *  For colorMode = 'series' we use colors[seriesIndex]; for 'category' we use colors[datumIndex]. */\n\tcolors?: string[];\n}\n\n/** Low-level primitive for vertical bars (time / ordinal X via ScaleContext time scale). */\nexport const BarSeriesPrimitive: React.FC<BarSeriesPrimitiveProps> = ({\n\tseries,\n\tseriesIndex,\n\tseriesCount,\n\tpalette,\n\tparseX,\n\tfocusable = true,\n\twidthFactor = 0.8,\n\tgroupGap = 2,\n\tbarWidth,\n\tadaptive = false,\n\tadaptiveGroupOccupancy = 0.9,\n\tvisibilityMode = \"remove\",\n\tcolorMode = \"series\",\n\tallSeries,\n\tstacked,\n\tgapRatio = 0.15,\n\tminBarWidth,\n\tgradientFill = true,\n\tgradientStrokeMatch = true,\n\topacity = 1,\n\tfadedOpacity = 0.25,\n\tflatFillOpacity = 1,\n\tcolors,\n}) => {\n\tconst effectiveGapRatio = Math.max(0, gapRatio);\n\tconst scaleCtx = useScaleContext();\n\tconst chartDims = useChartContext();\n\tif (!scaleCtx || !chartDims) return null;\n\tconst { xScale, yScale } = scaleCtx;\n\tconst visibility = useVisibility();\n\tconst isHidden = visibility?.isHidden(series.id) ?? false;\n\tconst faded = isHidden && visibilityMode === \"fade\";\n\tif (isHidden && visibilityMode === \"remove\") return null;\n\tconst tooltip = useTooltipContext();\n\n\t// Register for tooltip nearest lookup (treat bar top as focus coordinate)\n\tReact.useEffect(() => {\n\t\tif (!tooltip) return;\n\t\tconst normalized = series.data.map((d) => ({ x: parseX(d), y: d.y }));\n\t\ttooltip.registerSeries(series.id, normalized);\n\t\treturn () => tooltip.unregisterSeries(series.id);\n\t}, [tooltip, series.id, series.data, parseX]);\n\n\t// Support band scale (categorical) if present, else fall back to pixel inference on continuous scale\n\tconst isBandScale = typeof (xScale as any).bandwidth === \"function\";\n\tconst bandwidth = isBandScale ? (xScale as any).bandwidth() : undefined;\n\tconst inferredPixelWidth = React.useMemo(() => {\n\t\tif (bandwidth != null) return bandwidth; // band scale already encodes step\n\t\t// Use global x positions across all series if provided for consistent grouping width\n\t\tconst sourceSeries = allSeries && allSeries.length ? allSeries : [series];\n\t\tconst posSet: number[] = [];\n\t\tsourceSeries.forEach((s) => {\n\t\t\ts.data.forEach((d) => {\n\t\t\t\tconst v = xScale(parseX(d));\n\t\t\t\tif (Number.isFinite(v)) posSet.push(v);\n\t\t\t});\n\t\t});\n\t\tconst pxPositions = posSet.sort((a, b) => a - b);\n\t\tif (pxPositions.length <= 1) return 40; // fallback width for single bar\n\t\tconst diffs: number[] = [];\n\t\tfor (let i = 1; i < pxPositions.length; i++)\n\t\t\tdiffs.push(pxPositions[i] - pxPositions[i - 1]);\n\t\tdiffs.sort((a, b) => a - b);\n\t\tconst median = diffs[Math.floor(diffs.length / 2)] || 40;\n\t\treturn median * widthFactor;\n\t}, [series.data, allSeries, xScale, parseX, widthFactor, bandwidth]);\n\n\t// Group width = total width occupied by all bars in a group plus base single bar width candidate\n\tconst { basePerBar } = React.useMemo(() => {\n\t\t// Band scale: derived from bandwidth then optional override (clamped)\n\t\tif (isBandScale) {\n\t\t\tconst bw = inferredPixelWidth; // bandwidth\n\t\t\tconst autoPerBar = Math.max(\n\t\t\t\t1,\n\t\t\t\t(bw - groupGap * (seriesCount - 1)) / seriesCount\n\t\t\t);\n\t\t\tconst explicit = series.barWidth ?? barWidth;\n\t\t\tlet finalPerBar = explicit ? Math.min(explicit, bw) : autoPerBar;\n\t\t\tif (adaptive) {\n\t\t\t\tconst targetGroup =\n\t\t\t\t\tbw * Math.min(1, Math.max(0.05, adaptiveGroupOccupancy));\n\t\t\t\tconst adaptedPerBar = Math.max(\n\t\t\t\t\t1,\n\t\t\t\t\t(targetGroup - groupGap * (seriesCount - 1)) / seriesCount\n\t\t\t\t);\n\t\t\t\tfinalPerBar = explicit\n\t\t\t\t\t? Math.min(finalPerBar, adaptedPerBar)\n\t\t\t\t\t: adaptedPerBar;\n\t\t\t}\n\t\t\treturn { basePerBar: finalPerBar };\n\t\t}\n\t\t// Continuous scale: explicit override first\n\t\tconst explicit = series.barWidth ?? barWidth;\n\t\t// Compute base auto width from inferredPixelWidth (median diff * widthFactor already baked into inferredPixelWidth)\n\t\tconst maxAutoPer = Math.max(\n\t\t\t1,\n\t\t\t(inferredPixelWidth - groupGap * (seriesCount - 1)) / seriesCount\n\t\t);\n\t\tif (adaptive) {\n\t\t\t// Recompute step using nearest neighbor distance across global positions for tighter occupancy\n\t\t\tconst sourceSeries = allSeries && allSeries.length ? allSeries : [series];\n\t\t\tconst positions: number[] = [];\n\t\t\tsourceSeries.forEach((s) =>\n\t\t\t\ts.data.forEach((d) => {\n\t\t\t\t\tconst v = xScale(parseX(d));\n\t\t\t\t\tif (Number.isFinite(v)) positions.push(v);\n\t\t\t\t})\n\t\t\t);\n\t\t\tpositions.sort((a, b) => a - b);\n\t\t\tconst diffs: number[] = [];\n\t\t\tfor (let i = 1; i < positions.length; i++)\n\t\t\t\tdiffs.push(positions[i] - positions[i - 1]);\n\t\t\tdiffs.sort((a, b) => a - b);\n\t\t\tconst step = diffs[Math.floor(diffs.length / 2)] || inferredPixelWidth;\n\t\t\tconst targetGroup =\n\t\t\t\tstep * Math.min(1, Math.max(0.05, adaptiveGroupOccupancy));\n\t\t\tconst adaptivePer = Math.max(\n\t\t\t\t1,\n\t\t\t\t(targetGroup - groupGap * (seriesCount - 1)) / seriesCount\n\t\t\t);\n\t\t\tconst finalPer = explicit ? Math.min(explicit, adaptivePer) : adaptivePer;\n\t\t\treturn { basePerBar: finalPer };\n\t\t}\n\t\tif (explicit) {\n\t\t\tconst finalPer = Math.min(explicit, maxAutoPer);\n\t\t\treturn { basePerBar: finalPer };\n\t\t}\n\t\treturn { basePerBar: maxAutoPer };\n\t}, [\n\t\tisBandScale,\n\t\tinferredPixelWidth,\n\t\tgroupGap,\n\t\tseriesCount,\n\t\tbarWidth,\n\t\tseries.barWidth,\n\t\tadaptive,\n\t\tadaptiveGroupOccupancy,\n\t\tallSeries,\n\t\txScale,\n\t\tparseX,\n\t]);\n\t// Precompute global centers for continuous scale once\n\tconst globalCenters = React.useMemo(() => {\n\t\tif (isBandScale) return [] as number[];\n\t\tconst pts: number[] = [];\n\t\tconst src = allSeries && allSeries.length ? allSeries : [series];\n\t\tsrc.forEach((s) =>\n\t\t\ts.data.forEach((pt) => {\n\t\t\t\tconst v = xScale(parseX(pt));\n\t\t\t\tif (Number.isFinite(v)) pts.push(v);\n\t\t\t})\n\t\t);\n\t\tpts.sort((a, b) => a - b);\n\t\treturn Array.from(new Set(pts));\n\t}, [isBandScale, allSeries, series, xScale, parseX]);\n\t// Slot bounds for continuous layout: each data center gets a slot from midpoint(prev, current) to midpoint(current, next);\n\t// first slot starts at 0, last slot ends at innerWidth -> ensures no overflow beyond plotting area.\n\tconst continuousSlots = React.useMemo(() => {\n\t\tif (isBandScale)\n\t\t\treturn [] as { center: number; left: number; right: number }[];\n\t\tif (!globalCenters.length) return [];\n\t\tif (globalCenters.length === 1) {\n\t\t\treturn [\n\t\t\t\t{ center: globalCenters[0], left: 0, right: chartDims.innerWidth },\n\t\t\t];\n\t\t}\n\t\tconst slots: { center: number; left: number; right: number }[] = [];\n\t\tfor (let i = 0; i < globalCenters.length; i++) {\n\t\t\tconst c = globalCenters[i];\n\t\t\tconst left = i === 0 ? 0 : (globalCenters[i - 1] + c) / 2;\n\t\t\tconst right =\n\t\t\t\ti === globalCenters.length - 1\n\t\t\t\t\t? chartDims.innerWidth\n\t\t\t\t\t: (c + globalCenters[i + 1]) / 2;\n\t\t\tslots.push({\n\t\t\t\tcenter: c,\n\t\t\t\tleft: Math.max(0, left),\n\t\t\t\tright: Math.min(chartDims.innerWidth, right),\n\t\t\t});\n\t\t}\n\t\treturn slots;\n\t}, [isBandScale, globalCenters, chartDims.innerWidth]);\n\n\t// Uniform group width across all continuous slots so first/last bars are same width.\n\tconst continuousUniforms = React.useMemo(() => {\n\t\tif (isBandScale || !continuousSlots.length)\n\t\t\treturn undefined as undefined | { groupWidth: number; barWidth: number };\n\t\tconst occupancy = Math.min(1, Math.max(0.05, widthFactor));\n\t\tconst slotSpans = continuousSlots.map((s) => Math.max(2, s.right - s.left));\n\t\t// Candidate width per slot capped by slot span minus a pixel padding, scaled by occupancy\n\t\tconst candidates = slotSpans.map((span) =>\n\t\t\tMath.max(2, Math.min(span - 1, span * occupancy))\n\t\t);\n\t\tlet uniformGroupWidth = Math.min(...candidates);\n\t\t// If a minBarWidth is provided we may be able to expand beyond occupancy (without exceeding any slot span - 1)\n\t\tif (minBarWidth) {\n\t\t\tif (seriesCount <= 1) {\n\t\t\t\tconst maxFeasible = Math.min(...slotSpans.map((span) => span - 1));\n\t\t\t\tif (maxFeasible >= minBarWidth && uniformGroupWidth < minBarWidth) {\n\t\t\t\t\tuniformGroupWidth = Math.min(maxFeasible, minBarWidth);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst maxFeasibleGroup = Math.min(...slotSpans.map((span) => span - 1));\n\t\t\t\tconst requiredGroupForMin =\n\t\t\t\t\tminBarWidth * seriesCount +\n\t\t\t\t\t(seriesCount - 1) * (minBarWidth * effectiveGapRatio);\n\t\t\t\tif (\n\t\t\t\t\trequiredGroupForMin <= maxFeasibleGroup &&\n\t\t\t\t\tuniformGroupWidth < requiredGroupForMin\n\t\t\t\t) {\n\t\t\t\t\tuniformGroupWidth = requiredGroupForMin;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (seriesCount <= 1) {\n\t\t\t// For single-series continuous bars we can attempt to respect minBarWidth directly (bounded by slot constraints)\n\t\t\tif (minBarWidth && uniformGroupWidth < minBarWidth) {\n\t\t\t\t// Only upgrade if all slots can accommodate minBarWidth (single series so groupWidth == barWidth)\n\t\t\t\tconst canAllFit = slotSpans.every((span) => span >= minBarWidth);\n\t\t\t\tif (canAllFit)\n\t\t\t\t\treturn { groupWidth: minBarWidth, barWidth: minBarWidth };\n\t\t\t}\n\t\t\treturn { groupWidth: uniformGroupWidth, barWidth: uniformGroupWidth };\n\t\t}\n\t\t// Solve for barWidth where gap = barWidth * effectiveGapRatio and total group fits uniformGroupWidth\n\t\t// uniformGroupWidth = b*seriesCount + (seriesCount-1)*(b*effectiveGapRatio)\n\t\t// => b = uniformGroupWidth / (seriesCount + (seriesCount-1)*effectiveGapRatio)\n\t\tlet b =\n\t\t\tuniformGroupWidth / (seriesCount + (seriesCount - 1) * effectiveGapRatio);\n\t\tif (b < 1) b = 1; // clamp minimal visibility\n\t\tif (minBarWidth && b < minBarWidth) {\n\t\t\t// Check if raising to minBarWidth still fits inside the smallest slot span\n\t\t\tconst requiredGroup =\n\t\t\t\tminBarWidth * seriesCount +\n\t\t\t\t(seriesCount - 1) * (minBarWidth * effectiveGapRatio);\n\t\t\tif (requiredGroup <= uniformGroupWidth) {\n\t\t\t\tb = minBarWidth;\n\t\t\t}\n\t\t}\n\t\t// Recompute group width using derived b (might be slightly < uniformGroupWidth due to clamping)\n\t\tconst groupWidth =\n\t\t\tb * seriesCount + (seriesCount - 1) * (b * effectiveGapRatio);\n\t\treturn { groupWidth, barWidth: b };\n\t}, [\n\t\tisBandScale,\n\t\tcontinuousSlots,\n\t\twidthFactor,\n\t\tseriesCount,\n\t\teffectiveGapRatio,\n\t\tminBarWidth,\n\t]);\n\n\t// innerWidth not needed after uniform span logic (bounds derived from midpoints)\n\n\t// Resolve colours with explicit precedence hierarchy.\n\t// series.color always wins for primary (series-level) colour. Otherwise, for series mode use colors[seriesIndex];\n\t// for category mode each datum will consult colors[di] later.\n\tconst resolvedSeriesPaletteColor =\n\t\tcolors && colors[seriesIndex] ? colors[seriesIndex] : undefined;\n\tconst baseSeriesColor =\n\t\tseries.color ||\n\t\tresolvedSeriesPaletteColor ||\n\t\t(palette === \"region\"\n\t\t\t? pickRegionColor(series.id, seriesIndex)\n\t\t\t: pickSeriesColor(seriesIndex));\n\tconst baseSeriesStroke =\n\t\tpalette === \"region\"\n\t\t\t? pickRegionStroke(series.id, seriesIndex)\n\t\t\t: pickSeriesStroke(seriesIndex);\n\t// If explicit palette colour used we also adopt it for stroke when gradientStrokeMatch (unless series.color provided which is already in baseSeriesColor)\n\tconst effectiveBaseStroke =\n\t\tgradientStrokeMatch && (series.color || resolvedSeriesPaletteColor)\n\t\t\t? baseSeriesColor\n\t\t\t: baseSeriesStroke;\n\tconst baselineY = Number.isFinite(yScale(0)) ? yScale(0) : yScale.range()[0];\n\n\t// If stacked provided, render each datum as a single vertical rect spanning y0->y1 (ignore grouping logic beyond width allocation).\n\tconst seriesGradientId = React.useId();\n\tif (stacked && stacked.length === series.data.length) {\n\t\t// For stacked bars we typically have one BarSeriesPrimitive per stacked layer OR a combined single series with stacked segments? Here we assume one primitive per layer (like stacked areas). Width partition among series becomes full slot per layer (overlap) so we treat seriesCount=1 for geometry.\n\t\treturn (\n\t\t\t<g\n\t\t\t\tclassName=\"fdp-bar-series fdp-bar-series--stacked\"\n\t\t\t\tdata-series={series.id}\n\t\t\t\topacity={faded ? fadedOpacity : opacity}\n\t\t\t\taria-hidden={faded ? true : undefined}\n\t\t\t>\n\t\t\t\t{gradientFill && (\n\t\t\t\t\t<defs>\n\t\t\t\t\t\t{/* Vertical gradient from top-left downward (strong at top, soft toward baseline). */}\n\t\t\t\t\t\t<linearGradient\n\t\t\t\t\t\t\tid={seriesGradientId}\n\t\t\t\t\t\t\tx1=\"0%\"\n\t\t\t\t\t\t\ty1=\"0%\"\n\t\t\t\t\t\t\tx2=\"0%\"\n\t\t\t\t\t\t\ty2=\"100%\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<stop offset=\"0%\" stopColor={baseSeriesColor} stopOpacity={0.3} />\n\t\t\t\t\t\t\t<stop\n\t\t\t\t\t\t\t\toffset=\"60%\"\n\t\t\t\t\t\t\t\tstopColor={baseSeriesColor}\n\t\t\t\t\t\t\t\tstopOpacity={0.14}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<stop\n\t\t\t\t\t\t\t\toffset=\"100%\"\n\t\t\t\t\t\t\t\tstopColor={baseSeriesColor}\n\t\t\t\t\t\t\t\tstopOpacity={0.06}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t</defs>\n\t\t\t\t)}\n\t\t\t\t{series.data.map((d, di) => {\n\t\t\t\t\tconst rawX = parseX(d);\n\t\t\t\t\tconst xPos = isBandScale ? xScale(d.x as any) : xScale(rawX);\n\t\t\t\t\tlet fullWidth: number;\n\t\t\t\t\tlet barX: number;\n\t\t\t\t\tif (isBandScale) {\n\t\t\t\t\t\tfullWidth = inferredPixelWidth;\n\t\t\t\t\t\tbarX = xPos;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst slot = continuousSlots.find(\n\t\t\t\t\t\t\t(s) => Math.abs(s.center - xPos) < 0.5\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (!slot || !continuousUniforms) {\n\t\t\t\t\t\t\tfullWidth = basePerBar;\n\t\t\t\t\t\t\tbarX = xPos - basePerBar / 2;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst { groupWidth } = continuousUniforms;\n\t\t\t\t\t\t\tfullWidth = groupWidth;\n\t\t\t\t\t\t\tlet groupLeft = xPos - groupWidth / 2;\n\t\t\t\t\t\t\t// Clamp within slot\n\t\t\t\t\t\t\tif (groupLeft < slot.left) groupLeft = slot.left;\n\t\t\t\t\t\t\tif (groupLeft + groupWidth > slot.right)\n\t\t\t\t\t\t\t\tgroupLeft = Math.max(slot.left, slot.right - groupWidth);\n\t\t\t\t\t\t\tbarX = groupLeft;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconst seg = stacked[di];\n\t\t\t\t\tconst y0 = yScale(seg.y0);\n\t\t\t\t\tconst y1 = yScale(seg.y1);\n\t\t\t\t\tconst y = Math.min(y0, y1);\n\t\t\t\t\tconst height = Math.abs(y1 - y0) || 1;\n\t\t\t\t\t// Fallback enforcement: ensure minBarWidth respected if possible\n\t\t\t\t\tif (!isBandScale && minBarWidth && fullWidth < minBarWidth) {\n\t\t\t\t\t\tconst slot = continuousSlots.find(\n\t\t\t\t\t\t\t(s) => Math.abs(s.center - xPos) < 0.5\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (slot) {\n\t\t\t\t\t\t\tconst maxFeasible = Math.max(2, slot.right - slot.left - 1);\n\t\t\t\t\t\t\tconst target = Math.min(maxFeasible, minBarWidth);\n\t\t\t\t\t\t\tif (target > fullWidth) {\n\t\t\t\t\t\t\t\tfullWidth = target;\n\t\t\t\t\t\t\t\tbarX = Math.max(\n\t\t\t\t\t\t\t\t\tslot.left,\n\t\t\t\t\t\t\t\t\tMath.min(slot.right - fullWidth, xPos - fullWidth / 2)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconst isFocused =\n\t\t\t\t\t\t!faded &&\n\t\t\t\t\t\ttooltip?.focused?.seriesId === series.id &&\n\t\t\t\t\t\ttooltip.focused.index === di;\n\t\t\t\t\tconst onEnter = () => {\n\t\t\t\t\t\tif (!tooltip || faded) return;\n\t\t\t\t\t\t// Use top segment value for focus (y1)\n\t\t\t\t\t\ttooltip.setFocused({\n\t\t\t\t\t\t\tseriesId: series.id,\n\t\t\t\t\t\t\tindex: di,\n\t\t\t\t\t\t\tx: rawX as any,\n\t\t\t\t\t\t\ty: seg.y1 - seg.y0,\n\t\t\t\t\t\t\tclientX: barX + fullWidth / 2,\n\t\t\t\t\t\t\tclientY: y,\n\t\t\t\t\t\t});\n\t\t\t\t\t};\n\t\t\t\t\tconst onLeave = () => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\ttooltip?.focused?.seriesId === series.id &&\n\t\t\t\t\t\t\ttooltip.focused.index === di\n\t\t\t\t\t\t)\n\t\t\t\t\t\t\ttooltip.clear();\n\t\t\t\t\t};\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<rect\n\t\t\t\t\t\t\tkey={di}\n\t\t\t\t\t\t\tx={barX}\n\t\t\t\t\t\t\ty={y}\n\t\t\t\t\t\t\twidth={fullWidth}\n\t\t\t\t\t\t\theight={height}\n\t\t\t\t\t\t\tfill={\n\t\t\t\t\t\t\t\tgradientFill ? `url(#${seriesGradientId})` : baseSeriesColor\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t{...(!gradientFill ? { fillOpacity: flatFillOpacity } : {})}\n\t\t\t\t\t\t\t// Stroke now driven by CSS variable for non-matched gradient strokes (path 2c). Attribute only overrides for focus highlight or when matching base color.\n\t\t\t\t\t\t\tstroke={\n\t\t\t\t\t\t\t\tisFocused\n\t\t\t\t\t\t\t\t\t? \"var(--nhs-fdp-color-primary-yellow, #ffeb3b)\"\n\t\t\t\t\t\t\t\t\t: gradientFill && gradientStrokeMatch\n\t\t\t\t\t\t\t\t\t\t? baseSeriesColor\n\t\t\t\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tstrokeWidth={isFocused ? 2 : 1}\n\t\t\t\t\t\t\tclassName=\"fdp-bar fdp-bar--stacked\"\n\t\t\t\t\t\t\ttabIndex={faded || !focusable ? -1 : 0}\n\t\t\t\t\t\t\trole=\"graphics-symbol\"\n\t\t\t\t\t\t\taria-label={`${series.label || series.id} ${rawX instanceof Date ? rawX.toDateString() : rawX} value ${seg.y1 - seg.y0}`}\n\t\t\t\t\t\t\tonMouseEnter={onEnter}\n\t\t\t\t\t\t\tonFocus={onEnter}\n\t\t\t\t\t\t\tonMouseLeave={onLeave}\n\t\t\t\t\t\t\tonBlur={onLeave}\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</g>\n\t\t);\n\t}\n\n\treturn (\n\t\t<g\n\t\t\tclassName=\"fdp-bar-series\"\n\t\t\tdata-series={series.id}\n\t\t\topacity={faded ? fadedOpacity : opacity}\n\t\t\taria-hidden={faded ? true : undefined}\n\t\t>\n\t\t\t{/* Gradients: one per series in series color mode, or per bar when category mode (unique id based on index) */}\n\t\t\t{gradientFill && (\n\t\t\t\t<defs>\n\t\t\t\t\t{colorMode === \"series\" && (\n\t\t\t\t\t\t<linearGradient\n\t\t\t\t\t\t\tid={seriesGradientId}\n\t\t\t\t\t\t\tx1=\"0%\"\n\t\t\t\t\t\t\ty1=\"0%\"\n\t\t\t\t\t\t\tx2=\"0%\"\n\t\t\t\t\t\t\ty2=\"100%\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<stop offset=\"0%\" stopColor={baseSeriesColor} stopOpacity={0.3} />\n\t\t\t\t\t\t\t<stop\n\t\t\t\t\t\t\t\toffset=\"60%\"\n\t\t\t\t\t\t\t\tstopColor={baseSeriesColor}\n\t\t\t\t\t\t\t\tstopOpacity={0.14}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<stop\n\t\t\t\t\t\t\t\toffset=\"100%\"\n\t\t\t\t\t\t\t\tstopColor={baseSeriesColor}\n\t\t\t\t\t\t\t\tstopOpacity={0.06}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t)}\n\t\t\t\t\t{colorMode === \"category\" &&\n\t\t\t\t\t\tseries.data.map((d, di) => {\n\t\t\t\t\t\t\tconst paletteOverride = colors && colors[di];\n\t\t\t\t\t\t\tconst catColor =\n\t\t\t\t\t\t\t\tpaletteOverride ||\n\t\t\t\t\t\t\t\t(palette === \"region\"\n\t\t\t\t\t\t\t\t\t? pickRegionColor(String(d.x), di)\n\t\t\t\t\t\t\t\t\t: pickSeriesColor(di));\n\t\t\t\t\t\t\tconst gid = `${seriesGradientId}-${di}`;\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<linearGradient\n\t\t\t\t\t\t\t\t\tkey={gid}\n\t\t\t\t\t\t\t\t\tid={gid}\n\t\t\t\t\t\t\t\t\tx1=\"0%\"\n\t\t\t\t\t\t\t\t\ty1=\"0%\"\n\t\t\t\t\t\t\t\t\tx2=\"0%\"\n\t\t\t\t\t\t\t\t\ty2=\"100%\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<stop offset=\"0%\" stopColor={catColor} stopOpacity={0.3} />\n\t\t\t\t\t\t\t\t\t<stop offset=\"60%\" stopColor={catColor} stopOpacity={0.14} />\n\t\t\t\t\t\t\t\t\t<stop offset=\"100%\" stopColor={catColor} stopOpacity={0.06} />\n\t\t\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t</defs>\n\t\t\t)}\n\t\t\t{series.data.map((d, di) => {\n\t\t\t\tconst rawX = parseX(d);\n\t\t\t\tconst xPos = isBandScale ? xScale(d.x as any) : xScale(rawX);\n\t\t\t\t// For band scale we can position directly within the band; else group logic with inferred group width\n\t\t\t\tlet barX: number;\n\t\t\t\tlet barWidth: number;\n\t\t\t\tif (isBandScale) {\n\t\t\t\t\tconst bw = inferredPixelWidth; // full categorical slot\n\t\t\t\t\tif (seriesCount <= 1) {\n\t\t\t\t\t\tbarWidth = bw;\n\t\t\t\t\t\tbarX = xPos;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbarWidth = Math.max(\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\tbw / (seriesCount + (seriesCount - 1) * effectiveGapRatio)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst gap = barWidth * effectiveGapRatio;\n\t\t\t\t\t\tconst groupWidth = barWidth * seriesCount + gap * (seriesCount - 1);\n\t\t\t\t\t\tconst groupLeft = xPos + (bw - groupWidth) / 2;\n\t\t\t\t\t\tbarX = groupLeft + seriesIndex * (barWidth + gap);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst slot = continuousSlots.find((s) => s.center === xPos);\n\t\t\t\t\tif (!slot || !continuousUniforms) {\n\t\t\t\t\t\tbarWidth = basePerBar;\n\t\t\t\t\t\tbarX = xPos - basePerBar / 2;\n\t\t\t\t\t\tif (minBarWidth && barWidth < minBarWidth) {\n\t\t\t\t\t\t\tbarWidth = minBarWidth;\n\t\t\t\t\t\t\tbarX = xPos - barWidth / 2;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst { barWidth: uBar } = continuousUniforms;\n\t\t\t\t\t\tbarWidth = uBar;\n\t\t\t\t\t\tconst gap = seriesCount > 1 ? uBar * effectiveGapRatio : 0;\n\t\t\t\t\t\tconst computedGroupWidth =\n\t\t\t\t\t\t\tbarWidth * seriesCount + gap * (seriesCount - 1);\n\t\t\t\t\t\tlet groupLeft = xPos - computedGroupWidth / 2;\n\t\t\t\t\t\tif (groupLeft < slot.left) groupLeft = slot.left;\n\t\t\t\t\t\tif (groupLeft + computedGroupWidth > slot.right)\n\t\t\t\t\t\t\tgroupLeft = Math.max(slot.left, slot.right - computedGroupWidth);\n\t\t\t\t\t\tbarX = groupLeft + seriesIndex * (barWidth + gap);\n\t\t\t\t\t}\n\t\t\t\t\t// Fallback enforcement for continuous bars\n\t\t\t\t\tif (minBarWidth && barWidth < minBarWidth) {\n\t\t\t\t\t\tconst slot2 = continuousSlots.find(\n\t\t\t\t\t\t\t(s) => Math.abs(s.center - xPos) < 0.5\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (slot2) {\n\t\t\t\t\t\t\tconst maxFeasible = Math.max(2, slot2.right - slot2.left - 1);\n\t\t\t\t\t\t\tconst target = Math.min(maxFeasible, minBarWidth);\n\t\t\t\t\t\t\tif (target > barWidth) {\n\t\t\t\t\t\t\t\tif (seriesCount <= 1) {\n\t\t\t\t\t\t\t\t\tbarWidth = target;\n\t\t\t\t\t\t\t\t\tbarX = Math.max(\n\t\t\t\t\t\t\t\t\t\tslot2.left,\n\t\t\t\t\t\t\t\t\t\tMath.min(slot2.right - barWidth, xPos - barWidth / 2)\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tconst gap = target * effectiveGapRatio;\n\t\t\t\t\t\t\t\t\tconst neededGroup =\n\t\t\t\t\t\t\t\t\t\ttarget * seriesCount + gap * (seriesCount - 1);\n\t\t\t\t\t\t\t\t\tif (neededGroup <= slot2.right - slot2.left - 1) {\n\t\t\t\t\t\t\t\t\t\tbarWidth = target;\n\t\t\t\t\t\t\t\t\t\tconst groupWidth = neededGroup;\n\t\t\t\t\t\t\t\t\t\tlet groupLeft = xPos - groupWidth / 2;\n\t\t\t\t\t\t\t\t\t\tif (groupLeft < slot2.left) groupLeft = slot2.left;\n\t\t\t\t\t\t\t\t\t\tif (groupLeft + groupWidth > slot2.right)\n\t\t\t\t\t\t\t\t\t\t\tgroupLeft = Math.max(\n\t\t\t\t\t\t\t\t\t\t\t\tslot2.left,\n\t\t\t\t\t\t\t\t\t\t\t\tslot2.right - groupWidth\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tbarX = groupLeft + seriesIndex * (barWidth + gap);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst barCenterX = barX + barWidth / 2;\n\t\t\t\tconst valueY = yScale(d.y);\n\t\t\t\tconst y = Math.min(baselineY, valueY);\n\t\t\t\tconst height = Math.abs(baselineY - valueY);\n\t\t\t\tconst isFocused =\n\t\t\t\t\t!faded &&\n\t\t\t\t\ttooltip?.focused?.seriesId === series.id &&\n\t\t\t\t\ttooltip.focused.index === di;\n\t\t\t\tconst onEnter = () => {\n\t\t\t\t\tif (!tooltip || faded) return;\n\t\t\t\t\ttooltip.setFocused({\n\t\t\t\t\t\tseriesId: series.id,\n\t\t\t\t\t\tindex: di,\n\t\t\t\t\t\tx: rawX as any,\n\t\t\t\t\t\ty: d.y,\n\t\t\t\t\t\tclientX: barCenterX,\n\t\t\t\t\t\tclientY: valueY,\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t\tconst onLeave = () => {\n\t\t\t\t\tif (\n\t\t\t\t\t\ttooltip?.focused?.seriesId === series.id &&\n\t\t\t\t\t\ttooltip.focused.index === di\n\t\t\t\t\t)\n\t\t\t\t\t\ttooltip.clear();\n\t\t\t\t};\n\t\t\t\tconst paletteOverride =\n\t\t\t\t\tcolorMode === \"category\" && colors ? colors[di] : undefined;\n\t\t\t\tconst catColor =\n\t\t\t\t\tcolorMode === \"category\"\n\t\t\t\t\t\t? paletteOverride ||\n\t\t\t\t\t\t\t(palette === \"region\"\n\t\t\t\t\t\t\t\t? pickRegionColor(String(d.x), di)\n\t\t\t\t\t\t\t\t: pickSeriesColor(di))\n\t\t\t\t\t\t: baseSeriesColor;\n\t\t\t\tconst fillId =\n\t\t\t\t\tcolorMode === \"category\"\n\t\t\t\t\t\t? `${seriesGradientId}-${di}`\n\t\t\t\t\t\t: seriesGradientId;\n\t\t\t\tconst baseStroke =\n\t\t\t\t\tgradientFill && gradientStrokeMatch\n\t\t\t\t\t\t? catColor\n\t\t\t\t\t\t: colorMode === \"category\"\n\t\t\t\t\t\t\t? palette === \"region\"\n\t\t\t\t\t\t\t\t? pickRegionStroke(String(d.x), di)\n\t\t\t\t\t\t\t\t: pickSeriesStroke(di)\n\t\t\t\t\t\t\t: effectiveBaseStroke;\n\t\t\t\tconst barStrokeColor = isFocused\n\t\t\t\t\t? \"var(--nhs-fdp-color-primary-yellow, #ffeb3b)\"\n\t\t\t\t\t: baseStroke || catColor;\n\t\t\t\treturn (\n\t\t\t\t\t<rect\n\t\t\t\t\t\tkey={di}\n\t\t\t\t\t\tx={barX}\n\t\t\t\t\t\ty={y}\n\t\t\t\t\t\twidth={barWidth}\n\t\t\t\t\t\theight={height || 1} // ensure minimal visibility for zero-height\n\t\t\t\t\t\tfill={gradientFill ? `url(#${fillId})` : catColor}\n\t\t\t\t\t\t{...(!gradientFill ? { fillOpacity: flatFillOpacity } : {})}\n\t\t\t\t\t\tstroke={barStrokeColor}\n\t\t\t\t\t\tstrokeWidth={isFocused ? 2 : 1}\n\t\t\t\t\t\tclassName=\"fdp-bar\"\n\t\t\t\t\t\ttabIndex={faded || !focusable ? -1 : 0}\n\t\t\t\t\t\trole=\"graphics-symbol\"\n\t\t\t\t\t\taria-label={`${series.label || series.id} ${rawX instanceof Date ? rawX.toDateString() : rawX} value ${d.y}`}\n\t\t\t\t\t\tonMouseEnter={onEnter}\n\t\t\t\t\t\tonFocus={onEnter}\n\t\t\t\t\t\tonMouseLeave={onLeave}\n\t\t\t\t\t\tonBlur={onLeave}\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t})}\n\t\t</g>\n\t);\n};\n\nexport default BarSeriesPrimitive;\n", "import * as React from \"react\";\nimport { scaleBand, scaleLinear } from \"d3-scale\";\nimport ScaleContext, { type ScaleContextValue } from \"./ScaleContext\";\nimport { useChartContext } from \"./ChartRoot\";\n\nexport interface BandDatum {\n\tx: string;\n\ty: number;\n}\nexport interface BandSeries {\n\tdata: BandDatum[];\n}\n\nexport interface BandScalesProviderProps {\n\tseries: BandSeries[];\n\tinnerWidth?: number;\n\tinnerHeight?: number;\n\tpaddingInner?: number; // band scale inner padding\n\tpaddingOuter?: number; // band scale outer padding\n\tchildren: React.ReactNode;\n\tyTickCount?: number;\n}\n\nexport const BandScalesProvider: React.FC<BandScalesProviderProps> = ({\n\tseries,\n\tinnerWidth: iw,\n\tinnerHeight: ih,\n\tpaddingInner = 0.1,\n\tpaddingOuter = 0.05,\n\tchildren,\n\tyTickCount = 5,\n}) => {\n\tconst chart = useChartContext();\n\tconst innerWidth = iw ?? chart?.innerWidth ?? 0;\n\tconst innerHeight = ih ?? chart?.innerHeight ?? 0;\n\tconst allData = React.useMemo(() => series.flatMap((s) => s.data), [series]);\n\t\n\tconst xDomain = React.useMemo(() => {\n\t\tconst set = new Set<string>();\n\t\tallData.forEach((d) => set.add(d.x));\n\t\treturn Array.from(set);\n\t}, [allData]);\n\t\n\tconst yMax = React.useMemo(\n\t\t() => Math.max(0, ...allData.map((d) => d.y)),\n\t\t[allData]\n\t);\n\t\n\tconst xScale = React.useMemo(\n\t\t() =>\n\t\t\tscaleBand<string>()\n\t\t\t\t.domain(xDomain)\n\t\t\t\t.range([0, innerWidth])\n\t\t\t\t.paddingInner(paddingInner)\n\t\t\t\t.paddingOuter(paddingOuter),\n\t\t[xDomain, innerWidth, paddingInner, paddingOuter]\n\t);\n\t\n\tconst yScale = React.useMemo(\n\t\t() => scaleLinear().domain([0, yMax]).nice().range([innerHeight, 0]),\n\t\t[yMax, innerHeight]\n\t);\n\t\n\tconst value: ScaleContextValue = React.useMemo(\n\t\t() => ({\n\t\t\txScale,\n\t\t\tyScale,\n\t\t\tgetXTicks: () => xDomain as any,\n\t\t\tgetYTicks: (c = yTickCount) => yScale.ticks(c),\n\t\t}),\n\t\t[xScale, yScale, xDomain, yTickCount]\n\t);\n\treturn (\n\t\t<ScaleContext.Provider value={value}>{children}</ScaleContext.Provider>\n\t);\n};\n\nexport default BandScalesProvider;\n", "import * as React from \"react\";\nimport { useChartContext } from \"../core/ChartRoot\";\nimport { useScaleContext } from \"../core/ScaleContext\";\n\nexport type AlertStatus = \"ok\" | \"warning\" | \"critical\" | \"info\";\n\nexport interface AlertThresholdProps {\n\t/** Orientation of the threshold: horizontal (y=value) or vertical (x=value). Default 'horizontal'. */\n\torientation?: \"horizontal\" | \"vertical\";\n\t/** Numeric y-value for horizontal line or Date/number x-value for vertical line. */\n\tvalue: number | Date;\n\t/** Optional text label rendered near the end of the line. */\n\tlabel?: string;\n\t/** Semantic status influences default colour. */\n\tstatus?: AlertStatus;\n\t/** Explicit stroke colour to override status default. */\n\tcolor?: string;\n\t/** Dashed line style (default true). */\n\tdashed?: boolean;\n\t/** Stroke width (px). Default 2. */\n\tstrokeWidth?: number;\n}\n\nconst statusColor = (s: AlertStatus | undefined): string => {\n\tswitch (s) {\n\t\tcase \"critical\":\n\t\t\treturn \"var(--nhs-fdp-color-critical,#d5281b)\";\n\t\tcase \"warning\":\n\t\t\treturn \"var(--nhs-fdp-color-warning,#ff7f0e)\";\n\t\tcase \"info\":\n\t\t\treturn \"var(--nhs-fdp-color-info,#1d70b8)\";\n\t\tcase \"ok\":\n\t\t\treturn \"var(--nhs-fdp-color-success,#007f3b)\";\n\t\tdefault:\n\t\t\treturn \"var(--nhs-fdp-color-warning,#ff7f0e)\";\n\t}\n};\n\n/** Draws a threshold line across the plot area using current scales. */\nexport const AlertThreshold: React.FC<AlertThresholdProps> = ({\n\torientation = \"horizontal\",\n\tvalue,\n\tlabel,\n\tstatus,\n\tcolor,\n\tdashed = true,\n\tstrokeWidth = 2,\n}) => {\n\tconst chart = useChartContext();\n\tconst scales = useScaleContext();\n\tif (!chart || !scales) return null;\n\tconst { innerWidth, innerHeight } = chart;\n\tconst stroke = color || statusColor(status);\n\n\tif (orientation === \"horizontal\") {\n\t\tconst y = scales.yScale(value);\n\t\tif (Number.isNaN(y)) return null;\n\t\treturn (\n\t\t\t<g className=\"fdp-annot-threshold fdp-annot-threshold--h\" aria-hidden>\n\t\t\t\t<line\n\t\t\t\t\tx1={0}\n\t\t\t\t\ty1={y}\n\t\t\t\t\tx2={innerWidth}\n\t\t\t\t\ty2={y}\n\t\t\t\t\tstroke={stroke}\n\t\t\t\t\tstrokeWidth={strokeWidth}\n\t\t\t\t\tstrokeDasharray={dashed ? \"6,6\" : undefined}\n\t\t\t\t/>\n\t\t\t\t{label && (\n\t\t\t\t\t<text\n\t\t\t\t\t\tx={innerWidth - 4}\n\t\t\t\t\t\ty={y - 4}\n\t\t\t\t\t\ttextAnchor=\"end\"\n\t\t\t\t\t\tfontSize={12}\n\t\t\t\t\t\tfill={stroke}\n\t\t\t\t\t>\n\t\t\t\t\t\t{label}\n\t\t\t\t\t</text>\n\t\t\t\t)}\n\t\t\t</g>\n\t\t);\n\t}\n\tconst x = scales.xScale(\n\t\tvalue instanceof Date ? value : new Date(value as any)\n\t);\n\tif (Number.isNaN(x)) return null;\n\treturn (\n\t\t<g className=\"fdp-annot-threshold fdp-annot-threshold--v\" aria-hidden>\n\t\t\t<line\n\t\t\t\tx1={x}\n\t\t\t\ty1={0}\n\t\t\t\tx2={x}\n\t\t\t\ty2={innerHeight}\n\t\t\t\tstroke={stroke}\n\t\t\t\tstrokeWidth={strokeWidth}\n\t\t\t\tstrokeDasharray={dashed ? \"6,6\" : undefined}\n\t\t\t/>\n\t\t\t{label && (\n\t\t\t\t<text x={x + 4} y={12} fontSize={12} fill={stroke}>\n\t\t\t\t\t{label}\n\t\t\t\t</text>\n\t\t\t)}\n\t\t</g>\n\t);\n};\n\nexport default AlertThreshold;\n", "import * as React from \"react\";\nimport { useChartContext } from \"../core/ChartRoot\";\nimport { useScaleContext } from \"../core/ScaleContext\";\nimport type { AlertStatus } from \"./AlertThreshold\";\n\nexport interface AlertBandProps {\n\torientation?: \"horizontal\" | \"vertical\";\n\tfrom: number | Date;\n\tto: number | Date;\n\tstatus?: AlertStatus;\n\tfill?: string;\n\topacity?: number; // default 0.12\n\t/** Optional rounded corners radius */\n\trx?: number;\n}\n\nconst statusFill = (s: AlertStatus | undefined): string => {\n\tswitch (s) {\n\t\tcase \"critical\":\n\t\t\treturn \"var(--nhs-fdp-color-critical,#d5281b)\";\n\t\tcase \"warning\":\n\t\t\treturn \"var(--nhs-fdp-color-warning,#ff7f0e)\";\n\t\tcase \"info\":\n\t\t\treturn \"var(--nhs-fdp-color-info,#1d70b8)\";\n\t\tcase \"ok\":\n\t\t\treturn \"var(--nhs-fdp-color-success,#007f3b)\";\n\t\tdefault:\n\t\t\treturn \"var(--nhs-fdp-color-warning,#ff7f0e)\";\n\t}\n};\n\n/** Shaded band across a value range (y or x). Renders inside plot <g>. */\nexport const AlertBand: React.FC<AlertBandProps> = ({\n\torientation = \"horizontal\",\n\tfrom,\n\tto,\n\tstatus,\n\tfill,\n\topacity = 0.12,\n\trx = 0,\n}) => {\n\tconst chart = useChartContext();\n\tconst scales = useScaleContext();\n\tif (!chart || !scales) return null;\n\tconst { innerWidth, innerHeight } = chart;\n\tconst color = fill || statusFill(status);\n\tif (orientation === \"horizontal\") {\n\t\tconst y1 = scales.yScale(from);\n\t\tconst y2 = scales.yScale(to);\n\t\tif ([y1, y2].some((v) => Number.isNaN(v))) return null;\n\t\tconst y = Math.min(y1, y2);\n\t\tconst h = Math.abs(y2 - y1);\n\t\treturn (\n\t\t\t<rect\n\t\t\t\tx={0}\n\t\t\t\ty={y}\n\t\t\t\twidth={innerWidth}\n\t\t\t\theight={h}\n\t\t\t\tfill={color}\n\t\t\t\topacity={opacity}\n\t\t\t\trx={rx}\n\t\t\t/>\n\t\t);\n\t}\n\tconst x1 = scales.xScale(from instanceof Date ? from : new Date(from as any));\n\tconst x2 = scales.xScale(to instanceof Date ? to : new Date(to as any));\n\tif ([x1, x2].some((v) => Number.isNaN(v))) return null;\n\tconst x = Math.min(x1, x2);\n\tconst w = Math.abs(x2 - x1);\n\treturn (\n\t\t<rect\n\t\t\tx={x}\n\t\t\ty={0}\n\t\t\twidth={w}\n\t\t\theight={innerHeight}\n\t\t\tfill={color}\n\t\t\topacity={opacity}\n\t\t\trx={rx}\n\t\t/>\n\t);\n};\n\nexport default AlertBand;\n", "import * as React from \"react\";\nimport { useChartContext } from \"../core/ChartRoot\";\nimport { useScaleContext } from \"../core/ScaleContext\";\nimport type { AlertStatus } from \"./AlertThreshold\";\n\nexport interface AlertMarkerPoint {\n\tx: Date | number | string;\n\ty?: number; // optional; if omitted, markers rendered near top\n\tstatus?: AlertStatus;\n\tlabel?: string;\n}\n\nexport interface AlertMarkersProps {\n\tpoints: AlertMarkerPoint[];\n\tshape?: \"triangle\" | \"diamond\" | \"dot\";\n\tsize?: number; // visual size (radius or half-width). Default 5\n}\n\nconst statusColor = (s: AlertStatus | undefined): string => {\n\tswitch (s) {\n\t\tcase \"critical\":\n\t\t\treturn \"var(--nhs-fdp-color-critical,#d5281b)\";\n\t\tcase \"warning\":\n\t\t\treturn \"var(--nhs-fdp-color-warning,#ff7f0e)\";\n\t\tcase \"info\":\n\t\t\treturn \"var(--nhs-fdp-color-info,#1d70b8)\";\n\t\tcase \"ok\":\n\t\t\treturn \"var(--nhs-fdp-color-success,#007f3b)\";\n\t\tdefault:\n\t\t\treturn \"var(--nhs-fdp-color-warning,#ff7f0e)\";\n\t}\n};\n\nfunction Triangle({\n\tcx,\n\tcy,\n\tsize,\n\tfill,\n}: {\n\tcx: number;\n\tcy: number;\n\tsize: number;\n\tfill: string;\n}) {\n\tconst h = size * 1.2;\n\tconst points = `${cx},${cy - h} ${cx - size},${cy + h * 0.6} ${cx + size},${cy + h * 0.6}`;\n\treturn (\n\t\t<polygon points={points} fill={fill} stroke=\"#fff\" strokeWidth={0.5} />\n\t);\n}\n\nfunction Diamond({\n\tcx,\n\tcy,\n\tsize,\n\tfill,\n}: {\n\tcx: number;\n\tcy: number;\n\tsize: number;\n\tfill: string;\n}) {\n\tconst points = `${cx},${cy - size} ${cx - size},${cy} ${cx},${cy + size} ${cx + size},${cy}`;\n\treturn (\n\t\t<polygon points={points} fill={fill} stroke=\"#fff\" strokeWidth={0.5} />\n\t);\n}\n\n/** Paints alert markers at specified points using the current scales. */\nexport const AlertMarkers: React.FC<AlertMarkersProps> = ({\n\tpoints,\n\tshape = \"triangle\",\n\tsize = 5,\n}) => {\n\tconst chart = useChartContext();\n\tconst scales = useScaleContext();\n\tif (!chart || !scales || !points.length) return null;\n\t// Note: innerHeight available on chart, not currently used here\n\tconst mapX = (x: any) => (x instanceof Date ? x : new Date(x));\n\treturn (\n\t\t<g className=\"fdp-annot-markers\" aria-hidden>\n\t\t\t{points.map((p, i) => {\n\t\t\t\tconst cx = scales.xScale(mapX(p.x));\n\t\t\t\tconst cy = p.y === undefined ? Math.max(10, 10) : scales.yScale(p.y);\n\t\t\t\tconst fill = statusColor(p.status);\n\t\t\t\tconst key = `am-${i}`;\n\t\t\t\tif (Number.isNaN(cx) || Number.isNaN(cy)) return null;\n\t\t\t\treturn (\n\t\t\t\t\t<g key={key}>\n\t\t\t\t\t\t{shape === \"triangle\" ? (\n\t\t\t\t\t\t\t<Triangle cx={cx} cy={cy} size={size} fill={fill} />\n\t\t\t\t\t\t) : shape === \"diamond\" ? (\n\t\t\t\t\t\t\t<Diamond cx={cx} cy={cy} size={size} fill={fill} />\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<circle\n\t\t\t\t\t\t\t\tcx={cx}\n\t\t\t\t\t\t\t\tcy={cy}\n\t\t\t\t\t\t\t\tr={size}\n\t\t\t\t\t\t\t\tfill={fill}\n\t\t\t\t\t\t\t\tstroke=\"#fff\"\n\t\t\t\t\t\t\t\tstrokeWidth={0.5}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{p.label && (\n\t\t\t\t\t\t\t<text\n\t\t\t\t\t\t\t\tx={cx + size + 2}\n\t\t\t\t\t\t\t\ty={cy - size - 2}\n\t\t\t\t\t\t\t\tfontSize={11}\n\t\t\t\t\t\t\t\tfill={fill}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{p.label}\n\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</g>\n\t\t\t\t);\n\t\t\t})}\n\t\t</g>\n\t);\n};\n\nexport default AlertMarkers;\n", "import * as React from 'react';\nimport clsx from 'clsx';\nimport '../../DataVisualisation.scss';\nimport { default as Table } from '../../../Tables/Table';\nimport type { TableProps } from '../../../Tables/Table.types';\n\nexport interface ChartNoScriptProps {\n  /** Accessible title for the chart (mirrors ChartContainer usage) */\n  title: string;\n  /** Short description or summary of what the chart shows */\n  description?: string;\n  /** Source string (optional) */\n  source?: string;\n  /** Data table fallback props (passed to internal Table component). Provide at least rows + head OR caption. */\n  table: TableProps;\n  /** Optional className for outer wrapper */\n  className?: string;\n  /** Optional id to stabilise aria attributes */\n  id?: string;\n  /** Message shown above table when scripting disabled / prior to hydration */\n  message?: string;\n  /** If true, always show fallback (useful for forcing SSR mode in tests) */\n  forceFallback?: boolean;\n}\n\n/**\n * ChartNoScript provides an SSR-friendly static fallback for chart content.\n * It renders a figure with a table (data) wrapped in a <noscript> block for browsers\n * with JavaScript disabled. During hydration it can also reveal a progressive\n * enhancement message until the real interactive chart mounts.\n * Usage notes:\n * - Pass structured data via `table` (TableProps). For responsive stacking, set `responsive: true`.\n * - For panel styling, include `panel: true` and optional `panelClasses` inside `table` prop.\n * - After your interactive chart hydrates, add the class `.fdp-chart--enhanced` to the wrapping figure\n *   (or an ancestor) to hide the static fallback table (`[data-fallback-table]`).\n */\nexport const ChartNoScript: React.FC<ChartNoScriptProps> = ({\n  title,\n  description,\n  source,\n  table,\n  className,\n  id,\n  message = 'Interactive chart loading\u2026',\n  forceFallback = false\n}) => {\n  const figureId = React.useId();\n  const resolvedId = id || figureId;\n  const descId = description ? `${resolvedId}-desc` : undefined;\n  const sourceId = source ? `${resolvedId}-src` : undefined;\n\n  // We rely on absence of window during SSR. forceFallback allows tests to simulate.\n  const isHydrated = typeof window !== 'undefined' && !forceFallback;\n\n  return (\n    <figure\n      id={resolvedId}\n      className={clsx('fdp-chart fdp-chart--noscript', className)}\n      aria-labelledby={`${resolvedId}-title`}\n      aria-describedby={clsx(descId, sourceId)}\n      data-component=\"ChartNoScript\"\n    >\n      <header className=\"fdp-chart__header\">\n        <h3 id={`${resolvedId}-title`} className=\"fdp-chart__title\">{title}</h3>\n      </header>\n      {description && (\n        <p id={descId} className=\"fdp-chart__description\">{description}</p>\n      )}\n      {/* Progressive enhancement message (hidden after hydration handled by caller) */}\n      {!isHydrated && (\n        <div className=\"fdp-chart__loading\" role=\"status\" aria-live=\"polite\">{message}</div>\n      )}\n      <div className=\"fdp-chart__fallback\" role=\"group\" aria-label={title}>\n        {/* noscript ensures content visible with JS disabled */}\n        <noscript>\n          <div className=\"fdp-chart__noscript-wrapper\">\n            <Table {...table} />\n          </div>\n        </noscript>\n        {/* Also render table immediately for SSR for SEO / immediate access; hide via CSS when interactive chart replaces */}\n        <div className=\"fdp-chart__table\" data-fallback-table>\n          <Table {...table} />\n        </div>\n      </div>\n      {(source) && (\n        <figcaption className=\"fdp-chart__caption\">\n          {source && (\n            <small id={sourceId} className=\"fdp-chart__source\">Source: {source}</small>\n          )}\n        </figcaption>\n      )}\n    </figure>\n  );\n};\n\nexport default ChartNoScript;\n", "import * as React from 'react';\n\nexport interface ChartEnhancerProps {\n  /**\n   * CSS selector used to locate the chart figure(s) to enhance.\n   * Defaults to 'figure.fdp-chart'. All matches receive the class 'fdp-chart--enhanced'.\n   */\n  selector?: string;\n  /** Optional callback fired after enhancement completes (provides enhanced elements) */\n  onEnhanced?: (elements: HTMLElement[]) => void;\n  /** Optional delay (ms) before applying enhancement (useful for Storybook demos) */\n  delay?: number;\n  /** Children containing one or more chart figures */\n  children: React.ReactNode;\n}\n\n/**\n * ChartEnhancer automatically applies the `.fdp-chart--enhanced` class to any chart figure(s)\n * once the client has hydrated. This hides the static fallback table rendered by `ChartNoScript`\n * while preserving the `<noscript>` content for non\u2011JS scenarios.\n *\n * Example:\n * ```tsx\n * <ChartEnhancer>\n *   <ChartNoScript title=\"KPI\" table={tableProps} />\n *   // Interactive chart mounts here\n * </ChartEnhancer>\n * ```\n */\nconst ChartEnhancer: React.FC<ChartEnhancerProps> = ({ selector = 'figure.fdp-chart', onEnhanced, delay = 0, children }) => {\n  const ref = React.useRef<HTMLDivElement | null>(null);\n\n  React.useEffect(() => {\n    const root = ref.current;\n    if (!root) return;\n    const apply = () => {\n      const figures = Array.from(root.querySelectorAll<HTMLElement>(selector));\n      if (figures.length === 0) return;\n      const newlyEnhanced: HTMLElement[] = [];\n      figures.forEach(fig => {\n        if (!fig.classList.contains('fdp-chart--enhanced')) {\n          fig.classList.add('fdp-chart--enhanced');\n          newlyEnhanced.push(fig);\n        }\n      });\n      if (newlyEnhanced.length && onEnhanced) onEnhanced(newlyEnhanced);\n    };\n    if (delay > 0) {\n      // Guard setTimeout in non-browser environments (no-op on server)\n      if (typeof window === 'undefined') return;\n      const t = window.setTimeout(apply, delay);\n      return () => window.clearTimeout(t);\n    }\n    apply();\n  }, [selector, onEnhanced, delay]);\n\n  return <div ref={ref}>{children}</div>;\n};\n\nexport default ChartEnhancer;\n", "import * as React from \"react\";\nimport clsx from \"clsx\";\nimport \"../../DataVisualisation.scss\";\nimport \"./MetricCard.scss\";\n\nexport type MetricStatus = \"positive\" | \"negative\" | \"warning\" | \"neutral\";\nexport type MetricVariant =\n\t| \"default\"\n\t| \"primary\"\n\t| \"secondary\"\n\t| \"accent\"\n\t| \"success\"\n\t| \"warning\"\n\t| \"error\";\n\nexport interface MetricDelta {\n\t/** Numeric change (positive, negative or zero). Sign used if direction not supplied. */\n\tvalue: number;\n\t/** Override auto direction (derived from value sign when omitted). */\n\tdirection?: \"up\" | \"down\" | \"neutral\";\n\t/** Optional accessible label (e.g. \"+12% compared to last week\"). Auto\u2011generated if omitted. */\n\tariaLabel?: string;\n\t/** If true, invert meaning (e.g. lower is better) for auto aria text wording. */\n\tinvert?: boolean;\n\t/** Treat value as percentage and append % sign in visual text (ariaLabel can still override). */\n\tisPercent?: boolean;\n\t/** Additional context text for the delta (e.g. \"this month\", \"this year\") */\n\tperiod?: string;\n}\n\nexport interface MetricCardProps {\n\t/** Primary textual label (short) */\n\tlabel: string;\n\t/** Value to display (string or number). When number, valueFormatter can adjust. */\n\tvalue: string | number;\n\t/** Unit displayed inline after value (e.g. % or ms) */\n\tunit?: string;\n\t/** Optional delta / change indicator */\n\tdelta?: MetricDelta;\n\t/** Visual status accent (maps to border / colour modifiers) */\n\tstatus?: MetricStatus;\n\t/** Visual variant (maps to DataViz color palette) */\n\tvariant?: MetricVariant;\n\t/** Optional subtitle/description text */\n\tsubtitle?: string;\n\t/** Optional metadata (e.g. \"Latest period: Aug 2025\") */\n\tmetadata?: string;\n\t/** Optional little trend sparkline values (reserved \u2013 visualisation to follow) */\n\ttrendData?: number[];\n\t/** Show skeleton / placeholder instead of value */\n\tloading?: boolean;\n\t/** Error message overrides normal value layout */\n\terror?: string;\n\t/** Format numeric value (before unit). Default: locale string */\n\tvalueFormatter?: (n: number) => string;\n\t/** Custom class name */\n\tclassName?: string;\n\t/** Stable id (auto generated if omitted) */\n\tid?: string;\n\t/** Announce delta changes in live region (polite) */\n\tannounceDelta?: boolean;\n}\n\n/**\n * MetricCard presents a headline KPI value with optional delta (change) and severity/status accent.\n * Features modern DataViz-inspired styling with left border accents and subtle gradients.\n * Accessibility:\n * - Wrapper uses role=\"group\" with aria-labelledby referencing the label.\n * - Delta includes an aria-label conveying direction & magnitude; a live region announces updates.\n * - Colour alone isn't relied on: arrow + sign (+/\u2212) supplied; neutral shows a dash.\n * Future:\n * - `trendData` will enable a miniature sparkline beneath or beside the value.\n */\nexport const MetricCard: React.FC<MetricCardProps> = ({\n\tlabel,\n\tvalue,\n\tunit,\n\tdelta,\n\tstatus = \"neutral\",\n\tvariant = \"default\",\n\tsubtitle,\n\tmetadata,\n\ttrendData,\n\tloading = false,\n\terror,\n\tvalueFormatter,\n\tclassName,\n\tid,\n\tannounceDelta = true,\n}) => {\n\tconst internalId = React.useId();\n\tconst baseId = id || internalId;\n\tconst labelId = `${baseId}-label`;\n\tconst valueId = `${baseId}-value`;\n\tconst deltaId = `${baseId}-delta`;\n\n\tconst isNumber = typeof value === \"number\" && !Number.isNaN(value);\n\tconst formattedValue = loading\n\t\t? \"\u2014\"\n\t\t: error\n\t\t\t? \"\"\n\t\t\t: isNumber\n\t\t\t\t? valueFormatter\n\t\t\t\t\t? valueFormatter(value as number)\n\t\t\t\t\t: (value as number).toLocaleString()\n\t\t\t\t: value;\n\n\tlet deltaDirection: \"up\" | \"down\" | \"neutral\" | undefined;\n\tlet visualDelta = \"\";\n\tlet deltaAria = \"\";\n\tif (delta && !loading && !error) {\n\t\tdeltaDirection =\n\t\t\tdelta.direction ||\n\t\t\t(delta.value > 0 ? \"up\" : delta.value < 0 ? \"down\" : \"neutral\");\n\t\tconst absVal = Math.abs(delta.value);\n\t\tconst signedDisplay =\n\t\t\tdeltaDirection === \"up\"\n\t\t\t\t? `+${absVal}`\n\t\t\t\t: deltaDirection === \"down\"\n\t\t\t\t\t? `-${absVal}`\n\t\t\t\t\t: \"0\";\n\t\tconst suffix = delta.isPercent ? \"%\" : \"\";\n\t\t// Plain representation (no arrow emojis) per design refinement\n\t\tvisualDelta = `${signedDisplay}${suffix}`;\n\t\tif (delta.ariaLabel) {\n\t\t\tdeltaAria = delta.ariaLabel;\n\t\t} else {\n\t\t\tconst better = delta.invert\n\t\t\t\t? deltaDirection === \"down\"\n\t\t\t\t: deltaDirection === \"up\";\n\t\t\tconst dirWord =\n\t\t\t\tdeltaDirection === \"neutral\"\n\t\t\t\t\t? \"no change\"\n\t\t\t\t\t: deltaDirection === \"up\"\n\t\t\t\t\t\t? \"up\"\n\t\t\t\t\t\t: \"down\";\n\t\t\tdeltaAria = `${dirWord} ${absVal}${suffix}${deltaDirection === \"neutral\" ? \"\" : better ? \" (improvement)\" : \" (worse)\"}`;\n\t\t}\n\t}\n\n\treturn (\n\t\t<div\n\t\t\tclassName={clsx(\n\t\t\t\t\"fdp-metric-card\",\n\t\t\t\tvariant && `fdp-metric-card--${variant}`,\n\t\t\t\tstatus && `fdp-metric-card--status-${status}`,\n\t\t\t\tloading && \"fdp-metric-card--loading\",\n\t\t\t\terror && \"fdp-metric-card--error\",\n\t\t\t\tclassName\n\t\t\t)}\n\t\t\trole=\"group\"\n\t\t\taria-labelledby={labelId}\n\t\t\tdata-component=\"MetricCard\"\n\t\t>\n\t\t\t<div className=\"fdp-metric-card__inner\">\n\t\t\t\t<div className=\"fdp-metric-card__header\">\n\t\t\t\t\t<h3 id={labelId} className=\"fdp-metric-card__label\">\n\t\t\t\t\t\t{label}\n\t\t\t\t\t</h3>\n\t\t\t\t\t{metadata && (\n\t\t\t\t\t\t<div className=\"fdp-metric-card__metadata\">{metadata}</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"fdp-metric-card__content\">\n\t\t\t\t\t<div className=\"fdp-metric-card__value-section\">\n\t\t\t\t\t\t<div id={valueId} className=\"fdp-metric-card__value\">\n\t\t\t\t\t\t\t{loading ? (\n\t\t\t\t\t\t\t\t<div className=\"fdp-metric-card__skeleton\" aria-hidden=\"true\">\n\t\t\t\t\t\t\t\t\t<div className=\"fdp-metric-card__skeleton-line fdp-metric-card__skeleton-line--value\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : error ? (\n\t\t\t\t\t\t\t\t<div className=\"fdp-metric-card__error\" role=\"alert\">\n\t\t\t\t\t\t\t\t\t{error}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<span className=\"fdp-metric-card__number\">\n\t\t\t\t\t\t\t\t\t\t{formattedValue}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t{unit && (\n\t\t\t\t\t\t\t\t\t\t<span className=\"fdp-metric-card__unit\">{unit}</span>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{subtitle && !loading && !error && (\n\t\t\t\t\t\t\t<div className=\"fdp-metric-card__subtitle\">{subtitle}</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{delta && !loading && !error && (\n\t\t\t\t\t\t<div className=\"fdp-metric-card__delta-section\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tid={deltaId}\n\t\t\t\t\t\t\t\taria-label={deltaAria}\n\t\t\t\t\t\t\t\tclassName={clsx(\n\t\t\t\t\t\t\t\t\t\"fdp-metric-card__delta\",\n\t\t\t\t\t\t\t\t\tdeltaDirection && `fdp-metric-card__delta--${deltaDirection}`\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span className=\"fdp-metric-card__delta-value\">\n\t\t\t\t\t\t\t\t\t{visualDelta}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t{delta.period && (\n\t\t\t\t\t\t\t\t\t<span className=\"fdp-metric-card__delta-period\">\n\t\t\t\t\t\t\t\t\t\t{delta.period}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{trendData && trendData.length > 0 && !loading && !error && (\n\t\t\t\t\t\t<div className=\"fdp-metric-card__trend\" aria-hidden=\"true\">\n\t\t\t\t\t\t\t{/* Future: mini sparkline visualization */}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t\t{announceDelta && delta && !delta.ariaLabel && !loading && !error && (\n\t\t\t\t\t<div className=\"fdp-visually-hidden\" aria-live=\"polite\">\n\t\t\t\t\t\t{deltaAria}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default MetricCard;\n", "import * as React from \"react\";\nimport {\n\tRow,\n\tColumn,\n\tHeading,\n\tRadios,\n\tButton,\n\tPanel,\n\tInsetText,\n\tCheckboxes,\n\tGridWidth,\n\tColumnAlign,\n\tButtonVariant,\n} from \"../../../components\";\nimport WizardProgress from \"./WizardProgress\";\nimport ReviewAnswers from \"./ReviewAnswers\";\nimport {\n\tevaluateSingleChoice,\n\tevaluateYesNo,\n\tevaluateMultiChoice,\n\tgetNode as getTypedNode,\n\tgetWizard as getTypedWizard,\n} from \"../logic/wizardEngine\";\nimport type { LogicFile } from \"../logic/wizardTypes\";\n\ntype WizardLogic = LogicFile | any;\n\nexport interface DataVizWizardProps {\n\tlogic: WizardLogic;\n\twizardId?: string; // default 'nhs_v1'\n\tstorageKey?: string; // localStorage key for persistence\n}\n\ntype Node = any;\n\nfunction getWizardRoot(logic: WizardLogic, wizardId: string) {\n\t// Prefer typed helpers when available\n\ttry {\n\t\treturn getTypedWizard(logic as any, wizardId);\n\t} catch {\n\t\treturn (logic as any).wizards[wizardId];\n\t}\n}\n\nfunction getNode(logic: WizardLogic, wizardId: string, nodeId: string): Node {\n\ttry {\n\t\treturn getTypedNode(getWizardRoot(logic, wizardId) as any, nodeId) as any;\n\t} catch {\n\t\treturn (logic as any).wizards[wizardId].nodes[nodeId];\n\t}\n}\n\nfunction isClient() {\n\treturn typeof window !== \"undefined\";\n}\n\nexport const DataVizWizard: React.FC<DataVizWizardProps> = ({\n\tlogic,\n\twizardId = \"nhs_v1\",\n\tstorageKey = \"dv_wizard_state_v1\",\n}) => {\n\tconst wiz = getWizardRoot(logic, wizardId);\n\tconst rootId: string = wiz.root;\n\ttype Answer = {\n\t\tnodeId: string;\n\t\tquestion?: string;\n\t\tvalue: string | string[];\n\t\trecommend?: string[];\n\t};\n\tconst [path, setPath] = React.useState<string[]>([rootId]);\n\tconst [answers, setAnswers] = React.useState<Answer[]>([]);\n\tconst [result, setResult] = React.useState<string[] | null>(null);\n\tconst [selectedValue, setSelectedValue] = React.useState<string>(\"\");\n\tconst [selectedValues, setSelectedValues] = React.useState<string[]>([]);\n\n\tReact.useEffect(() => {\n\t\tif (!isClient()) return;\n\t\ttry {\n\t\t\tconst raw = window.localStorage.getItem(storageKey);\n\t\t\tif (raw) {\n\t\t\t\tconst parsed = JSON.parse(raw);\n\t\t\t\tif (Array.isArray(parsed.path) && Array.isArray(parsed.answers)) {\n\t\t\t\t\tsetPath(parsed.path);\n\t\t\t\t\tsetAnswers(parsed.answers);\n\t\t\t\t\tsetResult(parsed.result ?? null);\n\t\t\t\t}\n\t\t\t}\n\t\t} catch {}\n\t}, [storageKey]);\n\n\tReact.useEffect(() => {\n\t\tif (!isClient()) return;\n\t\twindow.localStorage.setItem(\n\t\t\tstorageKey,\n\t\t\tJSON.stringify({ path, answers, result })\n\t\t);\n\t}, [path, answers, result, storageKey]);\n\n\tconst currentId = path[path.length - 1];\n\tconst node = getNode(logic, wizardId, currentId);\n\t// no-op\n\n\t// Prefill/reset selection when node changes using any prior answer recorded\n\tReact.useEffect(() => {\n\t\tconst prev = answers.find((a) => a.nodeId === currentId);\n\t\tif (prev) {\n\t\t\tif (Array.isArray(prev.value)) {\n\t\t\t\tsetSelectedValues(prev.value);\n\t\t\t\tsetSelectedValue(\"\");\n\t\t\t} else {\n\t\t\t\tsetSelectedValue(prev.value);\n\t\t\t\tsetSelectedValues([]);\n\t\t\t}\n\t\t} else {\n\t\t\tsetSelectedValue(\"\");\n\t\t\tsetSelectedValues([]);\n\t\t}\n\t}, [currentId]);\n\n\t// Browser history: seed initial state and listen for back/forward\n\tReact.useEffect(() => {\n\t\tif (!isClient()) return;\n\t\tconst state = { path, answers, result };\n\t\ttry {\n\t\t\twindow.history.replaceState(state, \"\");\n\t\t} catch {}\n\t\tconst onPop = (e: PopStateEvent) => {\n\t\t\tconst st = (e.state || {}) as any;\n\t\t\tif (st && Array.isArray(st.path) && Array.isArray(st.answers)) {\n\t\t\t\tsetPath(st.path);\n\t\t\t\tsetAnswers(st.answers);\n\t\t\t\tsetResult(st.result ?? null);\n\t\t\t}\n\t\t};\n\t\twindow.addEventListener(\"popstate\", onPop);\n\t\treturn () => window.removeEventListener(\"popstate\", onPop);\n\t}, []);\n\n\t// Contextual guidance for data shape page based on selected component\n\tconst shapeContextHelp = React.useMemo(() => {\n\t\tif (currentId !== \"components_shape\") return null;\n\t\tconst prevVal = answers.find((a) => a.nodeId === \"components_root\")\n\t\t\t?.value as any;\n\t\tconst prevComponent: string | null = Array.isArray(prevVal)\n\t\t\t? prevVal[0] || null\n\t\t\t: prevVal || null;\n\t\tif (!prevComponent) return null;\n\t\tconst labelBase = prevComponent\n\t\t\t.replace(/\\s*\\(.*\\)$/, \"\")\n\t\t\t.trim()\n\t\t\t.toLowerCase();\n\t\tconst comps = (logic as any)?.models?.abela?.components as\n\t\t\t| any[]\n\t\t\t| undefined;\n\t\tif (!Array.isArray(comps)) return null;\n\t\tlet comp = comps.find(\n\t\t\t(c) =>\n\t\t\t\t(c.label || \"\")\n\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t.replace(/\\s*\\(.*\\)$/, \"\")\n\t\t\t\t\t.trim() === labelBase\n\t\t);\n\t\tif (!comp && labelBase.includes(\"resources\")) {\n\t\t\tcomp = comps.find((c) => c.id === \"resources\");\n\t\t}\n\t\tif (!comp) return null;\n\t\tconst shapeNames: Record<string, string> = {\n\t\t\ttime_series: \"Time series\",\n\t\t\tcategories: \"Categories\",\n\t\t\thierarchy: \"Hierarchy\",\n\t\t\tmatrix: \"Matrix\",\n\t\t\tspatial: \"Spatial\",\n\t\t\tdistribution: \"Distribution\",\n\t\t};\n\t\tconst shapes: string[] = (comp.maps_to_data_shapes || [])\n\t\t\t.map((s: string) => shapeNames[s] || s)\n\t\t\t.filter(Boolean);\n\t\tif (shapes.length === 0 && !comp.notes) return null;\n\t\treturn (\n\t\t\t<InsetText>\n\t\t\t\t<div>\n\t\t\t\t\t<strong>{prevComponent}</strong>: common data shapes\n\t\t\t\t</div>\n\t\t\t\t{shapes.length > 0 && (\n\t\t\t\t\t<ul style={{ marginTop: 8 }}>\n\t\t\t\t\t\t{shapes.map((s) => (\n\t\t\t\t\t\t\t<li key={s}>{s}</li>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</ul>\n\t\t\t\t)}\n\t\t\t\t{comp.notes && <p style={{ marginTop: 8 }}>{comp.notes}</p>}\n\t\t\t</InsetText>\n\t\t);\n\t}, [answers, currentId, logic]);\n\n\tconst pushHistoryState = (\n\t\tnextPath: string[],\n\t\tnextAnswers: Answer[],\n\t\tnextResult: string[] | null\n\t) => {\n\t\tif (!isClient()) return;\n\t\tconst state = { path: nextPath, answers: nextAnswers, result: nextResult };\n\t\ttry {\n\t\t\twindow.history.pushState(state, \"\");\n\t\t} catch {}\n\t};\n\tconst goBack = () => {\n\t\t// If we're viewing a result (end state without explicit end node), clear it first\n\t\tif (result) {\n\t\t\tsetResult(null);\n\t\t\tsetAnswers((a) => (a.length > 0 ? a.slice(0, -1) : a));\n\t\t\treturn;\n\t\t}\n\t\tif (isClient()) {\n\t\t\twindow.history.back();\n\t\t} else {\n\t\t\tsetPath((p) => (p.length > 1 ? p.slice(0, -1) : p));\n\t\t\tsetAnswers((a) => (a.length > 0 ? a.slice(0, -1) : a));\n\t\t}\n\t};\n\tconst reset = () => {\n\t\tsetPath([rootId]);\n\t\tsetAnswers([]);\n\t\tsetResult(null);\n\t\tsetSelectedValue(\"\");\n\t\tsetSelectedValues([]);\n\t\tif (isClient()) {\n\t\t\tconst state = { path: [rootId], answers: [], result: null };\n\t\t\ttry {\n\t\t\t\twindow.history.pushState(state, \"\");\n\t\t\t} catch {}\n\t\t}\n\t};\n\n\t// legacy helper removed in favour of explicit Next handling\n\t// This is the summary chart view.\n\tconst renderEnd = (recommend: string[]) => (\n\t\t<>\n\t\t\t<Heading level={2}>Recommended charts</Heading>\n\t\t\t<Panel>\n\t\t\t\t<ul>\n\t\t\t\t\t{recommend.map((r) => (\n\t\t\t\t\t\t<li key={r}>\n\t\t\t\t\t\t\t<code>{r}</code>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t))}\n\t\t\t\t</ul>\n\t\t\t</Panel>\n\t\t\t<Heading level={3}>Your answers</Heading>\n\t\t\t<ReviewAnswers\n\t\t\t\titems={answers}\n\t\t\t\tonChange={(i) => {\n\t\t\t\t\t// Jump to a previous step to change an answer\n\t\t\t\t\tsetResult(null);\n\t\t\t\t\tsetPath((p) => p.slice(0, i + 1));\n\t\t\t\t\tsetAnswers((a) => a.slice(0, i));\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<Row>\n\t\t\t\t<Column width={GridWidth.OneHalf}>\n\t\t\t\t\t<Button onClick={goBack} variant=\"secondary\">\n\t\t\t\t\t\tBack\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button onClick={reset} style={{ marginLeft: \"1em\" }}>\n\t\t\t\t\t\tStart again\n\t\t\t\t\t</Button>\n\t\t\t\t</Column>\n\t\t\t</Row>\n\t\t</>\n\t);\n\n\tlet content: React.ReactNode = null;\n\t// If we have an explicit end node, show its recommendations\n\tif (node?.type === \"end\" && !result) {\n\t\tcontent = renderEnd((node as any).recommend || []);\n\t} else if (result) {\n\t\tcontent = renderEnd(result);\n\t} else if (!node) {\n\t\tcontent = <InsetText>Unknown node: {currentId}</InsetText>;\n\t} else if (node.type === \"single_choice\" || node.type === \"choice\") {\n\t\tconst options = node.choices as {\n\t\t\tlabel: string;\n\t\t\tnext?: string;\n\t\t\trecommend?: string[];\n\t\t}[];\n\t\tconst multiple =\n\t\t\tnode.type === \"choice\"\n\t\t\t\t? (node as any).mode === \"multiple\"\n\t\t\t\t: !!(node as any).multiple;\n\t\tcontent = (\n\t\t\t<Row>\n\t\t\t\t<Column width={GridWidth.OneHalf}>\n\t\t\t\t\t<Heading level={2}>\n\t\t\t\t\t\t{answers.length + 1}. {node.question}\n\t\t\t\t\t</Heading>\n\t\t\t\t\t{node.help && <InsetText>{node.help}</InsetText>}\n\t\t\t\t\t{shapeContextHelp}\n\t\t\t\t\t{multiple ? (\n\t\t\t\t\t\t<Checkboxes\n\t\t\t\t\t\t\tkey={currentId}\n\t\t\t\t\t\t\tname={currentId}\n\t\t\t\t\t\t\titems={\n\t\t\t\t\t\t\t\toptions.map((o) => ({ value: o.label, text: o.label })) as any\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tonChange={(vals: string[]) => setSelectedValues(vals)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<Radios\n\t\t\t\t\t\t\tkey={currentId}\n\t\t\t\t\t\t\tname={currentId}\n\t\t\t\t\t\t\toptions={options.map((o) => ({\n\t\t\t\t\t\t\t\tlabel: o.label,\n\t\t\t\t\t\t\t\tvalue: o.label,\n\t\t\t\t\t\t\t\ttext: o.label,\n\t\t\t\t\t\t\t}))}\n\t\t\t\t\t\t\tstyle={{ marginBottom: \"1.5em\" }}\n\t\t\t\t\t\t\tonChange={(event: React.ChangeEvent<HTMLInputElement>) =>\n\t\t\t\t\t\t\t\tsetSelectedValue(event.target.value)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Column width={GridWidth.OneHalf}>\n\t\t\t\t\t\t\t{path.length > 1 && (\n\t\t\t\t\t\t\t\t<Button onClick={goBack} variant=\"secondary\">\n\t\t\t\t\t\t\t\t\tBack\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Column>\n\t\t\t\t\t\t<Column width={GridWidth.OneHalf} align={ColumnAlign.Right}>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tif (multiple) {\n\t\t\t\t\t\t\t\t\t\tconst res = evaluateMultiChoice(node, selectedValues);\n\t\t\t\t\t\t\t\t\t\tconst nextAnswers = [\n\t\t\t\t\t\t\t\t\t\t\t...answers,\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tnodeId: currentId,\n\t\t\t\t\t\t\t\t\t\t\t\tquestion: node.question,\n\t\t\t\t\t\t\t\t\t\t\t\tvalue: selectedValues,\n\t\t\t\t\t\t\t\t\t\t\t\trecommend: res.recommend,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\t\t\tif (res.nextId) {\n\t\t\t\t\t\t\t\t\t\t\tconst nextPath = [...path, res.nextId];\n\t\t\t\t\t\t\t\t\t\t\tsetAnswers(nextAnswers);\n\t\t\t\t\t\t\t\t\t\t\tsetResult(null);\n\t\t\t\t\t\t\t\t\t\t\tsetPath(nextPath);\n\t\t\t\t\t\t\t\t\t\t\tpushHistoryState(nextPath, nextAnswers, null);\n\t\t\t\t\t\t\t\t\t\t} else if (res.recommend && res.recommend.length) {\n\t\t\t\t\t\t\t\t\t\t\tsetAnswers(nextAnswers);\n\t\t\t\t\t\t\t\t\t\t\tsetResult(res.recommend);\n\t\t\t\t\t\t\t\t\t\t\tpushHistoryState(path, nextAnswers, res.recommend);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tconst val = selectedValue;\n\t\t\t\t\t\t\t\t\t\tif (!val) return;\n\t\t\t\t\t\t\t\t\t\tconst res = evaluateSingleChoice(node, val);\n\t\t\t\t\t\t\t\t\t\tconst nextAnswers = [\n\t\t\t\t\t\t\t\t\t\t\t...answers,\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\tnodeId: currentId,\n\t\t\t\t\t\t\t\t\t\t\t\tquestion: node.question,\n\t\t\t\t\t\t\t\t\t\t\t\tvalue: val,\n\t\t\t\t\t\t\t\t\t\t\t\trecommend: res.recommend,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\t\t\tif (res.nextId) {\n\t\t\t\t\t\t\t\t\t\t\tconst nextPath = [...path, res.nextId];\n\t\t\t\t\t\t\t\t\t\t\tsetAnswers(nextAnswers);\n\t\t\t\t\t\t\t\t\t\t\tsetResult(null);\n\t\t\t\t\t\t\t\t\t\t\tsetPath(nextPath);\n\t\t\t\t\t\t\t\t\t\t\tpushHistoryState(nextPath, nextAnswers, null);\n\t\t\t\t\t\t\t\t\t\t} else if (res.recommend && res.recommend.length) {\n\t\t\t\t\t\t\t\t\t\t\tsetAnswers(nextAnswers);\n\t\t\t\t\t\t\t\t\t\t\tsetResult(res.recommend);\n\t\t\t\t\t\t\t\t\t\t\tpushHistoryState(path, nextAnswers, res.recommend);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tdisabled={\n\t\t\t\t\t\t\t\t\tmultiple ? selectedValues.length === 0 : !selectedValue\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tNext\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Column>\n\t\t\t\t\t</Row>\n\t\t\t\t</Column>\n\t\t\t\t<Column width={GridWidth.OneHalf}>\n\t\t\t\t\t<WizardProgress\n\t\t\t\t\t\titems={answers}\n\t\t\t\t\t\tonJumpTo={(i) => {\n\t\t\t\t\t\t\tsetPath((p) => p.slice(0, i + 1));\n\t\t\t\t\t\t\tsetAnswers((a) => a.slice(0, i));\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</Column>\n\t\t\t</Row>\n\t\t);\n\t} else if (node.type === \"yes_no\") {\n\t\tcontent = (\n\t\t\t<Row>\n\t\t\t\t<Column width={GridWidth.TwoThirds}>\n\t\t\t\t\t<Heading level={2}>{node.question}</Heading>\n\t\t\t\t\t<Radios\n\t\t\t\t\t\tkey={currentId}\n\t\t\t\t\t\tname={currentId}\n\t\t\t\t\t\toptions={[\n\t\t\t\t\t\t\t{ text: \"Yes\", value: \"Yes\" },\n\t\t\t\t\t\t\t{ text: \"No\", value: \"No\" },\n\t\t\t\t\t\t]}\n\t\t\t\t\t\tonChange={(event: React.ChangeEvent<HTMLInputElement>) =>\n\t\t\t\t\t\t\tsetSelectedValue(event.target.value)\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t\t<Row>\n\t\t\t\t\t\t<Column width={GridWidth.OneHalf}>\n\t\t\t\t\t\t\t<Button onClick={goBack} variant={ButtonVariant.Secondary}>\n\t\t\t\t\t\t\t\tBack\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Column>\n\t\t\t\t\t\t<Column width={GridWidth.OneHalf} align={ColumnAlign.Right}>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tconst val = selectedValue;\n\t\t\t\t\t\t\t\t\tif (!val) return;\n\t\t\t\t\t\t\t\t\tconst res = evaluateYesNo(\n\t\t\t\t\t\t\t\t\t\tnode,\n\t\t\t\t\t\t\t\t\t\tval.toLowerCase() === \"yes\" ? \"yes\" : \"no\"\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tconst nextAnswers = [\n\t\t\t\t\t\t\t\t\t\t...answers,\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tnodeId: currentId,\n\t\t\t\t\t\t\t\t\t\t\tquestion: node.question,\n\t\t\t\t\t\t\t\t\t\t\tvalue: val,\n\t\t\t\t\t\t\t\t\t\t\trecommend: res.recommend,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\t\tif (res.nextId) {\n\t\t\t\t\t\t\t\t\t\tconst nextPath = [...path, res.nextId];\n\t\t\t\t\t\t\t\t\t\tsetAnswers(nextAnswers);\n\t\t\t\t\t\t\t\t\t\tsetResult(null);\n\t\t\t\t\t\t\t\t\t\tsetPath(nextPath);\n\t\t\t\t\t\t\t\t\t\tpushHistoryState(nextPath, nextAnswers, null);\n\t\t\t\t\t\t\t\t\t} else if (res.recommend && res.recommend.length) {\n\t\t\t\t\t\t\t\t\t\tsetAnswers(nextAnswers);\n\t\t\t\t\t\t\t\t\t\tsetResult(res.recommend);\n\t\t\t\t\t\t\t\t\t\tpushHistoryState(path, nextAnswers, res.recommend);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tdisabled={!selectedValue}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tNext\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Column>\n\t\t\t\t\t</Row>\n\t\t\t\t</Column>\n\t\t\t\t<Column width={GridWidth.OneThird}>\n\t\t\t\t\t<WizardProgress\n\t\t\t\t\t\titems={answers}\n\t\t\t\t\t\tcurrentQuestion={node.question}\n\t\t\t\t\t\tonJumpTo={(i) => {\n\t\t\t\t\t\t\tsetPath((p) => p.slice(0, i + 1));\n\t\t\t\t\t\t\tsetAnswers((a) => a.slice(0, i));\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t</Column>\n\t\t\t</Row>\n\t\t);\n\t} else {\n\t\tcontent = <InsetText>Unsupported node type: {node.type}</InsetText>;\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t{/* <Heading level={1}>NHS Visualisation Selector</Heading> */}\n\t\t\t{content}\n\t\t</>\n\t);\n};\n\nexport default DataVizWizard;\n", "export interface TagInputProps {\n  color?: string;\n  noBorder?: boolean;\n  closable?: boolean;\n  disabled?: boolean;\n  className?: string;\n}\n\nexport interface NormalisedTagModel {\n  classes: string;\n  showClose: boolean;\n  disabled: boolean;\n}\n\nexport function mapTagProps(input: TagInputProps): NormalisedTagModel {\n  const { color = 'default', noBorder, closable, disabled, className } = input;\n  const classes = [\n    'nhsuk-tag',\n    color !== 'default' ? `nhsuk-tag--${color}` : '',\n    noBorder ? 'nhsuk-tag--no-border' : '',\n    closable ? 'nhsuk-tag--closable' : '',\n    disabled ? 'nhsuk-tag--disabled' : '',\n    className || ''\n  ].filter(Boolean).join(' ');\n  return { classes, showClose: !!closable, disabled: !!disabled };\n}\n", "import React from \"react\";\nimport \"./Tag.scss\";\nimport { TagProps } from \"./Tag.types\";\nimport { mapTagProps } from \"../../mapping/tag\";\n\nexport const Tag: React.FC<TagProps> = ({\n\ttext,\n\thtml,\n\tchildren,\n\tcolor = \"default\",\n\tnoBorder = false,\n\tclosable = false,\n\tonClose,\n\tdisabled = false,\n\tclassName,\n\t...props\n}) => {\n\tconst model = mapTagProps({ color, noBorder, closable, disabled, className });\n\n\tconst handleClose = (e: React.MouseEvent) => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tif (!disabled && onClose) {\n\t\t\tonClose();\n\t\t}\n\t};\n\n\treturn (\n\t\t<strong className={model.classes} {...props}>\n\t\t\t{/* Content - children take precedence, then html, then text */}\n\t\t\t{children ? (\n\t\t\t\tchildren\n\t\t\t) : html ? (\n\t\t\t\t<span dangerouslySetInnerHTML={{ __html: html }} />\n\t\t\t) : (\n\t\t\t\ttext\n\t\t\t)}\n\n\t\t\t{/* Close button */}\n\t\t\t{closable && (\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclassName=\"nhsuk-tag__close\"\n\t\t\t\t\tonClick={handleClose}\n\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\taria-label=\"Remove\"\n\t\t\t\t\ttitle=\"Remove\"\n\t\t\t\t>\n\t\t\t\t\t\u00D7\n\t\t\t\t</button>\n\t\t\t)}\n\t\t</strong>\n\t);\n};\n", "import React, { useState, ReactNode } from 'react';\nimport classNames from 'classnames';\nimport { CheckboxesProps, CheckboxConditionalProps } from './Checkboxes.types';\nimport { Input } from '../Input/Input';\nimport { Label } from '../Label/Label';\nimport { Fieldset } from '../Fieldset/Fieldset';\nimport './Checkboxes.scss';\nimport { mapCheckboxesProps } from '../../mapping/checkboxes';\n\n/**\n * NHS Checkboxes Component\n * \n * A checkboxes component that follows NHS design guidelines and uses the NHS design tokens.\n * Supports multiple selection, hints, error messages, conditional content, and small variant.\n * \n * @example\n * ```tsx\n * <Checkboxes\n *   name=\"nationality\"\n *   legend=\"What is your nationality?\"\n *   items={[\n *     { value: 'british', text: 'British' },\n *     { value: 'irish', text: 'Irish' },\n *     { value: 'other', text: 'Other' }\n *   ]}\n * />\n * ```\n */\nexport const Checkboxes: React.FC<CheckboxesProps> = ({\n  items,\n  name,\n  idPrefix,\n  legend,\n  isPageHeading = false,\n  legendSize = 'l',\n  hint,\n  errorMessage,\n  className = '',\n  small = false,\n  onChange,\n  fieldsetAttributes,\n  attributes,\n  ...props\n}) => {\n  const [selectedValues, setSelectedValues] = useState<string[]>(\n    items.filter(item => item.checked).map(item => item.value)\n  );\n\n  // Generate IDs\n  const finalIdPrefix = idPrefix || name;\n  const hintId = hint ? `${finalIdPrefix}-hint` : undefined;\n  const errorId = errorMessage ? `${finalIdPrefix}-error` : undefined;\n  const describedBy = [hintId, errorId].filter(Boolean).join(' ') || undefined;\n\n  const handleCheckboxChange = (value: string, checked: boolean) => {\n    let newValues: string[];\n    \n    if (checked) {\n      newValues = [...selectedValues, value];\n    } else {\n      newValues = selectedValues.filter(v => v !== value);\n    }\n    \n    setSelectedValues(newValues);\n    \n    onChange?.(newValues);\n  };\n\n  // Render each checkbox item with its conditional content (if any)\n  const renderItems = () => {\n    return items.map((item, index) => {\n      const itemId = `${finalIdPrefix}-${index + 1}`;\n      const conditionalId = `${itemId}-conditional`;\n      const isChecked = selectedValues.includes(item.value);\n      const isDisabled = item.disabled || false;\n\n      return (\n        <div key={item.value} className=\"nhsuk-checkboxes__item\">\n          <input\n            className=\"nhsuk-checkboxes__input\"\n            id={itemId}\n            name={name}\n            type=\"checkbox\"\n            value={item.value}\n            checked={isChecked}\n            disabled={isDisabled}\n            onChange={(e) => handleCheckboxChange(item.value, e.target.checked)}\n            aria-describedby={item.hint ? `${itemId}-hint` : describedBy}\n            {...(item.conditional && {\n              'aria-controls': conditionalId,\n              'aria-expanded': isChecked ? 'true' : 'false'\n            })}\n            {...item.attributes}\n          />\n          <label className=\"nhsuk-checkboxes__label\" htmlFor={itemId}>\n            {item.text}\n          </label>\n          {item.hint && (\n            <div id={`${itemId}-hint`} className=\"nhsuk-checkboxes__hint\">\n              {item.hint}\n            </div>\n          )}\n          {item.conditional && (\n            <div\n              className={classNames('nhsuk-checkboxes__conditional', {\n                'nhsuk-checkboxes__conditional--hidden': !isChecked,\n              })}\n              id={conditionalId}\n            >\n              {typeof item.conditional === 'object' && \n               item.conditional !== null && \n               'label' in item.conditional && \n               'id' in item.conditional && \n               'name' in item.conditional ? (\n                <div style={{ marginTop: '16px' }}>\n                  {(item.conditional as CheckboxConditionalProps).label && (\n                    <Label htmlFor={(item.conditional as CheckboxConditionalProps).id}>\n                      {(item.conditional as CheckboxConditionalProps).label}\n                    </Label>\n                  )}\n                  <Input {...(item.conditional as CheckboxConditionalProps)} />\n                </div>\n              ) : (\n                item.conditional as ReactNode\n              )}\n            </div>\n          )}\n        </div>\n      );\n    });\n  };\n\n  const { classes: checkboxesClasses, formGroupClasses } = mapCheckboxesProps({ small, className, hasError: !!errorMessage });\n\n  return (\n    <div className={formGroupClasses} {...attributes} {...props}>\n      <Fieldset\n        legend={legend ? {\n          text: legend,\n          isPageHeading,\n          size: legendSize\n        } : undefined}\n        describedBy={describedBy}\n        {...fieldsetAttributes}\n      >\n        {hint && (\n          <div id={hintId} className=\"nhsuk-hint\">\n            {hint}\n          </div>\n        )}\n        \n        {errorMessage && (\n          <div id={errorId} className=\"nhsuk-error-message\">\n            <span className=\"nhsuk-u-visually-hidden\">Error:</span> {errorMessage}\n          </div>\n        )}\n        \n        <div className={checkboxesClasses}>\n          {renderItems()}\n        </div>\n      </Fieldset>\n    </div>\n  );\n};\n\nCheckboxes.displayName = 'Checkboxes';\n\nexport default Checkboxes;\n", "import React, { useState, useEffect } from 'react';\nimport './Input.scss';\nimport { InputProps } from './Input.types';\nimport { mapInputProps } from '../../mapping/input';\n\nexport const Input: React.FC<InputProps> = ({\n  id,\n  name,\n  type = 'text',\n  value,\n  defaultValue,\n  placeholder,\n  disabled = false,\n  readOnly = false,\n  required = false,\n  hasError = false,\n  describedBy,\n  className,\n  width = 'full',\n  inputMode,\n  autoComplete,\n  maxLength,\n  minLength,\n  pattern,\n  step,\n  min,\n  max,\n  showValueLabels = false,\n  showCurrentValue = false,\n  valueLabels,\n  onChange,\n  onBlur,\n  onFocus,\n  onKeyDown,\n  ...props\n}) => {\n  const [currentValue, setCurrentValue] = useState(value || defaultValue || (type === 'range' ? min || '0' : ''));\n\n  useEffect(() => {\n    if (value !== undefined) {\n      setCurrentValue(value);\n    }\n  }, [value]);\n\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement> | React.KeyboardEvent<HTMLInputElement>) => {\n    const el = event.target as HTMLInputElement;\n    setCurrentValue(el.value);\n    // Only forward real change events (have nativeEvent) or synthesized key events where value changed\n    if ('type' in event && (event as any).nativeEvent) {\n      onChange?.(event as any);\n    } else if (event.type === 'keydown') {\n      onChange?.(event as any);\n    }\n  };\n\n  const { classes: inputClasses, isRange } = mapInputProps({ id, name, type, hasError, width, className });\n\n  const isControlled = value !== undefined;\n  const sharedRangeProps = {\n    id,\n    name,\n    type,\n    placeholder,\n    disabled,\n    readOnly,\n    required,\n    'aria-describedby': describedBy,\n    inputMode,\n    autoComplete,\n    maxLength,\n    minLength,\n    pattern,\n    step,\n    min,\n    max,\n    onChange: handleChange,\n    onBlur,\n    onFocus,\n    onKeyDown: (e: React.KeyboardEvent<HTMLInputElement>) => {\n      // For range sliders, jsdom may not update value when typing numbers; manually adjust\n      if (isRange && /[0-9]/.test(e.key)) {\n        const next = (currentValue?.toString() || '') + e.key;\n        (e.target as HTMLInputElement).value = next;\n        handleChange(e);\n      }\n      onKeyDown?.(e);\n    },\n    ...props,\n  } as const;\n\n  // Range input handling: avoid React warning by not passing both value and defaultValue for uncontrolled inputs\n  const uncontrolledRangeProps = (!isControlled && defaultValue !== undefined)\n    ? { defaultValue }\n    : {};\n  const controlledRangeProps = isControlled ? { value } : {};\n\n  const renderRangeInput = () => (\n    <input\n      className={inputClasses}\n      // Only supply value if controlled; otherwise rely on defaultValue\n      {...controlledRangeProps}\n      {...uncontrolledRangeProps}\n      // For internal current value display we still keep state, but don't force React controlled mode\n      data-current-value={currentValue}\n      {...sharedRangeProps}\n    />\n  );\n\n  const rangeWrapper = isRange ? (\n    <div className=\"nhsuk-input-range-wrapper\">\n      {showValueLabels && (\n        <div className=\"nhsuk-input-range-labels\">\n          <span className=\"nhsuk-input-range-label nhsuk-input-range-label--min\">\n            {valueLabels?.min || min || '0'}\n          </span>\n          {renderRangeInput()}\n          <span className=\"nhsuk-input-range-label nhsuk-input-range-label--max\">\n            {valueLabels?.max || max || '100'}\n          </span>\n        </div>\n      )}\n      {!showValueLabels && renderRangeInput()}\n      {showCurrentValue && (\n        <div className=\"nhsuk-input-range-current-value\">\n          <span className=\"nhsuk-input-range-current-label\">\n            {valueLabels?.current || 'Current value:'} <strong>{currentValue}</strong>\n          </span>\n        </div>\n      )}\n    </div>\n  ) : null;\n\n  if (isRange) {\n    return rangeWrapper;\n  }\n\n  return (\n    <input\n      className={inputClasses}\n      id={id}\n      name={name}\n      type={type}\n      value={value}\n      {...(value === undefined && defaultValue !== undefined ? { defaultValue } : {})}\n      placeholder={placeholder}\n      disabled={disabled}\n      readOnly={readOnly}\n      required={required}\n      aria-describedby={describedBy}\n      inputMode={inputMode}\n      autoComplete={autoComplete}\n      maxLength={maxLength}\n      minLength={minLength}\n      pattern={pattern}\n      step={step}\n      min={min}\n      max={max}\n      onChange={onChange}\n      onBlur={onBlur}\n      onFocus={onFocus}\n      onKeyDown={onKeyDown}\n      {...props}\n    />\n  );\n};\n", "export interface InputMapperProps {\n  id: string;\n  name: string;\n  type?: string;\n  hasError?: boolean;\n  width?: string;\n  className?: string;\n  range?: {\n    isRange: boolean;\n    showValueLabels: boolean;\n    showCurrentValue: boolean;\n  };\n}\n\nexport interface NormalisedInputModel {\n  classes: string;\n  isRange: boolean;\n}\n\nexport function mapInputProps(p: InputMapperProps): NormalisedInputModel {\n  const type = p.type || 'text';\n  const isRange = type === 'range';\n  const classes = [\n    'nhsuk-input',\n    p.hasError ? 'nhsuk-input--error' : '',\n    isRange ? 'nhsuk-input--range' : '',\n    (!isRange && p.width && p.width !== 'full') ? `nhsuk-input--width-${p.width}` : '',\n    p.className || ''\n  ].filter(Boolean).join(' ');\n  return { classes, isRange };\n}\n", "export interface LabelInputProps {\n  size?: 'xl'|'l'|'m'|'s';\n  isPageHeading?: boolean;\n  className?: string;\n  htmlFor?: string;\n}\n\nexport interface NormalisedLabelModel {\n  tag: 'label' | 'h1';\n  classes: string;\n  size: string;\n  htmlFor?: string;\n  isPageHeading: boolean;\n}\n\nexport function mapLabelProps(input: LabelInputProps): NormalisedLabelModel {\n  const size = input.size || 'm';\n  const classes = [\n    'nhsuk-label',\n    size !== 'm' ? `nhsuk-label--${size}` : '',\n    input.className || ''\n  ].filter(Boolean).join(' ');\n  return {\n    tag: input.isPageHeading ? 'h1' : 'label',\n    classes,\n    size,\n    htmlFor: input.isPageHeading ? undefined : input.htmlFor,\n    isPageHeading: !!input.isPageHeading\n  };\n}\n", "import React from 'react';\nimport './Label.scss';\nimport { LabelProps } from './Label.types';\nimport { mapLabelProps } from '../../mapping/label';\n\nexport const Label: React.FC<LabelProps> = ({\n  htmlFor,\n  className,\n  isPageHeading = false,\n  size = 'm',\n  children,\n  ...props\n}) => {\n  const model = mapLabelProps({ size, isPageHeading, className, htmlFor });\n  const LabelElement = model.tag;\n\n  return (\n  <LabelElement className={model.classes} htmlFor={model.htmlFor} {...props}>\n      {isPageHeading ? (\n        <label className=\"nhsuk-label-wrapper\" htmlFor={htmlFor}>\n          {children}\n        </label>\n      ) : (\n        children\n      )}\n    </LabelElement>\n  );\n};\n", "export type FieldsetLegendSize = 'xl' | 'l' | 'm' | 's';\n\nexport interface FieldsetLegendInput {\n  size?: FieldsetLegendSize;\n  className?: string;\n  isPageHeading?: boolean;\n}\n\nexport interface FieldsetInputProps {\n  className?: string;\n  describedBy?: string;\n  legend?: FieldsetLegendInput;\n}\n\nexport interface NormalisedFieldsetModel {\n  fieldsetClasses: string;\n  legendClasses?: string;\n  legendIsPageHeading: boolean;\n  describedBy?: string;\n}\n\nexport function mapFieldsetProps(input: FieldsetInputProps): NormalisedFieldsetModel {\n  const fieldsetClasses = ['nhsuk-fieldset', input.className || ''].filter(Boolean).join(' ');\n  const legendClasses = input.legend\n    ? [\n        'nhsuk-fieldset__legend',\n        input.legend.size ? `nhsuk-fieldset__legend--${input.legend.size}` : '',\n        input.legend.className || '',\n      ]\n        .filter(Boolean)\n        .join(' ')\n    : undefined;\n  return {\n    fieldsetClasses,\n    legendClasses,\n    legendIsPageHeading: !!input.legend?.isPageHeading,\n    describedBy: input.describedBy,\n  };\n}\n", "import React from \"react\";\nimport \"./Fieldset.scss\";\nimport { FieldsetProps } from \"./Fieldset.types\";\nimport { mapFieldsetProps } from \"../../mapping/fieldset\";\n\nexport const Fieldset: React.FC<FieldsetProps> = ({\n\tchildren,\n\tlegend,\n\tclassName,\n\tdescribedBy,\n\t...fieldsetProps\n}) => {\n\tconst model = mapFieldsetProps({\n\t\tclassName,\n\t\tdescribedBy,\n\t\tlegend: legend\n\t\t\t? {\n\t\t\t\t\tsize: legend.size,\n\t\t\t\t\tclassName: legend.className,\n\t\t\t\t\tisPageHeading: legend.isPageHeading,\n\t\t\t\t}\n\t\t\t: undefined,\n\t});\n\n\tconst renderLegendContent = () => {\n\t\tconst content = legend?.html ? (\n\t\t\t<span dangerouslySetInnerHTML={{ __html: legend.html }} />\n\t\t) : (\n\t\t\tlegend?.text\n\t\t);\n\n\t\tif (model.legendIsPageHeading) {\n\t\t\treturn <h1 className=\"nhsuk-fieldset__heading\">{content}</h1>;\n\t\t}\n\n\t\treturn content;\n\t};\n\n\treturn (\n\t\t<fieldset\n\t\t\tclassName={model.fieldsetClasses}\n\t\t\taria-describedby={model.describedBy}\n\t\t\t{...fieldsetProps}\n\t\t>\n\t\t\t{legend && (legend.text || legend.html) && (\n\t\t\t\t<legend className={model.legendClasses}>{renderLegendContent()}</legend>\n\t\t\t)}\n\t\t\t{children}\n\t\t</fieldset>\n\t);\n};\n", "export interface CheckboxesInputProps {\n  small?: boolean;\n  className?: string;\n  hasError?: boolean;\n}\n\nexport interface NormalisedCheckboxesModel {\n  classes: string;\n  formGroupClasses: string;\n}\n\nexport function mapCheckboxesProps(input: CheckboxesInputProps): NormalisedCheckboxesModel {\n  const classes = [\n    'nhsuk-checkboxes',\n    input.small ? 'nhsuk-checkboxes--small' : '',\n    input.className || '',\n  ].filter(Boolean).join(' ');\n  const formGroupClasses = [\n    'nhsuk-form-group',\n    input.hasError ? 'nhsuk-form-group--error' : '',\n  ].filter(Boolean).join(' ');\n  return { classes, formGroupClasses };\n}\n", "import React, { useState, useRef, useCallback } from 'react';\nimport { RadiosProps } from './Radios.types';\nimport { renderRadiosMarkup } from './Radios.render';\nimport { Input } from '../Input/Input';\n\nexport const Radios: React.FC<RadiosProps> = ({ value, defaultValue, onChange, onBlur, onFocus, ...rest }) => {\n\tconst [selectedValue, setSelectedValue] = useState(value || defaultValue || '');\n\tconst itemsRef = useRef<HTMLInputElement[]>([]);\n\n\t// Minimal guards: only emit change if value actually changed\n\tconst lastValueRef = useRef<string | null>(selectedValue);\n\tconst handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n\t\tconst newValue = event.target.value;\n\t\tif (newValue === lastValueRef.current) return; // ignore duplicate\n\t\tlastValueRef.current = newValue;\n\t\tsetSelectedValue(newValue);\n\t\tonChange?.(event);\n\t};\n\n\tconst handleFocus = (event: React.FocusEvent<HTMLInputElement>) => {\n\t\tonFocus?.(event);\n\t};\n\n\tconst handleKeyDown = useCallback((event: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tconst { key } = event;\n\t\tif (!['ArrowDown', 'ArrowUp', 'ArrowRight', 'ArrowLeft'].includes(key)) return;\n\t\tevent.preventDefault();\n\t\tconst enabledRadios = itemsRef.current.filter(r => r && !r.disabled);\n\t\tconst current = enabledRadios.indexOf(event.currentTarget);\n\t\tif (current === -1) return;\n\t\tlet nextIndex = current;\n\t\tif (['ArrowDown', 'ArrowRight'].includes(key)) nextIndex = (current + 1) % enabledRadios.length;\n\t\telse if (['ArrowUp', 'ArrowLeft'].includes(key)) nextIndex = (current - 1 + enabledRadios.length) % enabledRadios.length;\n\t\tconst nextRadio = enabledRadios[nextIndex];\n\t\tif (nextRadio) {\n\t\t\tnextRadio.focus();\n\t\t\tif (!nextRadio.checked) nextRadio.click();\n\t\t}\n\t}, []);\n\n\treturn renderRadiosMarkup(\n\t\t{ value, defaultValue, onChange, onBlur, onFocus, ...rest },\n\t\t{\n\t\t\tvariant: 'client',\n\t\t\tselectedValue,\n\t\t\tenableBehaviourAttr: false,\n\t\t\thandleChange,\n\t\t\thandleBlur: onBlur,\n\t\t\thandleFocus, // wrapped to suppress duplicate focus calls\n\t\t\thandleKeyDown,\n\t\t\titemsRef,\n\t\t\tInputComponent: Input,\n\t\t}\n\t);\n};\n\n", "import React, { ReactNode } from \"react\";\nimport classNames from \"classnames\";\nimport { RadiosProps, RadioConditionalProps } from \"./Radios.types\";\nimport { Label } from \"../Label/Label\";\nimport { Fieldset } from \"../Fieldset/Fieldset\";\nimport \"./Radios.scss\";\nimport { mapRadiosProps } from \"../../mapping/radios\";\nimport type { InputProps } from \"../Input/Input.types\";\n\n// Pure render function used by both client (interactive) and server (static) variants.\n// The caller supplies: selectedValue (string), event handlers (possibly no-ops for server),\n// and flags controlling whether runtime behaviours should be activated.\nexport interface RenderRadiosOptions {\n\tvariant: \"client\" | \"server\";\n\tselectedValue: string;\n\tenableBehaviourAttr?: boolean; // whether to include data-nhs-behaviour attribute\n\thandleChange?: (e: React.ChangeEvent<HTMLInputElement>) => void;\n\thandleBlur?: (e: React.FocusEvent<HTMLInputElement>) => void;\n\thandleFocus?: (e: React.FocusEvent<HTMLInputElement>) => void;\n\thandleKeyDown?: (e: React.KeyboardEvent<HTMLInputElement>) => void;\n\titemsRef?: React.MutableRefObject<HTMLInputElement[]>; // only for client roving focus\n  /** Input component to use for conditional content; injected to avoid importing client Input in SSR. */\n  InputComponent: React.ComponentType<InputProps>;\n}\n\nexport function renderRadiosMarkup(\n\tprops: RadiosProps,\n\t{\n\t\tvariant,\n\t\tselectedValue,\n\t\tenableBehaviourAttr,\n\t\thandleChange,\n\t\thandleBlur,\n\t\thandleFocus,\n\t\thandleKeyDown,\n\t\titemsRef,\n    InputComponent,\n\t}: RenderRadiosOptions\n) {\n\t// Remove user-supplied form event handlers so they are only bound to inputs, not the wrapper\n\tconst {\n\t\tonChange: _omitOnChange,\n\t\tonBlur: _omitOnBlur,\n\t\tonFocus: _omitOnFocus,\n\t\t...safeProps\n\t} = props as any;\n\tconst {\n\t\tname,\n\t\thasError = false,\n\t\tdescribedBy,\n\t\tclassName,\n\t\tsize = \"normal\",\n\t\tinline = false,\n\t\toptions,\n\t\t...rest\n\t} = safeProps;\n\n\tconst { classes: radiosClasses, describedBy: mappedDescribedBy } =\n\t\tmapRadiosProps({ hasError, size, inline, className, describedBy });\n\n\treturn (\n\t\t<Fieldset>\n\t\t\t<div\n\t\t\t\tclassName={radiosClasses}\n\t\t\t\t{...rest}\n\t\t\t\t{...(enableBehaviourAttr ? { \"data-nhs-behaviour\": \"radios\" } : {})}\n\t\t\t>\n\t\t\t\t{options.map((option: any, index: number) => {\n\t\t\t\t\tconst radioId = `${name}-${index}`;\n\t\t\t\t\tconst conditionalId = option.conditional\n\t\t\t\t\t\t? `${radioId}-conditional`\n\t\t\t\t\t\t: undefined;\n\t\t\t\t\tconst isSelected = selectedValue === option.value;\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div key={option.value} className=\"nhsuk-radios__item\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tclassName=\"nhsuk-radios__input\"\n\t\t\t\t\t\t\t\tid={radioId}\n\t\t\t\t\t\t\t\tname={name}\n\t\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\t\tvalue={option.value}\n\t\t\t\t\t\t\t\tdisabled={option.disabled}\n\t\t\t\t\t\t\t\t{...(variant === \"client\"\n\t\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\t\tchecked: isSelected,\n\t\t\t\t\t\t\t\t\t\t\tonChange: handleChange,\n\t\t\t\t\t\t\t\t\t\t\tonBlur: handleBlur,\n\t\t\t\t\t\t\t\t\t\t\tonFocus: handleFocus,\n\t\t\t\t\t\t\t\t\t\t\tonKeyDown: handleKeyDown,\n\t\t\t\t\t\t\t\t\t\t\tref: (el: HTMLInputElement) => {\n\t\t\t\t\t\t\t\t\t\t\t\tif (el && itemsRef) itemsRef.current[index] = el;\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\t\tdefaultChecked: isSelected,\n\t\t\t\t\t\t\t\t\t\t\t\"data-nhs-radios-input\": true,\n\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\taria-describedby={mappedDescribedBy}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<label className=\"nhsuk-radios__label\" htmlFor={radioId}>\n\t\t\t\t\t\t\t\t{option.text}\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t{option.hint && (\n\t\t\t\t\t\t\t\t<div className=\"nhsuk-radios__hint\">{option.hint}</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{option.conditional && (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName={classNames(\"nhsuk-radios__conditional\", {\n\t\t\t\t\t\t\t\t\t\t\"nhsuk-radios__conditional--hidden\": !isSelected,\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\tid={conditionalId}\n\t\t\t\t\t\t\t\t\t{...(variant === \"server\"\n\t\t\t\t\t\t\t\t\t\t? { \"data-nhs-radios-conditional\": true }\n\t\t\t\t\t\t\t\t\t\t: {})}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{typeof option.conditional === \"object\" &&\n\t\t\t\t\t\t\t\t\toption.conditional !== null &&\n\t\t\t\t\t\t\t\t\t\"label\" in option.conditional &&\n\t\t\t\t\t\t\t\t\t\"id\" in option.conditional &&\n\t\t\t\t\t\t\t\t\t\"name\" in option.conditional ? (\n\t\t\t\t\t\t\t\t\t\t<div style={{ marginTop: \"16px\" }}>\n\t\t\t\t\t\t\t\t\t\t\t{(option.conditional as RadioConditionalProps).label && (\n\t\t\t\t\t\t\t\t\t\t\t\t<Label\n\t\t\t\t\t\t\t\t\t\t\t\t\thtmlFor={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(option.conditional as RadioConditionalProps).id\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{(option.conditional as RadioConditionalProps).label}\n\t\t\t\t\t\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t<InputComponent\n\t\t\t\t\t\t\t\t\t\t\t\t{...(option.conditional as RadioConditionalProps)}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t(option.conditional as ReactNode)\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</div>\n\t\t</Fieldset>\n\t);\n}\n", "export interface RadiosInputProps {\n  hasError?: boolean;\n  inline?: boolean;\n  size?: 'normal' | 'small';\n  className?: string;\n  describedBy?: string;\n}\n\nexport interface NormalisedRadiosModel {\n  classes: string;\n  describedBy?: string;\n}\n\nexport function mapRadiosProps(input: RadiosInputProps): NormalisedRadiosModel {\n  const classes = [\n    'nhsuk-radios',\n    input.hasError ? 'nhsuk-radios--error' : '',\n    input.size === 'small' ? 'nhsuk-radios--small' : '',\n    input.inline ? 'nhsuk-radios--inline' : '',\n    input.className || '',\n  ].filter(Boolean).join(' ');\n  return { classes, describedBy: input.describedBy };\n}\n", "import React from \"react\";\nimport classNames from \"classnames\";\nimport \"./Grid.scss\";\nimport {\n\tContainerProps,\n\tRowProps,\n\tColumnProps,\n\tGridProps,\n} from \"./Grid.types\";\n\n/**\n * Grid Container Component\n *\n * Provides a page-width container with responsive margins.\n * Based on NHS UK's width-container object.\n */\nexport const Container: React.FC<ContainerProps> = ({\n\tchildren,\n\tclassName,\n\tfluid = false,\n\tmaxWidth,\n\tstyle,\n\t...props\n}) => {\n\tconst containerClasses = classNames(\n\t\t{\n\t\t\t\"nhsuk-width-container\": !fluid,\n\t\t\t\"nhsuk-width-container-fluid\": fluid,\n\t\t},\n\t\tclassName\n\t);\n\n\tconst mergedStyle = maxWidth ? { maxWidth, ...(style || {}) } : style;\n\n\treturn (\n\t\t<div className={containerClasses} style={mergedStyle} {...props}>\n\t\t\t{children}\n\t\t</div>\n\t);\n};\n\n/**\n * Grid Row Component\n *\n * Creates a grid row with negative margins to offset column gutters.\n * Based on NHS UK's grid-row object.\n */\nexport const Row: React.FC<RowProps> = ({\n\tchildren,\n\tclassName,\n\tstyle,\n\t...props\n}) => {\n\tconst rowClasses = classNames(\"nhsuk-grid-row\", className);\n\n\treturn (\n\t\t<div className={rowClasses} style={style} {...props}>\n\t\t\t{children}\n\t\t</div>\n\t);\n};\n\n/**\n * Grid Column Component\n *\n * Creates responsive grid columns with CSS Grid layout.\n * Supports different widths at different breakpoints and grid positioning.\n */\nimport { GridWidth } from \"./Grid.types\";\n\nexport const Column: React.FC<ColumnProps> = ({\n\tchildren,\n\twidth = GridWidth.Full,\n\tmobileWidth,\n\ttabletWidth,\n\tdesktopWidth,\n\tstart,\n\tclassName,\n\tforceWidth = false,\n\tstyle,\n\talign,\n\t...props\n}) => {\n\tconst columnClasses = classNames(\n\t\t{\n\t\t\t// Standard responsive grid columns\n\t\t\t[`nhsuk-grid-column-${width}`]: !forceWidth,\n\t\t\t// Utility classes that force width on all screen sizes\n\t\t\t[`nhsuk-u-${width}`]: forceWidth,\n\t\t\t// Responsive width overrides\n\t\t\t[`nhsuk-u-${mobileWidth}-mobile`]: !!mobileWidth,\n\t\t\t[`nhsuk-u-${tabletWidth}-tablet`]: !!tabletWidth,\n\t\t\t[`nhsuk-u-${desktopWidth}-desktop`]: !!desktopWidth,\n\n\t\t\t// Grid positioning\n\t\t\t[`nhsuk-grid-column-start-${start}`]: start && start >= 1 && start <= 7,\n\t\t\t// Alignment (robust string-based class to avoid enum identity issues)\n\t\t\t...(align ? { [`nhsuk-grid-align-${align}`]: true } : {}),\n\t\t},\n\t\tclassName\n\t);\n\n\treturn (\n\t\t<div className={columnClasses} style={style} {...props}>\n\t\t\t{children}\n\t\t</div>\n\t);\n};\n\n/**\n * Grid Wrapper Component\n *\n * Convenience component that combines Container and Row.\n * Automatically wraps children in a Row unless the first child is already a Row component.\n */\nexport const Grid: React.FC<GridProps> = ({\n\tchildren,\n\tclassName,\n\tstyle,\n\t...props\n}) => {\n\tconst childrenArray = React.Children.toArray(children);\n\tconst firstChild = childrenArray[0];\n\n\t// Check if the first child is a Row component\n\tconst hasRowAsFirstChild =\n\t\tReact.isValidElement(firstChild) &&\n\t\t(firstChild.type === Row ||\n\t\t\t(typeof firstChild.props === \"object\" &&\n\t\t\t\tfirstChild.props &&\n\t\t\t\t\"className\" in firstChild.props &&\n\t\t\t\ttypeof firstChild.props.className === \"string\" &&\n\t\t\t\tfirstChild.props.className.includes(\"nhsuk-grid-row\")));\n\n\treturn (\n\t\t<Container className={className} style={style} {...props}>\n\t\t\t{hasRowAsFirstChild ? children : <Row>{children}</Row>}\n\t\t</Container>\n\t);\n};\n", "import React from 'react';\nimport classNames from 'classnames';\nimport { InsetTextProps } from './InsetText.types';\nimport './InsetText.scss';\n\nexport const InsetText: React.FC<InsetTextProps> = ({\n  text,\n  html,\n  children,\n  className,\n  ...rest\n}) => {\n  const insetTextClasses = classNames('nhsuk-inset-text', className);\n\n  const renderContent = () => {\n    if (children) {\n      return children;\n    }\n    \n    if (html) {\n      return <div dangerouslySetInnerHTML={{ __html: html }} />;\n    }\n    \n    if (text) {\n      return <p>{text}</p>;\n    }\n    \n    return null;\n  };\n\n  return (\n    <div className={insetTextClasses} {...rest}>\n      {renderContent()}\n    </div>\n  );\n};\n", "import React from 'react';\nimport classNames from 'classnames';\nimport { SummaryListProps, SummaryListItem } from './SummaryList.types';\nimport './SummaryList.scss';\n\nexport const SummaryList: React.FC<SummaryListProps> = ({\n  items,\n  noBorder = false,\n  className,\n  ...rest\n}) => {\n  const summaryListClasses = classNames(\n\t'nhsuk-summary-list',\n\t{\n\t  'nhsuk-summary-list--no-border': noBorder,\n\t},\n\tclassName\n  );\n\n  const renderContent = (content: { text?: string; html?: string; children?: React.ReactNode }) => {\n\tif (content.children) {\n\t  return content.children;\n\t}\n\t\n\tif (content.html) {\n\t  return <span dangerouslySetInnerHTML={{ __html: content.html }} />;\n\t}\n\t\n\tif (content.text) {\n\t  return content.text;\n\t}\n\t\n\treturn null;\n  };\n\n  const renderActions = (actions: SummaryListItem['actions']) => {\n\tif (!actions || !actions.items.length) {\n\t  return null;\n\t}\n\n\t  return (\n\t\t\t\n\t\t\t\t<dd className=\"nhsuk-summary-list__actions\">\n\t\t\t\t\t<ul className=\"nhsuk-summary-list__actions-list\">\n\t\t\t\t\t{actions.items.map((action, actionIndex) => (\n\t\t\t\t\t\t<li \n\t\t\t\t\t\tkey={actionIndex} \n\t\t\t\t\t\tclassName=\"nhsuk-summary-list__actions-list-item\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\thref={action.href}\n\t\t\t\t\t\t\tclassName=\"nhsuk-link\"\n\t\t\t\t\t\t\t{...action.attributes}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{renderContent(action)}\n\t\t\t\t\t\t\t{action.visuallyHiddenText && (\n\t\t\t\t\t\t\t<span className=\"nhsuk-u-visually-hidden\">\n\t\t\t\t\t\t\t\t{action.visuallyHiddenText}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t))}\n\t\t\t\t\t</ul>\n\t\t\t\t</dd>\n\t\t\t\n\t);\n  };\n\nreturn (\n\t<div className=\"nhsuk-summary-list-container\">\n\t\t<dl className={summaryListClasses} {...rest}>\n\t\t{items.map((item, index) => (\n\t\t\t<div key={index} className=\"nhsuk-summary-list__row\">\n\t\t\t<dt className=\"nhsuk-summary-list__key\">\n\t\t\t\t{renderContent(item.key)}\n\t\t\t</dt>\n\t\t\t<dd className=\"nhsuk-summary-list__value\">\n\t\t\t\t{renderContent(item.value)}\n\t\t\t</dd>\n\t\t\t{renderActions(item.actions)}\n\t\t\t</div>\n\t\t))}\n\t\t</dl>\n\t</div>\n  );\n};\n", "import * as React from \"react\";\nimport { SummaryList } from \"../../../components\";\nimport type { SummaryListItem } from \"../../../components/SummaryList\";\n\nexport interface WizardProgressItem {\n\tnodeId: string;\n\tquestion?: string;\n\tvalue: string | string[];\n}\n\nexport interface WizardProgressProps {\n\titems: WizardProgressItem[];\n\tcurrentQuestion?: string;\n\tonJumpTo?: (index: number) => void;\n}\n\n/**\n * WizardProgress now renders a SummaryList of prior answers (one row per answer)\n * and shows the current step/question. Each row includes a Change link when onJumpTo is provided.\n */\nexport const WizardProgress: React.FC<WizardProgressProps> = ({\n\titems,\n\tcurrentQuestion,\n\tonJumpTo,\n}) => {\n\tconst listItems: SummaryListItem[] = items.map((a, i) => ({\n\t\tkey: { text: a.question || a.nodeId },\n\t\tvalue: { text: Array.isArray(a.value) ? a.value.join(\", \") : a.value },\n\t\tactions: onJumpTo\n\t\t\t? {\n\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thref: \"#\",\n\t\t\t\t\t\t\ttext: \"Change\",\n\t\t\t\t\t\t\tvisuallyHiddenText: a.question || a.nodeId,\n\t\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\t\tonClick: (e: any) => {\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\tonJumpTo(i);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t} as any,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t}\n\t\t\t: undefined,\n\t}));\n\n\treturn (\n\t\t<aside aria-label=\"Progress\" style={{ position: \"relative\" }}>\n\t\t\t{currentQuestion && (\n\t\t\t\t<p style={{ marginTop: 0, marginBottom: 12 }}>{currentQuestion}</p>\n\t\t\t)}\n\t\t\t{items.length > 0 && <SummaryList items={listItems} />}\n\t\t</aside>\n\t);\n};\n\nexport default WizardProgress;\n", "import * as React from 'react';\nimport { SummaryList } from '../../../components/SummaryList';\nimport type { SummaryListItem } from '../../../components/SummaryList/SummaryList.types';\n\nexport interface ReviewAnswersItem {\n  nodeId: string;\n  question?: string;\n  value: string | string[];\n}\n\nexport interface ReviewAnswersProps {\n  items: ReviewAnswersItem[];\n  onChange?: (index: number) => void;\n}\n\n/**\n * ReviewAnswers shows a SummaryList of prior answers with a Change link for each,\n * plus a Start again button to clear all answers.\n */\nexport const ReviewAnswers: React.FC<ReviewAnswersProps> = ({ items, onChange }) => {\n  const list: SummaryListItem[] = items.map((a, i) => ({\n    key: { text: a.question || a.nodeId },\n    value: { text: Array.isArray(a.value) ? a.value.join(', ') : a.value },\n    actions: onChange\n      ? {\n          items: [\n            {\n              href: '#',\n              text: 'Change',\n              visuallyHiddenText: a.question || a.nodeId,\n              attributes: {\n                onClick: (e: any) => {\n                  e.preventDefault();\n                  onChange(i);\n                },\n              } as any,\n            },\n          ],\n        }\n      : undefined,\n  }));\n\n  return (\n    <div>\n      <SummaryList items={list} />\n      {/* {onReset && (\n        <div style={{ marginTop: 16 }}>\n          <Button variant=\"secondary\" onClick={onReset}>\n            Start again\n          </Button>\n        </div>\n      )} */}\n    </div>\n  );\n};\n\nexport default ReviewAnswers;\n", "import type { LogicFile, Wizard, WizardNode } from \"./wizardTypes\";\n\nexport function getWizard(logic: LogicFile, wizardId: string): Wizard {\n\tconst wiz = (logic as any).wizards?.[wizardId];\n\tif (!wiz) throw new Error(`Wizard '${wizardId}' not found`);\n\treturn wiz as Wizard;\n}\n\nexport function getNode(wiz: Wizard, nodeId: string): WizardNode {\n\tconst node = wiz.nodes?.[nodeId];\n\tif (!node) throw new Error(`Node '${nodeId}' not found`);\n\treturn node as WizardNode;\n}\n\nexport type StepResult = { nextId?: string; recommend?: string[] };\n\n/** Given a yes/no node and an answer string ('yes'|'no'), return the next step */\nexport function evaluateYesNo(node: any, answer: \"yes\" | \"no\"): StepResult {\n\tconst branch = answer === \"yes\" ? node.yes : node.no;\n\tif (!branch) return {};\n\treturn { nextId: branch.next, recommend: branch.recommend };\n}\n\n/**\n * Evaluate a choice for a single_choice node; returns the next node id (if any) and any recommendations.\n */\nexport function evaluateSingleChoice(node: any, label: string): StepResult {\n\tconst choice = (node.choices || []).find((c: any) => c.label === label);\n\tif (!choice) return {};\n\treturn { nextId: choice.next, recommend: choice.recommend };\n}\n\n/**\n * Evaluate a multi-select choice list; aggregates recommendations and only follows next\n * if all selected choices share the same explicit next id.\n */\nexport function evaluateMultiChoice(node: any, labels: string[]): StepResult {\n\tconst selected = (node.choices || []).filter((c: any) =>\n\t\tlabels.includes(c.label)\n\t);\n\tif (selected.length === 0) return {};\n\tconst rec: string[] = selected.flatMap(\n\t\t(c: any) => (c.recommend as string[] | undefined) || []\n\t);\n\tconst nextIds = Array.from(\n\t\tnew Set(selected.map((c: any) => c.next).filter(Boolean))\n\t);\n\tconst nextId = nextIds.length === 1 ? (nextIds[0] as string) : undefined;\n\t// de-duplicate recommendations\n\tconst recommend = Array.from(new Set(rec));\n\treturn { nextId, recommend };\n}\n\n/** Determine if a choice node allows multiple selections (supports new and legacy shapes). */\nexport function isMultipleChoice(node: any): boolean {\n    if (!node) return false;\n    if (node.type === 'choice') return node.mode === 'multiple';\n    if (node.type === 'single_choice') return !!node.multiple;\n    return false;\n}\n", "import * as React from \"react\";\nimport \"../../../DataVisualisation.scss\";\nimport \"./SPCChart.scss\";\nimport { ChartRoot, useChartContext } from \"../../../core/ChartRoot\";\nimport { TooltipProvider, useTooltipContext } from \"../../../core/TooltipContext\";\nimport {\n\tLineScalesProvider,\n\tuseScaleContext,\n} from \"../../../core/ScaleContext\";\nimport Axis from \"../../Axis/Axis\";\nimport GridLines from \"../../GridlLines/GridLines\";\nimport LineSeriesPrimitive from \"../../../series/LineSeriesPrimitive\";\n// Replaced generic TooltipOverlay with SPC-specific enriched overlay\nimport SPCTooltipOverlay from \"./SPCTooltipOverlay\";\nimport VisuallyHiddenLiveRegion from \"../../../primitives/VisuallyHiddenLiveRegion\";\nimport { SPCVariationIcon } from \"../SPCIcons/SPCIcon\";\nimport { SPCAssuranceIcon } from \"../SPCIcons/SPCAssuranceIcon\";\nimport { AssuranceResult, Direction, MetricPolarity } from \"../SPCIcons/SPCConstants\";\n// SPC Logic & types\nimport {\n\tbuildSpc,\n\tSpcWarningSeverity,\n\tSpcWarningCategory,\n\tSpcWarningCode,\n\ttype SpcSettings,\n} from \"./logic/spc\";\nimport { ImprovementDirection, VariationIcon, AssuranceIcon, ChartType } from \"./logic/spcConstants\";\nimport SpcGradientCategory, { SpcEmbeddedIconVariant, LetterMode } from \"./SPCChart.constants\";\nimport { buildSpcSqlCompat } from './logic/spcSqlCompat';\nimport { Tag } from \"../../../../Tag/Tag\";\nimport Table from \"../../../../Tables/Table\";\nimport SPCSignalsInspector from \"./SPCSignalsInspector\";\nimport type { SPCSignalFocusInfo } from \"./SPCChart.types\";\nimport {\n\textractRuleIds,\n\truleGlossary,\n\tvariationLabel,\n} from \"./logic/spcDescriptors\";\n\n// Global counter to create stable, unique gradient id bases across multiple SPCChart instances\nlet spcSequenceInstanceCounter = 0;\n\n// Gradient transition strategy between adjacent coloured sequences\nexport enum SequenceTransition {\n\tSlope = \"slope\",   // attribute join to rising (next) or falling/flat (prev) based on delta\n\tNeutral = \"neutral\", // draw a neutral (grey) wedge between coloured runs\n\tExtend = \"extend\", // always extend previous coloured run to the next first point\n}\n\n// Visual-only mode for trend colouring\nexport enum TrendVisualMode {\n\tUngated = \"ungated\",\n\tGated = \"gated\",\n}\n\nexport interface SPCDatum {\n\tx: Date | string | number;\n\ty: number;\n}\nexport interface SPCChartProps {\n\tdata: SPCDatum[];\n\tariaLabel?: string;\n\theight?: number;\n\tshowZones?: boolean;\n\tshowPoints?: boolean;\n\tannounceFocus?: boolean;\n\tclassName?: string;\n\t/** Convenience unit alias (overrides narrationContext.measureUnit). Auto-detected as '%' when all y in [0,1] if not provided */\n\tunit?: string;\n\t/** Highlight points outside 3-sigma */\n\thighlightOutOfControl?: boolean;\n\t/** SPC chart type */\n\tchartType?: ChartType;\n\t/** Direction where higher/lower is better (affects variation and assurance icons) */\n\tmetricImprovement?: ImprovementDirection;\n\t/** Show special-cause coloured point classes */\n\tenableRules?: boolean;\n\t/** Render variation/assurance icons (basic text markers for now) */\n\tshowIcons?: boolean;\n\t/** Render embedded SPC variation icon in chart corner (defaults to true) */\n\tshowEmbeddedIcon?: boolean;\n\t/** Variant style for embedded SPC variation icon (classic triangle / triangleWithRun). */\n\tembeddedIconVariant?: SpcEmbeddedIconVariant;\n\t/** Run length (0-5) for triangleWithRun embedded variation icon variant. Ignored otherwise. */\n\tembeddedIconRunLength?: number;\n\t/** Optional targets per point (same length order as data) */\n\ttargets?: (number | null | undefined)[];\n\t/** Baseline flags per point to start new partitions */\n\tbaselines?: (boolean | null | undefined)[];\n\t/** Ghost flags per point (excluded from calc) */\n\tghosts?: (boolean | null | undefined)[];\n\t/** Advanced engine settings (special-cause thresholds, rule toggles, assurance mode) */\n\tsettings?: SpcSettings;\n\t/** Optional contextual metadata used to enrich accessible narration */\n\tnarrationContext?: {\n\t\tmeasureName?: string;\n\t\tmeasureUnit?: string; // e.g. '%', 'ms', 'patients'\n\t\tdatasetContext?: string; // e.g. \"Monthly trust-wide data\"\n\t\torganisation?: string;\n\t\ttimeframe?: string; // free text timeframe summary\n\t\tadditionalNote?: string; // intervention or caveat\n\t};\n\t/** When true, render light gradient band fills behind contiguous sequences of similarly coloured points (concern / improvement / common). */\n\tgradientSequences?: boolean;\n\t/** Strategy for how coloured gradient sequences join at boundaries. */\n\tsequenceTransition?: SequenceTransition;\n\t/** Stroke width (thickness) of the main process line. Defaults to 1. */\n\tprocessLineWidth?: number;\n\t/** When true, render vertical dashed markers at partition (baseline) boundaries */\n\tshowPartitionMarkers?: boolean;\n\t/** When true, renders a diagnostics warnings panel below the icon row */\n\tshowWarningsPanel?: boolean;\n\t/** Filter for warnings rendered in the panel */\n\twarningsFilter?: {\n\t\tseverities?: SpcWarningSeverity[];\n\t\tcategories?: SpcWarningCategory[];\n\t\tcodes?: SpcWarningCode[];\n\t};\n\t/** Show neutral special-cause (no-judgement) purple styling on points and tooltip. Defaults to true. */\n\tenableNeutralNoJudgement?: boolean;\n\t/** Show the trend side-gating explanation text in the tooltip. Defaults to true. */\n\tshowTrendGatingExplanation?: boolean;\n\t/** Visual-only control for trend side-gating colours.\n\t * Ungated (default): Early monotonic trend points are coloured by direction (blue/orange) even before crossing the mean.\n\t * Gated: Early monotonic trend points remain neutral purple until the run reaches the favourable side of the mean.\n\t * Note: Classification (engine variationIcon) remains side-gated regardless; this only affects rendering.\n\t */\n\ttrendVisualMode?: TrendVisualMode;\n\t/**\n\t * @deprecated This prop is now ignored; trend side gating always on\n\t */\n\tdisableTrendSideGating?: boolean;\n\t/** Optional source / citation text rendered below the chart outside the SVG for reliable layout */\n\tsource?: React.ReactNode;\n\t/** Force y-axis to include zero as the lower bound even if all values are strictly positive. Default false. */\n\talwaysShowZeroY?: boolean;\n\t/** Force y-axis to include 100 as the upper bound (useful for percentages). Default false. */\n\talwaysShowHundredY?: boolean;\n\t/** Convenience flag: treat series as percentage scale (enforces 0\u2013100 domain). Overrides alwaysShowZeroY / alwaysShowHundredY when true. */\n\tpercentScale?: boolean;\n\t/** When true, run experimental SQL compatibility wrapper (post-hoc per-side ranking & pruning) instead of native aggregation. */\n\tuseSqlCompatEngine?: boolean;\n\t/** UI-only: show a hollow marker at the first index where a trend is detected (run reaches N). Default false. */\n\tshowTrendStartMarkers?: boolean;\n\t/** UI-only: show a solid marker at the first point in the trend window that lies on the favourable side of the mean. Default false. */\n\tshowFirstFavourableCrossMarkers?: boolean;\n\t/** UI-only: draw a dashed bridge between trend start and first favourable-side inclusion. Default false. */\n\tshowTrendBridgeOverlay?: boolean;\n\t/** UI-only: show a minimal Signals Inspector panel under the chart reflecting the focused point. Default false. */\n\tshowSignalsInspector?: boolean;\n\t/** UI-only: when Signals Inspector is shown, notify on focus changes. */\n\tonSignalFocus?: (info: SPCSignalFocusInfo) => void;\n}\n\nexport const SPCChart: React.FC<SPCChartProps> = ({\n\tdata,\n\tariaLabel = \"SPC chart\",\n\theight = 260,\n\tshowZones = true,\n\tshowPoints = true,\n\tannounceFocus = false,\n\tclassName,\n\tunit,\n\thighlightOutOfControl = true,\n\tchartType = ChartType.XmR,\n\tmetricImprovement = ImprovementDirection.Neither,\n\tenableRules = true,\n\tshowIcons = false,\n\tshowEmbeddedIcon = true,\n\tembeddedIconVariant = SpcEmbeddedIconVariant.Classic,\n\tembeddedIconRunLength,\n\ttargets: targetsProp,\n\tbaselines,\n\tghosts,\n\tsettings,\n\tnarrationContext,\n\tgradientSequences = false,\n\tsequenceTransition = SequenceTransition.Slope,\n\tprocessLineWidth = 2,\n\tshowWarningsPanel = false,\n\twarningsFilter,\n\tenableNeutralNoJudgement = true,\n\tshowTrendGatingExplanation = true,\n\ttrendVisualMode = TrendVisualMode.Ungated,\n\tdisableTrendSideGating,\n\tsource,\n\talwaysShowZeroY = false,\n\talwaysShowHundredY = false,\n\tpercentScale = false,\n\tuseSqlCompatEngine = false,\n\tshowTrendStartMarkers = false,\n\tshowFirstFavourableCrossMarkers = false,\n\tshowTrendBridgeOverlay = false,\n\tshowSignalsInspector = false,\n\tonSignalFocus,\n}) => {\n\t// Optional flags now available as props\n\t// Human-friendly label for SpcWarningCode values (snake_case -> Capitalised words)\n\tconst formatWarningCode = React.useCallback(\n\t\t(code: SpcWarningCode | string): string => {\n\t\t\tconst raw = String(code);\n\t\t\treturn raw\n\t\t\t\t.replace(/^spc_warning_code\\.?/i, \"\") // defensive: strip enum prefix if ever serialized\n\t\t\t\t.replace(/[_\\-]+/g, \" \") // underscores/hyphens -> space\n\t\t\t\t.trim()\n\t\t\t\t.split(\" \")\n\t\t\t\t.filter(Boolean)\n\t\t\t\t.map((w) => (w.length ? w[0].toUpperCase() + w.slice(1) : w))\n\t\t\t\t.join(\" \");\n\t\t},\n\t\t[]\n\t);\n\n\t// Human friendly label for SpcWarningCategory values (snake_case -> Capitalised words)\n\tconst formatWarningCategory = React.useCallback(\n\t\t(cat: SpcWarningCategory | string): string => {\n\t\t\treturn String(cat)\n\t\t\t\t.replace(/[_\\-]+/g, \" \")\n\t\t\t\t.trim()\n\t\t\t\t.split(\" \")\n\t\t\t\t.filter(Boolean)\n\t\t\t\t.map((w) => (w.length ? w[0].toUpperCase() + w.slice(1) : w))\n\t\t\t\t.join(\" \");\n\t\t},\n\t\t[]\n\t);\n\n\t// Removed effectiveEnableTrendSideGating constant)\n\tif (process.env.NODE_ENV !== \"production\" && disableTrendSideGating !== undefined) {\n\t\tconsole.warn(\n\t\t\t\"SPCChart: 'disableTrendSideGating' prop is deprecated and ignored (trend side gating always enabled).\"\n\t\t);\n\t}\n\n\t// Build SPC engine instance (memoised)\n\t// NB: settings object is assumed stable if not changing reference (no deep equality check)\n\t// NB: data array is assumed stable if not changing reference (no deep equality check)\n\t// NB: targets/baselines/ghosts are assumed stable if not changing reference (no deep equality check)\n\t// NB: chartType and metricImprovement are primitive values\n\t// NB: useSqlCompatEngine is a primitive value\n\t// If any of the above change by reference/value, a new engine is built.\n\t// If the build fails (e.g. insufficient data), engine will be null.\n\t// This is a best-effort attempt to avoid unnecessary rebuilds while still responding to changes.\n\t// Parent components should memoise props where possible to avoid unnecessary rebuilds.\n\t// If more granular control is needed, consider memoising settings and data at a higher level.\n\tconst engine = React.useMemo(() => {\n\t\tconst rowsInput = data.map((d, i) => ({\n\t\t\tx: d.x,\n\t\t\tvalue: d.y,\n\t\t\ttarget: targetsProp?.[i] ?? undefined,\n\t\t\tbaseline: baselines?.[i] ?? undefined,\n\t\t\tghost: ghosts?.[i] ?? undefined,\n\t\t}));\n\t\ttry {\n\t\t\t// Settings passed through unchanged (trend gating flags removed from core)\n\t\t\tconst engineSettings: SpcSettings | undefined = settings ? { ...settings } : undefined;\n\t\t\tif (useSqlCompatEngine) {\n\t\t\t\treturn buildSpcSqlCompat({\n\t\t\t\t\tchartType,\n\t\t\t\t\tmetricImprovement,\n\t\t\t\t\tdata: rowsInput,\n\t\t\t\t\tsettings: engineSettings,\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn buildSpc({ chartType, metricImprovement, data: rowsInput, settings: engineSettings });\n\t\t} catch {\n\t\t\treturn null;\n\t\t}\n\t}, [\n\t\tdata,\n\t\ttargetsProp,\n\t\tbaselines,\n\t\tghosts,\n\t\tchartType,\n\t\tmetricImprovement,\n\t\tsettings,\n\t\tuseSqlCompatEngine,\n\t]);\n\n\t// Representative row with populated limits (last available)\n\tconst engineRepresentative = engine?.rows\n\t\t.slice()\n\t\t.reverse()\n\t\t.find((r) => r.mean != null);\n\tconst mean = engineRepresentative?.mean ?? null;\n\tconst warnings = engine?.warnings || [];\n\tconst filteredWarnings = React.useMemo(() => {\n\t\tif (!warnings.length) return [] as typeof warnings;\n\t\tif (!warningsFilter) return warnings;\n\t\treturn warnings.filter((w) => {\n\t\t\tif (\n\t\t\t\twarningsFilter.severities &&\n\t\t\t\tw.severity &&\n\t\t\t\t!warningsFilter.severities.includes(w.severity)\n\t\t\t)\n\t\t\t\treturn false;\n\t\t\tif (\n\t\t\t\twarningsFilter.categories &&\n\t\t\t\tw.category &&\n\t\t\t\t!warningsFilter.categories.includes(w.category)\n\t\t\t)\n\t\t\t\treturn false;\n\t\t\tif (\n\t\t\t\twarningsFilter.codes &&\n\t\t\t\t!warningsFilter.codes.includes(w.code as SpcWarningCode)\n\t\t\t)\n\t\t\t\treturn false;\n\t\t\treturn true;\n\t\t});\n\t}, [warnings, warningsFilter]);\n\n\t// Accessible live announcement for diagnostics panel updates\n\tconst [diagnosticsMessage, setDiagnosticsMessage] =\n\t\tReact.useState<string>(\"\");\n\tconst lastDiagnosticsRef = React.useRef<string>(\"\");\n\tReact.useEffect(() => {\n\t\tif (!showWarningsPanel) {\n\t\t\tif (lastDiagnosticsRef.current !== \"\") {\n\t\t\t\tlastDiagnosticsRef.current = \"\";\n\t\t\t\tsetDiagnosticsMessage(\"\");\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tconst total = filteredWarnings.length;\n\t\tif (!total) {\n\t\t\tconst msg = \"Diagnostics: no warnings.\";\n\t\t\tif (msg !== lastDiagnosticsRef.current) {\n\t\t\t\tlastDiagnosticsRef.current = msg;\n\t\t\t\tsetDiagnosticsMessage(msg);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tconst counts = {\n\t\t\terror: filteredWarnings.filter(\n\t\t\t\t(w) => w.severity === SpcWarningSeverity.Error\n\t\t\t).length,\n\t\t\twarning: filteredWarnings.filter(\n\t\t\t\t(w) => w.severity === SpcWarningSeverity.Warning\n\t\t\t).length,\n\t\t\tinfo: filteredWarnings.filter(\n\t\t\t\t(w) => w.severity === SpcWarningSeverity.Info\n\t\t\t).length,\n\t\t};\n\t\tconst breakdownParts: string[] = [];\n\t\tif (counts.error)\n\t\t\tbreakdownParts.push(\n\t\t\t\t`${counts.error} error${counts.error === 1 ? \"\" : \"s\"}`\n\t\t\t);\n\t\tif (counts.warning)\n\t\t\tbreakdownParts.push(\n\t\t\t\t`${counts.warning} warning${counts.warning === 1 ? \"\" : \"s\"}`\n\t\t\t);\n\t\tif (counts.info) breakdownParts.push(`${counts.info} info`);\n\t\tconst msg = `Diagnostics updated: ${total} warning${total === 1 ? \"\" : \"s\"} (${breakdownParts.join(\", \")}).`;\n\t\tif (msg !== lastDiagnosticsRef.current) {\n\t\t\tlastDiagnosticsRef.current = msg;\n\t\t\tsetDiagnosticsMessage(msg);\n\t\t}\n\t}, [showWarningsPanel, filteredWarnings]);\n\n\t// Y-axis domain including limits\n\tconst ucl = engineRepresentative?.upperProcessLimit ?? null;\n\tconst lcl = engineRepresentative?.lowerProcessLimit ?? null;\n\tconst onePos = engineRepresentative?.upperOneSigma ?? null;\n\tconst oneNeg = engineRepresentative?.lowerOneSigma ?? null;\n\tconst twoPos = engineRepresentative?.upperTwoSigma ?? null;\n\tconst twoNeg = engineRepresentative?.lowerTwoSigma ?? null;\n\tconst sigma = mean != null && onePos != null ? Math.abs(onePos - mean) : 0;\n\n\t// Force SPC process line to neutral grey (#A6A6A6) to align with default point (common cause) colour.\n\tconst series = React.useMemo(\n\t\t() => [{ id: \"process\", data, color: \"#A6A6A6\" }],\n\t\t[data]\n\t);\n\tconst yDomain = React.useMemo(() => {\n\n\t\tif (percentScale) {\n\t\t\t// If any values slightly exceed bounds (e.g. 100.2 due to rounding), widen just enough.\n\t\t\tconst allVals = data.map(d => d.y);\n\t\t\tconst overMax = Math.max(100, ...allVals);\n\t\t\tconst underMin = Math.min(0, ...allVals);\n\t\t\treturn [underMin < 0 ? underMin : 0, overMax > 100 ? overMax : 100] as [number, number];\n\t\t}\n\t\t\n\t\tconst values = data.map((d) => d.y);\n\t\tconst base = [...values];\n\t\t[mean, ucl, lcl, onePos, oneNeg, twoPos, twoNeg].forEach((v) => {\n\t\t\tif (v != null) base.push(v);\n\t\t});\n\t\t\n\t\t// Include any numeric targets so target line never sits outside vertical range\n\t\tif (targetsProp)\n\t\t\ttargetsProp.forEach((t: number | null | undefined) => {\n\t\t\t\tif (typeof t === \"number\" && !isNaN(t)) base.push(t);\n\t\t\t});\n\t\tif (!base.length) return undefined;\n\t\tlet min = Math.min(...base);\n\t\tlet max = Math.max(...base);\n\t\tif (alwaysShowZeroY) min = Math.min(0, min);\n\t\tif (alwaysShowHundredY) max = Math.max(100, max);\n\t\treturn [min, max];\n\n\t}, [data, mean, ucl, lcl, onePos, oneNeg, twoPos, twoNeg, targetsProp, alwaysShowZeroY, alwaysShowHundredY, percentScale]);\n\n\t// Auto-detect percentage unit when all values in [0,1] and no explicit unit supplied\n\tconst autoUnit = React.useMemo(() => {\n\t\tif (unit || narrationContext?.measureUnit) return undefined;\n\t\tif (!data.length) return undefined;\n\t\treturn data.every((d) => d.y >= 0 && d.y <= 1) ? \"%\" : undefined;\n\t}, [unit, narrationContext?.measureUnit, data]);\n\n\tconst effectiveUnit = unit ?? narrationContext?.measureUnit ?? autoUnit;\n\tconst effectiveNarrationContext = React.useMemo(() => {\n\t\treturn effectiveUnit\n\t\t\t? { ...(narrationContext || {}), measureUnit: effectiveUnit }\n\t\t\t: narrationContext;\n\t}, [narrationContext, effectiveUnit]);\n\n\t// Partition markers (after engine available)\n\tconst partitionMarkers = React.useMemo(() => {\n\t\tif (!engine?.rows) return [] as number[];\n\t\tconst markers: number[] = [];\n\t\tfor (let i = 1; i < engine.rows.length; i++) {\n\t\t\tif (engine.rows[i].partitionId !== engine.rows[i - 1].partitionId)\n\t\t\t\tmarkers.push(i);\n\t\t}\n\t\treturn markers;\n\t}, [engine?.rows]);\n\n\t// Derive embedded variation icon (now rendered above chart instead of inside SVG)\n\tconst embeddedIcon = React.useMemo(() => {\n\t\tif (!showEmbeddedIcon || !engine?.rows?.length) return null;\n\t\tconst engineRows = engine.rows;\n\t\t// Suppress embedded icon entirely when insufficient non-ghost points to establish stable limits\n\t\tconst minPoints = settings?.minimumPoints ?? 13;\n\t\tconst nonGhostCount = engineRows.filter(\n\t\t\t(r) => !r.ghost && r.value != null\n\t\t).length;\n\n\t\tif (nonGhostCount < minPoints) return null;\n\t\t// Determine if targets exist (no longer used to suppress placeholder; kept for potential future diagnostics)\n\t\t// const hasAnyTargets = (targetsProp?.some(t => typeof t === 'number' && !isNaN(t as any))) ?? false;\n\t\tlet lastIdx = -1;\n\t\tfor (let i = engineRows.length - 1; i >= 0; i--) {\n\t\t\tconst r = engineRows[i];\n\t\t\tif (r && r.value != null && !r.ghost) {\n\t\t\t\tlastIdx = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (lastIdx === -1) return null;\n\t\tconst lastRow = engineRows[lastIdx];\n\t\tconst variation = lastRow.variationIcon as VariationIcon | undefined;\n\t\tconst canonicalVariation: VariationIcon | undefined = variation;\n\t\tconst assuranceRaw = lastRow.assuranceIcon as AssuranceIcon | undefined;\n\t\tconst hasNeutralSpecialCause =\n\t\t\tcanonicalVariation === VariationIcon.Neither && !!lastRow.specialCauseNeitherValue;\n\t\t\n\t\t// Map engine assurance icon (which can be None) to visual AssuranceResult (None -> Uncertain placeholder glyph)\n\t\tconst assuranceRenderStatus: AssuranceResult =\n\t\t\tassuranceRaw === AssuranceIcon.Pass\n\t\t\t\t? AssuranceResult.Pass\n\t\t\t\t: assuranceRaw === AssuranceIcon.Fail\n\t\t\t\t\t? AssuranceResult.Fail\n\t\t\t\t\t: AssuranceResult.Uncertain;\n\t\t\n\t// Derive a trend/orientation hint for suppressed 'no judgement' cases so the purple arrow points towards the favourable direction\n\t\tlet trend: Direction | undefined = undefined;\n\t\tif (canonicalVariation === VariationIcon.Suppressed) {\n\t\t\t// A suppressed favourable single point will have exactly one of the singlePointUp/Down flags set\n\t\t\tconst singleHigh = lastRow.specialCauseSinglePointUp;\n\t\t\tconst singleLow = lastRow.specialCauseSinglePointDown;\n\t\t\tif (metricImprovement === ImprovementDirection.Up) {\n\t\t\t\t// Higher is favourable: a suppressed high point should orient higher\n\t\t\t\tif (singleHigh) trend = Direction.Higher;\n\t\t\t\telse if (singleLow) trend = Direction.Lower; // defensive (should not be favourable)\n\t\t\t} else if (metricImprovement === ImprovementDirection.Down) {\n\t\t\t\t// Lower is favourable: a suppressed low point should orient lower\n\t\t\t\tif (singleLow) trend = Direction.Lower;\n\t\t\t\telse if (singleHigh) trend = Direction.Higher; // defensive\n\t\t\t} else {\n\t\t\t\t// Neutral metrics: default to higher to preserve legacy layout\n\t\t\t\ttrend = Direction.Higher;\n\t\t\t}\n\t} else if (canonicalVariation === VariationIcon.Neither && hasNeutralSpecialCause) {\n\t\t\t// Neutral special-cause (purple) orientation should reflect side of signal (high-side vs low-side)\n\t\t\tconst anyHighSide =\n\t\t\t\tlastRow.specialCauseSinglePointUp ||\n\t\t\t\tlastRow.specialCauseTwoOfThreeUp ||\n\t\t\t\tlastRow.specialCauseFourOfFiveUp ||\n\t\t\t\tlastRow.specialCauseShiftUp ||\n\t\t\t\tlastRow.specialCauseTrendUp;\n\t\t\tconst anyLowSide =\n\t\t\t\tlastRow.specialCauseSinglePointDown ||\n\t\t\t\tlastRow.specialCauseTwoOfThreeDown ||\n\t\t\t\tlastRow.specialCauseFourOfFiveDown ||\n\t\t\t\tlastRow.specialCauseShiftDown ||\n\t\t\t\tlastRow.specialCauseTrendDown;\n\t\t\tif (anyHighSide && !anyLowSide) trend = Direction.Higher;\n\t\t\telse if (anyLowSide && !anyHighSide) trend = Direction.Lower;\n\t\t\telse trend = Direction.Higher; // conflicting or none -> default higher\n\t\t}\n\t\t\n\t\t// Determine metric polarity for embedded icon (higher/lower/context) based on improvement direction\n\t\t// NB: this is a change from previous behaviour where neutral metrics were marked as 'context dependent'\n\t\t// This better reflects the fact that the direction of the arrows in neutral metrics is purely indicative\n\t\t// and does not reflect any underlying business meaning.\n\t\t// Note: polarity is not currently used in rendering but is included in data attributes for potential future use.\n\t\tlet polarity: MetricPolarity;\n\t\tif (metricImprovement === ImprovementDirection.Up)\n\t\t\tpolarity = MetricPolarity.HigherIsBetter;\n\t\telse if (metricImprovement === ImprovementDirection.Down)\n\t\t\tpolarity = MetricPolarity.LowerIsBetter;\n\t\telse polarity = MetricPolarity.ContextDependent;\n\t\t\n\t\tconst iconSize = 80;\n\t\t\n\t\treturn (\n\t\t\t<div\n\t\t\t\tkey={`embedded-icon-${lastIdx}`}\n\t\t\t\tstyle={{ display: \"flex\", gap: 12, marginRight: 16 }}\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"fdp-spc-chart__embedded-icon\"\n\t\t\t\t\tdata-variation={String(canonicalVariation)}\n\t\t\t\t\tdata-trend-raw={trend ? String(trend) : \"none\"}\n\t\t\t\t\tdata-trend={trend ? String(trend) : \"none\"}\n\t\t\t\t\tdata-polarity={String(polarity ?? \"unknown\")}\n\t\t\t\t\tstyle={{ width: iconSize, height: iconSize }}\n\t\t\t\t>\n\t\t\t\t\t<SPCVariationIcon\n\t\t\t\t\t\tdropShadow={false}\n\t\t\t\t\t\tdata={{\n\t\t\t\t\t\t\tvariationIcon: variation!,\n\t\t\t\t\t\t\timprovementDirection: metricImprovement,\n\t\t\t\t\t\t\tpolarity,\n\t\t\t\t\t\t\tspecialCauseNeutral: hasNeutralSpecialCause,\n\t\t\t\t\t\t\thighSideSignal:\n\t\t\t\t\t\t\t\tlastRow.specialCauseSinglePointUp ||\n\t\t\t\t\t\t\t\t\tlastRow.specialCauseTwoOfThreeUp ||\n\t\t\t\t\t\t\t\t\tlastRow.specialCauseFourOfFiveUp ||\n\t\t\t\t\t\t\t\t\tlastRow.specialCauseShiftUp ||\n\t\t\t\t\t\t\t\t\tlastRow.specialCauseTrendUp,\n\t\t\t\t\t\t\tlowSideSignal:\n\t\t\t\t\t\t\t\tlastRow.specialCauseSinglePointDown ||\n\t\t\t\t\t\t\t\t\tlastRow.specialCauseTwoOfThreeDown ||\n\t\t\t\t\t\t\t\t\tlastRow.specialCauseFourOfFiveDown ||\n\t\t\t\t\t\t\t\t\tlastRow.specialCauseShiftDown ||\n\t\t\t\t\t\t\t\t\tlastRow.specialCauseTrendDown,\n\t\t\t\t\t\t\t...(trend ? { trend } : {}),\n\t\t\t\t\t\t}}\n\t\t\t\t\t\t// Letter semantics: use polarity (business improvement direction) when specified; fall back to signal side for neutral metrics\n\t\t\t\t\t\tletterMode={\n\t\t\t\t\t\t\tmetricImprovement === ImprovementDirection.Neither\n\t\t\t\t\t\t\t\t? LetterMode.Direction\n\t\t\t\t\t\t\t\t: LetterMode.Polarity\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsize={iconSize}\n\t\t\t\t\t\tvariant={embeddedIconVariant}\n\t\t\t\t\t\trunLength={\n\t\t\t\t\t\t\tembeddedIconVariant === SpcEmbeddedIconVariant.TriangleWithRun\n\t\t\t\t\t\t\t\t? embeddedIconRunLength\n\t\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t{/* Always render assurance icon (mapping 'none' -> Uncertain placeholder) for consistent dual-icon display */}\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"fdp-spc-chart__embedded-assurance-icon\"\n\t\t\t\t\tdata-assurance={String(assuranceRaw)}\n\t\t\t\t\tstyle={{ width: iconSize, height: iconSize }}\n\t\t\t\t>\n\t\t\t\t\t<SPCAssuranceIcon\n\t\t\t\t\t\tstatus={assuranceRenderStatus}\n\t\t\t\t\t\tsize={iconSize}\n\t\t\t\t\t\tdropShadow={false}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}, [\n\t\tshowEmbeddedIcon,\n\t\tengine?.rows,\n\t\tmetricImprovement,\n\t\tsettings?.minimumPoints,\n\t\ttargetsProp,\n\t\tembeddedIconVariant,\n\t\tembeddedIconRunLength,\n\t]);\n\n\treturn (\n\t\t<div\n\t\t\tclassName={\n\t\t\t\tclassName\n\t\t\t\t\t? `fdp-spc-chart-wrapper ${className}`\n\t\t\t\t\t: \"fdp-spc-chart-wrapper\"\n\t\t\t}\n\t\t>\n\t\t\t{/* Top row containing right-aligned embedded variation icon */}\n\t\t\t{showEmbeddedIcon && (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"fdp-spc-chart__top-row\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tdisplay: \"flex\",\n\t\t\t\t\t\tjustifyContent: \"flex-end\",\n\t\t\t\t\t\tmarginBottom: 4,\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{embeddedIcon}\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t<ChartRoot\n\t\t\t\theight={height}\n\t\t\t\tariaLabel={ariaLabel}\n\t\t\t\tmargin={{ bottom: 48, left: 56, right: 16, top: 12 }}\n\t\t\t\tclassName={undefined /* avoid duplicating outer class */}\n\t\t\t>\n\t\t\t\t<LineScalesProvider series={series as any} yDomain={yDomain as any}>\n\t\t\t\t\t<InternalSPC\n\t\t\t\t\t\tseries={series as any}\n\t\t\t\t\t\tshowPoints={showPoints}\n\t\t\t\t\t\tannounceFocus={announceFocus}\n\t\t\t\t\t\tlimits={{ mean, ucl, lcl, sigma, onePos, oneNeg, twoPos, twoNeg }}\n\t\t\t\t\t\tshowZones={showZones}\n\t\t\t\t\t\thighlightOutOfControl={highlightOutOfControl}\n\t\t\t\t\t\tengineRows={engine?.rows || null}\n\t\t\t\t\t\tenableRules={enableRules}\n\t\t\t\t\t\tshowIcons={showIcons}\n\t\t\t\t\t\tnarrationContext={effectiveNarrationContext}\n\t\t\t\t\t\tgradientSequences={gradientSequences}\n\t\t\t\t\t\tsequenceTransition={sequenceTransition}\n\t\t\t\t\t\tprocessLineWidth={processLineWidth}\n\t\t\t\t\t\teffectiveUnit={effectiveUnit}\n\t\t\t\t\t\tpartitionMarkers={partitionMarkers}\n\t\t\t\t\t\tariaLabel={ariaLabel}\n\t\t\t\t\t\tenableNeutralNoJudgement={enableNeutralNoJudgement}\n\t\t\t\t\t\tshowTrendGatingExplanation={showTrendGatingExplanation}\n\t\t\t\t\t\ttrendVisualMode={trendVisualMode}\n\t\t\t\t\t\tmetricImprovement={metricImprovement}\n\t\t\t\t\t\tshowTrendStartMarkers={showTrendStartMarkers}\n\t\t\t\t\t\tshowFirstFavourableCrossMarkers={showFirstFavourableCrossMarkers}\n\t\t\t\t\t\tshowTrendBridgeOverlay={showTrendBridgeOverlay}\n\t\t\t\t\t\tshowSignalsInspector={showSignalsInspector}\n\t\t\t\t\t\tonSignalFocus={onSignalFocus}\n\t\t\t\t\t/>\n\t\t\t\t</LineScalesProvider>\n\t\t\t</ChartRoot>\n\t\t\t{source && (\n\t\t\t\t<div className=\"fdp-spc-chart__source\" aria-label=\"Chart data source\">\n\t\t\t\t\t{typeof source === 'string' ? <small>Source: {source}</small> : source}\n\t\t\t\t</div>\n\t\t\t)}\n\t\t\t{/* Live diagnostics announcement (visually hidden) */}\n\t\t\t{showWarningsPanel && diagnosticsMessage && (\n\t\t\t\t<div\n\t\t\t\t\tdata-testid=\"spc-diagnostics-live\"\n\t\t\t\t\taria-live=\"polite\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tposition: \"absolute\",\n\t\t\t\t\t\twidth: 1,\n\t\t\t\t\t\theight: 1,\n\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\tmargin: 0,\n\t\t\t\t\t\toverflow: \"hidden\",\n\t\t\t\t\t\tclip: \"rect(0 0 0 0)\",\n\t\t\t\t\t\twhiteSpace: \"nowrap\",\n\t\t\t\t\t\tborder: 0,\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{diagnosticsMessage}\n\t\t\t\t</div>\n\t\t\t)}\n\t\t\t{showWarningsPanel && filteredWarnings.length > 0 && (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"fdp-spc-chart__warnings\"\n\t\t\t\t\trole=\"region\"\n\t\t\t\t\taria-label=\"SPC diagnostics\"\n\t\t\t\t>\n\t\t\t\t\t<p className=\"fdp-spc-chart__warnings-heading\">Diagnostics</p>\n\t\t\t\t\t<Table\n\t\t\t\t\t\tfirstCellIsHeader={false}\n\t\t\t\t\t\tpanel={false}\n\t\t\t\t\t\tresponsive={false}\n\t\t\t\t\t\thead={[\n\t\t\t\t\t\t\t{ text: \"Severity\" },\n\t\t\t\t\t\t\t{ text: \"Category\" },\n\t\t\t\t\t\t\t{ text: \"Code\" },\n\t\t\t\t\t\t\t{ text: \"Details\" },\n\t\t\t\t\t\t]}\n\t\t\t\t\t\trows={filteredWarnings.map((w) => {\n\t\t\t\t\t\t\tlet severityColor: any = \"grey\";\n\t\t\t\t\t\t\tif (w.severity === SpcWarningSeverity.Error)\n\t\t\t\t\t\t\t\tseverityColor = \"red\";\n\t\t\t\t\t\t\telse if (w.severity === SpcWarningSeverity.Warning)\n\t\t\t\t\t\t\t\tseverityColor = \"orange\";\n\t\t\t\t\t\t\telse if (w.severity === SpcWarningSeverity.Info)\n\t\t\t\t\t\t\t\tseverityColor = \"blue\";\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tnode: (\n\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\tcolor={severityColor}\n\t\t\t\t\t\t\t\t\t\t\ttext={(w.severity ? String(w.severity) : \"Info\").replace(\n\t\t\t\t\t\t\t\t\t\t\t\t/^[a-z]/,\n\t\t\t\t\t\t\t\t\t\t\t\t(c) => c.toUpperCase()\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tclasses:\n\t\t\t\t\t\t\t\t\t\t\"fdp-spc-chart__warning-cell fdp-spc-chart__warning-cell--severity\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tnode: w.category ? (\n\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"purple\"\n\t\t\t\t\t\t\t\t\t\t\ttext={formatWarningCategory(w.category)}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<span className=\"fdp-spc-chart__warning-empty\">\u2013</span>\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tclasses:\n\t\t\t\t\t\t\t\t\t\t\"fdp-spc-chart__warning-cell fdp-spc-chart__warning-cell--category\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tnode: <Tag color=\"grey\" text={formatWarningCode(w.code)} />,\n\t\t\t\t\t\t\t\t\tclasses:\n\t\t\t\t\t\t\t\t\t\t\"fdp-spc-chart__warning-cell fdp-spc-chart__warning-cell--code\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tnode: (\n\t\t\t\t\t\t\t\t\t\t<div className=\"fdp-spc-chart__warning-message\">\n\t\t\t\t\t\t\t\t\t\t\t<span>{w.message}</span>\n\t\t\t\t\t\t\t\t\t\t\t{w.context && Object.keys(w.context).length > 0 && (\n\t\t\t\t\t\t\t\t\t\t\t\t<details\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc-chart__warning-context\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ marginTop: 4 }}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<summary>context</summary>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<pre>{JSON.stringify(w.context, null, 2)}</pre>\n\t\t\t\t\t\t\t\t\t\t\t\t</details>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tclasses:\n\t\t\t\t\t\t\t\t\t\t\"fdp-spc-chart__warning-cell fdp-spc-chart__warning-cell--message\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t})}\n\t\t\t\t\t\tclasses=\"fdp-spc-chart__warnings-table-wrapper\"\n\t\t\t\t\t\ttableClasses=\"fdp-spc-chart__warnings-table\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t);\n};\n\ninterface InternalProps {\n\tseries: { id: string; data: SPCDatum[] }[];\n\tshowPoints: boolean;\n\tannounceFocus: boolean;\n\tlimits: {\n\t\tmean?: number | null;\n\t\tucl?: number | null;\n\t\tlcl?: number | null;\n\t\tsigma: number;\n\t\tonePos?: number | null;\n\t\toneNeg?: number | null;\n\t\ttwoPos?: number | null;\n\t\ttwoNeg?: number | null;\n\t};\n\tshowZones: boolean;\n\thighlightOutOfControl: boolean;\n\tengineRows: any[] | null;\n\tenableRules: boolean;\n\tshowIcons: boolean;\n\tnarrationContext?: {\n\t\tmeasureName?: string;\n\t\tmeasureUnit?: string;\n\t\tdatasetContext?: string;\n\t\torganisation?: string;\n\t\ttimeframe?: string;\n\t\tadditionalNote?: string;\n\t};\n\tmetricImprovement?: ImprovementDirection;\n\tgradientSequences: boolean;\n\tsequenceTransition: SequenceTransition;\n\tprocessLineWidth: number;\n\teffectiveUnit?: string;\n\tpartitionMarkers: number[];\n\tariaLabel?: string;\n\t// Feature flags to control neutral purple and gating explanation behaviour\n\tenableNeutralNoJudgement?: boolean;\n\tshowTrendGatingExplanation?: boolean;\n\t/** Visual mode for trend colouring: 'ungated' (directional colours even before crossing mean) or 'gated' (neutral purple until favourable side). */\n\ttrendVisualMode?: TrendVisualMode;\n\t// UI overlays\n\tshowTrendStartMarkers?: boolean;\n\tshowFirstFavourableCrossMarkers?: boolean;\n\tshowTrendBridgeOverlay?: boolean;\n\tshowSignalsInspector?: boolean;\n\t/** UI-only: when Signals Inspector is shown, notify on focus changes. */\n\tonSignalFocus?: (info: SPCSignalFocusInfo) => void;\n}\n\nconst InternalSPC: React.FC<InternalProps> = ({\n\tseries,\n\tshowPoints,\n\tannounceFocus,\n\tlimits,\n\tshowZones,\n\thighlightOutOfControl,\n\tengineRows,\n\tenableRules,\n\tshowIcons,\n\tnarrationContext,\n\tgradientSequences,\n\tsequenceTransition,\n\tprocessLineWidth,\n\teffectiveUnit,\n\tpartitionMarkers,\n\tariaLabel,\n\tmetricImprovement,\n\tenableNeutralNoJudgement = true,\n\tshowTrendGatingExplanation = true,\n\ttrendVisualMode = TrendVisualMode.Ungated,\n\tshowTrendStartMarkers = false,\n\tshowFirstFavourableCrossMarkers = false,\n\tshowTrendBridgeOverlay = false,\n\tshowSignalsInspector = false,\n\tonSignalFocus,\n}) => {\n\tconst scaleCtx = useScaleContext();\n\tconst chartCtx = useChartContext();\n\tif (!scaleCtx) return null;\n\tconst { xScale, yScale } = scaleCtx;\n\t// Stable unique base ID for gradient defs per chart instance (prevents MDX multi-chart ID collisions)\n\tconst gradientIdBaseRef = React.useRef<string>(\n\t\t\"spc-seq-\" + ++spcSequenceInstanceCounter\n\t);\n\tconst tooltipCtx = useTooltipContext();\n\tconst all = series[0]?.data || [];\n\tconst outOfControl = React.useMemo(() => {\n\t\tif (!limits.ucl && !limits.lcl) return new Set<number>();\n\t\tconst set = new Set<number>();\n\t\tall.forEach((d, i) => {\n\t\t\tif (\n\t\t\t\t(limits.ucl != null && d.y > limits.ucl) ||\n\t\t\t\t(limits.lcl != null && d.y < limits.lcl)\n\t\t\t)\n\t\t\t\tset.add(i);\n\t\t});\n\t\treturn set;\n\t}, [all, limits.ucl, limits.lcl]);\n\n\t// Map engine row signals by index (rowId is 1-based, order preserved relative to data input)\n\tconst engineSignals = React.useMemo(() => {\n\t\tif (!engineRows) return null;\n\t\tconst map: Record<\n\t\t\tnumber,\n\t\t\t{\n\t\t\t\tvariation?: VariationIcon;\n\t\t\t\tassurance?: AssuranceIcon;\n\t\t\t\tspecial?: boolean;\n\t\t\t\tconcern?: boolean;\n\t\t\t\timprovement?: boolean;\n\t\t\t\ttrendUp?: boolean;\n\t\t\t\ttrendDown?: boolean;\n\t\t\t}\n\t\t> = {};\n\t\tengineRows.forEach((r, idx) => {\n\t\t\tif (r.value == null || r.ghost) return;\n\t\t\tconst anySpecial =\n\t\t\t\tr.specialCauseSinglePointUp ||\n\t\t\t\tr.specialCauseSinglePointDown ||\n\t\t\t\tr.specialCauseTwoOfThreeUp ||\n\t\t\t\tr.specialCauseTwoOfThreeDown ||\n\t\t\t\tr.specialCauseFourOfFiveUp ||\n\t\t\t\tr.specialCauseFourOfFiveDown ||\n\t\t\t\tr.specialCauseShiftUp ||\n\t\t\t\tr.specialCauseShiftDown ||\n\t\t\t\tr.specialCauseTrendUp ||\n\t\t\t\tr.specialCauseTrendDown;\n\t\t\tmap[idx] = {\n\t\t\t\tvariation: r.variationIcon,\n\t\t\t\tassurance: r.assuranceIcon,\n\t\t\t\tspecial: anySpecial,\n\t\t\t\tconcern: r.variationIcon === VariationIcon.Concern,\n\t\t\t\timprovement: r.variationIcon === VariationIcon.Improvement,\n\t\t\t\ttrendUp: !!r.specialCauseTrendUp,\n\t\t\t\ttrendDown: !!r.specialCauseTrendDown,\n\t\t\t};\n\t\t});\n\t\treturn map;\n\t}, [engineRows]);\n\n\t// Derive a single uniform target (most common current usage) for drawing a horizontal reference line.\n\tconst uniformTarget = React.useMemo(() => {\n\t\tif (!engineRows || !engineRows.length) return null;\n\t\tconst values: number[] = [];\n\t\tfor (const r of engineRows) {\n\t\t\tif (typeof r.target === \"number\" && !isNaN(r.target))\n\t\t\t\tvalues.push(r.target);\n\t\t}\n\t\tif (!values.length) return null;\n\t\tconst first = values[0];\n\t\treturn values.every((v) => v === first) ? first : null; // only render when constant across series\n\t}, [engineRows]);\n\n\t// Preprocess categories with singleton coloured point absorption\n\t// Added 'noJudgement' (purple) for neutral special-cause sequences (variation === Neither & special cause present)\n\tconst categories = React.useMemo(() => {\n\t\tif (!engineSignals || !all.length)\n\t\t\treturn [] as SpcGradientCategory[];\n\t\tconst raw: SpcGradientCategory[] =\n\t\t\tall.map((_d, i) => {\n\t\t\t\tconst sig = engineSignals?.[i];\n\t\t\t\tif (sig?.concern) return SpcGradientCategory.Concern;\n\t\t\t\tif (sig?.improvement) return SpcGradientCategory.Improvement;\n\t\t\t\t// When variation is Neither but a trend rule fired, allow visual directional colours in 'ungated' mode\n\t\t\t\tif (sig?.special && sig.variation === VariationIcon.Neither) {\n\t\t\t\t\tif (trendVisualMode === TrendVisualMode.Ungated && metricImprovement && metricImprovement !== ImprovementDirection.Neither) {\n\t\t\t\t\t\tif (sig.trendUp) {\n\t\t\t\t\t\t\treturn metricImprovement === ImprovementDirection.Up ? SpcGradientCategory.Improvement : SpcGradientCategory.Concern;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (sig.trendDown) {\n\t\t\t\t\t\t\treturn metricImprovement === ImprovementDirection.Down ? SpcGradientCategory.Improvement : SpcGradientCategory.Concern;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// Fallback: neutral purple when enabled\n\t\t\t\t\tif (enableNeutralNoJudgement) return SpcGradientCategory.NoJudgement;\n\t\t\t\t}\n\t\t\t\treturn SpcGradientCategory.Common;\n\t\t\t});\n\n\t\t// Debug logging for Rule Clash charts\n\t\tconst isRuleClash = ariaLabel?.includes(\"Rule Clash\");\n\t\tif (isRuleClash) {\n\t\t\tconsole.log(\n\t\t\t\t`[${ariaLabel}] Raw categories:`,\n\t\t\t\traw.map((cat, i) => `${i}:${cat}(${all[i].y})`).join(\", \")\n\t\t\t);\n\t\t}\n\n\t\treturn raw;\n\t}, [engineSignals, all, ariaLabel, enableNeutralNoJudgement, trendVisualMode, metricImprovement]);\n\n\t// Derive contiguous sequences after absorption\n\tconst sequences = React.useMemo(() => {\n\t\tif (!gradientSequences || !categories.length)\n\t\t\treturn [] as {\n\t\t\t\tstart: number;\n\t\t\t\tend: number;\n\t\t\t\tcategory: SpcGradientCategory;\n\t\t\t}[];\n\t\t// Copy categories so we can absorb single coloured points unconditionally\n\t\tconst cats = [...categories];\n\t\t// Absorb ANY single coloured point (length-1 run) regardless of neighbours\n\t\tlet i = 0;\n\t\twhile (i < cats.length) {\n\t\t\tconst cat = cats[i];\n\t\t\tlet j = i + 1;\n\t\t\twhile (j < cats.length && cats[j] === cat) j++;\n\t\t\tconst runLen = j - i;\n\t\t\tif (runLen === 1 && cat !== SpcGradientCategory.Common) {\n\t\t\t\tcats[i] = SpcGradientCategory.Common;\n\t\t\t}\n\t\t\ti = j;\n\t\t}\n\t\t// Build sequences (coloured runs must be length >=2 after absorption)\n\t\tconst out: {\n\t\t\tstart: number;\n\t\t\tend: number;\n\t\t\tcategory: SpcGradientCategory;\n\t\t}[] = [];\n\t\tif (cats.length) {\n\t\t\tlet start = 0;\n\t\t\tfor (let k = 1; k <= cats.length; k++) {\n\t\t\t\tif (k === cats.length || cats[k] !== cats[start]) {\n\t\t\t\t\tconst runCat = cats[start];\n\t\t\t\t\tconst end = k - 1;\n\t\t\t\t\tconst len = end - start + 1;\n\t\t\t\t\tif (runCat === SpcGradientCategory.Common || len >= 2)\n\t\t\t\t\t\tout.push({ start, end, category: runCat });\n\t\t\t\t\tstart = k;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconst isRuleClash = ariaLabel?.includes(\"Rule Clash\");\n\t\tif (isRuleClash) {\n\t\t\tconsole.log(\n\t\t\t\t`[${ariaLabel}] Final sequences:`,\n\t\t\t\tout.map((s) => `${s.start}-${s.end}:${s.category}`).join(\", \")\n\t\t\t);\n\t\t}\n\t\treturn out;\n\t}, [gradientSequences, categories, ariaLabel]);\n\n\t// Precompute x positions for boundary calculations (after scales + data available)\n\tconst xPositions = React.useMemo(\n\t\t() => all.map((d) => xScale(d.x instanceof Date ? d.x : new Date(d.x))),\n\t\t[all, xScale]\n\t);\n\tconst plotWidth = xScale.range()[1];\n\n\t// Compute basic trend insights (UI-only) from engine rows\n\tconst trendInsights = React.useMemo(() => {\n\t\tif (!engineRows || !engineRows.length) return null as null | {\n\t\t\tdirection: 'up' | 'down';\n\t\t\tdetectedAt: number; // index in series\n\t\t\tfirstFavourableCrossAt: number | null;\n\t\t\tpersistedAcrossMean: boolean;\n\t\t};\n\t\t// Find earliest trend window across up/down\n\t\tlet earliestUp = Number.POSITIVE_INFINITY;\n\t\tlet earliestDown = Number.POSITIVE_INFINITY;\n\t\tengineRows.forEach((r, i) => {\n\t\t\tif (r.specialCauseTrendUp) earliestUp = Math.min(earliestUp, i);\n\t\t\tif (r.specialCauseTrendDown) earliestDown = Math.min(earliestDown, i);\n\t\t});\n\t\tif (!Number.isFinite(earliestUp) && !Number.isFinite(earliestDown)) return null;\n\t\tconst useUp = earliestUp <= earliestDown;\n\t\tconst direction: 'up' | 'down' = useUp ? 'up' : 'down';\n\t\tconst detectedAt = useUp ? earliestUp : earliestDown;\n\t\t// Determine favourable side relative to metricImprovement and row mean\n\t\tconst isFavourable = (row: any): boolean => {\n\t\t\tif (metricImprovement == null || metricImprovement === ImprovementDirection.Neither) return false;\n\t\t\tif (row == null || typeof row.value !== 'number' || typeof row.mean !== 'number') return false;\n\t\t\tif (direction === 'up') {\n\t\t\t\treturn metricImprovement === ImprovementDirection.Up ? row.value > row.mean : row.value < row.mean;\n\t\t\t}\n\t\t\t// direction === 'down'\n\t\t\treturn metricImprovement === ImprovementDirection.Down ? row.value < row.mean : row.value > row.mean;\n\t\t};\n\t\tlet firstFavourableCrossAt: number | null = null;\n\t\tfor (let i = detectedAt; i < engineRows.length; i++) {\n\t\t\tconst r = engineRows[i];\n\t\t\tconst flagged = useUp ? !!r.specialCauseTrendUp : !!r.specialCauseTrendDown;\n\t\t\tif (!flagged) break; // end of contiguous trend window span\n\t\t\tif (isFavourable(r)) { firstFavourableCrossAt = i; break; }\n\t\t}\n\t\tlet persistedAcrossMean = false;\n\t\tif (firstFavourableCrossAt != null) {\n\t\t\tlet favourableCount = 0;\n\t\t\tfor (let i = firstFavourableCrossAt; i < engineRows.length; i++) {\n\t\t\t\tconst r = engineRows[i];\n\t\t\t\tconst flagged = useUp ? !!r.specialCauseTrendUp : !!r.specialCauseTrendDown;\n\t\t\t\tif (!flagged) break;\n\t\t\t\tif (isFavourable(r)) favourableCount++;\n\t\t\t}\n\t\t\tpersistedAcrossMean = favourableCount >= 2;\n\t\t}\n\t\treturn { direction, detectedAt, firstFavourableCrossAt, persistedAcrossMean };\n\t}, [engineRows, metricImprovement]);\n\n\t// Build horizontal line segments for limits that can change across partitions (means/limits per row)\n\tconst limitSegments = React.useMemo(() => {\n\t\tif (!engineRows || !engineRows.length) return null;\n\t\t// Helper to extract segments for a given numeric accessor key present on each row\n\t\tconst build = (key: keyof (typeof engineRows)[number]) => {\n\t\t\tconst segs: { x1: number; x2: number; y: number }[] = [];\n\t\t\tlet start: number | null = null;\n\t\t\tlet current: number | null = null;\n\t\t\tfor (let i = 0; i < engineRows.length; i++) {\n\t\t\t\tconst row = engineRows[i];\n\t\t\t\tconst v = typeof row[key] === \"number\" ? (row[key] as number) : null;\n\t\t\t\tif (v == null || isNaN(v)) {\n\t\t\t\t\t// flush any active segment\n\t\t\t\t\tif (start !== null && current != null) {\n\t\t\t\t\t\tsegs.push({\n\t\t\t\t\t\t\tx1: xPositions[start],\n\t\t\t\t\t\t\tx2: xPositions[i - 1],\n\t\t\t\t\t\t\ty: yScale(current),\n\t\t\t\t\t\t});\n\t\t\t\t\t\tstart = null;\n\t\t\t\t\t\tcurrent = null;\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (start === null) {\n\t\t\t\t\tstart = i;\n\t\t\t\t\tcurrent = v;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t// continue segment if value unchanged (within epsilon) else close & start new\n\t\t\t\tconst EPS = 1e-9;\n\t\t\t\tif (current != null && Math.abs(v - current) <= EPS) {\n\t\t\t\t\t// still same segment\n\t\t\t\t} else {\n\t\t\t\t\t// close previous\n\t\t\t\t\tif (current != null) {\n\t\t\t\t\t\tsegs.push({\n\t\t\t\t\t\t\tx1: xPositions[start],\n\t\t\t\t\t\t\tx2: xPositions[i - 1],\n\t\t\t\t\t\t\ty: yScale(current),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tstart = i;\n\t\t\t\t\tcurrent = v;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (start !== null && current != null) {\n\t\t\t\tsegs.push({\n\t\t\t\t\tx1: xPositions[start],\n\t\t\t\t\tx2: xPositions[engineRows.length - 1],\n\t\t\t\t\ty: yScale(current),\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn segs;\n\t\t};\n\t\treturn {\n\t\t\tmean: build(\"mean\"),\n\t\t\tucl: build(\"upperProcessLimit\"),\n\t\t\tlcl: build(\"lowerProcessLimit\"),\n\t\t\tonePos: build(\"upperOneSigma\"),\n\t\t\toneNeg: build(\"lowerOneSigma\"),\n\t\t\ttwoPos: build(\"upperTwoSigma\"),\n\t\t\ttwoNeg: build(\"lowerTwoSigma\"),\n\t\t};\n\t}, [engineRows, xPositions, yScale]);\n\n\t// Build gradient definitions + rects\n\tconst sequenceDefs = React.useMemo(() => {\n\t\tif (!sequences.length) return null;\n\t\treturn (\n\t\t\t<defs>\n\t\t\t\t{/* Reusable common-cause gradient for transition wedges between coloured sequences */}\n\t\t\t\t<linearGradient id={`${gradientIdBaseRef.current}-grad-common`} x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n\t\t\t\t\t<stop offset=\"0%\" stopColor={\"var(--nhs-fdp-color-data-viz-spc-common-cause, #A6A6A6)\"} stopOpacity={0.28} />\n\t\t\t\t\t<stop offset=\"70%\" stopColor={\"var(--nhs-fdp-color-data-viz-spc-common-cause, #A6A6A6)\"} stopOpacity={0.12} />\n\t\t\t\t\t<stop offset=\"100%\" stopColor={\"var(--nhs-fdp-color-data-viz-spc-common-cause, #A6A6A6)\"} stopOpacity={0.045} />\n\t\t\t\t</linearGradient>\n\t\t\t\t{sequences.map((seq, idx) => {\n\t\t\t\t\tconst id = `${gradientIdBaseRef.current}-grad-${idx}`;\n\t\t\t\t\tlet baseVar: string;\n\t\t\t\t\tlet top = 0.28,\n\t\t\t\t\t\tmid = 0.12,\n\t\t\t\t\t\tend = 0.045; // default (grey/common)\n\t\t\t\t\tswitch (seq.category) {\n\t\t\t\t\t\tcase SpcGradientCategory.Concern:\n\t\t\t\t\t\t\tbaseVar = \"var(--nhs-fdp-color-data-viz-spc-concern, #E46C0A)\";\n\t\t\t\t\t\t\t// stronger wash for coloured sequences\n\t\t\t\t\t\t\ttop = 0.28;\n\t\t\t\t\t\t\tmid = 0.12;\n\t\t\t\t\t\t\tend = 0.045;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase SpcGradientCategory.Improvement:\n\t\t\t\t\t\t\tbaseVar =\n\t\t\t\t\t\t\t\t\"var(--nhs-fdp-color-data-viz-spc-improvement, #00B0F0)\";\n\t\t\t\t\t\t\ttop = 0.26;\n\t\t\t\t\t\t\tmid = 0.11;\n\t\t\t\t\t\t\tend = 0.045;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase SpcGradientCategory.NoJudgement:\n\t\t\t\t\t\t\tbaseVar =\n\t\t\t\t\t\t\t\t\"var(--nhs-fdp-color-data-viz-spc-no-judgement, #490092)\";\n\t\t\t\t\t\t\t// Use similar opacity profile to improvement for balance\n\t\t\t\t\t\t\ttop = 0.26;\n\t\t\t\t\t\t\tmid = 0.11;\n\t\t\t\t\t\t\tend = 0.045;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tbaseVar =\n\t\t\t\t\t\t\t\t\"var(--nhs-fdp-color-data-viz-spc-common-cause, #A6A6A6)\";\n\t\t\t\t\t}\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<linearGradient key={id} id={id} x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n\t\t\t\t\t\t\t<stop offset=\"0%\" stopColor={baseVar} stopOpacity={top} />\n\t\t\t\t\t\t\t<stop offset=\"70%\" stopColor={baseVar} stopOpacity={mid} />\n\t\t\t\t\t\t\t<stop offset=\"100%\" stopColor={baseVar} stopOpacity={end} />\n\t\t\t\t\t\t</linearGradient>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</defs>\n\t\t);\n\t}, [sequences]);\n\n\tconst sequenceAreas = React.useMemo(() => {\n\t\tif (!sequences.length) return null;\n\n\t\tconst [domainMin] = yScale.domain();\n\t\tconst baseY = yScale(domainMin);\n\n\t\tconst areas = sequences\n\t\t\t.map((seq, idx) => {\n\t\t\t\tconst { start: firstIdx, end: lastIdx, category } = seq;\n\n\t\t\t\tif (firstIdx < 0 || lastIdx >= xPositions.length || firstIdx > lastIdx)\n\t\t\t\t\treturn null;\n\n\t\t\t\tconst firstX = xPositions[firstIdx];\n\t\t\t\tconst lastX = xPositions[lastIdx];\n\n\t\t\t\tlet d = \"\";\n\n\t\t\t\tif (category === SpcGradientCategory.Common) {\n\t\t\t\t\t// --- Common Cause (Grey) Gradient ---\n\t\t\t\t\tconst prevSeq = idx > 0 ? sequences[idx - 1] : null;\n\t\t\t\t\tconst nextSeq = idx < sequences.length - 1 ? sequences[idx + 1] : null;\n\n\t\t\t\t\tconst leftX = prevSeq ? xPositions[prevSeq.end] : 0;\n\t\t\t\t\tconst leftY = prevSeq ? yScale(all[prevSeq.end].y) : baseY;\n\n\t\t\t\t\tconst rightX = nextSeq ? xPositions[nextSeq.start] : plotWidth;\n\t\t\t\t\tconst rightY = nextSeq ? yScale(all[nextSeq.start].y) : baseY;\n\n\t\t\t\t\td = `M ${leftX} ${baseY}`;\n\t\t\t\t\td += ` L ${leftX} ${leftY}`;\n\n\t\t\t\t\tfor (let i = firstIdx; i <= lastIdx; i++) {\n\t\t\t\t\t\td += ` L ${xPositions[i]} ${yScale(all[i].y)}`;\n\t\t\t\t\t}\n\n\t\t\t\t\td += ` L ${rightX} ${rightY}`;\n\t\t\t\t\td += ` L ${rightX} ${baseY} Z`;\n\t\t\t\t} else {\n\t\t\t\t\t// --- Special Cause (Colored) Gradient ---\n\t\t\t\t\tconst prevSeq = idx > 0 ? sequences[idx - 1] : null;\n\t\t\t\t\tconst nextSeq = idx < sequences.length - 1 ? sequences[idx + 1] : null;\n\t\t\t\t\tconst prevColoured = prevSeq && prevSeq.category !== SpcGradientCategory.Common;\n\t\t\t\t\tconst nextColoured = nextSeq && nextSeq.category !== SpcGradientCategory.Common;\n\t\t\t\t\tconst firstY = yScale(all[firstIdx].y);\n\t\t\t\t\tconst lastY = yScale(all[lastIdx].y);\n\t\t\t\t\tlet startBaselineX = firstX;\n\t\t\t\t\tlet endBaselineX = lastX;\n\n\t\t\t\t\t// Start logic based on transition mode\n\t\t\t\t\tif (prevColoured) {\n\t\t\t\t\t\tconst prevX = xPositions[prevSeq!.end];\n\t\t\t\t\t\tconst prevY = yScale(all[prevSeq!.end].y);\n\t\t\t\t\t\tconst deltaPrev = all[firstIdx].y - all[prevSeq!.end].y;\n\t\t\t\t\t\tif (sequenceTransition === SequenceTransition.Slope && deltaPrev > 0) {\n\t\t\t\t\t\t\t// slope: rising -> attribute join to current colour\n\t\t\t\t\t\t\td = `M ${prevX} ${prevY} L ${firstX} ${firstY}`;\n\t\t\t\t\t\t\tstartBaselineX = prevX;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// neutral/extend/slope (falling or flat): start from baseline at first point\n\t\t\t\t\t\t\td = `M ${firstX} ${baseY} L ${firstX} ${firstY}`;\n\t\t\t\t\t\t\tstartBaselineX = firstX;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// no coloured predecessor\n\t\t\t\t\t\td = `M ${firstX} ${baseY} L ${firstX} ${firstY}`;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (let i = firstIdx + 1; i <= lastIdx; i++) {\n\t\t\t\t\t\td += ` L ${xPositions[i]} ${yScale(all[i].y)}`;\n\t\t\t\t\t}\n\t\t\t\t\t// Ensure path includes last point explicitly\n\t\t\t\t\td += ` L ${lastX} ${lastY}`;\n\n\t\t\t\t\t// End logic based on transition mode\n\t\t\t\t\tif (nextColoured) {\n\t\t\t\t\t\tconst nextFirstX = xPositions[nextSeq!.start];\n\t\t\t\t\t\tconst nextFirstY = yScale(all[nextSeq!.start].y);\n\t\t\t\t\t\tconst deltaNext = all[nextSeq!.start].y - all[lastIdx].y;\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t(sequenceTransition === SequenceTransition.Slope && deltaNext <= 0) ||\n\t\t\t\t\t\t\tsequenceTransition === SequenceTransition.Extend\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t// attribute join to current (previous) colour by extending to next first\n\t\t\t\t\t\t\td += ` L ${nextFirstX} ${nextFirstY}`;\n\t\t\t\t\t\t\tendBaselineX = nextFirstX;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Baseline closure\n\t\t\t\t\td += ` L ${endBaselineX} ${baseY}`;\n\t\t\t\t\td += ` L ${startBaselineX} ${baseY} Z`;\n\n\t\t\t\t\t// For neutral mode, insert a grey wedge at the start boundary (previous coloured -> current coloured)\n\t\t\t\t\tif (sequenceTransition === SequenceTransition.Neutral && prevColoured) {\n\t\t\t\t\t\tconst prevX = xPositions[prevSeq!.end];\n\t\t\t\t\t\tconst prevY = yScale(all[prevSeq!.end].y);\n\t\t\t\t\t\tconst wedge = (\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\tkey={`seq-wedge-${idx}`}\n\t\t\t\t\t\t\t\td={`M ${prevX} ${baseY} L ${prevX} ${prevY} L ${firstX} ${firstY} L ${firstX} ${baseY} Z`}\n\t\t\t\t\t\t\t\tfill={`url(#${gradientIdBaseRef.current}-grad-common)`}\n\t\t\t\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\t\t\t\tclassName=\"fdp-spc__sequence-bg\"\n\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<g key={`seq-group-${idx}`}>\n\t\t\t\t\t\t\t\t{wedge}\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\tkey={`seq-area-${idx}`}\n\t\t\t\t\t\t\t\t\td={d}\n\t\t\t\t\t\t\t\t\tfill={`url(#${gradientIdBaseRef.current}-grad-${idx})`}\n\t\t\t\t\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc__sequence-bg\"\n\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn (\n\t\t\t\t\t<path\n\t\t\t\t\t\tkey={`seq-area-${idx}`}\n\t\t\t\t\t\td={d}\n\t\t\t\t\t\tfill={`url(#${gradientIdBaseRef.current}-grad-${idx})`}\n\t\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\t\tclassName=\"fdp-spc__sequence-bg\"\n\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t})\n\t\t\t.filter(Boolean);\n\n\t\treturn <g className=\"fdp-spc__sequence-bgs\">{areas}</g>;\n\t}, [sequences, xPositions, plotWidth, yScale, all, sequenceTransition]);\n\n\t// Live region formatter (invoked only when announceFocus prop true)\n\t// Derive descriptive timeframe if not explicitly provided\n\tconst computedTimeframe = React.useMemo(() => {\n\t\tif (!narrationContext?.timeframe && all.length >= 2) {\n\t\t\tconst xs = all.map((d) => (d.x instanceof Date ? d.x : new Date(d.x)));\n\t\t\tconst min = new Date(Math.min(...xs.map((d) => d.getTime())));\n\t\t\tconst max = new Date(Math.max(...xs.map((d) => d.getTime())));\n\t\t\tconst diffDays =\n\t\t\t\tMath.round((max.getTime() - min.getTime()) / 86400000) || 0;\n\t\t\tif (diffDays < 14)\n\t\t\t\treturn `The chart shows a timeframe of ${diffDays + 1} days`;\n\t\t\tconst weeks = Math.round(diffDays / 7);\n\t\t\tif (weeks < 20) return `The chart shows a timeframe of ${weeks} weeks`;\n\t\t\tconst months =\n\t\t\t\t(max.getFullYear() - min.getFullYear()) * 12 +\n\t\t\t\t(max.getMonth() - min.getMonth()) +\n\t\t\t\t1; // inclusive months span\n\t\t\treturn `The chart shows a timeframe of ${months} months`;\n\t\t}\n\t\tif (narrationContext?.timeframe) {\n\t\t\treturn `The chart shows a timeframe of ${narrationContext.timeframe}`;\n\t\t}\n\t\treturn undefined;\n\t}, [narrationContext?.timeframe, all]);\n\n\tconst ordinal = (n: number) => {\n\t\tconst mod10 = n % 10,\n\t\t\tmod100 = n % 100;\n\t\tif (mod10 === 1 && mod100 !== 11) return `${n}st`;\n\t\tif (mod10 === 2 && mod100 !== 12) return `${n}nd`;\n\t\tif (mod10 === 3 && mod100 !== 13) return `${n}rd`;\n\t\treturn `${n}th`;\n\t};\n\tconst formatDateLong = (d: Date) =>\n\t\t`${ordinal(d.getDate())} ${d.toLocaleString(\"en-GB\", { month: \"long\" })}, ${d.getFullYear()}`;\n\n\tconst formatLive = React.useCallback(\n\t\t({\n\t\t\tindex,\n\t\t\tx,\n\t\t\ty,\n\t\t}: {\n\t\t\tseriesId: string;\n\t\t\tx: Date;\n\t\t\ty: number;\n\t\t\tindex: number;\n\t\t}) => {\n\t\t\tconst row = engineRows?.[index];\n\t\t\tconst dateObj = x instanceof Date ? x : new Date(x);\n\t\t\tconst dateLabel = formatDateLong(dateObj);\n\t\t\tconst unit = narrationContext?.measureUnit\n\t\t\t\t? ` ${narrationContext.measureUnit}`\n\t\t\t\t: \"\";\n\t\t\tconst measure = narrationContext?.measureName\n\t\t\t\t? ` ${narrationContext.measureName}`\n\t\t\t\t: \"\";\n\t\t\tif (!row) {\n\t\t\t\treturn `General summary is: ${computedTimeframe ? computedTimeframe + \". \" : \"\"}Point ${index + 1}, ${dateLabel}, ${y}${unit}${measure}`;\n\t\t\t}\n\t\t\tconst varLabel = variationLabel(row.variationIcon) || \"Variation\";\n\t\t\tconst ruleIds = extractRuleIds(row);\n\t\t\tconst ruleNarr = ruleIds.length\n\t\t\t\t? ` Rules: ${[...new Set(ruleIds.map((r) => ruleGlossary[r].narration))].join(\"; \")}.`\n\t\t\t\t: \" No special cause rules.\";\n\t\t\tconst ctxParts: string[] = [];\n\t\t\tif (narrationContext?.measureName)\n\t\t\t\tctxParts.push(`Measure: ${narrationContext.measureName}.`);\n\t\t\tif (narrationContext?.datasetContext)\n\t\t\t\tctxParts.push(`${narrationContext.datasetContext}.`);\n\t\t\tif (narrationContext?.organisation)\n\t\t\t\tctxParts.push(`Organisation: ${narrationContext.organisation}.`);\n\t\t\tif (narrationContext?.additionalNote)\n\t\t\t\tctxParts.push(narrationContext.additionalNote);\n\t\t\treturn [\n\t\t\t\t`General summary is:`,\n\t\t\t\t...ctxParts,\n\t\t\t\t`Point ${index + 1} recorded on `,\n\t\t\t\tdateLabel + \",\",\n\t\t\t\t`with a value of ${y} ${unit}${measure}`,\n\t\t\t\tvarLabel + \".\",\n\t\t\t\truleNarr,\n\t\t\t]\n\t\t\t\t.join(\" \")\n\t\t\t\t.replace(/\\s+/g, \" \")\n\t\t\t\t.trim();\n\t\t},\n\t\t[engineRows, narrationContext, computedTimeframe]\n\t);\n\n\t// Per-point aria-description (long form) reusing formatLive but omitting leading \"Point N\" for brevity.\n\tconst describePoint = React.useCallback(\n\t\t(index: number, d: SPCDatum): string | undefined => {\n\t\t\tconst row = engineRows?.[index];\n\t\t\tif (!row) return undefined;\n\t\t\tconst base = formatLive({\n\t\t\t\tindex,\n\t\t\t\tseriesId: \"process\",\n\t\t\t\tx: d.x instanceof Date ? d.x : new Date(d.x),\n\t\t\t\ty: d.y,\n\t\t\t});\n\t\t\t// Remove leading \"Point N \" if present to reduce repetition when screen reader announces label then description.\n\t\t\treturn base\n\t\t\t\t.replace(/^General summary is:\\s*/, \"\")\n\t\t\t\t.replace(/^Point \\d+\\s*/, \"\");\n\t\t},\n\t\t[engineRows, formatLive]\n\t);\n\n\treturn (\n\t\t<TooltipProvider>\n\t\t\t<div\n\t\t\t\tclassName=\"fdp-spc-chart\"\n\t\t\t\trole=\"group\"\n\t\t\t\taria-label=\"Statistical process control chart\"\n\t\t\t\taria-roledescription=\"chart\"\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\twidth={scaleCtx.xScale.range()[1] + 56 + 16}\n\t\t\t\t\theight={scaleCtx.yScale.range()[0] + 12 + 48}\n\t\t\t\t\trole=\"img\"\n\t\t\t\t>\n\t\t\t\t\t<g transform={`translate(56,12)`}>\n\t\t\t\t\t\t<Axis type=\"x\" />\n\t\t\t\t\t\t<Axis type=\"y\" />\n\t\t\t\t\t\t<GridLines axis=\"y\" />\n\t\t\t\t\t\t{sequenceDefs}\n\t\t\t\t\t\t{sequenceAreas}\n\t\t\t\t\t\t{partitionMarkers.map((idx: number, i: number) => {\n\t\t\t\t\t\t\tconst d = all[idx];\n\t\t\t\t\t\t\tif (!d) return null;\n\t\t\t\t\t\t\tconst x = xScale(d.x instanceof Date ? d.x : new Date(d.x));\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\t\tkey={`partition-marker-${i}`}\n\t\t\t\t\t\t\t\t\tx1={x}\n\t\t\t\t\t\t\t\t\tx2={x}\n\t\t\t\t\t\t\t\t\ty1={0}\n\t\t\t\t\t\t\t\t\ty2={yScale.range()[0]}\n\t\t\t\t\t\t\t\t\tstroke=\"#555\"\n\t\t\t\t\t\t\t\t\tstrokeDasharray=\"4 4\"\n\t\t\t\t\t\t\t\t\tstrokeWidth={1}\n\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc__partition-marker\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t\t\t{/* Partition-aware mean (centre line) rendering with curved joins between recalculations */}\n\t\t\t\t\t\t{limitSegments?.mean.length ? (() => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<g aria-hidden=\"true\" className=\"fdp-spc__cl-group\">\n\t\t\t\t\t\t\t\t\t{limitSegments.mean.map((s,i) => (\n\t\t\t\t\t\t\t\t\t\t<line key={`mean-${i}`} className=\"fdp-spc__cl\" x1={s.x1} x2={s.x2} y1={s.y} y2={s.y} />\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t{limitSegments.mean.map((s,i) => {\n\t\t\t\t\t\t\t\t\t\tif (i === limitSegments.mean.length - 1) return null;\n\t\t\t\t\t\t\t\t\t\tconst next = limitSegments.mean[i+1];\n\t\t\t\t\t\t\t\t\t\tif (!next) return null;\n\t\t\t\t\t\t\t\t\t\tif (s.y === next.y) return null; // no join needed if level unchanged\n\t\t\t\t\t\t\t\t\t\tconst gap = Math.max(4, (next.x1 - s.x2) || 0); // pixel gap (may be 0 if contiguous)\n\t\t\t\t\t\t\t\t\t\tconst k = gap * 0.5; // control point offset\n\t\t\t\t\t\t\t\t\t\t// Build cubic bezier from end of current to start of next\n\t\t\t\t\t\t\t\t\t\tconst d = `M ${s.x2},${s.y} C ${s.x2 + k},${s.y} ${next.x1 - k},${next.y} ${next.x1},${next.y}`;\n\t\t\t\t\t\t\t\t\t\treturn <path key={`mean-join-${i}`} className=\"fdp-spc__cl fdp-spc__cl-join\" d={d} fill=\"none\" />;\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})() : null}\n\t\t\t\t\t\t{uniformTarget != null && (\n\t\t\t\t\t\t\t// Render later (after limits) for stacking; temporary placeholder (moved below)\n\t\t\t\t\t\t\t<></>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{limitSegments?.ucl.length ? (() => (\n\t\t\t\t\t\t\t<g aria-hidden=\"true\" className=\"fdp-spc__limit-group fdp-spc__limit-group--ucl\">\n\t\t\t\t\t\t\t\t{limitSegments.ucl.map((s,i) => (\n\t\t\t\t\t\t\t\t\t<line key={`ucl-${i}`} className=\"fdp-spc__limit fdp-spc__limit--ucl\" x1={s.x1} x2={s.x2} y1={s.y} y2={s.y} strokeWidth={2} />\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t{limitSegments.ucl.map((s,i) => {\n\t\t\t\t\t\t\t\t\tif (i === limitSegments.ucl.length - 1) return null;\n\t\t\t\t\t\t\t\t\tconst next = limitSegments.ucl[i+1];\n\t\t\t\t\t\t\t\t\tif (!next) return null;\n\t\t\t\t\t\t\t\t\tif (s.y === next.y) return null;\n\t\t\t\t\t\t\t\t\tconst gap = Math.max(4, (next.x1 - s.x2) || 0);\n\t\t\t\t\t\t\t\t\tconst k = gap * 0.5;\n\t\t\t\t\t\t\t\t\tconst d = `M ${s.x2},${s.y} C ${s.x2 + k},${s.y} ${next.x1 - k},${next.y} ${next.x1},${next.y}`;\n\t\t\t\t\t\t\t\t\treturn <path key={`ucl-join-${i}`} className=\"fdp-spc__limit fdp-spc__limit--ucl fdp-spc__limit-join\" d={d} fill=\"none\" strokeWidth={2} />;\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t))() : null}\n\t\t\t\t\t\t{limitSegments?.lcl.length ? (() => (\n\t\t\t\t\t\t\t<g aria-hidden=\"true\" className=\"fdp-spc__limit-group fdp-spc__limit-group--lcl\">\n\t\t\t\t\t\t\t\t{limitSegments.lcl.map((s,i) => (\n\t\t\t\t\t\t\t\t\t<line key={`lcl-${i}`} className=\"fdp-spc__limit fdp-spc__limit--lcl\" x1={s.x1} x2={s.x2} y1={s.y} y2={s.y} strokeWidth={2} />\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t{limitSegments.lcl.map((s,i) => {\n\t\t\t\t\t\t\t\t\tif (i === limitSegments.lcl.length - 1) return null;\n\t\t\t\t\t\t\t\t\tconst next = limitSegments.lcl[i+1];\n\t\t\t\t\t\t\t\t\tif (!next) return null;\n\t\t\t\t\t\t\t\t\tif (s.y === next.y) return null;\n\t\t\t\t\t\t\t\t\tconst gap = Math.max(4, (next.x1 - s.x2) || 0);\n\t\t\t\t\t\t\t\t\tconst k = gap * 0.5;\n\t\t\t\t\t\t\t\t\tconst d = `M ${s.x2},${s.y} C ${s.x2 + k},${s.y} ${next.x1 - k},${next.y} ${next.x1},${next.y}`;\n\t\t\t\t\t\t\t\t\treturn <path key={`lcl-join-${i}`} className=\"fdp-spc__limit fdp-spc__limit--lcl fdp-spc__limit-join\" d={d} fill=\"none\" strokeWidth={2} />;\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t))() : null}\n\t\t\t\t\t\t{/* Target line drawn after limits for clear visibility */}\n\t\t\t\t\t\t{uniformTarget != null && (\n\t\t\t\t\t\t\t<g aria-hidden=\"true\" className=\"fdp-spc__target-group\">\n\t\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc__target\"\n\t\t\t\t\t\t\t\t\tdata-testid=\"spc-target-line\"\n\t\t\t\t\t\t\t\t\tx1={0}\n\t\t\t\t\t\t\t\t\tx2={xScale.range()[1]}\n\t\t\t\t\t\t\t\t\ty1={yScale(uniformTarget)}\n\t\t\t\t\t\t\t\t\ty2={yScale(uniformTarget)}\n\t\t\t\t\t\t\t\t\tstrokeWidth={2.5}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<text\n\t\t\t\t\t\t\t\t\tdata-testid=\"spc-target-label\"\n\t\t\t\t\t\t\t\t\tx={xScale.range()[0] - 7}\n\t\t\t\t\t\t\t\t\ty={yScale(uniformTarget) - 5}\n\t\t\t\t\t\t\t\t\ttextAnchor=\"start\"\n\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc__target-label\"\n\t\t\t\t\t\t\t\t\tfontSize={12}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tTarget {uniformTarget}{\" \"}\n\t\t\t\t\t\t\t\t\t{effectiveUnit || narrationContext?.measureUnit || \"\"}\n\t\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{showZones && limitSegments && limitSegments.mean.length > 0 && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{limitSegments.onePos.map((s, i) => (\n\t\t\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\t\t\tkey={`onePos-${i}`}\n\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc__zone fdp-spc__zone--pos1\"\n\t\t\t\t\t\t\t\t\t\tx1={s.x1}\n\t\t\t\t\t\t\t\t\t\tx2={s.x2}\n\t\t\t\t\t\t\t\t\t\ty1={s.y}\n\t\t\t\t\t\t\t\t\t\ty2={s.y}\n\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t\tstrokeWidth={2}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t{limitSegments.oneNeg.map((s, i) => (\n\t\t\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\t\t\tkey={`oneNeg-${i}`}\n\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc__zone fdp-spc__zone--neg1\"\n\t\t\t\t\t\t\t\t\t\tx1={s.x1}\n\t\t\t\t\t\t\t\t\t\tx2={s.x2}\n\t\t\t\t\t\t\t\t\t\ty1={s.y}\n\t\t\t\t\t\t\t\t\t\ty2={s.y}\n\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t\tstrokeWidth={2}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t{limitSegments.twoPos.map((s, i) => (\n\t\t\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\t\t\tkey={`twoPos-${i}`}\n\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc__zone fdp-spc__zone--pos2\"\n\t\t\t\t\t\t\t\t\t\tx1={s.x1}\n\t\t\t\t\t\t\t\t\t\tx2={s.x2}\n\t\t\t\t\t\t\t\t\t\ty1={s.y}\n\t\t\t\t\t\t\t\t\t\ty2={s.y}\n\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t\tstrokeWidth={2}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t{limitSegments.twoNeg.map((s, i) => (\n\t\t\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\t\t\tkey={`twoNeg-${i}`}\n\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc__zone fdp-spc__zone--neg2\"\n\t\t\t\t\t\t\t\t\t\tx1={s.x1}\n\t\t\t\t\t\t\t\t\t\tx2={s.x2}\n\t\t\t\t\t\t\t\t\t\ty1={s.y}\n\t\t\t\t\t\t\t\t\t\ty2={s.y}\n\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t\tstrokeWidth={2}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{/* Optional trend overlays: start/cross markers and bridge */}\n\t\t\t\t\t\t{trendInsights && (showTrendStartMarkers || showFirstFavourableCrossMarkers || showTrendBridgeOverlay) && (() => {\n\t\t\t\t\t\t\tconst startIdx = trendInsights.detectedAt;\n\t\t\t\t\t\t\tconst crossIdx = trendInsights.firstFavourableCrossAt;\n\t\t\t\t\t\t\tconst sx = all[startIdx] ? xScale(all[startIdx].x instanceof Date ? all[startIdx].x as Date : new Date(all[startIdx].x)) : null;\n\t\t\t\t\t\t\tconst sy = all[startIdx] ? yScale(all[startIdx].y) : null;\n\t\t\t\t\t\t\tconst cx = (crossIdx != null && all[crossIdx]) ? xScale(all[crossIdx].x instanceof Date ? all[crossIdx].x as Date : new Date(all[crossIdx].x)) : null;\n\t\t\t\t\t\t\tconst cy = (crossIdx != null && all[crossIdx]) ? yScale(all[crossIdx].y) : null;\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<g aria-hidden=\"true\" className=\"fdp-spc__trend-overlays\">\n\t\t\t\t\t\t\t\t\t{showTrendBridgeOverlay && sx != null && sy != null && cx != null && cy != null && (\n\t\t\t\t\t\t\t\t\t\t<line x1={sx} y1={sy} x2={cx} y2={cy} stroke=\"#888\" strokeDasharray=\"4 4\" strokeWidth={2}>\n\t\t\t\t\t\t\t\t\t\t\t<title>Trend bridge: start to first favourable-side point</title>\n\t\t\t\t\t\t\t\t\t\t</line>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t{showTrendStartMarkers && sx != null && sy != null && (\n\t\t\t\t\t\t\t\t\t\t<circle cx={sx} cy={sy} r={6} fill=\"white\" stroke=\"#555\" strokeWidth={2}>\n\t\t\t\t\t\t\t\t\t\t\t<title>Trend start (run reached N)</title>\n\t\t\t\t\t\t\t\t\t\t</circle>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t{showFirstFavourableCrossMarkers && cx != null && cy != null && (\n\t\t\t\t\t\t\t\t\t\t<circle cx={cx} cy={cy} r={5} fill=\"#555\">\n\t\t\t\t\t\t\t\t\t\t\t<title>First favourable-side inclusion</title>\n\t\t\t\t\t\t\t\t\t\t</circle>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})()}\n\t\t\t\t\t\t<LineSeriesPrimitive\n\t\t\t\t\t\t\tseries={series[0] as any}\n\t\t\t\t\t\t\tseriesIndex={0}\n\t\t\t\t\t\t\tpalette=\"categorical\"\n\t\t\t\t\t\t\tshowPoints={false}\n\t\t\t\t\t\t\tfocusablePoints={false}\n\t\t\t\t\t\t\tfocusIndex={-1}\n\t\t\t\t\t\t\tparseX={(d: SPCDatum) =>\n\t\t\t\t\t\t\t\td.x instanceof Date ? d.x : new Date(d.x)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsmooth={false}\n\t\t\t\t\t\t\tstrokeWidth={processLineWidth}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{showPoints &&\n\t\t\t\t\t\t\tall.map((d, i) => {\n\t\t\t\t\t\t\t\tconst cx = xScale(d.x instanceof Date ? d.x : new Date(d.x));\n\t\t\t\t\t\t\t\tconst cy = yScale(d.y);\n\t\t\t\t\t\t\t\tconst ooc = outOfControl.has(i);\n\t\t\t\t\t\t\t\tconst sig = engineSignals?.[i];\n\t\t\t\t\t\t\t\t// Visual-only ungated trend colouring: when variation is Neither but a trend rule fired,\n\t\t\t\t\t\t\t\t// map early trend points to directional colours based on metricImprovement.\n\t\t\t\t\t\t\t\tconst visualUngatedActive =\n\t\t\t\t\t\t\t\t\ttrendVisualMode === TrendVisualMode.Ungated &&\n\t\t\t\t\t\t\t\t\t!!sig?.special &&\n\t\t\t\t\t\t\t\t\tsig?.variation === VariationIcon.Neither &&\n\t\t\t\t\t\t\t\t\tmetricImprovement != null &&\n\t\t\t\t\t\t\t\t\tmetricImprovement !== ImprovementDirection.Neither;\n\t\t\t\t\t\t\t\tconst visualUngatedImprovement =\n\t\t\t\t\t\t\t\t\tvisualUngatedActive &&\n\t\t\t\t\t\t\t\t\t((sig?.trendUp && metricImprovement === ImprovementDirection.Up) ||\n\t\t\t\t\t\t\t\t\t\t(sig?.trendDown && metricImprovement === ImprovementDirection.Down));\n\t\t\t\t\t\t\t\tconst visualUngatedConcern =\n\t\t\t\t\t\t\t\t\tvisualUngatedActive &&\n\t\t\t\t\t\t\t\t\t((sig?.trendUp && metricImprovement === ImprovementDirection.Down) ||\n\t\t\t\t\t\t\t\t\t\t(sig?.trendDown && metricImprovement === ImprovementDirection.Up));\n\t\t\t\t\t\t\t\tconst isImprovement = !!(sig?.improvement || visualUngatedImprovement);\n\t\t\t\t\t\t\t\tconst isConcern = !!(sig?.concern || visualUngatedConcern);\n\t\t\t\t\t\t\t\tconst classes = [\n\t\t\t\t\t\t\t\t\t\"fdp-spc__point\",\n\t\t\t\t\t\t\t\t\tooc && highlightOutOfControl ? \"fdp-spc__point--ooc\" : null,\n\t\t\t\t\t\t\t\t\tenableRules && sig?.special && isConcern\n\t\t\t\t\t\t\t\t\t\t? \"fdp-spc__point--sc-concern\"\n\t\t\t\t\t\t\t\t\t\t: null,\n\t\t\t\t\t\t\t\t\tenableRules && sig?.special && isImprovement\n\t\t\t\t\t\t\t\t\t\t? \"fdp-spc__point--sc-improvement\"\n\t\t\t\t\t\t\t\t\t\t: null,\n\t\t\t\t\t\t\t\t\t// Neutral (context-dependent) metrics: show purple when special cause present but neither improvement nor concern\n\t\t\t\t\t\t\t\t\tenableRules &&\n\t\t\t\t\t\t\t\t\tenableNeutralNoJudgement &&\n\t\t\t\t\t\t\t\t\tsig?.special &&\n\t\t\t\t\t\t\t\t\tsig.variation === VariationIcon.Neither &&\n\t\t\t\t\t\t\t\t\t!isImprovement &&\n\t\t\t\t\t\t\t\t\t!isConcern\n\t\t\t\t\t\t\t\t\t\t? \"fdp-spc__point--sc-no-judgement\"\n\t\t\t\t\t\t\t\t\t\t: null,\n\t\t\t\t\t\t\t\t\tsig?.assurance === AssuranceIcon.Pass\n\t\t\t\t\t\t\t\t\t\t? \"fdp-spc__point--assurance-pass\"\n\t\t\t\t\t\t\t\t\t\t: null,\n\t\t\t\t\t\t\t\t\tsig?.assurance === AssuranceIcon.Fail\n\t\t\t\t\t\t\t\t\t\t? \"fdp-spc__point--assurance-fail\"\n\t\t\t\t\t\t\t\t\t\t: null,\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t.filter(Boolean)\n\t\t\t\t\t\t\t\t\t.join(\" \");\n\t\t\t\t\t\t\t\tconst ariaLabel =\n\t\t\t\t\t\t\t\t\t`Point ${i + 1} value ${d.y}` +\n\t\t\t\t\t\t\t\t\t(sig?.special ? \" special cause\" : \"\") +\n\t\t\t\t\t\t\t\t\t(sig?.variation === VariationIcon.Improvement\n\t\t\t\t\t\t\t\t\t\t? \" improving\"\n\t\t\t\t\t\t\t\t\t\t: sig?.variation === VariationIcon.Concern\n\t\t\t\t\t\t\t\t\t\t\t? \" concern\"\n\t\t\t\t\t\t\t\t\t\t\t: \"\");\n\t\t\t\t\t\t\t\t// Removed per refined ARIA approach: rely on tooltip via aria-describedby for detailed context\n\t\t\t\t\t\t\t\tconst isFocused = tooltipCtx?.focused?.index === i;\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<circle\n\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\tcx={cx}\n\t\t\t\t\t\t\t\t\t\tcy={cy}\n\t\t\t\t\t\t\t\t\t\tr={5} // unified radius for consistency across all points\n\t\t\t\t\t\t\t\t\t\tclassName={classes}\n\t\t\t\t\t\t\t\t\t\tdata-variation={sig?.variation}\n\t\t\t\t\t\t\t\t\t\tdata-assurance={sig?.assurance}\n\t\t\t\t\t\t\t\t\t\taria-label={ariaLabel}\n\t\t\t\t\t\t\t\t\t\t{...(isFocused\n\t\t\t\t\t\t\t\t\t\t\t? { \"aria-describedby\": `spc-tooltip-${i}` }\n\t\t\t\t\t\t\t\t\t\t\t: {})}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t{showIcons &&\n\t\t\t\t\t\t\tenableRules &&\n\t\t\t\t\t\t\tengineSignals &&\n\t\t\t\t\t\t\tall.map((d, i) => {\n\t\t\t\t\t\t\t\tconst sig = engineSignals[i];\n\t\t\t\t\t\t\t\tif (!sig) return null;\n\t\t\t\t\t\t\t\tif (!(sig.concern || sig.improvement)) return null;\n\t\t\t\t\t\t\t\tconst rawX = xScale(d.x instanceof Date ? d.x : new Date(d.x));\n\t\t\t\t\t\t\t\tconst rawPointY = yScale(d.y);\n\t\t\t\t\t\t\t\tlet iconY = rawPointY - 10; // preferred: above point\n\t\t\t\t\t\t\t\tconst topPadding = 12; // must stay >= group translate y (12) for visibility\n\t\t\t\t\t\t\t\tconst bottomLimit = yScale.range()[0] - 4; // small bottom padding\n\t\t\t\t\t\t\t\tif (iconY < topPadding) {\n\t\t\t\t\t\t\t\t\t// If too close to top, place below point instead (avoids clipping + overlap)\n\t\t\t\t\t\t\t\t\t// When forced below the point, add extra 10px vertical gap for clarity\n\t\t\t\t\t\t\t\t\ticonY = Math.min(rawPointY + 16, bottomLimit);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// Horizontal clamp so text anchor centre doesn't overflow\n\t\t\t\t\t\t\t\tconst plotWidth = xScale.range()[1];\n\t\t\t\t\t\t\t\tconst iconX = Math.min(Math.max(rawX, 0), plotWidth - 0);\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<text\n\t\t\t\t\t\t\t\t\t\tkey={`icon-${i}`}\n\t\t\t\t\t\t\t\t\t\tx={iconX}\n\t\t\t\t\t\t\t\t\t\ty={iconY}\n\t\t\t\t\t\t\t\t\t\ttextAnchor=\"middle\"\n\t\t\t\t\t\t\t\t\t\tclassName={`fdp-spc__icon ${sig.concern ? \"fdp-spc__icon--concern\" : \"fdp-spc__icon--improvement\"}`}\n\t\t\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{sig.concern ? \"!\" : \"\u2605\"}\n\t\t\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t{/* Pointer / keyboard interaction layer (covers plot area) */}\n\t\t\t\t\t\t{chartCtx && (\n\t\t\t\t\t\t\t<InteractionLayer\n\t\t\t\t\t\t\t\twidth={xScale.range()[1]}\n\t\t\t\t\t\t\t\theight={yScale.range()[0]}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{!showSignalsInspector && (\n\t\t\t\t\t\t\t<SPCTooltipOverlay\n\t\t\t\t\t\t\t\tengineRows={engineRows}\n\t\t\t\t\t\t\t\tlimits={{ mean: limits.mean, sigma: limits.sigma }}\n\t\t\t\t\t\t\t\tpointDescriber={describePoint}\n\t\t\t\t\t\t\t\tmeasureName={narrationContext?.measureName}\n\t\t\t\t\t\t\t\tmeasureUnit={narrationContext?.measureUnit}\n\t\t\t\t\t\t\t\tdateFormatter={(d: Date) => formatDateLong(d)}\n\t\t\t\t\t\t\t\tenableNeutralNoJudgement={enableNeutralNoJudgement}\n\t\t\t\t\t\t\t\tshowTrendGatingExplanation={showTrendGatingExplanation}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</g>\n\t\t\t\t</svg>\n\t\t\t\t{showSignalsInspector && (\n\t\t\t\t\t<div style={{ marginTop: 8 }}>\n\t\t\t\t\t\t<SPCSignalsInspector\n\t\t\t\t\t\t\tengineRows={engineRows}\n\t\t\t\t\t\t\tmeasureName={narrationContext?.measureName}\n\t\t\t\t\t\t\tmeasureUnit={effectiveUnit || narrationContext?.measureUnit}\n\t\t\t\t\t\t\tonSignalFocus={onSignalFocus}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t{announceFocus && (\n\t\t\t\t\t<VisuallyHiddenLiveRegion\n\t\t\t\t\t\tformat={(d: any) =>\n\t\t\t\t\t\t\tformatLive({ ...d, x: d.x instanceof Date ? d.x : new Date(d.x) })\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</TooltipProvider>\n\t);\n};\n\n// Transparent rectangle capturing pointer + keyboard events to drive tooltip focus\nconst InteractionLayer: React.FC<{ width: number; height: number }> = ({\n\twidth,\n\theight,\n}) => {\n\tconst t = useTooltipContext();\n\tif (!t) return null;\n\treturn (\n\t\t<rect\n\t\t\tclassName=\"fdp-spc__interaction-layer\"\n\t\t\twidth={width}\n\t\t\theight={height}\n\t\t\tfill=\"transparent\"\n\t\t\ttabIndex={0}\n\t\t\taria-label=\"Interactive chart area. Use arrow keys to move between points.\"\n\t\t\tonMouseMove={(e) => {\n\t\t\t\tconst target = e.currentTarget as SVGRectElement;\n\t\t\t\tconst bounds = target.getBoundingClientRect();\n\t\t\t\tconst x = e.clientX - bounds.left;\n\t\t\t\tconst y = e.clientY - bounds.top;\n\t\t\t\tt.focusNearest(x, y);\n\t\t\t}}\n\t\t\tonMouseLeave={() => t.clear()}\n\t\t\tonKeyDown={(e) => {\n\t\t\t\tswitch (e.key) {\n\t\t\t\t\tcase \"ArrowRight\":\n\t\t\t\t\t\tt.focusNextPoint();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"ArrowLeft\":\n\t\t\t\t\t\tt.focusPrevPoint();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"ArrowDown\":\n\t\t\t\t\t\tt.focusNextSeries();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"ArrowUp\":\n\t\t\t\t\t\tt.focusPrevSeries();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Home\":\n\t\t\t\t\t\tt.focusFirstPoint();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"End\":\n\t\t\t\t\t\tt.focusLastPoint();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}}\n\t\t\tstyle={{ cursor: \"crosshair\" }}\n\t\t/>\n\t);\n};\n\nexport { ImprovementDirection, VariationIcon, AssuranceIcon };\nexport default SPCChart;\n", "import * as React from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { useTooltipContext } from \"../../../core/TooltipContext\";\nimport { useChartContext } from \"../../../core/ChartRoot\";\n// pickSeriesColor intentionally not used in SPC tooltip overlay; keep import commented for future use\n// import { pickSeriesColor } from \"../../utils/colors\";\n// AssuranceIcon import removed (utility based)\nimport {\n\textractRuleIds,\n\truleGlossary,\n\tvariationLabel,\n\tassuranceLabel,\n\tzoneLabel,\n} from \"./logic/spcDescriptors\";\nimport { VariationIcon, SpcRuleId, SpcRawRuleTag } from './logic/spcConstants';\nimport { getVariationColorToken } from \"./logic/spcDescriptors\";\nimport { Tag } from \"../../../../Tag\";\n\ninterface SPCTooltipOverlayProps {\n\tengineRows: any[] | null;\n\tlimits: { mean?: number | null; sigma: number };\n\t/** Optional callback to produce rich aria / tooltip narrative for a point (index, SPCDatum-like) */\n\tpointDescriber?: (\n\t\tindex: number,\n\t\td: { x: Date | string | number; y: number }\n\t) => string | undefined;\n\t/** Optional measure name for richer value line e.g. \"85 % Hand Washing Compliance\" */\n\tmeasureName?: string;\n\t/** Optional unit e.g. '%', 'ms' */\n\tmeasureUnit?: string;\n\t/** Optional date formatter (defaults to toDateString) */\n\tdateFormatter?: (d: Date) => string;\n\t/** Show neutral special-cause (no-judgement) purple styling in tooltip. Defaults to true. */\n\tenableNeutralNoJudgement?: boolean;\n\t/** Show trend side-gating explanation text. Defaults to true. */\n\tshowTrendGatingExplanation?: boolean;\n}\n\n/**\n * SPC specific tooltip overlay enriching the basic overlay with:\n *  - Variation / assurance interpretation (improvement vs concern)\n *  - Specific special-cause rule(s) that triggered for the point\n *  - Zone classification relative to mean (inside 1\u03C3, 1\u20132\u03C3, 2\u20133\u03C3, >3\u03C3)\n */\nconst SPCTooltipOverlay: React.FC<SPCTooltipOverlayProps> = ({\n\tengineRows,\n\tlimits,\n\tpointDescriber,\n\tmeasureName,\n\tmeasureUnit,\n\tdateFormatter,\n\tenableNeutralNoJudgement = true,\n\tshowTrendGatingExplanation = true,\n}) => {\n\tconst tooltip = useTooltipContext();\n\tconst chart = useChartContext();\n\n\t// Sticky tooltip behaviour: retain last focused point while user hovers tooltip surface.\n\t// Hooks must run every render (even when no point focused) to keep order stable.\n\tconst [cachedFocus, setCachedFocus] = React.useState<any | null>(null);\n\tconst [hoveringTooltip, setHoveringTooltip] = React.useState(false);\n\tconst hideTimeoutRef = React.useRef<number | null>(null);\n\n\t// When context focus changes to a real point, cache it\n\tReact.useEffect(() => {\n\t\tif (!tooltip) return; // no context yet\n\t\tif (tooltip.focused) {\n\t\t\tsetCachedFocus(tooltip.focused);\n\t\t\tif (hideTimeoutRef.current) {\n\t\t\t\tcancelAnimationFrame(hideTimeoutRef.current);\n\t\t\t\thideTimeoutRef.current = null;\n\t\t\t}\n\t\t}\n\t\tif (!tooltip.focused && !hoveringTooltip) {\n\t\t\tconst id = requestAnimationFrame(() => {\n\t\t\t\tsetCachedFocus(null);\n\t\t\t\thideTimeoutRef.current = null;\n\t\t\t});\n\t\t\thideTimeoutRef.current = id;\n\t\t}\n\t\treturn () => {\n\t\t\tif (hideTimeoutRef.current) {\n\t\t\t\tcancelAnimationFrame(hideTimeoutRef.current);\n\t\t\t\thideTimeoutRef.current = null;\n\t\t\t}\n\t\t};\n\t}, [tooltip, tooltip?.focused, hoveringTooltip]);\n\n\t// Determine current focused point (may be null). No early returns until AFTER all hooks declared.\n\tconst focused =\n\t\ttooltip &&\n\t\t(tooltip.focused || (hoveringTooltip ? cachedFocus : null) || cachedFocus);\n\n\t// Visibility animation hooks MUST run every render to keep ordering stable.\n\tconst [visible, setVisible] = React.useState(false);\n\tReact.useEffect(() => {\n\t\tconst id = requestAnimationFrame(() => setVisible(true));\n\t\treturn () => cancelAnimationFrame(id);\n\t}, [focused?.index]);\n\n\t// Safe metrics (fallback to 0 if chart not ready so calculations still defined)\n\tconst innerWidth = chart?.innerWidth ?? 0;\n\tconst innerHeight = chart?.innerHeight ?? 0;\n\tconst clampX = focused\n\t\t? Math.min(Math.max(focused.clientX, 0), innerWidth)\n\t\t: 0;\n\tconst clampY = focused\n\t\t? Math.min(Math.max(focused.clientY, 0), innerHeight)\n\t\t: 0;\n\n\t// We'll render marker in SVG but move rich text into an absolutely positioned HTML portal so it can overflow chart.\n\tconst containerEl = (chart as any).ref?.current as HTMLElement | undefined; // ChartRoot div (position: relative)\n\tconst host = containerEl; // we rely on ChartRoot's positioned container\n\n\t// If no focused point yet, don't attempt to derive tooltip content.\n\tif (!focused) {\n\t\treturn null;\n\t}\n\n\t// Single series assumption for SPCChart; index aligns with engineRows order used earlier.\n\tconst row = engineRows?.[focused.index];\n\t// Keep rule ids and labels so we can apply colour logic per rule (e.g. trend always purple)\n\tconst ruleIds = extractRuleIds(row);\n\tconst rules = ruleIds.map((r) => ({ id: r, label: ruleGlossary[r].tooltip })); // structured for per-rule styling\n\tconst dateObj = focused.x instanceof Date ? focused.x : new Date(focused.x);\n\tconst dateLabel = dateFormatter\n\t\t? dateFormatter(dateObj)\n\t\t: dateObj.toDateString();\n\tconst unit = measureUnit ? `${measureUnit}` : \"\";\n\tconst valueLabel =\n\t\tmeasureName || unit\n\t\t\t? `${focused.y}${unit ? \"\" + unit : \" \"}${measureName ? \" \" + measureName : \"\"}`\n\t\t\t: `${focused.y}`;\n\n\t// Variation / assurance descriptors\n\tconst variationDesc: string | null = variationLabel(row?.variationIcon);\n\t// Assurance descriptor\n\tconst assuranceDesc: string | null = assuranceLabel(row?.assuranceIcon);\n\n\t// Zone classification relative to mean & sigma\n\tconst zone: string | null = zoneLabel(\n\t\tlimits.mean ?? null,\n\t\tlimits.sigma,\n\t\tfocused.y\n\t);\n\n\t// Build structured content blocks for NHS styled tooltip\n\tconst narrative = pointDescriber\n\t\t? pointDescriber(focused.index, { x: focused.x, y: focused.y })\n\t\t: undefined;\n\tconst showBadges = variationDesc || assuranceDesc || zone;\n\n\t// Determine if trend side-gating applies (trend flag present but variation neutral)\n\tconst trendFlag = row?.specialCauseTrendUp || row?.specialCauseTrendDown;\n\tconst variationNeutral = row?.variationIcon === VariationIcon.Neither && trendFlag;\n\t// Side-gating explanatory line (only when neutrality due to being on unfavourable side)\n\tconst gatingExplanation = showTrendGatingExplanation && variationNeutral\n\t\t? 'Trend detected (monotonic run) \u2013 held neutral until values cross onto the favourable side of the mean.'\n\t\t: null;\n\tconst hasRules = rules.length > 0;\n\t// SQL compatibility metadata (present only when wrapper used). We defensively gate on property existence.\n\tconst primeDirection: string | undefined = row?.primeDirection;\n\tconst primeRuleId: SpcRuleId | undefined = row?.primeRuleId;\n\t// \"No judgement\" (neutral special cause) state: underlying variation classified as Neither but special cause rules fired\n\tconst isNoJudgement = enableNeutralNoJudgement && row?.variationIcon === VariationIcon.Neither && hasRules;\n\t// Provenance (ruleTags) removed from tooltip to avoid duplication with Special cause section.\n\n\t// focus ring colour\n\tconst focusYellow = \"var(--nhs-fdp-color-primary-yellow, #ffeb3b)\";\n\t// Tooltip inner dot colour: use canonical token exported from spcDescriptors\n\tconst spcDotColor = getVariationColorToken(row?.variationIcon);\n\n\t// lineHeight constant removed (was only used for height calculation)\n\t// Height no longer needed for positioning (always placed below point)\n\n\t// Compute absolute positioning relative to chart container for portal.\n\t// Determine desired width from content (approximate character width heuristic) within bounds.\n\tconst charPx = 6.2;\n\t// Estimate width using primary textual lines (narrative / date-value) \u2013 badges and list wrap naturally\n\tconst baseLinesForMeasure = [\n\t\tnarrative || \"\",\n\t\t`${dateLabel} \u2022 ${valueLabel}`,\n\t].filter(Boolean);\n\tconst contentWidthEstimate = baseLinesForMeasure.reduce(\n\t\t(m, s) => Math.max(m, s.length * charPx + 32),\n\t\t0\n\t); // padding allowance\n\tconst minWidth = 200;\n\tconst maxWidth = 440;\n\tconst boxWidth = Math.min(maxWidth, Math.max(minWidth, contentWidthEstimate));\n\n\tlet left = clampX + 12; // initial: to the right of point\n\t// Account for chart margin.top (group translate) so portal top matches visual point position.\n\tconst marginTop = (chart as any).margin?.top ?? 0;\n\t// Position tooltip below the point: top edge exactly 10px beneath the data point\n\tlet top = marginTop + clampY + 16;\n\t// If overflowing right edge, flip to left side of point\n\tif (left + boxWidth > innerWidth) {\n\t\tconst flipGap = -60; // smaller gap when flipped to sit closer to point\n\t\tleft = clampX - flipGap - boxWidth;\n\t}\n\t// Final clamp to container bounds\n\tif (left < 0) left = Math.max(0, innerWidth - boxWidth);\n\n\t// Fade-in: mount flag already handled earlier; reuse existing visible state.\n\tconst tooltipId = focused ? `spc-tooltip-${focused.index}` : \"spc-tooltip\";\n\tconst portal = host\n\t\t? createPortal(\n\t\t\t\t<div\n\t\t\t\t\tid={tooltipId}\n\t\t\t\t\tclassName={\n\t\t\t\t\t\t\"fdp-spc-tooltip fdp-spc-tooltip-portal\" +\n\t\t\t\t\t\t(visible ? \" is-visible\" : \"\")\n\t\t\t\t\t}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tposition: \"absolute\",\n\t\t\t\t\t\tleft,\n\t\t\t\t\t\ttop,\n\t\t\t\t\t\twidth: boxWidth,\n\t\t\t\t\t\tmaxWidth: maxWidth,\n\t\t\t\t\t\tzIndex: 10,\n\t\t\t\t\t\tpointerEvents: \"auto\",\n\t\t\t\t\t\tuserSelect: \"none\",\n\t\t\t\t\t}}\n\t\t\t\t\trole=\"tooltip\"\n\t\t\t\t\taria-live=\"polite\"\n\t\t\t\t\taria-hidden={visible ? \"false\" : \"true\"}\n\t\t\t\t\tdata-floating\n\t\t\t\t\tdata-placement={left + boxWidth + 12 > innerWidth ? \"left\" : \"right\"}\n\t\t\t\t\tonPointerEnter={() => {\n\t\t\t\t\t\tsetHoveringTooltip(true);\n\t\t\t\t\t\tif (hideTimeoutRef.current) {\n\t\t\t\t\t\t\tcancelAnimationFrame(hideTimeoutRef.current);\n\t\t\t\t\t\t\thideTimeoutRef.current = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\tonPointerLeave={() => {\n\t\t\t\t\t\tsetHoveringTooltip(false);\n\t\t\t\t\t\t// if context no longer focused, clear cached after a short animation frame\n\t\t\t\t\t\tif (!tooltip?.focused) {\n\t\t\t\t\t\t\tconst id = requestAnimationFrame(() => {\n\t\t\t\t\t\t\t\tsetCachedFocus(null);\n\t\t\t\t\t\t\t\thideTimeoutRef.current = null;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\thideTimeoutRef.current = id;\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"fdp-spc-tooltip__body\">\n\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section fdp-spc-tooltip__section--date\">\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section-label\">\n\t\t\t\t\t\t\t\t<strong>Date</strong>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__primary-line\">{dateLabel}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section fdp-spc-tooltip__section--value\">\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section-label\">\n\t\t\t\t\t\t\t\t<strong>Value</strong>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__primary-line\">{valueLabel}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/* {narrative && (\n\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section fdp-spc-tooltip__section--narrative\">\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__narrative\">{narrative}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)} */}\n\t\t\t\t\t\t{showBadges && (\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section fdp-spc-tooltip__section--signals\">\n\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section-label\">\n\t\t\t\t\t\t\t\t\t<strong>Signals</strong>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__badges\" aria-label=\"Signals\">\n\t\t\t\t\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\t\t\t\t// Prefer explicit improvement/concern wording; override with purple no-judgement if neutral + special cause\n\t\t\t\t\t\t\t\t\t\tif (variationDesc?.toLowerCase().includes(\"concern\")) {\n\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext={variationDesc}\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc-tooltip__tag fdp-spc-tag fdp-spc-tag--concern\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (variationDesc?.toLowerCase().includes(\"improvement\")) {\n\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext={variationDesc}\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc-tooltip__tag fdp-spc-tag fdp-spc-tag--improvement\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (isNoJudgement) {\n\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext={\"No judgement\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc-tooltip__tag fdp-spc-tag fdp-spc-tag--no-judgement\"\n\t\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"Neutral special cause (no directional judgement)\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (variationDesc) {\n\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext={variationDesc}\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc-tooltip__tag fdp-spc-tag fdp-spc-tag--common\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t})()}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{assuranceDesc && (\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section fdp-spc-tooltip__section--assurance\">\n\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section-label\">\n\t\t\t\t\t\t\t\t\t<strong>Assurance</strong>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__badges\" aria-label=\"Limits\">\n\t\t\t\t\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\t\t\t\tconst lower = assuranceDesc.toLowerCase();\n\t\t\t\t\t\t\t\t\t\t// Treat explicit 'not met' (or 'not achieved') as fail; require standalone 'met' / 'achieved' for pass.\n\t\t\t\t\t\t\t\t\t\tconst isFail = lower.includes(\"not met\") || lower.includes(\"not achieved\");\n\t\t\t\t\t\t\t\t\t\t// Pass if contains 'met' or 'achieved' and not a fail phrase.\n\t\t\t\t\t\t\t\t\t\tconst isPass = !isFail && (/(^|\\b)(met|achieved)(\\b|$)/).test(lower);\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\ttext={assuranceDesc}\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\t// Pass -> improvement (blue), Fail -> concern (orange)\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={`fdp-spc-tooltip__tag fdp-spc-tag fdp-spc-tag--assurance ${isPass ? \"fdp-spc-tag--improvement\" : \"fdp-spc-tag--concern\"}`}\n\t\t\t\t\t\t\t\t\t\t\t\taria-label={`Assurance: ${assuranceDesc}`}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t})()}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{zone && (\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section fdp-spc-tooltip__section--limits\">\n\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section-label\">\n\t\t\t\t\t\t\t\t\t<strong>Control Limits & Sigma</strong>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__badges\" aria-label=\"Limits\">\n\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\ttext={(() => {\n\t\t\t\t\t\t\t\t\t\t\tconst z = zone.toLowerCase();\n\t\t\t\t\t\t\t\t\t\t\tif (z.startsWith(\"within 1\")) return \"\u22641\u03C3\";\n\t\t\t\t\t\t\t\t\t\t\tif (z.startsWith(\"1\u20132\")) return \"1\u20132\u03C3\";\n\t\t\t\t\t\t\t\t\t\t\tif (z.startsWith(\"2\u20133\")) return \"2\u20133\u03C3\";\n\t\t\t\t\t\t\t\t\t\t\tif (z.startsWith(\">3\")) return \">3\u03C3\";\n\t\t\t\t\t\t\t\t\t\t\treturn zone;\n\t\t\t\t\t\t\t\t\t\t})()}\n\t\t\t\t\t\t\t\t\t\tcolor={\n\t\t\t\t\t\t\t\t\t\t\tzone.includes(\">3\")\n\t\t\t\t\t\t\t\t\t\t\t\t? \"orange\"\n\t\t\t\t\t\t\t\t\t\t\t\t: zone.includes(\"2\u20133\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t? \"yellow\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t: \"grey\"\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\taria-label={`Sigma zone: ${zone}`}\n\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc-tooltip__tag fdp-spc-tag fdp-spc-tag--zone\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{gatingExplanation && (\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section fdp-spc-tooltip__section--gating\" data-gating>\n\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section-label\"><strong>Trend gating</strong></div>\n\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__explanation\" aria-live=\"off\">{gatingExplanation}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{hasRules && (\n\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section fdp-spc-tooltip__section--rules\">\n\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section-label\">\n\t\t\t\t\t\t\t\t\t<strong>Special cause</strong>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc-tooltip__rule-tags\"\n\t\t\t\t\t\t\t\t\taria-label=\"Special cause rules\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{rules.map(({ id, label }) => {\n\t\t\t\t\t\t\t\t\t\tconst idStr = String(id);\n\t\t\t\t\t\t\t\t\t\tconst isTrend = idStr === SpcRawRuleTag.TrendIncreasing || idStr === SpcRawRuleTag.TrendDecreasing;\n\t\t\t\t\t\t\t\t\t\t// Trend special cause stays purple (common) even if overall variation is improvement/concern (side-gated neutrality visual cue)\n\t\t\t\t\t\t\t\t\t\tconst ruleColorClass = isTrend\n\t\t\t\t\t\t\t\t\t\t\t? 'fdp-spc-tag--trend'\n\t\t\t\t\t\t\t\t\t\t\t: isNoJudgement\n\t\t\t\t\t\t\t\t\t\t\t\t? 'fdp-spc-tag--no-judgement'\n\t\t\t\t\t\t\t\t\t\t\t\t: variationDesc\n\t\t\t\t\t\t\t\t\t\t\t\t\t? variationDesc.toLowerCase().includes('concern')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'fdp-spc-tag--concern'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: variationDesc.toLowerCase().includes('improvement')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'fdp-spc-tag--improvement'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'fdp-spc-tag--common'\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'fdp-spc-tag--common';\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\tkey={idStr}\n\t\t\t\t\t\t\t\t\t\t\t\ttext={label}\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={`fdp-spc-tooltip__tag fdp-spc-tag ${ruleColorClass}`}\n\t\t\t\t\t\t\t\t\t\t\t\tdata-rule-id={idStr}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{ primeDirection && (\n\t\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section fdp-spc-tooltip__section--rules\" style={{ marginTop: 16 }}>\n\t\t\t\t\t\t\t\t\t\t<div className=\"fdp-spc-tooltip__section-label\" style={{ marginBottom: 6 }}>\n\t\t\t\t\t\t\t\t\t\t\t<strong>Prime Direction</strong>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\t\t\t\t\tconst primeColorClass = isNoJudgement\n\t\t\t\t\t\t\t\t\t\t\t\t? 'fdp-spc-tag--no-judgement'\n\t\t\t\t\t\t\t\t\t\t\t\t: variationDesc\n\t\t\t\t\t\t\t\t\t\t\t\t\t? variationDesc.toLowerCase().includes('concern')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'fdp-spc-tag--concern'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: variationDesc.toLowerCase().includes('improvement')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'fdp-spc-tag--improvement'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'fdp-spc-tag--common'\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'fdp-spc-tag--common';\n\t\t\t\t\t\t\t\t\t\t\tconst primeLabel = `${primeDirection}${primeRuleId ? ` (${primeRuleId})` : ''}`;\n\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext={primeLabel}\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`fdp-spc-tooltip__tag fdp-spc-tag ${primeColorClass}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\taria-label={`Prime direction ${primeDirection}${primeRuleId ? ` via ${primeRuleId}` : ''}`}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t})()}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>,\n\t\t\t\thost\n\t\t\t)\n\t\t: null;\n\n\treturn (\n\t\t<g\n\t\t\tclassName=\"fdp-tooltip-layer fdp-spc-tooltip\"\n\t\t\tpointerEvents=\"none\"\n\t\t\taria-hidden=\"true\"\n\t\t>\n\t\t\t<circle\n\t\t\t\tcx={clampX}\n\t\t\t\tcy={clampY}\n\t\t\t\tr={7}\n\t\t\t\tfill=\"none\"\n\t\t\t\tstroke={focusYellow}\n\t\t\t\tstrokeWidth={3}\n\t\t\t/>\n\t\t\t<circle\n\t\t\t\tcx={clampX}\n\t\t\t\tcy={clampY}\n\t\t\t\tr={5}\n\t\t\t\tfill=\"#000\"\n\t\t\t\tstroke={focusYellow}\n\t\t\t\tstrokeWidth={1.5}\n\t\t\t/>\n\t\t\t<circle\n\t\t\t\tcx={clampX}\n\t\t\t\tcy={clampY}\n\t\t\t\tr={2.5}\n\t\t\t\tfill={spcDotColor}\n\t\t\t\tstroke=\"#fff\"\n\t\t\t\tstrokeWidth={0.5}\n\t\t\t/>\n\t\t\t{portal}\n\t\t</g>\n\t);\n};\n\nexport default SPCTooltipOverlay;\n", "// Centralised SPC engine constants, enums, and registry metadata\n\n// Chart types supported by the SPC engine\nexport enum ChartType {\n\tXmR = \"XmR\",\n\tT = \"T\",\n\tG = \"G\",\n}\n\n// Core enums to share with UI/icon layers\nexport enum ImprovementDirection {\n\tUp = \"Up\",\n\tDown = \"Down\",\n\tNeither = \"Neither\",\n}\n\nexport enum VariationIcon {\n\tImprovement = \"improvement\",\n\tConcern = \"concern\",\n\tNeither = \"neither\",\n\t/** Preferred identifier for no\u2011judgement/suppressed cases. */\n\tSuppressed = \"suppressed\",\n}\n\n// Stable identifiers for rule categories used in ranking / conflict metadata\nexport enum SpcRuleId {\n\tSinglePoint = \"single_point\",\n\tTwoSigma = \"two_sigma\",\n\tShift = \"shift\",\n\tTrend = \"trend\",\n}\n\n// Stable ordered precedence list (index +1 gives rank)\nexport const RULE_PRECEDENCE: SpcRuleId[] = [\n\tSpcRuleId.SinglePoint,\n\tSpcRuleId.TwoSigma,\n\tSpcRuleId.Shift,\n\tSpcRuleId.Trend,\n];\n\n// Derive rank map from RULE_PRECEDENCE (1-based)\nexport const RULE_RANK_BY_ID: Record<SpcRuleId, number> =\n\tRULE_PRECEDENCE.reduce(\n\t\t(acc, id, i) => {\n\t\t\tacc[id] = i + 1;\n\t\t\treturn acc;\n\t\t},\n\t\t{} as Record<SpcRuleId, number>\n\t);\n\n// Human friendly labels (retained for backward compatibility)\n/**\n * @deprecated Use `RULE_METADATA[id].label` or `RULES_IN_RANK_ORDER` instead.\n */\nexport const RULE_LABEL: Record<SpcRuleId, string> = {\n\t[SpcRuleId.SinglePoint]: \"Single point beyond process limit\",\n\t[SpcRuleId.TwoSigma]: \"Two of three beyond 2\u03C3 on one side\",\n\t[SpcRuleId.Shift]: \"Sustained shift (run)\",\n\t[SpcRuleId.Trend]: \"Monotonic trend\",\n};\n\n// Unified rule metadata registry\nexport enum SpcRuleCategory {\n\tPoint = \"point\",\n\tCluster = \"cluster\",\n\tSustained = \"sustained\",\n}\n\nexport interface SpcRuleMetadataEntry {\n\tid: SpcRuleId;\n\trank: number;\n\tlabel: string;\n\tcategory: SpcRuleCategory;\n\tparticipatesInRanking: boolean;\n}\n\nconst RULE_CATEGORY: Record<SpcRuleId, SpcRuleCategory> = {\n\t[SpcRuleId.SinglePoint]: SpcRuleCategory.Point,\n\t[SpcRuleId.TwoSigma]: SpcRuleCategory.Cluster,\n\t[SpcRuleId.Shift]: SpcRuleCategory.Sustained,\n\t[SpcRuleId.Trend]: SpcRuleCategory.Sustained,\n};\n\nexport const RULE_METADATA: Record<SpcRuleId, SpcRuleMetadataEntry> =\n\tRULE_PRECEDENCE.reduce(\n\t\t(acc, id, index) => {\n\t\t\tacc[id] = {\n\t\t\t\tid,\n\t\t\t\trank: index + 1,\n\t\t\t\tlabel: RULE_LABEL[id],\n\t\t\t\tcategory: RULE_CATEGORY[id],\n\t\t\t\tparticipatesInRanking: true,\n\t\t\t};\n\t\t\treturn acc;\n\t\t},\n\t\t{} as Record<SpcRuleId, SpcRuleMetadataEntry>\n\t);\n\nexport const RULES_IN_RANK_ORDER: SpcRuleMetadataEntry[] = RULE_PRECEDENCE.map(\n\t(id) => RULE_METADATA[id]\n);\n\n// Directional side (high vs low) for special-cause classification\nexport enum Side {\n\tUp = \"up\",\n\tDown = \"down\",\n}\n\n// Raw rule tag identifiers (snake_case) used in ruleTags audit trail\nexport enum SpcRawRuleTag {\n\tSinglePointAbove = \"single_above\",\n\tSinglePointBelow = \"single_below\",\n\tTwoOfThreeAbove = \"two_of_three_above\",\n\tTwoOfThreeBelow = \"two_of_three_below\",\n\tFourOfFiveAbove = \"four_of_five_above\",\n\tFourOfFiveBelow = \"four_of_five_below\",\n\tShiftHigh = \"shift_high\",\n\tShiftLow = \"shift_low\",\n\tTrendIncreasing = \"trend_inc\",\n\tTrendDecreasing = \"trend_dec\",\n\tFifteenInnerThird = \"fifteen_inner_third\",\n}\n\n// Map raw rule tags (side-specific flags) to canonical ranked rule ids\nexport const RAW_TAG_TO_RULE_ID: Partial<Record<SpcRawRuleTag, SpcRuleId>> = {\n\t[SpcRawRuleTag.SinglePointAbove]: SpcRuleId.SinglePoint,\n\t[SpcRawRuleTag.SinglePointBelow]: SpcRuleId.SinglePoint,\n\t[SpcRawRuleTag.TwoOfThreeAbove]: SpcRuleId.TwoSigma,\n\t[SpcRawRuleTag.TwoOfThreeBelow]: SpcRuleId.TwoSigma,\n\t[SpcRawRuleTag.ShiftHigh]: SpcRuleId.Shift,\n\t[SpcRawRuleTag.ShiftLow]: SpcRuleId.Shift,\n\t[SpcRawRuleTag.TrendIncreasing]: SpcRuleId.Trend,\n\t[SpcRawRuleTag.TrendDecreasing]: SpcRuleId.Trend,\n\t// FourOfFiveAbove / FourOfFiveBelow intentionally omitted from ranking\n\t// FifteenInnerThird intentionally omitted from ranking\n};\n\nexport enum AssuranceIcon {\n\tPass = \"pass\",\n\tFail = \"fail\",\n\tNone = \"none\",\n}\n\n// Baseline suggestion trigger reason ordering (string values used in snapshots/docs)\nexport enum BaselineSuggestionReason {\n\tShift = \"shift\",\n\tTrend = \"trend\",\n\tPoint = \"point\",\n}\n\n// Precedence strategies for variation classification\nexport enum PrecedenceStrategy {\n\tLegacy = \"legacy\",\n\tDirectionalFirst = \"directional_first\",\n}\n\n// Optional conflict precedence mode (SQL v2.6a style ranking)\nexport enum ConflictPrecedenceMode {\n\tNone = \"none\",\n\tSqlRankingV26a = \"sql_ranking_v2_6a\",\n}\n\n// Unified prime direction (used by SQL compatibility & potential conflict pruning metadata)\nexport enum PrimeDirection {\n\tUpwards = \"Upwards\",\n\tDownwards = \"Downwards\",\n\tSame = \"Same\",\n}\n\n// Unified pruning mode enumeration for rows\nexport enum PruningMode {\n\tSql = \"sql\",\n\tConflict = \"conflict\",\n}\n\n// Row alias field names (forward-compatible deprecations / planned renames)\nexport enum SpcRowAliasField {\n\tImprovementValueBeforePruning = \"improvementValueBeforePruning\",\n\tConcernValueBeforePruning = \"concernValueBeforePruning\",\n}\n", "import { SpcRow } from \"./spc\";\nimport { VariationIcon, AssuranceIcon } from \"./spcConstants\";\n\n// Stable identifiers for rule flags mapped from SpcRow boolean properties (enum for stronger typing)\nexport enum SpcRuleId {\n\tSinglePointUp = 'singlePointUp',\n\tSinglePointDown = 'singlePointDown',\n\tTwoOfThreeUp = 'twoOfThreeUp',\n\tTwoOfThreeDown = 'twoOfThreeDown',\n\tFourOfFiveUp = 'fourOfFiveUp',\n\tFourOfFiveDown = 'fourOfFiveDown',\n\tShiftUp = 'shiftUp',\n\tShiftDown = 'shiftDown',\n\tTrendUp = 'trendUp',\n\tTrendDown = 'trendDown'\n}\n\nexport interface SpcRuleGlossaryEntry {\n\t/** Short label suitable for dense tooltip list */\n\ttooltip: string;\n\t/** Longer narration fragment (not full sentence) used when assembling live region text */\n\tnarration: string;\n}\n\n\texport const ruleGlossary: Record<SpcRuleId, SpcRuleGlossaryEntry> = {\n\t\t[SpcRuleId.SinglePointUp]: {\n\t\ttooltip: \"Single point above upper control limit\",\n\t\tnarration: \"Single point beyond a control limit\",\n\t},\n\t\t[SpcRuleId.SinglePointDown]: {\n\t\ttooltip: \"Single point below lower control limit\",\n\t\tnarration: \"Single point beyond a control limit\",\n\t},\n\t\t[SpcRuleId.TwoOfThreeUp]: {\n\t\ttooltip: \"Two of three points beyond +2\u03C3\",\n\t\tnarration: \"Two of three points beyond two sigma (same side)\",\n\t},\n\t\t[SpcRuleId.TwoOfThreeDown]: {\n\t\ttooltip: \"Two of three points beyond -2\u03C3\",\n\t\tnarration: \"Two of three points beyond two sigma (same side)\",\n\t},\n\t\t[SpcRuleId.FourOfFiveUp]: {\n\t\ttooltip: \"Four of five points beyond +1\u03C3\",\n\t\tnarration: \"Four of five points beyond one sigma (same side)\",\n\t},\n\t\t[SpcRuleId.FourOfFiveDown]: {\n\t\ttooltip: \"Four of five points beyond -1\u03C3\",\n\t\tnarration: \"Four of five points beyond one sigma (same side)\",\n\t},\n\t\t[SpcRuleId.ShiftUp]: {\n\t\ttooltip: \"Shift: run of points above centre line\",\n\t\tnarration: \"Shift (run on one side of mean)\",\n\t},\n\t\t[SpcRuleId.ShiftDown]: {\n\t\ttooltip: \"Shift: run of points below centre line\",\n\t\tnarration: \"Shift (run on one side of mean)\",\n\t},\n\t\t[SpcRuleId.TrendUp]: {\n\t\ttooltip: \"Trend: consecutive increasing points\",\n\t\tnarration: \"Trend (consecutive increases)\",\n\t},\n\t\t[SpcRuleId.TrendDown]: {\n\t\ttooltip: \"Trend: consecutive decreasing points\",\n\t\tnarration: \"Trend (consecutive decreases)\",\n\t},\n};\n\n/** Extract the triggered rule identifiers for a given SPC row */\nexport function extractRuleIds(row: SpcRow | undefined | null): SpcRuleId[] {\n\tif (!row) return [];\n\tconst ids: SpcRuleId[] = [];\n\tif (row.specialCauseSinglePointUp) ids.push(SpcRuleId.SinglePointUp);\n\tif (row.specialCauseSinglePointDown) ids.push(SpcRuleId.SinglePointDown);\n\tif (row.specialCauseTwoOfThreeUp) ids.push(SpcRuleId.TwoOfThreeUp);\n\tif (row.specialCauseTwoOfThreeDown) ids.push(SpcRuleId.TwoOfThreeDown);\n\tif (row.specialCauseFourOfFiveUp) ids.push(SpcRuleId.FourOfFiveUp);\n\tif (row.specialCauseFourOfFiveDown) ids.push(SpcRuleId.FourOfFiveDown);\n\tif (row.specialCauseShiftUp) ids.push(SpcRuleId.ShiftUp);\n\tif (row.specialCauseShiftDown) ids.push(SpcRuleId.ShiftDown);\n\tif (row.specialCauseTrendUp) ids.push(SpcRuleId.TrendUp);\n\tif (row.specialCauseTrendDown) ids.push(SpcRuleId.TrendDown);\n\treturn ids;\n}\n\n/** Standardised human readable label for variation classification */\nexport function variationLabel(icon: VariationIcon | undefined): string | null {\n\tswitch (icon) {\n\t\tcase VariationIcon.Improvement:\n\t\t\treturn \"Improvement signal\";\n\t\tcase VariationIcon.Concern:\n\t\t\treturn \"Concern signal\";\n\t\tcase VariationIcon.Neither:\n\t\t\treturn \"Common cause variation\";\n\t\tcase VariationIcon.Suppressed:\n\t\t\treturn null; // suppressed / not enough data\n\t\tdefault:\n\t\t\treturn null;\n\t}\n}\n\n/** Human readable assurance (target) classification */\nexport function assuranceLabel(icon: AssuranceIcon | undefined): string | null {\n\tswitch (icon) {\n\t\tcase AssuranceIcon.Pass:\n\t\t\treturn \"Target met\";\n\t\tcase AssuranceIcon.Fail:\n\t\t\treturn \"Target not met\";\n\t\tdefault:\n\t\t\treturn null;\n\t}\n}\n\n/** Zone classification given mean + sigma + value */\nexport function zoneLabel(\n\tmean: number | null | undefined,\n\tsigma: number,\n\tvalue: number\n): string | null {\n\tif (mean == null || !Number.isFinite(sigma) || sigma <= 0) return null;\n\tconst z = Math.abs((value - mean) / sigma);\n\tif (z < 1) return \"Within 1\u03C3\";\n\tif (z < 2) return \"Between 1\u20132\u03C3\";\n\tif (z < 3) return \"Between 2\u20133\u03C3\";\n\treturn \"Beyond 3\u03C3\";\n}\n\n// ------------------------- Shared visual tokens (source of truth) -------------------------\n// Canonical mapping of engine variation icons -> CSS token (with fallback hex).\nexport const VARIATION_COLOR_TOKENS: Record<\n\tVariationIcon,\n\t{ token: string; hex: string }\n> = {\n\timprovement: {\n\t\ttoken: \"var(--nhs-fdp-color-data-viz-spc-improvement, #00B0F0)\",\n\t\thex: \"#00B0F0\",\n\t},\n\tconcern: {\n\t\ttoken: \"var(--nhs-fdp-color-data-viz-spc-concern, #E46C0A)\",\n\t\thex: \"#E46C0A\",\n\t},\n\tneither: {\n\t\ttoken: \"var(--nhs-fdp-color-data-viz-spc-common-cause, #A6A6A6)\",\n\t\thex: \"#A6A6A6\",\n\t},\n\tsuppressed: {\n\t\ttoken: \"var(--nhs-fdp-color-data-viz-spc-no-judgement, #490092)\",\n\t\thex: \"#490092\",\n\t},\n};\n\nexport function getVariationColorToken(\n\ticon: VariationIcon | undefined\n): string {\n\tif (!icon) return VARIATION_COLOR_TOKENS.neither.token;\n\treturn (\n\t\tVARIATION_COLOR_TOKENS[icon]?.token ?? VARIATION_COLOR_TOKENS.neither.token\n\t);\n}\n\nexport function getVariationColorHex(icon: VariationIcon | undefined): string {\n\tif (!icon) return VARIATION_COLOR_TOKENS.neither.hex;\n\treturn (\n\t\tVARIATION_COLOR_TOKENS[icon]?.hex ?? VARIATION_COLOR_TOKENS.neither.hex\n\t);\n}\n", "import React, { useId, useMemo } from \"react\";\nimport { tokenColour, getGradientOpacities } from \"./tokenUtils\";\nimport {\n\tcomputePointPositions,\n\tDirection,\n\tgetVariationColour,\n\tgetVariationTrend,\n\tMetricPolarity,\n\tPoint,\n\tVariationJudgement,\n\tVariationState,\n} from \"./SPCConstants\";\n\n// Token utilities now sourced from shared tokenUtils module.\n// Import VariationIcon enum from SPC engine to permit direct usage with icon component.\n// Updated: point to advanced SPC engine (legacy ../../xmr/spc path removed during refactor)\nimport { VariationIcon as SpcEngineVariationIcon, ImprovementDirection } from \"../SPCChart/logic/spcConstants\";\nimport { SpcEmbeddedIconVariant, LetterMode, SpcLetterGlyph } from \"../SPCChart/SPCChart.constants\";\n\n// Friendly alias exported for consumers who want to pass just the engine icon key\nexport type SpcEngineIconPayload = {\n\tvariationIcon: SpcEngineVariationIcon;\n\ttrend?: Direction;\n\tpolarity?: MetricPolarity;\n};\n\n// (Removed duplicate local colour system; rely on canonical palette & helpers from SPCConstants.)\n\n// --- Point layout system ----------------------------------------------------\n// We render five recent data points; their vertical positions vary with state + direction\n// Coordinates are in icon space (300x300). We preserve r=16.\n// Chosen layouts (provided examples):\n// - special cause (current \"higher\" pattern)       : existing original coordinates\n// - special cause (\"lower\" pattern)                : alternate set provided\n// - common cause (neutral variation)               : all grey positions provided\n// - special cause no judgement uses direction to choose between higher/lower layout\n\n/**\n * Payload driving the variation icon.\n *\n * The `state` determines the SPC classification (special cause improving/deteriorating,\n * common cause or special cause with no judgement) and therefore the colour.\n * The optional `trend/direction` explicitly controls whether the variation is moving\n * higher or lower relative to the baseline. This allows all eight logical\n * permutations (state \u00D7 trend) to be specified directly. When omitted,\n * a trend will be derived for special cause improving/deteriorating states\n * only; other states will default to 'higher'.\n *\n * `polarity` is retained for alt\u2011text copy but has no effect on colour or\n * letter rendering.\n */\n/**\n * @deprecated Use engine-aligned payload: { variationIcon, improvementDirection, specialCauseNeutral?, trend? }\n * Retained temporarily for backward compatibility. Will be removed in a future minor version once downstream usages migrate.\n */\nexport interface SpcVariationPayload {\n\tstate: VariationState;\n\ttrend?: Direction; // explicitly choose geometry (higher/lower)\n\tpolarity?: MetricPolarity;\n}\n\n// New: direct engine variation icon payload (maps engine-level VariationIcon enum to a state)\nexport interface SpcVariationEngineIconPayload {\n\tvariationIcon: SpcEngineVariationIcon;\n\ttrend?: Direction; // orientation override\n\tpolarity?: MetricPolarity; // optional explicit polarity\n\timprovementDirection?: ImprovementDirection; // engine-style polarity input (preferred over polarity when provided)\n\tspecialCauseNeutral?: boolean; // distinguishes neutral special-cause (purple) from common cause when variationIcon === Neither\n\thighSideSignal?: boolean; // optional side hint for neutral special-cause arrow orientation\n\tlowSideSignal?: boolean; // optional side hint for neutral special-cause arrow orientation\n}\n\n/**\n * V2 (derivable) payload \u2013 supply semantic \"what we know\" and let the icon infer \"how to draw\".\n *\n * Inputs\n *  - judgement: SPC variation judgement at the most recent point.\n *      * improving        -> maps to VariationState.SpecialCauseImproving (special cause, positive)\n *      * deteriorating    -> maps to VariationState.SpecialCauseDeteriorating (special cause, negative)\n *      * no_judgement     -> maps to VariationState.SpecialCauseNoJudgement (special cause detected but cannot label direction)\n *      * none             -> maps to VariationState.CommonCause (no special cause)\n *  - polarity: MetricPolarity describing whether higher values are desirable, lower are desirable, or it is context dependent.\n *  - trend (optional): Explicit geometric direction (higher / lower). Only used / needed when the judgement itself does\n *    not imply a direction (no_judgement, none) OR when inference would be ambiguous (e.g. polarity context dependent).\n *\n * Derivation Logic (implemented in resolveStateAndLayout):\n *  1. State mapping is direct from judgement (see above).\n *  2. Direction inference:\n *      a. If judgement is Improving:\n *           - If polarity === LowerIsBetter, a reduction is desirable so the trend is considered Lower.\n *           - Otherwise (HigherIsBetter or ContextDependent), assume Higher.\n *      b. If judgement is Deteriorating:\n *           - If polarity === LowerIsBetter, an increase is undesirable -> direction inferred Higher.\n *           - Otherwise, inferred Lower.\n *      c. If judgement is No_Judgement or None:\n *           - We cannot infer reliably; use provided trend prop or fall back to Higher as a neutral default.\n *  3. Polarity is carried through for potential use in externally generated aria text / tooltips but does not\n *     currently alter colour once state is fixed (colour is keyed solely by final VariationState).\n *\n * Rendering Effects of Derived Values:\n *  - state selects the colour (ring, letter, special glyph) via getVariationColour(state).\n *  - direction selects which set of 5 point coordinates are used (higher vs lower layout) via computePointPositions.\n *  - letter (H / L) is only rendered when judgement is Improving or Deteriorating; it reflects the final direction.\n *  - SpecialCauseNoJudgement renders the purple arrow glyph; direction rotates / orients that glyph.\n *  - CommonCause (state = common cause) suppresses letter and arrow; all points render grey and the ring is grey.\n *  - Special cause states colour the last two data points; common cause keeps all points grey.\n *\n * When to Provide trend explicitly:\n *  - Always for judgement = No_Judgement or None (otherwise a default of Higher is applied which may misrepresent geometry).\n *  - Optionally for Improving/Deteriorating if you wish to override the inferred direction (rare; would make semantics inconsistent).\n *\n * Examples:\n *  { judgement: Improving, polarity: HigherIsBetter } -> state special_cause_improving, direction higher, letter H\n *  { judgement: Improving, polarity: LowerIsBetter }  -> state special_cause_improving, direction lower,  letter L\n *  { judgement: Deteriorating, polarity: HigherIsBetter } -> state special_cause_deteriorating, direction lower,  letter L\n *  { judgement: Deteriorating, polarity: LowerIsBetter }  -> state special_cause_deteriorating, direction higher, letter H\n *  { judgement: No_Judgement, polarity: HigherIsBetter, trend: Lower } -> state special_cause_no_judgement, direction lower, arrow rotated, no letter\n *  { judgement: None, polarity: ContextDependent, trend: Higher } -> state common_cause, direction higher, grey ring, no letter\n */\n/**\n * @deprecated Supply engine payload instead. If you still need automatic letter orientation, pass improvementDirection and omit trend.\n */\nexport interface SpcVariationDerivePayload {\n\tjudgement: VariationJudgement;\n\tpolarity: MetricPolarity;\n\ttrend?: Direction; // required when judgement is no_judgement/none OR polarity is context_dependent\n}\n\nexport type SpcVariationInput =\n\t| SpcVariationPayload\n\t| SpcVariationDerivePayload\n\t| SpcVariationParsimonious\n\t| SpcVariationEngineIconPayload;\n\n/**\n * Strict, parsimonious V2 shape \u2014 requires orientation when judgement is neutral\n * or when polarity is context-dependent. This enforces compile-time clarity.\n */\n/**\n * @deprecated Parsimonious form superseded by engine payload. Prefer { variationIcon, improvementDirection, specialCauseNeutral }.\n */\nexport type SpcVariationParsimonious =\n\t| {\n\t\t\tjudgement: VariationJudgement.Improving;\n\t\t\tpolarity: MetricPolarity.HigherIsBetter | MetricPolarity.LowerIsBetter;\n\t  }\n\t| {\n\t\t\tjudgement: VariationJudgement.Deteriorating;\n\t\t\tpolarity: MetricPolarity.HigherIsBetter | MetricPolarity.LowerIsBetter;\n\t  }\n\t| {\n\t\t\tjudgement: VariationJudgement.No_Judgement;\n\t\t\tpolarity: MetricPolarity;\n\t\t\ttrend: Direction;\n\t  }\n\t| {\n\t\t\tjudgement: VariationJudgement.None;\n\t\t\tpolarity: MetricPolarity;\n\t\t\ttrend: Direction;\n\t  };\n\nexport interface SpcVariationAltIconProps extends SpcIconBaseProps {\n\tdata: SpcVariationParsimonious;\n}\n\n/**\n * Normalise either V1 (state/layout) or V2 (judgement+polarity) into { state, layout, polarity } for rendering.\n */\nconst resolveStateAndLayout = (\n\tinput: SpcVariationInput\n): {\n\tstate: VariationState;\n\tdirection: Direction;\n\tpolarity: MetricPolarity;\n} => {\n\t// Runtime deprecation warning (fires once) for legacy payloads (state / judgement forms)\n\tconst emitDeprecation = () => {\n\t\tif (!(globalThis as any).__spcIconDeprecationEmitted) {\n\t\t\tconsole.warn(\n\t\t\t\t\"[SPCVariationIcon] Deprecated payload shape detected. Migrate to { variationIcon, improvementDirection, specialCauseNeutral?, trend? }.\"\n\t\t\t);\n\t\t\t(globalThis as any).__spcIconDeprecationEmitted = true;\n\t\t}\n\t};\n\t// Engine VariationIcon mapping support\n\tif ((input as SpcVariationEngineIconPayload).variationIcon !== undefined) {\n\t\tconst eng = input as SpcVariationEngineIconPayload;\n\t\t// Determine polarity preference: improvementDirection overrides explicit polarity prop.\n\t\tlet polarity: MetricPolarity | undefined = undefined;\n\t\tif (eng.improvementDirection !== undefined) {\n\t\t\tpolarity =\n\t\t\t\teng.improvementDirection === ImprovementDirection.Up\n\t\t\t\t\t? MetricPolarity.HigherIsBetter\n\t\t\t\t\t: eng.improvementDirection === ImprovementDirection.Down\n\t\t\t\t\t\t? MetricPolarity.LowerIsBetter\n\t\t\t\t\t\t: MetricPolarity.ContextDependent;\n\t\t} else if (eng.polarity) {\n\t\t\tpolarity = eng.polarity;\n\t\t}\n\t\t// Map engine variation icon to internal state, injecting neutral special-cause purple when flagged.\n\t\tlet state: VariationState;\n\t\tswitch (eng.variationIcon) {\n\t\t\tcase SpcEngineVariationIcon.Improvement:\n\t\t\t\tstate = VariationState.SpecialCauseImproving; break;\n\t\t\tcase SpcEngineVariationIcon.Concern:\n\t\t\t\tstate = VariationState.SpecialCauseDeteriorating; break;\n\t\t\tcase SpcEngineVariationIcon.Neither:\n\t\t\t\tstate = eng.specialCauseNeutral\n\t\t\t\t\t? VariationState.SpecialCauseNoJudgement\n\t\t\t\t\t: VariationState.CommonCause; break;\n\t\t\tcase SpcEngineVariationIcon.Suppressed:\n\t\t\tdefault:\n\t\t\t\tstate = VariationState.SpecialCauseNoJudgement; break;\n\t\t}\n\t\tlet direction: Direction | undefined = eng.trend as Direction | undefined;\n\t\tif (!direction) {\n\t\t\tif (state === VariationState.SpecialCauseImproving) {\n\t\t\t\tdirection = polarity === MetricPolarity.LowerIsBetter ? Direction.Lower : Direction.Higher;\n\t\t\t} else if (state === VariationState.SpecialCauseDeteriorating) {\n\t\t\t\tdirection = polarity === MetricPolarity.LowerIsBetter ? Direction.Higher : Direction.Lower;\n\t\t\t} else if (state === VariationState.SpecialCauseNoJudgement) {\n\t\t\t\t// Prefer explicit side hints when supplied\n\t\t\t\tif (eng.highSideSignal && !eng.lowSideSignal) direction = Direction.Higher;\n\t\t\t\telse if (eng.lowSideSignal && !eng.highSideSignal) direction = Direction.Lower;\n\t\t\t\telse direction = Direction.Higher; // fallback\n\t\t\t} else {\n\t\t\t\tdirection = Direction.Higher;\n\t\t\t}\n\t\t}\n\t\treturn { state, direction, polarity: polarity ?? MetricPolarity.ContextDependent };\n\t}\n\t// Legacy explicit state payload\n\tif ((input as SpcVariationPayload).state !== undefined) {\n\t\temitDeprecation();\n\t\tconst v1 = input as SpcVariationPayload;\n\t\tlet direction: Direction | undefined = v1.trend as Direction | undefined;\n\t\tif (\n\t\t\t!direction &&\n\t\t\t(v1.state === VariationState.SpecialCauseImproving ||\n\t\t\t\tv1.state === VariationState.SpecialCauseDeteriorating) &&\n\t\t\tv1.polarity\n\t\t) {\n\t\t\tif (v1.state === VariationState.SpecialCauseImproving) {\n\t\t\t\tdirection =\n\t\t\t\t\tv1.polarity === MetricPolarity.LowerIsBetter\n\t\t\t\t\t\t? Direction.Lower\n\t\t\t\t\t\t: Direction.Higher;\n\t\t\t} else {\n\t\t\t\tdirection =\n\t\t\t\t\tv1.polarity === MetricPolarity.LowerIsBetter\n\t\t\t\t\t\t? Direction.Higher\n\t\t\t\t\t\t: Direction.Lower;\n\t\t\t}\n\t\t}\n\t\tif (!direction) {\n\t\t\tif (v1.state === VariationState.SpecialCauseImproving)\n\t\t\t\tdirection = Direction.Higher;\n\t\t\telse if (v1.state === VariationState.SpecialCauseDeteriorating)\n\t\t\t\tdirection = Direction.Lower;\n\t\t\telse direction = Direction.Higher;\n\t\t}\n\t\treturn {\n\t\t\tstate: v1.state,\n\t\t\tdirection,\n\t\t\tpolarity: v1.polarity ?? MetricPolarity.ContextDependent,\n\t\t};\n\t}\n\t// Derivation payload based on judgement + polarity\n\tconst v2 = input as SpcVariationDerivePayload;\n\temitDeprecation();\n\tconst map: Record<VariationJudgement, VariationState> = {\n\t\t[VariationJudgement.Improving]: VariationState.SpecialCauseImproving,\n\t\t[VariationJudgement.Deteriorating]:\n\t\t\tVariationState.SpecialCauseDeteriorating,\n\t\t[VariationJudgement.No_Judgement]: VariationState.SpecialCauseNoJudgement,\n\t\t[VariationJudgement.None]: VariationState.CommonCause,\n\t};\n\tconst state = map[v2.judgement];\n\tlet direction: Direction;\n\tif (v2.judgement === VariationJudgement.Improving) {\n\t\tdirection =\n\t\t\tv2.polarity === MetricPolarity.LowerIsBetter\n\t\t\t\t? Direction.Lower\n\t\t\t\t: Direction.Higher;\n\t} else if (v2.judgement === VariationJudgement.Deteriorating) {\n\t\tdirection =\n\t\t\tv2.polarity === MetricPolarity.LowerIsBetter\n\t\t\t\t? Direction.Higher\n\t\t\t\t: Direction.Lower;\n\t} else {\n\t\tdirection = (v2.trend ?? Direction.Higher) as Direction;\n\t}\n\treturn { state, direction, polarity: v2.polarity };\n};\n\n/**\n * Derive a rich, sentence\u2011level aria description for assistive tech.\n * This version aligns with MDC accessibility and NHS style.\n */\nexport interface VariationNarrativeContext {\n\tmeasureName?: string; // e.g. \"Emergency department 4h performance\"\n\tdatasetContext?: string; // e.g. \"Monthly trust-wide data\"\n\torganisation?: string; // e.g. \"University Hospital A\"\n\ttimeframe?: string; // e.g. \"Jan 2024 \u2013 Jul 2025\"\n\tadditionalNote?: string; // free-form note (intervention, caveat)\n}\n\nexport function deriveVariationAriaDescription(\n\tinput: SpcVariationInput,\n\tcontext?: VariationNarrativeContext\n): string {\n\tconst { state, direction, polarity } = resolveStateAndLayout(input);\n\tconst judgement = getVariationTrend(state);\n\n\t// Use plain-English SPC phrasing: sustained run above/below the mean\n\tconst sideWord = direction === Direction.Higher ? \"above\" : \"below\";\n\tconst trendWord = direction === Direction.Higher ? \"upwards\" : \"downwards\";\n\n\tconst polarityClause = (() => {\n\t\tswitch (polarity) {\n\t\t\tcase MetricPolarity.HigherIsBetter:\n\t\t\t\treturn \"For this measure, higher values are better.\";\n\t\t\tcase MetricPolarity.LowerIsBetter:\n\t\t\t\treturn \"For this measure, lower values are better.\";\n\t\t\tdefault:\n\t\t\t\treturn \"Direction of improvement is context dependent.\";\n\t\t}\n\t})();\n\n\tconst base = (() => {\n\t\tswitch (judgement) {\n\t\t\tcase VariationJudgement.Improving:\n\t\t\t\treturn `Special cause improvement: recent data show a sustained run ${sideWord} the mean (unlikely due to random variation).`;\n\t\t\tcase VariationJudgement.Deteriorating:\n\t\t\t\treturn `Special cause deterioration: recent data show a sustained run ${sideWord} the mean (unlikely due to random variation).`;\n\t\t\tcase VariationJudgement.No_Judgement:\n\t\t\t\treturn `Special cause detected (no value judgement): recent data show a change in level, trending ${trendWord}.`;\n\t\t\tcase VariationJudgement.None:\n\t\t\tdefault:\n\t\t\t\treturn `Common cause variation: points vary randomly around the mean; no special cause detected.`;\n\t\t}\n\t})();\n\n\tconst parts = [\n\t\tbase,\n\t\tpolarityClause,\n\t\tcontext?.measureName ? `Measure: ${context.measureName}.` : null,\n\t\tcontext?.datasetContext ? `${context.datasetContext}.` : null,\n\t\tcontext?.organisation ? `Organisation: ${context.organisation}.` : null,\n\t\tcontext?.timeframe ? `Timeframe: ${context.timeframe}.` : null,\n\t\tcontext?.additionalNote ? context.additionalNote : null,\n\t];\n\treturn parts.filter(Boolean).join(\" \");\n}\n\n/** Assurance states \u2013 SPC\u2011based likelihood to meet target consistently. */\nexport type AssuranceState = \"likely\" | \"unlikely\" | \"uncertain\";\n\nexport interface SpcAssurancePayload {\n\tstate: AssuranceState; // No RAG colours; neutral glyphs.\n\ttargetLabel?: string; // e.g., \"95% within 4h\"\n}\n\n/** Shared visual props */\nexport interface SpcIconBaseProps {\n\tsize?: number; // px; default 44. Consider 32\u201344 for dense tables.\n\tariaLabel?: string; // override accessible label\n\tshowLetter?: boolean; // default true \u2014 render H/L\n\tdropShadow?: boolean; // default true \u2013 apply outer circle shadow\n\t/** When true, apply a diagonal (top-left -> bottom-right) colour wash instead of solid white interior. */\n\tgradientWash?: boolean;\n}\n\nexport interface SPCVariationIconProps extends SpcIconBaseProps {\n\tdata: SpcVariationInput;\n}\n\nexport interface SpcAssuranceIconProps extends SpcIconBaseProps {\n\tdata: SpcAssurancePayload;\n}\n\nexport interface SpcIconsProps {\n\tvariation: SPCVariationIconProps[\"data\"];\n\tassurance: SpcAssuranceIconProps[\"data\"];\n\tsize?: number;\n\tariaLabel?: string; // combined label for the pair\n}\n\n// Derive an H/L direction from the SPC state for backward compatibility.\n// Improving states imply movement upwards; deteriorating states imply downwards.\n// For states without an inherent judgement (common cause or no judgement),\n// return null to allow callers to specify their own direction.\n\nexport interface SPCVariationIconPropsAlt extends SPCVariationIconProps {\n\tvariant?: SpcEmbeddedIconVariant;\n\trunLength?: number;\n\t/** How to derive H/L when shown (default: direction). */\n\tletterMode?: LetterMode;\n\t/** Explicit override for the letter (takes precedence). Use '' to suppress. */\n\tletterOverride?: SpcLetterGlyph;\n}\n// (imports consolidated above)\n\n// Shared defs (filter + gradient) helper to avoid repetition across variants\nconst buildDefs = (\n\tcolourHex: string,\n\tshadowId: string,\n\twashId: string,\n\tdropShadow: boolean,\n\tgradientWash: boolean,\n\tstops: Array<{ offset: string; opacity: string }>\n) => (\n\t<defs>\n\t\t{dropShadow && (\n\t\t\t<filter id={shadowId} filterUnits=\"objectBoundingBox\">\n\t\t\t\t<feGaussianBlur stdDeviation=\"3\" />\n\t\t\t\t<feOffset dx=\"0\" dy=\"15\" result=\"blur\" />\n\t\t\t\t<feFlood floodColor=\"rgb(150,150,150)\" floodOpacity=\"1\" />\n\t\t\t\t<feComposite in2=\"blur\" operator=\"in\" result=\"colorShadow\" />\n\t\t\t\t<feComposite in=\"SourceGraphic\" in2=\"colorShadow\" operator=\"over\" />\n\t\t\t</filter>\n\t\t)}\n\t\t{gradientWash && (\n\t\t\t<linearGradient id={washId} x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n\t\t\t\t{stops.map((s) => (\n\t\t\t\t\t<stop\n\t\t\t\t\t\tkey={s.offset}\n\t\t\t\t\t\toffset={s.offset}\n\t\t\t\t\t\tstopColor={colourHex}\n\t\t\t\t\t\tstopOpacity={parseFloat(s.opacity)}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</linearGradient>\n\t\t)}\n\t</defs>\n);\n\nexport const SPCVariationIcon = ({\n\tdata,\n\tsize = 44,\n\tariaLabel,\n\tshowLetter = true,\n\tdropShadow = true,\n\tgradientWash = false,\n\tvariant = SpcEmbeddedIconVariant.Classic,\n\trunLength = 0,\n\t// Default changed to 'polarity' so letters reflect desirable direction (H = Higher is better, L = Lower is better)\n\tletterMode = LetterMode.Polarity,\n\tletterOverride,\n\t...rest\n}: SPCVariationIconPropsAlt & Record<string, unknown>) => {\n\tconst shadowId = useId();\n\tconst washId = useId();\n\t// Gradient opacities (classic + triangle variants)\n\tconst {\n\t\tstart: gradStart,\n\t\tmid: gradMid,\n\t\tend: gradEnd,\n\t\ttriStart: triGradStart,\n\t\ttriMid: triGradMid,\n\t\ttriEnd: triGradEnd,\n\t} = getGradientOpacities();\n\n\t// Resolve semantic state + layout once\n\tconst { state, direction, polarity } = useMemo(\n\t\t() => resolveStateAndLayout(data as SpcVariationInput),\n\t\t[data]\n\t);\n\tconst colour = useMemo(() => getVariationColour(state), [state]);\n\tconst judgement = useMemo(() => getVariationTrend(state), [state]);\n\tconst showLetterForJudgement =\n\t\tjudgement === VariationJudgement.Improving ||\n\t\tjudgement === VariationJudgement.Deteriorating;\n\tlet letter = \"\";\n\t\n\tif (showLetter && showLetterForJudgement) {\n\t\tif (letterMode === LetterMode.Polarity) {\n\t\t\tif (polarity === MetricPolarity.HigherIsBetter) letter = \"H\";\n\t\t\telse if (polarity === MetricPolarity.LowerIsBetter) letter = \"L\";\n\t\t\telse letter = \"\";\n\t\t} else {\n\t\t\tletter = direction === Direction.Higher ? \"H\" : \"L\";\n\t\t}\n\t}\n\t\n\tif (letterOverride !== undefined) letter = letterOverride;\n\tconst isSpecial = state !== VariationState.CommonCause;\n\tconst isNoJudgement = state === VariationState.SpecialCauseNoJudgement;\n\tconst neutralGrey = tokenColour(\"common-cause\", \"#A6A6A6\");\n\tconst pointColour = isSpecial ? colour.hex : neutralGrey;\n\tconst points: Point[] = useMemo(\n\t\t() => computePointPositions(state, direction),\n\t\t[state, direction]\n\t);\n\tconst aria =\n\t\tariaLabel ||\n\t\t`${colour.label}${\n\t\t\tletter ? (direction === Direction.Higher ? \" \u2013 Higher\" : \" \u2013 Lower\") : \"\"\n\t\t}`;\n\tconst ariaDescription = deriveVariationAriaDescription(\n\t\tdata as SpcVariationInput\n\t);\n\n\t// --- Triangle with run rendering (new) ---\n\tif (variant === SpcEmbeddedIconVariant.TriangleWithRun) {\n\t\t// Short triangle with run indicator (five small circles)\n\t\tconst triSize = 100;\n\t\tconst centerX = 150;\n\t\tconst centerY = 140;\n\t\tconst upTriangle = [\n\t\t\t[centerX, centerY - triSize / 2],\n\t\t\t[centerX - triSize / 2, centerY + triSize / 2],\n\t\t\t[centerX + triSize / 2, centerY + triSize / 2],\n\t\t];\n\t\tconst downTriangle = [\n\t\t\t[centerX, centerY + triSize / 2],\n\t\t\t[centerX - triSize / 2, centerY - triSize / 2],\n\t\t\t[centerX + triSize / 2, centerY - triSize / 2],\n\t\t];\n\t\t// flatLine intentionally omitted \u2014 rendered as a short line when needed directly in JSX\n\t\tlet shape: React.ReactNode = null;\n\t\t// Orientation now driven by inferred direction (not raw improving/deteriorating state) so\n\t\t// \"improving\" with LowerIsBetter shows a downward triangle and \"deteriorating\" with LowerIsBetter shows upward.\n\t\tif (\n\t\t\tstate === VariationState.SpecialCauseImproving ||\n\t\t\tstate === VariationState.SpecialCauseDeteriorating\n\t\t) {\n\t\t\tshape = (\n\t\t\t\t<polygon\n\t\t\t\t\tpoints={(direction === Direction.Higher ? upTriangle : downTriangle)\n\t\t\t\t\t\t.map((p) => p.join(\",\"))\n\t\t\t\t\t\t.join(\" \")}\n\t\t\t\t\tfill={colour.hex}\n\t\t\t\t\tstroke={colour.hex}\n\t\t\t\t\tstrokeWidth={6}\n\t\t\t\t\ttransform={\n\t\t\t\t\t\tdirection === Direction.Higher\n\t\t\t\t\t\t\t? \"translate(0, -8)\"\n\t\t\t\t\t\t\t: \"translate(0, 15)\"\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t);\n\t\t} else if (state === VariationState.SpecialCauseNoJudgement) {\n\t\t\tshape = (\n\t\t\t\t<polygon\n\t\t\t\t\tpoints={\n\t\t\t\t\t\tdirection === Direction.Higher\n\t\t\t\t\t\t\t? upTriangle.map((p) => p.join(\",\")).join(\" \")\n\t\t\t\t\t\t\t: downTriangle.map((p) => p.join(\",\")).join(\" \")\n\t\t\t\t\t}\n\t\t\t\t\tfill={colour.hex}\n\t\t\t\t\tstroke={colour.hex}\n\t\t\t\t\tstrokeWidth={6}\n\t\t\t\t\ttransform={\n\t\t\t\t\t\tdirection === Direction.Higher\n\t\t\t\t\t\t\t? \"translate(0,-7)\"\n\t\t\t\t\t\t\t: \"translate(0,14)\"\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\t// Run circles\n\t\tconst runLen = Math.max(0, Math.min(5, Math.floor(runLength || 0)));\n\t\tconst runY = state === VariationState.CommonCause ? 160 : direction === Direction.Higher ? 220 : 70;\n\t\tconst runRadius = 10;\n\t\tconst runGap = 26;\n\t\tconst runStartX = centerX - 2 * runGap;\n\t\tconst runColor = state === VariationState.SpecialCauseImproving\n\t\t\t\t? tokenColour(\"improvement\", \"#00B0F0\")\n\t\t\t\t: state === VariationState.SpecialCauseDeteriorating\n\t\t\t\t\t? tokenColour(\"concern\", \"#E46C0A\")\n\t\t\t\t\t: neutralGrey;\n\t\tconst runCircles = Array.from({ length: 5 }).map((_, i) => {\n\t\tconst filled = (state === VariationState.SpecialCauseImproving ||\n\t\t\t\tstate === VariationState.SpecialCauseDeteriorating) &&\n\t\t\t\ti >= 5 - runLen;\n\t\t\tconst fill = filled ? runColor : neutralGrey;\n\t\t\treturn (\n\t\t\t\t<circle\n\t\t\t\t\tkey={i}\n\t\t\t\t\tcx={runStartX + i * runGap}\n\t\t\t\t\tcy={runY}\n\t\t\t\t\tr={runRadius}\n\t\t\t\t\tfill={fill}\n\t\t\t\t\tstroke={fill}\n\t\t\t\t\tstrokeWidth={1}\n\t\t\t\t/>\n\t\t\t);\n\t\t});\n\t\tconst defs = buildDefs(\n\t\t\tcolour.hex,\n\t\t\tshadowId,\n\t\t\twashId,\n\t\t\tdropShadow,\n\t\t\tgradientWash,\n\t\t\t[\n\t\t\t\t{ offset: \"0%\", opacity: triGradStart },\n\t\t\t\t{ offset: \"75%\", opacity: triGradMid },\n\t\t\t\t{ offset: \"100%\", opacity: triGradEnd },\n\t\t\t]\n\t\t);\n\t\t// Keep common cause visually consistent regardless of supplied direction by fixing transform.\n\t\tconst groupTransform =\n\t\t\tstate === VariationState.CommonCause\n\t\t\t? \"translate(0,-10)\" // mimic the higher layout centring\n\t\t\t: direction === Direction.Higher\n\t\t\t? \"translate(0,-10)\"\n\t\t\t: \"translate(0,25)\";\n\t\treturn (\n\t\t\t<svg\n\t\t\t\twidth={size}\n\t\t\t\theight={size}\n\t\t\t\tviewBox=\"0 0 300 300\"\n\t\t\t\trole=\"img\"\n\t\t\t\taria-label={aria}\n\t\t\t\taria-description={ariaDescription}\n\t\t\t\t{...rest}\n\t\t\t>\n\t\t\t\t{defs}\n\t\t\t\t<circle\n\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\tfill={gradientWash ? `url(#${washId})` : \"#ffffff\"}\n\t\t\t\t\t{...(dropShadow ? { filter: `url(#${shadowId})` } : {})}\n\t\t\t\t\tcx=\"150\"\n\t\t\t\t\tcy=\"150\"\n\t\t\t\t\tr=\"120\"\n\t\t\t\t/>\n\t\t\t\t<circle\n\t\t\t\t\tstroke={colour.hex}\n\t\t\t\t\tstrokeWidth={15}\n\t\t\t\t\tstrokeMiterlimit={10}\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tcx=\"150\"\n\t\t\t\t\tcy=\"150\"\n\t\t\t\t\tr=\"120\"\n\t\t\t\t/>\n\t\t\t\t<g transform={groupTransform}>\n\t\t\t\t\t{shape}\n\t\t\t\t\t{letter && (\n\t\t\t\t\t\t<text\n\t\t\t\t\t\t\tfill=\"#fff\"\n\t\t\t\t\t\t\tfontFamily=\"'Frutiger W01', Frutiger, Arial, 'Helvetica Neue', Helvetica, sans-serif\"\n\t\t\t\t\t\t\tfontWeight=\"bold\"\n\t\t\t\t\t\t\tfontSize={64}\n\t\t\t\t\t\t\tx=\"150\"\n\t\t\t\t\t\t\ty={direction === Direction.Higher ? 155 : 145}\n\t\t\t\t\t\t\ttextAnchor=\"middle\"\n\t\t\t\t\t\t\tdominantBaseline=\"middle\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{letter}\n\t\t\t\t\t\t</text>\n\t\t\t\t\t)}\n\t\t\t\t\t{runCircles}\n\t\t\t\t</g>\n\t\t\t</svg>\n\t\t);\n\t}\n\n\t// --- Alternative triangle rendering ---\n\tif (variant === SpcEmbeddedIconVariant.Triangle) {\n\t\t// Triangle geometry\n\t\t// Upward triangle: base at bottom, tip at top\n\t\t// Downward triangle: base at top, tip at bottom\n\t\t// Centered at (150,150), size ~120px\n\t\tconst triSize = 150;\n\t\tconst centerX = 150;\n\t\tconst centerY = 150;\n\t\tconst upTriangle = [\n\t\t\t[centerX, centerY - triSize / 2],\n\t\t\t[centerX - triSize / 2, centerY + triSize / 2],\n\t\t\t[centerX + triSize / 2, centerY + triSize / 2],\n\t\t];\n\t\tconst downTriangle = [\n\t\t\t[centerX, centerY + triSize / 2],\n\t\t\t[centerX - triSize / 2, centerY - triSize / 2],\n\t\t\t[centerX + triSize / 2, centerY - triSize / 2],\n\t\t];\n\t\t// Flat line for neither\n\t\tconst flatLine = [\n\t\t\t[centerX - triSize / 2, centerY + triSize / 2],\n\t\t\t[centerX + triSize / 2, centerY + triSize / 2],\n\t\t];\n\t\tlet shape: React.ReactNode = null;\n\t\t// Orientation now driven by direction (not state) for the same semantic reason as triangleWithRun.\n\t\tif (\n\t\t\tstate === VariationState.SpecialCauseImproving ||\n\t\t\tstate === VariationState.SpecialCauseDeteriorating\n\t\t) {\n\t\t\tshape = (\n\t\t\t\t<polygon\n\t\t\t\t\tpoints={(direction === Direction.Higher ? upTriangle : downTriangle)\n\t\t\t\t\t\t.map((p) => p.join(\",\"))\n\t\t\t\t\t\t.join(\" \")}\n\t\t\t\t\tfill={colour.hex}\n\t\t\t\t\tstroke={colour.hex}\n\t\t\t\t\tstrokeWidth={8}\n\t\t\t\t\ttransform={\n\t\t\t\t\t\tdirection === Direction.Higher\n\t\t\t\t\t\t\t? \"translate(0, -10)\"\n\t\t\t\t\t\t\t: \"translate(0, 10)\"\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t);\n\t\t} else if (state === VariationState.SpecialCauseNoJudgement) {\n\t\t\t// Up or down triangle, no letter\n\t\t\tshape = (\n\t\t\t\t<polygon\n\t\t\t\t\tpoints={\n\t\t\t\t\t\tdirection === Direction.Higher\n\t\t\t\t\t\t\t? upTriangle.map((p) => p.join(\",\")).join(\" \")\n\t\t\t\t\t\t\t: downTriangle.map((p) => p.join(\",\")).join(\" \")\n\t\t\t\t\t}\n\t\t\t\t\tfill={colour.hex}\n\t\t\t\t\tstroke={colour.hex}\n\t\t\t\t\tstrokeWidth={8}\n\t\t\t\t\ttransform={\n\t\t\t\t\t\tdirection === Direction.Higher\n\t\t\t\t\t\t\t? \"translate(0, -15)\"\n\t\t\t\t\t\t\t: \"translate(0, 15)\"\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t);\n\t\t} else if (state === VariationState.CommonCause) {\n\t\t\t// Flat line\n\t\t\tshape = (\n\t\t\t\t<line\n\t\t\t\t\tx1={flatLine[0][0]}\n\t\t\t\t\ty1={flatLine[0][1]}\n\t\t\t\t\tx2={flatLine[1][0]}\n\t\t\t\t\ty2={flatLine[1][1]}\n\t\t\t\t\tstroke={colour.hex}\n\t\t\t\t\tstrokeWidth={32}\n\t\t\t\t\tstrokeLinecap=\"square\"\n\t\t\t\t\ttransform=\"translate(0, -75)\"\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t\tconst defs = buildDefs(\n\t\t\tcolour.hex,\n\t\t\tshadowId,\n\t\t\twashId,\n\t\t\tdropShadow,\n\t\t\tgradientWash,\n\t\t\t[\n\t\t\t\t{ offset: \"0%\", opacity: triGradStart },\n\t\t\t\t{ offset: \"65%\", opacity: triGradMid },\n\t\t\t\t{ offset: \"100%\", opacity: triGradEnd },\n\t\t\t]\n\t\t);\n\t\treturn (\n\t\t\t<svg\n\t\t\t\twidth={size}\n\t\t\t\theight={size}\n\t\t\t\tviewBox=\"0 0 300 300\"\n\t\t\t\trole=\"img\"\n\t\t\t\taria-label={aria}\n\t\t\t\taria-description={ariaDescription}\n\t\t\t\t{...rest}\n\t\t\t>\n\t\t\t\t{defs}\n\t\t\t\t<circle\n\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\tfill={gradientWash ? `url(#${washId})` : \"#ffffff\"}\n\t\t\t\t\t{...(dropShadow ? { filter: `url(#${shadowId})` } : {})}\n\t\t\t\t\tcx=\"150\"\n\t\t\t\t\tcy=\"150\"\n\t\t\t\t\tr=\"120\"\n\t\t\t\t/>\n\t\t\t\t<circle\n\t\t\t\t\tstroke={colour.hex}\n\t\t\t\t\tstrokeWidth={15}\n\t\t\t\t\tstrokeMiterlimit={10}\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tcx=\"150\"\n\t\t\t\t\tcy=\"150\"\n\t\t\t\t\tr=\"120\"\n\t\t\t\t/>\n\t\t\t\t{shape}\n\t\t\t\t{letter &&\n\t\t\t\t\t(state === VariationState.SpecialCauseImproving ||\n\t\t\t\t\t\tstate === VariationState.SpecialCauseDeteriorating) && (\n\t\t\t\t\t\t<text\n\t\t\t\t\t\t\tfill=\"#fff\"\n\t\t\t\t\t\t\tfontFamily=\"'Frutiger W01', Frutiger, Arial, 'Helvetica Neue', Helvetica, sans-serif\"\n\t\t\t\t\t\t\tfontWeight=\"bold\"\n\t\t\t\t\t\t\tfontSize={100}\n\t\t\t\t\t\t\tx=\"150\"\n\t\t\t\t\t\t\ty={direction === Direction.Higher ? \"170\" : \"140\"}\n\t\t\t\t\t\t\ttextAnchor=\"middle\"\n\t\t\t\t\t\t\tdominantBaseline=\"middle\"\n\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{letter}\n\t\t\t\t\t\t</text>\n\t\t\t\t\t)}\n\t\t\t</svg>\n\t\t);\n\t}\n\n\t// --- Default/classic rendering ---\n\tconst defs = buildDefs(\n\t\tcolour.hex,\n\t\tshadowId,\n\t\twashId,\n\t\tdropShadow,\n\t\tgradientWash,\n\t\t[\n\t\t\t{ offset: \"0%\", opacity: gradStart },\n\t\t\t{ offset: \"65%\", opacity: gradMid },\n\t\t\t{ offset: \"100%\", opacity: gradEnd },\n\t\t]\n\t);\n\treturn (\n\t\t<svg\n\t\t\twidth={size}\n\t\t\theight={size}\n\t\t\tviewBox=\"0 0 300 300\"\n\t\t\trole=\"img\"\n\t\t\taria-label={aria}\n\t\t\taria-description={ariaDescription}\n\t\t\t{...rest}\n\t\t>\n\t\t\t{defs}\n\t\t\t<circle\n\t\t\t\tstroke=\"none\"\n\t\t\t\tfill={gradientWash ? `url(#${washId})` : \"#ffffff\"}\n\t\t\t\t{...(dropShadow ? { filter: `url(#${shadowId})` } : {})}\n\t\t\t\tcx=\"150\"\n\t\t\t\tcy=\"150\"\n\t\t\t\tr=\"120\"\n\t\t\t/>\n\t\t\t<circle\n\t\t\t\tstroke={colour.hex}\n\t\t\t\tstrokeWidth={15}\n\t\t\t\tstrokeMiterlimit={10}\n\t\t\t\tfill=\"none\"\n\t\t\t\tcx=\"150\"\n\t\t\t\tcy=\"150\"\n\t\t\t\tr=\"120\"\n\t\t\t/>\n\t\t\t{letter && (\n\t\t\t\t<text\n\t\t\t\t\tfill={colour.hex}\n\t\t\t\t\tfontFamily=\"Arial-BoldMT, Arial, 'Helvetica Neue', Helvetica, sans-serif\"\n\t\t\t\t\tfontWeight=\"bold\"\n\t\t\t\t\tfontSize={176}\n\t\t\t\t\ttransform=\"translate(86.67, 54) scale(0.5, 0.5)\"\n\t\t\t\t\ttextAnchor=\"end\"\n\t\t\t\t>\n\t\t\t\t\t<tspan x=\"120\" y={direction === Direction.Lower ? \"340\" : \"155\"}>\n\t\t\t\t\t\t{letter}\n\t\t\t\t\t</tspan>\n\t\t\t\t</text>\n\t\t\t)}\n\t\t\t{/* Special Cause (No Judgement) arrow glyph: vertical arrow indicating orientation.\n\t\t\t\tUp (layout Higher) shows arrow pointing up; Down (layout Lower) rotates 90\u00B0. */}\n\t\t\t{isNoJudgement ? (\n\t\t\t\t<path\n\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\tfillRule=\"evenodd\"\n\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\tfill={colour.hex}\n\t\t\t\t\t{...(direction === Direction.Lower\n\t\t\t\t\t\t? { transform: \"rotate(90 150 150)\" }\n\t\t\t\t\t\t: { transform: \"translate(-5 0) rotate(0 150 150)\" })}\n\t\t\t\t\td=\"M 90.26,185.42 L 149.31,126.37 127.44,104.51 209.81,90.66 195.96,173.02 174.09,151.16 115.05,210.2 90.26,185.42 Z M 90.26,185.42\"\n\t\t\t\t/>\n\t\t\t) : (\n\t\t\t\t<>\n\t\t\t\t\t{/* Trend path connecting the five point centres */}\n\t\t\t\t\t{points.length === 5 && (\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\tstroke={neutralGrey}\n\t\t\t\t\t\t\tstrokeWidth={12}\n\t\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\t\topacity={0.9}\n\t\t\t\t\t\t\td={`M ${points.map((p) => `${p.cx} ${p.cy}`).join(\" L \")}`}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{/* Data points (last two coloured when judgement positive or negative) */}\n\t\t\t\t\t{points.map((p: Point, i: number) => {\n\t\t\t\t\t\tconst specialIdx = i >= points.length - 2 && isSpecial; // last two\n\t\t\t\t\t\tconst fill = specialIdx ? pointColour : neutralGrey;\n\t\t\t\t\t\tconst stroke = fill;\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<circle\n\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\tstroke={stroke}\n\t\t\t\t\t\t\t\tstrokeWidth={2}\n\t\t\t\t\t\t\t\tstrokeMiterlimit={10}\n\t\t\t\t\t\t\t\tfill={fill}\n\t\t\t\t\t\t\t\tcx={p.cx}\n\t\t\t\t\t\t\t\tcy={p.cy}\n\t\t\t\t\t\t\t\tr={16}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</>\n\t\t\t)}\n\t\t</svg>\n\t);\n};\n\nSPCVariationIcon.displayName = \"SPCVariationIcon\";\n", "// Shared token lookup utilities for SPC icons.\nlet spcTokenRoot: Record<string, any> | null = null;\ntry {\n\t// Dynamic require to avoid breaking SSR if tokens file not present at runtime.\n\t// @ts-ignore - compiled artifact path resolved post-build\n\tconst tokens = require(\"@fergusbisset/nhs-fdp-design-system/dist/js/tokens.json\");\n\tspcTokenRoot = tokens?.color?.[\"data-viz\"]?.spc || null;\n} catch {\n\t// Swallow \u2013 fall back to provided colour fallbacks.\n}\n\nexport const tokenColour = (key: string, fallback: string): string => {\n\tif (!spcTokenRoot) return fallback;\n\tconst parts = key.split(\".\");\n\tlet current: any = spcTokenRoot;\n\tfor (const p of parts) {\n\t\tif (current == null) break;\n\t\tcurrent = current[p];\n\t}\n\tconst val = current;\n\tif (val == null) return fallback;\n\tif (typeof val === \"string\" || typeof val === \"number\") return String(val);\n\tif (val.$value != null) return String(val.$value);\n\tif (val.value != null) return String(val.value);\n\treturn fallback;\n};\n\nexport const getGradientOpacities = () => ({\n\t// Lightened defaults (previous 0.18 -> 0.12, 0.06 -> 0.03) to reduce intensity of wash.\n\tstart: tokenColour(\"gradient.stop.start-opacity\", \"0.12\"),\n\tmid: tokenColour(\"gradient.stop.mid-opacity\", \"0.03\"),\n\tend: tokenColour(\"gradient.stop.end-opacity\", \"0\"),\n\ttriStart: tokenColour(\n\t\t\"gradient.stop.triangle-start-opacity\",\n\t\ttokenColour(\"gradient.stop.start-opacity\", \"0.12\")\n\t),\n\ttriMid: tokenColour(\n\t\t\"gradient.stop.triangle-mid-opacity\",\n\t\ttokenColour(\"gradient.stop.mid-opacity\", \"0.03\")\n\t),\n\ttriEnd: tokenColour(\n\t\t\"gradient.stop.triangle-end-opacity\",\n\t\ttokenColour(\"gradient.stop.end-opacity\", \"0\")\n\t),\n});\n", "// Simple three\u2011state assurance enum\nexport enum AssuranceResult {\n\tPass = \"pass\",\n\tFail = \"fail\",\n\tUncertain = \"uncertain\",\n}\n\n// Pull canonical SPC palette from engine logic (source of truth)\nimport { VARIATION_COLOR_TOKENS } from \"../SPCChart/logic/spcDescriptors\";\n\n// Default colours aligned to variation icon palette\nexport const DEFAULT_COLOURS: Record<AssuranceResult, string> = {\n\t[AssuranceResult.Pass]: \"#00B0F0\", // blue\n\t[AssuranceResult.Fail]: \"#E46C0A\", // orange\n\t[AssuranceResult.Uncertain]: \"#A6A6A6\", // grey\n};\n\n// Default letters to show for each state\nexport const DEFAULT_LETTERS: Record<AssuranceResult, string> = {\n\t[AssuranceResult.Pass]: \"P\",\n\t[AssuranceResult.Fail]: \"F\",\n\t[AssuranceResult.Uncertain]: \"?\",\n};\n\n// Metric polarity tells us if \"higher\" is good or bad for interpretation text.\nexport enum MetricPolarity {\n\tHigherIsBetter = \"higher_is_better\",\n\tLowerIsBetter = \"lower_is_better\",\n\tContextDependent = \"context_dependent\",\n}\n\n// Orientation / geometry (was TrendDirection / Layout earlier)\nexport enum Direction {\n\tHigher = \"higher\",\n\tLower = \"lower\",\n}\n\nexport enum VariationJudgement {\n\tImproving = \"improving\",\n\tDeteriorating = \"deteriorating\",\n\tNo_Judgement = \"no_judgement\",\n\tNone = \"none\",\n}\n\nexport enum VariationState {\n\tSpecialCauseImproving = \"special_cause_improving\",\n\tSpecialCauseDeteriorating = \"special_cause_deteriorating\",\n\tCommonCause = \"common_cause\",\n\tSpecialCauseNoJudgement = \"special_cause_no_judgement\",\n}\n\nexport interface VariationColourDef {\n\thex: string;\n\tstroke?: string;\n\tfill?: string;\n\tlabel: string;\n\tdescription: string;\n\ttext?: string;\n\tjudgement?: VariationJudgement;\n}\n\n// Geometry constants (legacy 300x300 artboard)\nexport const ICON_VIEWBOX = \"0 0 300 300\";\nexport const ICON_SIZE = 300; // default px\nexport const ICON_CX = 150;\nexport const ICON_CY = 150;\nexport const ICON_R = 113.25;\nexport const POINT_RADIUS = 16;\n\n// Base polygon path currently used for No Judgement glyph (points upward by default)\nexport const NO_JUDGEMENT_GLYPH_PATH =\n\t\"M 90.26,185.42 L 149.31,126.37 127.44,104.51 209.81,90.66 195.96,173.02 174.09,151.16 115.05,210.2 90.26,185.42 Z M 90.26,185.42\";\n\n// Accessible text colour picker (simple luminance threshold)\nconst pickTextColour = (hex: string) => {\n\tconst c = hex.replace(\"#\", \"\");\n\tconst r = parseInt(c.slice(0, 2), 16) / 255;\n\tconst g = parseInt(c.slice(2, 4), 16) / 255;\n\tconst b = parseInt(c.slice(4, 6), 16) / 255;\n\tconst srgb = [r, g, b].map((v) =>\n\t\tv <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4)\n\t);\n\tconst L = 0.2126 * srgb[0] + 0.7152 * srgb[1] + 0.0722 * srgb[2];\n\treturn L < 0.55 ? \"#ffffff\" : \"#212b32\";\n};\n\nexport const VARIATION_COLOURS: Record<VariationState, VariationColourDef> = {\n\t[VariationState.SpecialCauseDeteriorating]: {\n\t\thex: VARIATION_COLOR_TOKENS.concern.hex,\n\t\tjudgement: VariationJudgement.Deteriorating,\n\t\tlabel: \"Special Cause (Deteriorating)\",\n\t\tdescription:\n\t\t\t\"Deteriorating variation detected (special cause) relative to baseline.\",\n\t},\n\t[VariationState.SpecialCauseImproving]: {\n\t\thex: VARIATION_COLOR_TOKENS.improvement.hex,\n\t\tjudgement: VariationJudgement.Improving,\n\t\tlabel: \"Special Cause (Improving)\",\n\t\tdescription:\n\t\t\t\"Improving variation detected (special cause) relative to baseline.\",\n\t},\n\t[VariationState.CommonCause]: {\n\t\thex: VARIATION_COLOR_TOKENS.neither.hex,\n\t\tjudgement: VariationJudgement.None,\n\t\tlabel: \"Common Cause\",\n\t\tdescription: \"Common cause variation only \u2013 no special cause detected.\",\n\t},\n\t[VariationState.SpecialCauseNoJudgement]: {\n\t\thex: VARIATION_COLOR_TOKENS.suppressed.hex,\n\t\tjudgement: VariationJudgement.No_Judgement,\n\t\tlabel: \"Special Cause (No Judgement)\",\n\t\tdescription:\n\t\t\t\"Special cause detected without assigning improving/deteriorating judgement.\",\n\t},\n};\n\nObject.values(VARIATION_COLOURS).forEach((def) => {\n\tif (!def.text) def.text = pickTextColour(def.hex);\n});\n\nexport const getVariationColour = (state: VariationState) =>\n\tVARIATION_COLOURS[state];\nexport const getVariationTrend = (state: VariationState): VariationJudgement =>\n\tVARIATION_COLOURS[state].judgement || VariationJudgement.None;\n\nexport interface Point {\n\tcx: number;\n\tcy: number;\n}\n\nexport const POINT_LAYOUTS = {\n\tspecial: {\n\t\thigher: [\n\t\t\t{ cx: 77.5, cy: 158.5 },\n\t\t\t{ cx: 114, cy: 175 },\n\t\t\t{ cx: 150.5, cy: 158.5 },\n\t\t\t{ cx: 188, cy: 125 },\n\t\t\t{ cx: 225, cy: 137 },\n\t\t],\n\t\tlower: [\n\t\t\t{ cx: 77.5, cy: 139.5 },\n\t\t\t{ cx: 114, cy: 124.5 },\n\t\t\t{ cx: 150.5, cy: 139.5 },\n\t\t\t{ cx: 188, cy: 175.5 },\n\t\t\t{ cx: 224.5, cy: 162 },\n\t\t],\n\t},\n\tcommon: [\n\t\t{ cx: 76.5, cy: 149.5 },\n\t\t{ cx: 113, cy: 179.5 },\n\t\t{ cx: 149.5, cy: 117 },\n\t\t{ cx: 187, cy: 171 },\n\t\t{ cx: 223.5, cy: 158 },\n\t],\n} as const;\n\nexport function computePointPositions(\n\tstate: VariationState,\n\tdirection: Direction\n): Point[] {\n\tlet src;\n\tif (state === VariationState.CommonCause) src = POINT_LAYOUTS.common;\n\telse\n\t\tsrc =\n\t\t\tPOINT_LAYOUTS.special[direction === Direction.Lower ? \"lower\" : \"higher\"];\n\treturn src.map((p) => ({ ...p }));\n}\n\n// Narrow type for example payloads (matches derivation form accepted by SPCVariationIcon)\ninterface VariationExampleData {\n\tjudgement: VariationJudgement;\n\tpolarity: MetricPolarity;\n\ttrend?: Direction; // only required for No_Judgement / None examples\n}\n\nexport const variationExamples: {\n\tid: string;\n\tlabel: string;\n\tdata: VariationExampleData;\n}[] = [\n\t{\n\t\tid: \"improve-higher\",\n\t\tlabel: \"Improving (Higher is Better) \u2013 Trend is Higher\",\n\t\tdata: {\n\t\t\tjudgement: VariationJudgement.Improving,\n\t\t\tpolarity: MetricPolarity.HigherIsBetter,\n\t\t},\n\t},\n\t{\n\t\tid: \"improve-lower\",\n\t\tlabel: \"Improving (Lower is Better) \u2013 Trend is Lower\",\n\t\tdata: {\n\t\t\tjudgement: VariationJudgement.Improving,\n\t\t\tpolarity: MetricPolarity.LowerIsBetter,\n\t\t},\n\t},\n\t{\n\t\tid: \"deteriorate-higher\",\n\t\tlabel: \"Deteriorating (Higher is Better) \u2013 Trend is Lower\",\n\t\tdata: {\n\t\t\tjudgement: VariationJudgement.Deteriorating,\n\t\t\tpolarity: MetricPolarity.HigherIsBetter,\n\t\t},\n\t},\n\t{\n\t\tid: \"deteriorate-lower\",\n\t\tlabel: \"Deteriorating (Lower is Better) \u2013 Trend is Higher\",\n\t\tdata: {\n\t\t\tjudgement: VariationJudgement.Deteriorating,\n\t\t\tpolarity: MetricPolarity.LowerIsBetter,\n\t\t},\n\t},\n\t{\n\t\tid: \"no-judgement-higher\",\n\t\tlabel: \"Special Cause (No Judgement) \u2013 Trend is Higher\",\n\t\tdata: {\n\t\t\tjudgement: VariationJudgement.No_Judgement,\n\t\t\tpolarity: MetricPolarity.ContextDependent,\n\t\t\ttrend: Direction.Higher,\n\t\t},\n\t},\n\t{\n\t\tid: \"no-judgement-lower\",\n\t\tlabel: \"Special Cause (No Judgement) \u2013 Lower\",\n\t\tdata: {\n\t\t\tjudgement: VariationJudgement.No_Judgement,\n\t\t\tpolarity: MetricPolarity.ContextDependent,\n\t\t\ttrend: Direction.Lower,\n\t\t},\n\t},\n\t{\n\t\tid: \"common-cause-higher\",\n\t\tlabel: \"Common Cause \u2013 Higher layout\",\n\t\tdata: {\n\t\t\tjudgement: VariationJudgement.None,\n\t\t\tpolarity: MetricPolarity.HigherIsBetter,\n\t\t\ttrend: Direction.Higher,\n\t\t},\n\t},\n\t{\n\t\tid: \"common-cause-lower\",\n\t\tlabel: \"Common Cause \u2013 Lower layout\",\n\t\tdata: {\n\t\t\tjudgement: VariationJudgement.None,\n\t\t\tpolarity: MetricPolarity.HigherIsBetter,\n\t\t\ttrend: Direction.Lower,\n\t\t},\n\t},\n];\n\nexport const assuranceExamples = [\n\t{\n\t\tid: \"assurance-pass\",\n\t\tlabel: \"Assurance Pass\",\n\t\tstatus: AssuranceResult.Pass,\n\t},\n\t{\n\t\tid: \"assurance-fail\",\n\t\tlabel: \"Assurance Fail\",\n\t\tstatus: AssuranceResult.Fail,\n\t},\n\t{\n\t\tid: \"assurance-uncertain\",\n\t\tlabel: \"Assurance Uncertain\",\n\t\tstatus: AssuranceResult.Uncertain,\n\t},\n];\n\n// Compatibility re-exports: canonical tokens & helpers live in SPCChart logic; re-export here for older imports\nexport { VARIATION_COLOR_TOKENS } from \"../SPCChart/logic/spcDescriptors\";\nexport {\n\tgetVariationColorToken,\n\tgetVariationColorHex,\n} from \"../SPCChart/logic/spcDescriptors\";\nexport type { VariationIcon } from \"../SPCChart/logic/spcConstants\";\n", "// UI-only category enum for gradient band sequences behind coloured point runs\n// Keep string values stable as they are used in CSS and data attributes.\nexport enum SpcGradientCategory {\n  Concern = \"concern\",\n  Improvement = \"improvement\",\n  NoJudgement = \"noJudgement\",\n  Common = \"common\",\n}\n\n// UI-only enum for embedded SPCVariationIcon variants used by SPCChart\n// Keep string values stable for compatibility with existing props and docs.\nexport enum SpcEmbeddedIconVariant {\n  Classic = \"classic\",\n  Triangle = \"triangle\",\n  TriangleWithRun = \"triangleWithRun\",\n}\n\n// UI-only enum controlling how H/L letters are derived in SPC icons\nexport enum LetterMode {\n  Direction = \"direction\",\n  Polarity = \"polarity\",\n}\n\n// UI-only enum for explicit letter override glyphs\nexport enum SpcLetterGlyph {\n  H = \"H\",\n  L = \"L\",\n  None = \"\",\n}\n\nexport default SpcGradientCategory;\n", "import { useId } from \"react\";\nimport { getGradientOpacities } from './tokenUtils';\nimport {\n\tAssuranceResult,\n\tDEFAULT_COLOURS,\n\tDEFAULT_LETTERS,\n} from \"./SPCConstants\";\n\nexport interface AssuranceIconProps {\n\tstatus: AssuranceResult;\n\tsize?: number; // px\n\tariaLabel?: string; // override accessible label\n\tdropShadow?: boolean;\n\t/** When true apply a diagonal colour wash instead of solid white interior */\n\tgradientWash?: boolean;\n\tcolourOverride?: string; // optional single colour override for ring, letter & accent path\n\tletterOverride?: string; // optional override for displayed letter\n\tshowTrendLines?: boolean; // allow hiding decorative lines if needed\n\t\"data-testid\"?: string;\n}\n\nexport const SPCAssuranceIcon = ({\n\tstatus,\n\tsize = 44,\n\tariaLabel,\n\tdropShadow = true,\n\tcolourOverride,\n\tgradientWash = false,\n\tletterOverride,\n\tshowTrendLines = true,\n\t...rest\n}: AssuranceIconProps & Record<string, unknown>) => {\n\tconst shadowId = useId();\n\tconst washId = useId();\n\t// Gradient stop opacity tokens via shared util\n\tconst { start: gradStart, mid: gradMid, end: gradEnd } = getGradientOpacities();\n\tconst colour = colourOverride || DEFAULT_COLOURS[status];\n\tconst letter = (letterOverride || DEFAULT_LETTERS[status]).slice(0, 2); // safety \u2013 limit length\n\tconst aria = ariaLabel || `Assurance ${status}`;\n\n\treturn (\n\t\t<svg\n\t\t\twidth={size}\n\t\t\theight={size}\n\t\t\tviewBox=\"0 0 300 300\"\n\t\t\trole=\"img\"\n\t\t\taria-label={aria}\n\t\t\t{...rest}\n\t\t>\n\t\t\t<defs>\n\t\t\t\t{dropShadow && (\n\t\t\t\t\t<filter id={shadowId} filterUnits=\"objectBoundingBox\">\n\t\t\t\t\t\t<feGaussianBlur stdDeviation=\"3\" />\n\t\t\t\t\t\t<feOffset dx=\"-1\" dy=\"15\" result=\"blur\" />\n\t\t\t\t\t\t<feFlood floodColor=\"rgb(166,166,166)\" floodOpacity=\"1\" />\n\t\t\t\t\t\t<feComposite in2=\"blur\" operator=\"in\" result=\"colorShadow\" />\n\t\t\t\t\t\t<feComposite in=\"SourceGraphic\" in2=\"colorShadow\" operator=\"over\" />\n\t\t\t\t\t</filter>\n\t\t\t\t)}\n\t\t\t\t{gradientWash && (\n\t\t\t\t\t<linearGradient id={washId} x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n\t\t\t\t\t\t<stop offset=\"0%\" stopColor={colour} stopOpacity={parseFloat(gradStart)} />\n\t\t\t\t\t\t<stop offset=\"65%\" stopColor={colour} stopOpacity={parseFloat(gradMid)} />\n\t\t\t\t\t\t<stop offset=\"100%\" stopColor=\"#ffffff\" stopOpacity={parseFloat(gradEnd)} />\n\t\t\t\t\t</linearGradient>\n\t\t\t\t)}\n\t\t\t</defs>\n\t\t\t<circle\n\t\t\t\tstroke=\"none\"\n\t\t\t\tfill={gradientWash ? `url(#${washId})` : '#ffffff'}\n\t\t\t\t{...(dropShadow ? { filter: `url(#${shadowId})` } : {})}\n\t\t\t\tcx=\"150\"\n\t\t\t\tcy=\"150\"\n\t\t\t\tr=\"120\"\n\t\t\t/>\n\t\t\t{/* Letter */}\n\t\t\t<text\n\t\t\t\tfill={colour}\n\t\t\t\tfontFamily=\"Arial-BoldMT, Arial, 'Helvetica Neue', Helvetica, sans-serif\"\n\t\t\t\tfontWeight=\"bold\"\n\t\t\t\tfontSize={176}\n\t\t\t\tx={0}\n\t\t\t\ty={0}\n\t\t\t\ttransform=\"translate(121.01, 32) scale(0.5, 0.5)\"\n\t\t\t\ttextAnchor=\"middle\"\n\t\t\t>\n\t\t\t\t<tspan x={60} y={184}>\n\t\t\t\t\t{letter}\n\t\t\t\t</tspan>\n\t\t\t</text>\n\t\t\t{showTrendLines && (\n\t\t\t\t<>\n\t\t\t\t\t{/* Coloured baseline / target line (changes geometry if Fail) */}\n\t\t\t\t\t{status === AssuranceResult.Fail ? (\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tid=\"fail-line\"\n\t\t\t\t\t\t\tstroke={colour}\n\t\t\t\t\t\t\tstrokeWidth={9.5}\n\t\t\t\t\t\t\tstrokeMiterlimit={9.5}\n\t\t\t\t\t\t\tstrokeDasharray=\"35,10\"\n\t\t\t\t\t\t\tstrokeDashoffset={0}\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\td=\"M 33,143 L 268,143\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : status === AssuranceResult.Uncertain ? (\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tid=\"uncertain-line\"\n\t\t\t\t\t\t\tstroke=\"rgb(166, 166, 166)\"\n\t\t\t\t\t\t\tstrokeWidth={9.5}\n\t\t\t\t\t\t\tstrokeMiterlimit={9.5}\n\t\t\t\t\t\t\tstrokeDasharray=\"16.5,10\"\n\t\t\t\t\t\t\tstrokeDashoffset={0}\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\td=\"M 36,174 L 266,174\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\tid=\"pass-line\"\n\t\t\t\t\t\t\tstroke={colour}\n\t\t\t\t\t\t\tstrokeWidth={9.5}\n\t\t\t\t\t\t\tstrokeMiterlimit={9.5}\n\t\t\t\t\t\t\tstrokeDasharray=\"35,10\"\n\t\t\t\t\t\t\tstrokeDashoffset={0}\n\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\td=\"M 48,204 L 254,204\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{/* Grey underlying squiggle / sparkline bezier */}\n\t\t\t\t\t<path\n\t\t\t\t\t\tid=\"data-sparkline\"\n\t\t\t\t\t\tstroke=\"rgb(166, 166, 166)\"\n\t\t\t\t\t\tstrokeWidth={12}\n\t\t\t\t\t\tstrokeMiterlimit={12}\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\td=\"M 59.9,187.91 C 72.79,171.72 87.33,158.06 104.4,157.83 121.91,158.58 140.94,187.85 153.4,189.91 164.1,192.12 163.78,171.38 169.17,170.53 172.87,169.55 174.88,187.45 184.94,189.24 197,191.86 230.54,184.47 239.01,185.9\"\n\t\t\t\t\t/>\n\t\t\t\t\t<circle\n\t\t\t\t\t\tstroke={colour}\n\t\t\t\t\t\tstrokeWidth={15}\n\t\t\t\t\t\tstrokeMiterlimit={10}\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tcx=\"150\"\n\t\t\t\t\t\tcy=\"150\"\n\t\t\t\t\t\tr=\"120\"\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</svg>\n\t);\n};\n\nSPCAssuranceIcon.displayName = \"SPCAssuranceIcon\";\n", "// Extracted pure calculation helpers from spc.ts for direct unit testing.\n// These contain no React / DOM dependencies and are deterministic given inputs.\n\n// Basic numeric helpers\nexport const isNumber = (v: unknown): v is number => typeof v === 'number' && Number.isFinite(v);\nexport const sum = (arr: number[]): number => arr.reduce((a, b) => a + b, 0);\nexport const mean = (arr: number[]): number => (arr.length ? sum(arr) / arr.length : NaN);\n\n// XmR limit helpers ---------------------------------------------------------\nexport function movingRanges(values: (number | null)[], ghosts: boolean[]): (number | null)[] {\n  const mr: (number | null)[] = new Array(values.length).fill(null);\n  let prevIdx: number | null = null;\n  for (let i = 0; i < values.length; i++) {\n    const vi = values[i];\n    if (!ghosts[i] && isNumber(vi)) {\n      if (prevIdx !== null) {\n        const pv = values[prevIdx];\n        mr[i] = isNumber(pv) ? Math.abs(vi - pv) : null;\n      }\n      prevIdx = i;\n    }\n  }\n  return mr;\n}\n\nexport function mrMeanWithOptionalExclusion(\n  mr: (number | null)[],\n  excludeOutliers: boolean\n): { mrMean: number; mrUcl: number } {\n  const pool = mr.filter((v): v is number => isNumber(v));\n  if (!pool.length) return { mrMean: NaN, mrUcl: NaN };\n  let mrMeanVal = mean(pool);\n  let mrUclVal = 3.267 * mrMeanVal;\n  if (excludeOutliers) {\n    const trimmed = pool.filter((v) => v <= mrUclVal);\n    if (trimmed.length && trimmed.length !== pool.length) {\n      mrMeanVal = mean(trimmed);\n      mrUclVal = 3.267 * mrMeanVal;\n    }\n  }\n  return { mrMean: mrMeanVal, mrUcl: mrUclVal };\n}\n\nexport function xmrLimits(\n  centerMean: number,\n  mrMeanVal: number\n): {\n  upperProcessLimit: number | null;\n  lowerProcessLimit: number | null;\n  upperTwoSigma: number | null;\n  lowerTwoSigma: number | null;\n  upperOneSigma: number | null;\n  lowerOneSigma: number | null;\n} {\n  if (!isNumber(centerMean) || !isNumber(mrMeanVal))\n    return {\n      upperProcessLimit: null,\n      lowerProcessLimit: null,\n      upperTwoSigma: null,\n      lowerTwoSigma: null,\n      upperOneSigma: null,\n      lowerOneSigma: null,\n    };\n  const k3 = 2.66;\n  const k2 = (2 / 3) * k3;\n  const k1 = (1 / 3) * k3;\n  return {\n    upperProcessLimit: centerMean + k3 * mrMeanVal,\n    lowerProcessLimit: centerMean - k3 * mrMeanVal,\n    upperTwoSigma: centerMean + k2 * mrMeanVal,\n    lowerTwoSigma: centerMean - k2 * mrMeanVal,\n    upperOneSigma: centerMean + k1 * mrMeanVal,\n    lowerOneSigma: centerMean - k1 * mrMeanVal,\n  };\n}\n\n// Rare event chart helpers --------------------------------------------------\nconst T_ALPHA = 0.2777;\nconst T_INV_ALPHA = 3.6;\nexport const toTTransformed = (t: number | null): number | null => (isNumber(t) && t >= 0 ? Math.pow(t, T_ALPHA) : null);\nexport const fromTTransformed = (y: number | null): number | null => (isNumber(y) && y >= 0 ? Math.pow(y, T_INV_ALPHA) : null);\n\n// Geometric inverse CDF utilities for G chart probability limits\nexport function geomInvCdfReal(q: number, p: number): number {\n  if (!(q > 0 && q < 1) || !(p > 0 && p < 1)) return NaN;\n  return Math.log(1 - q) / Math.log(1 - p);\n}\n\nconst SIGMA_PROBS = {\n  one: { low: 0.1586552539, high: 0.8413447461 },\n  two: { low: 0.0227501319, high: 0.9772498681 },\n  three: { low: 0.001349898, high: 0.998650102 },\n};\n\nexport function gChartProbabilityLimits(gMean: number): {\n  cl: number | null;\n  lcl: number | null;\n  ucl: number | null;\n  oneLow: number | null;\n  oneHigh: number | null;\n  twoLow: number | null;\n  twoHigh: number | null;\n} {\n  if (!isNumber(gMean) || gMean < 0)\n    return {\n      cl: null,\n      lcl: null,\n      ucl: null,\n      oneLow: null,\n      oneHigh: null,\n      twoLow: null,\n      twoHigh: null,\n    };\n  const p = 1 / (gMean + 1);\n  const qToGbetween = (q: number) => geomInvCdfReal(q, p) - 1;\n  const cl = qToGbetween(0.5);\n  const lcl = Math.max(0, qToGbetween(SIGMA_PROBS.three.low));\n  const ucl = qToGbetween(SIGMA_PROBS.three.high);\n  const oneL = Math.max(0, qToGbetween(SIGMA_PROBS.one.low));\n  const oneH = qToGbetween(SIGMA_PROBS.one.high);\n  const twoL = Math.max(0, qToGbetween(SIGMA_PROBS.two.low));\n  const twoH = qToGbetween(SIGMA_PROBS.two.high);\n  return { cl, lcl, ucl, oneLow: oneL, oneHigh: oneH, twoLow: twoL, twoHigh: twoH };\n}\n\nexport function tChartLimits(\n  tValues: (number | null)[],\n  ghosts: boolean[],\n  excludeOutliers: boolean\n): {\n  center: number | null;\n  upperProcessLimit: number | null;\n  lowerProcessLimit: number | null;\n  upperTwoSigma: number | null;\n  lowerTwoSigma: number | null;\n  upperOneSigma: number | null;\n  lowerOneSigma: number | null;\n  mr: (number | null)[];\n  mrMean: number | null;\n  mrUcl: number | null;\n} {\n  const y = tValues.map((v) => (isNumber(v) ? toTTransformed(v)! : null));\n  const mrY = movingRanges(y, ghosts);\n  const { mrMean: mrMeanY_raw } = mrMeanWithOptionalExclusion(mrY, !!excludeOutliers);\n  const yNonGhost = y.filter((v, i) => !ghosts[i] && isNumber(v)) as number[];\n  const yBar = yNonGhost.length ? mean(yNonGhost) : NaN;\n  if (!isNumber(yBar) || !isNumber(mrMeanY_raw)) {\n    return {\n      center: null,\n      upperProcessLimit: null,\n      lowerProcessLimit: null,\n      upperTwoSigma: null,\n      lowerTwoSigma: null,\n      upperOneSigma: null,\n      lowerOneSigma: null,\n      mr: mrY,\n      mrMean: null,\n      mrUcl: null,\n    };\n  }\n  const k3 = 2.66, k2 = (2 / 3) * k3, k1 = (1 / 3) * k3;\n  const UL_y = yBar + k3 * mrMeanY_raw;\n  const LL_y = yBar - k3 * mrMeanY_raw;\n  const U2_y = yBar + k2 * mrMeanY_raw;\n  const L2_y = yBar - k2 * mrMeanY_raw;\n  const U1_y = yBar + k1 * mrMeanY_raw;\n  const L1_y = yBar - k1 * mrMeanY_raw;\n  const center = fromTTransformed(yBar);\n  const upl = fromTTransformed(UL_y);\n  const lpl = LL_y <= 0 ? null : fromTTransformed(LL_y);\n  const oneH = fromTTransformed(U1_y);\n  const oneL = L1_y <= 0 ? null : fromTTransformed(L1_y);\n  const twoH = fromTTransformed(U2_y);\n  const twoL = L2_y <= 0 ? null : fromTTransformed(L2_y);\n  return {\n    center: center ?? null,\n    upperProcessLimit: upl ?? null,\n    lowerProcessLimit: lpl ?? null,\n    upperTwoSigma: twoH ?? null,\n    lowerTwoSigma: twoL ?? null,\n    upperOneSigma: oneH ?? null,\n    lowerOneSigma: oneL ?? null,\n    mr: mrY,\n    mrMean: mrMeanY_raw,\n    mrUcl: isNumber(mrMeanY_raw) ? 3.267 * mrMeanY_raw : null,\n  };\n}\n", "// Assurance icon helper \u2013 now returns engine enum (single source of truth via spcConstants)\n// Contract:\n// - Inputs: metricImprovement, capabilityMode, row value/limits, target\n// - Output: AssuranceIcon (Pass | Fail | None) matching existing semantics in spc.ts\n\nimport { AssuranceIcon, ImprovementDirection } from \"./spcConstants\";\n\n// Backward compatible type aliases (prefer importing enums from spcConstants directly)\nexport type ImprovementDir = ImprovementDirection;\nexport type AssuranceResult = AssuranceIcon;\n\nexport function computeAssuranceIcon(args: {\n\tmetricImprovement: ImprovementDirection;\n\tcapabilityMode: boolean | undefined;\n\tvalue: number | null;\n\tmean: number | null;\n\tupperProcessLimit: number | null;\n\tlowerProcessLimit: number | null;\n\ttarget: number | null;\n}): AssuranceIcon {\n\tconst {\n\t\tmetricImprovement,\n\t\tcapabilityMode,\n\t\tvalue,\n\t\tmean,\n\t\tupperProcessLimit,\n\t\tlowerProcessLimit,\n\t\ttarget,\n\t} = args;\n\n\tconst isNumber = (v: unknown): v is number =>\n\t\ttypeof v === \"number\" && Number.isFinite(v as number);\n\n\tif (!isNumber(value) || mean === null || !isNumber(target)) return AssuranceIcon.None;\n\n\tif (\n\t\tcapabilityMode &&\n\t\tisNumber(upperProcessLimit) &&\n\t\tisNumber(lowerProcessLimit)\n\t) {\n\t\tif (metricImprovement === ImprovementDirection.Up) {\n\t\t\tif (isNumber(lowerProcessLimit) && lowerProcessLimit > target)\n\t\t\t\treturn AssuranceIcon.Pass;\n\t\t\tif (isNumber(upperProcessLimit) && upperProcessLimit < target)\n\t\t\t\treturn AssuranceIcon.Fail;\n\t\t\treturn AssuranceIcon.None;\n\t\t}\n\t\tif (metricImprovement === ImprovementDirection.Down) {\n\t\t\tif (isNumber(upperProcessLimit) && upperProcessLimit < target)\n\t\t\t\treturn AssuranceIcon.Pass;\n\t\t\tif (isNumber(lowerProcessLimit) && lowerProcessLimit > target)\n\t\t\t\treturn AssuranceIcon.Fail;\n\t\t\treturn AssuranceIcon.None;\n\t\t}\n\t\treturn AssuranceIcon.None;\n\t}\n\n\t// Fallback: single-point vs target\n\tif (metricImprovement === ImprovementDirection.Down)\n\t\treturn value <= target ? AssuranceIcon.Pass : AssuranceIcon.Fail;\n\tif (metricImprovement === ImprovementDirection.Up)\n\t\treturn value >= target ? AssuranceIcon.Pass : AssuranceIcon.Fail;\n\treturn AssuranceIcon.None;\n}\n\nexport default { computeAssuranceIcon };\n", "import { mean } from \"./spcUtils\";\nimport { VariationIcon, BaselineSuggestionReason } from \"./spcConstants\";\n\nexport interface BaselineSuggestionRaw {\n\tindex: number;\n\treason: BaselineSuggestionReason;\n\tscore: number;\n\tdeltaMean: number;\n\toldMean: number;\n\tnewMean: number;\n\twindow: [number, number];\n}\n\nexport interface BaselineRowMinimal {\n\tvalue: number | null;\n\tpartitionId: number;\n\tvariationIcon: VariationIcon;\n\tmean: number | null;\n\tupperProcessLimit: number | null;\n}\n\n// Compute baseline suggestions for a given set of rows and parameters\nexport function computeBaselineSuggestionsRaw(\n\trows: BaselineRowMinimal[],\n\tparams: {\n\t\tW: number; // stability window length\n\t\tminGap: number;\n\t\tminDeltaSigma: number;\n\t\tscoreThreshold: number;\n\t\t// candidate triggers provided as booleans on each row (side-specific to detect rising edges correctly)\n\t\tisShiftUpAt: (i: number) => boolean;\n\t\tisShiftDownAt: (i: number) => boolean;\n\t\tisTrendUpAt: (i: number) => boolean;\n\t\tisTrendDownAt: (i: number) => boolean;\n\t\tisSingleUpAt: (i: number) => boolean;\n\t\tisSingleDownAt: (i: number) => boolean;\n\t\t// optional: run lengths (unused currently, kept for potential future heuristics)\n\t\tshiftRunLength?: number;\n\t\ttrendRunLength?: number;\n\t}\n): BaselineSuggestionRaw[] {\n\t// Destructure params for easier access\n\tconst {\n\t\tW,\n\t\tminGap,\n\t\tminDeltaSigma,\n\t\tscoreThreshold,\n\t\tisShiftUpAt,\n\t\tisShiftDownAt,\n\t\tisTrendUpAt,\n\t\tisTrendDownAt,\n\t\tisSingleUpAt,\n\t\tisSingleDownAt,\n\t} = params;\n\tconst suggestions: BaselineSuggestionRaw[] = [];\n\n\t// Track last manual baseline boundary using partitionId changes\n\tlet lastBaselineIndex = 0; // treat start as baseline\n\tfor (let i = 0; i < rows.length; i++) {\n\t\tconst r = rows[i];\n\t\t// Update lastBaselineIndex when partition boundary encountered\n\t\tif (i > 0 && rows[i - 1].partitionId !== r.partitionId) {\n\t\t\tlastBaselineIndex = i;\n\t\t}\n\n\t\tconst wasShiftUp = i > 0 && isShiftUpAt(i - 1);\n\t\tconst wasShiftDown = i > 0 && isShiftDownAt(i - 1);\n\t\tconst wasTrendUp = i > 0 && isTrendUpAt(i - 1);\n\t\tconst wasTrendDown = i > 0 && isTrendDownAt(i - 1);\n\t\tconst wasSingleUp = i > 0 && isSingleUpAt(i - 1);\n\t\tconst wasSingleDown = i > 0 && isSingleDownAt(i - 1);\n\t\tconst isShiftUp = isShiftUpAt(i);\n\t\tconst isShiftDown = isShiftDownAt(i);\n\t\tconst isTrendUp = isTrendUpAt(i);\n\t\tconst isTrendDown = isTrendDownAt(i);\n\t\tconst isSingleUp = isSingleUpAt(i);\n\t\tconst isSingleDown = isSingleDownAt(i);\n\t\tconst candidates: { reason: BaselineSuggestionReason; index: number }[] = [];\n\t\tif (isShiftUp && !wasShiftUp) candidates.push({ reason: BaselineSuggestionReason.Shift, index: i });\n\t\tif (isShiftDown && !wasShiftDown) candidates.push({ reason: BaselineSuggestionReason.Shift, index: i });\n\t\tif (isTrendUp && !wasTrendUp) candidates.push({ reason: BaselineSuggestionReason.Trend, index: i });\n\t\tif (isTrendDown && !wasTrendDown) candidates.push({ reason: BaselineSuggestionReason.Trend, index: i });\n\t\tif (isSingleUp && !wasSingleUp) candidates.push({ reason: BaselineSuggestionReason.Point, index: i });\n\t\tif (isSingleDown && !wasSingleDown) candidates.push({ reason: BaselineSuggestionReason.Point, index: i });\n\n\t\t// Evaluate each candidate\n\t\tfor (const c of candidates) {\n\t\t\tif (c.index - lastBaselineIndex < minGap) continue;\n\t\t\tconst oldStart = Math.max(0, c.index - W);\n\t\t\tconst oldEnd = c.index - 1;\n\t\t\tif (oldEnd - oldStart + 1 < W) continue;\n\t\t\tconst newStart = c.index;\n\t\t\tconst newEnd = c.index + W - 1;\n\t\t\tif (newEnd >= rows.length) continue;\n\t\t\tconst oldVals = rows\n\t\t\t\t.slice(oldStart, oldEnd + 1)\n\t\t\t\t.map((rw) => rw.value)\n\t\t\t\t.filter(\n\t\t\t\t\t(v): v is number => typeof v === \"number\" && Number.isFinite(v)\n\t\t\t\t);\n\t\t\tconst newVals = rows\n\t\t\t\t.slice(newStart, newEnd + 1)\n\t\t\t\t.map((rw) => rw.value)\n\t\t\t\t.filter(\n\t\t\t\t\t(v): v is number => typeof v === \"number\" && Number.isFinite(v)\n\t\t\t\t);\n\t\t\tif (oldVals.length < W || newVals.length < W) continue;\n\t\t\t// Sigma estimate from candidate row limits\n\t\t\tconst cand = rows[c.index];\n\t\t\tlet sigma: number | null = null;\n\t\t\tif (\n\t\t\t\ttypeof cand.upperProcessLimit === \"number\" &&\n\t\t\t\ttypeof cand.mean === \"number\"\n\t\t\t) {\n\t\t\t\tconst span = cand.upperProcessLimit - cand.mean;\n\t\t\t\tif (span > 0) sigma = span / 3;\n\t\t\t}\n\t\t\tif (!sigma || sigma <= 0) continue;\n\t\t\tconst oldMean = mean(oldVals);\n\t\t\tconst newMean = mean(newVals);\n\t\t\tconst deltaMean = newMean - oldMean;\n\t\t\tif (Math.abs(deltaMean) < minDeltaSigma * sigma) continue;\n\t\t\t// Stability: count concern icons only in the new window\n\t\t\tconst newRows = rows.slice(newStart, newEnd + 1);\n\t\t\tconst concernCount = newRows.filter(\n\t\t\t\t(rw) => rw.variationIcon === VariationIcon.Concern\n\t\t\t).length;\n\t\t\tif (concernCount > 1) continue;\n\t\t\t// Variance scoring bonus\n\t\t\tconst variance = (arr: number[]) => {\n\t\t\t\tconst m = mean(arr);\n\t\t\t\treturn arr.length\n\t\t\t\t\t? arr.reduce((a, b) => a + (b - m) * (b - m), 0) / arr.length\n\t\t\t\t\t: 0;\n\t\t\t};\n\t\t\tconst oldVar = variance(oldVals);\n\t\t\tconst newVar = variance(newVals);\n\t\t\tlet scoreBase =\n\t\t\t\tc.reason === BaselineSuggestionReason.Shift\n\t\t\t\t\t? 90\n\t\t\t\t\t: c.reason === BaselineSuggestionReason.Trend\n\t\t\t\t\t? 70\n\t\t\t\t\t: 60;\n\t\t\tif (newVar < oldVar) scoreBase += 10;\n\t\t\tscoreBase -= concernCount * 15;\n\t\t\tif (scoreBase < scoreThreshold) continue;\n\t\t\tconst existing = suggestions.find((s) => s.index === c.index);\n\t\t\tif (existing) {\n\t\t\t\tconst priority = (reason: BaselineSuggestionReason) =>\n\t\t\t\t\treason === BaselineSuggestionReason.Shift\n\t\t\t\t\t\t? 3\n\t\t\t\t\t\t: reason === BaselineSuggestionReason.Trend\n\t\t\t\t\t\t? 2\n\t\t\t\t\t\t: 1;\n\t\t\t\tif (\n\t\t\t\t\tpriority(c.reason) > priority(existing.reason) ||\n\t\t\t\t\tscoreBase > existing.score\n\t\t\t\t) {\n\t\t\t\t\texisting.reason = c.reason;\n\t\t\t\t\texisting.score = scoreBase;\n\t\t\t\t\texisting.deltaMean = deltaMean;\n\t\t\t\t\texisting.oldMean = oldMean;\n\t\t\t\t\texisting.newMean = newMean;\n\t\t\t\t\texisting.window = [newStart, newEnd];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsuggestions.push({\n\t\t\t\t\tindex: c.index,\n\t\t\t\t\treason: c.reason,\n\t\t\t\t\tscore: scoreBase,\n\t\t\t\t\tdeltaMean,\n\t\t\t\t\toldMean,\n\t\t\t\t\tnewMean,\n\t\t\t\t\twindow: [newStart, newEnd],\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\tsuggestions.sort((a, b) => a.index - b.index);\n\treturn suggestions;\n}\n\nexport default { computeBaselineSuggestionsRaw };\n", "// NHSE \"Making Data Count\" SPC Charts \u2013 TypeScript port of SQL v2.6\n// Supports XmR, T, and G charts with special-cause rules and variation/assurance icons.\n\n// Utility functions\nimport {\n\tisNumber,\n\tmean,\n\tmovingRanges,\n\tmrMeanWithOptionalExclusion,\n\txmrLimits,\n\ttChartLimits,\n\tgChartProbabilityLimits,\n} from './spcUtils';\n\n// Modularised logic components\nimport { computeAssuranceIcon } from './spcAssurance';\nimport { computeBaselineSuggestionsRaw } from './spcCandidates';\n\n// Centralised constants/enums\nimport {\n\tChartType,\n\tImprovementDirection,\n\tVariationIcon,\n\tSpcRuleId,\n\tRULE_METADATA,\n\tSide,\n\tSpcRawRuleTag,\n\tAssuranceIcon,\n\tPrecedenceStrategy,\n\tConflictPrecedenceMode,\n\tPrimeDirection,\n\tPruningMode,\n\tSpcRowAliasField,\n\tBaselineSuggestionReason,\n} from './spcConstants';\n// Phase 4 strict-mode toggle (default ON). Consumers can override via:\n// - globalThis.__SPC_PHASE4_STRICT (boolean), or\n// - process.env.SPC_PHASE4_STRICT ('1'|'true' -> true, '0'|'false' -> false).\n// This is evaluated at call-time to allow tests to override per-spec.\nfunction isPhase4Strict(): boolean {\n\t// Explicit global override takes precedence\n\tconst g: any = (globalThis as any);\n\tif (typeof g.__SPC_PHASE4_STRICT !== 'undefined') return !!g.__SPC_PHASE4_STRICT;\n\t// Environment override if present\n\tif (typeof process !== 'undefined') {\n\t\tconst v = (process as any)?.env?.SPC_PHASE4_STRICT;\n\t\tif (typeof v !== 'undefined') {\n\t\t\tconst s = String(v).toLowerCase();\n\t\t\tif (s === '1' || s === 'true') return true;\n\t\t\tif (s === '0' || s === 'false') return false;\n\t\t}\n\t}\n\t// Default: strict ON in Phase 4\n\treturn true;\n}\n\n/**\n * Chart type meanings (high\u2011level):\n *  XmR (Individuals & Moving Range):\n *    - Use for a continuous measurement per period (e.g. % compliance, rate, time, count when roughly normal).\n *    - Centre line = mean of individual values; sigma estimated from average moving range (MRbar).\n *    - Control limits = mean \u00B1 2.66 * MRbar (3\u03C3); 1\u03C3/2\u03C3 bands are proportional fractions (1/3, 2/3 of 2.66).\n *\n *  T chart (Time\u2011between events):\n *    - Use when data are elapsed time between rare events (positive, skewed).\n *    - Applies power transform y = t^0.2777 to stabilise variance; runs an XmR on y; then back\u2011transforms limits.\n *    - Lower limit suppressed if back\u2011transform would fall \u2264 0 (time cannot be negative).\n *\n *  G chart (Count between events):\n *    - Use when data record the number of opportunities/units between rare events (geometric behaviour).\n *    - No moving range; limits derived directly from geometric distribution quantiles around the mean count.\n *    - Provides probability\u2011based 1\u03C3/2\u03C3/3\u03C3 style bands using inverse CDF (no MR / d2 constants involved).\n */\n// Chart types supported by the SPC engine.\n// Converted from string union to enum for stronger typing / refactor safety.\n\nexport interface SpcInputRow {\n\tx: string | number | Date; // period label or date\n\tvalue?: number | null; // numeric value (null/undefined treated as missing)\n\tghost?: boolean; // if true, do not include in calc (still output)\n\tbaseline?: boolean; // if true, start a new partition from this row\n\ttarget?: number; // optional target value (for assurance icon)\n}\n\nexport interface SpcSettings {\n\texcludeMovingRangeOutliers?: boolean;\n\tspecialCauseShiftPoints?: number;\n\tspecialCauseTrendPoints?: number;\n\tenableFourOfFiveRule?: boolean;\n\tprecedenceStrategy?: PrecedenceStrategy;\n\t/** @deprecated Use emergingGraceEnabled */\n\temergingDirectionGrace?: boolean;\n\t// REMOVED: trendSideGatingEnabled (now unconditional side qualification)\n\temergingGraceEnabled?: boolean; // V2 canonical\n\t// REMOVED: trendFavourableSideOnly (behaviour now always on)\n\tminimumPoints?: number;\n\tminimumPointsWarning?: boolean;\n\tminimumPointsPartition?: number;\n\tmaximumPointsPartition?: number | null;\n\tmaximumPoints?: number | null;\n\tpointConflictWarning?: boolean;\n\tvariationIconConflictWarning?: boolean;\n\tnullValueWarning?: boolean;\n\ttargetSuppressedWarning?: boolean;\n\tghostOnRareEventWarning?: boolean;\n\tpartitionSizeWarnings?: boolean;\n\tbaselineSpecialCauseWarning?: boolean;\n\tmaximumPointsWarnings?: boolean;\n\tassuranceCapabilityMode?: boolean;\n\ttransitionBufferPoints?: number;\n\t/** @deprecated Use collapseWeakerClusterRules */\n\tcollapseClusterRules?: boolean;\n\tcollapseWeakerClusterRules?: boolean; // V2 canonical\n\tenableFifteenInInnerThirdRule?: boolean;\n\tbaselineSuggest?: boolean;\n\tbaselineSuggestMinDeltaSigma?: number;\n\tbaselineSuggestStabilityPoints?: number;\n\tbaselineSuggestMinGap?: number;\n\tbaselineSuggestScoreThreshold?: number;\n\tautoRecalculateAfterShift?: boolean;\n\tautoRecalculateShiftLength?: number;\n\tautoRecalculateDeltaSigma?: number;\n\tconflictPrecedenceMode?: ConflictPrecedenceMode;\n\t// Minimal nested mirrors to support grouped access in engine code\n\trules?: {\n\t\tcollapseWeakerClusterRules?: boolean;\n\t\tshiftPoints?: number;\n\t\ttrendPoints?: number;\n\t\tfourOfFiveEnabled?: boolean;\n\t\tfifteenInnerThirdEnabled?: boolean;\n\t};\n\tgrace?: {\n\t\temergingEnabled?: boolean;\n\t};\n}\n\n// Phase 2 forward-looking settings shape with renamed flags (non-breaking adapter provided)\n// New names (V2): emergingGraceEnabled, trendFavourableSideOnly, collapseWeakerClusterRules\n// Phase 3: Grouped settings API (backward-compatible via normaliser)\nexport interface SpcSettingsV2 {\n\t// Rule configuration\n\trules?: {\n\t\tshiftPoints?: number; // maps to specialCauseShiftPoints\n\t\ttrendPoints?: number; // maps to specialCauseTrendPoints\n\t\tfourOfFiveEnabled?: boolean; // maps to enableFourOfFiveRule\n\t\tfifteenInnerThirdEnabled?: boolean; // maps to enableFifteenInInnerThirdRule\n\t\tcollapseWeakerClusterRules?: boolean; // maps to collapseWeakerClusterRules\n\t};\n\t// Precedence and conflict resolution\n\tprecedence?: {\n\t\tstrategy?: PrecedenceStrategy; // maps to precedenceStrategy\n\t\tconflictMode?: ConflictPrecedenceMode; // maps to conflictPrecedenceMode\n\t};\n\t// Data/partition thresholds\n\tthresholds?: {\n\t\tminimumPoints?: number; // maps to minimumPoints\n\t\tminimumPointsPartition?: number; // maps to minimumPointsPartition\n\t\tmaximumPointsPartition?: number | null; // maps to maximumPointsPartition\n\t\tmaximumPoints?: number | null; // maps to maximumPoints\n\t\ttransitionBufferPoints?: number; // maps to transitionBufferPoints\n\t};\n\t// Warnings toggles\n\twarnings?: {\n\t\tminimumPointsWarning?: boolean;\n\t\tpointConflictWarning?: boolean;\n\t\tvariationIconConflictWarning?: boolean;\n\t\tnullValueWarning?: boolean;\n\t\ttargetSuppressedWarning?: boolean;\n\t\tghostOnRareEventWarning?: boolean;\n\t\tpartitionSizeWarnings?: boolean;\n\t\tbaselineSpecialCauseWarning?: boolean;\n\t\tmaximumPointsWarnings?: boolean;\n\t};\n\t// Rare event / MR exclusions\n\trareEvent?: {\n\t\texcludeMovingRangeOutliers?: boolean;\n\t};\n\t// Capability/assurance\n\tcapability?: {\n\t\tassuranceCapabilityMode?: boolean;\n\t};\n\t// Grace window semantics\n\tgrace?: {\n\t\temergingEnabled?: boolean; // maps to emergingGraceEnabled / emergingDirectionGrace\n\t};\n\t// Baseline suggestions configuration\n\tbaselineSuggest?: {\n\t\tenabled?: boolean; // maps to baselineSuggest\n\t\tminDeltaSigma?: number; // maps to baselineSuggestMinDeltaSigma\n\t\tstabilityPoints?: number; // maps to baselineSuggestStabilityPoints\n\t\tminGap?: number; // maps to baselineSuggestMinGap\n\t\tscoreThreshold?: number; // maps to baselineSuggestScoreThreshold\n\t};\n\t// Auto-recalculation after sustained shift\n\tautoRecalc?: {\n\t\tenabled?: boolean; // maps to autoRecalculateAfterShift\n\t\tshiftLength?: number; // maps to autoRecalculateShiftLength\n\t\tdeltaSigma?: number; // maps to autoRecalculateDeltaSigma\n\t};\n\t// Forward-compat: accept flat V2 rename fields as well (soft-deprecated but supported)\n\temergingGraceEnabled?: boolean; // same as grace.emergingEnabled\n\tcollapseWeakerClusterRules?: boolean; // same as rules.collapseWeakerClusterRules\n}\n\ntype AnySpcSettings = SpcSettings | SpcSettingsV2;\n\nexport interface BuildSpcArgs {\n\tchartType: ChartType;\n\tmetricImprovement: ImprovementDirection;\n\tdata: SpcInputRow[];\n\tsettings?: AnySpcSettings; // Accept legacy or V2 shape\n}\n\nexport interface SpcRow {\n\trowId: number;\n\tx: string | number | Date;\n\tvalue: number | null;\n\tghost: boolean;\n\tpartitionId: number;\n\tpointRank: number;\n\tmean: number | null;\n\tmr: number | null;\n\tmrMean: number | null;\n\tmrUcl: number | null;\n\tupperProcessLimit: number | null;\n\tlowerProcessLimit: number | null;\n\tupperTwoSigma: number | null;\n\tupperOneSigma: number | null;\n\tlowerOneSigma: number | null;\n\tlowerTwoSigma: number | null;\n\t/** Target value for this row (if provided in input). Exposed for rendering reference lines. */\n\ttarget: number | null;\n\t/** Fifteen consecutive points within inner third (\u00B11\u03C3) with at least one on each side of mean */\n\tspecialCauseFifteenInnerThird: boolean;\n\t/**\n\t * Unified directional aliases (Up/Down) for all special cause rule flags.\n\t * These replace the legacy Above/Below/High/Low/Increasing/Decreasing fields (removed in vNEXT breaking change).\n\t */\n\t// Single point\n\tspecialCauseSinglePointUp: boolean;\n\tspecialCauseSinglePointDown: boolean;\n\t// Two of three beyond 2\u03C3\n\tspecialCauseTwoOfThreeUp: boolean;\n\tspecialCauseTwoOfThreeDown: boolean;\n\t// Four of five beyond 1\u03C3 (optional rule)\n\tspecialCauseFourOfFiveUp: boolean;\n\tspecialCauseFourOfFiveDown: boolean;\n\t// Shift (run) rule\n\tspecialCauseShiftUp: boolean;\n\tspecialCauseShiftDown: boolean;\n\t// Trend (monotonic) rule\n\tspecialCauseTrendUp: boolean;\n\tspecialCauseTrendDown: boolean;\n\tvariationIcon: VariationIcon; // never null; use VariationIcon.Suppressed when suppressed\n\tassuranceIcon: AssuranceIcon; // 'none' when no target / not assessed\n\t// Parity/helper columns\n\tupperBaseline: number | null;\n\tlowerBaseline: number | null;\n\tmovingRangeHighPointValue: number | null;\n\tghostValue: number | null;\n\tghostFlag: boolean;\n\tspecialCauseImprovementValue: number | null;\n\tspecialCauseConcernValue: number | null;\n\tspecialCauseNeitherValue: number | null;\n\t/** Raw rule-based special cause tags (orthodox flags; snake_case) for audit trail */\n\truleTags?: SpcRawRuleTag[];\n\t// Conflict resolution metadata (populated only when conflictPrecedenceMode active & a conflict was resolved)\n\tconflictPrimeDirection?: PrimeDirection;\n\tconflictResolvedByRuleId?: SpcRuleId; // winning rule id (ranked)\n\tconflictResolvedRank?: number; // 1..4\n\tconflictResolved?: boolean; // true if pruning occurred\n\t/** @deprecated Use improvementValueBeforePruning (Phase 2 rename) */\n\toriginalSpecialCauseImprovementValue?: number | null; // legacy alias\n\t/** @deprecated Use concernValueBeforePruning (Phase 2 rename) */\n\toriginalSpecialCauseConcernValue?: number | null; // legacy alias\n\t/** @deprecated Use improvementValueBeforePruning (added Phase 2). Getter provided for forward compatibility. */\n\timprovementValueBeforePruning?: number | null;\n\t/** @deprecated Use concernValueBeforePruning (added Phase 2). Getter provided for forward compatibility. */\n\tconcernValueBeforePruning?: number | null;\n\t/** Pruning mode applied (if any). Undefined when no pruning semantics applied. */\n\tpruningMode?: PruningMode;\n}\n\n// Warning metadata enums for stronger typing and refactor safety\nexport enum SpcWarningSeverity {\n\tInfo = \"info\",\n\tWarning = \"warning\",\n\tError = \"error\",\n}\nexport enum SpcWarningCategory {\n\tConfig = \"config\",\n\tData = \"data\",\n\tLimits = \"limits\",\n\tSpecialCause = \"special_cause\",\n\tBaseline = \"baseline\",\n\tLogic = \"logic\",\n\tTarget = \"target\",\n\tGhost = \"ghost\",\n\tPartition = \"partition\",\n}\n\n// Stable catalog of warning codes (public surface)\nexport enum SpcWarningCode {\n\tUnknownChartType = 'unknown_chart_type',\n\tInsufficientPointsGlobal = 'insufficient_points_global',\n\tVariationConflictRow = 'variation_conflict_row',\n\tNullValuesExcluded = 'null_values_excluded',\n\tTargetIgnoredRareEvent = 'target_ignored_rare_event',\n\tGhostRowsRareEvent = 'ghost_rows_rare_event',\n\tInsufficientPointsPartition = 'insufficient_points_partition',\n\tBaselineWithSpecialCause = 'baseline_with_special_cause',\n\tPartitionCapApplied = 'partition_cap_applied',\n\tGlobalCapApplied = 'global_cap_applied',\n}\n\nexport interface SpcWarning {\n\tcode: SpcWarningCode; // stable identifier\n\tmessage: string; // human-readable text\n\tseverity?: SpcWarningSeverity;\n\tcategory?: SpcWarningCategory;\n\tcontext?: Record<string, unknown>; // optional structured data (counts, ids, etc.)\n}\nexport interface SpcResult {\n\trows: SpcRow[];\n\twarnings: SpcWarning[];\n\t/** Optional heuristic suggestions for candidate new baseline starting points (phase changes) */\n\tsuggestedBaselines?: Array<{\n\t\tindex: number; // 0-based index into rows\n\t\treason: BaselineSuggestionReason;\n\t\tscore: number; // relative confidence 0-100\n\t\tdeltaMean: number; // absolute difference in means (new - old)\n\t\toldMean: number;\n\t\tnewMean: number;\n\t\twindow: [number, number]; // stability window used\n\t}>;\n}\n\n// ------------------------- Directional summary helper -------------------------\nexport function getDirectionalSignalSummary(row: SpcRow) {\n\tconst upRules: SpcRuleId[] = [];\n\tconst downRules: SpcRuleId[] = [];\n\tif (row.specialCauseSinglePointUp) upRules.push(SpcRuleId.SinglePoint);\n\tif (row.specialCauseSinglePointDown) downRules.push(SpcRuleId.SinglePoint);\n\tif (row.specialCauseTwoOfThreeUp) upRules.push(SpcRuleId.TwoSigma);\n\tif (row.specialCauseTwoOfThreeDown) downRules.push(SpcRuleId.TwoSigma);\n\tif (row.specialCauseShiftUp) upRules.push(SpcRuleId.Shift);\n\tif (row.specialCauseShiftDown) downRules.push(SpcRuleId.Shift);\n\tif (row.specialCauseTrendUp) upRules.push(SpcRuleId.Trend);\n\tif (row.specialCauseTrendDown) downRules.push(SpcRuleId.Trend);\n\tconst upMax = upRules.reduce((m, id) => Math.max(m, RULE_METADATA[id].rank), 0);\n\tconst downMax = downRules.reduce((m, id) => Math.max(m, RULE_METADATA[id].rank), 0);\n\treturn { upRules, downRules, upMax, downMax, hasUp: upRules.length>0, hasDown: downRules.length>0 };\n}\n\n// BaselineSuggestionReason moved to spcConstants.ts (single source of truth)\n\n// ------------------------- Utility functions -------------------------\n\n// (moved isNumber, sum, mean to spcUtils.ts)\n\ntype CanonicalRow = {\n\trowId: number;\n\tx: string | number | Date;\n\tvalue: number | null;\n\tghost: boolean;\n\tbaseline: boolean;\n\ttarget: number | null;\n};\n\n/** Split into partitions based on row.baseline === true (inclusive of flag row). */\nfunction partitionRows(data: CanonicalRow[]): CanonicalRow[][] {\n\tconst partitions: CanonicalRow[][] = [];\n\tlet current: CanonicalRow[] = [];\n\tfor (const row of data) {\n\t\tif (row.baseline && current.length) {\n\t\t\tpartitions.push(current);\n\t\t\tcurrent = [];\n\t\t}\n\t\tcurrent.push(row);\n\t}\n\tif (current.length) partitions.push(current);\n\treturn partitions;\n}\n\n/** Inject synthetic baseline flags into canonical rows where a sustained shift justifies a recalculation. */\nfunction applyAutoRecalculationBaselines(\n\tdata: CanonicalRow[],\n\tsettings: SpcSettings,\n\tmetricImprovement: ImprovementDirection\n) {\n\tconst shiftN = settings.autoRecalculateShiftLength || settings.specialCauseShiftPoints || 6;\n\tif (data.length < shiftN * 2) return; // need at least two windows\n\t// We perform a lightweight provisional scan using rolling windows to detect a sustained mean change.\n\t// 1. Build array of numeric (non-null) values with indices.\n\tconst numeric: { idx: number; value: number }[] = data\n\t\t.map((r, i) => ({ idx: i, value: r.value! }))\n\t\t.filter(o => isNumber(o.value));\n\tif (numeric.length < shiftN * 2) return;\n\t// 2. For each candidate start, test shiftN consecutive points all above (or below) the global mean of previous window.\n\t// We'll adapt to improvement direction so we only trigger on favourable sustained changes.\n\tconst favourUp = metricImprovement === ImprovementDirection.Up || metricImprovement === ImprovementDirection.Neither;\n\tconst favourDown = metricImprovement === ImprovementDirection.Down;\n\t// Rolling statistics helper\n\tfunction windowMean(from: number, toExclusive: number) {\n\t\tconst slice = numeric.slice(from, toExclusive).map(o => o.value);\n\t\treturn slice.length ? mean(slice as number[]) : NaN;\n\t}\n\t// Estimate global sigma proxy using overall MR-like approach for threshold scaling.\n\tlet sigma: number | null = null;\n\tif (numeric.length > 1) {\n\t\tconst diffs: number[] = [];\n\t\tfor (let i=1;i<numeric.length;i++) diffs.push(Math.abs(numeric[i].value - numeric[i-1].value));\n\t\tconst mrBar = mean(diffs as number[]);\n\t\tif (isNumber(mrBar) && mrBar > 0) sigma = mrBar * (2.66/3); // reverse of 3\u03C3 = 2.66 * MRbar\n\t}\n\tif (!sigma || sigma <= 0) return;\n\tconst deltaThreshold = settings.autoRecalculateDeltaSigma ?? 0.5;\n\t// Scan for first sustained favourable window after an initial stable window.\n\tfor (let start = shiftN; start <= numeric.length - shiftN; start++) {\n\t\tconst preStart = start - shiftN;\n\t\tconst preMean = windowMean(preStart, start);\n\t\tconst postMean = windowMean(start, start + shiftN);\n\t\tif (!isNumber(preMean) || !isNumber(postMean)) continue;\n\t\tconst delta = postMean - preMean;\n\t\tconst deltaSigma = delta / sigma;\n\t\tconst favourable = favourUp ? deltaSigma >= deltaThreshold : favourDown ? -deltaSigma >= deltaThreshold : Math.abs(deltaSigma) >= deltaThreshold;\n\t\tif (!favourable) continue;\n\t\t// Verify sustained run directionality: all post window points above preMean (up) or below (down).\n\t\tconst postVals = numeric.slice(start, start + shiftN).map(o => o.value);\n\t\tconst directional = favourUp ? postVals.every(v => v > preMean) : favourDown ? postVals.every(v => v < preMean) : postVals.every(v => favourUp ? v > preMean : v < preMean);\n\t\tif (!directional) continue;\n\t\t// Insert synthetic baseline flag at first index of post window if not already baseline.\n\t\tconst baselineIdx = numeric[start].idx;\n\t\tif (!data[baselineIdx].baseline) {\n\t\t\tdata[baselineIdx].baseline = true;\n\t\t}\n\t\treturn; // single insertion for now\n\t}\n}\n\n/** Compute moving range array relative to previous NON-GHOST, within a partition */\n// (moved movingRanges to spcUtils.ts)\n\n/** Iterative single-pass outlier exclusion for MR using UCL = 3.267 * MRbar (1 iteration) */\n// (moved mrMeanWithOptionalExclusion to spcUtils.ts)\n\n/** Build sigma/limit lines given mean and MRbar for XmR */\n// (moved xmrLimits to spcUtils.ts)\n\n// (Removed unused helper functions: countAbove, countBelow, isTrend, isRunOnOneSide)\n\n// ------------------------- Rare event chart helpers (T & G) -------------------------\n// T chart (time-between events): y = t^0.2777; XmR on y; back-transform t = y^3.6; no LCL if lower transform \u2264 0.\n// (moved T chart transform helpers to spcUtils.ts)\n\n// Normal CDF quantile probabilities for 1\u03C3, 2\u03C3, 3\u03C3 used by probability-based G chart limits\n// (moved SIGMA_PROBS to spcUtils.ts)\n\n// Inverse CDF for geometric (\"number until first success\") as a real value (no ceiling)\n// (moved geomInvCdfReal to spcUtils.ts)\n\n// Probability-based control lines for a G chart given mean g (\"number between\")\n// (moved gChartProbabilityLimits to spcUtils.ts)\n\n// Compute T chart limits on the original t-scale using XmR on transformed y = t^alpha\n// (moved tChartLimits to spcUtils.ts)\n\n// ------------------------- Core builder -------------------------\n\n// Normalise user supplied settings (legacy + V2) into legacy internal field names for now.\nexport function normaliseSpcSettings(user?: AnySpcSettings): SpcSettings {\n\tif (!user) return {} as SpcSettings;\n\tconst legacy = user as SpcSettings;\n\tconst v2 = user as SpcSettingsV2;\n\n\t// Pull grouped sections (if present)\n\tconst rules = v2.rules ?? {};\n\tconst precedence = v2.precedence ?? {};\n\tconst thresholds = v2.thresholds ?? {};\n\tconst warnings = v2.warnings ?? {};\n\tconst rareEvent = v2.rareEvent ?? {};\n\tconst capability = v2.capability ?? {};\n\tconst grace = v2.grace ?? {};\n\tconst baselineSuggest = v2.baselineSuggest ?? {};\n\tconst autoRecalc = v2.autoRecalc ?? {};\n\n\t// Resolve renamed flags and aliases\n\tconst emergingGraceEnabled = (grace.emergingEnabled ?? v2.emergingGraceEnabled ?? legacy.emergingGraceEnabled ?? legacy.emergingDirectionGrace);\n\tconst collapseWeakerClusterRules = (rules.collapseWeakerClusterRules ?? v2.collapseWeakerClusterRules ?? legacy.collapseWeakerClusterRules ?? legacy.collapseClusterRules);\n\n\t// Phase 4 strict mode: reject legacy/deprecated fields\n\tif (isPhase4Strict()) {\n\t\tif (legacy.emergingDirectionGrace !== undefined) {\n\t\t\tthrow new Error('[spc][phase4] emergingDirectionGrace is no longer supported. Use settings.grace.emergingEnabled.');\n\t\t}\n\t\tif (legacy.collapseClusterRules !== undefined) {\n\t\t\tthrow new Error('[spc][phase4] collapseClusterRules is no longer supported. Use settings.rules.collapseWeakerClusterRules.');\n\t\t}\n\t}\n\n\t// First-use deprecation warnings for legacy names\n\tconst globalAny = globalThis as any;\n\tif (!isPhase4Strict() && legacy.emergingDirectionGrace !== undefined && v2.emergingGraceEnabled === undefined && grace.emergingEnabled === undefined && !globalAny.__spc_warn_emergingDirectionGrace) {\n\t\tglobalAny.__spc_warn_emergingDirectionGrace = true;\n\t\tconsole.warn('[spc] emergingDirectionGrace is deprecated; use grace.emergingEnabled');\n\t}\n\tif (!isPhase4Strict() && legacy.collapseClusterRules !== undefined && rules.collapseWeakerClusterRules === undefined && v2.collapseWeakerClusterRules === undefined && !globalAny.__spc_warn_collapseClusterRules) {\n\t\tglobalAny.__spc_warn_collapseClusterRules = true;\n\t\tconsole.warn('[spc] collapseClusterRules is deprecated; use rules.collapseWeakerClusterRules');\n\t}\n\n\t// Helper to remove undefined keys so defaults in buildSpc are not overridden by undefined\n\tconst pruneUndefined = <T extends Record<string, any>>(obj: T): Partial<T> => {\n\t\tconst out: Record<string, any> = {};\n\t\tfor (const k of Object.keys(obj)) {\n\t\t\tconst v = (obj as any)[k];\n\t\t\tif (v !== undefined) out[k] = v;\n\t\t}\n\t\treturn out as Partial<T>;\n\t};\n\n\t// Flatten into legacy engine shape (engine remains flat for now) \u2013 keep only defined values\n\tconst flattened: SpcSettings = pruneUndefined<SpcSettings>({\n\t\t// Rare event / MR\n\t\texcludeMovingRangeOutliers: rareEvent.excludeMovingRangeOutliers ?? legacy.excludeMovingRangeOutliers,\n\t\t// Rules\n\t\tspecialCauseShiftPoints: rules.shiftPoints ?? legacy.specialCauseShiftPoints,\n\t\tspecialCauseTrendPoints: rules.trendPoints ?? legacy.specialCauseTrendPoints,\n\t\tenableFourOfFiveRule: rules.fourOfFiveEnabled ?? legacy.enableFourOfFiveRule,\n\t\tenableFifteenInInnerThirdRule: rules.fifteenInnerThirdEnabled ?? legacy.enableFifteenInInnerThirdRule,\n\t\tcollapseWeakerClusterRules: collapseWeakerClusterRules ?? legacy.collapseWeakerClusterRules,\n\t\t// Precedence\n\t\tprecedenceStrategy: precedence.strategy ?? legacy.precedenceStrategy,\n\t\tconflictPrecedenceMode: precedence.conflictMode ?? legacy.conflictPrecedenceMode,\n\t\t// Thresholds\n\t\tminimumPoints: thresholds.minimumPoints ?? legacy.minimumPoints,\n\t\tminimumPointsPartition: thresholds.minimumPointsPartition ?? legacy.minimumPointsPartition,\n\t\tmaximumPointsPartition: (thresholds.maximumPointsPartition ?? legacy.maximumPointsPartition) as any,\n\t\tmaximumPoints: (thresholds.maximumPoints ?? legacy.maximumPoints) as any,\n\t\ttransitionBufferPoints: thresholds.transitionBufferPoints ?? legacy.transitionBufferPoints,\n\t\t// Warnings\n\t\tminimumPointsWarning: warnings.minimumPointsWarning ?? legacy.minimumPointsWarning,\n\t\tpointConflictWarning: warnings.pointConflictWarning ?? legacy.pointConflictWarning,\n\t\tvariationIconConflictWarning: warnings.variationIconConflictWarning ?? legacy.variationIconConflictWarning,\n\t\tnullValueWarning: warnings.nullValueWarning ?? legacy.nullValueWarning,\n\t\ttargetSuppressedWarning: warnings.targetSuppressedWarning ?? legacy.targetSuppressedWarning,\n\t\tghostOnRareEventWarning: warnings.ghostOnRareEventWarning ?? legacy.ghostOnRareEventWarning,\n\t\tpartitionSizeWarnings: warnings.partitionSizeWarnings ?? legacy.partitionSizeWarnings,\n\t\tbaselineSpecialCauseWarning: warnings.baselineSpecialCauseWarning ?? legacy.baselineSpecialCauseWarning,\n\t\tmaximumPointsWarnings: warnings.maximumPointsWarnings ?? legacy.maximumPointsWarnings,\n\t\t// Capability\n\t\tassuranceCapabilityMode: capability.assuranceCapabilityMode ?? legacy.assuranceCapabilityMode,\n\t\t// Grace\n\t\temergingGraceEnabled,\n\t\temergingDirectionGrace: emergingGraceEnabled,\n\t\t// Baseline suggestions\n\t\tbaselineSuggest: baselineSuggest.enabled ?? legacy.baselineSuggest,\n\t\tbaselineSuggestMinDeltaSigma: baselineSuggest.minDeltaSigma ?? legacy.baselineSuggestMinDeltaSigma,\n\t\tbaselineSuggestStabilityPoints: baselineSuggest.stabilityPoints ?? legacy.baselineSuggestStabilityPoints,\n\t\tbaselineSuggestMinGap: baselineSuggest.minGap ?? legacy.baselineSuggestMinGap,\n\t\tbaselineSuggestScoreThreshold: baselineSuggest.scoreThreshold ?? legacy.baselineSuggestScoreThreshold,\n\t\t// Auto recalculation\n\t\tautoRecalculateAfterShift: autoRecalc.enabled ?? legacy.autoRecalculateAfterShift,\n\t\tautoRecalculateShiftLength: autoRecalc.shiftLength ?? legacy.autoRecalculateShiftLength,\n\t\tautoRecalculateDeltaSigma: autoRecalc.deltaSigma ?? legacy.autoRecalculateDeltaSigma,\n\t} as SpcSettings);\n\n\t// Also spread any remaining legacy flat fields provided directly to override defaults (keep only defined)\n\tconst merged: SpcSettings = { ...flattened, ...pruneUndefined<SpcSettings>(legacy) } as SpcSettings;\n\t// ensure canonical pairs remain consistent when explicitly provided\n\tif (emergingGraceEnabled !== undefined) {\n\t\t(merged as any).emergingGraceEnabled = emergingGraceEnabled;\n\t\t(merged as any).grace = { ...(merged as any).grace, emergingEnabled: emergingGraceEnabled };\n\t}\n\tif ((flattened as any).collapseWeakerClusterRules !== undefined) {\n\t\tconst v = (flattened as any).collapseWeakerClusterRules;\n\t\t(merged as any).collapseWeakerClusterRules = v;\n\t\t(merged as any).rules = { ...(merged as any).rules, collapseWeakerClusterRules: v };\n\t}\n\t// Final prune to remove any lingering undefined keys\n\treturn pruneUndefined<SpcSettings>(merged) as SpcSettings;\n}\n\nexport function buildSpc(args: BuildSpcArgs): SpcResult {\n\tconst {\n\t\tchartType,\n\t\tmetricImprovement,\n\t\tdata,\n\t\tsettings: rawUserSettings = {},\n\t} = args;\n\n\t// Convert any V2 setting names to legacy internal names until engine migrates fully.\n\tconst userSettings = normaliseSpcSettings(rawUserSettings);\n\n\tconst settings = {\n\t\texcludeMovingRangeOutliers: false,\n\t\tspecialCauseShiftPoints: 6,\n\t\tspecialCauseTrendPoints: 6,\n\t\tenableFourOfFiveRule: false,\n\t\tminimumPoints: 13,\n\t\tminimumPointsWarning: false,\n\t\tminimumPointsPartition: 12,\n\t\tmaximumPointsPartition: null,\n\t\tmaximumPoints: null,\n\t\tpointConflictWarning: false,\n\t\tvariationIconConflictWarning: true,\n\t\tnullValueWarning: true,\n\t\ttargetSuppressedWarning: true,\n\t\tghostOnRareEventWarning: true,\n\t\tpartitionSizeWarnings: true,\n\t\tbaselineSpecialCauseWarning: true,\n\t\tmaximumPointsWarnings: true,\n\t\tassuranceCapabilityMode: true,\n\t\ttransitionBufferPoints: 2,\n\t\tcollapseWeakerClusterRules: true,\n\t\tbaselineSuggest: false,\n\t\tbaselineSuggestMinDeltaSigma: 0.5,\n\t\tbaselineSuggestStabilityPoints: 5,\n\t\tbaselineSuggestMinGap: 12,\n\t\tbaselineSuggestScoreThreshold: 50,\n\t\tprecedenceStrategy: PrecedenceStrategy.DirectionalFirst,\n\t\temergingDirectionGrace: false,\n\t\trules: {},\n\t\tgrace: {},\n\t\t// REMOVED: trendSideGatingEnabled default (always on)\n\t\tautoRecalculateAfterShift: false,\n\t\tautoRecalculateShiftLength: undefined,\n\t\tautoRecalculateDeltaSigma: 0.5,\n\t\t...userSettings,\n\t} as Required<SpcSettings>;\n\n\tif (!Array.isArray(data)) throw new Error(\"data must be an array of rows\");\n\tconst canonical: CanonicalRow[] = data.map((d, i) => ({\n\t\trowId: i + 1,\n\t\tx: d.x,\n\t\tvalue: isNumber(d.value) ? d.value : null,\n\t\tghost: !!d.ghost,\n\t\tbaseline: !!d.baseline,\n\t\ttarget: isNumber(d.target) ? d.target : null,\n\t}));\n\n\t// Optionally augment canonical rows with auto recalculation baseline flags (synthetic) BEFORE partitioning\n\tif (userSettings?.autoRecalculateAfterShift) {\n\t\ttry {\n\t\t\tapplyAutoRecalculationBaselines(canonical, userSettings, metricImprovement);\n\t\t} catch {\n\t\t\t// Fail silently \u2013 feature is non-critical\n\t\t}\n\t}\n\tconst partitions = partitionRows(canonical);\n\tconst output: SpcRow[] = [];\n\tconst warnings: SpcWarning[] = [];\n\n\t// Global counts for minimum point checks\n\tconst nonGhostGlobalCount = canonical.filter(\n\t\t(r) => !r.ghost && isNumber(r.value)\n\t).length;\n\tconst globalEnough = nonGhostGlobalCount >= (settings.minimumPoints ?? 13);\n\n\t// Iterate partitions\n\tlet partitionId = 0;\n\tconst partitionNonGhostCounts: Record<number, number> = {};\n\tfor (const part of partitions) {\n\t\tpartitionId++;\n\n\t\tconst values = part.map((r) => r.value);\n\t\tconst ghosts = part.map((r) => r.ghost);\n\n\t\t// Initialize moving range variables\n\t\tlet mr: (number | null)[] = new Array(values.length).fill(null);\n\t\tlet centerLine: number = NaN;\n\t\tlet mrMean: number = NaN;\n\t\tlet mrUcl: number = NaN;\n\n\t\t// Control limits structure\n\t\t// Initialized to nulls so can be used directly when limits not computable\n\t\t// (e.g. insufficient data, or G chart with no MR concept)\n\t\tlet lim: {\n\t\t\tupperProcessLimit: number | null;\n\t\t\tlowerProcessLimit: number | null;\n\t\t\tupperTwoSigma: number | null;\n\t\t\tlowerTwoSigma: number | null;\n\t\t\tupperOneSigma: number | null;\n\t\t\tlowerOneSigma: number | null;\n\t\t} = {\n\t\t\tupperProcessLimit: null,\n\t\t\tlowerProcessLimit: null,\n\t\t\tupperTwoSigma: null,\n\t\t\tlowerTwoSigma: null,\n\t\t\tupperOneSigma: null,\n\t\t\tlowerOneSigma: null,\n\t\t};\n\n\t\t// Chart-type-specific calculations\n\t\t// XmR: moving ranges, mean, limits\n\t\t// T: transformed XmR, back-transform limits\n\t\t// G: probability-based limits (no MR)\n\n\t\tif (chartType === \"XmR\") {\n\t\t\tmr = movingRanges(values, ghosts);\n\t\t\tconst nonGhostVals = values.filter(\n\t\t\t\t(v, i) => !ghosts[i] && isNumber(v)\n\t\t\t) as number[];\n\t\t\tcenterLine = nonGhostVals.length ? mean(nonGhostVals) : NaN;\n\t\t\tconst tmp = mrMeanWithOptionalExclusion(\n\t\t\t\tmr,\n\t\t\t\t!!settings.excludeMovingRangeOutliers\n\t\t\t);\n\t\t\tmrMean = tmp.mrMean;\n\t\t\tmrUcl = tmp.mrUcl;\n\t\t\tlim = xmrLimits(centerLine, mrMean);\n\t\t} else if (chartType === \"T\") {\n\t\t\tconst tlim = tChartLimits(\n\t\t\t\tvalues,\n\t\t\t\tghosts,\n\t\t\t\t!!settings.excludeMovingRangeOutliers\n\t\t\t);\n\t\t\tmr = tlim.mr;\n\t\t\tmrMean = tlim.mrMean ?? NaN;\n\t\t\tmrUcl = tlim.mrUcl ?? NaN;\n\t\t\tcenterLine = tlim.center ?? NaN;\n\t\t\tlim = {\n\t\t\t\tupperProcessLimit: tlim.upperProcessLimit,\n\t\t\t\tlowerProcessLimit: tlim.lowerProcessLimit,\n\t\t\t\tupperTwoSigma: tlim.upperTwoSigma,\n\t\t\t\tlowerTwoSigma: tlim.lowerTwoSigma,\n\t\t\t\tupperOneSigma: tlim.upperOneSigma,\n\t\t\t\tlowerOneSigma: tlim.lowerOneSigma,\n\t\t\t};\n\t\t} else if (chartType === \"G\") {\n\t\t\tconst nonGhostVals = values.filter(\n\t\t\t\t(v, i) => !ghosts[i] && isNumber(v)\n\t\t\t) as number[];\n\t\t\tconst gMean = nonGhostVals.length ? mean(nonGhostVals) : NaN;\n\t\t\tconst g = gChartProbabilityLimits(gMean);\n\t\t\tcenterLine = g.cl ?? NaN;\n\t\t\tlim = {\n\t\t\t\tupperProcessLimit: g.ucl,\n\t\t\t\tlowerProcessLimit: g.lcl,\n\t\t\t\tupperTwoSigma: g.twoHigh,\n\t\t\t\tlowerTwoSigma: g.twoLow,\n\t\t\t\tupperOneSigma: g.oneHigh,\n\t\t\t\tlowerOneSigma: g.oneLow,\n\t\t\t};\n\t\t\t// No MR concept on probability-based G\n\t\t\tmr = new Array(values.length).fill(null);\n\t\t\tmrMean = NaN;\n\t\t\tmrUcl = NaN;\n\t\t} else {\n\t\t\twarnings.push({\n\t\t\t\tcode: SpcWarningCode.UnknownChartType,\n\t\t\t\tcategory: SpcWarningCategory.Config,\n\t\t\t\tseverity: SpcWarningSeverity.Error,\n\t\t\t\tmessage: `Unknown ChartType '${chartType}' \u2013 supported: XmR, T, G.`,\n\t\t\t\tcontext: { chartType },\n\t\t\t});\n\t\t}\n\n\t\t// Build rows with lines & limits (or nulls if insufficient data)\n\t\t// Suppress limits until global minimum points reached\n\t\t// (per NHS SPC guidance to avoid misleading signals)\n\t\tconst withLines: SpcRow[] = part.map((r, i) => {\n\t\t\tconst pointRank =\n\t\t\t\t!r.ghost && isNumber(r.value)\n\t\t\t\t\t? values.slice(0, i + 1).filter((v, j) => !ghosts[j] && isNumber(v))\n\t\t\t\t\t\t\t.length\n\t\t\t\t\t: 0;\n\n\t\t\tconst limitsAllowed = globalEnough; // suppress until global minimum reached\n\t\t\tconst limits = limitsAllowed\n\t\t\t\t? lim\n\t\t\t\t: {\n\t\t\t\t\t\tupperProcessLimit: null,\n\t\t\t\t\t\tlowerProcessLimit: null,\n\t\t\t\t\t\tupperTwoSigma: null,\n\t\t\t\t\t\tlowerTwoSigma: null,\n\t\t\t\t\t\tupperOneSigma: null,\n\t\t\t\t\t\tlowerOneSigma: null,\n\t\t\t\t\t};\n\n\t\t\tconst row: SpcRow = {\n\t\t\t\trowId: r.rowId,\n\t\t\t\tx: r.x,\n\t\t\t\tvalue: isNumber(r.value) ? r.value : null,\n\t\t\t\tghost: r.ghost,\n\t\t\t\tpartitionId,\n\t\t\t\tpointRank,\n\t\t\t\tmean: limitsAllowed && isNumber(centerLine) ? centerLine : null,\n\t\t\t\tmr: isNumber(mr[i]) ? mr[i] : null,\n\t\t\t\tmrMean: limitsAllowed && isNumber(mrMean) ? mrMean : null,\n\t\t\t\tmrUcl: limitsAllowed && isNumber(mrUcl) ? mrUcl : null,\n\t\t\t\tupperProcessLimit: isNumber(limits.upperProcessLimit)\n\t\t\t\t\t? limits.upperProcessLimit\n\t\t\t\t\t: null,\n\t\t\t\tlowerProcessLimit: isNumber(limits.lowerProcessLimit)\n\t\t\t\t\t? limits.lowerProcessLimit\n\t\t\t\t\t: null,\n\t\t\t\tupperTwoSigma: isNumber(limits.upperTwoSigma)\n\t\t\t\t\t? limits.upperTwoSigma\n\t\t\t\t\t: null,\n\t\t\t\tlowerTwoSigma: isNumber(limits.lowerTwoSigma)\n\t\t\t\t\t? limits.lowerTwoSigma\n\t\t\t\t\t: null,\n\t\t\t\tupperOneSigma: isNumber(limits.upperOneSigma)\n\t\t\t\t\t? limits.upperOneSigma\n\t\t\t\t\t: null,\n\t\t\t\tlowerOneSigma: isNumber(limits.lowerOneSigma)\n\t\t\t\t\t? limits.lowerOneSigma\n\t\t\t\t\t: null,\n\t\t\t\ttarget: isNumber(r.target) ? r.target : null,\n\t\t\t\tspecialCauseFifteenInnerThird: false,\n\t\t\t\t// Unified directional alias initialisers (kept in sync post-detection)\n\t\t\t\tspecialCauseSinglePointUp: false,\n\t\t\t\tspecialCauseSinglePointDown: false,\n\t\t\t\tspecialCauseTwoOfThreeUp: false,\n\t\t\t\tspecialCauseTwoOfThreeDown: false,\n\t\t\t\tspecialCauseFourOfFiveUp: false,\n\t\t\t\tspecialCauseFourOfFiveDown: false,\n\t\t\t\tspecialCauseShiftUp: false,\n\t\t\t\tspecialCauseShiftDown: false,\n\t\t\t\tspecialCauseTrendUp: false,\n\t\t\t\tspecialCauseTrendDown: false,\n\t\t\t\tvariationIcon: VariationIcon.Suppressed,\n\t\t\t\tassuranceIcon: AssuranceIcon.None,\n\t\t\t\tupperBaseline:\n\t\t\t\t\tlimitsAllowed && isNumber(centerLine) ? centerLine : null,\n\t\t\t\tlowerBaseline:\n\t\t\t\t\tlimitsAllowed && isNumber(centerLine) ? centerLine : null,\n\t\t\t\tmovingRangeHighPointValue:\n\t\t\t\t\tlimitsAllowed && isNumber(mrUcl) ? mrUcl : null,\n\t\t\t\tghostValue: r.ghost && isNumber(r.value) ? r.value : null,\n\t\t\t\tghostFlag: !!r.ghost,\n\t\t\t\tspecialCauseImprovementValue: null,\n\t\t\t\tspecialCauseConcernValue: null,\n\t\t\t\tspecialCauseNeitherValue: null,\n\t\t\t\truleTags: [],\n\t\t\t};\n\t\t\treturn row;\n\t\t});\n\n\t\tpartitionNonGhostCounts[partitionId] = withLines.filter(\n\t\t\t(r) => !r.ghost && isNumber(r.value)\n\t\t).length;\n\n\t\t// Special cause detection (within partition)\n\t\tconst shiftN = settings.specialCauseShiftPoints ?? 6;\n\t\tconst trendN = settings.specialCauseTrendPoints ?? 6;\n\n\t\t// First pass: build rows & detect single-point 3-sigma only; collect non-ghost numeric indices for second-pass pattern detection\n\t\tconst nonGhostIndices: number[] = [];\n\t\tconst nonGhostValues: number[] = [];\n\t\tfor (let i = 0; i < withLines.length; i++) {\n\t\t\tconst row = withLines[i];\n\t\t\tconst v = row.value;\n\t\t\tif (!row.ghost && isNumber(v)) {\n\t\t\t\tnonGhostIndices.push(i);\n\t\t\t\tnonGhostValues.push(v);\n\t\t\t}\n\n\t\t\tconst hasLimits =\n\t\t\t\tisNumber(row.mean) &&\n\t\t\t\tisNumber(row.upperProcessLimit) &&\n\t\t\t\tisNumber(row.lowerProcessLimit);\n\t\t\tif (!hasLimits || row.ghost || !isNumber(v)) {\n\t\t\t\toutput.push(row);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Single point beyond 3-sigma (populate directional flags directly)\n\t\t\trow.specialCauseSinglePointUp = isNumber(row.upperProcessLimit)\n\t\t\t\t? v > row.upperProcessLimit\n\t\t\t\t: false;\n\t\t\trow.specialCauseSinglePointDown = isNumber(row.lowerProcessLimit)\n\t\t\t\t? v < row.lowerProcessLimit\n\t\t\t\t: false;\n\n\t\t\t// Multi-point rules deferred to second pass\n\n\t\t\t// Trend of N strictly increasing/decreasing\n\t\t\t// (deferred to second pass)\n\n\t\t\toutput.push(row);\n\t\t}\n\n\t\t// Second pass: apply multi-point pattern rules with complete backfill\n\t\tif (nonGhostIndices.length) {\n\t\t\t// Helper accessors\n\t\t\tconst getRow = (idx: number) => withLines[idx];\n\t\t\t// Shift detection (runs above/below mean)\n\t\t\tlet runHigh: number[] = [];\n\t\t\tlet runLow: number[] = [];\n\t\t\tfor (const idxLocal of nonGhostIndices) {\n\t\t\t\tconst r = getRow(idxLocal);\n\t\t\t\tif (!isNumber(r.mean) || !isNumber(r.value)) { runHigh = []; runLow = []; continue; }\n\t\t\t\tif (r.value > r.mean) { runHigh.push(idxLocal); runLow = []; } else if (r.value < r.mean) { runLow.push(idxLocal); runHigh = []; } else { runHigh = []; runLow = []; }\n\t\t\t\tif (runHigh.length >= shiftN) {\n\t\t\t\t\tfor (const j of runHigh) { const rr = getRow(j); rr.specialCauseShiftUp = true; }\n\t\t\t\t}\n\t\t\t\tif (runLow.length >= shiftN) {\n\t\t\t\t\tfor (const j of runLow) { const rr = getRow(j); rr.specialCauseShiftDown = true; }\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Two-of-three 2-sigma (high/low): flag ONLY the points beyond \u00B12\u03C3 within a qualifying same-side triple\n\t\t\t// NOTE: Points beyond 3\u03C3 (process limits) are excluded from counting for this rule (they are handled by the single-point rule).\n\t\t\tfor (let w = 0; w <= nonGhostIndices.length - 3; w++) {\n\t\t\t\tconst windowIdx = nonGhostIndices.slice(w, w + 3);\n\t\t\t\tconst rows3 = windowIdx.map(getRow);\n\t\t\t\tif (!rows3.every(r => isNumber(r.mean) && isNumber(r.value))) continue;\n\t\t\t\tconst meanVal = rows3[0].mean!; // stable within partition\n\t\t\t\tconst allHighSide = rows3.every(r => r.value! > meanVal);\n\t\t\t\tconst allLowSide = rows3.every(r => r.value! < meanVal);\n\t\t\t\tif (!allHighSide && !allLowSide) continue;\n\t\t\t\tconst u2 = rows3[0].upperTwoSigma ?? Infinity;\n\t\t\t\tconst l2 = rows3[0].lowerTwoSigma ?? -Infinity;\n\t\t\t\tconst u3 = rows3[0].upperProcessLimit ?? Infinity;\n\t\t\t\tconst l3 = rows3[0].lowerProcessLimit ?? -Infinity;\n\t\t\t\t// Exclude >3\u03C3 (single-point) from candidate sets so they do not contribute to the 2-of-3 count\n\t\t\t\tconst highExceed = rows3.filter(r => r.value! > u2 && r.value! <= u3);\n\t\t\t\tconst lowExceed = rows3.filter(r => r.value! < l2 && r.value! >= l3);\n\t\t\t\tif (allHighSide && highExceed.length >= 2) {\n\t\t\t\t\tfor (const r of highExceed) { r.specialCauseTwoOfThreeUp = true; }\n\t\t\t\t}\n\t\t\t\tif (allLowSide && lowExceed.length >= 2) {\n\t\t\t\t\tfor (const r of lowExceed) { r.specialCauseTwoOfThreeDown = true; }\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Four-of-five 1-sigma (if enabled): flag ONLY the points beyond \u00B11\u03C3 within qualifying window\n\t\t\tif (settings.enableFourOfFiveRule) {\n\t\t\t\tfor (let w = 0; w <= nonGhostIndices.length - 5; w++) {\n\t\t\t\t\tconst windowIdx = nonGhostIndices.slice(w, w + 5);\n\t\t\t\t\tconst rows5 = windowIdx.map(getRow);\n\t\t\t\t\tif (!rows5.every(r => isNumber(r.mean) && isNumber(r.value))) continue;\n\t\t\t\t\tconst meanVal = rows5[0].mean!;\n\t\t\t\t\tif (!rows5.every(r => r.value! > meanVal) && !rows5.every(r => r.value! < meanVal)) continue;\n\t\t\t\t\tconst u1 = rows5[0].upperOneSigma ?? Infinity;\n\t\t\t\t\tconst l1 = rows5[0].lowerOneSigma ?? -Infinity;\n\t\t\t\t\tconst highExceed = rows5.filter(r => r.value! > u1);\n\t\t\t\t\tconst lowExceed = rows5.filter(r => r.value! < l1);\n\t\t\t\t\tif (rows5.every(r => r.value! > meanVal) && highExceed.length >= 4) {\n\t\t\t\t\t\tfor (const r of highExceed) { r.specialCauseFourOfFiveUp = true; }\n\t\t\t\t\t}\n\t\t\t\t\tif (rows5.every(r => r.value! < meanVal) && lowExceed.length >= 4) {\n\t\t\t\t\t\tfor (const r of lowExceed) { r.specialCauseFourOfFiveDown = true; }\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Trend increasing/decreasing\n\t\t\tfor (let w = 0; w <= nonGhostIndices.length - trendN; w++) {\n\t\t\t\tconst windowIdx = nonGhostIndices.slice(w, w + trendN);\n\t\t\t\tconst rowsN = windowIdx.map(getRow);\n\t\t\t\tif (!rowsN.every(r=> isNumber(r.value))) continue;\n\t\t\t\tlet inc = true; let dec = true;\n\t\t\t\tfor (let k=1;k<rowsN.length;k++) {\n\t\t\t\t\tif (!(rowsN[k].value! > rowsN[k-1].value!)) inc = false;\n\t\t\t\t\tif (!(rowsN[k].value! < rowsN[k-1].value!)) dec = false;\n\t\t\t\t\tif (!inc && !dec) break;\n\t\t\t\t}\n\t\t\t\tif (inc) for (const j of windowIdx) { const rr = getRow(j); rr.specialCauseTrendUp = true; }\n\t\t\t\tif (dec) for (const j of windowIdx) { const rr = getRow(j); rr.specialCauseTrendDown = true; }\n\t\t\t}\n\n\t\t\t// Fifteen consecutive points within inner third (optional)\n\t\t\tif (settings.enableFifteenInInnerThirdRule) {\n\t\t\t\tlet innerRun: number[] = [];\n\t\t\t\tfor (const idxLocal of nonGhostIndices) {\n\t\t\t\t\tconst r = getRow(idxLocal);\n\t\t\t\t\tif (!isNumber(r.value) || !isNumber(r.mean) || !isNumber(r.upperOneSigma) || !isNumber(r.lowerOneSigma)) { innerRun = []; continue; }\n\t\t\t\t\tconst inBand = r.value < r.upperOneSigma! && r.value > r.lowerOneSigma!;\n\t\t\t\t\tif (!inBand) { innerRun = []; continue; }\n\t\t\t\t\tinnerRun.push(idxLocal);\n\t\t\t\t\tif (innerRun.length >= 15) {\n\t\t\t\t\t\tconst rowsRun = innerRun.map(getRow);\n\t\t\t\t\t\tconst anyAbove = rowsRun.some(rr => rr.value! > rr.mean!);\n\t\t\t\t\t\tconst anyBelow = rowsRun.some(rr => rr.value! < rr.mean!);\n\t\t\t\t\t\tif (anyAbove && anyBelow) {\n\t\t\t\t\t\t\tfor (const j of innerRun) getRow(j).specialCauseFifteenInnerThird = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// (No pruning needed under selective flagging semantics)\n\t\t}\n\n\t\t// (Optional) enforce maximumPointsPartition by nulling limits after cap\n\t\tif (\n\t\t\tsettings.maximumPointsPartition &&\n\t\t\tNumber.isFinite(settings.maximumPointsPartition)\n\t\t) {\n\t\t\tconst cap = settings.maximumPointsPartition as number;\n\t\t\tlet seen = 0;\n\t\t\tfor (const row of output.filter((r) => r.partitionId === partitionId)) {\n\t\t\t\tif (!row.ghost && isNumber(row.value)) seen++;\n\t\t\t\tif (seen > cap) {\n\t\t\t\t\trow.mean = row.upperProcessLimit = row.lowerProcessLimit = null;\n\t\t\t\t\trow.upperTwoSigma =\n\t\t\t\t\t\trow.lowerTwoSigma =\n\t\t\t\t\t\trow.upperOneSigma =\n\t\t\t\t\t\trow.lowerOneSigma =\n\t\t\t\t\t\t\tnull;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// (Removed) legacy \u2192 alias sync loop: aliases now set inline during detection\n\t}\n\n\t// Variation icon per row based on improvement direction\n\t// --- Provenance: capture original rule-based flags BEFORE any heuristic mutation occurs ---\n\t// We populate ruleTags exactly once, immediately prior to heuristics that can mutate the specialCause* booleans.\n\t// If already populated (defensive), skip.\n\tfor (const r of output) {\n\t\tif (r.ruleTags && r.ruleTags.length) continue; // already captured\n\t\tconst tags: string[] = [];\n\t\tif (r.specialCauseShiftUp) tags.push(SpcRawRuleTag.ShiftHigh);\n\t\tif (r.specialCauseShiftDown) tags.push(SpcRawRuleTag.ShiftLow);\n\t\tif (r.specialCauseTrendUp) tags.push(SpcRawRuleTag.TrendIncreasing);\n\t\tif (r.specialCauseTrendDown) tags.push(SpcRawRuleTag.TrendDecreasing);\n\t\tif (r.specialCauseSinglePointUp) tags.push(SpcRawRuleTag.SinglePointAbove);\n\t\tif (r.specialCauseSinglePointDown) tags.push(SpcRawRuleTag.SinglePointBelow);\n\t\tif (r.specialCauseTwoOfThreeUp) tags.push(SpcRawRuleTag.TwoOfThreeAbove);\n\t\tif (r.specialCauseTwoOfThreeDown) tags.push(SpcRawRuleTag.TwoOfThreeBelow);\n\t\tif (r.specialCauseFourOfFiveUp) tags.push(SpcRawRuleTag.FourOfFiveAbove);\n\t\tif (r.specialCauseFourOfFiveDown) tags.push(SpcRawRuleTag.FourOfFiveBelow);\n\t\tif (r.specialCauseFifteenInnerThird) tags.push(SpcRawRuleTag.FifteenInnerThird);\n\t\t// Only persist if any tags present for compactness\n\t\tif (tags.length) r.ruleTags = tags as SpcRawRuleTag[];\n\t}\n\n\t// Heuristic tagging helper removed (no remaining heuristics mutate classification)\n\n\t// Retroactive neutralisation heuristic removed\n\n\t// Comparative baseline emulation block removed\n\n\tfor (let idx = 0; idx < output.length; idx++) {\n\t\tconst row = output[idx];\n\t\t// Alias getter scaffolding (Phase 1 optional): expose forward-compatible names\n\t\t// improvementValueBeforePruning / concernValueBeforePruning mapping to legacy originals if defined.\n\t\t// Non-enumerable to discourage new usage until Phase 2 formalises rename.\n\t\tif (!(Object.prototype.hasOwnProperty.call(row, SpcRowAliasField.ImprovementValueBeforePruning))) {\n\t\t\tObject.defineProperty(row, SpcRowAliasField.ImprovementValueBeforePruning, {\n\t\t\t\tget() { return (row as any).originalSpecialCauseImprovementValue ?? null; },\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true\n\t\t\t});\n\t\t}\n\t\tif (!(Object.prototype.hasOwnProperty.call(row, SpcRowAliasField.ConcernValueBeforePruning))) {\n\t\t\tObject.defineProperty(row, SpcRowAliasField.ConcernValueBeforePruning, {\n\t\t\t\tget() { return (row as any).originalSpecialCauseConcernValue ?? null; },\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: true\n\t\t\t});\n\t\t}\n\t\tif (row.ghost || !isNumber(row.value) || row.mean === null) {\n\t\t\trow.variationIcon = VariationIcon.Suppressed;\n\t\t\tcontinue;\n\t\t}\n\t\t// Directional aggregation now sourced from alias Up/Down flags to unify internal logic.\n\t\t// Trend side-gating behaviour preserved exactly (only contribute if on favourable side when enabled).\n\t\tconst onHighSide = row.value! > row.mean!;\n\t\tconst onLowSide  = row.value! < row.mean!;\n\t\t// Optional cluster rule collapse (retain stronger 4-of-5 over 2-of-3 when both same side)\n\t\t// Ensure both legacy and alias flags are cleared to preserve parity tests.\n\t\tif (settings.rules?.collapseWeakerClusterRules) {\n\t\t\tif (row.specialCauseTwoOfThreeUp && row.specialCauseFourOfFiveUp) { row.specialCauseTwoOfThreeUp = false; }\n\t\t\tif (row.specialCauseTwoOfThreeDown && row.specialCauseFourOfFiveDown) { row.specialCauseTwoOfThreeDown = false; }\n\t\t}\n\n\t\t// Side-gated trend contribution to icon classification\n\t\t// NOTE: trendSideGatingEnabled setting is deprecated and has no effect; trend is always side-gated for icon classification.\n\t\t// Unified (Phase 2) semantics: trend signals only contribute to high/low side when on the corresponding side of the mean.\n\t\t// Side-gating flags (trendFavourableSideOnly / trendSideGatingEnabled) are now effectively always-on for icon classification.\n\t\tconst trendUpQualified = row.specialCauseTrendUp && onHighSide;\n\t\tconst trendDownQualified = row.specialCauseTrendDown && onLowSide;\n\t\tconst highSignals = (row.specialCauseSinglePointUp || row.specialCauseTwoOfThreeUp || (settings.enableFourOfFiveRule && row.specialCauseFourOfFiveUp) || row.specialCauseShiftUp || trendUpQualified);\n\t\tconst lowSignals = (row.specialCauseSinglePointDown || row.specialCauseTwoOfThreeDown || (settings.enableFourOfFiveRule && row.specialCauseFourOfFiveDown) || row.specialCauseShiftDown || trendDownQualified);\n\n\t\t// Emerging favourable detection (N-1 monotonic run in favourable direction before trend flag fires)\n\t\tlet emergingFavourable = false;\n\t\tif (settings.precedenceStrategy === PrecedenceStrategy.DirectionalFirst && (settings.grace?.emergingEnabled || settings.emergingGraceEnabled || settings.emergingDirectionGrace)) {\n\t\t\tconst trendN = settings.specialCauseTrendPoints || 6;\n\t\t\tif (trendN > 1 && !(row.specialCauseTrendUp || row.specialCauseTrendDown)) {\n\t\t\t\tconst needed = trendN - 1;\n\t\t\t\t// Collect last needed non-ghost numeric rows including current row\n\t\t\t\tconst seq: SpcRow[] = [];\n\t\t\t\tfor (let back = idx; back >= 0 && seq.length < needed; back--) {\n\t\t\t\t\tconst rPrev = output[back];\n\t\t\t\t\tif (!rPrev.ghost && isNumber(rPrev.value) && rPrev.mean !== null) seq.unshift(rPrev);\n\t\t\t\t}\n\t\t\t\tif (seq.length === needed) {\n\t\t\t\t\tlet monotonic = true;\n\t\t\t\t\tfor (let k = 1; k < seq.length && monotonic; k++) {\n\t\t\t\t\t\tif (metricImprovement === ImprovementDirection.Up) {\n\t\t\t\t\t\t\tif (!(seq[k].value! > seq[k-1].value!)) monotonic = false;\n\t\t\t\t\t\t} else if (metricImprovement === ImprovementDirection.Down) {\n\t\t\t\t\t\t\tif (!(seq[k].value! < seq[k-1].value!)) monotonic = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmonotonic = false; // neutral metrics do not use emerging grace\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\temergingFavourable = monotonic;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (settings.precedenceStrategy === PrecedenceStrategy.DirectionalFirst) {\n\t\t\t// Parity adjustment: if a favourable trend exists but was side-gated (value still on the opposite side of mean)\n\t\t\t// we still want to recognise its emerging directional weight when resolving simultaneous opposing signals.\n\t\t\t// The SQL wrapper counts raw trend flags irrespective of side gating, leading to earlier Improvement framing\n\t\t\t// in mixed shift+emerging trend sequences. We mirror that by treating a suppressed favourable trend as a\n\t\t\t// (low-rank) favourable presence for precedence purposes only.\n\t\t\t// Side gating: earlier implementation tracked suppressedTrendFavourable for precedence; no longer needed for icon logic.\n\t\t\tconst favourableRaw = metricImprovement === ImprovementDirection.Up ? highSignals : metricImprovement === ImprovementDirection.Down ? lowSignals : false;\n\t\t\t// Regression fix: suppressed (side\u2011gated) favourable trend rows should NOT directly yield an Improvement icon\n\t\t\t// until the series crosses the mean (tests expect gating). We retain suppressedTrendFavourable only for potential\n\t\t\t// future precedence heuristics but exclude it from icon classification.\n\t\t\tconst favourable = favourableRaw; // intentionally excludes suppressedTrendFavourable from direct icon promotion\n\t\t\tconst unfavourable = metricImprovement === ImprovementDirection.Up ? lowSignals : metricImprovement === ImprovementDirection.Down ? highSignals : false;\n\t\t\tif (favourable && !unfavourable) row.variationIcon = VariationIcon.Improvement;\n\t\t\telse if (unfavourable && !favourable) row.variationIcon = emergingFavourable ? VariationIcon.Neither : VariationIcon.Concern;\n\t\t\telse if (favourable && unfavourable) row.variationIcon = (emergingFavourable || row.specialCauseTrendUp || row.specialCauseTrendDown) ? VariationIcon.Improvement : VariationIcon.Neither;\n\t\t\telse row.variationIcon = VariationIcon.Neither;\n\t\t} else {\n\t\t\tif (metricImprovement === ImprovementDirection.Up) row.variationIcon = highSignals ? VariationIcon.Improvement : lowSignals ? VariationIcon.Concern : VariationIcon.Neither;\n\t\t\telse if (metricImprovement === ImprovementDirection.Down) row.variationIcon = lowSignals ? VariationIcon.Improvement : highSignals ? VariationIcon.Concern : VariationIcon.Neither;\n\t\t\telse row.variationIcon = VariationIcon.Neither;\n\t\t}\n\n\t\t// Removed suppression of isolated favourable single 3\u03C3 heuristic\n\n\t\tconst anySignal = highSignals || lowSignals;\n\t\trow.specialCauseImprovementValue =\n\t\t\tanySignal && row.variationIcon === VariationIcon.Improvement\n\t\t\t\t? row.value\n\t\t\t\t: null;\n\t\trow.specialCauseConcernValue =\n\t\t\tanySignal && row.variationIcon === VariationIcon.Concern\n\t\t\t\t? row.value\n\t\t\t\t: null;\n\t\trow.specialCauseNeitherValue =\n\t\t\tanySignal && row.variationIcon === VariationIcon.Neither\n\t\t\t\t? row.value\n\t\t\t\t: null;\n\n\t\t// --- Optional SQL-style conflict resolution (applies AFTER icon decision so we can inspect simultaneous signals) ---\n\t\tif (\n\t\t\tsettings.conflictPrecedenceMode === ConflictPrecedenceMode.SqlRankingV26a &&\n\t\t\trow.specialCauseImprovementValue !== null &&\n\t\t\trow.specialCauseConcernValue !== null\n\t\t) {\n\t\t\t// Collect active rule ids per side (only those that contribute to current high/low signals)\n\t\t\t// We purposefully do not attempt to reconstruct historical intermediate heuristics; rely on raw specialCause* booleans.\n\t\t\tconst active: { id: SpcRuleId; rank: number; side: Side }[] = [];\n\t\t\t// Rank mapping: single_point=1, two_sigma=2, shift=3, trend=4 (four_of_five not part of NHS primary ranking)\n\t\t\tif (row.specialCauseSinglePointUp) active.push({ id: SpcRuleId.SinglePoint, rank: 1, side: Side.Up });\n\t\t\tif (row.specialCauseSinglePointDown) active.push({ id: SpcRuleId.SinglePoint, rank: 1, side: Side.Down });\n\t\t\tif (row.specialCauseTwoOfThreeUp) active.push({ id: SpcRuleId.TwoSigma, rank: 2, side: Side.Up });\n\t\t\tif (row.specialCauseTwoOfThreeDown) active.push({ id: SpcRuleId.TwoSigma, rank: 2, side: Side.Down });\n\t\t\tif (row.specialCauseShiftUp) active.push({ id: SpcRuleId.Shift, rank: 3, side: Side.Up });\n\t\t\tif (row.specialCauseShiftDown) active.push({ id: SpcRuleId.Shift, rank: 3, side: Side.Down });\n\t\t\tif (row.specialCauseTrendUp) active.push({ id: SpcRuleId.Trend, rank: 4, side: Side.Up });\n\t\t\tif (row.specialCauseTrendDown) active.push({ id: SpcRuleId.Trend, rank: 4, side: Side.Down });\n\t\t\t// Compute side maxima\n\t\t\tconst upMax = active.filter(a => a.side === Side.Up).reduce((m,a)=> Math.max(m,a.rank), 0);\n\t\t\tconst downMax = active.filter(a => a.side === Side.Down).reduce((m,a)=> Math.max(m,a.rank), 0);\n\t\t\tlet prime: PrimeDirection;\n\t\t\tif (upMax > downMax) prime = PrimeDirection.Upwards; else if (downMax > upMax) prime = PrimeDirection.Downwards; else prime = PrimeDirection.Same;\n\t\t\tconst originalImprovement = row.specialCauseImprovementValue;\n\t\t\tconst originalConcern = row.specialCauseConcernValue;\n\t\t\t// Decide pruning per SQL logic using metricImprovement direction (outer scope)\n\t\t\tif (prime === PrimeDirection.Upwards) {\n\t\t\t\tif (metricImprovement === ImprovementDirection.Up) {\n\t\t\t\t\trow.specialCauseConcernValue = null;\n\t\t\t\t} else if (metricImprovement === ImprovementDirection.Down) {\n\t\t\t\t\trow.specialCauseImprovementValue = null;\n\t\t\t\t}\n\t\t\t} else if (prime === PrimeDirection.Downwards) {\n\t\t\t\tif (metricImprovement === ImprovementDirection.Up) {\n\t\t\t\t\trow.specialCauseImprovementValue = null;\n\t\t\t\t} else if (metricImprovement === ImprovementDirection.Down) {\n\t\t\t\t\trow.specialCauseConcernValue = null;\n\t\t\t\t}\n\t\t\t} else { // Same\n\t\t\t\t// Use metricConflictRule concept: replicate by favouring the existing variationIcon side if decisive, else prefer Improvement if present\n\t\t\t\t// (We do not have explicit metricConflictRule setting in TS port; infer from current variationIcon bias)\n\t\t\t\tif (row.variationIcon === VariationIcon.Improvement) {\n\t\t\t\t\trow.specialCauseConcernValue = null;\n\t\t\t\t} else if (row.variationIcon === VariationIcon.Concern) {\n\t\t\t\t\trow.specialCauseImprovementValue = null;\n\t\t\t\t} else {\n\t\t\t\t\t// Neutral icon -> default to preserving improvement side for positive framing\n\t\t\t\t\trow.specialCauseConcernValue = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Update variationIcon if both sides were not reduced to Neither earlier\n\t\t\tif (row.specialCauseImprovementValue !== null && row.specialCauseConcernValue === null) {\n\t\t\t\trow.variationIcon = VariationIcon.Improvement;\n\t\t\t} else if (row.specialCauseConcernValue !== null && row.specialCauseImprovementValue === null) {\n\t\t\t\trow.variationIcon = VariationIcon.Concern;\n\t\t\t} else if (row.specialCauseImprovementValue === null && row.specialCauseConcernValue === null) {\n\t\t\t\t// Both suppressed \u2013 fallback to neither to avoid stale icon\n\t\t\t\trow.variationIcon = VariationIcon.Neither;\n\t\t\t}\n\t\t\t// Persist metadata\n\t\t\tconst winningSide: Side | undefined = row.specialCauseImprovementValue !== null ? Side.Up\n\t\t\t\t: row.specialCauseConcernValue !== null ? Side.Down\n\t\t\t\t: undefined;\n\t\t\tconst winningRank = winningSide === Side.Up ? upMax : winningSide === Side.Down ? downMax : Math.max(upMax, downMax);\n\t\t\tconst winner = active.find(a => a.rank === winningRank && (!winningSide || a.side === winningSide));\n\t\t\trow.conflictPrimeDirection = prime;\n\t\t\trow.conflictResolved = true;\n\t\t\trow.conflictResolvedRank = winningRank || undefined;\n\t\t\tif (winner) row.conflictResolvedByRuleId = winner.id;\n\t\t\trow.pruningMode = PruningMode.Conflict;\n\t\t\trow.originalSpecialCauseImprovementValue = originalImprovement;\n\t\t\trow.originalSpecialCauseConcernValue = originalConcern;\n\t\t}\n\n\t\t// Assurance icon via helper (capability vs fallback) \u2013 preserves existing semantics\n\t\t{\n\t\t\tconst inputRow = canonical[row.rowId - 1];\n\t\t\tconst result = computeAssuranceIcon({\n\t\t\t\tmetricImprovement,\n\t\t\t\tcapabilityMode: settings.assuranceCapabilityMode,\n\t\t\t\tvalue: row.value,\n\t\t\t\tmean: row.mean,\n\t\t\t\tupperProcessLimit: row.upperProcessLimit,\n\t\t\t\tlowerProcessLimit: row.lowerProcessLimit,\n\t\t\t\ttarget: isNumber(inputRow?.target) ? inputRow.target! : null,\n\t\t\t});\n\t\t\trow.assuranceIcon = result;\n\t\t}\n\t}\n\n\t// Step 5-like warnings\n\tif ((settings.minimumPointsWarning ?? false) && !globalEnough) {\n\t\tconst available = canonical.filter(\n\t\t\t(r) => !r.ghost && isNumber(r.value)\n\t\t).length;\n\t\twarnings.push({\n\t\t\tcode: SpcWarningCode.InsufficientPointsGlobal,\n\t\t\tcategory: SpcWarningCategory.Data,\n\t\t\tseverity: SpcWarningSeverity.Warning,\n\t\t\tmessage: `Only ${available} non-ghost points available; minimum required is ${settings.minimumPoints}. Limits and icons suppressed.`,\n\t\t\tcontext: { available, minimumRequired: settings.minimumPoints },\n\t\t});\n\t}\n\n\t// Variation icon conflict warnings (simultaneous high/low signals)\n\t// NOTE: does not consider pruning mode; flags any row with both high and low special-cause signals.\n\t// This is a heuristic alert only; no automatic mutation of icons or values.\n\t// Users should inspect such rows to ensure the icon reflects their interpretation of the data.\n\t// This is most relevant when using the DirectionalFirst precedence strategy which can yield mixed signals.\n\t// The SQL port does not currently have an equivalent warning.\n\t// We do not consider suppressedTrendFavourable here as it does not affect icon classification directly.\n\t// We do consider all other specialCause* flags as they directly contribute to icon classification.\n\t// We do not consider emergingFavourable here as it is a transient heuristic that does not reflect actual signals present.\n\t// Users should inspect the actual specialCause* flags to understand the nature of the conflict.\n\t// This warning is primarily intended to catch cases where both high and low shift/trend signals are present simultaneously,\n\tif (settings.variationIconConflictWarning) {\n\t\tfor (const row of output) {\n\t\t\t\tif (row.variationIcon === VariationIcon.Improvement) {\n\t\t\t\t\tconst highAndLow =\n\t\t\t\t\t\t(row.specialCauseSinglePointUp ||\n\t\t\t\t\t\t\trow.specialCauseTwoOfThreeUp ||\n\t\t\t\t\t\t\t(settings.enableFourOfFiveRule &&\n\t\t\t\t\t\t\t\trow.specialCauseFourOfFiveUp) ||\n\t\t\t\t\t\t\trow.specialCauseShiftUp ||\n\t\t\t\t\t\t\trow.specialCauseTrendUp) &&\n\t\t\t\t\t\t(row.specialCauseSinglePointDown ||\n\t\t\t\t\t\t\trow.specialCauseTwoOfThreeDown ||\n\t\t\t\t\t\t\t(settings.enableFourOfFiveRule &&\n\t\t\t\t\t\t\t\trow.specialCauseFourOfFiveDown) ||\n\t\t\t\t\t\t\trow.specialCauseShiftDown ||\n\t\t\t\t\t\t\trow.specialCauseTrendDown);\n\t\t\t\t\tif (highAndLow) {\n\t\t\t\t\t\twarnings.push({\n\t\t\t\t\t\t\tcode: SpcWarningCode.VariationConflictRow,\n\t\t\t\t\t\t\tcategory: SpcWarningCategory.Logic,\n\t\t\t\t\t\t\tseverity: SpcWarningSeverity.Warning,\n\t\t\t\t\t\t\tmessage: `Row ${row.rowId}: simultaneous high/low special-cause signals \u2013 variation icon may be ambiguous.`,\n\t\t\t\t\t\t\tcontext: { rowId: row.rowId },\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Optional global cap on number of non-ghost points considered\n\tif (settings.maximumPoints && Number.isFinite(settings.maximumPoints)) {\n\t\tconst cap = settings.maximumPoints as number;\n\t\tlet seen = 0;\n\t\tfor (const row of output) {\n\t\t\tif (!row.ghost && isNumber(row.value)) seen++;\n\t\t\tif (seen > cap) {\n\t\t\t\trow.mean = row.upperProcessLimit = row.lowerProcessLimit = null;\n\t\t\t\trow.upperTwoSigma =\n\t\t\t\t\trow.lowerTwoSigma =\n\t\t\t\t\trow.upperOneSigma =\n\t\t\t\t\trow.lowerOneSigma =\n\t\t\t\t\t\tnull;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Extended warning suite\n\tif (settings.nullValueWarning && (chartType === ChartType.XmR || chartType === ChartType.G)) {\n\t\tconst nullCount = canonical.filter(\n\t\t\t(r) =>\n\t\t\t\t!r.ghost &&\n\t\t\t\t(r.value === null || r.value === undefined || !isNumber(r.value))\n\t\t).length;\n\t\tif (nullCount)\n\t\t\twarnings.push({\n\t\t\t\tcode: SpcWarningCode.NullValuesExcluded,\n\t\t\t\tcategory: SpcWarningCategory.Data,\n\t\t\t\tseverity: SpcWarningSeverity.Info,\n\t\t\t\tmessage: `${nullCount} null/missing value(s) excluded from calculations.`,\n\t\t\t\tcontext: { nullCount },\n\t\t\t});\n\t}\n\tif (\n\t\tsettings.targetSuppressedWarning &&\n\t\t(chartType === ChartType.T || chartType === ChartType.G)\n\t) {\n\t\tconst hasTarget = canonical.some((r) => isNumber(r.target));\n\t\tif (hasTarget)\n\t\t\twarnings.push({\n\t\t\t\tcode: SpcWarningCode.TargetIgnoredRareEvent,\n\t\t\t\tcategory: SpcWarningCategory.Target,\n\t\t\t\tseverity: SpcWarningSeverity.Info,\n\t\t\t\tmessage: `Targets provided are ignored for ${chartType} charts in this port.`,\n\t\t\t\tcontext: { chartType },\n\t\t\t});\n\t}\n\tif (\n\t\tsettings.ghostOnRareEventWarning &&\n\t\t(chartType === ChartType.T || chartType === ChartType.G)\n\t) {\n\t\tconst ghostCount = canonical.filter((r) => r.ghost).length;\n\t\tif (ghostCount)\n\t\t\twarnings.push({\n\t\t\t\tcode: SpcWarningCode.GhostRowsRareEvent,\n\t\t\t\tcategory: SpcWarningCategory.Ghost,\n\t\t\t\tseverity: SpcWarningSeverity.Info,\n\t\t\t\tmessage: `${ghostCount} ghost row(s) supplied for rare-event chart (${chartType}); verify intent.`,\n\t\t\t\tcontext: { chartType, ghostCount },\n\t\t\t});\n\t}\n\tif (settings.partitionSizeWarnings) {\n\t\tObject.entries(partitionNonGhostCounts).forEach(([pid, count]) => {\n\t\t\tif (count < settings.minimumPointsPartition)\n\t\t\t\twarnings.push({\n\t\t\t\t\tcode: SpcWarningCode.InsufficientPointsPartition,\n\t\t\t\t\tcategory: SpcWarningCategory.Partition,\n\t\t\t\t\tseverity: SpcWarningSeverity.Warning,\n\t\t\t\t\tmessage: `Partition ${pid} has only ${count} non-ghost point(s); below recommended ${settings.minimumPointsPartition}.`,\n\t\t\t\t\tcontext: {\n\t\t\t\t\t\tpartitionId: Number(pid),\n\t\t\t\t\t\tcount,\n\t\t\t\t\t\tminimum: settings.minimumPointsPartition,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t});\n\t}\n\tif (settings.baselineSpecialCauseWarning) {\n\t\tconst issueRows: number[] = [];\n\t\toutput.forEach((r) => {\n\t\t\tconst input = canonical[r.rowId - 1];\n\t\t\tif (input.baseline) {\n\t\t\t\tconst anySignal =\n\t\t\t\t\tr.specialCauseSinglePointUp ||\n\t\t\t\t\tr.specialCauseSinglePointDown ||\n\t\t\t\t\tr.specialCauseTwoOfThreeUp ||\n\t\t\t\t\tr.specialCauseTwoOfThreeDown ||\n\t\t\t\t\tr.specialCauseFourOfFiveUp ||\n\t\t\t\t\tr.specialCauseFourOfFiveDown ||\n\t\t\t\t\tr.specialCauseShiftUp ||\n\t\t\t\t\tr.specialCauseShiftDown ||\n\t\t\t\t\tr.specialCauseTrendUp ||\n\t\t\t\t\tr.specialCauseTrendDown;\n\t\t\t\tif (anySignal) issueRows.push(r.rowId);\n\t\t\t}\n\t\t});\n\t\tif (issueRows.length)\n\t\t\twarnings.push({\n\t\t\t\tcode: SpcWarningCode.BaselineWithSpecialCause,\n\t\t\t\tcategory: SpcWarningCategory.Baseline,\n\t\t\t\tseverity: SpcWarningSeverity.Warning,\n\t\t\t\tmessage: `Baseline set with special-cause present at row(s): ${issueRows.join(\", \")}.`,\n\t\t\t\tcontext: { rows: issueRows },\n\t\t\t});\n\t}\n\tif (settings.maximumPointsWarnings) {\n\t\tif (\n\t\t\tsettings.maximumPointsPartition &&\n\t\t\tNumber.isFinite(settings.maximumPointsPartition)\n\t\t)\n\t\t\twarnings.push({\n\t\t\t\tcode: SpcWarningCode.PartitionCapApplied,\n\t\t\t\tcategory: SpcWarningCategory.Limits,\n\t\t\t\tseverity: SpcWarningSeverity.Info,\n\t\t\t\tmessage: `Limits suppressed after ${settings.maximumPointsPartition} non-ghost points per partition.`,\n\t\t\t\tcontext: { cap: settings.maximumPointsPartition },\n\t\t\t});\n\t\tif (settings.maximumPoints && Number.isFinite(settings.maximumPoints))\n\t\t\twarnings.push({\n\t\t\t\tcode: SpcWarningCode.GlobalCapApplied,\n\t\t\t\tcategory: SpcWarningCategory.Limits,\n\t\t\t\tseverity: SpcWarningSeverity.Info,\n\t\t\t\tmessage: `Limits suppressed after global cap of ${settings.maximumPoints} non-ghost points.`,\n\t\t\t\tcontext: { cap: settings.maximumPoints },\n\t\t\t});\n\t}\n\n\tlet suggestedBaselines: SpcResult['suggestedBaselines'];\n\tif (settings.baselineSuggest) {\n\t\tconst W = settings.baselineSuggestStabilityPoints;\n\t\tconst minGap = settings.baselineSuggestMinGap;\n\t\tconst minDeltaSigma = settings.baselineSuggestMinDeltaSigma;\n\t\tconst scoreThreshold = settings.baselineSuggestScoreThreshold;\n\t\tconst shiftRunLength = settings.specialCauseShiftPoints ?? 6;\n\t\tconst trendRunLength = settings.specialCauseTrendPoints ?? 6;\n\t\tconst raw = computeBaselineSuggestionsRaw(\n\t\t\toutput.map(r => ({\n\t\t\t\tvalue: r.value,\n\t\t\t\tpartitionId: r.partitionId,\n\t\t\t\tvariationIcon: r.variationIcon,\n\t\t\t\tmean: r.mean,\n\t\t\t\tupperProcessLimit: r.upperProcessLimit,\n\t\t\t})),\n\t\t\t{\n\t\t\t\tW, minGap, minDeltaSigma, scoreThreshold,\n\t\t\t\tshiftRunLength, trendRunLength,\n\t\t\t\tisShiftUpAt: (i) => !!output[i].specialCauseShiftUp,\n\t\t\t\tisShiftDownAt: (i) => !!output[i].specialCauseShiftDown,\n\t\t\t\tisTrendUpAt: (i) => !!output[i].specialCauseTrendUp,\n\t\t\t\tisTrendDownAt: (i) => !!output[i].specialCauseTrendDown,\n\t\t\t\tisSingleUpAt: (i) => !!output[i].specialCauseSinglePointUp,\n\t\t\t\tisSingleDownAt: (i) => !!output[i].specialCauseSinglePointDown,\n\t\t\t}\n\t\t);\n\t\tsuggestedBaselines = raw.map(s => ({\n\t\t\tindex: s.index,\n\t\t\treason: s.reason,\n\t\t\tscore: s.score,\n\t\t\tdeltaMean: s.deltaMean,\n\t\t\toldMean: s.oldMean,\n\t\t\tnewMean: s.newMean,\n\t\t\twindow: s.window,\n\t\t}));\n\t}\n\treturn { rows: output, warnings, ...(suggestedBaselines ? { suggestedBaselines } : {}) };\n}\n\nexport default { buildSpc };\n", "// SQL-compatibility SPC engine wrapper providing explicit per-side rule ranking and directional pruning\n// without relying on mutually exclusive side aggregation. This aims to mirror the v2.6a SQL post-processing\n// steps (PrimeDirection + pruning) while leveraging the existing orthodox rule detection from buildSpc.\n\nimport { buildSpc, SpcSettings, SpcRow, getDirectionalSignalSummary } from './spc';\nimport {\n\tChartType,\n\tImprovementDirection,\n\tVariationIcon,\n\tSpcRuleId,\n\tSide,\n\tRULE_RANK_BY_ID,\n\tPrimeDirection,\n\tPruningMode,\n} from './spcConstants';\n\nexport interface BuildSpcSqlCompatArgs {\n\tchartType: ChartType;\n\tmetricImprovement: ImprovementDirection;\n\tdata: {\n\t\tx: string | number | Date;\n\t\tvalue?: number | null;\n\t\tghost?: boolean;\n\t\tbaseline?: boolean;\n\t\ttarget?: number;\n\t}[];\n\tsettings?: SpcSettings; // honour existing settings (e.g. shift lengths)\n}\n\nexport interface SpcSqlCompatRow extends SpcRow {\n\tprimeDirection?: PrimeDirection;\n\t// Rank chosen (1 single,2 two-sigma,3 shift,4 trend) for the winning side prior to pruning\n\tprimeRank?: number;\n\t// Winning rule id for transparency\n\tprimeRuleId?: SpcRuleId;\n\t/** Indicates pruning strategy used on this row */\n\tpruningMode?: PruningMode;\n\t// Original (pre-pruning) improvement / concern prior to directional pruning\n\tsqlOriginalImprovementValue?: number | null;\n\tsqlOriginalConcernValue?: number | null;\n\t// Indicates pruning was applied (both sides originally populated and one removed)\n\tsqlPruned?: boolean;\n}\n\nexport interface SpcSqlCompatResult {\n\trows: SpcSqlCompatRow[];\n\twarnings: ReturnType<typeof buildSpc>[\"warnings\"];\n}\n\n// Internal: determine per-side rank catalogue mirroring SQL ordering\n// PrimeDirection now exported from core spc.ts\n\n// collectSideRanks replaced by shared getDirectionalSignalSummary helper.\n\n// Exported for unit tests to simulate synthetic clashes\nexport function sqlDirectionalPrune(\n\trow: SpcSqlCompatRow,\n\tmetricImprovement: ImprovementDirection\n) {\n\tconst summary = getDirectionalSignalSummary(row);\n\tconst upMax = summary.upMax;\n\tconst downMax = summary.downMax;\n\t// reconstruct high/low sets for winner selection using RULE_RANK_BY_ID ordering\n\tconst high = summary.upRules.map(id => ({ id, rank: RULE_RANK_BY_ID[id] }));\n\tconst low = summary.downRules.map(id => ({ id, rank: RULE_RANK_BY_ID[id] }));\n\tlet prime: PrimeDirection;\n\tif (upMax > downMax) prime = PrimeDirection.Upwards;\n\telse if (downMax > upMax) prime = PrimeDirection.Downwards;\n\telse prime = PrimeDirection.Same;\n\n\t// Establish original candidates (independent of prior variationIcon decision). We treat any high-side signal\n\t// as a potential Improvement when metricImprovement = Up, and any low-side signal as Improvement when = Down.\n\tconst anyHigh = upMax > 0;\n\tconst anyLow = downMax > 0;\n\tconst originalImprovement =\n\t\t(metricImprovement === ImprovementDirection.Up && anyHigh) ||\n\t\t(metricImprovement === ImprovementDirection.Down && anyLow)\n\t\t\t? row.value\n\t\t\t: null;\n\tconst originalConcern =\n\t\t(metricImprovement === ImprovementDirection.Up && anyLow) ||\n\t\t(metricImprovement === ImprovementDirection.Down && anyHigh)\n\t\t\t? row.value\n\t\t\t: null;\n\n\trow.sqlOriginalImprovementValue = originalImprovement;\n\trow.sqlOriginalConcernValue = originalConcern;\n\n\t// Apply SQL-like pruning only if both existed\n\tif (originalImprovement !== null && originalConcern !== null) {\n\t\trow.sqlPruned = true;\n\t\tif (prime === PrimeDirection.Upwards) {\n\t\t\tif (metricImprovement === ImprovementDirection.Up) {\n\t\t\t\t// keep improvement, drop concern\n\t\t\t} else if (metricImprovement === ImprovementDirection.Down) {\n\t\t\t\trow.sqlOriginalImprovementValue = null; // drop improvement (opposite side stronger)\n\t\t\t}\n\t\t} else if (prime === PrimeDirection.Downwards) {\n\t\t\tif (metricImprovement === ImprovementDirection.Up) {\n\t\t\t\trow.sqlOriginalImprovementValue = null; // drop improvement (opposite side stronger)\n\t\t\t} else if (metricImprovement === ImprovementDirection.Down) {\n\t\t\t\t// keep improvement (downwards favourable)\n\t\t\t}\n\t\t} else { // PrimeDirection.Same\n\t\t\t// Same rank strength both sides\n\t\t\t// Bias to improvement framing (prune concern) unless metricImprovement makes that impossible\n\t\t\tif (originalImprovement !== null) {\n\t\t\t\trow.sqlOriginalConcernValue = null;\n\t\t\t} else if (originalConcern !== null) {\n\t\t\t\t// No improvement candidate, keep concern only\n\t\t\t\trow.sqlOriginalImprovementValue = null;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Derive variationIcon from pruned values (post pruning semantics):\n\tif (row.sqlOriginalImprovementValue && !row.sqlOriginalConcernValue) {\n\t\trow.variationIcon = VariationIcon.Improvement;\n\t} else if (!row.sqlOriginalImprovementValue && row.sqlOriginalConcernValue) {\n\t\trow.variationIcon = VariationIcon.Concern;\n\t} else if (!row.sqlOriginalImprovementValue && !row.sqlOriginalConcernValue) {\n\t\trow.variationIcon = VariationIcon.Neither;\n\t} else {\n\t\t// Both present (no pruning) only when rank logic leaves them; treat as improvement favourably\n\t\trow.variationIcon = VariationIcon.Improvement;\n\t}\n\n\trow.primeDirection = prime; // attach convenience alias names\n\trow.primeRank = Math.max(upMax, downMax) || undefined;\n\trow.pruningMode = PruningMode.Sql;\n\t// Determine winning side using unified Side enum (Up corresponds to former 'high', Down to 'low').\n\tconst winningSide: Side =\n\t\trow.variationIcon === VariationIcon.Concern\n\t\t\t? metricImprovement === ImprovementDirection.Up\n\t\t\t\t? Side.Down\n\t\t\t\t: Side.Up\n\t\t\t: metricImprovement === ImprovementDirection.Up\n\t\t\t\t? Side.Up\n\t\t\t\t: Side.Down;\n\tconst winnerSet = winningSide === Side.Up ? high : low;\n\tconst top = winnerSet.reduce(\n\t\t(best, a) => (!best || a.rank > best.rank ? a : best),\n\t\tundefined as { id: SpcRuleId; rank: number } | undefined\n\t);\n\tif (top) row.primeRuleId = top.id;\n}\n\nexport function buildSpcSqlCompat(\n\targs: BuildSpcSqlCompatArgs\n): SpcSqlCompatResult {\n\tconst {\n\t\tchartType,\n\t\tmetricImprovement,\n\t\tdata,\n\t\tsettings = {},\n\t} = args;\n\tconst base = buildSpc({\n\t\tchartType,\n\t\tmetricImprovement,\n\t\tdata,\n\t\tsettings: {\n\t\t\t...settings,\n\t\t},\n\t});\n\tconst rows: SpcSqlCompatRow[] = base.rows.map((r) => ({ ...r }));\n\tfor (const r of rows) {\n\t\tsqlDirectionalPrune(r, metricImprovement);\n\t}\n\treturn { rows, warnings: base.warnings };\n}\n", "import type { SPCSignalFocusInfo } from \"./SPCChart.types\";\nimport * as React from \"react\";\nimport { useTooltipContext } from \"../../../core/TooltipContext\";\nimport { VariationIcon, SpcRawRuleTag } from \"./logic/spcConstants\";\nimport {\n\textractRuleIds,\n\truleGlossary,\n\tvariationLabel,\n\tassuranceLabel,\n} from \"./logic/spcDescriptors\";\nimport { Tag } from \"../../../../Tag\";\n\nexport interface SPCSignalsInspectorProps {\n\t/** Engine rows from buildSpc; used to read variation/assurance and rule flags */\n\tengineRows: any[] | null;\n\t/** Optional measure name/unit for labels */\n\tmeasureName?: string;\n\tmeasureUnit?: string;\n\t/** Optional callback fired whenever the focused point changes (via keyboard or nav buttons). */\n\tonSignalFocus?: (info: SPCSignalFocusInfo) => void;\n}\n\n/**\n * Minimal, additive Signals Inspector.\n * - Listens to TooltipContext focus and renders details for the focused point.\n * - Shows value, variation classification, assurance, and triggered rules (with narration).\n * - Keyboard arrows via InteractionLayer already drive focus; this panel mirrors that state.\n */\nconst SPCSignalsInspector: React.FC<SPCSignalsInspectorProps> = ({\n\tengineRows,\n\tmeasureName,\n\tmeasureUnit,\n\tonSignalFocus,\n}) => {\n\tconst t = useTooltipContext();\n\tconst focused = t?.focused ?? null;\n\tconst index = focused?.index ?? null;\n\tconst row =\n\t\ttypeof index === \"number\" && engineRows ? engineRows[index] : null;\n\n\tconst rules = React.useMemo(() => (row ? extractRuleIds(row) : []), [row]);\n\tconst uniqueRuleNarr = React.useMemo(\n\t\t() =>\n\t\t\tArray.from(\n\t\t\t\tnew Set(rules.map((r) => ruleGlossary[r]?.narration).filter(Boolean))\n\t\t\t),\n\t\t[rules]\n\t);\n\n\t// Derived descriptors (reuse tooltip overlay phrasing & colour classes)\n\tconst variationDesc: string | null = row\n\t\t? variationLabel(row.variationIcon)\n\t\t: null;\n\tconst assuranceDesc: string | null = row\n\t\t? assuranceLabel(row.assuranceIcon)\n\t\t: null;\n\tconst hasRules = rules.length > 0;\n\tconst isNoJudgement = row\n\t\t? row.variationIcon === VariationIcon.Neither && hasRules\n\t\t: false;\n\n\t// Fire onSignalFocus when the focused point changes (debounced to index change)\n\tconst lastKeyRef = React.useRef<string | null>(null);\n\tReact.useEffect(() => {\n\t\tif (!onSignalFocus) return;\n\t\tif (!focused || row == null) return;\n\t\tconst key = `${focused.seriesId}:${focused.index}`;\n\t\tif (lastKeyRef.current === key) return;\n\t\tlastKeyRef.current = key;\n\t\ttry {\n\t\t\tonSignalFocus({\n\t\t\t\tindex: focused.index,\n\t\t\t\tx: focused.x,\n\t\t\t\ty: focused.y,\n\t\t\t\trow,\n\t\t\t\trules,\n\t\t\t});\n\t\t} catch {\n\t\t\t// no-op: avoid throwing from effects\n\t\t}\n\t}, [focused?.seriesId, focused?.index, focused?.x, focused?.y, row, rules, onSignalFocus]);\n\n\treturn (\n\t\t<div\n\t\t\tclassName=\"fdp-spc-inspector\"\n\t\t\trole=\"region\"\n\t\t\taria-label=\"Signals inspector\"\n\t\t\tdata-testid=\"spc-signals-inspector\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName=\"fdp-spc-inspector__header\"\n\t\t\t\tstyle={{\n\t\t\t\t\tdisplay: \"flex\",\n\t\t\t\t\talignItems: \"center\",\n\t\t\t\t\tjustifyContent: \"space-between\",\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<strong>Signals inspector</strong>\n\t\t\t\t<div className=\"fdp-spc-inspector__nav\" aria-hidden={!t}>\n\t\t\t\t\t{/* Optional quick nav when tooltip context present */}\n\t\t\t\t\t{t && (\n\t\t\t\t\t\t<div style={{ display: \"flex\", gap: 8 }}>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclassName=\"fdp-button fdp-button--secondary\"\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tif (!t.focused) t.focusFirstPoint();\n\t\t\t\t\t\t\t\t\telse t.focusPrevPoint();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\taria-label=\"Previous point\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\u25C0\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclassName=\"fdp-button fdp-button--secondary\"\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tif (!t.focused) t.focusFirstPoint();\n\t\t\t\t\t\t\t\t\telse t.focusNextPoint();\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\taria-label=\"Next point\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\u25B6\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{!row || !focused ? (\n\t\t\t\t<p className=\"fdp-spc-inspector__empty\">No point selected.</p>\n\t\t\t) : (\n\t\t\t\t<div className=\"fdp-spc-inspector__body\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"fdp-spc-inspector__summary\"\n\t\t\t\t\t\tstyle={{ display: \"flex\", gap: 16, flexWrap: \"wrap\" }}\n\t\t\t\t\t>\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t<strong>Point:</strong> {focused.index + 1}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t<strong>Value:</strong> {focused.y}\n\t\t\t\t\t\t\t{measureUnit ? ` ${measureUnit}` : \"\"}\n\t\t\t\t\t\t\t{measureName ? ` ${measureName}` : \"\"}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Signals badges mirroring tooltip overlay styling */}\n\t\t\t\t\t{(variationDesc || isNoJudgement || assuranceDesc) && (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"fdp-spc-inspector__signals\"\n\t\t\t\t\t\t\tstyle={{ marginTop: 8 }}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tdisplay: \"flex\",\n\t\t\t\t\t\t\t\t\tgap: 8,\n\t\t\t\t\t\t\t\t\tflexWrap: \"wrap\",\n\t\t\t\t\t\t\t\t\talignItems: \"center\",\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{(() => {\n\t\t\t\t\t\t\t\t\tif (variationDesc?.toLowerCase().includes(\"concern\")) {\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\ttext={variationDesc}\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc-tooltip__tag fdp-spc-tag fdp-spc-tag--concern\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (variationDesc?.toLowerCase().includes(\"improvement\")) {\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\ttext={variationDesc}\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc-tooltip__tag fdp-spc-tag fdp-spc-tag--improvement\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (isNoJudgement) {\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\ttext=\"No judgement\"\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc-tooltip__tag fdp-spc-tag fdp-spc-tag--no-judgement\"\n\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"Neutral special cause (no directional judgement)\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (variationDesc) {\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\ttext={variationDesc}\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"fdp-spc-tooltip__tag fdp-spc-tag fdp-spc-tag--common\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t})()}\n\t\t\t\t\t\t\t\t{assuranceDesc &&\n\t\t\t\t\t\t\t\t\t(() => {\n\t\t\t\t\t\t\t\t\t\tconst lower = assuranceDesc.toLowerCase();\n\t\t\t\t\t\t\t\t\t\tconst isFail =\n\t\t\t\t\t\t\t\t\t\t\tlower.includes(\"not met\") ||\n\t\t\t\t\t\t\t\t\t\t\tlower.includes(\"not achieved\");\n\t\t\t\t\t\t\t\t\t\tconst isPass =\n\t\t\t\t\t\t\t\t\t\t\t!isFail && /^|\\b(met|achieved)\\b|$/.test(lower);\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\t\ttext={assuranceDesc}\n\t\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={`fdp-spc-tooltip__tag fdp-spc-tag fdp-spc-tag--assurance ${isPass ? \"fdp-spc-tag--improvement\" : \"fdp-spc-tag--concern\"}`}\n\t\t\t\t\t\t\t\t\t\t\t\taria-label={`Assurance: ${assuranceDesc}`}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t})()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{/* Special cause rule tags with same colour logic as tooltip (trend stays purple) */}\n\t\t\t\t\t<div className=\"fdp-spc-inspector__rules\" style={{ marginTop: 8 }}>\n\t\t\t\t\t\t<strong>Special cause:</strong>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"fdp-spc-tooltip__rule-tags\"\n\t\t\t\t\t\t\taria-label=\"Special cause rules\"\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tdisplay: \"flex\",\n\t\t\t\t\t\t\t\tgap: 6,\n\t\t\t\t\t\t\t\tflexWrap: \"wrap\",\n\t\t\t\t\t\t\t\tmarginTop: 4,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{rules.length === 0 ? (\n\t\t\t\t\t\t\t\t<span> None</span>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\trules.map((r) => {\n\t\t\t\t\t\t\t\t\tconst idStr = String(r);\n\t\t\t\t\t\t\t\t\tconst isTrend =\n\t\t\t\t\t\t\t\t\t\tidStr === SpcRawRuleTag.TrendIncreasing ||\n\t\t\t\t\t\t\t\t\t\tidStr === SpcRawRuleTag.TrendDecreasing;\n\t\t\t\t\t\t\t\t\tconst ruleColorClass = isTrend\n\t\t\t\t\t\t\t\t\t\t? \"fdp-spc-tag--trend\"\n\t\t\t\t\t\t\t\t\t\t: isNoJudgement\n\t\t\t\t\t\t\t\t\t\t\t? \"fdp-spc-tag--no-judgement\"\n\t\t\t\t\t\t\t\t\t\t\t: variationDesc\n\t\t\t\t\t\t\t\t\t\t\t\t? variationDesc.toLowerCase().includes(\"concern\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t? \"fdp-spc-tag--concern\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t: variationDesc.toLowerCase().includes(\"improvement\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"fdp-spc-tag--improvement\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"fdp-spc-tag--common\"\n\t\t\t\t\t\t\t\t\t\t\t\t: \"fdp-spc-tag--common\";\n\t\t\t\t\t\t\t\t\tconst label = ruleGlossary[r]?.tooltip || idStr;\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<Tag\n\t\t\t\t\t\t\t\t\t\t\tkey={idStr}\n\t\t\t\t\t\t\t\t\t\t\ttext={label}\n\t\t\t\t\t\t\t\t\t\t\tcolor=\"default\"\n\t\t\t\t\t\t\t\t\t\t\tclassName={`fdp-spc-tooltip__tag fdp-spc-tag ${ruleColorClass}`}\n\t\t\t\t\t\t\t\t\t\t\tdata-rule-id={idStr}\n\t\t\t\t\t\t\t\t\t\t\ttitle={ruleGlossary[r]?.tooltip}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{uniqueRuleNarr.length > 0 && (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"fdp-spc-inspector__narration\"\n\t\t\t\t\t\t\tstyle={{ marginTop: 8 }}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<strong>Summary:</strong> {uniqueRuleNarr.join(\"; \")}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t);\n};\n\nexport default SPCSignalsInspector;\n", "// Barrel exports for SPC (Statistical Process Control) related components & types\n// Provides a stable import surface: `import { SPCChart, SPCVariationIcon, SPCAssuranceIcon, buildSpc } from '.../DataVisualisation/charts/SPC';`\n\nexport { default as SPCChart } from './SPCChart/SPCChart';\nexport type { SPCChartProps, SPCDatum } from './SPCChart/SPCChart';\n\n// Engine logic & enums\nexport { buildSpc, normaliseSpcSettings } from './SPCChart/logic/spc';\nexport { ImprovementDirection, VariationIcon, AssuranceIcon, ChartType, BaselineSuggestionReason, RULE_METADATA } from './SPCChart/logic/spcConstants';\nexport { SpcWarningSeverity, SpcWarningCategory, SpcWarningCode } from './SPCChart/logic/spc';\nexport type { SpcSettings, SpcSettingsV2, SpcResult, SpcWarning } from './SPCChart/logic/spc';\n\n// Descriptors & helpers (colour tokens, labels)\nexport { variationLabel, extractRuleIds, ruleGlossary, VARIATION_COLOR_TOKENS, getVariationColorHex, getVariationColorToken } from './SPCChart/logic/spcDescriptors';\n\n// Icon system\nexport { SPCVariationIcon } from './SPCIcons/SPCIcon';\nexport { SPCAssuranceIcon } from './SPCIcons/SPCAssuranceIcon';\nexport { AssuranceResult, Direction, MetricPolarity, VariationJudgement, VariationState, getVariationColour, getVariationTrend } from './SPCIcons/SPCConstants';\nexport type { VariationColourDef } from './SPCIcons/SPCConstants';\nexport type { SPCVariationIconProps, SpcVariationAltIconProps, SpcAssuranceIconProps, SpcIconsProps, SpcIconBaseProps } from './SPCIcons/SPCIcon';\n\n// Tooltip overlay (specialised)\nexport { default as SPCTooltipOverlay } from './SPCChart/SPCTooltipOverlay';\nexport { SpcEmbeddedIconVariant } from './SPCChart/SPCChart.constants';\n\n// Icons-only barrel re-export (optional convenience)\nexport * as Icons from './icons';\n", "// SPC Icons-only barrel\n// Import just icons, their props, enums and helpers without pulling chart/engine code.\n\nexport { SPCVariationIcon } from './SPCIcons/SPCIcon';\nexport { SPCAssuranceIcon } from './SPCIcons/SPCAssuranceIcon';\n\nexport type {\n  SPCVariationIconProps,\n  SpcVariationAltIconProps,\n  SpcAssuranceIconProps,\n  SpcIconsProps,\n  SpcIconBaseProps,\n} from './SPCIcons/SPCIcon';\n\nexport {\n  AssuranceResult,\n  Direction,\n  MetricPolarity,\n  VariationJudgement,\n  VariationState,\n  getVariationColour,\n  getVariationTrend,\n} from './SPCIcons/SPCConstants';\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAOA,KAAC,WAAY;AACZ;AAEA,UAAI,SAAS,CAAC,EAAE;AAEhB,eAASA,cAAc;AACtB,YAAI,UAAU;AAEd,iBAAS,IAAI,GAAG,IAAI,UAAU,QAAQ,KAAK;AAC1C,cAAI,MAAM,UAAU,CAAC;AACrB,cAAI,KAAK;AACR,sBAAU,YAAY,SAAS,WAAW,GAAG,CAAC;AAAA,UAC/C;AAAA,QACD;AAEA,eAAO;AAAA,MACR;AAEA,eAAS,WAAY,KAAK;AACzB,YAAI,OAAO,QAAQ,YAAY,OAAO,QAAQ,UAAU;AACvD,iBAAO;AAAA,QACR;AAEA,YAAI,OAAO,QAAQ,UAAU;AAC5B,iBAAO;AAAA,QACR;AAEA,YAAI,MAAM,QAAQ,GAAG,GAAG;AACvB,iBAAOA,YAAW,MAAM,MAAM,GAAG;AAAA,QAClC;AAEA,YAAI,IAAI,aAAa,OAAO,UAAU,YAAY,CAAC,IAAI,SAAS,SAAS,EAAE,SAAS,eAAe,GAAG;AACrG,iBAAO,IAAI,SAAS;AAAA,QACrB;AAEA,YAAI,UAAU;AAEd,iBAAS,OAAO,KAAK;AACpB,cAAI,OAAO,KAAK,KAAK,GAAG,KAAK,IAAI,GAAG,GAAG;AACtC,sBAAU,YAAY,SAAS,GAAG;AAAA,UACnC;AAAA,QACD;AAEA,eAAO;AAAA,MACR;AAEA,eAAS,YAAa,OAAO,UAAU;AACtC,YAAI,CAAC,UAAU;AACd,iBAAO;AAAA,QACR;AAEA,YAAI,OAAO;AACV,iBAAO,QAAQ,MAAM;AAAA,QACtB;AAEA,eAAO,QAAQ;AAAA,MAChB;AAEA,UAAI,OAAO,WAAW,eAAe,OAAO,SAAS;AACpD,QAAAA,YAAW,UAAUA;AACrB,eAAO,UAAUA;AAAA,MAClB,WAAW,OAAO,WAAW,cAAc,OAAO,OAAO,QAAQ,YAAY,OAAO,KAAK;AAExF,eAAO,cAAc,CAAC,GAAG,WAAY;AACpC,iBAAOA;AAAA,QACR,CAAC;AAAA,MACF,OAAO;AACN,eAAO,aAAaA;AAAA,MACrB;AAAA,IACD,GAAE;AAAA;AAAA;;;AC5EF;AAAA;AAOA,QAAI,QAAS,OAAO,WAAW,cAC5B,SAEA,OAAO,sBAAsB,eAAe,gBAAgB,oBAC1D,OACA,CAAC;AAWN,QAAIC,SAAS,SAAUC,QAAO;AAG7B,UAAI,OAAO;AACX,UAAI,WAAW;AAGf,UAAI,mBAAmB,CAAC;AAGxB,UAAI,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAsBP,QAAQA,OAAM,SAASA,OAAM,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAsBnC,6BAA6BA,OAAM,SAASA,OAAM,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAWxD,MAAM;AAAA,UACL,QAAQ,SAAS,OAAO,QAAQ;AAC/B,gBAAI,kBAAkB,OAAO;AAC5B,qBAAO,IAAI,MAAM,OAAO,MAAM,OAAO,OAAO,OAAO,GAAG,OAAO,KAAK;AAAA,YACnE,WAAW,MAAM,QAAQ,MAAM,GAAG;AACjC,qBAAO,OAAO,IAAI,MAAM;AAAA,YACzB,OAAO;AACN,qBAAO,OAAO,QAAQ,MAAM,OAAO,EAAE,QAAQ,MAAM,MAAM,EAAE,QAAQ,WAAW,GAAG;AAAA,YAClF;AAAA,UACD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAkBA,MAAM,SAAU,GAAG;AAClB,mBAAO,OAAO,UAAU,SAAS,KAAK,CAAC,EAAE,MAAM,GAAG,EAAE;AAAA,UACrD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAQA,OAAO,SAAU,KAAK;AACrB,gBAAI,CAAC,IAAI,MAAM,GAAG;AACjB,qBAAO,eAAe,KAAK,QAAQ,EAAE,OAAO,EAAE,SAAS,CAAC;AAAA,YACzD;AACA,mBAAO,IAAI,MAAM;AAAA,UAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAYA,OAAO,SAAS,UAAU,GAAG,SAAS;AACrC,sBAAU,WAAW,CAAC;AAEtB,gBAAI;AAAO,gBAAI;AACf,oBAAQ,EAAE,KAAK,KAAK,CAAC,GAAG;AAAA,cACvB,KAAK;AACJ,qBAAK,EAAE,KAAK,MAAM,CAAC;AACnB,oBAAI,QAAQ,EAAE,GAAG;AAChB,yBAAO,QAAQ,EAAE;AAAA,gBAClB;AACA;AAAA,gBAA4C,CAAC;AAC7C,wBAAQ,EAAE,IAAI;AAEd,yBAAS,OAAO,GAAG;AAClB,sBAAI,EAAE,eAAe,GAAG,GAAG;AAC1B,0BAAM,GAAG,IAAI,UAAU,EAAE,GAAG,GAAG,OAAO;AAAA,kBACvC;AAAA,gBACD;AAEA;AAAA;AAAA,kBAA2B;AAAA;AAAA,cAE5B,KAAK;AACJ,qBAAK,EAAE,KAAK,MAAM,CAAC;AACnB,oBAAI,QAAQ,EAAE,GAAG;AAChB,yBAAO,QAAQ,EAAE;AAAA,gBAClB;AACA,wBAAQ,CAAC;AACT,wBAAQ,EAAE,IAAI;AAEd;AAAA;AAAA,gBAAyC,EAAK,QAAQ,SAAU,GAAG,GAAG;AACrE,wBAAM,CAAC,IAAI,UAAU,GAAG,OAAO;AAAA,gBAChC,CAAC;AAED;AAAA;AAAA,kBAA2B;AAAA;AAAA,cAE5B;AACC,uBAAO;AAAA,YACT;AAAA,UACD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAUA,aAAa,SAAU,SAAS;AAC/B,mBAAO,SAAS;AACf,kBAAI,IAAI,KAAK,KAAK,QAAQ,SAAS;AACnC,kBAAI,GAAG;AACN,uBAAO,EAAE,CAAC,EAAE,YAAY;AAAA,cACzB;AACA,wBAAU,QAAQ;AAAA,YACnB;AACA,mBAAO;AAAA,UACR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UASA,aAAa,SAAU,SAAS,UAAU;AAGzC,oBAAQ,YAAY,QAAQ,UAAU,QAAQ,OAAO,MAAM,IAAI,GAAG,EAAE;AAIpE,oBAAQ,UAAU,IAAI,cAAc,QAAQ;AAAA,UAC7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UASA,eAAe,WAAY;AAC1B,gBAAI,OAAO,aAAa,aAAa;AACpC,qBAAO;AAAA,YACR;AACA,gBAAI,mBAAmB,YAAY,IAAI,GAAwC;AAC9E;AAAA;AAAA,gBAA2B,SAAS;AAAA;AAAA,YACrC;AAMA,gBAAI;AACH,oBAAM,IAAI,MAAM;AAAA,YACjB,SAAS,KAAK;AAQb,kBAAI,OAAO,qCAAqC,KAAK,IAAI,KAAK,KAAK,CAAC,GAAG,CAAC;AACxE,kBAAI,KAAK;AACR,oBAAI,UAAU,SAAS,qBAAqB,QAAQ;AACpD,yBAAS,KAAK,SAAS;AACtB,sBAAI,QAAQ,CAAC,EAAE,OAAO,KAAK;AAC1B,2BAAO,QAAQ,CAAC;AAAA,kBACjB;AAAA,gBACD;AAAA,cACD;AACA,qBAAO;AAAA,YACR;AAAA,UACD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAqBA,UAAU,SAAU,SAAS,WAAW,mBAAmB;AAC1D,gBAAI,KAAK,QAAQ;AAEjB,mBAAO,SAAS;AACf,kBAAI,YAAY,QAAQ;AACxB,kBAAI,UAAU,SAAS,SAAS,GAAG;AAClC,uBAAO;AAAA,cACR;AACA,kBAAI,UAAU,SAAS,EAAE,GAAG;AAC3B,uBAAO;AAAA,cACR;AACA,wBAAU,QAAQ;AAAA,YACnB;AACA,mBAAO,CAAC,CAAC;AAAA,UACV;AAAA,QACD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QASA,WAAW;AAAA;AAAA;AAAA;AAAA,UAIV,OAAO;AAAA,UACP,WAAW;AAAA,UACX,MAAM;AAAA,UACN,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UA8BL,QAAQ,SAAU,IAAI,OAAO;AAC5B,gBAAIC,QAAO,EAAE,KAAK,MAAM,EAAE,UAAU,EAAE,CAAC;AAEvC,qBAAS,OAAO,OAAO;AACtB,cAAAA,MAAK,GAAG,IAAI,MAAM,GAAG;AAAA,YACtB;AAEA,mBAAOA;AAAA,UACR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UA6EA,cAAc,SAAU,QAAQ,QAAQ,QAAQ,MAAM;AACrD,mBAAO;AAAA,YAA4B,EAAE;AACrC,gBAAI,UAAU,KAAK,MAAM;AAEzB,gBAAI,MAAM,CAAC;AAEX,qBAAS,SAAS,SAAS;AAC1B,kBAAI,QAAQ,eAAe,KAAK,GAAG;AAElC,oBAAI,SAAS,QAAQ;AACpB,2BAAS,YAAY,QAAQ;AAC5B,wBAAI,OAAO,eAAe,QAAQ,GAAG;AACpC,0BAAI,QAAQ,IAAI,OAAO,QAAQ;AAAA,oBAChC;AAAA,kBACD;AAAA,gBACD;AAGA,oBAAI,CAAC,OAAO,eAAe,KAAK,GAAG;AAClC,sBAAI,KAAK,IAAI,QAAQ,KAAK;AAAA,gBAC3B;AAAA,cACD;AAAA,YACD;AAEA,gBAAI,MAAM,KAAK,MAAM;AACrB,iBAAK,MAAM,IAAI;AAGf,cAAE,UAAU,IAAI,EAAE,WAAW,SAAU,KAAK,OAAO;AAClD,kBAAI,UAAU,OAAO,OAAO,QAAQ;AACnC,qBAAK,GAAG,IAAI;AAAA,cACb;AAAA,YACD,CAAC;AAED,mBAAO;AAAA,UACR;AAAA;AAAA,UAGA,KAAK,SAAS,IAAI,GAAG,UAAU,MAAM,SAAS;AAC7C,sBAAU,WAAW,CAAC;AAEtB,gBAAI,QAAQ,EAAE,KAAK;AAEnB,qBAAS,KAAK,GAAG;AAChB,kBAAI,EAAE,eAAe,CAAC,GAAG;AACxB,yBAAS,KAAK,GAAG,GAAG,EAAE,CAAC,GAAG,QAAQ,CAAC;AAEnC,oBAAI,WAAW,EAAE,CAAC;AAClB,oBAAI,eAAe,EAAE,KAAK,KAAK,QAAQ;AAEvC,oBAAI,iBAAiB,YAAY,CAAC,QAAQ,MAAM,QAAQ,CAAC,GAAG;AAC3D,0BAAQ,MAAM,QAAQ,CAAC,IAAI;AAC3B,sBAAI,UAAU,UAAU,MAAM,OAAO;AAAA,gBACtC,WAAW,iBAAiB,WAAW,CAAC,QAAQ,MAAM,QAAQ,CAAC,GAAG;AACjE,0BAAQ,MAAM,QAAQ,CAAC,IAAI;AAC3B,sBAAI,UAAU,UAAU,GAAG,OAAO;AAAA,gBACnC;AAAA,cACD;AAAA,YACD;AAAA,UACD;AAAA,QACD;AAAA,QAEA,SAAS,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAcV,cAAc,SAAU,OAAO,UAAU;AACxC,YAAE,kBAAkB,UAAU,OAAO,QAAQ;AAAA,QAC9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAiBA,mBAAmB,SAAU,WAAW,OAAO,UAAU;AACxD,cAAI,MAAM;AAAA,YACT;AAAA,YACA;AAAA,YACA,UAAU;AAAA,UACX;AAEA,YAAE,MAAM,IAAI,uBAAuB,GAAG;AAEtC,cAAI,WAAW,MAAM,UAAU,MAAM,MAAM,IAAI,UAAU,iBAAiB,IAAI,QAAQ,CAAC;AAEvF,YAAE,MAAM,IAAI,iCAAiC,GAAG;AAEhD,mBAAS,IAAI,GAAG,SAAU,UAAU,IAAI,SAAS,GAAG,KAAK;AACxD,cAAE,iBAAiB,SAAS,UAAU,MAAM,IAAI,QAAQ;AAAA,UACzD;AAAA,QACD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QA8BA,kBAAkB,SAAU,SAAS,OAAO,UAAU;AAErD,cAAI,WAAW,EAAE,KAAK,YAAY,OAAO;AACzC,cAAI,UAAU,EAAE,UAAU,QAAQ;AAGlC,YAAE,KAAK,YAAY,SAAS,QAAQ;AAGpC,cAAI,SAAS,QAAQ;AACrB,cAAI,UAAU,OAAO,SAAS,YAAY,MAAM,OAAO;AACtD,cAAE,KAAK,YAAY,QAAQ,QAAQ;AAAA,UACpC;AAEA,cAAI,OAAO,QAAQ;AAEnB,cAAI,MAAM;AAAA,YACT;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,UACD;AAEA,mBAAS,sBAAsB,iBAAiB;AAC/C,gBAAI,kBAAkB;AAEtB,cAAE,MAAM,IAAI,iBAAiB,GAAG;AAEhC,gBAAI,QAAQ,YAAY,IAAI;AAE5B,cAAE,MAAM,IAAI,mBAAmB,GAAG;AAClC,cAAE,MAAM,IAAI,YAAY,GAAG;AAC3B,wBAAY,SAAS,KAAK,IAAI,OAAO;AAAA,UACtC;AAEA,YAAE,MAAM,IAAI,uBAAuB,GAAG;AAGtC,mBAAS,IAAI,QAAQ;AACrB,cAAI,UAAU,OAAO,SAAS,YAAY,MAAM,SAAS,CAAC,OAAO,aAAa,UAAU,GAAG;AAC1F,mBAAO,aAAa,YAAY,GAAG;AAAA,UACpC;AAEA,cAAI,CAAC,IAAI,MAAM;AACd,cAAE,MAAM,IAAI,YAAY,GAAG;AAC3B,wBAAY,SAAS,KAAK,IAAI,OAAO;AACrC;AAAA,UACD;AAEA,YAAE,MAAM,IAAI,oBAAoB,GAAG;AAEnC,cAAI,CAAC,IAAI,SAAS;AACjB,kCAAsB,EAAE,KAAK,OAAO,IAAI,IAAI,CAAC;AAC7C;AAAA,UACD;AAEA,cAAI,SAASD,OAAM,QAAQ;AAC1B,gBAAI,SAAS,IAAI,OAAO,EAAE,QAAQ;AAElC,mBAAO,YAAY,SAAU,KAAK;AACjC,oCAAsB,IAAI,IAAI;AAAA,YAC/B;AAEA,mBAAO,YAAY,KAAK,UAAU;AAAA,cACjC,UAAU,IAAI;AAAA,cACd,MAAM,IAAI;AAAA,cACV,gBAAgB;AAAA,YACjB,CAAC,CAAC;AAAA,UACH,OAAO;AACN,kCAAsB,EAAE,UAAU,IAAI,MAAM,IAAI,SAAS,IAAI,QAAQ,CAAC;AAAA,UACvE;AAAA,QACD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAsBA,WAAW,SAAU,MAAM,SAAS,UAAU;AAC7C,cAAI,MAAM;AAAA,YACT,MAAM;AAAA,YACN;AAAA,YACA;AAAA,UACD;AACA,YAAE,MAAM,IAAI,mBAAmB,GAAG;AAClC,cAAI,CAAC,IAAI,SAAS;AACjB,kBAAM,IAAI,MAAM,mBAAmB,IAAI,WAAW,mBAAmB;AAAA,UACtE;AACA,cAAI,SAAS,EAAE,SAAS,IAAI,MAAM,IAAI,OAAO;AAC7C,YAAE,MAAM,IAAI,kBAAkB,GAAG;AACjC,iBAAO,MAAM,UAAU,EAAE,KAAK,OAAO,IAAI,MAAM,GAAG,IAAI,QAAQ;AAAA,QAC/D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QA0BA,UAAU,SAAU,MAAM,SAAS;AAClC,cAAI,OAAO,QAAQ;AACnB,cAAI,MAAM;AACT,qBAAS,SAAS,MAAM;AACvB,sBAAQ,KAAK,IAAI,KAAK,KAAK;AAAA,YAC5B;AAEA,mBAAO,QAAQ;AAAA,UAChB;AAEA,cAAI,YAAY,IAAI,WAAW;AAC/B,mBAAS,WAAW,UAAU,MAAM,IAAI;AAExC,uBAAa,MAAM,WAAW,SAAS,UAAU,MAAM,CAAC;AAExD,iBAAO,QAAQ,SAAS;AAAA,QACzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOA,OAAO;AAAA,UACN,KAAK,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAcN,KAAK,SAAU,MAAM,UAAU;AAC9B,gBAAI,QAAQ,EAAE,MAAM;AAEpB,kBAAM,IAAI,IAAI,MAAM,IAAI,KAAK,CAAC;AAE9B,kBAAM,IAAI,EAAE,KAAK,QAAQ;AAAA,UAC1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAWA,KAAK,SAAU,MAAM,KAAK;AACzB,gBAAI,YAAY,EAAE,MAAM,IAAI,IAAI;AAEhC,gBAAI,CAAC,aAAa,CAAC,UAAU,QAAQ;AACpC;AAAA,YACD;AAEA,qBAAS,IAAI,GAAG,UAAW,WAAW,UAAU,GAAG,KAAK;AACvD,uBAAS,GAAG;AAAA,YACb;AAAA,UACD;AAAA,QACD;AAAA,QAEA;AAAA,MACD;AACA,MAAAA,OAAM,QAAQ;AAmBd,eAAS,MAAM,MAAM,SAAS,OAAO,YAAY;AAUhD,aAAK,OAAO;AASZ,aAAK,UAAU;AAQf,aAAK,QAAQ;AAEb,aAAK,UAAU,cAAc,IAAI,SAAS;AAAA,MAC3C;AA8BA,YAAM,YAAY,SAAS,UAAU,GAAG,UAAU;AACjD,YAAI,OAAO,KAAK,UAAU;AACzB,iBAAO;AAAA,QACR;AACA,YAAI,MAAM,QAAQ,CAAC,GAAG;AACrB,cAAI,IAAI;AACR,YAAE,QAAQ,SAAU,GAAG;AACtB,iBAAK,UAAU,GAAG,QAAQ;AAAA,UAC3B,CAAC;AACD,iBAAO;AAAA,QACR;AAEA,YAAI,MAAM;AAAA,UACT,MAAM,EAAE;AAAA,UACR,SAAS,UAAU,EAAE,SAAS,QAAQ;AAAA,UACtC,KAAK;AAAA,UACL,SAAS,CAAC,SAAS,EAAE,IAAI;AAAA,UACzB,YAAY,CAAC;AAAA,UACb;AAAA,QACD;AAEA,YAAI,UAAU,EAAE;AAChB,YAAI,SAAS;AACZ,cAAI,MAAM,QAAQ,OAAO,GAAG;AAC3B,kBAAM,UAAU,KAAK,MAAM,IAAI,SAAS,OAAO;AAAA,UAChD,OAAO;AACN,gBAAI,QAAQ,KAAK,OAAO;AAAA,UACzB;AAAA,QACD;AAEA,UAAE,MAAM,IAAI,QAAQ,GAAG;AAEvB,YAAI,aAAa;AACjB,iBAAS,QAAQ,IAAI,YAAY;AAChC,wBAAc,MAAM,OAAO,QAAQ,IAAI,WAAW,IAAI,KAAK,IAAI,QAAQ,MAAM,QAAQ,IAAI;AAAA,QAC1F;AAEA,eAAO,MAAM,IAAI,MAAM,aAAa,IAAI,QAAQ,KAAK,GAAG,IAAI,MAAM,aAAa,MAAM,IAAI,UAAU,OAAO,IAAI,MAAM;AAAA,MACrH;AASA,eAAS,aAAa,SAAS,KAAK,MAAM,YAAY;AACrD,gBAAQ,YAAY;AACpB,YAAI,QAAQ,QAAQ,KAAK,IAAI;AAC7B,YAAI,SAAS,cAAc,MAAM,CAAC,GAAG;AAEpC,cAAI,mBAAmB,MAAM,CAAC,EAAE;AAChC,gBAAM,SAAS;AACf,gBAAM,CAAC,IAAI,MAAM,CAAC,EAAE,MAAM,gBAAgB;AAAA,QAC3C;AACA,eAAO;AAAA,MACR;AAgBA,eAAS,aAAa,MAAM,WAAW,SAAS,WAAW,UAAU,SAAS;AAC7E,iBAAS,SAAS,SAAS;AAC1B,cAAI,CAAC,QAAQ,eAAe,KAAK,KAAK,CAAC,QAAQ,KAAK,GAAG;AACtD;AAAA,UACD;AAEA,cAAI,WAAW,QAAQ,KAAK;AAC5B,qBAAW,MAAM,QAAQ,QAAQ,IAAI,WAAW,CAAC,QAAQ;AAEzD,mBAAS,IAAI,GAAG,IAAI,SAAS,QAAQ,EAAE,GAAG;AACzC,gBAAI,WAAW,QAAQ,SAAS,QAAQ,MAAM,GAAG;AAChD;AAAA,YACD;AAEA,gBAAI,aAAa,SAAS,CAAC;AAC3B,gBAAI,SAAS,WAAW;AACxB,gBAAI,aAAa,CAAC,CAAC,WAAW;AAC9B,gBAAI,SAAS,CAAC,CAAC,WAAW;AAC1B,gBAAI,QAAQ,WAAW;AAEvB,gBAAI,UAAU,CAAC,WAAW,QAAQ,QAAQ;AAEzC,kBAAI,QAAQ,WAAW,QAAQ,SAAS,EAAE,MAAM,WAAW,EAAE,CAAC;AAC9D,yBAAW,UAAU,OAAO,WAAW,QAAQ,QAAQ,QAAQ,GAAG;AAAA,YACnE;AAGA,gBAAI,UAAU,WAAW,WAAW;AAEpC,qBACK,cAAc,UAAU,MAAM,MAAM,UACxC,gBAAgB,UAAU,MAC1B,OAAO,YAAY,MAAM,QAAQ,cAAc,YAAY,MAC1D;AAED,kBAAI,WAAW,OAAO,QAAQ,OAAO;AACpC;AAAA,cACD;AAEA,kBAAI,MAAM,YAAY;AAEtB,kBAAI,UAAU,SAAS,KAAK,QAAQ;AAEnC;AAAA,cACD;AAEA,kBAAI,eAAe,OAAO;AACzB;AAAA,cACD;AAEA,kBAAI,cAAc;AAClB,kBAAI;AAEJ,kBAAI,QAAQ;AACX,wBAAQ,aAAa,SAAS,KAAK,MAAM,UAAU;AACnD,oBAAI,CAAC,SAAS,MAAM,SAAS,KAAK,QAAQ;AACzC;AAAA,gBACD;AAEA,oBAAI,OAAO,MAAM;AACjB,oBAAI,KAAK,MAAM,QAAQ,MAAM,CAAC,EAAE;AAChC,oBAAI,IAAI;AAGR,qBAAK,YAAY,MAAM;AACvB,uBAAO,QAAQ,GAAG;AACjB,gCAAc,YAAY;AAC1B,uBAAK,YAAY,MAAM;AAAA,gBACxB;AAEA,qBAAK,YAAY,MAAM;AACvB,sBAAM;AAGN,oBAAI,YAAY,iBAAiB,OAAO;AACvC;AAAA,gBACD;AAGA,yBACK,IAAI,aACR,MAAM,UAAU,SAAS,IAAI,MAAM,OAAO,EAAE,UAAU,WACtD,IAAI,EAAE,MACL;AACD;AACA,uBAAK,EAAE,MAAM;AAAA,gBACd;AACA;AAGA,sBAAM,KAAK,MAAM,KAAK,CAAC;AACvB,sBAAM,SAAS;AAAA,cAChB,OAAO;AACN,wBAAQ,aAAa,SAAS,GAAG,KAAK,UAAU;AAChD,oBAAI,CAAC,OAAO;AACX;AAAA,gBACD;AAAA,cACD;AAGA,kBAAI,OAAO,MAAM;AACjB,kBAAI,WAAW,MAAM,CAAC;AACtB,kBAAI,SAAS,IAAI,MAAM,GAAG,IAAI;AAC9B,kBAAI,QAAQ,IAAI,MAAM,OAAO,SAAS,MAAM;AAE5C,kBAAI,QAAQ,MAAM,IAAI;AACtB,kBAAI,WAAW,QAAQ,QAAQ,OAAO;AACrC,wBAAQ,QAAQ;AAAA,cACjB;AAEA,kBAAI,aAAa,YAAY;AAE7B,kBAAI,QAAQ;AACX,6BAAa,SAAS,WAAW,YAAY,MAAM;AACnD,uBAAO,OAAO;AAAA,cACf;AAEA,0BAAY,WAAW,YAAY,WAAW;AAE9C,kBAAI,UAAU,IAAI,MAAM,OAAO,SAAS,EAAE,SAAS,UAAU,MAAM,IAAI,UAAU,OAAO,QAAQ;AAChG,4BAAc,SAAS,WAAW,YAAY,OAAO;AAErD,kBAAI,OAAO;AACV,yBAAS,WAAW,aAAa,KAAK;AAAA,cACvC;AAEA,kBAAI,cAAc,GAAG;AAKpB,oBAAI,gBAAgB;AAAA,kBACnB,OAAO,QAAQ,MAAM;AAAA,kBACrB;AAAA,gBACD;AACA,6BAAa,MAAM,WAAW,SAAS,YAAY,MAAM,KAAK,aAAa;AAG3E,oBAAI,WAAW,cAAc,QAAQ,QAAQ,OAAO;AACnD,0BAAQ,QAAQ,cAAc;AAAA,gBAC/B;AAAA,cACD;AAAA,YACD;AAAA,UACD;AAAA,QACD;AAAA,MACD;AAeA,eAAS,aAAa;AAErB,YAAI,OAAO,EAAE,OAAO,MAAM,MAAM,MAAM,MAAM,KAAK;AAEjD,YAAI,OAAO,EAAE,OAAO,MAAM,MAAM,MAAM,MAAM,KAAK;AACjD,aAAK,OAAO;AAGZ,aAAK,OAAO;AAEZ,aAAK,OAAO;AACZ,aAAK,SAAS;AAAA,MACf;AAWA,eAAS,SAAS,MAAM,MAAM,OAAO;AAEpC,YAAI,OAAO,KAAK;AAEhB,YAAI,UAAU,EAAE,OAAc,MAAM,MAAM,KAAW;AACrD,aAAK,OAAO;AACZ,aAAK,OAAO;AACZ,aAAK;AAEL,eAAO;AAAA,MACR;AASA,eAAS,YAAY,MAAM,MAAM,OAAO;AACvC,YAAI,OAAO,KAAK;AAChB,iBAAS,IAAI,GAAG,IAAI,SAAS,SAAS,KAAK,MAAM,KAAK;AACrD,iBAAO,KAAK;AAAA,QACb;AACA,aAAK,OAAO;AACZ,aAAK,OAAO;AACZ,aAAK,UAAU;AAAA,MAChB;AAMA,eAAS,QAAQ,MAAM;AACtB,YAAI,QAAQ,CAAC;AACb,YAAI,OAAO,KAAK,KAAK;AACrB,eAAO,SAAS,KAAK,MAAM;AAC1B,gBAAM,KAAK,KAAK,KAAK;AACrB,iBAAO,KAAK;AAAA,QACb;AACA,eAAO;AAAA,MACR;AAGA,UAAI,CAACA,OAAM,UAAU;AACpB,YAAI,CAACA,OAAM,kBAAkB;AAE5B,iBAAO;AAAA,QACR;AAEA,YAAI,CAAC,EAAE,6BAA6B;AAEnC,UAAAA,OAAM,iBAAiB,WAAW,SAAU,KAAK;AAChD,gBAAI,UAAU,KAAK,MAAM,IAAI,IAAI;AACjC,gBAAIC,QAAO,QAAQ;AACnB,gBAAI,OAAO,QAAQ;AACnB,gBAAI,iBAAiB,QAAQ;AAE7B,YAAAD,OAAM,YAAY,EAAE,UAAU,MAAM,EAAE,UAAUC,KAAI,GAAGA,KAAI,CAAC;AAC5D,gBAAI,gBAAgB;AACnB,cAAAD,OAAM,MAAM;AAAA,YACb;AAAA,UACD,GAAG,KAAK;AAAA,QACT;AAEA,eAAO;AAAA,MACR;AAGA,UAAI,SAAS,EAAE,KAAK,cAAc;AAElC,UAAI,QAAQ;AACX,UAAE,WAAW,OAAO;AAEpB,YAAI,OAAO,aAAa,aAAa,GAAG;AACvC,YAAE,SAAS;AAAA,QACZ;AAAA,MACD;AAEA,eAAS,iCAAiC;AACzC,YAAI,CAAC,EAAE,QAAQ;AACd,YAAE,aAAa;AAAA,QAChB;AAAA,MACD;AAEA,UAAI,CAAC,EAAE,QAAQ;AAOd,YAAI,aAAa,SAAS;AAC1B,YAAI,eAAe,aAAa,eAAe,iBAAiB,UAAU,OAAO,OAAO;AACvF,mBAAS,iBAAiB,oBAAoB,8BAA8B;AAAA,QAC7E,OAAO;AACN,cAAI,OAAO,uBAAuB;AACjC,mBAAO,sBAAsB,8BAA8B;AAAA,UAC5D,OAAO;AACN,mBAAO,WAAW,gCAAgC,EAAE;AAAA,UACrD;AAAA,QACD;AAAA,MACD;AAEA,aAAO;AAAA,IAER,EAAE,KAAK;AAEP,QAAI,OAAO,WAAW,eAAe,OAAO,SAAS;AACpD,aAAO,UAAUD;AAAA,IAClB;AAGA,QAAI,OAAO,WAAW,aAAa;AAClC,aAAO,QAAQA;AAAA,IAChB;AAwDA,IAAAA,OAAM,UAAU,SAAS;AAAA,MACxB,WAAW;AAAA,QACV,SAAS;AAAA,QACT,QAAQ;AAAA,MACT;AAAA,MACA,UAAU;AAAA,QACT,SAAS;AAAA,QACT,QAAQ;AAAA,MACT;AAAA,MACA,WAAW;AAAA;AAAA,QAEV,SAAS;AAAA,QACT,QAAQ;AAAA,QACR,QAAQ;AAAA,UACP,mBAAmB;AAAA,YAClB,SAAS;AAAA,YACT,YAAY;AAAA,YACZ,QAAQ;AAAA,YACR,QAAQ;AAAA;AAAA,UACT;AAAA,UACA,UAAU;AAAA,YACT,SAAS;AAAA,YACT,QAAQ;AAAA,UACT;AAAA,UACA,eAAe;AAAA,UACf,eAAe;AAAA,UACf,QAAQ;AAAA,QACT;AAAA,MACD;AAAA,MACA,SAAS;AAAA,QACR,SAAS;AAAA,QACT,QAAQ;AAAA,MACT;AAAA,MACA,OAAO;AAAA,QACN,SAAS;AAAA,QACT,QAAQ;AAAA,QACR,QAAQ;AAAA,UACP,OAAO;AAAA,YACN,SAAS;AAAA,YACT,QAAQ;AAAA,cACP,eAAe;AAAA,cACf,aAAa;AAAA,YACd;AAAA,UACD;AAAA,UACA,gBAAgB,CAAC;AAAA,UACjB,cAAc;AAAA,YACb,SAAS;AAAA,YACT,QAAQ;AAAA,cACP,eAAe;AAAA,gBACd;AAAA,kBACC,SAAS;AAAA,kBACT,OAAO;AAAA,gBACR;AAAA,gBACA;AAAA,kBACC,SAAS;AAAA,kBACT,YAAY;AAAA,gBACb;AAAA,cACD;AAAA,YACD;AAAA,UACD;AAAA,UACA,eAAe;AAAA,UACf,aAAa;AAAA,YACZ,SAAS;AAAA,YACT,QAAQ;AAAA,cACP,aAAa;AAAA,YACd;AAAA,UACD;AAAA,QAED;AAAA,MACD;AAAA,MACA,UAAU;AAAA,QACT;AAAA,UACC,SAAS;AAAA,UACT,OAAO;AAAA,QACR;AAAA,QACA;AAAA,MACD;AAAA,IACD;AAEA,IAAAA,OAAM,UAAU,OAAO,KAAK,EAAE,OAAO,YAAY,EAAE,OAAO,QAAQ,IACjEA,OAAM,UAAU,OAAO,QAAQ;AAChC,IAAAA,OAAM,UAAU,OAAO,SAAS,EAAE,OAAO,iBAAiB,EAAE,SAASA,OAAM,UAAU;AAGrF,IAAAA,OAAM,MAAM,IAAI,QAAQ,SAAU,KAAK;AAEtC,UAAI,IAAI,SAAS,UAAU;AAC1B,YAAI,WAAW,OAAO,IAAI,IAAI,QAAQ,QAAQ,SAAS,GAAG;AAAA,MAC3D;AAAA,IACD,CAAC;AAED,WAAO,eAAeA,OAAM,UAAU,OAAO,KAAK,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAY/D,OAAO,SAAS,WAAW,SAAS,MAAM;AACzC,YAAI,sBAAsB,CAAC;AAC3B,4BAAoB,cAAc,IAAI,IAAI;AAAA,UACzC,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,QAAQA,OAAM,UAAU,IAAI;AAAA,QAC7B;AACA,4BAAoB,OAAO,IAAI;AAE/B,YAAI,SAAS;AAAA,UACZ,kBAAkB;AAAA,YACjB,SAAS;AAAA,YACT,QAAQ;AAAA,UACT;AAAA,QACD;AACA,eAAO,cAAc,IAAI,IAAI;AAAA,UAC5B,SAAS;AAAA,UACT,QAAQA,OAAM,UAAU,IAAI;AAAA,QAC7B;AAEA,YAAI,MAAM,CAAC;AACX,YAAI,OAAO,IAAI;AAAA,UACd,SAAS,OAAO,wFAAwF,OAAO,QAAQ,OAAO,WAAY;AAAE,mBAAO;AAAA,UAAS,CAAC,GAAG,GAAG;AAAA,UACnK,YAAY;AAAA,UACZ,QAAQ;AAAA,UACR;AAAA,QACD;AAEA,QAAAA,OAAM,UAAU,aAAa,UAAU,SAAS,GAAG;AAAA,MACpD;AAAA,IACD,CAAC;AACD,WAAO,eAAeA,OAAM,UAAU,OAAO,KAAK,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAYjE,OAAO,SAAU,UAAU,MAAM;AAChC,QAAAA,OAAM,UAAU,OAAO,IAAI,OAAO,cAAc,EAAE,KAAK;AAAA,UACtD,SAAS;AAAA,YACR,aAAa,SAAS,QAAQ,WAAW,MAAM,iDAAiD;AAAA,YAChG;AAAA,UACD;AAAA,UACA,YAAY;AAAA,UACZ,QAAQ;AAAA,YACP,aAAa;AAAA,YACb,cAAc;AAAA,cACb,SAAS;AAAA,cACT,QAAQ;AAAA,gBACP,SAAS;AAAA,kBACR,SAAS;AAAA,kBACT,YAAY;AAAA,kBACZ,OAAO,CAAC,MAAM,cAAc,IAAI;AAAA,kBAChC,QAAQA,OAAM,UAAU,IAAI;AAAA,gBAC7B;AAAA,gBACA,eAAe;AAAA,kBACd;AAAA,oBACC,SAAS;AAAA,oBACT,OAAO;AAAA,kBACR;AAAA,kBACA;AAAA,gBACD;AAAA,cACD;AAAA,YACD;AAAA,UACD;AAAA,QACD,CAAC;AAAA,MACF;AAAA,IACD,CAAC;AAED,IAAAA,OAAM,UAAU,OAAOA,OAAM,UAAU;AACvC,IAAAA,OAAM,UAAU,SAASA,OAAM,UAAU;AACzC,IAAAA,OAAM,UAAU,MAAMA,OAAM,UAAU;AAEtC,IAAAA,OAAM,UAAU,MAAMA,OAAM,UAAU,OAAO,UAAU,CAAC,CAAC;AACzD,IAAAA,OAAM,UAAU,OAAOA,OAAM,UAAU;AACvC,IAAAA,OAAM,UAAU,OAAOA,OAAM,UAAU;AACvC,IAAAA,OAAM,UAAU,MAAMA,OAAM,UAAU;AAOtC,KAAC,SAAUA,QAAO;AAEjB,UAAI,SAAS;AAEb,MAAAA,OAAM,UAAU,MAAM;AAAA,QACrB,WAAW;AAAA,QACX,UAAU;AAAA,UACT,SAAS,OAAO,eAAe,sBAAsB,SAAS,MAAM,OAAO,SAAS,QAAQ,kBAAkB,MAAM;AAAA,UACpH,QAAQ;AAAA,YACP,QAAQ;AAAA,YACR,8BAA8B;AAAA,cAC7B,SAAS;AAAA,cACT,YAAY;AAAA,cACZ,OAAO;AAAA,YACR;AAAA,YACA,WAAW;AAAA,cACV,SAAS;AAAA,cACT,YAAY;AAAA,YACb;AAAA;AAAA,UAED;AAAA,QACD;AAAA,QACA,OAAO;AAAA;AAAA,UAEN,SAAS,OAAO,iBAAiB,OAAO,SAAS,MAAM,8BAA8B,SAAS,QAAQ,GAAG;AAAA,UACzG,QAAQ;AAAA,UACR,QAAQ;AAAA,YACP,YAAY;AAAA,YACZ,eAAe;AAAA,YACf,UAAU;AAAA,cACT,SAAS,OAAO,MAAM,OAAO,SAAS,GAAG;AAAA,cACzC,OAAO;AAAA,YACR;AAAA,UACD;AAAA,QACD;AAAA,QACA,YAAY;AAAA,UACX,SAAS,OAAO,sDAAuD,OAAO,SAAS,eAAe;AAAA,UACtG,YAAY;AAAA,QACb;AAAA,QACA,UAAU;AAAA,UACT,SAAS;AAAA,UACT,QAAQ;AAAA,QACT;AAAA,QACA,YAAY;AAAA,UACX,SAAS;AAAA,UACT,YAAY;AAAA,QACb;AAAA,QACA,aAAa;AAAA,QACb,YAAY;AAAA,UACX,SAAS;AAAA,UACT,YAAY;AAAA,QACb;AAAA,QACA,eAAe;AAAA,MAChB;AAEA,MAAAA,OAAM,UAAU,IAAI,QAAQ,EAAE,OAAO,OAAOA,OAAM,UAAU;AAE5D,UAAI,SAASA,OAAM,UAAU;AAC7B,UAAI,QAAQ;AACX,eAAO,IAAI,WAAW,SAAS,KAAK;AACpC,eAAO,IAAI,aAAa,SAAS,KAAK;AAAA,MACvC;AAAA,IAED,GAAEA,MAAK;AAOP,IAAAA,OAAM,UAAU,QAAQ;AAAA,MACvB,WAAW;AAAA,QACV;AAAA,UACC,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,QAAQ;AAAA,QACT;AAAA,QACA;AAAA,UACC,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,QAAQ;AAAA,QACT;AAAA,MACD;AAAA,MACA,UAAU;AAAA,QACT,SAAS;AAAA,QACT,QAAQ;AAAA,MACT;AAAA,MACA,cAAc;AAAA,QACb,SAAS;AAAA,QACT,YAAY;AAAA,QACZ,QAAQ;AAAA,UACP,eAAe;AAAA,QAChB;AAAA,MACD;AAAA,MACA,WAAW;AAAA,MACX,WAAW;AAAA,MACX,YAAY;AAAA,MACZ,UAAU;AAAA,MACV,YAAY;AAAA,MACZ,eAAe;AAAA,IAChB;AAOA,IAAAA,OAAM,UAAU,aAAaA,OAAM,UAAU,OAAO,SAAS;AAAA,MAC5D,cAAc;AAAA,QACbA,OAAM,UAAU,MAAM,YAAY;AAAA,QAClC;AAAA,UACC,SAAS;AAAA,UACT,YAAY;AAAA,QACb;AAAA,MACD;AAAA,MACA,WAAW;AAAA,QACV;AAAA,UACC,SAAS;AAAA,UACT,YAAY;AAAA,QACb;AAAA,QACA;AAAA,UACC,SAAS;AAAA,UACT,YAAY;AAAA,QACb;AAAA,MACD;AAAA;AAAA,MAEA,YAAY;AAAA,MACZ,UAAU;AAAA,QACT,SAAS;AAAA,UACR,aAAa,SACb;AAAA,WAGC,eAAe,SACf;AAAA,UAEA,0BAA0B,SAC1B;AAAA,UAEA,4BAA4B,SAC5B;AAAA,UAEA,sCAAsC,SACtC;AAAA,UAEA,gBAAgB,SAChB;AAAA,UAEA,oFAAoF,UAErF,MACA,YAAY;AAAA,QACb;AAAA,QACA,YAAY;AAAA,MACb;AAAA,MACA,YAAY;AAAA,IACb,CAAC;AAED,IAAAA,OAAM,UAAU,WAAW,YAAY,EAAE,CAAC,EAAE,UAAU;AAEtD,IAAAA,OAAM,UAAU,aAAa,cAAc,WAAW;AAAA,MACrD,SAAS;AAAA,QACR,SAAS;AAAA;AAAA;AAAA,UAGR,0DAA0D;AAAA;AAAA;AAAA;AAAA,UAK1D,KAAK,SACL,QACA,iEAAiE,SACjE;AAAA,UAEA,qIAAqI,SACrI;AAAA,UAEA,kEAAkE;AAAA,QACnE;AAAA,QACA,YAAY;AAAA,QACZ,QAAQ;AAAA,QACR,QAAQ;AAAA,UACP,gBAAgB;AAAA,YACf,SAAS;AAAA,YACT,YAAY;AAAA,YACZ,OAAO;AAAA,YACP,QAAQA,OAAM,UAAU;AAAA,UACzB;AAAA,UACA,mBAAmB;AAAA,UACnB,eAAe;AAAA,QAChB;AAAA,MACD;AAAA;AAAA,MAEA,qBAAqB;AAAA,QACpB,SAAS;AAAA,QACT,OAAO;AAAA,MACR;AAAA,MACA,aAAa;AAAA,QACZ;AAAA,UACC,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,QAAQA,OAAM,UAAU;AAAA,QACzB;AAAA,QACA;AAAA,UACC,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,QAAQA,OAAM,UAAU;AAAA,QACzB;AAAA,QACA;AAAA,UACC,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,QAAQA,OAAM,UAAU;AAAA,QACzB;AAAA,QACA;AAAA,UACC,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,QAAQA,OAAM,UAAU;AAAA,QACzB;AAAA,MACD;AAAA,MACA,YAAY;AAAA,IACb,CAAC;AAED,IAAAA,OAAM,UAAU,aAAa,cAAc,UAAU;AAAA,MACpD,YAAY;AAAA,QACX,SAAS;AAAA,QACT,QAAQ;AAAA,QACR,OAAO;AAAA,MACR;AAAA,MACA,mBAAmB;AAAA,QAClB,SAAS;AAAA,QACT,QAAQ;AAAA,QACR,QAAQ;AAAA,UACP,wBAAwB;AAAA,YACvB,SAAS;AAAA,YACT,OAAO;AAAA,UACR;AAAA,UACA,iBAAiB;AAAA,YAChB,SAAS;AAAA,YACT,YAAY;AAAA,YACZ,QAAQ;AAAA,cACP,6BAA6B;AAAA,gBAC5B,SAAS;AAAA,gBACT,OAAO;AAAA,cACR;AAAA,cACA,MAAMA,OAAM,UAAU;AAAA,YACvB;AAAA,UACD;AAAA,UACA,UAAU;AAAA,QACX;AAAA,MACD;AAAA,MACA,mBAAmB;AAAA,QAClB,SAAS;AAAA,QACT,YAAY;AAAA,QACZ,QAAQ;AAAA,QACR,OAAO;AAAA,MACR;AAAA,IACD,CAAC;AAED,IAAAA,OAAM,UAAU,aAAa,cAAc,YAAY;AAAA,MACtD,oBAAoB;AAAA,QACnB,SAAS;AAAA,QACT,YAAY;AAAA,QACZ,OAAO;AAAA,MACR;AAAA,IACD,CAAC;AAED,QAAIA,OAAM,UAAU,QAAQ;AAC3B,MAAAA,OAAM,UAAU,OAAO,IAAI,WAAW,UAAU,YAAY;AAI5D,MAAAA,OAAM,UAAU,OAAO,IAAI;AAAA,QAC1B,yNAAyN;AAAA,QACzN;AAAA,MACD;AAAA,IACD;AAEA,IAAAA,OAAM,UAAU,KAAKA,OAAM,UAAU;AAOrC,KAAC,WAAY;AAEZ,UAAI,OAAOA,WAAU,eAAe,OAAO,aAAa,aAAa;AACpE;AAAA,MACD;AAGA,UAAI,CAAC,QAAQ,UAAU,SAAS;AAC/B,gBAAQ,UAAU,UAAU,QAAQ,UAAU,qBAAqB,QAAQ,UAAU;AAAA,MACtF;AAEA,UAAI,kBAAkB;AACtB,UAAI,kBAAkB,SAAU,QAAQ,SAAS;AAChD,eAAO,kBAAa,SAAS,2BAA2B;AAAA,MACzD;AACA,UAAI,wBAAwB;AAE5B,UAAI,aAAa;AAAA,QAChB,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,QACN,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,MAAM;AAAA,QACN,OAAO;AAAA,QACP,KAAK;AAAA,QACL,OAAO;AAAA,MACR;AAEA,UAAI,cAAc;AAClB,UAAI,iBAAiB;AACrB,UAAI,gBAAgB;AACpB,UAAI,gBAAgB;AAEpB,UAAI,WAAW,wBAAwB,cAAc,OAAO,gBAAgB,cAC9D,cAAc,OAAO,iBAAiB;AASpD,eAAS,SAAS,KAAK,SAAS,OAAO;AACtC,YAAI,MAAM,IAAI,eAAe;AAC7B,YAAI,KAAK,OAAO,KAAK,IAAI;AACzB,YAAI,qBAAqB,WAAY;AACpC,cAAI,IAAI,cAAc,GAAG;AACxB,gBAAI,IAAI,SAAS,OAAO,IAAI,cAAc;AACzC,sBAAQ,IAAI,YAAY;AAAA,YACzB,OAAO;AACN,kBAAI,IAAI,UAAU,KAAK;AACtB,sBAAM,gBAAgB,IAAI,QAAQ,IAAI,UAAU,CAAC;AAAA,cAClD,OAAO;AACN,sBAAM,qBAAqB;AAAA,cAC5B;AAAA,YACD;AAAA,UACD;AAAA,QACD;AACA,YAAI,KAAK,IAAI;AAAA,MACd;AAUA,eAAS,WAAWG,QAAO;AAC1B,YAAI,IAAI,wCAAwC,KAAKA,UAAS,EAAE;AAChE,YAAI,GAAG;AACN,cAAI,QAAQ,OAAO,EAAE,CAAC,CAAC;AACvB,cAAI,QAAQ,EAAE,CAAC;AACf,cAAI,MAAM,EAAE,CAAC;AAEb,cAAI,CAAC,OAAO;AACX,mBAAO,CAAC,OAAO,KAAK;AAAA,UACrB;AACA,cAAI,CAAC,KAAK;AACT,mBAAO,CAAC,OAAO,MAAS;AAAA,UACzB;AACA,iBAAO,CAAC,OAAO,OAAO,GAAG,CAAC;AAAA,QAC3B;AACA,eAAO;AAAA,MACR;AAEA,MAAAH,OAAM,MAAM,IAAI,uBAAuB,SAAU,KAAK;AACrD,YAAI,YAAY,OAAO;AAAA,MACxB,CAAC;AAED,MAAAA,OAAM,MAAM,IAAI,uBAAuB,SAAU,KAAK;AACrD,YAAI;AAAA;AAAA,UAAqC,IAAI;AAAA;AAC7C,YAAI,IAAI,QAAQ,QAAQ,GAAG;AAC1B,cAAI,OAAO;AAEX,cAAI,aAAa,aAAa,cAAc;AAG5C,cAAI,OAAO,IAAI,YAAY,SAAS,cAAc,MAAM,CAAC;AACzD,eAAK,cAAc;AAEnB,cAAI,MAAM,IAAI,aAAa,UAAU;AAErC,cAAI,WAAW,IAAI;AACnB,cAAI,aAAa,QAAQ;AAGxB,gBAAI,aAAa,WAAW,KAAK,GAAG,KAAK,CAAC,EAAE,MAAM,GAAG,CAAC;AACtD,uBAAW,WAAW,SAAS,KAAK;AAAA,UACrC;AAGA,UAAAA,OAAM,KAAK,YAAY,MAAM,QAAQ;AACrC,UAAAA,OAAM,KAAK,YAAY,KAAK,QAAQ;AAGpC,cAAI,aAAaA,OAAM,QAAQ;AAC/B,cAAI,YAAY;AACf,uBAAW,cAAc,QAAQ;AAAA,UAClC;AAGA;AAAA,YACC;AAAA,YACA,SAAU,MAAM;AAEf,kBAAI,aAAa,aAAa,aAAa;AAG3C,kBAAIG,SAAQ,WAAW,IAAI,aAAa,YAAY,CAAC;AACrD,kBAAIA,QAAO;AACV,oBAAI,QAAQ,KAAK,MAAM,WAAW;AAGlC,oBAAI,QAAQA,OAAM,CAAC;AACnB,oBAAI,MAAMA,OAAM,CAAC,KAAK,OAAO,MAAM,SAASA,OAAM,CAAC;AAEnD,oBAAI,QAAQ,GAAG;AAAE,2BAAS,MAAM;AAAA,gBAAQ;AACxC,wBAAQ,KAAK,IAAI,GAAG,KAAK,IAAI,QAAQ,GAAG,MAAM,MAAM,CAAC;AACrD,oBAAI,MAAM,GAAG;AAAE,yBAAO,MAAM;AAAA,gBAAQ;AACpC,sBAAM,KAAK,IAAI,GAAG,KAAK,IAAI,KAAK,MAAM,MAAM,CAAC;AAE7C,uBAAO,MAAM,MAAM,OAAO,GAAG,EAAE,KAAK,IAAI;AAGxC,oBAAI,CAAC,IAAI,aAAa,YAAY,GAAG;AACpC,sBAAI,aAAa,cAAc,OAAO,QAAQ,CAAC,CAAC;AAAA,gBACjD;AAAA,cACD;AAGA,mBAAK,cAAc;AACnB,cAAAH,OAAM,iBAAiB,IAAI;AAAA,YAC5B;AAAA,YACA,SAAU,OAAO;AAEhB,kBAAI,aAAa,aAAa,aAAa;AAE3C,mBAAK,cAAc;AAAA,YACpB;AAAA,UACD;AAAA,QACD;AAAA,MACD,CAAC;AAED,MAAAA,OAAM,QAAQ,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAQ7B,WAAW,SAAS,UAAU,WAAW;AACxC,cAAI,YAAY,aAAa,UAAU,iBAAiB,QAAQ;AAEhE,mBAAS,IAAI,GAAG,SAAU,UAAU,SAAS,GAAG,KAAK;AACpD,YAAAA,OAAM,iBAAiB,OAAO;AAAA,UAC/B;AAAA,QACD;AAAA,MACD;AAEA,UAAI,SAAS;AAEb,MAAAA,OAAM,gBAAgB,WAAY;AACjC,YAAI,CAAC,QAAQ;AACZ,kBAAQ,KAAK,yFAAyF;AACtG,mBAAS;AAAA,QACV;AACA,QAAAA,OAAM,QAAQ,cAAc,UAAU,MAAM,MAAM,SAAS;AAAA,MAC5D;AAAA,IAED,GAAE;AAAA;AAAA;;;ACz5DF;AAAA;AAAA,KAAC,SAAUI,QAAO;AAEjB,MAAAA,OAAM,UAAU,aAAaA,OAAM,UAAU,OAAO,cAAc;AAAA,QACjE,cAAc;AAAA,UACb,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,QAAQ;AAAA,UACR,QAAQ;AAAA;AAAA,QACT;AAAA,QACA,WAAW;AAAA,MACZ,CAAC;AAGD,MAAAA,OAAM,UAAU,WAAW,QAAQ;AAAA,QAClC;AAAA;AAAA,QAEA;AAAA;AAAA,QAEA;AAAA,MACD;AAGA,aAAOA,OAAM,UAAU,WAAW,WAAW;AAC7C,aAAOA,OAAM,UAAU,WAAW,kBAAkB;AAGpD,UAAI,aAAaA,OAAM,UAAU,OAAO,cAAc,CAAC,CAAC;AACxD,aAAO,WAAW,YAAY;AAE9B,MAAAA,OAAM,UAAU,WAAW,YAAY,EAAE,SAAS;AAElD,MAAAA,OAAM,UAAU,aAAa,cAAc,YAAY;AAAA,QACtD,aAAa;AAAA,UACZ,SAAS;AAAA,UACT,QAAQ;AAAA,YACP,MAAM;AAAA,cACL,SAAS;AAAA,cACT,OAAO;AAAA,YACR;AAAA,YACA,YAAY;AAAA,UACb;AAAA,QACD;AAAA,QACA,oBAAoB;AAAA;AAAA,UAEnB,SAAS;AAAA,UACT,QAAQ;AAAA,UACR,QAAQ;AAAA,YACP,YAAY;AAAA,YACZ,WAAW;AAAA,cACV,SAAS;AAAA;AAAA,cACT,OAAO;AAAA,cACP,QAAQ;AAAA,YACT;AAAA,UACD;AAAA,QACD;AAAA,MACD,CAAC;AAED,MAAAA,OAAM,UAAU,KAAKA,OAAM,UAAU;AAAA,IAEtC,GAAE,KAAK;AAAA;AAAA;;;AC3DP;AAAA;AAAA,KAAC,SAAUC,QAAO;AACjB,UAAI,aAAaA,OAAM,KAAK,MAAMA,OAAM,UAAU,UAAU;AAC5D,MAAAA,OAAM,UAAU,MAAMA,OAAM,UAAU,OAAO,OAAO,UAAU;AAG9D,aAAOA,OAAM,UAAU,IAAI,WAAW;AACtC,aAAOA,OAAM,UAAU,IAAI,kBAAkB;AAK7C,UAAI,MAAMA,OAAM,UAAU,IAAI;AAC9B,UAAI,UAAU,OAAO,qBAAqB,SAAS,QAAQ,IAAI,QAAQ,SAAS,KAAK,IAAI,QAAQ,KAAK;AACtG,UAAI,aAAa;AAAA,IAClB,GAAE,KAAK;AAAA;AAAA;;;ACdP;AAAA;AACA,UAAM,UAAU,OAAO;AAAA,MACtB,YAAY;AAAA,QACX,SAAS;AAAA,QACT,YAAY;AAAA,QACZ,QAAQ;AAAA,MACT;AAAA,MACA,UAAU;AAAA,QACT,SAAS;AAAA,QACT,YAAY;AAAA,QACZ,QAAQ;AAAA,MACT;AAAA,MACA,WAAW;AAAA,QACV,SAAS;AAAA,QACT,QAAQ;AAAA,MACT;AAAA,MACA,UAAU;AAAA,MACV,eAAe;AAAA,MACf,YAAY;AAAA,MACZ,WAAW;AAAA,MACX,QAAQ;AAAA,QACP,SAAS;AAAA,QACT,OAAO;AAAA,MACR;AAAA,IACD;AAEA,UAAM,UAAU,cAAc,MAAM,UAAU;AAAA;AAAA;;;AC1B9C;AAAA;AAAA;AAAA,MACE,WAAa;AAAA,QACX,UAAY;AAAA,UACV,MAAQ;AAAA,UACR,QAAU;AAAA,UACV,MAAQ;AAAA,QACV;AAAA,QACA,QAAU;AAAA,UACR,WAAW;AAAA,UACX,YAAY;AAAA,UACZ,eAAe;AAAA,UACf,QAAU;AAAA,QACZ;AAAA,MACF;AAAA,MACA,YAAc;AAAA,QACZ,QAAU;AAAA,UACR,SAAW;AAAA,UACX,QAAU;AAAA,QACZ;AAAA,QACA,OAAS;AAAA,UACP,OAAS;AAAA,QACX;AAAA,QACA,MAAQ;AAAA,UACN,OAAS;AAAA,QACX;AAAA,MACF;AAAA,MACA,QAAU;AAAA,QACR,OAAS;AAAA,UACP,SAAW;AAAA,UACX,gBAAgB;AAAA,UAChB,sBAAsB;AAAA,UACtB,eAAe;AAAA,UACf,OAAS;AAAA,UACT,gBAAgB;AAAA,UAChB,cAAc;AAAA,UACd,UAAY;AAAA,YACV,MAAQ;AAAA,YACR,UAAY;AAAA,YACZ,OAAS;AAAA,UACX;AAAA,QACF;AAAA,QACA,QAAU;AAAA,UACR,MAAQ;AAAA,UACR,OAAS;AAAA,UACT,QAAU;AAAA,UACV,OAAS;AAAA,QACX;AAAA,QACA,OAAS;AAAA,UACP,SAAW;AAAA,UACX,MAAQ;AAAA,UACR,MAAQ;AAAA,UACR,cAAc;AAAA,UACd,OAAS;AAAA,QACX;AAAA,MACF;AAAA,MACA,OAAS;AAAA,QACP,SAAW;AAAA,UACT,MAAQ;AAAA,UACR,eAAe;AAAA,UACf,OAAS;AAAA,UACT,OAAS;AAAA,UACT,OAAS;AAAA,UACT,QAAU;AAAA,UACV,aAAa;AAAA,UACb,KAAO;AAAA,UACP,gBAAgB;AAAA,UAChB,QAAU;AAAA,QACZ;AAAA,QACA,WAAa;AAAA,UACX,eAAe;AAAA,UACf,eAAe;AAAA,UACf,iBAAiB;AAAA,UACjB,QAAU;AAAA,UACV,WAAa;AAAA,UACb,cAAc;AAAA,UACd,cAAc;AAAA,UACd,MAAQ;AAAA,UACR,eAAe;AAAA,UACf,eAAe;AAAA,UACf,OAAS;AAAA,QACX;AAAA,QACA,MAAQ;AAAA,UACN,KAAK;AAAA,UACL,KAAK;AAAA,UACL,KAAK;AAAA,UACL,KAAK;AAAA,UACL,KAAK;AAAA,QACP;AAAA,QACA,eAAiB;AAAA,UACf,aAAa;AAAA,YACX,OAAS;AAAA,YACT,YAAc;AAAA,UAChB;AAAA,UACA,YAAY;AAAA,YACV,MAAQ;AAAA,YACR,QAAU;AAAA,UACZ;AAAA,UACA,UAAY;AAAA,UACZ,UAAY;AAAA,QACd;AAAA,QACA,YAAY;AAAA,UACV,aAAe;AAAA,YACb,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,UACR;AAAA,UACA,SAAW;AAAA,YACT,YAAc;AAAA,UAChB;AAAA,UACA,QAAU;AAAA,YACR,cAAc;AAAA,YACd,cAAc;AAAA,YACd,mBAAmB;AAAA,YACnB,UAAY;AAAA,YACZ,QAAU;AAAA,YACV,cAAc;AAAA,YACd,cAAc;AAAA,UAChB;AAAA,UACA,UAAY;AAAA,YACV,KAAO;AAAA,YACP,UAAY;AAAA,YACZ,MAAQ;AAAA,YACR,UAAY;AAAA,UACd;AAAA,UACA,aAAa;AAAA,YACX,OAAS;AAAA,YACT,WAAa;AAAA,YACb,KAAO;AAAA,YACP,QAAU;AAAA,UACZ;AAAA,UACA,QAAU;AAAA,YACR,aAAe;AAAA,cACb,KAAK;AAAA,cACL,KAAK;AAAA,cACL,KAAK;AAAA,cACL,KAAK;AAAA,cACL,KAAK;AAAA,cACL,KAAK;AAAA,cACL,KAAK;AAAA,cACL,KAAK;AAAA,cACL,KAAK;AAAA,cACL,MAAM;AAAA,cACN,MAAM;AAAA,cACN,MAAM;AAAA,YACR;AAAA,YACA,QAAU;AAAA,cACR,cAAc;AAAA,cACd,cAAc;AAAA,cACd,mBAAmB;AAAA,cACnB,UAAY;AAAA,cACZ,QAAU;AAAA,cACV,cAAc;AAAA,cACd,cAAc;AAAA,YAChB;AAAA,YACA,UAAY;AAAA,cACV,KAAO;AAAA,cACP,UAAY;AAAA,cACZ,MAAQ;AAAA,cACR,UAAY;AAAA,YACd;AAAA,YACA,aAAa;AAAA,cACX,OAAS;AAAA,cACT,WAAa;AAAA,cACb,KAAO;AAAA,cACP,QAAU;AAAA,YACZ;AAAA,UACF;AAAA,UACA,KAAO;AAAA,YACL,aAAe;AAAA,YACf,SAAW;AAAA,YACX,gBAAgB;AAAA,YAChB,gBAAgB;AAAA,YAChB,kBAAkB;AAAA,YAClB,kBAAkB;AAAA,YAClB,UAAY;AAAA,cACV,MAAQ;AAAA,gBACN,iBAAiB;AAAA,gBACjB,eAAe;AAAA,gBACf,eAAe;AAAA,gBACf,0BAA0B;AAAA,gBAC1B,wBAAwB;AAAA,gBACxB,wBAAwB;AAAA,cAC1B;AAAA,YACF;AAAA,YACA,QAAU;AAAA,cACR,aAAe;AAAA,cACf,SAAW;AAAA,cACX,gBAAgB;AAAA,cAChB,gBAAgB;AAAA,cAChB,kBAAkB;AAAA,cAClB,kBAAkB;AAAA,YACpB;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAAA,MACA,WAAa;AAAA,QACX,QAAU;AAAA,UACR,SAAW;AAAA,YACT,QAAU;AAAA,cACR,UAAY;AAAA,cACZ,YAAc;AAAA,YAChB;AAAA,YACA,SAAW;AAAA,cACT,UAAY;AAAA,cACZ,YAAc;AAAA,YAChB;AAAA,UACF;AAAA,UACA,QAAU;AAAA,YACR,MAAQ;AAAA,UACV;AAAA,QACF;AAAA,QACA,MAAQ;AAAA,UACN,OAAS;AAAA,YACP,cAAc;AAAA,YACd,SAAW;AAAA,UACb;AAAA,UACA,UAAY;AAAA,YACV,MAAQ;AAAA,YACR,iBAAiB;AAAA,UACnB;AAAA,QACF;AAAA,QACA,MAAQ;AAAA,UACN,SAAW;AAAA,YACT,QAAU;AAAA,YACV,SAAW;AAAA,UACb;AAAA,UACA,kBAAkB;AAAA,QACpB;AAAA,QACA,OAAS;AAAA,UACP,SAAW;AAAA,YACT,QAAU;AAAA,YACV,SAAW;AAAA,UACb;AAAA,QACF;AAAA,QACA,YAAc;AAAA,UACZ,SAAW;AAAA,YACT,eAAe;AAAA,YACf,gBAAgB;AAAA,UAClB;AAAA,UACA,eAAe;AAAA,YACb,QAAU;AAAA,YACV,SAAW;AAAA,UACb;AAAA,QACF;AAAA,QACA,gBAAgB;AAAA,UACd,gBAAgB;AAAA,YACd,UAAY;AAAA,YACZ,YAAc;AAAA,UAChB;AAAA,UACA,cAAc;AAAA,QAChB;AAAA,QACA,YAAc;AAAA,UACZ,eAAe;AAAA,UACf,aAAa;AAAA,UACb,wBAAwB;AAAA,QAC1B;AAAA,QACA,aAAa;AAAA,UACX,KAAO;AAAA,UACP,aAAa;AAAA,QACf;AAAA,QACA,SAAW;AAAA,UACT,eAAe;AAAA,UACf,sBAAsB;AAAA,UACtB,YAAY;AAAA,UACZ,mBAAmB;AAAA,QACrB;AAAA,QACA,UAAY;AAAA,UACV,aAAa;AAAA,UACb,qBAAqB;AAAA,UACrB,2BAA2B;AAAA,UAC3B,mBAAmB;AAAA,UACnB,yBAAyB;AAAA,UACzB,aAAa;AAAA,QACf;AAAA,QACA,QAAU;AAAA,UACR,kBAAkB;AAAA,UAClB,eAAe;AAAA,UACf,uBAAuB;AAAA,UACvB,oBAAoB;AAAA,UACpB,kBAAkB;AAAA,QACpB;AAAA,QACA,MAAQ;AAAA,UACN,sBAAsB;AAAA,QACxB;AAAA,QACA,KAAO;AAAA,UACL,sBAAsB;AAAA,QACxB;AAAA,QACA,MAAQ;AAAA,UACN,gBAAgB;AAAA,UAChB,uBAAuB;AAAA,UACvB,sBAAsB;AAAA,QACxB;AAAA,QACA,SAAW;AAAA,QACX,YAAc;AAAA,UACZ,UAAY;AAAA,YACV,gBAAgB;AAAA,YAChB,eAAe;AAAA,UACjB;AAAA,QACF;AAAA,QACA,UAAY;AAAA,QACZ,OAAS;AAAA,UACP,mBAAmB;AAAA,UACnB,eAAe;AAAA,QACjB;AAAA,QACA,QAAU;AAAA,QACV,MAAQ;AAAA,QACR,MAAQ;AAAA,QACR,YAAc;AAAA,MAChB;AAAA,MACA,QAAU;AAAA,QACR,SAAW;AAAA,UACT,YAAc;AAAA,YACZ,SAAW;AAAA,YACX,OAAS;AAAA,YACT,QAAU;AAAA,YACV,UAAY;AAAA,UACd;AAAA,UACA,MAAQ;AAAA,YACN,SAAW;AAAA,YACX,UAAY;AAAA,UACd;AAAA,UACA,QAAU;AAAA,YACR,SAAW;AAAA,YACX,OAAS;AAAA,UACX;AAAA,QACF;AAAA,QACA,WAAa;AAAA,UACX,YAAc;AAAA,YACZ,SAAW;AAAA,YACX,OAAS;AAAA,YACT,OAAS;AAAA,YACT,QAAU;AAAA,UACZ;AAAA,UACA,MAAQ;AAAA,YACN,SAAW;AAAA,UACb;AAAA,UACA,QAAU;AAAA,YACR,SAAW;AAAA,UACb;AAAA,QACF;AAAA,QACA,SAAW;AAAA,UACT,2BAA2B;AAAA,UAC3B,6BAA6B;AAAA,UAC7B,4BAA4B;AAAA,UAC5B,8BAA8B;AAAA,QAChC;AAAA,QACA,QAAU;AAAA,UACR,OAAS;AAAA,UACT,QAAU;AAAA,QACZ;AAAA,QACA,QAAU;AAAA,UACR,MAAQ;AAAA,QACV;AAAA,QACA,YAAc;AAAA,UACZ,QAAU;AAAA,QACZ;AAAA,MACF;AAAA,MACA,MAAQ;AAAA,QACN,YAAc;AAAA,UACZ,SAAW;AAAA,QACb;AAAA,QACA,QAAU;AAAA,UACR,SAAW;AAAA,UACX,OAAS;AAAA,UACT,QAAU;AAAA,QACZ;AAAA,QACA,MAAQ;AAAA,UACN,SAAW;AAAA,UACX,aAAe;AAAA,UACf,MAAQ;AAAA,QACV;AAAA,QACA,SAAW;AAAA,UACT,kBAAkB;AAAA,UAClB,mBAAmB;AAAA,UACnB,kBAAkB;AAAA,QACpB;AAAA,QACA,gBAAgB;AAAA,UACd,SAAW;AAAA,UACX,QAAU;AAAA,QACZ;AAAA,QACA,QAAU;AAAA,UACR,SAAW;AAAA,UACX,OAAS;AAAA,QACX;AAAA,MACF;AAAA,MACA,MAAQ;AAAA,QACN,OAAS;AAAA,UACP,YAAc;AAAA,YACZ,SAAW;AAAA,YACX,OAAS;AAAA,YACT,UAAY;AAAA,YACZ,OAAS;AAAA,UACX;AAAA,UACA,QAAU;AAAA,YACR,SAAW;AAAA,YACX,OAAS;AAAA,YACT,OAAS;AAAA,YACT,UAAY;AAAA,UACd;AAAA,UACA,MAAQ;AAAA,YACN,SAAW;AAAA,YACX,aAAe;AAAA,YACf,UAAY;AAAA,UACd;AAAA,QACF;AAAA,QACA,OAAS;AAAA,UACP,MAAQ;AAAA,YACN,SAAW;AAAA,YACX,UAAY;AAAA,UACd;AAAA,UACA,YAAc;AAAA,YACZ,QAAU;AAAA,UACZ;AAAA,QACF;AAAA,QACA,OAAS;AAAA,UACP,MAAQ;AAAA,YACN,SAAW;AAAA,UACb;AAAA,UACA,YAAc;AAAA,YACZ,QAAU;AAAA,UACZ;AAAA,QACF;AAAA,QACA,MAAQ;AAAA,UACN,MAAQ;AAAA,YACN,SAAW;AAAA,UACb;AAAA,QACF;AAAA,QACA,SAAW;AAAA,UACT,iBAAiB;AAAA,UACjB,oBAAoB;AAAA,UACpB,iBAAiB;AAAA,UACjB,0BAA0B;AAAA,QAC5B;AAAA,QACA,QAAU;AAAA,UACR,iBAAiB;AAAA,UACjB,eAAe;AAAA,UACf,QAAU;AAAA,QACZ;AAAA,MACF;AAAA,MACA,KAAO;AAAA,QACL,SAAW;AAAA,UACT,YAAc;AAAA,UACd,QAAU;AAAA,UACV,MAAQ;AAAA,QACV;AAAA,QACA,OAAS;AAAA,UACP,YAAc;AAAA,UACd,QAAU;AAAA,UACV,MAAQ;AAAA,QACV;AAAA,QACA,MAAQ;AAAA,UACN,YAAc;AAAA,UACd,QAAU;AAAA,UACV,MAAQ;AAAA,QACV;AAAA,QACA,OAAS;AAAA,UACP,YAAc;AAAA,UACd,QAAU;AAAA,UACV,MAAQ;AAAA,QACV;AAAA,QACA,cAAc;AAAA,UACZ,YAAc;AAAA,UACd,QAAU;AAAA,UACV,MAAQ;AAAA,QACV;AAAA,QACA,MAAQ;AAAA,UACN,YAAc;AAAA,UACd,QAAU;AAAA,UACV,MAAQ;AAAA,QACV;AAAA,QACA,QAAU;AAAA,UACR,YAAc;AAAA,UACd,QAAU;AAAA,UACV,MAAQ;AAAA,QACV;AAAA,QACA,MAAQ;AAAA,UACN,YAAc;AAAA,UACd,QAAU;AAAA,UACV,MAAQ;AAAA,QACV;AAAA,QACA,KAAO;AAAA,UACL,YAAc;AAAA,UACd,QAAU;AAAA,UACV,MAAQ;AAAA,QACV;AAAA,QACA,QAAU;AAAA,UACR,YAAc;AAAA,UACd,QAAU;AAAA,UACV,MAAQ;AAAA,QACV;AAAA,QACA,QAAU;AAAA,UACR,YAAc;AAAA,UACd,QAAU;AAAA,UACV,MAAQ;AAAA,QACV;AAAA,MACF;AAAA,MACA,SAAW;AAAA,QACT,WAAa;AAAA,UACX,UAAY;AAAA,YACV,MAAQ;AAAA,YACR,QAAU;AAAA,YACV,MAAQ;AAAA,UACV;AAAA,UACA,MAAQ;AAAA,YACN,MAAQ;AAAA,YACR,QAAU;AAAA,YACV,MAAQ;AAAA,UACV;AAAA,UACA,QAAU;AAAA,YACR,MAAQ;AAAA,YACR,QAAU;AAAA,YACV,MAAQ;AAAA,UACV;AAAA,UACA,SAAW;AAAA,YACT,MAAQ;AAAA,YACR,QAAU;AAAA,YACV,MAAQ;AAAA,UACV;AAAA,QACF;AAAA,QACA,SAAW;AAAA,UACT,OAAS;AAAA,YACP,UAAY;AAAA,cACV,MAAQ;AAAA,cACR,QAAU;AAAA,cACV,MAAQ;AAAA,YACV;AAAA,YACA,MAAQ;AAAA,cACN,MAAQ;AAAA,cACR,QAAU;AAAA,cACV,MAAQ;AAAA,YACV;AAAA,YACA,QAAU;AAAA,cACR,MAAQ;AAAA,cACR,QAAU;AAAA,cACV,MAAQ;AAAA,YACV;AAAA,YACA,SAAW;AAAA,cACT,MAAQ;AAAA,cACR,QAAU;AAAA,cACV,MAAQ;AAAA,YACV;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAAA,MACA,MAAQ;AAAA,QACN,MAAQ;AAAA,UACN,OAAS;AAAA,UACT,QAAU;AAAA,UACV,OAAS;AAAA,UACT,eAAe;AAAA,UACf,eAAe;AAAA,QACjB;AAAA,QACA,MAAQ;AAAA,UACN,SAAW;AAAA,YACT,OAAS;AAAA,YACT,QAAU;AAAA,YACV,OAAS;AAAA,UACX;AAAA,UACA,eAAe;AAAA,YACb,IAAM;AAAA,YACN,IAAM;AAAA,YACN,IAAM;AAAA,YACN,IAAM;AAAA,YACN,IAAM;AAAA,YACN,OAAO;AAAA,YACP,OAAO;AAAA,UACT;AAAA,QACF;AAAA,QACA,QAAU;AAAA,UACR,cAAc;AAAA,YACZ,QAAU;AAAA,YACV,SAAW;AAAA,UACb;AAAA,QACF;AAAA,MACF;AAAA,MACA,QAAU;AAAA,QACR,WAAa;AAAA,UACX,aAAa;AAAA,QACf;AAAA,QACA,QAAU;AAAA,UACR,MAAQ;AAAA,UACR,MAAQ;AAAA,UACR,OAAS;AAAA,UACT,SAAW;AAAA,UACX,SAAW;AAAA,QACb;AAAA,QACA,QAAU;AAAA,UACR,iBAAiB;AAAA,UACjB,qBAAqB;AAAA,QACvB;AAAA,QACA,KAAO;AAAA,UACL,SAAW;AAAA,UACX,OAAS;AAAA,QACX;AAAA,MACF;AAAA,MACA,YAAc;AAAA,QACZ,OAAS;AAAA,QACT,aAAa;AAAA,QACb,QAAU;AAAA,QACV,OAAS;AAAA,QACT,QAAU;AAAA,QACV,SAAW;AAAA,MACb;AAAA,MACA,MAAQ;AAAA,QACN,cAAc;AAAA,QACd,QAAU;AAAA,QACV,eAAe;AAAA,MACjB;AAAA,MACA,UAAY;AAAA,QACV,eAAe;AAAA,UACb,SAAW;AAAA,UACX,WAAa;AAAA,UACb,QAAU;AAAA,UACV,SAAW;AAAA,UACX,SAAW;AAAA,UACX,OAAS;AAAA,QACX;AAAA,MACF;AAAA,MACA,UAAY;AAAA,QACV,gBAAgB;AAAA,UACd,SAAW;AAAA,UACX,WAAa;AAAA,UACb,SAAW;AAAA,QACb;AAAA,QACA,iBAAiB;AAAA,UACf,SAAW;AAAA,UACX,WAAa;AAAA,UACb,SAAW;AAAA,QACb;AAAA,QACA,gBAAgB;AAAA,UACd,SAAW;AAAA,UACX,WAAa;AAAA,UACb,SAAW;AAAA,QACb;AAAA,QACA,SAAW;AAAA,UACT,MAAQ;AAAA,YACN,YAAc;AAAA,cACZ,OAAS;AAAA,cACT,SAAW;AAAA,cACX,SAAW;AAAA,cACX,UAAY;AAAA,cACZ,UAAY;AAAA,YACd;AAAA,YACA,QAAU;AAAA,cACR,SAAW;AAAA,cACX,OAAS;AAAA,cACT,OAAS;AAAA,cACT,SAAW;AAAA,YACb;AAAA,YACA,MAAQ;AAAA,cACN,SAAW;AAAA,cACX,aAAe;AAAA,cACf,UAAY;AAAA,cACZ,OAAS;AAAA,YACX;AAAA,UACF;AAAA,UACA,YAAc;AAAA,YACZ,YAAc;AAAA,cACZ,QAAU;AAAA,cACV,QAAU;AAAA,cACV,SAAW;AAAA,YACb;AAAA,YACA,MAAQ;AAAA,cACN,SAAW;AAAA,cACX,WAAa;AAAA,cACb,QAAU;AAAA,YACZ;AAAA,YACA,QAAU;AAAA,cACR,OAAS;AAAA,cACT,QAAU;AAAA,cACV,QAAU;AAAA,YACZ;AAAA,UACF;AAAA,UACA,SAAW;AAAA,YACT,YAAc;AAAA,cACZ,SAAW;AAAA,cACX,WAAa;AAAA,cACb,UAAY;AAAA,YACd;AAAA,YACA,MAAQ;AAAA,cACN,SAAW;AAAA,cACX,WAAa;AAAA,cACb,UAAY;AAAA,YACd;AAAA,YACA,QAAU;AAAA,cACR,MAAQ;AAAA,cACR,WAAa;AAAA,cACb,QAAU;AAAA,YACZ;AAAA,UACF;AAAA,QACF;AAAA,QACA,QAAU;AAAA,UACR,SAAW;AAAA,UACX,WAAa;AAAA,UACb,SAAW;AAAA,UACX,SAAW;AAAA,UACX,SAAW;AAAA,UACX,MAAQ;AAAA,QACV;AAAA,QACA,SAAW;AAAA,UACT,WAAa;AAAA,YACX,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,UACP;AAAA,UACA,aAAe;AAAA,YACb,SAAW;AAAA,YACX,OAAS;AAAA,YACT,QAAU;AAAA,YACV,UAAY;AAAA,UACd;AAAA,QACF;AAAA,QACA,YAAY;AAAA,UACV,QAAU;AAAA,YACR,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,MAAM;AAAA,YACN,MAAM;AAAA,YACN,MAAM;AAAA,UACR;AAAA,UACA,QAAU;AAAA,YACR,cAAc;AAAA,YACd,cAAc;AAAA,YACd,mBAAmB;AAAA,YACnB,UAAY;AAAA,YACZ,QAAU;AAAA,YACV,cAAc;AAAA,YACd,cAAc;AAAA,UAChB;AAAA,UACA,UAAY;AAAA,YACV,KAAO;AAAA,YACP,UAAY;AAAA,YACZ,MAAQ;AAAA,YACR,UAAY;AAAA,UACd;AAAA,UACA,aAAa;AAAA,YACX,OAAS;AAAA,YACT,WAAa;AAAA,YACb,KAAO;AAAA,YACP,QAAU;AAAA,UACZ;AAAA,UACA,QAAU;AAAA,YACR,QAAU;AAAA,cACR,KAAK;AAAA,cACL,KAAK;AAAA,cACL,KAAK;AAAA,cACL,KAAK;AAAA,cACL,KAAK;AAAA,cACL,KAAK;AAAA,cACL,KAAK;AAAA,cACL,KAAK;AAAA,cACL,KAAK;AAAA,cACL,MAAM;AAAA,cACN,MAAM;AAAA,cACN,MAAM;AAAA,YACR;AAAA,YACA,QAAU;AAAA,cACR,cAAc;AAAA,cACd,cAAc;AAAA,cACd,mBAAmB;AAAA,cACnB,UAAY;AAAA,cACZ,QAAU;AAAA,cACV,cAAc;AAAA,cACd,cAAc;AAAA,YAChB;AAAA,YACA,UAAY;AAAA,cACV,KAAO;AAAA,cACP,UAAY;AAAA,cACZ,MAAQ;AAAA,cACR,UAAY;AAAA,YACd;AAAA,YACA,aAAa;AAAA,cACX,OAAS;AAAA,cACT,WAAa;AAAA,cACb,KAAO;AAAA,cACP,QAAU;AAAA,YACZ;AAAA,UACF;AAAA,QACF;AAAA,QACA,cAAgB;AAAA,UACd,gBAAgB;AAAA,YACd,MAAQ;AAAA,cACN,YAAc;AAAA,cACd,SAAW;AAAA,gBACT,YAAc;AAAA,gBACd,MAAQ;AAAA,cACV;AAAA,cACA,QAAU;AAAA,gBACR,YAAc;AAAA,gBACd,MAAQ;AAAA,cACV;AAAA,YACF;AAAA,YACA,OAAS;AAAA,cACP,YAAc;AAAA,cACd,QAAU;AAAA,cACV,SAAW;AAAA,gBACT,MAAQ;AAAA,cACV;AAAA,YACF;AAAA,UACF;AAAA,UACA,qBAAqB;AAAA,YACnB,aAAe;AAAA,cACb,SAAW;AAAA,cACX,OAAS;AAAA,cACT,QAAU;AAAA,cACV,UAAY;AAAA,YACd;AAAA,YACA,QAAU;AAAA,cACR,SAAW;AAAA,gBACT,YAAc;AAAA,gBACd,OAAS;AAAA,gBACT,QAAU;AAAA,cACZ;AAAA,cACA,WAAa;AAAA,gBACX,YAAc;AAAA,gBACd,QAAU;AAAA,gBACV,OAAS;AAAA,cACX;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,QACA,OAAS;AAAA,UACP,MAAQ;AAAA,YACN,SAAW;AAAA,YACX,WAAa;AAAA,YACb,SAAW;AAAA,YACX,OAAS;AAAA,UACX;AAAA,UACA,MAAQ;AAAA,YACN,SAAW;AAAA,YACX,OAAS;AAAA,YACT,QAAU;AAAA,YACV,SAAW;AAAA,UACb;AAAA,UACA,OAAS;AAAA,YACP,YAAc;AAAA,YACd,MAAQ;AAAA,UACV;AAAA,UACA,QAAU;AAAA,YACR,SAAW;AAAA,YACX,WAAa;AAAA,UACf;AAAA,UACA,OAAS;AAAA,UACT,MAAQ;AAAA,YACN,QAAU;AAAA,YACV,YAAc;AAAA,UAChB;AAAA,UACA,OAAS;AAAA,YACP,QAAU;AAAA,YACV,eAAe;AAAA,UACjB;AAAA,UACA,QAAU;AAAA,YACR,eAAe;AAAA,UACjB;AAAA,UACA,QAAU;AAAA,YACR,SAAW;AAAA,cACT,YAAc;AAAA,cACd,MAAQ;AAAA,cACR,OAAS;AAAA,cACT,QAAU;AAAA,cACV,QAAU;AAAA,YACZ;AAAA,YACA,WAAa;AAAA,cACX,YAAc;AAAA,cACd,oBAAoB;AAAA,cACpB,QAAU;AAAA,cACV,MAAQ;AAAA,cACR,OAAS;AAAA,cACT,QAAU;AAAA,cACV,QAAU;AAAA,YACZ;AAAA,YACA,SAAW;AAAA,cACT,YAAc;AAAA,cACd,MAAQ;AAAA,cACR,OAAS;AAAA,cACT,QAAU;AAAA,cACV,QAAU;AAAA,YACZ;AAAA,YACA,SAAW;AAAA,cACT,YAAc;AAAA,cACd,OAAS;AAAA,cACT,QAAU;AAAA,cACV,QAAU;AAAA,YACZ;AAAA,YACA,OAAS;AAAA,cACP,YAAc;AAAA,cACd,OAAS;AAAA,cACT,QAAU;AAAA,cACV,QAAU;AAAA,YACZ;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAAA,MACA,QAAU;AAAA,QACR,QAAU;AAAA,UACR,SAAW;AAAA,UACX,WAAa;AAAA,UACb,SAAW;AAAA,UACX,OAAS;AAAA,QACX;AAAA,QACA,MAAQ;AAAA,UACN,SAAW;AAAA,UACX,OAAS;AAAA,QACX;AAAA,MACF;AAAA,MACA,iBAAiB;AAAA,QACf,OAAS;AAAA,QACT,QAAU;AAAA,QACV,OAAS;AAAA,MACX;AAAA,MACA,gBAAgB;AAAA,QACd,OAAS;AAAA,QACT,QAAU;AAAA,QACV,gBAAgB;AAAA,MAClB;AAAA,MACA,oBAAoB;AAAA,QAClB,cAAc;AAAA,QACd,iBAAiB;AAAA,MACnB;AAAA,MACA,WAAa;AAAA,QACX,MAAQ;AAAA,QACR,KAAO;AAAA,QACP,QAAU;AAAA,QACV,MAAQ;AAAA,MACV;AAAA,MACA,SAAW;AAAA,QACT,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,MACP;AAAA,MACA,sBAAsB;AAAA,QACpB,KAAK;AAAA,UACH,QAAU;AAAA,UACV,QAAU;AAAA,QACZ;AAAA,QACA,KAAK;AAAA,UACH,QAAU;AAAA,UACV,QAAU;AAAA,QACZ;AAAA,QACA,KAAK;AAAA,UACH,QAAU;AAAA,UACV,QAAU;AAAA,QACZ;AAAA,QACA,KAAK;AAAA,UACH,QAAU;AAAA,UACV,QAAU;AAAA,QACZ;AAAA,QACA,KAAK;AAAA,UACH,QAAU;AAAA,UACV,QAAU;AAAA,QACZ;AAAA,QACA,KAAK;AAAA,UACH,QAAU;AAAA,UACV,QAAU;AAAA,QACZ;AAAA,QACA,KAAK;AAAA,UACH,QAAU;AAAA,UACV,QAAU;AAAA,QACZ;AAAA,QACA,KAAK;AAAA,UACH,QAAU;AAAA,UACV,QAAU;AAAA,QACZ;AAAA,QACA,KAAK;AAAA,UACH,QAAU;AAAA,UACV,QAAU;AAAA,QACZ;AAAA,QACA,KAAK;AAAA,UACH,QAAU;AAAA,UACV,QAAU;AAAA,QACZ;AAAA,MACF;AAAA,MACA,OAAS;AAAA,QACP,OAAS;AAAA,UACP,UAAY;AAAA,YACV,QAAU;AAAA,cACR,SAAW;AAAA,cACX,WAAa;AAAA,cACb,SAAW;AAAA,cACX,SAAW;AAAA,cACX,SAAW;AAAA,cACX,MAAQ;AAAA,YACV;AAAA,YACA,SAAW;AAAA,cACT,YAAc;AAAA,gBACZ,SAAW;AAAA,gBACX,WAAa;AAAA,gBACb,UAAY;AAAA,cACd;AAAA,cACA,MAAQ;AAAA,gBACN,SAAW;AAAA,gBACX,WAAa;AAAA,gBACb,UAAY;AAAA,gBACZ,SAAW;AAAA,cACb;AAAA,cACA,QAAU;AAAA,gBACR,SAAW;AAAA,gBACX,QAAU;AAAA,gBACV,QAAU;AAAA,cACZ;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,QACA,MAAQ;AAAA,UACN,UAAY;AAAA,YACV,QAAU;AAAA,cACR,SAAW;AAAA,cACX,WAAa;AAAA,cACb,SAAW;AAAA,cACX,SAAW;AAAA,cACX,SAAW;AAAA,cACX,MAAQ;AAAA,YACV;AAAA,YACA,SAAW;AAAA,cACT,YAAc;AAAA,gBACZ,SAAW;AAAA,gBACX,WAAa;AAAA,gBACb,UAAY;AAAA,cACd;AAAA,cACA,MAAQ;AAAA,gBACN,SAAW;AAAA,gBACX,WAAa;AAAA,gBACb,UAAY;AAAA,gBACZ,SAAW;AAAA,cACb;AAAA,cACA,QAAU;AAAA,gBACR,SAAW;AAAA,gBACX,QAAU;AAAA,gBACV,QAAU;AAAA,cACZ;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAAA,MACA,MAAQ;AAAA,QACN,QAAU;AAAA,UACR,MAAQ;AAAA,UACR,UAAY;AAAA,UACZ,OAAS;AAAA,QACX;AAAA,QACA,QAAU;AAAA,UACR,QAAU;AAAA,UACV,MAAQ;AAAA,UACR,OAAS;AAAA,QACX;AAAA,QACA,MAAQ;AAAA,UACN,MAAM;AAAA,YACJ,SAAW;AAAA,YACX,QAAU;AAAA,YACV,QAAU;AAAA,YACV,OAAS;AAAA,UACX;AAAA,UACA,MAAM;AAAA,YACJ,SAAW;AAAA,YACX,QAAU;AAAA,YACV,QAAU;AAAA,YACV,OAAS;AAAA,UACX;AAAA,UACA,MAAM;AAAA,YACJ,SAAW;AAAA,YACX,QAAU;AAAA,YACV,QAAU;AAAA,YACV,OAAS;AAAA,UACX;AAAA,UACA,MAAM;AAAA,YACJ,SAAW;AAAA,YACX,QAAU;AAAA,YACV,QAAU;AAAA,YACV,OAAS;AAAA,UACX;AAAA,UACA,MAAM;AAAA,YACJ,SAAW;AAAA,YACX,QAAU;AAAA,YACV,QAAU;AAAA,YACV,OAAS;AAAA,UACX;AAAA,UACA,MAAM;AAAA,YACJ,SAAW;AAAA,YACX,QAAU;AAAA,YACV,QAAU;AAAA,YACV,OAAS;AAAA,UACX;AAAA,UACA,MAAM;AAAA,YACJ,SAAW;AAAA,YACX,QAAU;AAAA,YACV,QAAU;AAAA,YACV,OAAS;AAAA,UACX;AAAA,UACA,MAAQ;AAAA,QACV;AAAA,QACA,eAAe;AAAA,UACb,MAAM;AAAA,YACJ,SAAW;AAAA,YACX,QAAU;AAAA,YACV,QAAU;AAAA,YACV,OAAS;AAAA,UACX;AAAA,UACA,MAAM;AAAA,YACJ,SAAW;AAAA,YACX,QAAU;AAAA,YACV,QAAU;AAAA,YACV,OAAS;AAAA,UACX;AAAA,UACA,MAAM;AAAA,YACJ,SAAW;AAAA,YACX,QAAU;AAAA,YACV,QAAU;AAAA,YACV,OAAS;AAAA,UACX;AAAA,UACA,MAAM;AAAA,YACJ,SAAW;AAAA,YACX,QAAU;AAAA,YACV,QAAU;AAAA,YACV,OAAS;AAAA,UACX;AAAA,UACA,MAAM;AAAA,YACJ,SAAW;AAAA,YACX,QAAU;AAAA,YACV,QAAU;AAAA,YACV,OAAS;AAAA,UACX;AAAA,UACA,MAAM;AAAA,YACJ,SAAW;AAAA,YACX,QAAU;AAAA,YACV,QAAU;AAAA,YACV,OAAS;AAAA,UACX;AAAA,UACA,MAAM;AAAA,YACJ,SAAW;AAAA,YACX,QAAU;AAAA,YACV,QAAU;AAAA,YACV,OAAS;AAAA,UACX;AAAA,UACA,MAAQ;AAAA,QACV;AAAA,MACF;AAAA,IACF;AAAA;AAAA;;;ACxoCA,YAAY,WAAW;;;ACAvB,SAAS,EAAE,GAAE;AAAC,MAAI,GAAE,GAAE,IAAE;AAAG,MAAG,YAAU,OAAO,KAAG,YAAU,OAAO,EAAE,MAAG;AAAA,WAAU,YAAU,OAAO,EAAE,KAAG,MAAM,QAAQ,CAAC,GAAE;AAAC,QAAI,IAAE,EAAE;AAAO,SAAI,IAAE,GAAE,IAAE,GAAE,IAAI,GAAE,CAAC,MAAI,IAAE,EAAE,EAAE,CAAC,CAAC,OAAK,MAAI,KAAG,MAAK,KAAG;AAAA,EAAE,MAAM,MAAI,KAAK,EAAE,GAAE,CAAC,MAAI,MAAI,KAAG,MAAK,KAAG;AAAG,SAAO;AAAC;AAAQ,SAAS,OAAM;AAAC,WAAQ,GAAE,GAAE,IAAE,GAAE,IAAE,IAAG,IAAE,UAAU,QAAO,IAAE,GAAE,IAAI,EAAC,IAAE,UAAU,CAAC,OAAK,IAAE,EAAE,CAAC,OAAK,MAAI,KAAG,MAAK,KAAG;AAAG,SAAO;AAAC;AAAC,IAAO,eAAQ;;;ADwDzX,SACE,KADF;AAjCC,IAAM,iBAAgD,CAAC;AAAA,EAC5D;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,QAAQ;AAAA,EACR,SAAS;AAAA,EACT;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,qBAAqB;AACvB,MAAM;AACJ,QAAM,WAAiB,YAAM;AAC7B,QAAM,aAAa,MAAM;AACzB,QAAM,SAAS,cAAc,GAAG,UAAU,UAAU;AACpD,QAAM,WAAW,SAAS,GAAG,UAAU,SAAS;AAChD,QAAM,CAAC,WAAW,YAAY,IAAU,eAAS,kBAAkB;AAEnE,QAAM,eAAqB,kBAAY,MAAM;AAC3C,iBAAa,OAAK,CAAC,CAAC;AACpB;AAAA,EACF,GAAG,CAAC,aAAa,CAAC;AAElB,SACE;AAAA,IAAC;AAAA;AAAA,MACC,IAAI;AAAA,MACJ,WAAW,aAAK,aAAa,SAAS;AAAA,MACtC,OAAO,EAAE,MAAM;AAAA,MACf,mBAAiB,GAAG,UAAU;AAAA,MAC9B,oBAAkB,aAAK,QAAQ,QAAQ;AAAA,MAEvC;AAAA,6BAAC,YAAO,WAAU,qBAChB;AAAA,8BAAC,QAAG,IAAI,GAAG,UAAU,UAAU,WAAU,oBAAoB,iBAAM;AAAA,UAClE,mBACC;AAAA,YAAC;AAAA;AAAA,cACC,MAAK;AAAA,cACL,WAAU;AAAA,cACV,iBAAe;AAAA,cACf,SAAS;AAAA,cAER,sBAAY,eAAe;AAAA;AAAA,UAC9B;AAAA,WAEJ;AAAA,QACC,eACC,oBAAC,OAAE,IAAI,QAAQ,WAAU,0BACtB,uBACH;AAAA,QAEF;AAAA,UAAC;AAAA;AAAA,YACC,WAAU;AAAA,YACV,OAAO,EAAE,OAAO;AAAA,YAChB,MAAK;AAAA,YACL,cAAY;AAAA,YAEX;AAAA;AAAA,QACH;AAAA,SACE,UAAU,gBACV,qBAAC,gBAAW,WAAU,sBACnB;AAAA,oBACC,qBAAC,WAAM,IAAI,UAAU,WAAU,qBAAoB;AAAA;AAAA,YACxC;AAAA,aACX;AAAA,UAED,aAAa;AAAA,WAChB;AAAA;AAAA;AAAA,EAEJ;AAEJ;AAEA,IAAO,yBAAQ;;;AEhGf,YAAYC,aAAW;;;ACAR,SAAR,UAA2B,GAAG,GAAG;AACtC,SAAO,KAAK,QAAQ,KAAK,OAAO,MAAM,IAAI,IAAI,KAAK,IAAI,IAAI,IAAI,KAAK,IAAI,IAAI;AAC9E;;;ACFe,SAAR,WAA4B,GAAG,GAAG;AACvC,SAAO,KAAK,QAAQ,KAAK,OAAO,MAC5B,IAAI,IAAI,KACR,IAAI,IAAI,IACR,KAAK,IAAI,IACT;AACN;;;ACHe,SAAR,SAA0B,GAAG;AAClC,MAAI,UAAU,UAAU;AAOxB,MAAI,EAAE,WAAW,GAAG;AAClB,eAAW;AACX,eAAW,CAAC,GAAGC,OAAM,UAAU,EAAE,CAAC,GAAGA,EAAC;AACtC,YAAQ,CAAC,GAAGA,OAAM,EAAE,CAAC,IAAIA;AAAA,EAC3B,OAAO;AACL,eAAW,MAAM,aAAa,MAAM,aAAa,IAAI;AACrD,eAAW;AACX,YAAQ;AAAA,EACV;AAEA,WAAS,KAAK,GAAGA,IAAG,KAAK,GAAG,KAAK,EAAE,QAAQ;AACzC,QAAI,KAAK,IAAI;AACX,UAAI,SAASA,IAAGA,EAAC,MAAM,EAAG,QAAO;AACjC,SAAG;AACD,cAAM,MAAO,KAAK,OAAQ;AAC1B,YAAI,SAAS,EAAE,GAAG,GAAGA,EAAC,IAAI,EAAG,MAAK,MAAM;AAAA,YACnC,MAAK;AAAA,MACZ,SAAS,KAAK;AAAA,IAChB;AACA,WAAO;AAAA,EACT;AAEA,WAAS,MAAM,GAAGA,IAAG,KAAK,GAAG,KAAK,EAAE,QAAQ;AAC1C,QAAI,KAAK,IAAI;AACX,UAAI,SAASA,IAAGA,EAAC,MAAM,EAAG,QAAO;AACjC,SAAG;AACD,cAAM,MAAO,KAAK,OAAQ;AAC1B,YAAI,SAAS,EAAE,GAAG,GAAGA,EAAC,KAAK,EAAG,MAAK,MAAM;AAAA,YACpC,MAAK;AAAA,MACZ,SAAS,KAAK;AAAA,IAChB;AACA,WAAO;AAAA,EACT;AAEA,WAAS,OAAO,GAAGA,IAAG,KAAK,GAAG,KAAK,EAAE,QAAQ;AAC3C,UAAM,IAAI,KAAK,GAAGA,IAAG,IAAI,KAAK,CAAC;AAC/B,WAAO,IAAI,MAAM,MAAM,EAAE,IAAI,CAAC,GAAGA,EAAC,IAAI,CAAC,MAAM,EAAE,CAAC,GAAGA,EAAC,IAAI,IAAI,IAAI;AAAA,EAClE;AAEA,SAAO,EAAC,MAAM,QAAQ,MAAK;AAC7B;AAEA,SAAS,OAAO;AACd,SAAO;AACT;;;ACvDe,SAAR,OAAwBC,IAAG;AAChC,SAAOA,OAAM,OAAO,MAAM,CAACA;AAC7B;;;ACEA,IAAM,kBAAkB,SAAS,SAAS;AACnC,IAAM,cAAc,gBAAgB;AACpC,IAAM,aAAa,gBAAgB;AACnC,IAAM,eAAe,SAAS,MAAM,EAAE;AAC7C,IAAO,iBAAQ;;;ACRA,SAAR,OAAwB,QAAQ,SAAS;AAC9C,MAAI;AACJ,MAAI;AACJ,MAAI,YAAY,QAAW;AACzB,eAAW,SAAS,QAAQ;AAC1B,UAAI,SAAS,MAAM;AACjB,YAAI,QAAQ,QAAW;AACrB,cAAI,SAAS,MAAO,OAAM,MAAM;AAAA,QAClC,OAAO;AACL,cAAI,MAAM,MAAO,OAAM;AACvB,cAAI,MAAM,MAAO,OAAM;AAAA,QACzB;AAAA,MACF;AAAA,IACF;AAAA,EACF,OAAO;AACL,QAAI,QAAQ;AACZ,aAAS,SAAS,QAAQ;AACxB,WAAK,QAAQ,QAAQ,OAAO,EAAE,OAAO,MAAM,MAAM,MAAM;AACrD,YAAI,QAAQ,QAAW;AACrB,cAAI,SAAS,MAAO,OAAM,MAAM;AAAA,QAClC,OAAO;AACL,cAAI,MAAM,MAAO,OAAM;AACvB,cAAI,MAAM,MAAO,OAAM;AAAA,QACzB;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACA,SAAO,CAAC,KAAK,GAAG;AAClB;;;AC5BO,IAAM,YAAN,cAAwB,IAAI;AAAA,EACjC,YAAY,SAAS,MAAM,OAAO;AAChC,UAAM;AACN,WAAO,iBAAiB,MAAM,EAAC,SAAS,EAAC,OAAO,oBAAI,IAAI,EAAC,GAAG,MAAM,EAAC,OAAO,IAAG,EAAC,CAAC;AAC/E,QAAI,WAAW,KAAM,YAAW,CAACC,MAAK,KAAK,KAAK,QAAS,MAAK,IAAIA,MAAK,KAAK;AAAA,EAC9E;AAAA,EACA,IAAI,KAAK;AACP,WAAO,MAAM,IAAI,WAAW,MAAM,GAAG,CAAC;AAAA,EACxC;AAAA,EACA,IAAI,KAAK;AACP,WAAO,MAAM,IAAI,WAAW,MAAM,GAAG,CAAC;AAAA,EACxC;AAAA,EACA,IAAI,KAAK,OAAO;AACd,WAAO,MAAM,IAAI,WAAW,MAAM,GAAG,GAAG,KAAK;AAAA,EAC/C;AAAA,EACA,OAAO,KAAK;AACV,WAAO,MAAM,OAAO,cAAc,MAAM,GAAG,CAAC;AAAA,EAC9C;AACF;AAmBA,SAAS,WAAW,EAAC,SAAS,KAAI,GAAG,OAAO;AAC1C,QAAM,MAAM,KAAK,KAAK;AACtB,SAAO,QAAQ,IAAI,GAAG,IAAI,QAAQ,IAAI,GAAG,IAAI;AAC/C;AAEA,SAAS,WAAW,EAAC,SAAS,KAAI,GAAG,OAAO;AAC1C,QAAM,MAAM,KAAK,KAAK;AACtB,MAAI,QAAQ,IAAI,GAAG,EAAG,QAAO,QAAQ,IAAI,GAAG;AAC5C,UAAQ,IAAI,KAAK,KAAK;AACtB,SAAO;AACT;AAEA,SAAS,cAAc,EAAC,SAAS,KAAI,GAAG,OAAO;AAC7C,QAAM,MAAM,KAAK,KAAK;AACtB,MAAI,QAAQ,IAAI,GAAG,GAAG;AACpB,YAAQ,QAAQ,IAAI,GAAG;AACvB,YAAQ,OAAO,GAAG;AAAA,EACpB;AACA,SAAO;AACT;AAEA,SAAS,MAAM,OAAO;AACpB,SAAO,UAAU,QAAQ,OAAO,UAAU,WAAW,MAAM,QAAQ,IAAI;AACzE;;;AC5DA,IAAM,MAAM,KAAK,KAAK,EAAE;AAAxB,IACI,KAAK,KAAK,KAAK,EAAE;AADrB,IAEI,KAAK,KAAK,KAAK,CAAC;AAEpB,SAAS,SAAS,OAAO,MAAM,OAAO;AACpC,QAAM,QAAQ,OAAO,SAAS,KAAK,IAAI,GAAG,KAAK,GAC3C,QAAQ,KAAK,MAAM,KAAK,MAAM,IAAI,CAAC,GACnC,QAAQ,OAAO,KAAK,IAAI,IAAI,KAAK,GACjC,SAAS,SAAS,MAAM,KAAK,SAAS,KAAK,IAAI,SAAS,KAAK,IAAI;AACrE,MAAI,IAAI,IAAI;AACZ,MAAI,QAAQ,GAAG;AACb,UAAM,KAAK,IAAI,IAAI,CAAC,KAAK,IAAI;AAC7B,SAAK,KAAK,MAAM,QAAQ,GAAG;AAC3B,SAAK,KAAK,MAAM,OAAO,GAAG;AAC1B,QAAI,KAAK,MAAM,MAAO,GAAE;AACxB,QAAI,KAAK,MAAM,KAAM,GAAE;AACvB,UAAM,CAAC;AAAA,EACT,OAAO;AACL,UAAM,KAAK,IAAI,IAAI,KAAK,IAAI;AAC5B,SAAK,KAAK,MAAM,QAAQ,GAAG;AAC3B,SAAK,KAAK,MAAM,OAAO,GAAG;AAC1B,QAAI,KAAK,MAAM,MAAO,GAAE;AACxB,QAAI,KAAK,MAAM,KAAM,GAAE;AAAA,EACzB;AACA,MAAI,KAAK,MAAM,OAAO,SAAS,QAAQ,EAAG,QAAO,SAAS,OAAO,MAAM,QAAQ,CAAC;AAChF,SAAO,CAAC,IAAI,IAAI,GAAG;AACrB;AAEe,SAAR,MAAuB,OAAO,MAAM,OAAO;AAChD,SAAO,CAAC,MAAM,QAAQ,CAAC,OAAO,QAAQ,CAAC;AACvC,MAAI,EAAE,QAAQ,GAAI,QAAO,CAAC;AAC1B,MAAI,UAAU,KAAM,QAAO,CAAC,KAAK;AACjC,QAAM,UAAU,OAAO,OAAO,CAAC,IAAI,IAAI,GAAG,IAAI,UAAU,SAAS,MAAM,OAAO,KAAK,IAAI,SAAS,OAAO,MAAM,KAAK;AAClH,MAAI,EAAE,MAAM,IAAK,QAAO,CAAC;AACzB,QAAM,IAAI,KAAK,KAAK,GAAGC,SAAQ,IAAI,MAAM,CAAC;AAC1C,MAAI,SAAS;AACX,QAAI,MAAM,EAAG,UAAS,IAAI,GAAG,IAAI,GAAG,EAAE,EAAG,CAAAA,OAAM,CAAC,KAAK,KAAK,KAAK,CAAC;AAAA,QAC3D,UAAS,IAAI,GAAG,IAAI,GAAG,EAAE,EAAG,CAAAA,OAAM,CAAC,KAAK,KAAK,KAAK;AAAA,EACzD,OAAO;AACL,QAAI,MAAM,EAAG,UAAS,IAAI,GAAG,IAAI,GAAG,EAAE,EAAG,CAAAA,OAAM,CAAC,KAAK,KAAK,KAAK,CAAC;AAAA,QAC3D,UAAS,IAAI,GAAG,IAAI,GAAG,EAAE,EAAG,CAAAA,OAAM,CAAC,KAAK,KAAK,KAAK;AAAA,EACzD;AACA,SAAOA;AACT;AAEO,SAAS,cAAc,OAAO,MAAM,OAAO;AAChD,SAAO,CAAC,MAAM,QAAQ,CAAC,OAAO,QAAQ,CAAC;AACvC,SAAO,SAAS,OAAO,MAAM,KAAK,EAAE,CAAC;AACvC;AAEO,SAAS,SAAS,OAAO,MAAM,OAAO;AAC3C,SAAO,CAAC,MAAM,QAAQ,CAAC,OAAO,QAAQ,CAAC;AACvC,QAAM,UAAU,OAAO,OAAO,MAAM,UAAU,cAAc,MAAM,OAAO,KAAK,IAAI,cAAc,OAAO,MAAM,KAAK;AAClH,UAAQ,UAAU,KAAK,MAAM,MAAM,IAAI,IAAI,CAAC,MAAM;AACpD;;;ACtDe,SAAR,MAAuB,OAAO,MAAM,MAAM;AAC/C,UAAQ,CAAC,OAAO,OAAO,CAAC,MAAM,QAAQ,IAAI,UAAU,UAAU,KAAK,OAAO,OAAO,QAAQ,GAAG,KAAK,IAAI,IAAI,IAAI,CAAC;AAE9G,MAAI,IAAI,IACJ,IAAI,KAAK,IAAI,GAAG,KAAK,MAAM,OAAO,SAAS,IAAI,CAAC,IAAI,GACpDC,SAAQ,IAAI,MAAM,CAAC;AAEvB,SAAO,EAAE,IAAI,GAAG;AACd,IAAAA,OAAM,CAAC,IAAI,QAAQ,IAAI;AAAA,EACzB;AAEA,SAAOA;AACT;;;ACZO,SAAS,UAAU,QAAQC,QAAO;AACvC,UAAQ,UAAU,QAAQ;AAAA,IACxB,KAAK;AAAG;AAAA,IACR,KAAK;AAAG,WAAK,MAAM,MAAM;AAAG;AAAA,IAC5B;AAAS,WAAK,MAAMA,MAAK,EAAE,OAAO,MAAM;AAAG;AAAA,EAC7C;AACA,SAAO;AACT;;;ACJO,IAAM,WAAW,OAAO,UAAU;AAE1B,SAAR,UAA2B;AAChC,MAAI,QAAQ,IAAI,UAAU,GACtB,SAAS,CAAC,GACVC,SAAQ,CAAC,GACT,UAAU;AAEd,WAAS,MAAM,GAAG;AAChB,QAAI,IAAI,MAAM,IAAI,CAAC;AACnB,QAAI,MAAM,QAAW;AACnB,UAAI,YAAY,SAAU,QAAO;AACjC,YAAM,IAAI,GAAG,IAAI,OAAO,KAAK,CAAC,IAAI,CAAC;AAAA,IACrC;AACA,WAAOA,OAAM,IAAIA,OAAM,MAAM;AAAA,EAC/B;AAEA,QAAM,SAAS,SAAS,GAAG;AACzB,QAAI,CAAC,UAAU,OAAQ,QAAO,OAAO,MAAM;AAC3C,aAAS,CAAC,GAAG,QAAQ,IAAI,UAAU;AACnC,eAAW,SAAS,GAAG;AACrB,UAAI,MAAM,IAAI,KAAK,EAAG;AACtB,YAAM,IAAI,OAAO,OAAO,KAAK,KAAK,IAAI,CAAC;AAAA,IACzC;AACA,WAAO;AAAA,EACT;AAEA,QAAM,QAAQ,SAAS,GAAG;AACxB,WAAO,UAAU,UAAUA,SAAQ,MAAM,KAAK,CAAC,GAAG,SAASA,OAAM,MAAM;AAAA,EACzE;AAEA,QAAM,UAAU,SAAS,GAAG;AAC1B,WAAO,UAAU,UAAU,UAAU,GAAG,SAAS;AAAA,EACnD;AAEA,QAAM,OAAO,WAAW;AACtB,WAAO,QAAQ,QAAQA,MAAK,EAAE,QAAQ,OAAO;AAAA,EAC/C;AAEA,YAAU,MAAM,OAAO,SAAS;AAEhC,SAAO;AACT;;;ACzCe,SAAR,OAAwB;AAC7B,MAAI,QAAQ,QAAQ,EAAE,QAAQ,MAAS,GACnC,SAAS,MAAM,QACf,eAAe,MAAM,OACrB,KAAK,GACL,KAAK,GACL,MACA,WACA,QAAQ,OACR,eAAe,GACf,eAAe,GACf,QAAQ;AAEZ,SAAO,MAAM;AAEb,WAAS,UAAU;AACjB,QAAI,IAAI,OAAO,EAAE,QACb,UAAU,KAAK,IACf,QAAQ,UAAU,KAAK,IACvB,OAAO,UAAU,KAAK;AAC1B,YAAQ,OAAO,SAAS,KAAK,IAAI,GAAG,IAAI,eAAe,eAAe,CAAC;AACvE,QAAI,MAAO,QAAO,KAAK,MAAM,IAAI;AACjC,cAAU,OAAO,QAAQ,QAAQ,IAAI,iBAAiB;AACtD,gBAAY,QAAQ,IAAI;AACxB,QAAI,MAAO,SAAQ,KAAK,MAAM,KAAK,GAAG,YAAY,KAAK,MAAM,SAAS;AACtE,QAAI,SAAS,MAAS,CAAC,EAAE,IAAI,SAAS,GAAG;AAAE,aAAO,QAAQ,OAAO;AAAA,IAAG,CAAC;AACrE,WAAO,aAAa,UAAU,OAAO,QAAQ,IAAI,MAAM;AAAA,EACzD;AAEA,QAAM,SAAS,SAAS,GAAG;AACzB,WAAO,UAAU,UAAU,OAAO,CAAC,GAAG,QAAQ,KAAK,OAAO;AAAA,EAC5D;AAEA,QAAM,QAAQ,SAAS,GAAG;AACxB,WAAO,UAAU,UAAU,CAAC,IAAI,EAAE,IAAI,GAAG,KAAK,CAAC,IAAI,KAAK,CAAC,IAAI,QAAQ,KAAK,CAAC,IAAI,EAAE;AAAA,EACnF;AAEA,QAAM,aAAa,SAAS,GAAG;AAC7B,WAAO,CAAC,IAAI,EAAE,IAAI,GAAG,KAAK,CAAC,IAAI,KAAK,CAAC,IAAI,QAAQ,MAAM,QAAQ;AAAA,EACjE;AAEA,QAAM,YAAY,WAAW;AAC3B,WAAO;AAAA,EACT;AAEA,QAAM,OAAO,WAAW;AACtB,WAAO;AAAA,EACT;AAEA,QAAM,QAAQ,SAAS,GAAG;AACxB,WAAO,UAAU,UAAU,QAAQ,CAAC,CAAC,GAAG,QAAQ,KAAK;AAAA,EACvD;AAEA,QAAM,UAAU,SAAS,GAAG;AAC1B,WAAO,UAAU,UAAU,eAAe,KAAK,IAAI,GAAG,eAAe,CAAC,CAAC,GAAG,QAAQ,KAAK;AAAA,EACzF;AAEA,QAAM,eAAe,SAAS,GAAG;AAC/B,WAAO,UAAU,UAAU,eAAe,KAAK,IAAI,GAAG,CAAC,GAAG,QAAQ,KAAK;AAAA,EACzE;AAEA,QAAM,eAAe,SAAS,GAAG;AAC/B,WAAO,UAAU,UAAU,eAAe,CAAC,GAAG,QAAQ,KAAK;AAAA,EAC7D;AAEA,QAAM,QAAQ,SAAS,GAAG;AACxB,WAAO,UAAU,UAAU,QAAQ,KAAK,IAAI,GAAG,KAAK,IAAI,GAAG,CAAC,CAAC,GAAG,QAAQ,KAAK;AAAA,EAC/E;AAEA,QAAM,OAAO,WAAW;AACtB,WAAO,KAAK,OAAO,GAAG,CAAC,IAAI,EAAE,CAAC,EACzB,MAAM,KAAK,EACX,aAAa,YAAY,EACzB,aAAa,YAAY,EACzB,MAAM,KAAK;AAAA,EAClB;AAEA,SAAO,UAAU,MAAM,QAAQ,GAAG,SAAS;AAC7C;;;AClFe,SAAR,eAAiB,aAAa,SAAS,WAAW;AACvD,cAAY,YAAY,QAAQ,YAAY;AAC5C,YAAU,cAAc;AAC1B;AAEO,SAAS,OAAO,QAAQ,YAAY;AACzC,MAAI,YAAY,OAAO,OAAO,OAAO,SAAS;AAC9C,WAAS,OAAO,WAAY,WAAU,GAAG,IAAI,WAAW,GAAG;AAC3D,SAAO;AACT;;;ACPO,SAAS,QAAQ;AAAC;AAElB,IAAI,SAAS;AACb,IAAI,WAAW,IAAI;AAE1B,IAAI,MAAM;AAAV,IACI,MAAM;AADV,IAEI,MAAM;AAFV,IAGI,QAAQ;AAHZ,IAII,eAAe,IAAI,OAAO,UAAU,GAAG,IAAI,GAAG,IAAI,GAAG,MAAM;AAJ/D,IAKI,eAAe,IAAI,OAAO,UAAU,GAAG,IAAI,GAAG,IAAI,GAAG,MAAM;AAL/D,IAMI,gBAAgB,IAAI,OAAO,WAAW,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,GAAG,MAAM;AANxE,IAOI,gBAAgB,IAAI,OAAO,WAAW,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,GAAG,MAAM;AAPxE,IAQI,eAAe,IAAI,OAAO,UAAU,GAAG,IAAI,GAAG,IAAI,GAAG,MAAM;AAR/D,IASI,gBAAgB,IAAI,OAAO,WAAW,GAAG,IAAI,GAAG,IAAI,GAAG,IAAI,GAAG,MAAM;AAExE,IAAI,QAAQ;AAAA,EACV,WAAW;AAAA,EACX,cAAc;AAAA,EACd,MAAM;AAAA,EACN,YAAY;AAAA,EACZ,OAAO;AAAA,EACP,OAAO;AAAA,EACP,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,gBAAgB;AAAA,EAChB,MAAM;AAAA,EACN,YAAY;AAAA,EACZ,OAAO;AAAA,EACP,WAAW;AAAA,EACX,WAAW;AAAA,EACX,YAAY;AAAA,EACZ,WAAW;AAAA,EACX,OAAO;AAAA,EACP,gBAAgB;AAAA,EAChB,UAAU;AAAA,EACV,SAAS;AAAA,EACT,MAAM;AAAA,EACN,UAAU;AAAA,EACV,UAAU;AAAA,EACV,eAAe;AAAA,EACf,UAAU;AAAA,EACV,WAAW;AAAA,EACX,UAAU;AAAA,EACV,WAAW;AAAA,EACX,aAAa;AAAA,EACb,gBAAgB;AAAA,EAChB,YAAY;AAAA,EACZ,YAAY;AAAA,EACZ,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,cAAc;AAAA,EACd,eAAe;AAAA,EACf,eAAe;AAAA,EACf,eAAe;AAAA,EACf,eAAe;AAAA,EACf,YAAY;AAAA,EACZ,UAAU;AAAA,EACV,aAAa;AAAA,EACb,SAAS;AAAA,EACT,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,WAAW;AAAA,EACX,aAAa;AAAA,EACb,aAAa;AAAA,EACb,SAAS;AAAA,EACT,WAAW;AAAA,EACX,YAAY;AAAA,EACZ,MAAM;AAAA,EACN,WAAW;AAAA,EACX,MAAM;AAAA,EACN,OAAO;AAAA,EACP,aAAa;AAAA,EACb,MAAM;AAAA,EACN,UAAU;AAAA,EACV,SAAS;AAAA,EACT,WAAW;AAAA,EACX,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,OAAO;AAAA,EACP,UAAU;AAAA,EACV,eAAe;AAAA,EACf,WAAW;AAAA,EACX,cAAc;AAAA,EACd,WAAW;AAAA,EACX,YAAY;AAAA,EACZ,WAAW;AAAA,EACX,sBAAsB;AAAA,EACtB,WAAW;AAAA,EACX,YAAY;AAAA,EACZ,WAAW;AAAA,EACX,WAAW;AAAA,EACX,aAAa;AAAA,EACb,eAAe;AAAA,EACf,cAAc;AAAA,EACd,gBAAgB;AAAA,EAChB,gBAAgB;AAAA,EAChB,gBAAgB;AAAA,EAChB,aAAa;AAAA,EACb,MAAM;AAAA,EACN,WAAW;AAAA,EACX,OAAO;AAAA,EACP,SAAS;AAAA,EACT,QAAQ;AAAA,EACR,kBAAkB;AAAA,EAClB,YAAY;AAAA,EACZ,cAAc;AAAA,EACd,cAAc;AAAA,EACd,gBAAgB;AAAA,EAChB,iBAAiB;AAAA,EACjB,mBAAmB;AAAA,EACnB,iBAAiB;AAAA,EACjB,iBAAiB;AAAA,EACjB,cAAc;AAAA,EACd,WAAW;AAAA,EACX,WAAW;AAAA,EACX,UAAU;AAAA,EACV,aAAa;AAAA,EACb,MAAM;AAAA,EACN,SAAS;AAAA,EACT,OAAO;AAAA,EACP,WAAW;AAAA,EACX,QAAQ;AAAA,EACR,WAAW;AAAA,EACX,QAAQ;AAAA,EACR,eAAe;AAAA,EACf,WAAW;AAAA,EACX,eAAe;AAAA,EACf,eAAe;AAAA,EACf,YAAY;AAAA,EACZ,WAAW;AAAA,EACX,MAAM;AAAA,EACN,MAAM;AAAA,EACN,MAAM;AAAA,EACN,YAAY;AAAA,EACZ,QAAQ;AAAA,EACR,eAAe;AAAA,EACf,KAAK;AAAA,EACL,WAAW;AAAA,EACX,WAAW;AAAA,EACX,aAAa;AAAA,EACb,QAAQ;AAAA,EACR,YAAY;AAAA,EACZ,UAAU;AAAA,EACV,UAAU;AAAA,EACV,QAAQ;AAAA,EACR,QAAQ;AAAA,EACR,SAAS;AAAA,EACT,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,MAAM;AAAA,EACN,aAAa;AAAA,EACb,WAAW;AAAA,EACX,KAAK;AAAA,EACL,MAAM;AAAA,EACN,SAAS;AAAA,EACT,QAAQ;AAAA,EACR,WAAW;AAAA,EACX,QAAQ;AAAA,EACR,OAAO;AAAA,EACP,OAAO;AAAA,EACP,YAAY;AAAA,EACZ,QAAQ;AAAA,EACR,aAAa;AACf;AAEA,eAAO,OAAO,OAAO;AAAA,EACnB,KAAK,UAAU;AACb,WAAO,OAAO,OAAO,IAAI,KAAK,eAAa,MAAM,QAAQ;AAAA,EAC3D;AAAA,EACA,cAAc;AACZ,WAAO,KAAK,IAAI,EAAE,YAAY;AAAA,EAChC;AAAA,EACA,KAAK;AAAA;AAAA,EACL,WAAW;AAAA,EACX,YAAY;AAAA,EACZ,WAAW;AAAA,EACX,WAAW;AAAA,EACX,UAAU;AACZ,CAAC;AAED,SAAS,kBAAkB;AACzB,SAAO,KAAK,IAAI,EAAE,UAAU;AAC9B;AAEA,SAAS,mBAAmB;AAC1B,SAAO,KAAK,IAAI,EAAE,WAAW;AAC/B;AAEA,SAAS,kBAAkB;AACzB,SAAO,WAAW,IAAI,EAAE,UAAU;AACpC;AAEA,SAAS,kBAAkB;AACzB,SAAO,KAAK,IAAI,EAAE,UAAU;AAC9B;AAEe,SAAR,MAAuBC,SAAQ;AACpC,MAAI,GAAG;AACP,EAAAA,WAAUA,UAAS,IAAI,KAAK,EAAE,YAAY;AAC1C,UAAQ,IAAI,MAAM,KAAKA,OAAM,MAAM,IAAI,EAAE,CAAC,EAAE,QAAQ,IAAI,SAAS,EAAE,CAAC,GAAG,EAAE,GAAG,MAAM,IAAI,KAAK,CAAC,IACtF,MAAM,IAAI,IAAI,IAAK,KAAK,IAAI,KAAQ,KAAK,IAAI,KAAQ,KAAK,IAAI,KAAQ,IAAI,MAAS,IAAI,OAAQ,IAAM,IAAI,IAAM,CAAC,IAChH,MAAM,IAAI,KAAK,KAAK,KAAK,KAAM,KAAK,KAAK,KAAM,KAAK,IAAI,MAAO,IAAI,OAAQ,GAAI,IAC/E,MAAM,IAAI,KAAM,KAAK,KAAK,KAAQ,KAAK,IAAI,KAAQ,KAAK,IAAI,KAAQ,KAAK,IAAI,KAAQ,KAAK,IAAI,KAAQ,IAAI,OAAU,IAAI,OAAQ,IAAM,IAAI,MAAQ,GAAI,IACtJ,SACC,IAAI,aAAa,KAAKA,OAAM,KAAK,IAAI,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,KAC5D,IAAI,aAAa,KAAKA,OAAM,KAAK,IAAI,IAAI,EAAE,CAAC,IAAI,MAAM,KAAK,EAAE,CAAC,IAAI,MAAM,KAAK,EAAE,CAAC,IAAI,MAAM,KAAK,CAAC,KAChG,IAAI,cAAc,KAAKA,OAAM,KAAK,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,KAC7D,IAAI,cAAc,KAAKA,OAAM,KAAK,KAAK,EAAE,CAAC,IAAI,MAAM,KAAK,EAAE,CAAC,IAAI,MAAM,KAAK,EAAE,CAAC,IAAI,MAAM,KAAK,EAAE,CAAC,CAAC,KACjG,IAAI,aAAa,KAAKA,OAAM,KAAK,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,KAAK,EAAE,CAAC,IAAI,KAAK,CAAC,KACrE,IAAI,cAAc,KAAKA,OAAM,KAAK,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,IAAI,KAAK,EAAE,CAAC,IAAI,KAAK,EAAE,CAAC,CAAC,IAC1E,MAAM,eAAeA,OAAM,IAAI,KAAK,MAAMA,OAAM,CAAC,IACjDA,YAAW,gBAAgB,IAAI,IAAI,KAAK,KAAK,KAAK,CAAC,IACnD;AACR;AAEA,SAAS,KAAK,GAAG;AACf,SAAO,IAAI,IAAI,KAAK,KAAK,KAAM,KAAK,IAAI,KAAM,IAAI,KAAM,CAAC;AAC3D;AAEA,SAAS,KAAKC,IAAG,GAAG,GAAG,GAAG;AACxB,MAAI,KAAK,EAAG,CAAAA,KAAI,IAAI,IAAI;AACxB,SAAO,IAAI,IAAIA,IAAG,GAAG,GAAG,CAAC;AAC3B;AAEO,SAAS,WAAW,GAAG;AAC5B,MAAI,EAAE,aAAa,OAAQ,KAAI,MAAM,CAAC;AACtC,MAAI,CAAC,EAAG,QAAO,IAAI;AACnB,MAAI,EAAE,IAAI;AACV,SAAO,IAAI,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,OAAO;AACzC;AAEO,SAAS,IAAIA,IAAG,GAAG,GAAG,SAAS;AACpC,SAAO,UAAU,WAAW,IAAI,WAAWA,EAAC,IAAI,IAAI,IAAIA,IAAG,GAAG,GAAG,WAAW,OAAO,IAAI,OAAO;AAChG;AAEO,SAAS,IAAIA,IAAG,GAAG,GAAG,SAAS;AACpC,OAAK,IAAI,CAACA;AACV,OAAK,IAAI,CAAC;AACV,OAAK,IAAI,CAAC;AACV,OAAK,UAAU,CAAC;AAClB;AAEA,eAAO,KAAK,KAAK,OAAO,OAAO;AAAA,EAC7B,SAAS,GAAG;AACV,QAAI,KAAK,OAAO,WAAW,KAAK,IAAI,UAAU,CAAC;AAC/C,WAAO,IAAI,IAAI,KAAK,IAAI,GAAG,KAAK,IAAI,GAAG,KAAK,IAAI,GAAG,KAAK,OAAO;AAAA,EACjE;AAAA,EACA,OAAO,GAAG;AACR,QAAI,KAAK,OAAO,SAAS,KAAK,IAAI,QAAQ,CAAC;AAC3C,WAAO,IAAI,IAAI,KAAK,IAAI,GAAG,KAAK,IAAI,GAAG,KAAK,IAAI,GAAG,KAAK,OAAO;AAAA,EACjE;AAAA,EACA,MAAM;AACJ,WAAO;AAAA,EACT;AAAA,EACA,QAAQ;AACN,WAAO,IAAI,IAAI,OAAO,KAAK,CAAC,GAAG,OAAO,KAAK,CAAC,GAAG,OAAO,KAAK,CAAC,GAAG,OAAO,KAAK,OAAO,CAAC;AAAA,EACrF;AAAA,EACA,cAAc;AACZ,WAAQ,QAAQ,KAAK,KAAK,KAAK,IAAI,UAC3B,QAAQ,KAAK,KAAK,KAAK,IAAI,WAC3B,QAAQ,KAAK,KAAK,KAAK,IAAI,WAC3B,KAAK,KAAK,WAAW,KAAK,WAAW;AAAA,EAC/C;AAAA,EACA,KAAK;AAAA;AAAA,EACL,WAAW;AAAA,EACX,YAAY;AAAA,EACZ,WAAW;AAAA,EACX,UAAU;AACZ,CAAC,CAAC;AAEF,SAAS,gBAAgB;AACvB,SAAO,IAAI,IAAI,KAAK,CAAC,CAAC,GAAG,IAAI,KAAK,CAAC,CAAC,GAAG,IAAI,KAAK,CAAC,CAAC;AACpD;AAEA,SAAS,iBAAiB;AACxB,SAAO,IAAI,IAAI,KAAK,CAAC,CAAC,GAAG,IAAI,KAAK,CAAC,CAAC,GAAG,IAAI,KAAK,CAAC,CAAC,GAAG,KAAK,MAAM,KAAK,OAAO,IAAI,IAAI,KAAK,WAAW,GAAG,CAAC;AAC1G;AAEA,SAAS,gBAAgB;AACvB,QAAM,IAAI,OAAO,KAAK,OAAO;AAC7B,SAAO,GAAG,MAAM,IAAI,SAAS,OAAO,GAAG,OAAO,KAAK,CAAC,CAAC,KAAK,OAAO,KAAK,CAAC,CAAC,KAAK,OAAO,KAAK,CAAC,CAAC,GAAG,MAAM,IAAI,MAAM,KAAK,CAAC,GAAG;AACzH;AAEA,SAAS,OAAO,SAAS;AACvB,SAAO,MAAM,OAAO,IAAI,IAAI,KAAK,IAAI,GAAG,KAAK,IAAI,GAAG,OAAO,CAAC;AAC9D;AAEA,SAAS,OAAO,OAAO;AACrB,SAAO,KAAK,IAAI,GAAG,KAAK,IAAI,KAAK,KAAK,MAAM,KAAK,KAAK,CAAC,CAAC;AAC1D;AAEA,SAAS,IAAI,OAAO;AAClB,UAAQ,OAAO,KAAK;AACpB,UAAQ,QAAQ,KAAK,MAAM,MAAM,MAAM,SAAS,EAAE;AACpD;AAEA,SAAS,KAAK,GAAG,GAAG,GAAG,GAAG;AACxB,MAAI,KAAK,EAAG,KAAI,IAAI,IAAI;AAAA,WACf,KAAK,KAAK,KAAK,EAAG,KAAI,IAAI;AAAA,WAC1B,KAAK,EAAG,KAAI;AACrB,SAAO,IAAI,IAAI,GAAG,GAAG,GAAG,CAAC;AAC3B;AAEO,SAAS,WAAW,GAAG;AAC5B,MAAI,aAAa,IAAK,QAAO,IAAI,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,OAAO;AAC7D,MAAI,EAAE,aAAa,OAAQ,KAAI,MAAM,CAAC;AACtC,MAAI,CAAC,EAAG,QAAO,IAAI;AACnB,MAAI,aAAa,IAAK,QAAO;AAC7B,MAAI,EAAE,IAAI;AACV,MAAIA,KAAI,EAAE,IAAI,KACV,IAAI,EAAE,IAAI,KACV,IAAI,EAAE,IAAI,KACV,MAAM,KAAK,IAAIA,IAAG,GAAG,CAAC,GACtB,MAAM,KAAK,IAAIA,IAAG,GAAG,CAAC,GACtB,IAAI,KACJ,IAAI,MAAM,KACV,KAAK,MAAM,OAAO;AACtB,MAAI,GAAG;AACL,QAAIA,OAAM,IAAK,MAAK,IAAI,KAAK,KAAK,IAAI,KAAK;AAAA,aAClC,MAAM,IAAK,MAAK,IAAIA,MAAK,IAAI;AAAA,QACjC,MAAKA,KAAI,KAAK,IAAI;AACvB,SAAK,IAAI,MAAM,MAAM,MAAM,IAAI,MAAM;AACrC,SAAK;AAAA,EACP,OAAO;AACL,QAAI,IAAI,KAAK,IAAI,IAAI,IAAI;AAAA,EAC3B;AACA,SAAO,IAAI,IAAI,GAAG,GAAG,GAAG,EAAE,OAAO;AACnC;AAEO,SAAS,IAAI,GAAG,GAAG,GAAG,SAAS;AACpC,SAAO,UAAU,WAAW,IAAI,WAAW,CAAC,IAAI,IAAI,IAAI,GAAG,GAAG,GAAG,WAAW,OAAO,IAAI,OAAO;AAChG;AAEA,SAAS,IAAI,GAAG,GAAG,GAAG,SAAS;AAC7B,OAAK,IAAI,CAAC;AACV,OAAK,IAAI,CAAC;AACV,OAAK,IAAI,CAAC;AACV,OAAK,UAAU,CAAC;AAClB;AAEA,eAAO,KAAK,KAAK,OAAO,OAAO;AAAA,EAC7B,SAAS,GAAG;AACV,QAAI,KAAK,OAAO,WAAW,KAAK,IAAI,UAAU,CAAC;AAC/C,WAAO,IAAI,IAAI,KAAK,GAAG,KAAK,GAAG,KAAK,IAAI,GAAG,KAAK,OAAO;AAAA,EACzD;AAAA,EACA,OAAO,GAAG;AACR,QAAI,KAAK,OAAO,SAAS,KAAK,IAAI,QAAQ,CAAC;AAC3C,WAAO,IAAI,IAAI,KAAK,GAAG,KAAK,GAAG,KAAK,IAAI,GAAG,KAAK,OAAO;AAAA,EACzD;AAAA,EACA,MAAM;AACJ,QAAI,IAAI,KAAK,IAAI,OAAO,KAAK,IAAI,KAAK,KAClC,IAAI,MAAM,CAAC,KAAK,MAAM,KAAK,CAAC,IAAI,IAAI,KAAK,GACzC,IAAI,KAAK,GACT,KAAK,KAAK,IAAI,MAAM,IAAI,IAAI,KAAK,GACjC,KAAK,IAAI,IAAI;AACjB,WAAO,IAAI;AAAA,MACT,QAAQ,KAAK,MAAM,IAAI,MAAM,IAAI,KAAK,IAAI,EAAE;AAAA,MAC5C,QAAQ,GAAG,IAAI,EAAE;AAAA,MACjB,QAAQ,IAAI,MAAM,IAAI,MAAM,IAAI,KAAK,IAAI,EAAE;AAAA,MAC3C,KAAK;AAAA,IACP;AAAA,EACF;AAAA,EACA,QAAQ;AACN,WAAO,IAAI,IAAI,OAAO,KAAK,CAAC,GAAG,OAAO,KAAK,CAAC,GAAG,OAAO,KAAK,CAAC,GAAG,OAAO,KAAK,OAAO,CAAC;AAAA,EACrF;AAAA,EACA,cAAc;AACZ,YAAQ,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAAM,KAAK,CAAC,OAC1C,KAAK,KAAK,KAAK,KAAK,KAAK,OACzB,KAAK,KAAK,WAAW,KAAK,WAAW;AAAA,EAC/C;AAAA,EACA,YAAY;AACV,UAAM,IAAI,OAAO,KAAK,OAAO;AAC7B,WAAO,GAAG,MAAM,IAAI,SAAS,OAAO,GAAG,OAAO,KAAK,CAAC,CAAC,KAAK,OAAO,KAAK,CAAC,IAAI,GAAG,MAAM,OAAO,KAAK,CAAC,IAAI,GAAG,IAAI,MAAM,IAAI,MAAM,KAAK,CAAC,GAAG;AAAA,EACvI;AACF,CAAC,CAAC;AAEF,SAAS,OAAO,OAAO;AACrB,WAAS,SAAS,KAAK;AACvB,SAAO,QAAQ,IAAI,QAAQ,MAAM;AACnC;AAEA,SAAS,OAAO,OAAO;AACrB,SAAO,KAAK,IAAI,GAAG,KAAK,IAAI,GAAG,SAAS,CAAC,CAAC;AAC5C;AAGA,SAAS,QAAQ,GAAG,IAAI,IAAI;AAC1B,UAAQ,IAAI,KAAK,MAAM,KAAK,MAAM,IAAI,KAChC,IAAI,MAAM,KACV,IAAI,MAAM,MAAM,KAAK,OAAO,MAAM,KAAK,KACvC,MAAM;AACd;;;AC3YO,SAAS,MAAMC,KAAI,IAAI,IAAI,IAAI,IAAI;AACxC,MAAI,KAAKA,MAAKA,KAAI,KAAK,KAAKA;AAC5B,WAAS,IAAI,IAAIA,MAAK,IAAI,KAAK,MAAM,MAC9B,IAAI,IAAI,KAAK,IAAI,MAAM,MACvB,IAAI,IAAIA,MAAK,IAAI,KAAK,IAAI,MAAM,KACjC,KAAK,MAAM;AACnB;AAEe,SAAR,cAAiB,QAAQ;AAC9B,MAAI,IAAI,OAAO,SAAS;AACxB,SAAO,SAAS,GAAG;AACjB,QAAI,IAAI,KAAK,IAAK,IAAI,IAAK,KAAK,KAAK,IAAI,GAAG,IAAI,KAAK,KAAK,MAAM,IAAI,CAAC,GACjE,KAAK,OAAO,CAAC,GACb,KAAK,OAAO,IAAI,CAAC,GACjB,KAAK,IAAI,IAAI,OAAO,IAAI,CAAC,IAAI,IAAI,KAAK,IACtC,KAAK,IAAI,IAAI,IAAI,OAAO,IAAI,CAAC,IAAI,IAAI,KAAK;AAC9C,WAAO,OAAO,IAAI,IAAI,KAAK,GAAG,IAAI,IAAI,IAAI,EAAE;AAAA,EAC9C;AACF;;;AChBe,SAAR,oBAAiB,QAAQ;AAC9B,MAAI,IAAI,OAAO;AACf,SAAO,SAAS,GAAG;AACjB,QAAI,IAAI,KAAK,QAAQ,KAAK,KAAK,IAAI,EAAE,IAAI,KAAK,CAAC,GAC3C,KAAK,QAAQ,IAAI,IAAI,KAAK,CAAC,GAC3B,KAAK,OAAO,IAAI,CAAC,GACjB,KAAK,QAAQ,IAAI,KAAK,CAAC,GACvB,KAAK,QAAQ,IAAI,KAAK,CAAC;AAC3B,WAAO,OAAO,IAAI,IAAI,KAAK,GAAG,IAAI,IAAI,IAAI,EAAE;AAAA,EAC9C;AACF;;;ACZA,IAAO,mBAAQ,CAAAC,OAAK,MAAMA;;;ACE1B,SAAS,OAAO,GAAG,GAAG;AACpB,SAAO,SAAS,GAAG;AACjB,WAAO,IAAI,IAAI;AAAA,EACjB;AACF;AAEA,SAAS,YAAY,GAAG,GAAGC,IAAG;AAC5B,SAAO,IAAI,KAAK,IAAI,GAAGA,EAAC,GAAG,IAAI,KAAK,IAAI,GAAGA,EAAC,IAAI,GAAGA,KAAI,IAAIA,IAAG,SAAS,GAAG;AACxE,WAAO,KAAK,IAAI,IAAI,IAAI,GAAGA,EAAC;AAAA,EAC9B;AACF;AAOO,SAAS,MAAMC,IAAG;AACvB,UAAQA,KAAI,CAACA,QAAO,IAAI,UAAU,SAAS,GAAG,GAAG;AAC/C,WAAO,IAAI,IAAI,YAAY,GAAG,GAAGA,EAAC,IAAI,iBAAS,MAAM,CAAC,IAAI,IAAI,CAAC;AAAA,EACjE;AACF;AAEe,SAAR,QAAyB,GAAG,GAAG;AACpC,MAAI,IAAI,IAAI;AACZ,SAAO,IAAI,OAAO,GAAG,CAAC,IAAI,iBAAS,MAAM,CAAC,IAAI,IAAI,CAAC;AACrD;;;ACvBA,IAAO,cAAS,SAAS,SAASC,IAAG;AACnC,MAAIC,SAAQ,MAAMD,EAAC;AAEnB,WAASE,KAAI,OAAO,KAAK;AACvB,QAAIC,KAAIF,QAAO,QAAQ,IAAS,KAAK,GAAG,IAAI,MAAM,IAAS,GAAG,GAAG,CAAC,GAC9D,IAAIA,OAAM,MAAM,GAAG,IAAI,CAAC,GACxB,IAAIA,OAAM,MAAM,GAAG,IAAI,CAAC,GACxB,UAAU,QAAQ,MAAM,SAAS,IAAI,OAAO;AAChD,WAAO,SAAS,GAAG;AACjB,YAAM,IAAIE,GAAE,CAAC;AACb,YAAM,IAAI,EAAE,CAAC;AACb,YAAM,IAAI,EAAE,CAAC;AACb,YAAM,UAAU,QAAQ,CAAC;AACzB,aAAO,QAAQ;AAAA,IACjB;AAAA,EACF;AAEA,EAAAD,KAAI,QAAQ;AAEZ,SAAOA;AACT,EAAG,CAAC;AAEJ,SAAS,UAAU,QAAQ;AACzB,SAAO,SAAS,QAAQ;AACtB,QAAI,IAAI,OAAO,QACXC,KAAI,IAAI,MAAM,CAAC,GACf,IAAI,IAAI,MAAM,CAAC,GACf,IAAI,IAAI,MAAM,CAAC,GACf,GAAGF;AACP,SAAK,IAAI,GAAG,IAAI,GAAG,EAAE,GAAG;AACtB,MAAAA,SAAQ,IAAS,OAAO,CAAC,CAAC;AAC1B,MAAAE,GAAE,CAAC,IAAIF,OAAM,KAAK;AAClB,QAAE,CAAC,IAAIA,OAAM,KAAK;AAClB,QAAE,CAAC,IAAIA,OAAM,KAAK;AAAA,IACpB;AACA,IAAAE,KAAI,OAAOA,EAAC;AACZ,QAAI,OAAO,CAAC;AACZ,QAAI,OAAO,CAAC;AACZ,IAAAF,OAAM,UAAU;AAChB,WAAO,SAAS,GAAG;AACjB,MAAAA,OAAM,IAAIE,GAAE,CAAC;AACb,MAAAF,OAAM,IAAI,EAAE,CAAC;AACb,MAAAA,OAAM,IAAI,EAAE,CAAC;AACb,aAAOA,SAAQ;AAAA,IACjB;AAAA,EACF;AACF;AAEO,IAAI,WAAW,UAAU,aAAK;AAC9B,IAAI,iBAAiB,UAAU,mBAAW;;;ACtDlC,SAAR,oBAAiB,GAAG,GAAG;AAC5B,MAAI,CAAC,EAAG,KAAI,CAAC;AACb,MAAI,IAAI,IAAI,KAAK,IAAI,EAAE,QAAQ,EAAE,MAAM,IAAI,GACvC,IAAI,EAAE,MAAM,GACZ;AACJ,SAAO,SAAS,GAAG;AACjB,SAAK,IAAI,GAAG,IAAI,GAAG,EAAE,EAAG,GAAE,CAAC,IAAI,EAAE,CAAC,KAAK,IAAI,KAAK,EAAE,CAAC,IAAI;AACvD,WAAO;AAAA,EACT;AACF;AAEO,SAAS,cAAcG,IAAG;AAC/B,SAAO,YAAY,OAAOA,EAAC,KAAK,EAAEA,cAAa;AACjD;;;ACNO,SAAS,aAAa,GAAG,GAAG;AACjC,MAAI,KAAK,IAAI,EAAE,SAAS,GACpB,KAAK,IAAI,KAAK,IAAI,IAAI,EAAE,MAAM,IAAI,GAClCC,KAAI,IAAI,MAAM,EAAE,GAChB,IAAI,IAAI,MAAM,EAAE,GAChB;AAEJ,OAAK,IAAI,GAAG,IAAI,IAAI,EAAE,EAAG,CAAAA,GAAE,CAAC,IAAI,cAAM,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC;AAChD,SAAO,IAAI,IAAI,EAAE,EAAG,GAAE,CAAC,IAAI,EAAE,CAAC;AAE9B,SAAO,SAAS,GAAG;AACjB,SAAK,IAAI,GAAG,IAAI,IAAI,EAAE,EAAG,GAAE,CAAC,IAAIA,GAAE,CAAC,EAAE,CAAC;AACtC,WAAO;AAAA,EACT;AACF;;;ACrBe,SAAR,aAAiB,GAAG,GAAG;AAC5B,MAAI,IAAI,oBAAI;AACZ,SAAO,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,SAAS,GAAG;AACjC,WAAO,EAAE,QAAQ,KAAK,IAAI,KAAK,IAAI,CAAC,GAAG;AAAA,EACzC;AACF;;;ACLe,SAAR,eAAiB,GAAG,GAAG;AAC5B,SAAO,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,SAAS,GAAG;AACjC,WAAO,KAAK,IAAI,KAAK,IAAI;AAAA,EAC3B;AACF;;;ACFe,SAAR,eAAiB,GAAG,GAAG;AAC5B,MAAI,IAAI,CAAC,GACL,IAAI,CAAC,GACL;AAEJ,MAAI,MAAM,QAAQ,OAAO,MAAM,SAAU,KAAI,CAAC;AAC9C,MAAI,MAAM,QAAQ,OAAO,MAAM,SAAU,KAAI,CAAC;AAE9C,OAAK,KAAK,GAAG;AACX,QAAI,KAAK,GAAG;AACV,QAAE,CAAC,IAAI,cAAM,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC;AAAA,IACzB,OAAO;AACL,QAAE,CAAC,IAAI,EAAE,CAAC;AAAA,IACZ;AAAA,EACF;AAEA,SAAO,SAAS,GAAG;AACjB,SAAK,KAAK,EAAG,GAAE,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC;AAC1B,WAAO;AAAA,EACT;AACF;;;ACpBA,IAAI,MAAM;AAAV,IACI,MAAM,IAAI,OAAO,IAAI,QAAQ,GAAG;AAEpC,SAASC,MAAK,GAAG;AACf,SAAO,WAAW;AAChB,WAAO;AAAA,EACT;AACF;AAEA,SAAS,IAAI,GAAG;AACd,SAAO,SAAS,GAAG;AACjB,WAAO,EAAE,CAAC,IAAI;AAAA,EAChB;AACF;AAEe,SAAR,eAAiB,GAAG,GAAG;AAC5B,MAAI,KAAK,IAAI,YAAY,IAAI,YAAY,GACrC,IACA,IACA,IACA,IAAI,IACJ,IAAI,CAAC,GACL,IAAI,CAAC;AAGT,MAAI,IAAI,IAAI,IAAI,IAAI;AAGpB,UAAQ,KAAK,IAAI,KAAK,CAAC,OACf,KAAK,IAAI,KAAK,CAAC,IAAI;AACzB,SAAK,KAAK,GAAG,SAAS,IAAI;AACxB,WAAK,EAAE,MAAM,IAAI,EAAE;AACnB,UAAI,EAAE,CAAC,EAAG,GAAE,CAAC,KAAK;AAAA,UACb,GAAE,EAAE,CAAC,IAAI;AAAA,IAChB;AACA,SAAK,KAAK,GAAG,CAAC,QAAQ,KAAK,GAAG,CAAC,IAAI;AACjC,UAAI,EAAE,CAAC,EAAG,GAAE,CAAC,KAAK;AAAA,UACb,GAAE,EAAE,CAAC,IAAI;AAAA,IAChB,OAAO;AACL,QAAE,EAAE,CAAC,IAAI;AACT,QAAE,KAAK,EAAC,GAAM,GAAG,eAAO,IAAI,EAAE,EAAC,CAAC;AAAA,IAClC;AACA,SAAK,IAAI;AAAA,EACX;AAGA,MAAI,KAAK,EAAE,QAAQ;AACjB,SAAK,EAAE,MAAM,EAAE;AACf,QAAI,EAAE,CAAC,EAAG,GAAE,CAAC,KAAK;AAAA,QACb,GAAE,EAAE,CAAC,IAAI;AAAA,EAChB;AAIA,SAAO,EAAE,SAAS,IAAK,EAAE,CAAC,IACpB,IAAI,EAAE,CAAC,EAAE,CAAC,IACVA,MAAK,CAAC,KACL,IAAI,EAAE,QAAQ,SAAS,GAAG;AACzB,aAASC,KAAI,GAAG,GAAGA,KAAI,GAAG,EAAEA,GAAG,IAAG,IAAI,EAAEA,EAAC,GAAG,CAAC,IAAI,EAAE,EAAE,CAAC;AACtD,WAAO,EAAE,KAAK,EAAE;AAAA,EAClB;AACR;;;ACrDe,SAAR,cAAiB,GAAG,GAAG;AAC5B,MAAI,IAAI,OAAO,GAAG;AAClB,SAAO,KAAK,QAAQ,MAAM,YAAY,iBAAS,CAAC,KACzC,MAAM,WAAW,iBAClB,MAAM,YAAa,IAAI,MAAM,CAAC,MAAM,IAAI,GAAG,eAAO,iBAClD,aAAa,QAAQ,cACrB,aAAa,OAAO,eACpB,cAAc,CAAC,IAAI,sBACnB,MAAM,QAAQ,CAAC,IAAI,eACnB,OAAO,EAAE,YAAY,cAAc,OAAO,EAAE,aAAa,cAAc,MAAM,CAAC,IAAI,iBAClF,gBAAQ,GAAG,CAAC;AACpB;;;ACrBe,SAAR,cAAiB,GAAG,GAAG;AAC5B,SAAO,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,SAAS,GAAG;AACjC,WAAO,KAAK,MAAM,KAAK,IAAI,KAAK,IAAI,CAAC;AAAA,EACvC;AACF;;;ACJe,SAAR,UAA2BC,IAAG;AACnC,SAAO,WAAW;AAChB,WAAOA;AAAA,EACT;AACF;;;ACJe,SAARC,QAAwBC,IAAG;AAChC,SAAO,CAACA;AACV;;;ACGA,IAAI,OAAO,CAAC,GAAG,CAAC;AAET,SAAS,SAASC,IAAG;AAC1B,SAAOA;AACT;AAEA,SAAS,UAAU,GAAG,GAAG;AACvB,UAAQ,KAAM,IAAI,CAAC,KACb,SAASA,IAAG;AAAE,YAAQA,KAAI,KAAK;AAAA,EAAG,IAClC,UAAS,MAAM,CAAC,IAAI,MAAM,GAAG;AACrC;AAEA,SAAS,QAAQ,GAAG,GAAG;AACrB,MAAI;AACJ,MAAI,IAAI,EAAG,KAAI,GAAG,IAAI,GAAG,IAAI;AAC7B,SAAO,SAASA,IAAG;AAAE,WAAO,KAAK,IAAI,GAAG,KAAK,IAAI,GAAGA,EAAC,CAAC;AAAA,EAAG;AAC3D;AAIA,SAAS,MAAM,QAAQC,QAAO,aAAa;AACzC,MAAI,KAAK,OAAO,CAAC,GAAG,KAAK,OAAO,CAAC,GAAG,KAAKA,OAAM,CAAC,GAAG,KAAKA,OAAM,CAAC;AAC/D,MAAI,KAAK,GAAI,MAAK,UAAU,IAAI,EAAE,GAAG,KAAK,YAAY,IAAI,EAAE;AAAA,MACvD,MAAK,UAAU,IAAI,EAAE,GAAG,KAAK,YAAY,IAAI,EAAE;AACpD,SAAO,SAASD,IAAG;AAAE,WAAO,GAAG,GAAGA,EAAC,CAAC;AAAA,EAAG;AACzC;AAEA,SAAS,QAAQ,QAAQC,QAAO,aAAa;AAC3C,MAAI,IAAI,KAAK,IAAI,OAAO,QAAQA,OAAM,MAAM,IAAI,GAC5C,IAAI,IAAI,MAAM,CAAC,GACfC,KAAI,IAAI,MAAM,CAAC,GACf,IAAI;AAGR,MAAI,OAAO,CAAC,IAAI,OAAO,CAAC,GAAG;AACzB,aAAS,OAAO,MAAM,EAAE,QAAQ;AAChC,IAAAD,SAAQA,OAAM,MAAM,EAAE,QAAQ;AAAA,EAChC;AAEA,SAAO,EAAE,IAAI,GAAG;AACd,MAAE,CAAC,IAAI,UAAU,OAAO,CAAC,GAAG,OAAO,IAAI,CAAC,CAAC;AACzC,IAAAC,GAAE,CAAC,IAAI,YAAYD,OAAM,CAAC,GAAGA,OAAM,IAAI,CAAC,CAAC;AAAA,EAC3C;AAEA,SAAO,SAASD,IAAG;AACjB,QAAIG,KAAI,eAAO,QAAQH,IAAG,GAAG,CAAC,IAAI;AAClC,WAAOE,GAAEC,EAAC,EAAE,EAAEA,EAAC,EAAEH,EAAC,CAAC;AAAA,EACrB;AACF;AAEO,SAAS,KAAK,QAAQ,QAAQ;AACnC,SAAO,OACF,OAAO,OAAO,OAAO,CAAC,EACtB,MAAM,OAAO,MAAM,CAAC,EACpB,YAAY,OAAO,YAAY,CAAC,EAChC,MAAM,OAAO,MAAM,CAAC,EACpB,QAAQ,OAAO,QAAQ,CAAC;AAC/B;AAEO,SAAS,cAAc;AAC5B,MAAI,SAAS,MACTC,SAAQ,MACR,cAAc,eACd,WACA,aACA,SACA,QAAQ,UACR,WACA,QACA;AAEJ,WAAS,UAAU;AACjB,QAAI,IAAI,KAAK,IAAI,OAAO,QAAQA,OAAM,MAAM;AAC5C,QAAI,UAAU,SAAU,SAAQ,QAAQ,OAAO,CAAC,GAAG,OAAO,IAAI,CAAC,CAAC;AAChE,gBAAY,IAAI,IAAI,UAAU;AAC9B,aAAS,QAAQ;AACjB,WAAO;AAAA,EACT;AAEA,WAAS,MAAMD,IAAG;AAChB,WAAOA,MAAK,QAAQ,MAAMA,KAAI,CAACA,EAAC,IAAI,WAAW,WAAW,SAAS,UAAU,OAAO,IAAI,SAAS,GAAGC,QAAO,WAAW,IAAI,UAAU,MAAMD,EAAC,CAAC,CAAC;AAAA,EAC/I;AAEA,QAAM,SAAS,SAASI,IAAG;AACzB,WAAO,MAAM,aAAa,UAAU,QAAQ,UAAUH,QAAO,OAAO,IAAI,SAAS,GAAG,cAAiB,IAAIG,EAAC,CAAC,CAAC;AAAA,EAC9G;AAEA,QAAM,SAAS,SAAS,GAAG;AACzB,WAAO,UAAU,UAAU,SAAS,MAAM,KAAK,GAAGC,OAAM,GAAG,QAAQ,KAAK,OAAO,MAAM;AAAA,EACvF;AAEA,QAAM,QAAQ,SAAS,GAAG;AACxB,WAAO,UAAU,UAAUJ,SAAQ,MAAM,KAAK,CAAC,GAAG,QAAQ,KAAKA,OAAM,MAAM;AAAA,EAC7E;AAEA,QAAM,aAAa,SAAS,GAAG;AAC7B,WAAOA,SAAQ,MAAM,KAAK,CAAC,GAAG,cAAc,eAAkB,QAAQ;AAAA,EACxE;AAEA,QAAM,QAAQ,SAAS,GAAG;AACxB,WAAO,UAAU,UAAU,QAAQ,IAAI,OAAO,UAAU,QAAQ,KAAK,UAAU;AAAA,EACjF;AAEA,QAAM,cAAc,SAAS,GAAG;AAC9B,WAAO,UAAU,UAAU,cAAc,GAAG,QAAQ,KAAK;AAAA,EAC3D;AAEA,QAAM,UAAU,SAAS,GAAG;AAC1B,WAAO,UAAU,UAAU,UAAU,GAAG,SAAS;AAAA,EACnD;AAEA,SAAO,SAAS,GAAG,GAAG;AACpB,gBAAY,GAAG,cAAc;AAC7B,WAAO,QAAQ;AAAA,EACjB;AACF;AAEe,SAAR,aAA8B;AACnC,SAAO,YAAY,EAAE,UAAU,QAAQ;AACzC;;;AC5He,SAAR,sBAAiBK,IAAG;AACzB,SAAO,KAAK,IAAIA,KAAI,KAAK,MAAMA,EAAC,CAAC,KAAK,OAChCA,GAAE,eAAe,IAAI,EAAE,QAAQ,MAAM,EAAE,IACvCA,GAAE,SAAS,EAAE;AACrB;AAKO,SAAS,mBAAmBA,IAAG,GAAG;AACvC,OAAK,KAAKA,KAAI,IAAIA,GAAE,cAAc,IAAI,CAAC,IAAIA,GAAE,cAAc,GAAG,QAAQ,GAAG,KAAK,EAAG,QAAO;AACxF,MAAI,GAAG,cAAcA,GAAE,MAAM,GAAG,CAAC;AAIjC,SAAO;AAAA,IACL,YAAY,SAAS,IAAI,YAAY,CAAC,IAAI,YAAY,MAAM,CAAC,IAAI;AAAA,IACjE,CAACA,GAAE,MAAM,IAAI,CAAC;AAAA,EAChB;AACF;;;ACjBe,SAAR,iBAAiBC,IAAG;AACzB,SAAOA,KAAI,mBAAmB,KAAK,IAAIA,EAAC,CAAC,GAAGA,KAAIA,GAAE,CAAC,IAAI;AACzD;;;ACJe,SAAR,oBAAiB,UAAU,WAAW;AAC3C,SAAO,SAAS,OAAO,OAAO;AAC5B,QAAI,IAAI,MAAM,QACV,IAAI,CAAC,GACL,IAAI,GACJ,IAAI,SAAS,CAAC,GACd,SAAS;AAEb,WAAO,IAAI,KAAK,IAAI,GAAG;AACrB,UAAI,SAAS,IAAI,IAAI,MAAO,KAAI,KAAK,IAAI,GAAG,QAAQ,MAAM;AAC1D,QAAE,KAAK,MAAM,UAAU,KAAK,GAAG,IAAI,CAAC,CAAC;AACrC,WAAK,UAAU,IAAI,KAAK,MAAO;AAC/B,UAAI,SAAS,KAAK,IAAI,KAAK,SAAS,MAAM;AAAA,IAC5C;AAEA,WAAO,EAAE,QAAQ,EAAE,KAAK,SAAS;AAAA,EACnC;AACF;;;ACjBe,SAAR,uBAAiB,UAAU;AAChC,SAAO,SAAS,OAAO;AACrB,WAAO,MAAM,QAAQ,UAAU,SAAS,GAAG;AACzC,aAAO,SAAS,CAAC,CAAC;AAAA,IACpB,CAAC;AAAA,EACH;AACF;;;ACLA,IAAI,KAAK;AAEM,SAAR,gBAAiC,WAAW;AACjD,MAAI,EAAE,QAAQ,GAAG,KAAK,SAAS,GAAI,OAAM,IAAI,MAAM,qBAAqB,SAAS;AACjF,MAAI;AACJ,SAAO,IAAI,gBAAgB;AAAA,IACzB,MAAM,MAAM,CAAC;AAAA,IACb,OAAO,MAAM,CAAC;AAAA,IACd,MAAM,MAAM,CAAC;AAAA,IACb,QAAQ,MAAM,CAAC;AAAA,IACf,MAAM,MAAM,CAAC;AAAA,IACb,OAAO,MAAM,CAAC;AAAA,IACd,OAAO,MAAM,CAAC;AAAA,IACd,WAAW,MAAM,CAAC,KAAK,MAAM,CAAC,EAAE,MAAM,CAAC;AAAA,IACvC,MAAM,MAAM,CAAC;AAAA,IACb,MAAM,MAAM,EAAE;AAAA,EAChB,CAAC;AACH;AAEA,gBAAgB,YAAY,gBAAgB;AAErC,SAAS,gBAAgB,WAAW;AACzC,OAAK,OAAO,UAAU,SAAS,SAAY,MAAM,UAAU,OAAO;AAClE,OAAK,QAAQ,UAAU,UAAU,SAAY,MAAM,UAAU,QAAQ;AACrE,OAAK,OAAO,UAAU,SAAS,SAAY,MAAM,UAAU,OAAO;AAClE,OAAK,SAAS,UAAU,WAAW,SAAY,KAAK,UAAU,SAAS;AACvE,OAAK,OAAO,CAAC,CAAC,UAAU;AACxB,OAAK,QAAQ,UAAU,UAAU,SAAY,SAAY,CAAC,UAAU;AACpE,OAAK,QAAQ,CAAC,CAAC,UAAU;AACzB,OAAK,YAAY,UAAU,cAAc,SAAY,SAAY,CAAC,UAAU;AAC5E,OAAK,OAAO,CAAC,CAAC,UAAU;AACxB,OAAK,OAAO,UAAU,SAAS,SAAY,KAAK,UAAU,OAAO;AACnE;AAEA,gBAAgB,UAAU,WAAW,WAAW;AAC9C,SAAO,KAAK,OACN,KAAK,QACL,KAAK,OACL,KAAK,UACJ,KAAK,OAAO,MAAM,OAClB,KAAK,UAAU,SAAY,KAAK,KAAK,IAAI,GAAG,KAAK,QAAQ,CAAC,MAC1D,KAAK,QAAQ,MAAM,OACnB,KAAK,cAAc,SAAY,KAAK,MAAM,KAAK,IAAI,GAAG,KAAK,YAAY,CAAC,MACxE,KAAK,OAAO,MAAM,MACnB,KAAK;AACb;;;AC7Ce,SAAR,mBAAiB,GAAG;AACzB,MAAK,UAAS,IAAI,EAAE,QAAQ,IAAI,GAAG,KAAK,IAAI,IAAI,IAAI,GAAG,EAAE,GAAG;AAC1D,YAAQ,EAAE,CAAC,GAAG;AAAA,MACZ,KAAK;AAAK,aAAK,KAAK;AAAG;AAAA,MACvB,KAAK;AAAK,YAAI,OAAO,EAAG,MAAK;AAAG,aAAK;AAAG;AAAA,MACxC;AAAS,YAAI,CAAC,CAAC,EAAE,CAAC,EAAG,OAAM;AAAK,YAAI,KAAK,EAAG,MAAK;AAAG;AAAA,IACtD;AAAA,EACF;AACA,SAAO,KAAK,IAAI,EAAE,MAAM,GAAG,EAAE,IAAI,EAAE,MAAM,KAAK,CAAC,IAAI;AACrD;;;ACRO,IAAI;AAEI,SAAR,yBAAiBC,IAAG,GAAG;AAC5B,MAAI,IAAI,mBAAmBA,IAAG,CAAC;AAC/B,MAAI,CAAC,EAAG,QAAOA,KAAI;AACnB,MAAI,cAAc,EAAE,CAAC,GACjB,WAAW,EAAE,CAAC,GACd,IAAI,YAAY,iBAAiB,KAAK,IAAI,IAAI,KAAK,IAAI,GAAG,KAAK,MAAM,WAAW,CAAC,CAAC,CAAC,IAAI,KAAK,GAC5F,IAAI,YAAY;AACpB,SAAO,MAAM,IAAI,cACX,IAAI,IAAI,cAAc,IAAI,MAAM,IAAI,IAAI,CAAC,EAAE,KAAK,GAAG,IACnD,IAAI,IAAI,YAAY,MAAM,GAAG,CAAC,IAAI,MAAM,YAAY,MAAM,CAAC,IAC3D,OAAO,IAAI,MAAM,IAAI,CAAC,EAAE,KAAK,GAAG,IAAI,mBAAmBA,IAAG,KAAK,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC,EAAE,CAAC;AAC3F;;;ACbe,SAAR,sBAAiBC,IAAG,GAAG;AAC5B,MAAI,IAAI,mBAAmBA,IAAG,CAAC;AAC/B,MAAI,CAAC,EAAG,QAAOA,KAAI;AACnB,MAAI,cAAc,EAAE,CAAC,GACjB,WAAW,EAAE,CAAC;AAClB,SAAO,WAAW,IAAI,OAAO,IAAI,MAAM,CAAC,QAAQ,EAAE,KAAK,GAAG,IAAI,cACxD,YAAY,SAAS,WAAW,IAAI,YAAY,MAAM,GAAG,WAAW,CAAC,IAAI,MAAM,YAAY,MAAM,WAAW,CAAC,IAC7G,cAAc,IAAI,MAAM,WAAW,YAAY,SAAS,CAAC,EAAE,KAAK,GAAG;AAC3E;;;ACNA,IAAO,sBAAQ;AAAA,EACb,KAAK,CAACC,IAAG,OAAOA,KAAI,KAAK,QAAQ,CAAC;AAAA,EAClC,KAAK,CAACA,OAAM,KAAK,MAAMA,EAAC,EAAE,SAAS,CAAC;AAAA,EACpC,KAAK,CAACA,OAAMA,KAAI;AAAA,EAChB,KAAK;AAAA,EACL,KAAK,CAACA,IAAG,MAAMA,GAAE,cAAc,CAAC;AAAA,EAChC,KAAK,CAACA,IAAG,MAAMA,GAAE,QAAQ,CAAC;AAAA,EAC1B,KAAK,CAACA,IAAG,MAAMA,GAAE,YAAY,CAAC;AAAA,EAC9B,KAAK,CAACA,OAAM,KAAK,MAAMA,EAAC,EAAE,SAAS,CAAC;AAAA,EACpC,KAAK,CAACA,IAAG,MAAM,sBAAcA,KAAI,KAAK,CAAC;AAAA,EACvC,KAAK;AAAA,EACL,KAAK;AAAA,EACL,KAAK,CAACA,OAAM,KAAK,MAAMA,EAAC,EAAE,SAAS,EAAE,EAAE,YAAY;AAAA,EACnD,KAAK,CAACA,OAAM,KAAK,MAAMA,EAAC,EAAE,SAAS,EAAE;AACvC;;;AClBe,SAAR,iBAAiBC,IAAG;AACzB,SAAOA;AACT;;;ACOA,IAAI,MAAM,MAAM,UAAU;AAA1B,IACI,WAAW,CAAC,KAAI,KAAI,KAAI,KAAI,KAAI,KAAI,QAAI,KAAI,IAAG,KAAI,KAAI,KAAI,KAAI,KAAI,KAAI,KAAI,GAAG;AAEnE,SAAR,eAAiBC,SAAQ;AAC9B,MAAI,QAAQA,QAAO,aAAa,UAAaA,QAAO,cAAc,SAAY,mBAAW,oBAAY,IAAI,KAAKA,QAAO,UAAU,MAAM,GAAGA,QAAO,YAAY,EAAE,GACzJ,iBAAiBA,QAAO,aAAa,SAAY,KAAKA,QAAO,SAAS,CAAC,IAAI,IAC3E,iBAAiBA,QAAO,aAAa,SAAY,KAAKA,QAAO,SAAS,CAAC,IAAI,IAC3E,UAAUA,QAAO,YAAY,SAAY,MAAMA,QAAO,UAAU,IAChE,WAAWA,QAAO,aAAa,SAAY,mBAAW,uBAAe,IAAI,KAAKA,QAAO,UAAU,MAAM,CAAC,GACtG,UAAUA,QAAO,YAAY,SAAY,MAAMA,QAAO,UAAU,IAChE,QAAQA,QAAO,UAAU,SAAY,WAAMA,QAAO,QAAQ,IAC1D,MAAMA,QAAO,QAAQ,SAAY,QAAQA,QAAO,MAAM;AAE1D,WAAS,UAAU,WAAW;AAC5B,gBAAY,gBAAgB,SAAS;AAErC,QAAI,OAAO,UAAU,MACjB,QAAQ,UAAU,OAClBC,QAAO,UAAU,MACjB,SAAS,UAAU,QACnBC,QAAO,UAAU,MACjB,QAAQ,UAAU,OAClB,QAAQ,UAAU,OAClB,YAAY,UAAU,WACtB,OAAO,UAAU,MACjB,OAAO,UAAU;AAGrB,QAAI,SAAS,IAAK,SAAQ,MAAM,OAAO;AAAA,aAG9B,CAAC,oBAAY,IAAI,EAAG,eAAc,WAAc,YAAY,KAAK,OAAO,MAAM,OAAO;AAG9F,QAAIA,SAAS,SAAS,OAAO,UAAU,IAAM,CAAAA,QAAO,MAAM,OAAO,KAAK,QAAQ;AAI9E,QAAI,SAAS,WAAW,MAAM,iBAAiB,WAAW,OAAO,SAAS,KAAK,IAAI,IAAI,MAAM,KAAK,YAAY,IAAI,IAC9G,SAAS,WAAW,MAAM,iBAAiB,OAAO,KAAK,IAAI,IAAI,UAAU;AAK7E,QAAI,aAAa,oBAAY,IAAI,GAC7B,cAAc,aAAa,KAAK,IAAI;AAMxC,gBAAY,cAAc,SAAY,IAChC,SAAS,KAAK,IAAI,IAAI,KAAK,IAAI,GAAG,KAAK,IAAI,IAAI,SAAS,CAAC,IACzD,KAAK,IAAI,GAAG,KAAK,IAAI,IAAI,SAAS,CAAC;AAEzC,aAASC,QAAO,OAAO;AACrB,UAAI,cAAc,QACd,cAAc,QACd,GAAG,GAAG;AAEV,UAAI,SAAS,KAAK;AAChB,sBAAc,WAAW,KAAK,IAAI;AAClC,gBAAQ;AAAA,MACV,OAAO;AACL,gBAAQ,CAAC;AAGT,YAAI,gBAAgB,QAAQ,KAAK,IAAI,QAAQ;AAG7C,gBAAQ,MAAM,KAAK,IAAI,MAAM,WAAW,KAAK,IAAI,KAAK,GAAG,SAAS;AAGlE,YAAI,KAAM,SAAQ,mBAAW,KAAK;AAGlC,YAAI,iBAAiB,CAAC,UAAU,KAAKF,UAAS,IAAK,iBAAgB;AAGnE,uBAAe,gBAAiBA,UAAS,MAAMA,QAAO,QAASA,UAAS,OAAOA,UAAS,MAAM,KAAKA,SAAQ;AAC3G,uBAAe,SAAS,MAAM,SAAS,IAAI,iBAAiB,CAAC,IAAI,MAAM,eAAe,iBAAiBA,UAAS,MAAM,MAAM;AAI5H,YAAI,aAAa;AACf,cAAI,IAAI,IAAI,MAAM;AAClB,iBAAO,EAAE,IAAI,GAAG;AACd,gBAAI,IAAI,MAAM,WAAW,CAAC,GAAG,KAAK,KAAK,IAAI,IAAI;AAC7C,6BAAe,MAAM,KAAK,UAAU,MAAM,MAAM,IAAI,CAAC,IAAI,MAAM,MAAM,CAAC,KAAK;AAC3E,sBAAQ,MAAM,MAAM,GAAG,CAAC;AACxB;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAGA,UAAI,SAAS,CAACC,MAAM,SAAQ,MAAM,OAAO,QAAQ;AAGjD,UAAI,SAAS,YAAY,SAAS,MAAM,SAAS,YAAY,QACzD,UAAU,SAAS,QAAQ,IAAI,MAAM,QAAQ,SAAS,CAAC,EAAE,KAAK,IAAI,IAAI;AAG1E,UAAI,SAASA,MAAM,SAAQ,MAAM,UAAU,OAAO,QAAQ,SAAS,QAAQ,YAAY,SAAS,QAAQ,GAAG,UAAU;AAGrH,cAAQ,OAAO;AAAA,QACb,KAAK;AAAK,kBAAQ,cAAc,QAAQ,cAAc;AAAS;AAAA,QAC/D,KAAK;AAAK,kBAAQ,cAAc,UAAU,QAAQ;AAAa;AAAA,QAC/D,KAAK;AAAK,kBAAQ,QAAQ,MAAM,GAAG,SAAS,QAAQ,UAAU,CAAC,IAAI,cAAc,QAAQ,cAAc,QAAQ,MAAM,MAAM;AAAG;AAAA,QAC9H;AAAS,kBAAQ,UAAU,cAAc,QAAQ;AAAa;AAAA,MAChE;AAEA,aAAO,SAAS,KAAK;AAAA,IACvB;AAEA,IAAAC,QAAO,WAAW,WAAW;AAC3B,aAAO,YAAY;AAAA,IACrB;AAEA,WAAOA;AAAA,EACT;AAEA,WAASC,cAAa,WAAW,OAAO;AACtC,QAAI,IAAI,WAAW,YAAY,gBAAgB,SAAS,GAAG,UAAU,OAAO,KAAK,UAAU,GACvF,IAAI,KAAK,IAAI,IAAI,KAAK,IAAI,GAAG,KAAK,MAAM,iBAAS,KAAK,IAAI,CAAC,CAAC,CAAC,IAAI,GACjE,IAAI,KAAK,IAAI,IAAI,CAAC,CAAC,GACnB,SAAS,SAAS,IAAI,IAAI,CAAC;AAC/B,WAAO,SAASC,QAAO;AACrB,aAAO,EAAE,IAAIA,MAAK,IAAI;AAAA,IACxB;AAAA,EACF;AAEA,SAAO;AAAA,IACL,QAAQ;AAAA,IACR,cAAcD;AAAA,EAChB;AACF;;;ACjJA,IAAI;AACG,IAAI;AACJ,IAAI;AAEX,cAAc;AAAA,EACZ,WAAW;AAAA,EACX,UAAU,CAAC,CAAC;AAAA,EACZ,UAAU,CAAC,KAAK,EAAE;AACpB,CAAC;AAEc,SAAR,cAA+B,YAAY;AAChD,WAAS,eAAa,UAAU;AAChC,WAAS,OAAO;AAChB,iBAAe,OAAO;AACtB,SAAO;AACT;;;ACfe,SAAR,uBAAiB,MAAM;AAC5B,SAAO,KAAK,IAAI,GAAG,CAAC,iBAAS,KAAK,IAAI,IAAI,CAAC,CAAC;AAC9C;;;ACFe,SAAR,wBAAiB,MAAM,OAAO;AACnC,SAAO,KAAK,IAAI,GAAG,KAAK,IAAI,IAAI,KAAK,IAAI,GAAG,KAAK,MAAM,iBAAS,KAAK,IAAI,CAAC,CAAC,CAAC,IAAI,IAAI,iBAAS,KAAK,IAAI,IAAI,CAAC,CAAC;AAC9G;;;ACFe,SAAR,uBAAiB,MAAM,KAAK;AACjC,SAAO,KAAK,IAAI,IAAI,GAAG,MAAM,KAAK,IAAI,GAAG,IAAI;AAC7C,SAAO,KAAK,IAAI,GAAG,iBAAS,GAAG,IAAI,iBAAS,IAAI,CAAC,IAAI;AACvD;;;ACFe,SAAR,WAA4B,OAAO,MAAM,OAAO,WAAW;AAChE,MAAI,OAAO,SAAS,OAAO,MAAM,KAAK,GAClC;AACJ,cAAY,gBAAgB,aAAa,OAAO,OAAO,SAAS;AAChE,UAAQ,UAAU,MAAM;AAAA,IACtB,KAAK,KAAK;AACR,UAAI,QAAQ,KAAK,IAAI,KAAK,IAAI,KAAK,GAAG,KAAK,IAAI,IAAI,CAAC;AACpD,UAAI,UAAU,aAAa,QAAQ,CAAC,MAAM,YAAY,wBAAgB,MAAM,KAAK,CAAC,EAAG,WAAU,YAAY;AAC3G,aAAO,aAAa,WAAW,KAAK;AAAA,IACtC;AAAA,IACA,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK,KAAK;AACR,UAAI,UAAU,aAAa,QAAQ,CAAC,MAAM,YAAY,uBAAe,MAAM,KAAK,IAAI,KAAK,IAAI,KAAK,GAAG,KAAK,IAAI,IAAI,CAAC,CAAC,CAAC,EAAG,WAAU,YAAY,aAAa,UAAU,SAAS;AAC9K;AAAA,IACF;AAAA,IACA,KAAK;AAAA,IACL,KAAK,KAAK;AACR,UAAI,UAAU,aAAa,QAAQ,CAAC,MAAM,YAAY,uBAAe,IAAI,CAAC,EAAG,WAAU,YAAY,aAAa,UAAU,SAAS,OAAO;AAC1I;AAAA,IACF;AAAA,EACF;AACA,SAAO,OAAO,SAAS;AACzB;;;ACvBO,SAAS,UAAU,OAAO;AAC/B,MAAI,SAAS,MAAM;AAEnB,QAAM,QAAQ,SAAS,OAAO;AAC5B,QAAI,IAAI,OAAO;AACf,WAAO,MAAM,EAAE,CAAC,GAAG,EAAE,EAAE,SAAS,CAAC,GAAG,SAAS,OAAO,KAAK,KAAK;AAAA,EAChE;AAEA,QAAM,aAAa,SAAS,OAAO,WAAW;AAC5C,QAAI,IAAI,OAAO;AACf,WAAO,WAAW,EAAE,CAAC,GAAG,EAAE,EAAE,SAAS,CAAC,GAAG,SAAS,OAAO,KAAK,OAAO,SAAS;AAAA,EAChF;AAEA,QAAM,OAAO,SAAS,OAAO;AAC3B,QAAI,SAAS,KAAM,SAAQ;AAE3B,QAAI,IAAI,OAAO;AACf,QAAI,KAAK;AACT,QAAI,KAAK,EAAE,SAAS;AACpB,QAAI,QAAQ,EAAE,EAAE;AAChB,QAAI,OAAO,EAAE,EAAE;AACf,QAAI;AACJ,QAAI;AACJ,QAAI,UAAU;AAEd,QAAI,OAAO,OAAO;AAChB,aAAO,OAAO,QAAQ,MAAM,OAAO;AACnC,aAAO,IAAI,KAAK,IAAI,KAAK;AAAA,IAC3B;AAEA,WAAO,YAAY,GAAG;AACpB,aAAO,cAAc,OAAO,MAAM,KAAK;AACvC,UAAI,SAAS,SAAS;AACpB,UAAE,EAAE,IAAI;AACR,UAAE,EAAE,IAAI;AACR,eAAO,OAAO,CAAC;AAAA,MACjB,WAAW,OAAO,GAAG;AACnB,gBAAQ,KAAK,MAAM,QAAQ,IAAI,IAAI;AACnC,eAAO,KAAK,KAAK,OAAO,IAAI,IAAI;AAAA,MAClC,WAAW,OAAO,GAAG;AACnB,gBAAQ,KAAK,KAAK,QAAQ,IAAI,IAAI;AAClC,eAAO,KAAK,MAAM,OAAO,IAAI,IAAI;AAAA,MACnC,OAAO;AACL;AAAA,MACF;AACA,gBAAU;AAAA,IACZ;AAEA,WAAO;AAAA,EACT;AAEA,SAAO;AACT;AAEe,SAARE,UAA0B;AAC/B,MAAI,QAAQ,WAAW;AAEvB,QAAM,OAAO,WAAW;AACtB,WAAO,KAAK,OAAOA,QAAO,CAAC;AAAA,EAC7B;AAEA,YAAU,MAAM,OAAO,SAAS;AAEhC,SAAO,UAAU,KAAK;AACxB;;;ACrEe,SAAR,KAAsB,QAAQ,UAAU;AAC7C,WAAS,OAAO,MAAM;AAEtB,MAAI,KAAK,GACL,KAAK,OAAO,SAAS,GACrB,KAAK,OAAO,EAAE,GACd,KAAK,OAAO,EAAE,GACd;AAEJ,MAAI,KAAK,IAAI;AACX,QAAI,IAAI,KAAK,IAAI,KAAK;AACtB,QAAI,IAAI,KAAK,IAAI,KAAK;AAAA,EACxB;AAEA,SAAO,EAAE,IAAI,SAAS,MAAM,EAAE;AAC9B,SAAO,EAAE,IAAI,SAAS,KAAK,EAAE;AAC7B,SAAO;AACT;;;ACjBA,IAAM,KAAK,oBAAI;AAAf,IAAqB,KAAK,oBAAI;AAEvB,SAAS,aAAa,QAAQ,SAAS,OAAO,OAAO;AAE1D,WAAS,SAASC,OAAM;AACtB,WAAO,OAAOA,QAAO,UAAU,WAAW,IAAI,oBAAI,SAAO,oBAAI,KAAK,CAACA,KAAI,CAAC,GAAGA;AAAA,EAC7E;AAEA,WAAS,QAAQ,CAACA,UAAS;AACzB,WAAO,OAAOA,QAAO,oBAAI,KAAK,CAACA,KAAI,CAAC,GAAGA;AAAA,EACzC;AAEA,WAAS,OAAO,CAACA,UAAS;AACxB,WAAO,OAAOA,QAAO,IAAI,KAAKA,QAAO,CAAC,CAAC,GAAG,QAAQA,OAAM,CAAC,GAAG,OAAOA,KAAI,GAAGA;AAAA,EAC5E;AAEA,WAAS,QAAQ,CAACA,UAAS;AACzB,UAAM,KAAK,SAASA,KAAI,GAAG,KAAK,SAAS,KAAKA,KAAI;AAClD,WAAOA,QAAO,KAAK,KAAKA,QAAO,KAAK;AAAA,EACtC;AAEA,WAAS,SAAS,CAACA,OAAM,SAAS;AAChC,WAAO,QAAQA,QAAO,oBAAI,KAAK,CAACA,KAAI,GAAG,QAAQ,OAAO,IAAI,KAAK,MAAM,IAAI,CAAC,GAAGA;AAAA,EAC/E;AAEA,WAAS,QAAQ,CAAC,OAAO,MAAM,SAAS;AACtC,UAAMC,SAAQ,CAAC;AACf,YAAQ,SAAS,KAAK,KAAK;AAC3B,WAAO,QAAQ,OAAO,IAAI,KAAK,MAAM,IAAI;AACzC,QAAI,EAAE,QAAQ,SAAS,EAAE,OAAO,GAAI,QAAOA;AAC3C,QAAI;AACJ;AAAG,MAAAA,OAAM,KAAK,WAAW,oBAAI,KAAK,CAAC,KAAK,CAAC,GAAG,QAAQ,OAAO,IAAI,GAAG,OAAO,KAAK;AAAA,WACvE,WAAW,SAAS,QAAQ;AACnC,WAAOA;AAAA,EACT;AAEA,WAAS,SAAS,CAAC,SAAS;AAC1B,WAAO,aAAa,CAACD,UAAS;AAC5B,UAAIA,SAAQA,MAAM,QAAO,OAAOA,KAAI,GAAG,CAAC,KAAKA,KAAI,EAAG,CAAAA,MAAK,QAAQA,QAAO,CAAC;AAAA,IAC3E,GAAG,CAACA,OAAM,SAAS;AACjB,UAAIA,SAAQA,OAAM;AAChB,YAAI,OAAO,EAAG,QAAO,EAAE,QAAQ,GAAG;AAChC,iBAAO,QAAQA,OAAM,EAAE,GAAG,CAAC,KAAKA,KAAI,GAAG;AAAA,UAAC;AAAA,QAC1C;AAAA,YAAO,QAAO,EAAE,QAAQ,GAAG;AACzB,iBAAO,QAAQA,OAAM,CAAE,GAAG,CAAC,KAAKA,KAAI,GAAG;AAAA,UAAC;AAAA,QAC1C;AAAA,MACF;AAAA,IACF,CAAC;AAAA,EACH;AAEA,MAAI,OAAO;AACT,aAAS,QAAQ,CAAC,OAAO,QAAQ;AAC/B,SAAG,QAAQ,CAAC,KAAK,GAAG,GAAG,QAAQ,CAAC,GAAG;AACnC,aAAO,EAAE,GAAG,OAAO,EAAE;AACrB,aAAO,KAAK,MAAM,MAAM,IAAI,EAAE,CAAC;AAAA,IACjC;AAEA,aAAS,QAAQ,CAAC,SAAS;AACzB,aAAO,KAAK,MAAM,IAAI;AACtB,aAAO,CAAC,SAAS,IAAI,KAAK,EAAE,OAAO,KAAK,OAClC,EAAE,OAAO,KAAK,WACd,SAAS,OAAO,QACZ,CAAC,MAAM,MAAM,CAAC,IAAI,SAAS,IAC3B,CAAC,MAAM,SAAS,MAAM,GAAG,CAAC,IAAI,SAAS,CAAC;AAAA,IACpD;AAAA,EACF;AAEA,SAAO;AACT;;;AClEO,IAAM,cAAc,aAAa,MAAM;AAE9C,GAAG,CAACE,OAAM,SAAS;AACjB,EAAAA,MAAK,QAAQ,CAACA,QAAO,IAAI;AAC3B,GAAG,CAAC,OAAO,QAAQ;AACjB,SAAO,MAAM;AACf,CAAC;AAGD,YAAY,QAAQ,CAAC,MAAM;AACzB,MAAI,KAAK,MAAM,CAAC;AAChB,MAAI,CAAC,SAAS,CAAC,KAAK,EAAE,IAAI,GAAI,QAAO;AACrC,MAAI,EAAE,IAAI,GAAI,QAAO;AACrB,SAAO,aAAa,CAACA,UAAS;AAC5B,IAAAA,MAAK,QAAQ,KAAK,MAAMA,QAAO,CAAC,IAAI,CAAC;AAAA,EACvC,GAAG,CAACA,OAAM,SAAS;AACjB,IAAAA,MAAK,QAAQ,CAACA,QAAO,OAAO,CAAC;AAAA,EAC/B,GAAG,CAAC,OAAO,QAAQ;AACjB,YAAQ,MAAM,SAAS;AAAA,EACzB,CAAC;AACH;AAEO,IAAM,eAAe,YAAY;;;ACxBjC,IAAM,iBAAiB;AACvB,IAAM,iBAAiB,iBAAiB;AACxC,IAAM,eAAe,iBAAiB;AACtC,IAAM,cAAc,eAAe;AACnC,IAAM,eAAe,cAAc;AACnC,IAAM,gBAAgB,cAAc;AACpC,IAAM,eAAe,cAAc;;;ACHnC,IAAM,SAAS,aAAa,CAACC,UAAS;AAC3C,EAAAA,MAAK,QAAQA,QAAOA,MAAK,gBAAgB,CAAC;AAC5C,GAAG,CAACA,OAAM,SAAS;AACjB,EAAAA,MAAK,QAAQ,CAACA,QAAO,OAAO,cAAc;AAC5C,GAAG,CAAC,OAAO,QAAQ;AACjB,UAAQ,MAAM,SAAS;AACzB,GAAG,CAACA,UAAS;AACX,SAAOA,MAAK,cAAc;AAC5B,CAAC;AAEM,IAAM,UAAU,OAAO;;;ACVvB,IAAM,aAAa,aAAa,CAACC,UAAS;AAC/C,EAAAA,MAAK,QAAQA,QAAOA,MAAK,gBAAgB,IAAIA,MAAK,WAAW,IAAI,cAAc;AACjF,GAAG,CAACA,OAAM,SAAS;AACjB,EAAAA,MAAK,QAAQ,CAACA,QAAO,OAAO,cAAc;AAC5C,GAAG,CAAC,OAAO,QAAQ;AACjB,UAAQ,MAAM,SAAS;AACzB,GAAG,CAACA,UAAS;AACX,SAAOA,MAAK,WAAW;AACzB,CAAC;AAEM,IAAM,cAAc,WAAW;AAE/B,IAAM,YAAY,aAAa,CAACA,UAAS;AAC9C,EAAAA,MAAK,cAAc,GAAG,CAAC;AACzB,GAAG,CAACA,OAAM,SAAS;AACjB,EAAAA,MAAK,QAAQ,CAACA,QAAO,OAAO,cAAc;AAC5C,GAAG,CAAC,OAAO,QAAQ;AACjB,UAAQ,MAAM,SAAS;AACzB,GAAG,CAACA,UAAS;AACX,SAAOA,MAAK,cAAc;AAC5B,CAAC;AAEM,IAAM,aAAa,UAAU;;;ACtB7B,IAAM,WAAW,aAAa,CAACC,UAAS;AAC7C,EAAAA,MAAK,QAAQA,QAAOA,MAAK,gBAAgB,IAAIA,MAAK,WAAW,IAAI,iBAAiBA,MAAK,WAAW,IAAI,cAAc;AACtH,GAAG,CAACA,OAAM,SAAS;AACjB,EAAAA,MAAK,QAAQ,CAACA,QAAO,OAAO,YAAY;AAC1C,GAAG,CAAC,OAAO,QAAQ;AACjB,UAAQ,MAAM,SAAS;AACzB,GAAG,CAACA,UAAS;AACX,SAAOA,MAAK,SAAS;AACvB,CAAC;AAEM,IAAM,YAAY,SAAS;AAE3B,IAAM,UAAU,aAAa,CAACA,UAAS;AAC5C,EAAAA,MAAK,cAAc,GAAG,GAAG,CAAC;AAC5B,GAAG,CAACA,OAAM,SAAS;AACjB,EAAAA,MAAK,QAAQ,CAACA,QAAO,OAAO,YAAY;AAC1C,GAAG,CAAC,OAAO,QAAQ;AACjB,UAAQ,MAAM,SAAS;AACzB,GAAG,CAACA,UAAS;AACX,SAAOA,MAAK,YAAY;AAC1B,CAAC;AAEM,IAAM,WAAW,QAAQ;;;ACtBzB,IAAM,UAAU;AAAA,EACrB,CAAAC,UAAQA,MAAK,SAAS,GAAG,GAAG,GAAG,CAAC;AAAA,EAChC,CAACA,OAAM,SAASA,MAAK,QAAQA,MAAK,QAAQ,IAAI,IAAI;AAAA,EAClD,CAAC,OAAO,SAAS,MAAM,SAAS,IAAI,kBAAkB,IAAI,MAAM,kBAAkB,KAAK,kBAAkB;AAAA,EACzG,CAAAA,UAAQA,MAAK,QAAQ,IAAI;AAC3B;AAEO,IAAM,WAAW,QAAQ;AAEzB,IAAM,SAAS,aAAa,CAACA,UAAS;AAC3C,EAAAA,MAAK,YAAY,GAAG,GAAG,GAAG,CAAC;AAC7B,GAAG,CAACA,OAAM,SAAS;AACjB,EAAAA,MAAK,WAAWA,MAAK,WAAW,IAAI,IAAI;AAC1C,GAAG,CAAC,OAAO,QAAQ;AACjB,UAAQ,MAAM,SAAS;AACzB,GAAG,CAACA,UAAS;AACX,SAAOA,MAAK,WAAW,IAAI;AAC7B,CAAC;AAEM,IAAM,UAAU,OAAO;AAEvB,IAAM,UAAU,aAAa,CAACA,UAAS;AAC5C,EAAAA,MAAK,YAAY,GAAG,GAAG,GAAG,CAAC;AAC7B,GAAG,CAACA,OAAM,SAAS;AACjB,EAAAA,MAAK,WAAWA,MAAK,WAAW,IAAI,IAAI;AAC1C,GAAG,CAAC,OAAO,QAAQ;AACjB,UAAQ,MAAM,SAAS;AACzB,GAAG,CAACA,UAAS;AACX,SAAO,KAAK,MAAMA,QAAO,WAAW;AACtC,CAAC;AAEM,IAAM,WAAW,QAAQ;;;AC/BhC,SAAS,YAAY,GAAG;AACtB,SAAO,aAAa,CAACC,UAAS;AAC5B,IAAAA,MAAK,QAAQA,MAAK,QAAQ,KAAKA,MAAK,OAAO,IAAI,IAAI,KAAK,CAAC;AACzD,IAAAA,MAAK,SAAS,GAAG,GAAG,GAAG,CAAC;AAAA,EAC1B,GAAG,CAACA,OAAM,SAAS;AACjB,IAAAA,MAAK,QAAQA,MAAK,QAAQ,IAAI,OAAO,CAAC;AAAA,EACxC,GAAG,CAAC,OAAO,QAAQ;AACjB,YAAQ,MAAM,SAAS,IAAI,kBAAkB,IAAI,MAAM,kBAAkB,KAAK,kBAAkB;AAAA,EAClG,CAAC;AACH;AAEO,IAAM,aAAa,YAAY,CAAC;AAChC,IAAM,aAAa,YAAY,CAAC;AAChC,IAAM,cAAc,YAAY,CAAC;AACjC,IAAM,gBAAgB,YAAY,CAAC;AACnC,IAAM,eAAe,YAAY,CAAC;AAClC,IAAM,aAAa,YAAY,CAAC;AAChC,IAAM,eAAe,YAAY,CAAC;AAElC,IAAM,cAAc,WAAW;AAC/B,IAAM,cAAc,WAAW;AAC/B,IAAM,eAAe,YAAY;AACjC,IAAM,iBAAiB,cAAc;AACrC,IAAM,gBAAgB,aAAa;AACnC,IAAM,cAAc,WAAW;AAC/B,IAAM,gBAAgB,aAAa;AAE1C,SAAS,WAAW,GAAG;AACrB,SAAO,aAAa,CAACA,UAAS;AAC5B,IAAAA,MAAK,WAAWA,MAAK,WAAW,KAAKA,MAAK,UAAU,IAAI,IAAI,KAAK,CAAC;AAClE,IAAAA,MAAK,YAAY,GAAG,GAAG,GAAG,CAAC;AAAA,EAC7B,GAAG,CAACA,OAAM,SAAS;AACjB,IAAAA,MAAK,WAAWA,MAAK,WAAW,IAAI,OAAO,CAAC;AAAA,EAC9C,GAAG,CAAC,OAAO,QAAQ;AACjB,YAAQ,MAAM,SAAS;AAAA,EACzB,CAAC;AACH;AAEO,IAAM,YAAY,WAAW,CAAC;AAC9B,IAAM,YAAY,WAAW,CAAC;AAC9B,IAAM,aAAa,WAAW,CAAC;AAC/B,IAAM,eAAe,WAAW,CAAC;AACjC,IAAM,cAAc,WAAW,CAAC;AAChC,IAAM,YAAY,WAAW,CAAC;AAC9B,IAAM,cAAc,WAAW,CAAC;AAEhC,IAAM,aAAa,UAAU;AAC7B,IAAM,aAAa,UAAU;AAC7B,IAAM,cAAc,WAAW;AAC/B,IAAM,gBAAgB,aAAa;AACnC,IAAM,eAAe,YAAY;AACjC,IAAM,aAAa,UAAU;AAC7B,IAAM,eAAe,YAAY;;;ACrDjC,IAAM,YAAY,aAAa,CAACC,UAAS;AAC9C,EAAAA,MAAK,QAAQ,CAAC;AACd,EAAAA,MAAK,SAAS,GAAG,GAAG,GAAG,CAAC;AAC1B,GAAG,CAACA,OAAM,SAAS;AACjB,EAAAA,MAAK,SAASA,MAAK,SAAS,IAAI,IAAI;AACtC,GAAG,CAAC,OAAO,QAAQ;AACjB,SAAO,IAAI,SAAS,IAAI,MAAM,SAAS,KAAK,IAAI,YAAY,IAAI,MAAM,YAAY,KAAK;AACzF,GAAG,CAACA,UAAS;AACX,SAAOA,MAAK,SAAS;AACvB,CAAC;AAEM,IAAM,aAAa,UAAU;AAE7B,IAAM,WAAW,aAAa,CAACA,UAAS;AAC7C,EAAAA,MAAK,WAAW,CAAC;AACjB,EAAAA,MAAK,YAAY,GAAG,GAAG,GAAG,CAAC;AAC7B,GAAG,CAACA,OAAM,SAAS;AACjB,EAAAA,MAAK,YAAYA,MAAK,YAAY,IAAI,IAAI;AAC5C,GAAG,CAAC,OAAO,QAAQ;AACjB,SAAO,IAAI,YAAY,IAAI,MAAM,YAAY,KAAK,IAAI,eAAe,IAAI,MAAM,eAAe,KAAK;AACrG,GAAG,CAACA,UAAS;AACX,SAAOA,MAAK,YAAY;AAC1B,CAAC;AAEM,IAAM,YAAY,SAAS;;;ACxB3B,IAAM,WAAW,aAAa,CAACC,UAAS;AAC7C,EAAAA,MAAK,SAAS,GAAG,CAAC;AAClB,EAAAA,MAAK,SAAS,GAAG,GAAG,GAAG,CAAC;AAC1B,GAAG,CAACA,OAAM,SAAS;AACjB,EAAAA,MAAK,YAAYA,MAAK,YAAY,IAAI,IAAI;AAC5C,GAAG,CAAC,OAAO,QAAQ;AACjB,SAAO,IAAI,YAAY,IAAI,MAAM,YAAY;AAC/C,GAAG,CAACA,UAAS;AACX,SAAOA,MAAK,YAAY;AAC1B,CAAC;AAGD,SAAS,QAAQ,CAAC,MAAM;AACtB,SAAO,CAAC,SAAS,IAAI,KAAK,MAAM,CAAC,CAAC,KAAK,EAAE,IAAI,KAAK,OAAO,aAAa,CAACA,UAAS;AAC9E,IAAAA,MAAK,YAAY,KAAK,MAAMA,MAAK,YAAY,IAAI,CAAC,IAAI,CAAC;AACvD,IAAAA,MAAK,SAAS,GAAG,CAAC;AAClB,IAAAA,MAAK,SAAS,GAAG,GAAG,GAAG,CAAC;AAAA,EAC1B,GAAG,CAACA,OAAM,SAAS;AACjB,IAAAA,MAAK,YAAYA,MAAK,YAAY,IAAI,OAAO,CAAC;AAAA,EAChD,CAAC;AACH;AAEO,IAAM,YAAY,SAAS;AAE3B,IAAM,UAAU,aAAa,CAACA,UAAS;AAC5C,EAAAA,MAAK,YAAY,GAAG,CAAC;AACrB,EAAAA,MAAK,YAAY,GAAG,GAAG,GAAG,CAAC;AAC7B,GAAG,CAACA,OAAM,SAAS;AACjB,EAAAA,MAAK,eAAeA,MAAK,eAAe,IAAI,IAAI;AAClD,GAAG,CAAC,OAAO,QAAQ;AACjB,SAAO,IAAI,eAAe,IAAI,MAAM,eAAe;AACrD,GAAG,CAACA,UAAS;AACX,SAAOA,MAAK,eAAe;AAC7B,CAAC;AAGD,QAAQ,QAAQ,CAAC,MAAM;AACrB,SAAO,CAAC,SAAS,IAAI,KAAK,MAAM,CAAC,CAAC,KAAK,EAAE,IAAI,KAAK,OAAO,aAAa,CAACA,UAAS;AAC9E,IAAAA,MAAK,eAAe,KAAK,MAAMA,MAAK,eAAe,IAAI,CAAC,IAAI,CAAC;AAC7D,IAAAA,MAAK,YAAY,GAAG,CAAC;AACrB,IAAAA,MAAK,YAAY,GAAG,GAAG,GAAG,CAAC;AAAA,EAC7B,GAAG,CAACA,OAAM,SAAS;AACjB,IAAAA,MAAK,eAAeA,MAAK,eAAe,IAAI,OAAO,CAAC;AAAA,EACtD,CAAC;AACH;AAEO,IAAM,WAAW,QAAQ;;;ACrChC,SAAS,OAAO,MAAM,OAAO,MAAM,KAAK,MAAM,QAAQ;AAEpD,QAAM,gBAAgB;AAAA,IACpB,CAAC,QAAS,GAAQ,cAAc;AAAA,IAChC,CAAC,QAAS,GAAI,IAAI,cAAc;AAAA,IAChC,CAAC,QAAQ,IAAI,KAAK,cAAc;AAAA,IAChC,CAAC,QAAQ,IAAI,KAAK,cAAc;AAAA,IAChC,CAAC,QAAS,GAAQ,cAAc;AAAA,IAChC,CAAC,QAAS,GAAI,IAAI,cAAc;AAAA,IAChC,CAAC,QAAQ,IAAI,KAAK,cAAc;AAAA,IAChC,CAAC,QAAQ,IAAI,KAAK,cAAc;AAAA,IAChC,CAAG,MAAO,GAAQ,YAAc;AAAA,IAChC,CAAG,MAAO,GAAI,IAAI,YAAc;AAAA,IAChC,CAAG,MAAO,GAAI,IAAI,YAAc;AAAA,IAChC,CAAG,MAAM,IAAI,KAAK,YAAc;AAAA,IAChC,CAAI,KAAM,GAAQ,WAAc;AAAA,IAChC,CAAI,KAAM,GAAI,IAAI,WAAc;AAAA,IAChC,CAAG,MAAO,GAAQ,YAAc;AAAA,IAChC,CAAE,OAAQ,GAAQ,aAAc;AAAA,IAChC,CAAE,OAAQ,GAAI,IAAI,aAAc;AAAA,IAChC,CAAG,MAAO,GAAQ,YAAc;AAAA,EAClC;AAEA,WAASC,OAAM,OAAO,MAAM,OAAO;AACjC,UAAM,UAAU,OAAO;AACvB,QAAI,QAAS,EAAC,OAAO,IAAI,IAAI,CAAC,MAAM,KAAK;AACzC,UAAM,WAAW,SAAS,OAAO,MAAM,UAAU,aAAa,QAAQ,aAAa,OAAO,MAAM,KAAK;AACrG,UAAMA,SAAQ,WAAW,SAAS,MAAM,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC;AAC7D,WAAO,UAAUA,OAAM,QAAQ,IAAIA;AAAA,EACrC;AAEA,WAAS,aAAa,OAAO,MAAM,OAAO;AACxC,UAAM,SAAS,KAAK,IAAI,OAAO,KAAK,IAAI;AACxC,UAAM,IAAI,SAAS,CAAC,CAAC,EAAC,EAAEC,KAAI,MAAMA,KAAI,EAAE,MAAM,eAAe,MAAM;AACnE,QAAI,MAAM,cAAc,OAAQ,QAAO,KAAK,MAAM,SAAS,QAAQ,cAAc,OAAO,cAAc,KAAK,CAAC;AAC5G,QAAI,MAAM,EAAG,QAAO,YAAY,MAAM,KAAK,IAAI,SAAS,OAAO,MAAM,KAAK,GAAG,CAAC,CAAC;AAC/E,UAAM,CAAC,GAAG,IAAI,IAAI,cAAc,SAAS,cAAc,IAAI,CAAC,EAAE,CAAC,IAAI,cAAc,CAAC,EAAE,CAAC,IAAI,SAAS,IAAI,IAAI,CAAC;AAC3G,WAAO,EAAE,MAAM,IAAI;AAAA,EACrB;AAEA,SAAO,CAACD,QAAO,YAAY;AAC7B;AAEA,IAAM,CAAC,UAAU,eAAe,IAAI,OAAO,SAAS,UAAU,WAAW,SAAS,SAAS,SAAS;AACpG,IAAM,CAAC,WAAW,gBAAgB,IAAI,OAAO,UAAU,WAAW,YAAY,SAAS,UAAU,UAAU;;;AC1C3G,SAAS,UAAU,GAAG;AACpB,MAAI,KAAK,EAAE,KAAK,EAAE,IAAI,KAAK;AACzB,QAAIE,QAAO,IAAI,KAAK,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;AACpD,IAAAA,MAAK,YAAY,EAAE,CAAC;AACpB,WAAOA;AAAA,EACT;AACA,SAAO,IAAI,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;AACnD;AAEA,SAAS,QAAQ,GAAG;AAClB,MAAI,KAAK,EAAE,KAAK,EAAE,IAAI,KAAK;AACzB,QAAIA,QAAO,IAAI,KAAK,KAAK,IAAI,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC;AAC9D,IAAAA,MAAK,eAAe,EAAE,CAAC;AACvB,WAAOA;AAAA,EACT;AACA,SAAO,IAAI,KAAK,KAAK,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC;AAC7D;AAEA,SAAS,QAAQC,IAAG,GAAG,GAAG;AACxB,SAAO,EAAC,GAAGA,IAAG,GAAM,GAAM,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAC;AAClD;AAEe,SAAR,aAA8BC,SAAQ;AAC3C,MAAI,kBAAkBA,QAAO,UACzB,cAAcA,QAAO,MACrB,cAAcA,QAAO,MACrB,iBAAiBA,QAAO,SACxB,kBAAkBA,QAAO,MACzB,uBAAuBA,QAAO,WAC9B,gBAAgBA,QAAO,QACvB,qBAAqBA,QAAO;AAEhC,MAAI,WAAW,SAAS,cAAc,GAClC,eAAe,aAAa,cAAc,GAC1C,YAAY,SAAS,eAAe,GACpC,gBAAgB,aAAa,eAAe,GAC5C,iBAAiB,SAAS,oBAAoB,GAC9C,qBAAqB,aAAa,oBAAoB,GACtD,UAAU,SAAS,aAAa,GAChC,cAAc,aAAa,aAAa,GACxC,eAAe,SAAS,kBAAkB,GAC1C,mBAAmB,aAAa,kBAAkB;AAEtD,MAAI,UAAU;AAAA,IACZ,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,EACP;AAEA,MAAI,aAAa;AAAA,IACf,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,EACP;AAEA,MAAI,SAAS;AAAA,IACX,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,IACL,KAAK;AAAA,EACP;AAGA,UAAQ,IAAI,UAAU,aAAa,OAAO;AAC1C,UAAQ,IAAI,UAAU,aAAa,OAAO;AAC1C,UAAQ,IAAI,UAAU,iBAAiB,OAAO;AAC9C,aAAW,IAAI,UAAU,aAAa,UAAU;AAChD,aAAW,IAAI,UAAU,aAAa,UAAU;AAChD,aAAW,IAAI,UAAU,iBAAiB,UAAU;AAEpD,WAAS,UAAU,WAAWC,UAAS;AACrC,WAAO,SAASH,OAAM;AACpB,UAAI,SAAS,CAAC,GACV,IAAI,IACJ,IAAI,GACJ,IAAI,UAAU,QACd,GACAI,MACAC;AAEJ,UAAI,EAAEL,iBAAgB,MAAO,CAAAA,QAAO,oBAAI,KAAK,CAACA,KAAI;AAElD,aAAO,EAAE,IAAI,GAAG;AACd,YAAI,UAAU,WAAW,CAAC,MAAM,IAAI;AAClC,iBAAO,KAAK,UAAU,MAAM,GAAG,CAAC,CAAC;AACjC,eAAKI,OAAM,KAAK,IAAI,UAAU,OAAO,EAAE,CAAC,CAAC,MAAM,KAAM,KAAI,UAAU,OAAO,EAAE,CAAC;AAAA,cACxE,CAAAA,OAAM,MAAM,MAAM,MAAM;AAC7B,cAAIC,UAASF,SAAQ,CAAC,EAAG,KAAIE,QAAOL,OAAMI,IAAG;AAC7C,iBAAO,KAAK,CAAC;AACb,cAAI,IAAI;AAAA,QACV;AAAA,MACF;AAEA,aAAO,KAAK,UAAU,MAAM,GAAG,CAAC,CAAC;AACjC,aAAO,OAAO,KAAK,EAAE;AAAA,IACvB;AAAA,EACF;AAEA,WAAS,SAAS,WAAW,GAAG;AAC9B,WAAO,SAAS,QAAQ;AACtB,UAAI,IAAI,QAAQ,MAAM,QAAW,CAAC,GAC9B,IAAI,eAAe,GAAG,WAAW,UAAU,IAAI,CAAC,GAChD,MAAM;AACV,UAAI,KAAK,OAAO,OAAQ,QAAO;AAG/B,UAAI,OAAO,EAAG,QAAO,IAAI,KAAK,EAAE,CAAC;AACjC,UAAI,OAAO,EAAG,QAAO,IAAI,KAAK,EAAE,IAAI,OAAQ,OAAO,IAAI,EAAE,IAAI,EAAE;AAG/D,UAAI,KAAK,EAAE,OAAO,GAAI,GAAE,IAAI;AAG5B,UAAI,OAAO,EAAG,GAAE,IAAI,EAAE,IAAI,KAAK,EAAE,IAAI;AAGrC,UAAI,EAAE,MAAM,OAAW,GAAE,IAAI,OAAO,IAAI,EAAE,IAAI;AAG9C,UAAI,OAAO,GAAG;AACZ,YAAI,EAAE,IAAI,KAAK,EAAE,IAAI,GAAI,QAAO;AAChC,YAAI,EAAE,OAAO,GAAI,GAAE,IAAI;AACvB,YAAI,OAAO,GAAG;AACZ,iBAAO,QAAQ,QAAQ,EAAE,GAAG,GAAG,CAAC,CAAC,GAAG,MAAM,KAAK,UAAU;AACzD,iBAAO,MAAM,KAAK,QAAQ,IAAI,UAAU,KAAK,IAAI,IAAI,UAAU,IAAI;AACnE,iBAAO,OAAO,OAAO,OAAO,EAAE,IAAI,KAAK,CAAC;AACxC,YAAE,IAAI,KAAK,eAAe;AAC1B,YAAE,IAAI,KAAK,YAAY;AACvB,YAAE,IAAI,KAAK,WAAW,KAAK,EAAE,IAAI,KAAK;AAAA,QACxC,OAAO;AACL,iBAAO,UAAU,QAAQ,EAAE,GAAG,GAAG,CAAC,CAAC,GAAG,MAAM,KAAK,OAAO;AACxD,iBAAO,MAAM,KAAK,QAAQ,IAAI,WAAW,KAAK,IAAI,IAAI,WAAW,IAAI;AACrE,iBAAO,QAAQ,OAAO,OAAO,EAAE,IAAI,KAAK,CAAC;AACzC,YAAE,IAAI,KAAK,YAAY;AACvB,YAAE,IAAI,KAAK,SAAS;AACpB,YAAE,IAAI,KAAK,QAAQ,KAAK,EAAE,IAAI,KAAK;AAAA,QACrC;AAAA,MACF,WAAW,OAAO,KAAK,OAAO,GAAG;AAC/B,YAAI,EAAE,OAAO,GAAI,GAAE,IAAI,OAAO,IAAI,EAAE,IAAI,IAAI,OAAO,IAAI,IAAI;AAC3D,cAAM,OAAO,IAAI,QAAQ,QAAQ,EAAE,GAAG,GAAG,CAAC,CAAC,EAAE,UAAU,IAAI,UAAU,QAAQ,EAAE,GAAG,GAAG,CAAC,CAAC,EAAE,OAAO;AAChG,UAAE,IAAI;AACN,UAAE,IAAI,OAAO,KAAK,EAAE,IAAI,KAAK,IAAI,EAAE,IAAI,KAAK,MAAM,KAAK,IAAI,EAAE,IAAI,EAAE,IAAI,KAAK,MAAM,KAAK;AAAA,MACzF;AAIA,UAAI,OAAO,GAAG;AACZ,UAAE,KAAK,EAAE,IAAI,MAAM;AACnB,UAAE,KAAK,EAAE,IAAI;AACb,eAAO,QAAQ,CAAC;AAAA,MAClB;AAGA,aAAO,UAAU,CAAC;AAAA,IACpB;AAAA,EACF;AAEA,WAAS,eAAe,GAAG,WAAW,QAAQ,GAAG;AAC/C,QAAI,IAAI,GACJ,IAAI,UAAU,QACd,IAAI,OAAO,QACX,GACA;AAEJ,WAAO,IAAI,GAAG;AACZ,UAAI,KAAK,EAAG,QAAO;AACnB,UAAI,UAAU,WAAW,GAAG;AAC5B,UAAI,MAAM,IAAI;AACZ,YAAI,UAAU,OAAO,GAAG;AACxB,gBAAQ,OAAO,KAAK,OAAO,UAAU,OAAO,GAAG,IAAI,CAAC;AACpD,YAAI,CAAC,UAAW,IAAI,MAAM,GAAG,QAAQ,CAAC,KAAK,EAAI,QAAO;AAAA,MACxD,WAAW,KAAK,OAAO,WAAW,GAAG,GAAG;AACtC,eAAO;AAAA,MACT;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AAEA,WAAS,YAAY,GAAG,QAAQ,GAAG;AACjC,QAAI,IAAI,SAAS,KAAK,OAAO,MAAM,CAAC,CAAC;AACrC,WAAO,KAAK,EAAE,IAAI,aAAa,IAAI,EAAE,CAAC,EAAE,YAAY,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAAA,EAC7E;AAEA,WAAS,kBAAkB,GAAG,QAAQ,GAAG;AACvC,QAAI,IAAI,eAAe,KAAK,OAAO,MAAM,CAAC,CAAC;AAC3C,WAAO,KAAK,EAAE,IAAI,mBAAmB,IAAI,EAAE,CAAC,EAAE,YAAY,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAAA,EACnF;AAEA,WAAS,aAAa,GAAG,QAAQ,GAAG;AAClC,QAAI,IAAI,UAAU,KAAK,OAAO,MAAM,CAAC,CAAC;AACtC,WAAO,KAAK,EAAE,IAAI,cAAc,IAAI,EAAE,CAAC,EAAE,YAAY,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAAA,EAC9E;AAEA,WAAS,gBAAgB,GAAG,QAAQ,GAAG;AACrC,QAAI,IAAI,aAAa,KAAK,OAAO,MAAM,CAAC,CAAC;AACzC,WAAO,KAAK,EAAE,IAAI,iBAAiB,IAAI,EAAE,CAAC,EAAE,YAAY,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAAA,EACjF;AAEA,WAAS,WAAW,GAAG,QAAQ,GAAG;AAChC,QAAI,IAAI,QAAQ,KAAK,OAAO,MAAM,CAAC,CAAC;AACpC,WAAO,KAAK,EAAE,IAAI,YAAY,IAAI,EAAE,CAAC,EAAE,YAAY,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAAA,EAC5E;AAEA,WAAS,oBAAoB,GAAG,QAAQ,GAAG;AACzC,WAAO,eAAe,GAAG,iBAAiB,QAAQ,CAAC;AAAA,EACrD;AAEA,WAAS,gBAAgB,GAAG,QAAQ,GAAG;AACrC,WAAO,eAAe,GAAG,aAAa,QAAQ,CAAC;AAAA,EACjD;AAEA,WAAS,gBAAgB,GAAG,QAAQ,GAAG;AACrC,WAAO,eAAe,GAAG,aAAa,QAAQ,CAAC;AAAA,EACjD;AAEA,WAAS,mBAAmB,GAAG;AAC7B,WAAO,qBAAqB,EAAE,OAAO,CAAC;AAAA,EACxC;AAEA,WAAS,cAAc,GAAG;AACxB,WAAO,gBAAgB,EAAE,OAAO,CAAC;AAAA,EACnC;AAEA,WAAS,iBAAiB,GAAG;AAC3B,WAAO,mBAAmB,EAAE,SAAS,CAAC;AAAA,EACxC;AAEA,WAAS,YAAY,GAAG;AACtB,WAAO,cAAc,EAAE,SAAS,CAAC;AAAA,EACnC;AAEA,WAAS,aAAa,GAAG;AACvB,WAAO,eAAe,EAAE,EAAE,SAAS,KAAK,GAAG;AAAA,EAC7C;AAEA,WAAS,cAAc,GAAG;AACxB,WAAO,IAAI,CAAC,EAAE,EAAE,SAAS,IAAI;AAAA,EAC/B;AAEA,WAAS,sBAAsB,GAAG;AAChC,WAAO,qBAAqB,EAAE,UAAU,CAAC;AAAA,EAC3C;AAEA,WAAS,iBAAiB,GAAG;AAC3B,WAAO,gBAAgB,EAAE,UAAU,CAAC;AAAA,EACtC;AAEA,WAAS,oBAAoB,GAAG;AAC9B,WAAO,mBAAmB,EAAE,YAAY,CAAC;AAAA,EAC3C;AAEA,WAAS,eAAe,GAAG;AACzB,WAAO,cAAc,EAAE,YAAY,CAAC;AAAA,EACtC;AAEA,WAAS,gBAAgB,GAAG;AAC1B,WAAO,eAAe,EAAE,EAAE,YAAY,KAAK,GAAG;AAAA,EAChD;AAEA,WAAS,iBAAiB,GAAG;AAC3B,WAAO,IAAI,CAAC,EAAE,EAAE,YAAY,IAAI;AAAA,EAClC;AAEA,SAAO;AAAA,IACL,QAAQ,SAAS,WAAW;AAC1B,UAAI,IAAI,UAAU,aAAa,IAAI,OAAO;AAC1C,QAAE,WAAW,WAAW;AAAE,eAAO;AAAA,MAAW;AAC5C,aAAO;AAAA,IACT;AAAA,IACA,OAAO,SAAS,WAAW;AACzB,UAAI,IAAI,SAAS,aAAa,IAAI,KAAK;AACvC,QAAE,WAAW,WAAW;AAAE,eAAO;AAAA,MAAW;AAC5C,aAAO;AAAA,IACT;AAAA,IACA,WAAW,SAAS,WAAW;AAC7B,UAAI,IAAI,UAAU,aAAa,IAAI,UAAU;AAC7C,QAAE,WAAW,WAAW;AAAE,eAAO;AAAA,MAAW;AAC5C,aAAO;AAAA,IACT;AAAA,IACA,UAAU,SAAS,WAAW;AAC5B,UAAI,IAAI,SAAS,aAAa,IAAI,IAAI;AACtC,QAAE,WAAW,WAAW;AAAE,eAAO;AAAA,MAAW;AAC5C,aAAO;AAAA,IACT;AAAA,EACF;AACF;AAEA,IAAI,OAAO,EAAC,KAAK,IAAI,KAAK,KAAK,KAAK,IAAG;AAAvC,IACI,WAAW;AADf,IAEI,YAAY;AAFhB,IAGI,YAAY;AAEhB,SAAS,IAAI,OAAO,MAAM,OAAO;AAC/B,MAAIE,QAAO,QAAQ,IAAI,MAAM,IACzB,UAAUA,QAAO,CAAC,QAAQ,SAAS,IACnC,SAAS,OAAO;AACpB,SAAOA,SAAQ,SAAS,QAAQ,IAAI,MAAM,QAAQ,SAAS,CAAC,EAAE,KAAK,IAAI,IAAI,SAAS;AACtF;AAEA,SAAS,QAAQ,GAAG;AAClB,SAAO,EAAE,QAAQ,WAAW,MAAM;AACpC;AAEA,SAAS,SAAS,OAAO;AACvB,SAAO,IAAI,OAAO,SAAS,MAAM,IAAI,OAAO,EAAE,KAAK,GAAG,IAAI,KAAK,GAAG;AACpE;AAEA,SAAS,aAAa,OAAO;AAC3B,SAAO,IAAI,IAAI,MAAM,IAAI,CAAC,MAAM,MAAM,CAAC,KAAK,YAAY,GAAG,CAAC,CAAC,CAAC;AAChE;AAEA,SAAS,yBAAyB,GAAG,QAAQ,GAAG;AAC9C,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC5C,SAAO,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAC9C;AAEA,SAAS,yBAAyB,GAAG,QAAQ,GAAG;AAC9C,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC5C,SAAO,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAC9C;AAEA,SAAS,sBAAsB,GAAG,QAAQ,GAAG;AAC3C,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC5C,SAAO,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAC9C;AAEA,SAAS,mBAAmB,GAAG,QAAQ,GAAG;AACxC,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC5C,SAAO,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAC9C;AAEA,SAAS,sBAAsB,GAAG,QAAQ,GAAG;AAC3C,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC5C,SAAO,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAC9C;AAEA,SAAS,cAAc,GAAG,QAAQ,GAAG;AACnC,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC5C,SAAO,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAC9C;AAEA,SAAS,UAAU,GAAG,QAAQ,GAAG;AAC/B,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC5C,SAAO,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE,CAAC,IAAI,KAAK,OAAO,MAAO,IAAI,EAAE,CAAC,EAAE,UAAU;AAC3E;AAEA,SAAS,UAAU,GAAG,QAAQ,GAAG;AAC/B,MAAI,IAAI,+BAA+B,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAClE,SAAO,KAAK,EAAE,IAAI,EAAE,CAAC,IAAI,IAAI,EAAE,EAAE,CAAC,KAAK,EAAE,CAAC,KAAK,QAAQ,IAAI,EAAE,CAAC,EAAE,UAAU;AAC5E;AAEA,SAAS,aAAa,GAAG,QAAQ,GAAG;AAClC,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC5C,SAAO,KAAK,EAAE,IAAI,EAAE,CAAC,IAAI,IAAI,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AACrD;AAEA,SAAS,iBAAiB,GAAG,QAAQ,GAAG;AACtC,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC5C,SAAO,KAAK,EAAE,IAAI,EAAE,CAAC,IAAI,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AACjD;AAEA,SAAS,gBAAgB,GAAG,QAAQ,GAAG;AACrC,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC5C,SAAO,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAC9C;AAEA,SAAS,eAAe,GAAG,QAAQ,GAAG;AACpC,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC5C,SAAO,KAAK,EAAE,IAAI,GAAG,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AACvD;AAEA,SAAS,YAAY,GAAG,QAAQ,GAAG;AACjC,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC5C,SAAO,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAC9C;AAEA,SAAS,aAAa,GAAG,QAAQ,GAAG;AAClC,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC5C,SAAO,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAC9C;AAEA,SAAS,aAAa,GAAG,QAAQ,GAAG;AAClC,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC5C,SAAO,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAC9C;AAEA,SAAS,kBAAkB,GAAG,QAAQ,GAAG;AACvC,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC5C,SAAO,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAC9C;AAEA,SAAS,kBAAkB,GAAG,QAAQ,GAAG;AACvC,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC5C,SAAO,KAAK,EAAE,IAAI,KAAK,MAAM,EAAE,CAAC,IAAI,GAAI,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAChE;AAEA,SAAS,oBAAoB,GAAG,QAAQ,GAAG;AACzC,MAAI,IAAI,UAAU,KAAK,OAAO,MAAM,GAAG,IAAI,CAAC,CAAC;AAC7C,SAAO,IAAI,IAAI,EAAE,CAAC,EAAE,SAAS;AAC/B;AAEA,SAAS,mBAAmB,GAAG,QAAQ,GAAG;AACxC,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,CAAC,CAAC;AACrC,SAAO,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAC9C;AAEA,SAAS,0BAA0B,GAAG,QAAQ,GAAG;AAC/C,MAAI,IAAI,SAAS,KAAK,OAAO,MAAM,CAAC,CAAC;AACrC,SAAO,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,UAAU;AAC9C;AAEA,SAAS,iBAAiB,GAAG,GAAG;AAC9B,SAAO,IAAI,EAAE,QAAQ,GAAG,GAAG,CAAC;AAC9B;AAEA,SAAS,aAAa,GAAG,GAAG;AAC1B,SAAO,IAAI,EAAE,SAAS,GAAG,GAAG,CAAC;AAC/B;AAEA,SAAS,aAAa,GAAG,GAAG;AAC1B,SAAO,IAAI,EAAE,SAAS,IAAI,MAAM,IAAI,GAAG,CAAC;AAC1C;AAEA,SAAS,gBAAgB,GAAG,GAAG;AAC7B,SAAO,IAAI,IAAI,QAAQ,MAAM,SAAS,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;AACpD;AAEA,SAAS,mBAAmB,GAAG,GAAG;AAChC,SAAO,IAAI,EAAE,gBAAgB,GAAG,GAAG,CAAC;AACtC;AAEA,SAAS,mBAAmB,GAAG,GAAG;AAChC,SAAO,mBAAmB,GAAG,CAAC,IAAI;AACpC;AAEA,SAAS,kBAAkB,GAAG,GAAG;AAC/B,SAAO,IAAI,EAAE,SAAS,IAAI,GAAG,GAAG,CAAC;AACnC;AAEA,SAAS,cAAc,GAAG,GAAG;AAC3B,SAAO,IAAI,EAAE,WAAW,GAAG,GAAG,CAAC;AACjC;AAEA,SAAS,cAAc,GAAG,GAAG;AAC3B,SAAO,IAAI,EAAE,WAAW,GAAG,GAAG,CAAC;AACjC;AAEA,SAAS,0BAA0B,GAAG;AACpC,MAAI,MAAM,EAAE,OAAO;AACnB,SAAO,QAAQ,IAAI,IAAI;AACzB;AAEA,SAAS,uBAAuB,GAAG,GAAG;AACpC,SAAO,IAAI,WAAW,MAAM,SAAS,CAAC,IAAI,GAAG,CAAC,GAAG,GAAG,CAAC;AACvD;AAEA,SAAS,KAAK,GAAG;AACf,MAAI,MAAM,EAAE,OAAO;AACnB,SAAQ,OAAO,KAAK,QAAQ,IAAK,aAAa,CAAC,IAAI,aAAa,KAAK,CAAC;AACxE;AAEA,SAAS,oBAAoB,GAAG,GAAG;AACjC,MAAI,KAAK,CAAC;AACV,SAAO,IAAI,aAAa,MAAM,SAAS,CAAC,GAAG,CAAC,KAAK,SAAS,CAAC,EAAE,OAAO,MAAM,IAAI,GAAG,CAAC;AACpF;AAEA,SAAS,0BAA0B,GAAG;AACpC,SAAO,EAAE,OAAO;AAClB;AAEA,SAAS,uBAAuB,GAAG,GAAG;AACpC,SAAO,IAAI,WAAW,MAAM,SAAS,CAAC,IAAI,GAAG,CAAC,GAAG,GAAG,CAAC;AACvD;AAEA,SAAS,WAAW,GAAG,GAAG;AACxB,SAAO,IAAI,EAAE,YAAY,IAAI,KAAK,GAAG,CAAC;AACxC;AAEA,SAAS,cAAc,GAAG,GAAG;AAC3B,MAAI,KAAK,CAAC;AACV,SAAO,IAAI,EAAE,YAAY,IAAI,KAAK,GAAG,CAAC;AACxC;AAEA,SAAS,eAAe,GAAG,GAAG;AAC5B,SAAO,IAAI,EAAE,YAAY,IAAI,KAAO,GAAG,CAAC;AAC1C;AAEA,SAAS,kBAAkB,GAAG,GAAG;AAC/B,MAAI,MAAM,EAAE,OAAO;AACnB,MAAK,OAAO,KAAK,QAAQ,IAAK,aAAa,CAAC,IAAI,aAAa,KAAK,CAAC;AACnE,SAAO,IAAI,EAAE,YAAY,IAAI,KAAO,GAAG,CAAC;AAC1C;AAEA,SAAS,WAAW,GAAG;AACrB,MAAI,IAAI,EAAE,kBAAkB;AAC5B,UAAQ,IAAI,IAAI,OAAO,KAAK,IAAI,QAC1B,IAAI,IAAI,KAAK,GAAG,KAAK,CAAC,IACtB,IAAI,IAAI,IAAI,KAAK,CAAC;AAC1B;AAEA,SAAS,oBAAoB,GAAG,GAAG;AACjC,SAAO,IAAI,EAAE,WAAW,GAAG,GAAG,CAAC;AACjC;AAEA,SAAS,gBAAgB,GAAG,GAAG;AAC7B,SAAO,IAAI,EAAE,YAAY,GAAG,GAAG,CAAC;AAClC;AAEA,SAAS,gBAAgB,GAAG,GAAG;AAC7B,SAAO,IAAI,EAAE,YAAY,IAAI,MAAM,IAAI,GAAG,CAAC;AAC7C;AAEA,SAAS,mBAAmB,GAAG,GAAG;AAChC,SAAO,IAAI,IAAI,OAAO,MAAM,QAAQ,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;AAClD;AAEA,SAAS,sBAAsB,GAAG,GAAG;AACnC,SAAO,IAAI,EAAE,mBAAmB,GAAG,GAAG,CAAC;AACzC;AAEA,SAAS,sBAAsB,GAAG,GAAG;AACnC,SAAO,sBAAsB,GAAG,CAAC,IAAI;AACvC;AAEA,SAAS,qBAAqB,GAAG,GAAG;AAClC,SAAO,IAAI,EAAE,YAAY,IAAI,GAAG,GAAG,CAAC;AACtC;AAEA,SAAS,iBAAiB,GAAG,GAAG;AAC9B,SAAO,IAAI,EAAE,cAAc,GAAG,GAAG,CAAC;AACpC;AAEA,SAAS,iBAAiB,GAAG,GAAG;AAC9B,SAAO,IAAI,EAAE,cAAc,GAAG,GAAG,CAAC;AACpC;AAEA,SAAS,6BAA6B,GAAG;AACvC,MAAI,MAAM,EAAE,UAAU;AACtB,SAAO,QAAQ,IAAI,IAAI;AACzB;AAEA,SAAS,0BAA0B,GAAG,GAAG;AACvC,SAAO,IAAI,UAAU,MAAM,QAAQ,CAAC,IAAI,GAAG,CAAC,GAAG,GAAG,CAAC;AACrD;AAEA,SAAS,QAAQ,GAAG;AAClB,MAAI,MAAM,EAAE,UAAU;AACtB,SAAQ,OAAO,KAAK,QAAQ,IAAK,YAAY,CAAC,IAAI,YAAY,KAAK,CAAC;AACtE;AAEA,SAAS,uBAAuB,GAAG,GAAG;AACpC,MAAI,QAAQ,CAAC;AACb,SAAO,IAAI,YAAY,MAAM,QAAQ,CAAC,GAAG,CAAC,KAAK,QAAQ,CAAC,EAAE,UAAU,MAAM,IAAI,GAAG,CAAC;AACpF;AAEA,SAAS,6BAA6B,GAAG;AACvC,SAAO,EAAE,UAAU;AACrB;AAEA,SAAS,0BAA0B,GAAG,GAAG;AACvC,SAAO,IAAI,UAAU,MAAM,QAAQ,CAAC,IAAI,GAAG,CAAC,GAAG,GAAG,CAAC;AACrD;AAEA,SAAS,cAAc,GAAG,GAAG;AAC3B,SAAO,IAAI,EAAE,eAAe,IAAI,KAAK,GAAG,CAAC;AAC3C;AAEA,SAAS,iBAAiB,GAAG,GAAG;AAC9B,MAAI,QAAQ,CAAC;AACb,SAAO,IAAI,EAAE,eAAe,IAAI,KAAK,GAAG,CAAC;AAC3C;AAEA,SAAS,kBAAkB,GAAG,GAAG;AAC/B,SAAO,IAAI,EAAE,eAAe,IAAI,KAAO,GAAG,CAAC;AAC7C;AAEA,SAAS,qBAAqB,GAAG,GAAG;AAClC,MAAI,MAAM,EAAE,UAAU;AACtB,MAAK,OAAO,KAAK,QAAQ,IAAK,YAAY,CAAC,IAAI,YAAY,KAAK,CAAC;AACjE,SAAO,IAAI,EAAE,eAAe,IAAI,KAAO,GAAG,CAAC;AAC7C;AAEA,SAAS,gBAAgB;AACvB,SAAO;AACT;AAEA,SAAS,uBAAuB;AAC9B,SAAO;AACT;AAEA,SAAS,oBAAoB,GAAG;AAC9B,SAAO,CAAC;AACV;AAEA,SAAS,2BAA2B,GAAG;AACrC,SAAO,KAAK,MAAM,CAAC,IAAI,GAAI;AAC7B;;;ACtrBA,IAAIC;AACG,IAAI;AACJ,IAAI;AACJ,IAAI;AACJ,IAAI;AAEXC,eAAc;AAAA,EACZ,UAAU;AAAA,EACV,MAAM;AAAA,EACN,MAAM;AAAA,EACN,SAAS,CAAC,MAAM,IAAI;AAAA,EACpB,MAAM,CAAC,UAAU,UAAU,WAAW,aAAa,YAAY,UAAU,UAAU;AAAA,EACnF,WAAW,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAK;AAAA,EAC3D,QAAQ,CAAC,WAAW,YAAY,SAAS,SAAS,OAAO,QAAQ,QAAQ,UAAU,aAAa,WAAW,YAAY,UAAU;AAAA,EACjI,aAAa,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAK;AAClG,CAAC;AAEc,SAARA,eAA+B,YAAY;AAChD,EAAAD,UAAS,aAAa,UAAU;AAChC,eAAaA,QAAO;AACpB,cAAYA,QAAO;AACnB,cAAYA,QAAO;AACnB,aAAWA,QAAO;AAClB,SAAOA;AACT;;;ACpBA,SAAS,KAAK,GAAG;AACf,SAAO,IAAI,KAAK,CAAC;AACnB;AAEA,SAASE,QAAO,GAAG;AACjB,SAAO,aAAa,OAAO,CAAC,IAAI,CAAC,oBAAI,KAAK,CAAC,CAAC;AAC9C;AAEO,SAAS,SAASC,QAAO,cAAc,MAAM,OAAO,MAAM,KAAK,MAAM,QAAQC,SAAQC,SAAQ;AAClG,MAAI,QAAQ,WAAW,GACnB,SAAS,MAAM,QACf,SAAS,MAAM;AAEnB,MAAI,oBAAoBA,QAAO,KAAK,GAChC,eAAeA,QAAO,KAAK,GAC3B,eAAeA,QAAO,OAAO,GAC7B,aAAaA,QAAO,OAAO,GAC3B,YAAYA,QAAO,OAAO,GAC1B,aAAaA,QAAO,OAAO,GAC3B,cAAcA,QAAO,IAAI,GACzBC,cAAaD,QAAO,IAAI;AAE5B,WAASE,YAAWC,OAAM;AACxB,YAAQJ,QAAOI,KAAI,IAAIA,QAAO,oBACxB,OAAOA,KAAI,IAAIA,QAAO,eACtB,KAAKA,KAAI,IAAIA,QAAO,eACpB,IAAIA,KAAI,IAAIA,QAAO,aACnB,MAAMA,KAAI,IAAIA,QAAQ,KAAKA,KAAI,IAAIA,QAAO,YAAY,aACtD,KAAKA,KAAI,IAAIA,QAAO,cACpBF,aAAYE,KAAI;AAAA,EACxB;AAEA,QAAM,SAAS,SAASC,IAAG;AACzB,WAAO,IAAI,KAAK,OAAOA,EAAC,CAAC;AAAA,EAC3B;AAEA,QAAM,SAAS,SAAS,GAAG;AACzB,WAAO,UAAU,SAAS,OAAO,MAAM,KAAK,GAAGP,OAAM,CAAC,IAAI,OAAO,EAAE,IAAI,IAAI;AAAA,EAC7E;AAEA,QAAM,QAAQ,SAAS,UAAU;AAC/B,QAAI,IAAI,OAAO;AACf,WAAOC,OAAM,EAAE,CAAC,GAAG,EAAE,EAAE,SAAS,CAAC,GAAG,YAAY,OAAO,KAAK,QAAQ;AAAA,EACtE;AAEA,QAAM,aAAa,SAAS,OAAO,WAAW;AAC5C,WAAO,aAAa,OAAOI,cAAaF,QAAO,SAAS;AAAA,EAC1D;AAEA,QAAM,OAAO,SAAS,UAAU;AAC9B,QAAI,IAAI,OAAO;AACf,QAAI,CAAC,YAAY,OAAO,SAAS,UAAU,WAAY,YAAW,aAAa,EAAE,CAAC,GAAG,EAAE,EAAE,SAAS,CAAC,GAAG,YAAY,OAAO,KAAK,QAAQ;AACtI,WAAO,WAAW,OAAO,KAAK,GAAG,QAAQ,CAAC,IAAI;AAAA,EAChD;AAEA,QAAM,OAAO,WAAW;AACtB,WAAO,KAAK,OAAO,SAASF,QAAO,cAAc,MAAM,OAAO,MAAM,KAAK,MAAM,QAAQC,SAAQC,OAAM,CAAC;AAAA,EACxG;AAEA,SAAO;AACT;AAEe,SAAR,OAAwB;AAC7B,SAAO,UAAU,MAAM,SAAS,WAAW,kBAAkB,UAAU,WAAW,YAAU,SAAS,UAAU,YAAY,QAAY,UAAU,EAAE,OAAO,CAAC,IAAI,KAAK,KAAM,GAAG,CAAC,GAAG,IAAI,KAAK,KAAM,GAAG,CAAC,CAAC,CAAC,GAAG,SAAS;AACpN;;;ACtEe,SAARK,kBAAiBC,IAAG;AACzB,SAAO,SAAS,WAAW;AACzB,WAAOA;AAAA,EACT;AACF;;;ACJA,IAAM,KAAK,KAAK;AAAhB,IACI,MAAM,IAAI;AADd,IAEI,UAAU;AAFd,IAGI,aAAa,MAAM;AAEvB,SAAS,OAAO,SAAS;AACvB,OAAK,KAAK,QAAQ,CAAC;AACnB,WAAS,IAAI,GAAG,IAAI,QAAQ,QAAQ,IAAI,GAAG,EAAE,GAAG;AAC9C,SAAK,KAAK,UAAU,CAAC,IAAI,QAAQ,CAAC;AAAA,EACpC;AACF;AAEA,SAAS,YAAY,QAAQ;AAC3B,MAAI,IAAI,KAAK,MAAM,MAAM;AACzB,MAAI,EAAE,KAAK,GAAI,OAAM,IAAI,MAAM,mBAAmB,MAAM,EAAE;AAC1D,MAAI,IAAI,GAAI,QAAO;AACnB,QAAM,IAAI,MAAM;AAChB,SAAO,SAAS,SAAS;AACvB,SAAK,KAAK,QAAQ,CAAC;AACnB,aAAS,IAAI,GAAG,IAAI,QAAQ,QAAQ,IAAI,GAAG,EAAE,GAAG;AAC9C,WAAK,KAAK,KAAK,MAAM,UAAU,CAAC,IAAI,CAAC,IAAI,IAAI,QAAQ,CAAC;AAAA,IACxD;AAAA,EACF;AACF;AAEO,IAAM,OAAN,MAAW;AAAA,EAChB,YAAY,QAAQ;AAClB,SAAK,MAAM,KAAK;AAAA,IAChB,KAAK,MAAM,KAAK,MAAM;AACtB,SAAK,IAAI;AACT,SAAK,UAAU,UAAU,OAAO,SAAS,YAAY,MAAM;AAAA,EAC7D;AAAA,EACA,OAAOC,IAAGC,IAAG;AACX,SAAK,WAAW,KAAK,MAAM,KAAK,MAAM,CAACD,EAAC,IAAI,KAAK,MAAM,KAAK,MAAM,CAACC,EAAC;AAAA,EACtE;AAAA,EACA,YAAY;AACV,QAAI,KAAK,QAAQ,MAAM;AACrB,WAAK,MAAM,KAAK,KAAK,KAAK,MAAM,KAAK;AACrC,WAAK;AAAA,IACP;AAAA,EACF;AAAA,EACA,OAAOD,IAAGC,IAAG;AACX,SAAK,WAAW,KAAK,MAAM,CAACD,EAAC,IAAI,KAAK,MAAM,CAACC,EAAC;AAAA,EAChD;AAAA,EACA,iBAAiB,IAAI,IAAID,IAAGC,IAAG;AAC7B,SAAK,WAAW,CAAC,EAAE,IAAI,CAAC,EAAE,IAAI,KAAK,MAAM,CAACD,EAAC,IAAI,KAAK,MAAM,CAACC,EAAC;AAAA,EAC9D;AAAA,EACA,cAAc,IAAI,IAAI,IAAI,IAAID,IAAGC,IAAG;AAClC,SAAK,WAAW,CAAC,EAAE,IAAI,CAAC,EAAE,IAAI,CAAC,EAAE,IAAI,CAAC,EAAE,IAAI,KAAK,MAAM,CAACD,EAAC,IAAI,KAAK,MAAM,CAACC,EAAC;AAAA,EAC5E;AAAA,EACA,MAAM,IAAI,IAAI,IAAI,IAAIC,IAAG;AACvB,SAAK,CAAC,IAAI,KAAK,CAAC,IAAI,KAAK,CAAC,IAAI,KAAK,CAAC,IAAIA,KAAI,CAACA;AAG7C,QAAIA,KAAI,EAAG,OAAM,IAAI,MAAM,oBAAoBA,EAAC,EAAE;AAElD,QAAI,KAAK,KAAK,KACV,KAAK,KAAK,KACV,MAAM,KAAK,IACX,MAAM,KAAK,IACX,MAAM,KAAK,IACX,MAAM,KAAK,IACX,QAAQ,MAAM,MAAM,MAAM;AAG9B,QAAI,KAAK,QAAQ,MAAM;AACrB,WAAK,WAAW,KAAK,MAAM,EAAE,IAAI,KAAK,MAAM,EAAE;AAAA,IAChD,WAGS,EAAE,QAAQ,SAAS;AAAA,aAKnB,EAAE,KAAK,IAAI,MAAM,MAAM,MAAM,GAAG,IAAI,YAAY,CAACA,IAAG;AAC3D,WAAK,WAAW,KAAK,MAAM,EAAE,IAAI,KAAK,MAAM,EAAE;AAAA,IAChD,OAGK;AACH,UAAI,MAAM,KAAK,IACX,MAAM,KAAK,IACX,QAAQ,MAAM,MAAM,MAAM,KAC1B,QAAQ,MAAM,MAAM,MAAM,KAC1B,MAAM,KAAK,KAAK,KAAK,GACrB,MAAM,KAAK,KAAK,KAAK,GACrB,IAAIA,KAAI,KAAK,KAAK,KAAK,KAAK,MAAM,QAAQ,QAAQ,UAAU,IAAI,MAAM,IAAI,KAAK,CAAC,GAChF,MAAM,IAAI,KACV,MAAM,IAAI;AAGd,UAAI,KAAK,IAAI,MAAM,CAAC,IAAI,SAAS;AAC/B,aAAK,WAAW,KAAK,MAAM,GAAG,IAAI,KAAK,MAAM,GAAG;AAAA,MAClD;AAEA,WAAK,WAAWA,EAAC,IAAIA,EAAC,QAAQ,EAAE,MAAM,MAAM,MAAM,IAAI,IAAI,KAAK,MAAM,KAAK,MAAM,GAAG,IAAI,KAAK,MAAM,KAAK,MAAM,GAAG;AAAA,IAClH;AAAA,EACF;AAAA,EACA,IAAIF,IAAGC,IAAGC,IAAG,IAAI,IAAI,KAAK;AACxB,IAAAF,KAAI,CAACA,IAAGC,KAAI,CAACA,IAAGC,KAAI,CAACA,IAAG,MAAM,CAAC,CAAC;AAGhC,QAAIA,KAAI,EAAG,OAAM,IAAI,MAAM,oBAAoBA,EAAC,EAAE;AAElD,QAAI,KAAKA,KAAI,KAAK,IAAI,EAAE,GACpB,KAAKA,KAAI,KAAK,IAAI,EAAE,GACpB,KAAKF,KAAI,IACT,KAAKC,KAAI,IACT,KAAK,IAAI,KACT,KAAK,MAAM,KAAK,KAAK,KAAK;AAG9B,QAAI,KAAK,QAAQ,MAAM;AACrB,WAAK,WAAW,EAAE,IAAI,EAAE;AAAA,IAC1B,WAGS,KAAK,IAAI,KAAK,MAAM,EAAE,IAAI,WAAW,KAAK,IAAI,KAAK,MAAM,EAAE,IAAI,SAAS;AAC/E,WAAK,WAAW,EAAE,IAAI,EAAE;AAAA,IAC1B;AAGA,QAAI,CAACC,GAAG;AAGR,QAAI,KAAK,EAAG,MAAK,KAAK,MAAM;AAG5B,QAAI,KAAK,YAAY;AACnB,WAAK,WAAWA,EAAC,IAAIA,EAAC,QAAQ,EAAE,IAAIF,KAAI,EAAE,IAAIC,KAAI,EAAE,IAAIC,EAAC,IAAIA,EAAC,QAAQ,EAAE,IAAI,KAAK,MAAM,EAAE,IAAI,KAAK,MAAM,EAAE;AAAA,IAC5G,WAGS,KAAK,SAAS;AACrB,WAAK,WAAWA,EAAC,IAAIA,EAAC,MAAM,EAAE,MAAM,GAAG,IAAI,EAAE,IAAI,KAAK,MAAMF,KAAIE,KAAI,KAAK,IAAI,EAAE,CAAC,IAAI,KAAK,MAAMD,KAAIC,KAAI,KAAK,IAAI,EAAE,CAAC;AAAA,IACrH;AAAA,EACF;AAAA,EACA,KAAKF,IAAGC,IAAG,GAAG,GAAG;AACf,SAAK,WAAW,KAAK,MAAM,KAAK,MAAM,CAACD,EAAC,IAAI,KAAK,MAAM,KAAK,MAAM,CAACC,EAAC,IAAI,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC;AAAA,EAC5F;AAAA,EACA,WAAW;AACT,WAAO,KAAK;AAAA,EACd;AACF;AAEO,SAAS,OAAO;AACrB,SAAO,IAAI;AACb;AAGA,KAAK,YAAY,KAAK;;;ACrJf,SAAS,SAAS,OAAO;AAC9B,MAAI,SAAS;AAEb,QAAM,SAAS,SAAS,GAAG;AACzB,QAAI,CAAC,UAAU,OAAQ,QAAO;AAC9B,QAAI,KAAK,MAAM;AACb,eAAS;AAAA,IACX,OAAO;AACL,YAAM,IAAI,KAAK,MAAM,CAAC;AACtB,UAAI,EAAE,KAAK,GAAI,OAAM,IAAI,WAAW,mBAAmB,CAAC,EAAE;AAC1D,eAAS;AAAA,IACX;AACA,WAAO;AAAA,EACT;AAEA,SAAO,MAAM,IAAI,KAAK,MAAM;AAC9B;;;AClBO,IAAI,QAAQ,MAAM,UAAU;AAEpB,SAAR,cAAiBE,IAAG;AACzB,SAAO,OAAOA,OAAM,YAAY,YAAYA,KACxCA,KACA,MAAM,KAAKA,EAAC;AAClB;;;ACNA,SAAS,OAAO,SAAS;AACvB,OAAK,WAAW;AAClB;AAEA,OAAO,YAAY;AAAA,EACjB,WAAW,WAAW;AACpB,SAAK,QAAQ;AAAA,EACf;AAAA,EACA,SAAS,WAAW;AAClB,SAAK,QAAQ;AAAA,EACf;AAAA,EACA,WAAW,WAAW;AACpB,SAAK,SAAS;AAAA,EAChB;AAAA,EACA,SAAS,WAAW;AAClB,QAAI,KAAK,SAAU,KAAK,UAAU,KAAK,KAAK,WAAW,EAAI,MAAK,SAAS,UAAU;AACnF,SAAK,QAAQ,IAAI,KAAK;AAAA,EACxB;AAAA,EACA,OAAO,SAASC,IAAGC,IAAG;AACpB,IAAAD,KAAI,CAACA,IAAGC,KAAI,CAACA;AACb,YAAQ,KAAK,QAAQ;AAAA,MACnB,KAAK;AAAG,aAAK,SAAS;AAAG,aAAK,QAAQ,KAAK,SAAS,OAAOD,IAAGC,EAAC,IAAI,KAAK,SAAS,OAAOD,IAAGC,EAAC;AAAG;AAAA,MAC/F,KAAK;AAAG,aAAK,SAAS;AAAA;AAAA,MACtB;AAAS,aAAK,SAAS,OAAOD,IAAGC,EAAC;AAAG;AAAA,IACvC;AAAA,EACF;AACF;AAEe,SAAR,eAAiB,SAAS;AAC/B,SAAO,IAAI,OAAO,OAAO;AAC3B;;;AC9BO,SAAS,EAAE,GAAG;AACnB,SAAO,EAAE,CAAC;AACZ;AAEO,SAAS,EAAE,GAAG;AACnB,SAAO,EAAE,CAAC;AACZ;;;ACAe,SAAR,aAAiBC,IAAGC,IAAG;AAC5B,MAAI,UAAUC,kBAAS,IAAI,GACvB,UAAU,MACV,QAAQ,gBACR,SAAS,MACTC,QAAO,SAAS,IAAI;AAExB,EAAAH,KAAI,OAAOA,OAAM,aAAaA,KAAKA,OAAM,SAAa,IAASE,kBAASF,EAAC;AACzE,EAAAC,KAAI,OAAOA,OAAM,aAAaA,KAAKA,OAAM,SAAa,IAASC,kBAASD,EAAC;AAEzE,WAAS,KAAK,MAAM;AAClB,QAAI,GACA,KAAK,OAAO,cAAM,IAAI,GAAG,QACzB,GACA,WAAW,OACX;AAEJ,QAAI,WAAW,KAAM,UAAS,MAAM,SAASE,MAAK,CAAC;AAEnD,SAAK,IAAI,GAAG,KAAK,GAAG,EAAE,GAAG;AACvB,UAAI,EAAE,IAAI,KAAK,QAAQ,IAAI,KAAK,CAAC,GAAG,GAAG,IAAI,OAAO,UAAU;AAC1D,YAAI,WAAW,CAAC,SAAU,QAAO,UAAU;AAAA,YACtC,QAAO,QAAQ;AAAA,MACtB;AACA,UAAI,SAAU,QAAO,MAAM,CAACH,GAAE,GAAG,GAAG,IAAI,GAAG,CAACC,GAAE,GAAG,GAAG,IAAI,CAAC;AAAA,IAC3D;AAEA,QAAI,OAAQ,QAAO,SAAS,MAAM,SAAS,MAAM;AAAA,EACnD;AAEA,OAAK,IAAI,SAAS,GAAG;AACnB,WAAO,UAAU,UAAUD,KAAI,OAAO,MAAM,aAAa,IAAIE,kBAAS,CAAC,CAAC,GAAG,QAAQF;AAAA,EACrF;AAEA,OAAK,IAAI,SAAS,GAAG;AACnB,WAAO,UAAU,UAAUC,KAAI,OAAO,MAAM,aAAa,IAAIC,kBAAS,CAAC,CAAC,GAAG,QAAQD;AAAA,EACrF;AAEA,OAAK,UAAU,SAAS,GAAG;AACzB,WAAO,UAAU,UAAU,UAAU,OAAO,MAAM,aAAa,IAAIC,kBAAS,CAAC,CAAC,CAAC,GAAG,QAAQ;AAAA,EAC5F;AAEA,OAAK,QAAQ,SAAS,GAAG;AACvB,WAAO,UAAU,UAAU,QAAQ,GAAG,WAAW,SAAS,SAAS,MAAM,OAAO,IAAI,QAAQ;AAAA,EAC9F;AAEA,OAAK,UAAU,SAAS,GAAG;AACzB,WAAO,UAAU,UAAU,KAAK,OAAO,UAAU,SAAS,OAAO,SAAS,MAAM,UAAU,CAAC,GAAG,QAAQ;AAAA,EACxG;AAEA,SAAO;AACT;;;AClDe,SAAR,aAAiB,IAAI,IAAI,IAAI;AAClC,MAAI,KAAK,MACL,UAAUE,kBAAS,IAAI,GACvB,UAAU,MACV,QAAQ,gBACR,SAAS,MACTC,QAAO,SAAS,IAAI;AAExB,OAAK,OAAO,OAAO,aAAa,KAAM,OAAO,SAAa,IAASD,kBAAS,CAAC,EAAE;AAC/E,OAAK,OAAO,OAAO,aAAa,KAAM,OAAO,SAAaA,kBAAS,CAAC,IAAIA,kBAAS,CAAC,EAAE;AACpF,OAAK,OAAO,OAAO,aAAa,KAAM,OAAO,SAAa,IAASA,kBAAS,CAAC,EAAE;AAE/E,WAAS,KAAK,MAAM;AAClB,QAAI,GACA,GACA,GACA,KAAK,OAAO,cAAM,IAAI,GAAG,QACzB,GACA,WAAW,OACX,QACA,MAAM,IAAI,MAAM,CAAC,GACjB,MAAM,IAAI,MAAM,CAAC;AAErB,QAAI,WAAW,KAAM,UAAS,MAAM,SAASC,MAAK,CAAC;AAEnD,SAAK,IAAI,GAAG,KAAK,GAAG,EAAE,GAAG;AACvB,UAAI,EAAE,IAAI,KAAK,QAAQ,IAAI,KAAK,CAAC,GAAG,GAAG,IAAI,OAAO,UAAU;AAC1D,YAAI,WAAW,CAAC,UAAU;AACxB,cAAI;AACJ,iBAAO,UAAU;AACjB,iBAAO,UAAU;AAAA,QACnB,OAAO;AACL,iBAAO,QAAQ;AACf,iBAAO,UAAU;AACjB,eAAK,IAAI,IAAI,GAAG,KAAK,GAAG,EAAE,GAAG;AAC3B,mBAAO,MAAM,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC;AAAA,UAC7B;AACA,iBAAO,QAAQ;AACf,iBAAO,QAAQ;AAAA,QACjB;AAAA,MACF;AACA,UAAI,UAAU;AACZ,YAAI,CAAC,IAAI,CAAC,GAAG,GAAG,GAAG,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,GAAG,IAAI;AACjD,eAAO,MAAM,KAAK,CAAC,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,CAAC,GAAG,KAAK,CAAC,GAAG,GAAG,GAAG,IAAI,IAAI,IAAI,CAAC,CAAC;AAAA,MAC3E;AAAA,IACF;AAEA,QAAI,OAAQ,QAAO,SAAS,MAAM,SAAS,MAAM;AAAA,EACnD;AAEA,WAAS,WAAW;AAClB,WAAO,aAAK,EAAE,QAAQ,OAAO,EAAE,MAAM,KAAK,EAAE,QAAQ,OAAO;AAAA,EAC7D;AAEA,OAAK,IAAI,SAAS,GAAG;AACnB,WAAO,UAAU,UAAU,KAAK,OAAO,MAAM,aAAa,IAAID,kBAAS,CAAC,CAAC,GAAG,KAAK,MAAM,QAAQ;AAAA,EACjG;AAEA,OAAK,KAAK,SAAS,GAAG;AACpB,WAAO,UAAU,UAAU,KAAK,OAAO,MAAM,aAAa,IAAIA,kBAAS,CAAC,CAAC,GAAG,QAAQ;AAAA,EACtF;AAEA,OAAK,KAAK,SAAS,GAAG;AACpB,WAAO,UAAU,UAAU,KAAK,KAAK,OAAO,OAAO,OAAO,MAAM,aAAa,IAAIA,kBAAS,CAAC,CAAC,GAAG,QAAQ;AAAA,EACzG;AAEA,OAAK,IAAI,SAAS,GAAG;AACnB,WAAO,UAAU,UAAU,KAAK,OAAO,MAAM,aAAa,IAAIA,kBAAS,CAAC,CAAC,GAAG,KAAK,MAAM,QAAQ;AAAA,EACjG;AAEA,OAAK,KAAK,SAAS,GAAG;AACpB,WAAO,UAAU,UAAU,KAAK,OAAO,MAAM,aAAa,IAAIA,kBAAS,CAAC,CAAC,GAAG,QAAQ;AAAA,EACtF;AAEA,OAAK,KAAK,SAAS,GAAG;AACpB,WAAO,UAAU,UAAU,KAAK,KAAK,OAAO,OAAO,OAAO,MAAM,aAAa,IAAIA,kBAAS,CAAC,CAAC,GAAG,QAAQ;AAAA,EACzG;AAEA,OAAK,SACL,KAAK,SAAS,WAAW;AACvB,WAAO,SAAS,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE;AAAA,EAC9B;AAEA,OAAK,SAAS,WAAW;AACvB,WAAO,SAAS,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE;AAAA,EAC9B;AAEA,OAAK,SAAS,WAAW;AACvB,WAAO,SAAS,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE;AAAA,EAC9B;AAEA,OAAK,UAAU,SAAS,GAAG;AACzB,WAAO,UAAU,UAAU,UAAU,OAAO,MAAM,aAAa,IAAIA,kBAAS,CAAC,CAAC,CAAC,GAAG,QAAQ;AAAA,EAC5F;AAEA,OAAK,QAAQ,SAAS,GAAG;AACvB,WAAO,UAAU,UAAU,QAAQ,GAAG,WAAW,SAAS,SAAS,MAAM,OAAO,IAAI,QAAQ;AAAA,EAC9F;AAEA,OAAK,UAAU,SAAS,GAAG;AACzB,WAAO,UAAU,UAAU,KAAK,OAAO,UAAU,SAAS,OAAO,SAAS,MAAM,UAAU,CAAC,GAAG,QAAQ;AAAA,EACxG;AAEA,SAAO;AACT;;;AC/GA,SAAS,KAAKE,IAAG;AACf,SAAOA,KAAI,IAAI,KAAK;AACtB;AAMA,SAAS,OAAO,MAAM,IAAI,IAAI;AAC5B,MAAI,KAAK,KAAK,MAAM,KAAK,KACrB,KAAK,KAAK,KAAK,KACf,MAAM,KAAK,MAAM,KAAK,QAAQ,MAAM,KAAK,KAAK,KAC9C,MAAM,KAAK,KAAK,QAAQ,MAAM,KAAK,KAAK,KACxC,KAAK,KAAK,KAAK,KAAK,OAAO,KAAK;AACpC,UAAQ,KAAK,EAAE,IAAI,KAAK,EAAE,KAAK,KAAK,IAAI,KAAK,IAAI,EAAE,GAAG,KAAK,IAAI,EAAE,GAAG,MAAM,KAAK,IAAI,CAAC,CAAC,KAAK;AAC5F;AAGA,SAAS,OAAO,MAAM,GAAG;AACvB,MAAI,IAAI,KAAK,MAAM,KAAK;AACxB,SAAO,KAAK,KAAK,KAAK,MAAM,KAAK,OAAO,IAAI,KAAK,IAAI;AACvD;AAKA,SAASC,OAAM,MAAMC,KAAIC,KAAI;AAC3B,MAAI,KAAK,KAAK,KACV,KAAK,KAAK,KACV,KAAK,KAAK,KACV,KAAK,KAAK,KACV,MAAM,KAAK,MAAM;AACrB,OAAK,SAAS,cAAc,KAAK,IAAI,KAAK,KAAKD,KAAI,KAAK,IAAI,KAAK,KAAKC,KAAI,IAAI,EAAE;AAClF;AAEA,SAAS,UAAU,SAAS;AAC1B,OAAK,WAAW;AAClB;AAEA,UAAU,YAAY;AAAA,EACpB,WAAW,WAAW;AACpB,SAAK,QAAQ;AAAA,EACf;AAAA,EACA,SAAS,WAAW;AAClB,SAAK,QAAQ;AAAA,EACf;AAAA,EACA,WAAW,WAAW;AACpB,SAAK,MAAM,KAAK,MAChB,KAAK,MAAM,KAAK,MAChB,KAAK,MAAM;AACX,SAAK,SAAS;AAAA,EAChB;AAAA,EACA,SAAS,WAAW;AAClB,YAAQ,KAAK,QAAQ;AAAA,MACnB,KAAK;AAAG,aAAK,SAAS,OAAO,KAAK,KAAK,KAAK,GAAG;AAAG;AAAA,MAClD,KAAK;AAAG,QAAAF,OAAM,MAAM,KAAK,KAAK,OAAO,MAAM,KAAK,GAAG,CAAC;AAAG;AAAA,IACzD;AACA,QAAI,KAAK,SAAU,KAAK,UAAU,KAAK,KAAK,WAAW,EAAI,MAAK,SAAS,UAAU;AACnF,SAAK,QAAQ,IAAI,KAAK;AAAA,EACxB;AAAA,EACA,OAAO,SAASD,IAAGI,IAAG;AACpB,QAAID,MAAK;AAET,IAAAH,KAAI,CAACA,IAAGI,KAAI,CAACA;AACb,QAAIJ,OAAM,KAAK,OAAOI,OAAM,KAAK,IAAK;AACtC,YAAQ,KAAK,QAAQ;AAAA,MACnB,KAAK;AAAG,aAAK,SAAS;AAAG,aAAK,QAAQ,KAAK,SAAS,OAAOJ,IAAGI,EAAC,IAAI,KAAK,SAAS,OAAOJ,IAAGI,EAAC;AAAG;AAAA,MAC/F,KAAK;AAAG,aAAK,SAAS;AAAG;AAAA,MACzB,KAAK;AAAG,aAAK,SAAS;AAAG,QAAAH,OAAM,MAAM,OAAO,MAAME,MAAK,OAAO,MAAMH,IAAGI,EAAC,CAAC,GAAGD,GAAE;AAAG;AAAA,MACjF;AAAS,QAAAF,OAAM,MAAM,KAAK,KAAKE,MAAK,OAAO,MAAMH,IAAGI,EAAC,CAAC;AAAG;AAAA,IAC3D;AAEA,SAAK,MAAM,KAAK,KAAK,KAAK,MAAMJ;AAChC,SAAK,MAAM,KAAK,KAAK,KAAK,MAAMI;AAChC,SAAK,MAAMD;AAAA,EACb;AACF;AAEA,SAAS,UAAU,SAAS;AAC1B,OAAK,WAAW,IAAI,eAAe,OAAO;AAC5C;AAAA,CAEC,UAAU,YAAY,OAAO,OAAO,UAAU,SAAS,GAAG,QAAQ,SAASH,IAAGI,IAAG;AAChF,YAAU,UAAU,MAAM,KAAK,MAAMA,IAAGJ,EAAC;AAC3C;AAEA,SAAS,eAAe,SAAS;AAC/B,OAAK,WAAW;AAClB;AAEA,eAAe,YAAY;AAAA,EACzB,QAAQ,SAASA,IAAGI,IAAG;AAAE,SAAK,SAAS,OAAOA,IAAGJ,EAAC;AAAA,EAAG;AAAA,EACrD,WAAW,WAAW;AAAE,SAAK,SAAS,UAAU;AAAA,EAAG;AAAA,EACnD,QAAQ,SAASA,IAAGI,IAAG;AAAE,SAAK,SAAS,OAAOA,IAAGJ,EAAC;AAAA,EAAG;AAAA,EACrD,eAAe,SAAS,IAAI,IAAI,IAAI,IAAIA,IAAGI,IAAG;AAAE,SAAK,SAAS,cAAc,IAAI,IAAI,IAAI,IAAIA,IAAGJ,EAAC;AAAA,EAAG;AACrG;AAEO,SAAS,UAAU,SAAS;AACjC,SAAO,IAAI,UAAU,OAAO;AAC9B;;;AC/FO,SAAS,iBAAoB,MAAW,UAA0BK,QAAyB;AAChG,QAAM,SAAS,OAAO,MAAM,QAAQ;AACpC,SAAO,KAAU,EAAE,OAAO,MAAM,EAAE,MAAMA,MAAK;AAC/C;AAEO,SAAS,mBAAsB,MAAW,UAA4BA,QAAyB;AACpG,QAAM,CAAC,KAAK,GAAG,IAAI,OAAO,MAAM,QAAQ;AAKxC,QAAM,UAAU,OAAO,SAAS,GAAG,KAAK,OAAO,SAAS,GAAG;AAC3D,MAAI,CAAC,SAAS;AACZ,WAAOC,QAAY,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,EAAE,MAAMD,MAAK;AAAA,EACjD;AACA,MAAI;AACJ,MAAI,OAAO,GAAG;AAEZ,YAAQ,KAAK,IAAI,GAAG,GAAG;AAAA,EACzB,OAAO;AACL,UAAM,OAAO,MAAM;AAEnB,UAAME,QAAO,OAAO,IAAI,OAAO,OAAO;AACtC,YAAQ,KAAK,IAAI,GAAG,MAAMA,IAAG;AAE7B,QAAI,UAAU,IAAK,SAAQ,KAAK,IAAI,GAAG,MAAM,GAAG;AAAA,EAClD;AACA,QAAM,QAAQ,oBAAO;AACrB,SAAOD,QAAY,EAChB,OAAO,CAAC,OAAO,KAAK,CAAC,EACrB,KAAK,EACL,MAAMD,MAAK;AAChB;AAEO,SAAS,eACd,MACAG,IACAC,IACA,SACA;AA3CF,MAAAC;AA4CE,QAAM,UAAU,aAAU,EACvB,EAAEF,EAAC,EACH,EAAEC,EAAC;AACN,OAAI,mCAAS,YAAW,OAAO;AAC7B,YAAQ,MAAM,SAAc;AAAA,EAC9B;AACA,UAAOC,MAAA,QAAQ,IAAI,MAAZ,OAAAA,MAAiB;AAC1B;;;ACnDA,YAAYC,YAAW;AAWhB,SAAS,mBAAmB,UAA8C,CAAC,GAAoB;AACpG,QAAM,MAAY,cAAuB,IAAI;AAC7C,QAAM,SAAe,eAAQ,MAAG;AAblC,QAAAC,KAAAC,KAAA;AAasC;AAAA,MAClC,MAAKD,MAAA,QAAQ,QAAR,OAAAA,MAAe;AAAA,MACpB,QAAOC,MAAA,QAAQ,UAAR,OAAAA,MAAiB;AAAA,MACxB,SAAQ,aAAQ,WAAR,YAAkB;AAAA,MAC1B,OAAM,aAAQ,SAAR,YAAgB;AAAA,IACxB;AAAA,KAAI,CAAC,QAAQ,QAAQ,QAAQ,MAAM,QAAQ,OAAO,QAAQ,GAAG,CAAC;AAE9D,QAAM,CAAC,MAAM,OAAO,IAAU,gBAAS,EAAE,OAAO,GAAG,QAAQ,EAAE,CAAC;AAE9D,EAAM,uBAAgB,MAAM;AAC1B,QAAI,CAAC,IAAI,QAAS;AAClB,UAAM,KAAK,IAAI,eAAe,aAAW;AACvC,iBAAW,SAAS,SAAS;AAC3B,cAAM,EAAE,OAAO,OAAO,IAAI,MAAM;AAChC,gBAAQ,EAAE,OAAO,OAAO,CAAC;AAAA,MAC3B;AAAA,IACF,CAAC;AACD,OAAG,QAAQ,IAAI,OAAO;AACtB,WAAO,MAAM,GAAG,WAAW;AAAA,EAC7B,GAAG,CAAC,CAAC;AAEL,QAAM,aAAa,KAAK,IAAI,GAAG,KAAK,QAAQ,OAAO,OAAO,OAAO,KAAK;AACtE,QAAM,cAAc,KAAK,IAAI,GAAG,KAAK,SAAS,OAAO,MAAM,OAAO,MAAM;AAExE,SAAO,EAAE,OAAO,KAAK,OAAO,QAAQ,KAAK,QAAQ,YAAY,aAAa,QAAQ,IAAI;AACxF;;;ACtCA,YAAYC,YAAW;AAoCjB,gBAAAC,YAAA;AAlBN,IAAM,eAAqB,qBAAwC,IAAI;AAChE,SAAS,kBAA4C;AAAE,SAAa,kBAAW,YAAY;AAAG;AAE9F,IAAM,YAAsC,CAAC;AAAA,EAClD,SAAS;AAAA,EACT;AAAA,EACA;AAAA,EACA,YAAY;AAAA;AAAA,EACZ;AAAA,EACA,OAAO;AAAA,EACP;AACF,MAAM;AACJ,QAAM,OAAO,mBAAmB,MAAM;AACtC,QAAM,QAA6B,EAAE,QAAQ,UAAU,WAAW;AAClE,MAAI,UAAU,OAAW,OAAM,QAAQ,OAAO,UAAU,WAAW,GAAG,KAAK,OAAO;AAElF,SACE,gBAAAA,KAAC,SAAI,KAAK,KAAK,KAAY,WAAsB,OAAc,MAAY,cAAY,WACrF,0BAAAA,KAAC,aAAa,UAAb,EAAsB,OAAO,MAC3B,UACH,GACF;AAEJ;AAEA,IAAO,oBAAQ;;;AC3Cf,YAAYC,YAAW;AA0Ed,gBAAAC,YAAA;AA9DT,IAAM,eAAqB,qBAAwC,IAAI;AAChE,IAAM,kBAAkB,MAAY,kBAAW,YAAY;AAmB3D,IAAM,qBAAqB,CAAsC;AAAA,EACtE;AAAA,EACA,YAAY;AAAA,EACZ,aAAa;AAAA,EACb,QAAQ;AAAA,EACR;AAAA,EACA,aAAa;AAAA,EACb,aAAa;AAAA,EACb;AAAA,EACE;AAAA,EAAU;AACd,MAAsC;AA1CtC,MAAAC,KAAAC;AA2CE,QAAM,YAAY,gBAAgB;AAElC,QAAM,cAAaD,MAAA,0CAAkB,uCAAW,eAA7B,OAAAA,MAA2C;AAC9D,QAAM,eAAcC,MAAA,4CAAmB,uCAAW,gBAA9B,OAAAA,MAA6C;AACjE,QAAM,UAAgB,eAAQ,MAAM,OAAO,QAAQ,OAAK,EAAE,IAAI,GAAG,CAAC,MAAM,CAAC;AACzE,QAAM,SAAe,mBAAY,CAAC,MAAa;AAC7C,QAAI,WAAY,QAAO,WAAW,CAAC;AACnC,UAAM,MAAO,EAAU;AACvB,WAAO,eAAe,OAAO,MAAM,IAAI,KAAK,GAAG;AAAA,EACjD,GAAG,CAAC,UAAU,CAAC;AAEf,QAAM,OAAO,8BAAY;AACzB,QAAM,OAAO,8BAAY;AAEzB,QAAM,SAAe,eAAQ,MAAM,iBAAiB,SAAS,QAAe,CAAC,MAAM,KAAK,IAAI,GAAG,aAAa,IAAI,CAAC,CAAC,GAAG,CAAC,SAAS,QAAQ,YAAY,IAAI,CAAC;AACxJ,QAAM,SAAe,eAAQ,MAAM;AACjC,QAAI,SAAS;AACX,YAAM,QAAQ,mBAAmB,CAAC,GAAG,CAAC,MAAW,EAAE,GAAG,CAAC,KAAK,IAAI,GAAG,cAAc,IAAI,GAAG,IAAI,CAAC;AAC7F,YAAM,OAAO,OAAO;AACpB,aAAO;AAAA,IACT;AACA,WAAO,mBAAmB,SAAS,CAAC,MAAW,EAAE,GAAG,CAAC,KAAK,IAAI,GAAG,cAAc,IAAI,GAAG,IAAI,CAAC;AAAA,EAC7F,GAAG,CAAC,SAAS,aAAa,OAAO,CAAC;AAElC,QAAM,QAAiC,eAAQ,OAAO;AAAA,IACpD;AAAA,IACA;AAAA,IACA,WAAW,CAAC,QAAQ,eAAe,OAAO,MAAM,KAAK;AAAA,IACrD,WAAW,CAAC,QAAQ,eAAe,OAAO,MAAM,KAAK;AAAA,EACvD,IAAI,CAAC,QAAQ,QAAQ,YAAY,UAAU,CAAC;AAE5C,SAAO,gBAAAF,KAAC,aAAa,UAAb,EAAsB,OAAe,UAAS;AACxD;AAEA,IAAO,uBAAQ;;;AC7Ef,YAAYG,YAAW;AAkKf,gBAAAC,MAWM,QAAAC,aAXN;AAtID,IAAM,OAA4B,CAAC;AAAA,EACxC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY;AAAA,EACZ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,sBAAsB,SAAS,MAAM,OAAO;AAAA,EAC5C,aAAa;AAAA,EACb,iBAAiB;AAAA,EACjB;AACF,MAAM;AACJ,QAAM,WAAW,gBAAgB;AACjC,QAAM,OAAO,gBAAgB;AAC7B,QAAM,gBAAgB,UAAU,SAAS,MAAM,qCAAU,SAAS,qCAAU;AAC5E,QAAM,eAAe,gCAAc,SAAS,MAAM,IAAI;AAEtD,QAAM,mBAAmB,OAAO,kBAAkB;AAClD,QAAM,kBAA0D,eAAQ,MAAM;AAC5E,QAAI,iBAAkB,QAAO;AAC7B,QAAI,CAAC,iBAAkB,QAAO;AAC9B,UAAM,MAAM,CAAC,SAAqC,IAAI,KAAK,eAAe,QAAW,IAAI;AACzF,YAAQ,kBAAkB;AAAA,MACxB,KAAK;AACH,eAAO,CAAC,MAAW;AACjB,gBAAM,IAAI,aAAa,OAAO,IAAI,IAAI,KAAK,CAAC;AAC5C,iBAAO,GAAG,EAAE,QAAQ,CAAC;AAAA,EAAK,IAAI,EAAE,OAAO,QAAQ,CAAC,EAAE,OAAO,CAAC,CAAC;AAAA,QAC7D;AAAA,MACF,KAAK;AACH,eAAO,CAAC,MAAW;AACjB,gBAAM,IAAI,aAAa,OAAO,IAAI,IAAI,KAAK,CAAC;AAC1C,iBAAO,GAAG,EAAE,QAAQ,CAAC;AAAA,EAAK,IAAI,EAAE,OAAO,QAAQ,CAAC,EAAE,OAAO,CAAC,CAAC,IAAI,EAAE,YAAY,CAAC;AAAA,QAClF;AAAA,MACF,KAAK;AACH,eAAO,CAAC,MAAW;AACjB,gBAAM,IAAI,aAAa,OAAO,IAAI,IAAI,KAAK,CAAC;AAC5C,iBAAO,IAAI,EAAE,OAAO,QAAQ,CAAC,EAAE,OAAO,CAAC;AAAA,QACzC;AAAA,MACF,KAAK;AACH,eAAO,CAAC,MAAW;AACjB,gBAAM,IAAI,aAAa,OAAO,IAAI,IAAI,KAAK,CAAC;AAC5C,iBAAO,GAAG,IAAI,EAAE,OAAO,QAAQ,CAAC,EAAE,OAAO,CAAC,CAAC,IAAI,EAAE,YAAY,CAAC;AAAA,QAChE;AAAA,MACF,KAAK;AACH,eAAO,CAAC,MAAW;AACjB,gBAAM,IAAI,aAAa,OAAO,IAAI,IAAI,KAAK,CAAC;AAC5C,iBAAO,IAAI,EAAE,MAAM,WAAW,QAAQ,UAAU,CAAC,EAAE,OAAO,CAAC;AAAA,QAC7D;AAAA,MACF;AACE,eAAO;AAAA,IACX;AAAA,EACF,GAAG,CAAC,kBAAkB,gBAAgB,CAAC;AACvC,MAAI,sBAAuC,mBAAoB,gBAAqC,oBAAoB,CAAC,MAAW,OAAO,CAAC;AAC5I,QAAMC,SAAqB,eAAQ,MAAM;AACvC,QAAI,cAAc,MAAM,QAAQ,UAAU,EAAG,QAAO;AACpD,QAAI,CAAC,cAAe,QAAO,CAAC;AAC5B,QAAI,OAAO,cAAc,UAAU,WAAY,QAAO,cAAc,MAAM,YAAY;AACtF,WAAO,cAAc,SAAS,cAAc,OAAO,IAAI,CAAC;AAAA,EAC1D,GAAG,CAAC,eAAe,cAAc,UAAU,CAAC;AAG5C,MAAI,SAAS,OAAO,CAAC,oBAAoB,CAAC,oBAAoBA,OAAM,UAAUA,OAAM,MAAM,OAAK,aAAa,IAAI,GAAG;AACjH,UAAM,QAAQA,OAAM,CAAC;AACrB,UAAM,OAAOA,OAAMA,OAAM,SAAS,CAAC;AACnC,UAAM,SAAS,KAAK,QAAQ,IAAI,MAAM,QAAQ;AAC9C,UAAM,SAAS,KAAG,OAAK;AACvB,UAAM,UAAU,MAAI;AACpB,UAAM,WAAW,MAAM,YAAY,MAAM,KAAK,YAAY;AAC1D,UAAM,WAAW,IAAI,KAAK,eAAe,QAAW,EAAE,OAAO,QAAQ,CAAC;AACtE,QAAI,SAAS,IAAE,QAAQ;AACrB,YAAM,UAAU,IAAI,KAAK,eAAe,QAAW,EAAE,MAAM,WAAW,QAAQ,UAAU,CAAC;AACzF,4BAAsB,CAAC,MAAU,QAAQ,OAAO,CAAS;AAAA,IAC3D,WAAW,SAAS,KAAG,QAAQ;AAE7B,4BAAsB,CAAC,MAAU;AAC/B,cAAM,IAAI;AAAW,eAAO,GAAG,EAAE,QAAQ,CAAC,IAAI,SAAS,OAAO,CAAC,CAAC;AAAA,MAClE;AAAA,IACF,WAAW,SAAS,WAAW,UAAU;AAEvC,4BAAsB,CAAC,MAAU,SAAS,OAAO,CAAS;AAAA,IAC5D,WAAW,SAAS,IAAE,SAAS;AAE7B,YAAM,aAAa,oBAAI,IAAY;AACnC,4BAAsB,CAAC,MAAU;AAC/B,cAAM,IAAI;AAAW,cAAM,MAAM,EAAE,SAAS;AAC5C,YAAI,CAAC,WAAW,IAAI,GAAG,GAAG;AAAE,qBAAW,IAAI,GAAG;AAAA,QAAG;AACjD,eAAO,GAAG,SAAS,OAAO,CAAC,CAAC,IAAI,EAAE,YAAY,CAAC;AAAA,MACjD;AAAA,IACF,OAAO;AAEL,4BAAsB,CAAC,MAAU,OAAQ,EAAW,YAAY,CAAC;AAAA,IACnE;AAAA,EACF;AAEA,MAAI,CAAC,iBAAiB,CAAC,KAAM,QAAO;AAEpC,MAAI,SAAS,KAAK;AAChB,UAAMC,KAAI,0BAAU,KAAK;AACzB,UAAM,cAAc,OAAQ,cAAsB,cAAc;AAChE,UAAM,YAAY,cAAe,cAAsB,UAAU,IAAI;AACrE,UAAM,UAAU,CAAC,MAAW;AAC1B,YAAM,OAAO,cAAc,CAAC;AAC5B,aAAO,cAAc,OAAO,YAAY,IAAI;AAAA,IAC9C;AAEA,QAAI,qBAAqB,4CAAmB;AAC5C,QAAI,wBAAwB,oBAAoB,UAAa,oBAAoB,OAAO;AAEtF,YAAM,SAASD,OAAM,IAAI,OAAK,oBAAoB,CAAC,EAAE,QAAQ,SAAS,EAAE,CAAC;AACzE,YAAM,SAAS,OAAO,SAAS,OAAO,OAAO,CAAC,GAAE,MAAI,IAAE,EAAE,QAAO,CAAC,IAAE,OAAO,SAAS;AAClF,2BAAqB,KAAK,IAAI,IAAI,KAAK,MAAM,SAAS,IAAI,CAAC,CAAC;AAAA,IAC9D;AAEF,UAAM,gBAAsB,eAAQ,MAAM;AAEtC,UAAI,cAAc,MAAM,QAAQ,UAAU,EAAG,QAAOA;AACpD,UAAI,sBAAsB,EAAG,QAAOA;AACpC,YAAM,WAAkB,CAAC;AACzB,UAAI,UAAU;AACd,iBAAW,KAAKA,QAAO;AACzB,cAAM,MAAM,QAAQ,CAAC;AACjB,YAAI,MAAM,WAAW,oBAAoB;AACvC,mBAAS,KAAK,CAAC;AACf,oBAAU;AAAA,QACZ;AAAA,MACF;AACA,aAAO;AAAA,IACX,GAAG,CAACA,QAAO,eAAe,oBAAoB,YAAY,aAAa,SAAS,CAAC;AAC/E,WACF,gBAAAD,MAAC,OAAE,WAAW,CAAC,YAAW,eAAe,SAAS,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG,GAAG,WAAW,eAAeE,EAAC,KAAK,YAAW,iEACpH;AAAA,sBAAAH,KAAC,UAAK,IAAI,GAAG,IAAI,KAAK,YAAY,IAAI,GAAG,IAAI,GAAG,QAAO,gBAAe;AAAA,MACrE,cAAc,IAAI,CAAC,GAAG,MAAM;AAnKrC,YAAAI;AAoKU,cAAM,WAAW,oBAAoB,CAAC;AACpC,cAAM,eAAgB,sBAAsB,SAAS,SAAS,qBAC1D,SAAS,MAAM,GAAG,KAAK,IAAI,GAAG,qBAAqB,CAAC,CAAC,IAAI,WACzD;AACN,cAAM,QAAQ,iBAAiB,aAAa,MAAM,IAAI,IAAI,CAAC,aAAa,QAAQ,OAAM,GAAI,CAAC;AAC3F,cAAM,SAAS,aAAa,IAAI,QAAQ,aAAa,IAAI,UAAU;AACnE,eACJ,gBAAAH,MAAC,OAA6B,WAAW,aAAa,QAAQ,CAAC,CAAC,OACxD;AAAA,0BAAAD,KAAC,UAAK,IAAI,GAAG,QAAO,gBAAe;AAAA,UACnC,gBAAAC,MAAC,UAAK,GAAG,GAAG,YAAY,QAAQ,WAAU,kBAAiB,kBAAiB,WAAU,WAAW,aAAa,UAAU,UAAU,MAAM,QAAW,YAAW,WAC3J;AAAA,kBAAM,IAAI,CAAC,IAAI,OACd,gBAAAD,KAAC,WAAe,GAAG,GAAG,IAAI,OAAK,IAAE,IAAE,SAAU,gBAAjC,EAAoC,CACjD;AAAA,YACA,iBAAiB,YAAY,gBAAAA,KAAC,WAAO,oBAAS;AAAA,aACjD;AAAA,eAPAI,MAAA,uBAAG,aAAH,gBAAAA,IAAA,YAAmB,CAQrB;AAAA,MAEJ,CAAC;AAAA,OACH;AAAA,EAEJ;AAEA,SACA,gBAAAH,MAAC,OAAE,WAAW,CAAC,YAAW,eAAe,SAAS,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG,GAAG,YAAW,iEACrF;AAAA,IAAAC,OAAM,IAAI,CAAC,GAAG,MAAM;AA5L3B,UAAAE;AA6LQ,YAAM,WAAW,oBAAoB,CAAC;AACtC,YAAM,eAAgB,sBAAsB,SAAS,SAAS,qBAC1D,SAAS,MAAM,GAAG,KAAK,IAAI,GAAG,qBAAqB,CAAC,CAAC,IAAI,WACzD;AACJ,YAAM,QAAQ,iBAAiB,aAAa,MAAM,IAAI,IAAI,CAAC,aAAa,QAAQ,OAAM,GAAG,CAAC;AAC1F,aACE,gBAAAH,MAAC,OAA6B,WAAW,eAAe,cAAc,CAAC,CAAC,KACtE;AAAA,wBAAAD,KAAC,UAAK,IAAI,IAAI,QAAO,gBAAe;AAAA,QACpC,gBAAAC,MAAC,UAAK,GAAG,IAAI,IAAG,UAAS,YAAW,OAAM,WAAU,kBAAiB,YAAW,WAC7E;AAAA,gBAAM,IAAI,CAAC,IAAI,OACd,gBAAAD,KAAC,WAAe,GAAG,IAAI,IAAI,OAAK,IAAE,IAAE,SAAU,gBAAlC,EAAqC,CAClD;AAAA,UACA,iBAAiB,YAAY,gBAAAA,KAAC,WAAO,oBAAS;AAAA,WACjD;AAAA,aAPMI,MAAA,uBAAG,aAAH,gBAAAA,IAAA,YAAmB,CAQ3B;AAAA,IAEJ,CAAC;AAAA,IACA,SACC,gBAAAJ,KAAC,UAAK,WAAU,eAAc,GAAG,CAAC,KAAK,cAAc,GAAG,GAAG,CAAC,KAAK,OAAO,OAAO,IAAI,YAAW,UAAS,WAAU,mBAAkB,YAAW,WAAW,iBAAM;AAAA,KAEnK;AAEJ;AAEA,IAAO,eAAQ;;;AC7LX,SAEI,OAAAK,MAFJ,QAAAC,aAAA;AAZG,IAAM,YAAsC,CAAC;AAAA,EAClD,OAAO;AAAA,EACP;AAAA,EACA,SAAS;AAAA,EACT,YAAY;AAAA,EACZ;AACF,MAAM;AACJ,QAAM,WAAW,gBAAgB;AACjC,QAAM,OAAO,gBAAgB;AAC7B,MAAI,CAAC,YAAY,CAAC,KAAM,QAAO;AAC/B,QAAMC,SAAQ,SAAS,MAAM,SAAS,UAAU,SAAS,IAAI,SAAS,UAAU,SAAS;AACzF,SACE,gBAAAD,MAAC,OAAE,WAAW,CAAC,YAAY,SAAS,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG,GAC3D;AAAA,aAAS,OAAOC,OAAM,IAAI,CAAC,GAAG,MAC7B,gBAAAF,KAAC,UAAa,IAAI,GAAG,IAAI,KAAK,YAAY,IAAI,SAAS,OAAO,CAAC,GAAG,IAAI,SAAS,OAAO,CAAC,GAAG,QAAgB,iBAAiB,aAAhH,CAA2H,CACvI;AAAA,IACA,SAAS,OAAOE,OAAM,IAAI,CAAC,GAAG,MAC7B,gBAAAF,KAAC,UAAa,IAAI,GAAG,IAAI,KAAK,aAAa,IAAI,SAAS,OAAO,CAAC,GAAG,IAAI,SAAS,OAAO,CAAC,GAAG,QAAgB,iBAAiB,aAAjH,CAA4H,CACxI;AAAA,KACH;AAEJ;AAEA,IAAO,oBAAQ;;;ACnCf,YAAYG,YAAW;;;ACAvB;AAAA,EACE,OAAS;AAAA,IACP,YAAY;AAAA,MACV,OAAS;AAAA,MACT,aAAe;AAAA,QACb,KAAK,EAAE,QAAU,wBAAwB,cAAgB,wCAAmC;AAAA,QAC5F,KAAK,EAAE,QAAU,WAAW,cAAgB,uCAAkC;AAAA,QAC9E,KAAK,EAAE,QAAU,gCAAgC,cAAgB,4CAAuC;AAAA,QACxG,KAAK,EAAE,QAAU,WAAW,cAAgB,wCAAmC;AAAA,QAC/E,KAAK,EAAE,QAAU,yBAAyB,cAAgB,uCAAkC;AAAA,QAC5F,KAAK,EAAE,QAAU,iCAAiC,cAAgB,yEAAoE;AAAA,QACtI,KAAK,EAAE,QAAU,WAAW,cAAgB,0EAAqE;AAAA,QACjH,KAAK,EAAE,QAAU,0BAA0B,cAAgB,sCAAiC;AAAA,QAC5F,KAAK,EAAE,QAAU,WAAW,cAAgB,qDAAgD;AAAA,QAC5F,MAAM,EAAE,QAAU,WAAW,cAAgB,qDAAgD;AAAA,QAC7F,MAAM,EAAE,QAAU,0BAA0B,cAAgB,qDAAgD;AAAA,QAC5G,MAAM,EAAE,QAAU,WAAW,cAAgB,kDAA6C;AAAA,MAC5F;AAAA,MACA,SAAW;AAAA,QACT,YAAc,EAAE,QAAU,kBAAkB,cAAgB,uCAAuC;AAAA,MACrG;AAAA,MACA,QAAU;AAAA,QACR,UAAY;AAAA,QACZ,cAAc,EAAE,QAAU,wBAAwB,cAAgB,6BAAwB;AAAA,QAC1F,cAAc,EAAE,QAAU,WAAW,cAAgB,mCAA8B;AAAA,QACnF,mBAAmB,EAAE,QAAU,0BAA0B,cAAgB,oCAA+B;AAAA,QACxG,UAAY,EAAE,QAAU,0BAA0B,cAAgB,2BAAsB;AAAA,QAC5F,QAAU,EAAE,QAAU,WAAW,cAAgB,sCAAiC;AAAA,QAC9E,cAAc,EAAE,QAAU,WAAW,cAAgB,6CAAwC;AAAA,QAC7F,cAAc,EAAE,QAAU,WAAW,cAAgB,sDAAiD;AAAA,MACxG;AAAA,MACA,UAAY;AAAA,QACV,UAAY;AAAA,QACZ,KAAO,EAAE,QAAU,iCAAiC,cAAgB,6CAAwC;AAAA,QAC5G,UAAY,EAAE,QAAU,iCAAiC,cAAgB,uCAAkC;AAAA,QAC3G,MAAQ,EAAE,QAAU,4BAA4B,cAAgB,8BAAyB;AAAA,QACzF,UAAY,EAAE,QAAU,uBAAuB,cAAgB,+BAA0B;AAAA,MAC3F;AAAA,MACA,aAAa;AAAA,QACX,UAAY;AAAA,QACZ,OAAS,EAAE,QAAU,wBAAwB,cAAgB,wBAAmB;AAAA,QAChF,WAAa,EAAE,QAAU,yBAAyB,cAAgB,6BAAwB;AAAA,QAC1F,KAAO,EAAE,QAAU,6BAA6B,cAAgB,2BAAsB;AAAA,QACtF,QAAU,EAAE,QAAU,0BAA0B,cAAgB,2BAAsB;AAAA,MACxF;AAAA,MACA,QAAU;AAAA,QACR,UAAY;AAAA,QACZ,aAAe;AAAA,UACb,KAAK,EAAE,QAAU,WAAW,cAAgB,6BAA6B;AAAA,UACzE,KAAK,EAAE,QAAU,WAAW,cAAgB,mCAAmC;AAAA,UAC/E,KAAK,EAAE,QAAU,WAAW,cAAgB,mCAAmC;AAAA,UAC/E,KAAK,EAAE,QAAU,WAAW,cAAgB,oCAAoC;AAAA,UAChF,KAAK,EAAE,QAAU,WAAW,cAAgB,8BAA8B;AAAA,UAC1E,KAAK,EAAE,QAAU,WAAW,cAAgB,oCAAoC;AAAA,UAChF,KAAK,EAAE,QAAU,WAAW,cAAgB,kCAAkC;AAAA,UAC9E,KAAK,EAAE,QAAU,WAAW,cAAgB,6BAA6B;AAAA,UACzE,KAAK,EAAE,QAAU,WAAW,cAAgB,oCAAoC;AAAA,UAChF,MAAM,EAAE,QAAU,WAAW,cAAgB,sCAAsC;AAAA,UACnF,MAAM,EAAE,QAAU,WAAW,cAAgB,gCAAgC;AAAA,UAC7E,MAAM,EAAE,QAAU,WAAW,cAAgB,+BAA+B;AAAA,QAC9E;AAAA,QACA,QAAU;AAAA,UACR,UAAY;AAAA,UACZ,cAAc,EAAE,QAAU,WAAW,cAAgB,6CAA6C;AAAA,UAClG,cAAc,EAAE,QAAU,WAAW,cAAgB,kDAAkD;AAAA,UACvG,mBAAmB,EAAE,QAAU,WAAW,cAAgB,oDAAoD;AAAA,UAC9G,UAAY,EAAE,QAAU,WAAW,cAAgB,2CAA2C;AAAA,UAC9F,QAAU,EAAE,QAAU,WAAW,cAAgB,+CAA+C;AAAA,UAChG,cAAc,EAAE,QAAU,WAAW,cAAgB,8CAA8C;AAAA,UACnG,cAAc,EAAE,QAAU,WAAW,cAAgB,8CAA8C;AAAA,QACrG;AAAA,QACA,UAAY;AAAA,UACV,UAAY;AAAA,UACZ,KAAO,EAAE,QAAU,WAAW,cAAgB,6CAA6C;AAAA,UAC3F,UAAY,EAAE,QAAU,WAAW,cAAgB,kDAAkD;AAAA,UACrG,MAAQ,EAAE,QAAU,WAAW,cAAgB,yCAAyC;AAAA,UACxF,UAAY,EAAE,QAAU,WAAW,cAAgB,0CAA0C;AAAA,QAC/F;AAAA,QACA,aAAa;AAAA,UACX,UAAY;AAAA,UACZ,OAAS,EAAE,QAAU,WAAW,cAAgB,+BAA+B;AAAA,UAC/E,WAAa,EAAE,QAAU,WAAW,cAAgB,oCAAoC;AAAA,UACxF,KAAO,EAAE,QAAU,WAAW,cAAgB,kCAAkC;AAAA,UAChF,QAAU,EAAE,QAAU,WAAW,cAAgB,kCAAkC;AAAA,QACrF;AAAA,MACF;AAAA,MAEA,KAAO;AAAA,QACL,UAAY;AAAA,QACZ,aAAe,EAAE,QAAU,WAAW,cAAgB,6CAA6C;AAAA,QACnG,SAAW,EAAE,QAAU,WAAW,cAAgB,4CAA4C;AAAA,QAC9F,gBAAgB,EAAE,QAAU,WAAW,cAAgB,+CAA+C;AAAA,QACtG,gBAAgB,EAAE,QAAU,WAAW,cAAgB,wCAAwC;AAAA,QAC/F,kBAAkB,EAAE,QAAU,WAAW,cAAgB,iDAAiD;AAAA,QAC1G,kBAAkB,EAAE,QAAU,WAAW,cAAgB,qDAAqD;AAAA,QAC9G,UAAY;AAAA,UACV,UAAY;AAAA,UACZ,MAAQ;AAAA,YACN,iBAAiB,EAAE,QAAU,QAAQ,cAAgB,mDAAmD;AAAA,YACxG,eAAe,EAAE,QAAU,QAAQ,cAAgB,6BAA6B;AAAA,YAChF,eAAe,EAAE,QAAU,KAAK,cAAgB,0BAA0B;AAAA,YAC1E,0BAA0B,EAAE,QAAU,QAAQ,cAAgB,qDAAqD;AAAA,YACnH,wBAAwB,EAAE,QAAU,QAAQ,cAAgB,oCAAoC;AAAA,YAChG,wBAAwB,EAAE,QAAU,KAAK,cAAgB,oCAAoC;AAAA,UAC/F;AAAA,QACF;AAAA,QACA,QAAU;AAAA,UACR,UAAY;AAAA,UACZ,aAAe,EAAE,QAAU,WAAW,cAAgB,gCAAgC;AAAA,UACtF,SAAW,EAAE,QAAU,WAAW,cAAgB,4BAA4B;AAAA,UAC9E,gBAAgB,EAAE,QAAU,WAAW,cAAgB,iCAAiC;AAAA,UACxF,gBAAgB,EAAE,QAAU,WAAW,cAAgB,iCAAiC;AAAA,UACxF,kBAAkB,EAAE,QAAU,WAAW,cAAgB,mCAAmC;AAAA,UAC5F,kBAAkB,EAAE,QAAU,WAAW,cAAgB,mCAAmC;AAAA,QAC9F;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF;;;ACtHA;AAAA,EACE,OAAS;AAAA,IACV,SAAW;AAAA,MACT,OAAS;AAAA,MACT,MAAQ;AAAA,QACT,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,eAAe;AAAA,QAChB,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,OAAS;AAAA,QACV,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,OAAS;AAAA,QACV,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,OAAS;AAAA,QACV,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,QAAU;AAAA,QACX,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,aAAa;AAAA,QACd,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,KAAO;AAAA,QACR,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,gBAAgB;AAAA,QACjB,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,QAAU;AAAA,QACX,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,IACF;AAAA,IACA,WAAa;AAAA,MACX,OAAS;AAAA,MACT,eAAe;AAAA,QAChB,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,eAAe;AAAA,QAChB,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,iBAAiB;AAAA,QAClB,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,QAAU;AAAA,QACX,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,WAAa;AAAA,QACd,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,cAAc;AAAA,QACf,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,cAAc;AAAA,QACf,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,MAAQ;AAAA,QACT,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,eAAe;AAAA,QAChB,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,eAAe;AAAA,QAChB,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,OAAS;AAAA,QACV,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,IACF;AAAA,IACA,MAAQ;AAAA,MACN,OAAS;AAAA,MACT,KAAK;AAAA,QACN,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,KAAK;AAAA,QACN,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,KAAK;AAAA,QACN,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,KAAK;AAAA,QACN,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,KAAK;AAAA,QACN,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,IACF;AAAA,IACA,eAAiB;AAAA,MACf,OAAS;AAAA,MACT,UAAY;AAAA,MACZ,aAAa;AAAA,QACd,OAAS;AAAA,UACP,QAAU;AAAA,UACV,cAAgB;AAAA,QAClB;AAAA,QACA,YAAc;AAAA,UACZ,QAAU;AAAA,UACV,cAAgB;AAAA,QAClB;AAAA,MACC;AAAA,MACA,YAAY;AAAA,QACb,MAAQ;AAAA,UACN,QAAU;AAAA,UACV,cAAgB;AAAA,QAClB;AAAA,QACA,QAAU;AAAA,UACR,QAAU;AAAA,UACV,cAAgB;AAAA,QAClB;AAAA,MACC;AAAA,MACA,UAAY;AAAA,QACb,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,MACA,UAAY;AAAA,QACb,QAAU;AAAA,QACV,cAAgB;AAAA,MACf;AAAA,IACF;AAAA,EACC;AACF;;;AC5IA,IAAM,oBAAoB;AAAA,EACxB;AAAA,EAAW;AAAA,EAAW;AAAA,EAAW;AAAA,EACjC;AAAA,EAAW;AAAA,EAAW;AAAA,EAAW;AAAA,EACjC;AAAA,EAAW;AAAA,EAAW;AAAA,EAAW;AACnC;AAEA,IAAI,qBAAsC;AAC1C,IAAI,8BAA+C;AACnD,IAAI,uBAAwC;AAG5C,IAAI,sBAA2C;AAO/C,SAAS,eAAyB;AAChC,QAAM,OAAY,EAAE,OAAO,EAAE,GAAI,eAAoB,OAAO,GAAI,iBAAsB,MAAM,EAAE;AAE5F,QAAM,UAAU,CAACC,OAAc,OAAoB,oBAAI,IAAI,MAA0B;AACnF,QAAI,KAAK,IAAIA,KAAI,EAAG,QAAO;AAC3B,SAAK,IAAIA,KAAI;AACb,UAAM,OAAOA,MAAK,MAAM,GAAG,EAAE,OAAO,CAAC,KAAU,MAAO,MAAM,IAAI,CAAC,IAAI,QAAY,IAAI;AACrF,QAAI,CAAC,KAAM,QAAO;AAClB,UAAM,QAAQ,KAAK,UAAU,KAAK;AAClC,QAAI,OAAO,UAAU,YAAY,WAAW,KAAK,KAAK,GAAG;AACvD,aAAO,QAAQ,MAAM,MAAM,GAAG,EAAE,GAAG,IAAI;AAAA,IACzC;AACA,QAAI,OAAO,UAAU,SAAU,QAAO;AACtC,WAAO;AAAA,EACT;AAEA,QAAM,UAAoB,CAAC;AAC3B,MAAI;AACF,aAAS,IAAI,GAAG,KAAK,IAAI,KAAK;AAC5B,YAAM,YAAY,8BAA8B,CAAC;AACjD,YAAMC,OAAM,QAAQ,SAAS;AAC7B,UAAI,CAACA,KAAK,OAAM,IAAI,MAAM,iBAAiB,SAAS,EAAE;AACtD,cAAQ,KAAKA,IAAG;AAAA,IAClB;AACA,WAAO;AAAA,EACT,SAAS,GAAG;AACV,WAAO;AAAA,EACT;AACJ;AAEA,SAAS,aAAuB;AAC9B,MAAI,CAAC,mBAAoB,sBAAqB,aAAa;AAC3D,SAAO;AACT;AAMA,SAAS,SAASA,MAAyD;AACzE,QAAM,IAAI,4CAA4C,KAAKA,KAAI,KAAK,CAAC;AACrE,MAAI,CAAC,EAAG,QAAO;AACf,SAAO,EAAE,GAAG,SAAS,EAAE,CAAC,GAAG,EAAE,GAAG,GAAG,SAAS,EAAE,CAAC,GAAG,EAAE,GAAG,GAAG,SAAS,EAAE,CAAC,GAAG,EAAE,EAAE;AAC/E;AAGA,SAAS,aAAaC,IAAmB;AAAE,EAAAA,MAAK;AAAK,SAAOA,MAAK,UAAUA,KAAI,QAAQ,KAAK,KAAKA,KAAI,SAAS,OAAO,GAAG;AAAG;AAE3H,SAAS,SAASC,IAAW,GAAW,GAAgD;AACtF,QAAM,IAAI,aAAaA,EAAC;AAAG,QAAM,IAAI,aAAa,CAAC;AAAG,QAAM,IAAI,aAAa,CAAC;AAE9E,QAAMD,KAAI,IAAI,SAAS,IAAI,SAAS,IAAI;AACxC,QAAME,KAAI,IAAI,SAAS,IAAI,SAAS,IAAI;AACxC,QAAM,IAAI,IAAI,SAAS,IAAI,SAAS,IAAI;AACxC,SAAO,EAAE,GAAGF,KAAI,KAAK,GAAGE,KAAI,KAAK,GAAG,IAAI,IAAI;AAC9C;AAEA,SAAS,SAASF,IAAWE,IAAW,GAAgB;AAEtD,QAAM,OAAO,QAAQ,OAAO,KAAO,OAAO;AAC1C,MAAI,IAAIF,KAAI,MAAM,IAAIE,KAAI,MAAM,IAAI,IAAI;AACxC,QAAM,IAAI,CAAC,MAAe,IAAI,UAAW,KAAK,KAAK,CAAC,IAAK,QAAQ,IAAK,KAAK;AAC3E,MAAI,EAAE,CAAC;AAAG,MAAI,EAAE,CAAC;AAAG,MAAI,EAAE,CAAC;AAC3B,SAAO,EAAE,GAAI,MAAM,IAAK,IAAI,GAAG,OAAO,IAAI,IAAI,GAAG,OAAO,IAAI,GAAG;AACjE;AAEA,SAAS,SAASH,MAAyB;AACzC,QAAMI,OAAM,SAASJ,IAAG;AACxB,MAAI,CAACI,KAAK,QAAO;AACjB,QAAM,MAAM,SAASA,KAAI,GAAGA,KAAI,GAAGA,KAAI,CAAC;AACxC,SAAO,SAAS,IAAI,GAAG,IAAI,GAAG,IAAI,CAAC;AACrC;AAEA,SAAS,SAAS,IAAS,IAAiB;AAC1C,QAAM,KAAK,GAAG,IAAI,GAAG;AAAG,QAAM,KAAK,GAAG,IAAI,GAAG;AAAG,QAAM,KAAK,GAAG,IAAI,GAAG;AACrE,SAAO,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,EAAE;AAC9C;AAEA,SAAS,mCAA6C;AACpD,QAAM,OAAO,WAAW;AACxB,MAAI,KAAK,UAAU,EAAG,QAAO,KAAK,MAAM;AACxC,QAAM,OAAO,KAAK,IAAI,OAAK,SAAS,CAAC,CAAC;AAEtC,MAAI,eAAe;AAAG,MAAI,UAAU;AACpC,WAAS,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK;AACpC,UAAM,KAAK,KAAK,CAAC;AAAG,QAAI,CAAC,GAAI;AAC7B,QAAI,QAAQ;AAAG,QAAI,QAAQ;AAC3B,aAAS,IAAI,GAAG,IAAI,KAAK,QAAQ,IAAK,KAAI,MAAM,KAAK,KAAK,CAAC,GAAG;AAAE,eAAS,SAAS,IAAI,KAAK,CAAC,CAAE;AAAG;AAAA,IAAS;AAC1G,UAAM,MAAM,QAAQ,KAAK,IAAI,GAAG,KAAK;AACrC,QAAI,MAAM,SAAS;AAAE,gBAAU;AAAK,qBAAe;AAAA,IAAG;AAAA,EACxD;AACA,QAAM,YAAY,IAAI,IAAY,KAAK,IAAI,CAAC,GAAG,MAAM,CAAC,CAAC;AACvD,QAAM,QAAkB,CAAC;AACzB,QAAM,KAAK,YAAY;AAAG,YAAU,OAAO,YAAY;AACvD,SAAO,UAAU,MAAM;AACrB,QAAI,UAAU,MAAM,KAAK,SAAS,EAAE,CAAC;AACrC,QAAI,UAAU;AACd,eAAW,OAAO,WAAW;AAC3B,YAAM,IAAI,KAAK,GAAG;AAAG,UAAI,CAAC,EAAG;AAE7B,UAAI,OAAO;AACX,iBAAW,KAAK,OAAO;AACrB,cAAM,KAAK,KAAK,CAAC;AAAG,YAAI,IAAI;AAAE,gBAAM,IAAI,SAAS,GAAG,EAAE;AAAG,cAAI,IAAI,KAAM,QAAO;AAAA,QAAG;AAAA,MACnF;AACA,UAAI,OAAO,SAAS;AAAE,kBAAU;AAAM,kBAAU;AAAA,MAAK;AAAA,IACvD;AACA,UAAM,KAAK,OAAO;AAAG,cAAU,OAAO,OAAO;AAAA,EAC/C;AACA,SAAO,MAAM,IAAI,OAAK,KAAK,CAAC,CAAC;AAC/B;AAEA,SAAS,sBAAgC;AACvC,MAAI,CAAC,4BAA6B,+BAA8B,iCAAiC;AACjG,SAAO;AACT;AAEA,SAAS,gBAA0B;AAAE,SAAO,WAAW;AAAG;AAK1D,SAAS,SAAS,GAAS,GAAS,GAAS;AAC3C,QAAMD,MAAK,IAAI,MAAM;AAAK,QAAMF,KAAI,IAAI,MAAME;AAAG,QAAM,IAAIA,KAAI,IAAI;AACnE,QAAM,IAAI,CAAC,MAAW;AAAE,UAAM,KAAK,IAAE,IAAE;AAAG,WAAO,KAAK,UAAW,MAAM,IAAI,KAAG,OAAK;AAAA,EAAO;AAC1F,QAAM,IAAI,EAAEF,EAAC,IAAI;AAAQ,QAAM,IAAI,EAAEE,EAAC,IAAI;AAAK,QAAM,IAAI,EAAE,CAAC,IAAI;AAAS,SAAO,EAAC,GAAE,GAAE,EAAC;AACxF;AACA,SAAS,SAASF,IAASE,IAAS,GAAe;AACjD,EAAAF,MAAG;AAAK,EAAAE,MAAG;AAAK,OAAG;AACnB,MAAI,IAAIF,KAAE,SAASE,KAAE,UAAU,IAAE;AACjC,MAAI,IAAIF,KAAE,UAAUE,KAAE,SAAS,IAAE;AACjC,MAAI,IAAIF,KAAE,SAASE,KAAE,SAAU,IAAE;AACjC,QAAM,YAAY,CAAC,MAAY,KAAK,WAAY,QAAM,IAAI,QAAM,KAAK,IAAI,GAAE,IAAE,GAAG,IAAE;AAClF,MAAI,KAAK,IAAI,GAAG,KAAK,IAAI,GAAG,UAAU,CAAC,CAAC,CAAC;AACzC,MAAI,KAAK,IAAI,GAAG,KAAK,IAAI,GAAG,UAAU,CAAC,CAAC,CAAC;AACzC,MAAI,KAAK,IAAI,GAAG,KAAK,IAAI,GAAG,UAAU,CAAC,CAAC,CAAC;AACzC,SAAO,EAAE,GAAG,KAAK,MAAM,IAAE,GAAG,GAAG,GAAG,KAAK,MAAM,IAAE,GAAG,GAAG,GAAG,KAAK,MAAM,IAAE,GAAG,EAAE;AAC5E;AACA,SAAS,SAASD,IAAS,GAAS,GAAS;AAAE,SAAO,IAAI,CAACA,IAAE,GAAE,CAAC,EAAE,IAAI,OAAG,EAAE,SAAS,EAAE,EAAE,SAAS,GAAE,GAAG,CAAC,EAAE,KAAK,EAAE,CAAC;AAAI;AACrH,SAAS,gBAAgBF,MAAY,QAAuB;AAC1D,QAAM,MAAM,SAASA,IAAG;AAAG,MAAG,CAAC,IAAK,QAAOA;AAC3C,QAAM,IAAI,KAAK,IAAI,KAAK,KAAK,IAAI,GAAG,IAAI,IAAI,MAAM,CAAC;AACnD,QAAM,EAAC,GAAE,GAAE,EAAC,IAAI,SAAS,GAAG,IAAI,GAAG,IAAI,CAAC;AACxC,QAAMI,OAAM,SAAS,GAAE,GAAE,CAAC;AAC1B,SAAO,SAASA,KAAI,GAAEA,KAAI,GAAEA,KAAI,CAAC;AACnC;AAEA,SAAS,uBAAiC;AACxC,QAAM,OAAO,wBAAwB,QAAQ,cAAc,IAAI,oBAAoB;AAEnF,QAAM,SAAS,CAAC,IAAI,KAAK,IAAI,GAAG;AAChC,QAAM,WAAuB,OAAO,IAAI,OAAK,KAAK,IAAI,OAAK,gBAAgB,GAAG,CAAC,CAAC,CAAC;AAEjF,QAAM,WAAqB,CAAC,GAAG,IAAI;AACnC,WAAS,QAAQ,OAAK,SAAS,KAAK,GAAG,CAAC,CAAC;AACzC,SAAO;AACT;AAEA,SAAS,qBAA+B;AACtC,MAAI,CAAC,wBAAwB,qCAAqC,GAAG;AACnE,2BAAuB,qBAAqB;AAC5C,2BAAuB;AAAA,EACzB;AACA,SAAO;AACT;AACA,IAAI,uBAAmD;AACvD,SAAS,uCAAuC;AAAE,SAAO,yBAAyB;AAAqB;AAEhG,SAAS,gBAAgB,GAAW;AACzC,QAAM,MAAM,mBAAmB;AAC/B,SAAO,IAAI,IAAI,IAAI,MAAM;AAC3B;AAIO,SAAS,iCAA2C;AAAE,SAAO,CAAC,GAAG,oBAAoB,CAAC;AAAG;AACzF,SAAS,2BAAqC;AAAE,SAAO,CAAC,GAAG,cAAc,CAAC;AAAG;AAC7E,SAAS,gCAA0C;AAAE,SAAO,CAAC,GAAG,mBAAmB,CAAC;AAAG;AAG9F,IAAI,uBAAwC;AAC5C,IAAI,kBAAgD;AACpD,IAAI,oBAAkD;AACtD,IAAI,oBAAkD;AAEtD,SAAS,kBAAkB;AAlN3B,MAAAC,KAAAC,KAAA;AAmNE,QAAM,UAAU,MAAAA,OAAAD,MAAA,qCAAAA,IAAuB,UAAvB,gBAAAC,IAA+B,gBAA/B,mBAA4C;AAC5D,MAAI,QAAQ;AACV,UAAM,MAAM,OAAO,eAAe,CAAC;AACnC,2BAAuB,CAAC;AACxB,aAAS,IAAE,GAAE,KAAG,IAAG,KAAK;AACtB,YAAM,MAAI,SAAI,OAAO,CAAC,CAAC,MAAb,mBAAgB,aAAU,SAAI,OAAO,CAAC,CAAC,MAAb,mBAAgB;AACpD,2BAAqB,KAAK,OAAO,MAAM,WAAW,IAAI,SAAS;AAAA,IACjE;AACA,UAAM,MAAM,OAAO,UAAU,CAAC;AAC9B,sBAAkB,CAAC;AACnB,WAAO,KAAK,GAAG,EAAE,QAAQ,OAAK;AA7NlC,UAAAD,KAAAC;AA8NM,YAAM,MAAID,MAAA,IAAI,CAAC,MAAL,gBAAAA,IAAQ,aAAUC,MAAA,IAAI,CAAC,MAAL,gBAAAA,IAAQ;AACpC,UAAI,OAAO,MAAM,SAAU,iBAAiB,CAAC,IAAI;AAAA,IACnD,CAAC;AACD,UAAM,MAAM,OAAO,YAAY,CAAC;AAChC,UAAM,MAAM,OAAO,WAAW,KAAK,CAAC;AACpC,wBAAoB,CAAC;AACrB,WAAO,KAAK,GAAG,EAAE,QAAQ,OAAK;AApOlC,UAAAD,KAAAC;AAqOM,YAAM,MAAID,MAAA,IAAI,CAAC,MAAL,gBAAAA,IAAQ,aAAUC,MAAA,IAAI,CAAC,MAAL,gBAAAA,IAAQ;AACpC,UAAI,OAAO,MAAM,SAAU,mBAAmB,CAAC,IAAI;AAAA,IACrD,CAAC;AACD,wBAAoB,CAAC;AACrB,WAAO,KAAK,GAAG,EAAE,QAAQ,OAAK;AAzOlC,UAAAD,KAAAC;AA0OM,YAAM,MAAID,MAAA,IAAI,CAAC,MAAL,gBAAAA,IAAQ,aAAUC,MAAA,IAAI,CAAC,MAAL,gBAAAA,IAAQ;AACpC,UAAI,OAAO,MAAM,SAAU,mBAAmB,CAAC,IAAI;AAAA,IACrD,CAAC;AAAA,EACH;AACF;AAEA,SAAS,mBAAmB;AAC1B,MAAI,CAAC,wBAAwB,CAAC,mBAAmB,CAAC,qBAAqB,CAAC,kBAAmB,iBAAgB;AAC7G;AAEO,SAAS,iBAAiB,GAAW;AAC1C,mBAAiB;AACjB,MAAI,CAAC,qBAAsB,QAAO;AAClC,SAAO,qBAAqB,IAAI,qBAAqB,MAAM;AAC7D;AAEO,SAAS,gBAAgB,IAAgC;AAC9D,mBAAiB;AACjB,SAAO,kBAAkB,gBAAgB,EAAE,IAAI;AACjD;AAEO,SAAS,iBAAiB,IAAY,eAA+B;AAC1E,SAAO,gBAAgB,EAAE,KAAK,iBAAiB,aAAa;AAC9D;AAGO,IAAM,eAAe,CAAE,OAAO,YAAY,QAAQ,UAAW;AAEpE,IAAI,cAA4C;AAEhD,SAAS,mBAA0C;AACjD,QAAM,OAAY,EAAE,OAAO,EAAE,GAAI,eAAoB,OAAO,GAAI,iBAAsB,MAAM,EAAE;AAC9F,QAAM,UAAU,CAACC,OAAc,OAAoB,oBAAI,IAAI,MAA0B;AACnF,QAAI,KAAK,IAAIA,KAAI,EAAG,QAAO;AAC3B,SAAK,IAAIA,KAAI;AACb,UAAM,OAAOA,MAAK,MAAM,GAAG,EAAE,OAAO,CAAC,KAAU,MAAO,MAAM,IAAI,CAAC,IAAI,QAAY,IAAI;AACrF,QAAI,CAAC,KAAM,QAAO;AAClB,UAAM,QAAQ,KAAK,UAAU,KAAK;AAClC,QAAI,OAAO,UAAU,YAAY,WAAW,KAAK,KAAK,EAAG,QAAO,QAAQ,MAAM,MAAM,GAAE,EAAE,GAAG,IAAI;AAC/F,WAAO,OAAO,UAAU,WAAW,QAAQ;AAAA,EAC7C;AACA,QAAMC,OAA6B,CAAC;AACpC,eAAa,QAAQ,QAAM;AACzB,UAAMC,OAAM,QAAQ,2BAA2B,EAAE,EAAE;AACnD,QAAIA,KAAK,CAAAD,KAAI,EAAE,IAAIC;AAAA,EACrB,CAAC;AACD,SAAOD;AACT;AAEA,SAAS,iBAAwC;AAAE,MAAI,CAAC,YAAa,eAAc,iBAAiB;AAAG,SAAO;AAAa;AACpH,SAAS,iBAAiB,IAAgC;AAAE,SAAO,eAAe,EAAE,GAAG,YAAY,CAAC;AAAG;AACvG,SAAS,kBAAkB,IAAY,eAA+B;AAC3E,SAAO,iBAAiB,EAAE,KAAK,eAAe,EAAE,aAAa,gBAAgB,aAAa,MAAM,CAAC,KAAK,gBAAgB,aAAa;AACrI;AACO,SAAS,kBAAkB,IAAgC;AAAE,mBAAiB;AAAG,SAAO,oBAAoB,kBAAkB,EAAE,IAAI;AAAW;AAC/I,SAAS,mBAAmB,IAAY,eAA+B;AAC5E,SAAO,kBAAkB,EAAE,KAAK,iBAAiB,aAAa;AAChE;AAGO,IAAM,gBAAgB,CAAE,SAAS,aAAa,OAAO,QAAS;AAErE,IAAI,cAA4C;AAEhD,SAAS,mBAA0C;AACjD,QAAM,OAAY,EAAE,OAAO,EAAE,GAAI,eAAoB,OAAO,GAAI,iBAAsB,MAAM,EAAE;AAC9F,QAAM,UAAU,CAACD,OAAc,OAAoB,oBAAI,IAAI,MAA0B;AACnF,QAAI,KAAK,IAAIA,KAAI,EAAG,QAAO;AAC3B,SAAK,IAAIA,KAAI;AACb,UAAM,OAAOA,MAAK,MAAM,GAAG,EAAE,OAAO,CAAC,KAAU,MAAO,MAAM,IAAI,CAAC,IAAI,QAAY,IAAI;AACrF,QAAI,CAAC,KAAM,QAAO;AAClB,UAAM,QAAQ,KAAK,UAAU,KAAK;AAClC,QAAI,OAAO,UAAU,YAAY,WAAW,KAAK,KAAK,EAAG,QAAO,QAAQ,MAAM,MAAM,GAAE,EAAE,GAAG,IAAI;AAC/F,WAAO,OAAO,UAAU,WAAW,QAAQ;AAAA,EAC7C;AACA,QAAMC,OAA6B,CAAC;AACpC,gBAAc,QAAQ,QAAM;AAC1B,UAAMC,OAAM,QAAQ,4BAA4B,EAAE,EAAE;AACpD,QAAIA,KAAK,CAAAD,KAAI,EAAE,IAAIC;AAAA,EACrB,CAAC;AACD,SAAOD;AACT;AAEA,SAAS,iBAAwC;AAAE,MAAI,CAAC,YAAa,eAAc,iBAAiB;AAAG,SAAO;AAAa;AACpH,SAAS,iBAAiB,IAAgC;AAAE,SAAO,eAAe,EAAE,GAAG,YAAY,CAAC;AAAG;AACvG,SAAS,kBAAkB,IAAY,eAA+B;AAC3E,SAAO,iBAAiB,EAAE,KAAK,eAAe,EAAE,cAAc,gBAAgB,cAAc,MAAM,CAAC,KAAK,gBAAgB,aAAa;AACvI;AACO,SAAS,kBAAkB,IAAgC;AAAE,mBAAiB;AAAG,SAAO,oBAAoB,kBAAkB,EAAE,IAAI;AAAW;AAC/I,SAAS,mBAAmB,IAAY,eAA+B;AAC5E,SAAO,kBAAkB,EAAE,KAAK,iBAAiB,aAAa;AAChE;AAGA,IAAI,YAA0C;AAGvC,IAAM,aAAa;AAAA,EACxB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;AAIO,SAAS,kBAAkB,IAAoB;AACpD,SAAO,GACJ,KAAK,EACL,YAAY,EACZ,QAAQ,MAAM,KAAK,EACnB,QAAQ,eAAe,GAAG,EAC1B,QAAQ,YAAY,EAAE;AAC3B;AAEA,SAAS,iBAAwC;AAC/C,QAAM,OAAY,EAAE,OAAO,EAAE,GAAI,eAAoB,OAAO,GAAI,iBAAsB,MAAM,EAAE;AAC9F,QAAM,UAAU,CAACD,OAAc,OAAoB,oBAAI,IAAI,MAA0B;AACnF,QAAI,KAAK,IAAIA,KAAI,EAAG,QAAO;AAC3B,SAAK,IAAIA,KAAI;AACb,UAAM,OAAOA,MAAK,MAAM,GAAG,EAAE,OAAO,CAAC,KAAU,MAAO,MAAM,IAAI,CAAC,IAAI,QAAY,IAAI;AACrF,QAAI,CAAC,KAAM,QAAO;AAClB,UAAM,QAAQ,KAAK,UAAU,KAAK;AAClC,QAAI,OAAO,UAAU,YAAY,WAAW,KAAK,KAAK,EAAG,QAAO,QAAQ,MAAM,MAAM,GAAE,EAAE,GAAG,IAAI;AAC/F,WAAO,OAAO,UAAU,WAAW,QAAQ;AAAA,EAC7C;AACA,QAAMC,OAA6B,CAAC;AACpC,QAAM,UAAoB,CAAC;AAC3B,aAAW,QAAQ,QAAM;AACvB,UAAMC,OAAM,QAAQ,yBAAyB,EAAE,EAAE;AACjD,QAAIA,KAAK,CAAAD,KAAI,EAAE,IAAIC;AAAA,QAAU,SAAQ,KAAK,EAAE;AAAA,EAC9C,CAAC;AACD,MAAI,MAAuC;AACzC,QAAI,OAAO,KAAKD,IAAG,EAAE,WAAW,GAAG;AACjC,cAAQ,KAAK,kFAAkF;AAAA,IACjG,WAAW,QAAQ,QAAQ;AACzB,cAAQ,KAAK,2CAA2C,QAAQ,KAAK,IAAI,CAAC,GAAG;AAAA,IAC/E;AAAA,EACF;AACA,SAAOA;AACT;AAEA,SAAS,eAAsC;AAC7C,MAAI,CAAC,UAAW,aAAY,eAAe;AAC3C,SAAO;AACT;AAEO,SAAS,eAAe,IAAgC;AAC7D,SAAO,aAAa,EAAE,kBAAkB,EAAE,CAAC;AAC7C;AAGO,SAAS,gBAAgB,IAAY,eAA+B;AACzE,SAAO,eAAe,EAAE,KAAK,gBAAgB,aAAa;AAC5D;AA4BO,SAAS,mBACd,QACA,EAAE,UAAU,eAAe,SAAS,MAAM,IAAwB,CAAC,GAC9D;AACL,QAAME,QAAO,OAAO,IAAI,QAAM,EAAE,GAAG,EAAE,EAAE;AACvC,QAAM,gBAAgB,YAAY,WAC9BA,MAAK,IAAI,CAAC,GAAG,MAAM,gBAAgB,EAAE,IAAI,CAAC,CAAC,IAC3C,YAAY,aACVA,MAAK,IAAI,CAAC,GAAE,MAAK,kBAAkB,EAAE,IAAI,CAAC,CAAC,IAC3C,YAAY,cACVA,MAAK,IAAI,CAAC,GAAE,MAAK,kBAAkB,EAAE,IAAI,CAAC,CAAC,IAC9C,OAAO,SAAS,+BAA+B,EAAE,SAC9C,8BAA8B,IAC7B,wBAAwB,cACrB,+BAA+B,IAC/B,yBAAyB;AAErC,MAAI,QAAkB,YAAY,WAC9BA,MAAK,IAAI,CAAC,GAAG,MAAM,CAAC,IACpB,YAAY,aACVA,MAAK,IAAI,CAAC,GAAG,MAAM,CAAC,IACpB,YAAY,cACVA,MAAK,IAAI,CAAC,GAAG,MAAM,CAAC,IACxB,CAAC,GAAG,MAAM,cAAc,MAAM,EAAE,KAAK,CAAC;AAC1C,MAAI,QAAQ;AAEV,aAAS,IAAI,MAAM,SAAS,GAAG,IAAI,GAAG,KAAK;AACzC,YAAM,IAAI,KAAK,MAAM,KAAK,OAAO,KAAK,IAAI,EAAE;AAC5C,OAAC,MAAM,CAAC,GAAG,MAAM,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC,CAAC;AAAA,IAC5C;AAAA,EACF;AACA,MAAI,SAAS;AACb,EAAAA,MAAK,QAAQ,CAAC,GAAG,OAAO;AACtB,QAAI,CAAC,EAAE,OAAO;AACZ,UAAI,YAAY,UAAU;AACxB,UAAE,QAAQ,cAAc,EAAE;AAAA,MAC5B,OAAO;AACL,cAAM,MAAM,MAAM,SAAS,MAAM,MAAM;AACvC,UAAE,QAAQ,cAAc,GAAG;AAC3B;AAAA,MACF;AAAA,IACF;AAAA,EACF,CAAC;AACD,SAAOA;AACT;;;AC/cA,YAAYC,YAAW;AAqDd,gBAAAC,YAAA;AA1CT,IAAM,oBAA0B,qBAA6C,IAAI;AAC1E,IAAM,gBAAgB,MAAY,kBAAW,iBAAiB;AAU9D,IAAM,qBAAwD,CAAC;AAAA,EACpE,mBAAmB,CAAC;AAAA,EACpB;AAAA,EACA,WAAW;AAAA,EACX;AACF,MAAM;AACJ,QAAM,CAAC,cAAc,eAAe,IAAU,gBAAsB,MAAM,IAAI,IAAI,gBAAgB,CAAC;AACnG,QAAM,eAAe,qBAAqB;AAC1C,QAAM,YAAkB,eAAQ,MAAM,eAAe,IAAI,IAAI,gBAAgB,IAAI,cAAc,CAAC,cAAc,kBAAkB,YAAY,CAAC;AAE7I,QAAM,SAAe,mBAAY,CAAC,SAAsB;AACtD,QAAI,CAAC,aAAc,iBAAgB,IAAI,IAAI,IAAI,CAAC;AAChD,yCAAW,MAAM,KAAK,IAAI;AAAA,EAC5B,GAAG,CAAC,cAAc,QAAQ,CAAC;AAE3B,QAAM,MAAoC,eAAQ,OAAO;AAAA,IACvD,WAAW;AAAA,IACX,UAAU,CAAC,OAAe,UAAU,IAAI,EAAE;AAAA,IAC1C,QAAQ,CAAC,OAAe;AACtB,YAAM,OAAO,IAAI,IAAI,SAAS;AAC9B,WAAK,IAAI,EAAE,IAAI,KAAK,OAAO,EAAE,IAAI,KAAK,IAAI,EAAE;AAC5C,aAAO,IAAI;AAAA,IACb;AAAA,IACF,UAAU,CAAC,QAAgB;AAEvB,aAAO,oBAAI,IAAI,CAAC;AAAA,IAClB;AAAA,IACA,SAAS,MAAM,OAAO,oBAAI,IAAI,CAAC;AAAA,IAC/B,WAAW,CAAC,QAAQ,OAAO,IAAI,IAAI,MAAM,QAAQ,GAAG,IAAI,MAAM,MAAM,KAAK,GAAG,CAAC,CAAC;AAAA,EAChF,IAAI,CAAC,WAAW,MAAM,CAAC;AAEvB,SAAO,gBAAAA,KAAC,kBAAkB,UAAlB,EAA2B,OAAO,KAAM,UAAS;AAC3D;;;ACtDA,YAAYC,YAAW;AAmTrB,gBAAAC,YAAA;AAzQF,IAAM,iBAAuB,qBAA0C,IAAI;AACpE,IAAM,oBAAoB,MAAY,kBAAW,cAAc;AAW/D,IAAM,kBAAkD,CAAC;AAAA,EAC/D;AAAA,EACA,cAAc;AAAA,EACd,aAAa;AACd,MAAM;AACL,QAAM,WAAW,gBAAgB;AACjC,QAAM,aAAa,cAAc;AACjC,QAAM,CAAC,SAAS,UAAU,IAAU,gBAA8B,IAAI;AACtE,QAAM,YAAkB,cAEtB,oBAAI,IAAI,CAAC;AACX,QAAM,CAAC,YAAY,aAAa,IAAU,gBAAyB,CAAC,CAAC;AAErE,QAAM,iBAAuB;AAAA,IAC5B,CAAC,UAAkB,SAAqD;AACvE,gBAAU,QAAQ,IAAI,UAAU,IAAI;AAAA,IACrC;AAAA,IACA,CAAC;AAAA,EACF;AACA,QAAM,mBAAyB,mBAAY,CAAC,aAAqB;AAChE,cAAU,QAAQ,OAAO,QAAQ;AAAA,EAClC,GAAG,CAAC,CAAC;AAEL,QAAM,eAAqB;AAAA,IAC1B,CAAC,OAAe,UAAkB;AACjC,UAAI,CAAC,SAAU;AACf,YAAM,EAAE,QAAQ,OAAO,IAAI;AAC3B,UAAI,OAA4B;AAChC,UAAI,WAAW;AACf,gBAAU,QAAQ,QAAQ,CAAC,MAAM,QAAQ;AACxC,aAAK,QAAQ,CAAC,GAAG,MAAM;AACtB,gBAAM,KAAK,OAAO,EAAE,CAAC;AACrB,gBAAM,KAAK,OAAO,EAAE,CAAC;AACrB,gBAAM,KAAK,KAAK;AAChB,gBAAM,KAAK,KAAK;AAChB,gBAAM,OAAO,KAAK,KAAK,KAAK,KAAK,KAAK,EAAE;AACxC,cAAI,OAAO,UAAU;AACpB,uBAAW;AACX,mBAAO;AAAA,cACN,UAAU;AAAA,cACV,OAAO;AAAA,cACP,GAAG,EAAE;AAAA,cACL,GAAG,EAAE;AAAA,cACL,SAAS;AAAA,cACT,SAAS;AAAA,YACV;AAAA,UACD;AAAA,QACD,CAAC;AAAA,MACF,CAAC;AACD,UAAI,QAAQ,YAAY,YAAa,YAAW,IAAI;AAAA,UAC/C,YAAW,IAAI;AAAA,IACrB;AAAA,IACA,CAAC,UAAU,WAAW;AAAA,EACvB;AAEA,QAAM,QAAc,mBAAY,MAAM,WAAW,IAAI,GAAG,CAAC,CAAC;AAG1D,EAAM,iBAAU,MAAM;AACrB,QAAI,CAAC,SAAS;AACb,oBAAc,CAAC,CAAC;AAChB;AAAA,IACD;AAEA,QAAI,CAAC,SAAU;AACf,UAAM,EAAE,QAAQ,OAAO,IAAI;AAC3B,UAAM,MAAsB,CAAC;AAC7B,cAAU,QAAQ,QAAQ,CAAC,MAAM,QAAQ;AACxC,WAAK,QAAQ,CAAC,GAAG,MAAM;AACtB,cAAM,SAAS,MAAe;AAC7B,cAAI,QAAQ,aAAa,QAAQ,EAAE,aAAa;AAC/C,mBAAO,EAAE,EAAE,QAAQ,MAAM,QAAQ,EAAE,QAAQ;AAC5C,iBAAO,EAAE,MAAM,QAAQ;AAAA,QACxB,GAAG;AACH,YAAI,OAAO;AACV,cAAI,KAAK;AAAA,YACR,UAAU;AAAA,YACV,OAAO;AAAA,YACP,GAAG,EAAE;AAAA,YACL,GAAG,EAAE;AAAA,YACL,SAAS,OAAO,EAAE,CAAQ;AAAA,YAC1B,SAAS,OAAO,EAAE,CAAC;AAAA,UACpB,CAAC;AAAA,QACF;AAAA,MACD,CAAC;AAAA,IACF,CAAC;AAED,QAAI,KAAK,CAAC,GAAG,MAAM,EAAE,SAAS,cAAc,EAAE,QAAQ,CAAC;AACvD,kBAAc,GAAG;AAAA,EAClB,GAAG,CAAC,SAAS,QAAQ,CAAC;AAEtB,QAAM,qBAA2B;AAAA,IAChC,CAAC,UAAkB;AAClB,UAAI,CAAC,QAAS;AACd,YAAM,OAAO,UAAU,QAAQ,IAAI,QAAQ,QAAQ;AACnD,UAAI,CAAC,KAAM;AACX,UAAI,YAAY,QAAQ,QAAQ;AAChC,UAAI,YAAY,KAAK,aAAa,KAAK,QAAQ;AAC9C,YAAI,CAAC,WAAY;AAEjB,qBAAa,YAAY,KAAK,UAAU,KAAK;AAAA,MAC9C;AACA,YAAM,IAAI,KAAK,SAAS;AACxB,UAAI,CAAC,SAAU;AACf,YAAM,EAAE,QAAQ,OAAO,IAAI;AAC3B,iBAAW;AAAA,QACV,UAAU,QAAQ;AAAA,QAClB,OAAO;AAAA,QACP,GAAG,EAAE;AAAA,QACL,GAAG,EAAE;AAAA,QACL,SAAS,OAAO,EAAE,CAAC;AAAA,QACnB,SAAS,OAAO,EAAE,CAAC;AAAA,MACpB,CAAC;AAAA,IACF;AAAA,IACA,CAAC,SAAS,UAAU,UAAU;AAAA,EAC/B;AAEA,QAAM,qBAA2B;AAAA,IAAa,CAAC,gBAAwB;AACrE,UAAI,MAAM,MAAM,KAAK,UAAU,QAAQ,KAAK,CAAC;AAE7C,UAAI,WAAY,OAAM,IAAI,OAAO,CAAC,OAAO,CAAC,WAAW,SAAS,EAAE,CAAC;AACjE,UAAI,IAAI,WAAW,EAAG;AACtB,UAAI,CAAC,SAAS;AAEb,cAAM,QAAQ,IAAI,CAAC;AACnB,cAAM,OAAO,UAAU,QAAQ,IAAI,KAAK;AACxC,YAAI,CAAC,QAAQ,CAAC,SAAU;AACxB,cAAM,EAAE,QAAAC,SAAQ,QAAAC,QAAO,IAAI;AAC3B,cAAMC,KAAI,KAAK,CAAC;AAChB,mBAAW;AAAA,UACV,UAAU;AAAA,UACV,OAAO;AAAA,UACP,GAAGA,GAAE;AAAA,UACL,GAAGA,GAAE;AAAA,UACL,SAASF,QAAOE,GAAE,CAAC;AAAA,UACnB,SAASD,QAAOC,GAAE,CAAC;AAAA,QACpB,CAAC;AACD;AAAA,MACD;AACA,YAAM,mBAAmB,IAAI,QAAQ,QAAQ,QAAQ;AACrD,UAAI,qBAAqB,GAAI;AAC7B,UAAI,gBAAgB,mBAAmB;AACvC,UAAI,gBAAgB,KAAK,iBAAiB,IAAI,QAAQ;AACrD,YAAI,CAAC,WAAY;AACjB,yBAAiB,gBAAgB,IAAI,UAAU,IAAI;AAAA,MACpD;AACA,YAAM,eAAe,IAAI,aAAa;AACtC,YAAM,WAAW,UAAU,QAAQ,IAAI,YAAY;AACnD,UAAI,CAAC,YAAY,CAAC,SAAU;AAC5B,YAAM,MAAM,KAAK,IAAI,QAAQ,OAAO,SAAS,SAAS,CAAC;AACvD,YAAM,IAAI,SAAS,GAAG;AACtB,YAAM,EAAE,QAAQ,OAAO,IAAI;AAC3B,iBAAW;AAAA,QACV,UAAU;AAAA,QACV,OAAO;AAAA,QACP,GAAG,EAAE;AAAA,QACL,GAAG,EAAE;AAAA,QACL,SAAS,OAAO,EAAE,CAAC;AAAA,QACnB,SAAS,OAAO,EAAE,CAAC;AAAA,MACpB,CAAC;AAAA,IACF;AAAA,IACA,CAAC,SAAS,UAAU,YAAY,UAAU;AAAA,EAC3C;AACA,QAAM,kBAAwB,mBAAY,MAAM;AAE/C,QAAI,MAAM,MAAM,KAAK,UAAU,QAAQ,KAAK,CAAC;AAC7C,QAAI,WAAY,OAAM,IAAI,OAAO,CAAC,OAAO,CAAC,WAAW,SAAS,EAAE,CAAC;AACjE,QAAI,IAAI,WAAW,EAAG;AACtB,UAAM,iBAAiB,UAAU,QAAQ,WAAW,IAAI,CAAC;AACzD,UAAM,OAAO,UAAU,QAAQ,IAAI,cAAc;AACjD,QAAI,CAAC,QAAQ,KAAK,WAAW,KAAK,CAAC,SAAU;AAC7C,UAAM,IAAI,KAAK,CAAC;AAChB,UAAM,EAAE,QAAQ,OAAO,IAAI;AAC3B,eAAW;AAAA,MACV,UAAU;AAAA,MACV,OAAO;AAAA,MACP,GAAG,EAAE;AAAA,MACL,GAAG,EAAE;AAAA,MACL,SAAS,OAAO,EAAE,CAAC;AAAA,MACnB,SAAS,OAAO,EAAE,CAAC;AAAA,IACpB,CAAC;AAAA,EACF,GAAG,CAAC,SAAS,UAAU,UAAU,CAAC;AAElC,QAAM,iBAAuB,mBAAY,MAAM;AAC9C,QAAI,MAAM,MAAM,KAAK,UAAU,QAAQ,KAAK,CAAC;AAC7C,QAAI,WAAY,OAAM,IAAI,OAAO,CAAC,OAAO,CAAC,WAAW,SAAS,EAAE,CAAC;AACjE,QAAI,IAAI,WAAW,EAAG;AACtB,UAAM,iBAAiB,UAAU,QAAQ,WAAW,IAAI,CAAC;AACzD,UAAM,OAAO,UAAU,QAAQ,IAAI,cAAc;AACjD,QAAI,CAAC,QAAQ,KAAK,WAAW,KAAK,CAAC,SAAU;AAC7C,UAAM,YAAY,KAAK,SAAS;AAChC,UAAM,IAAI,KAAK,SAAS;AACxB,UAAM,EAAE,QAAQ,OAAO,IAAI;AAC3B,eAAW;AAAA,MACV,UAAU;AAAA,MACV,OAAO;AAAA,MACP,GAAG,EAAE;AAAA,MACL,GAAG,EAAE;AAAA,MACL,SAAS,OAAO,EAAE,CAAC;AAAA,MACnB,SAAS,OAAO,EAAE,CAAC;AAAA,IACpB,CAAC;AAAA,EACF,GAAG,CAAC,SAAS,UAAU,UAAU,CAAC;AAElC,QAAM,iBAAuB;AAAA,IAC5B,MAAM,mBAAmB,CAAC;AAAA,IAC1B,CAAC,kBAAkB;AAAA,EACpB;AACA,QAAM,iBAAuB;AAAA,IAC5B,MAAM,mBAAmB,EAAE;AAAA,IAC3B,CAAC,kBAAkB;AAAA,EACpB;AACA,QAAM,kBAAwB;AAAA,IAC7B,MAAM,mBAAmB,CAAC;AAAA,IAC1B,CAAC,kBAAkB;AAAA,EACpB;AACA,QAAM,kBAAwB;AAAA,IAC7B,MAAM,mBAAmB,EAAE;AAAA,IAC3B,CAAC,kBAAkB;AAAA,EACpB;AAEA,QAAM,QAAmC;AAAA,IACxC,OAAO;AAAA,MACN;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACD;AAAA,IACA;AAAA,MACC;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACD;AAAA,EACD;AAEA,SACC,gBAAAH,KAAC,eAAe,UAAf,EAAwB,OAAe,UAAS;AAEnD;;;ALpME,SAOE,OAAAI,MAPF,QAAAC,aAAA;AAlEK,IAAM,sBAA0D,CAAC;AAAA,EACvE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,iBAAiB;AAAA,EACjB,cAAc;AAAA,EACd,SAAS;AAAA,EACT;AAAA,EACA;AACD,MAAM;AA5DN,MAAAC;AA6DC,QAAM,WAAW,gBAAgB;AACjC,MAAI,CAAC,SAAU,QAAO;AACtB,QAAM,EAAE,QAAQ,OAAO,IAAI;AAC3B,QAAM,aAAa,cAAc;AACjC,QAAM,YAAWA,MAAA,yCAAY,SAAS,OAAO,QAA5B,OAAAA,MAAmC;AACpD,QAAM,QAAQ,YAAY,mBAAmB;AAC7C,MAAI,YAAY,mBAAmB,UAAU;AAC5C,WAAO;AAAA,EACR;AACA,QAAM,UAAU,kBAAkB;AAGlC,EAAM,iBAAU,MAAM;AACrB,QAAI,CAAC,QAAS;AACd,UAAM,aAAa,OAAO,KAAK,IAAI,CAAC,OAAO,EAAE,GAAG,OAAO,CAAC,GAAG,GAAG,EAAE,EAAE,EAAE;AACpE,YAAQ,eAAe,OAAO,IAAI,UAAU;AAC5C,WAAO,MAAM,QAAQ,iBAAiB,OAAO,EAAE;AAAA,EAChD,GAAG,CAAC,SAAS,OAAO,IAAI,OAAO,MAAM,MAAM,CAAC;AAC5C,QAAMC,QAAa;AAAA,IAClB,MACC;AAAA,MACC,OAAO;AAAA,MACP,CAAC,MAAM,OAAO,OAAO,CAAC,CAAC;AAAA,MACvB,CAAC,MAAM,OAAO,EAAE,CAAC;AAAA,MACjB,EAAE,OAAO;AAAA,IACV;AAAA,IACD,CAAC,OAAO,MAAM,QAAQ,QAAQ,QAAQ,MAAM;AAAA,EAC7C;AAEA,QAAM,WAAiB,eAAQ,MAAM;AACpC,QAAI,CAAC,OAAO,KAAK,OAAQ,QAAO;AAChC,UAAM,CAAC,SAAS,IAAI,OAAO,OAAO;AAClC,UAAM,MAAM,aAAkB,EAC5B,EAAE,CAAC,MAAM,OAAO,OAAO,CAAC,CAAC,CAAC,EAC1B,GAAG,MAAM,OAAO,SAAS,CAAC,EAC1B,GAAG,CAAC,MAAM,OAAO,EAAE,CAAC,CAAC;AACvB,QAAI,OAAQ,KAAI,MAAM,SAAc;AACpC,WAAO,IAAI,OAAO,IAAI,KAAK;AAAA,EAC5B,GAAG,CAAC,OAAO,MAAM,QAAQ,QAAQ,QAAQ,MAAM,CAAC;AAChD,QAAM,kBAAkB,UAAU,OAAO,WAAW;AACpD,QAAMC,SACL,OAAO,SACP,oBACC,YAAY,WACV,gBAAgB,OAAO,IAAI,WAAW,IACtC,gBAAgB,WAAW;AAC/B,QAAM,SACL,YAAY,WACT,iBAAiB,OAAO,IAAI,WAAW,IACvC,iBAAiB,WAAW;AAEhC,SACC,gBAAAH;AAAA,IAAC;AAAA;AAAA,MACA,WAAU;AAAA,MACV,eAAa,OAAO;AAAA,MACpB,SAAS,QAAQ,OAAO;AAAA,MACxB,eAAa,QAAQ,OAAO;AAAA,MAE3B;AAAA,0BACA,gBAAAD;AAAA,UAAC;AAAA;AAAA,YACA,GAAG;AAAA,YACH,MAAM,QAAQ,cAAc;AAAA,YAC5B,QAAO;AAAA,YACP,MAAK;AAAA,YACL,WAAU;AAAA;AAAA,QACX;AAAA,QAED,gBAAAA;AAAA,UAAC;AAAA;AAAA,YACA,GAAGG;AAAA,YACH,MAAK;AAAA,YACL,QAAQC;AAAA,YACR;AAAA,YACA,MAAK;AAAA;AAAA,QACN;AAAA,QACC,cACA,OAAO,KAAK,IAAI,CAAC,GAAG,OAAO;AAxI/B,cAAAF;AAyIK,gBAAM,KAAK,OAAO,OAAO,CAAC,CAAC;AAC3B,gBAAM,KAAK,OAAO,EAAE,CAAC;AACrB,gBAAM,WAAW,kBAAkB,IAAI;AACvC,gBAAM,iBACL,CAAC,UACC,mBAAmB,OAAO,gBAC1BA,MAAA,mCAAS,YAAT,gBAAAA,IAAkB,cAAa,OAAO,MACtC,QAAQ,QAAQ,UAAU;AAC7B,gBAAM,cAAc,MAAM;AACzB,gBAAI,WAAW,CAAC,OAAO;AACtB,sBAAQ,WAAW;AAAA,gBAClB,UAAU,OAAO;AAAA,gBACjB,OAAO;AAAA,gBACP,GAAG,OAAO,CAAC;AAAA,gBACX,GAAG,EAAE;AAAA,gBACL,SAAS;AAAA,gBACT,SAAS;AAAA,cACV,CAAC;AAAA,YACF;AAAA,UACD;AACA,gBAAM,cAAc,MAAM;AA7J/B,gBAAAA;AA8JM,gBACC,aACAA,MAAA,QAAQ,YAAR,gBAAAA,IAAiB,cAAa,OAAO,MACrC,QAAQ,QAAQ,UAAU;AAE1B,sBAAQ,MAAM;AAAA,UAChB;AACA,iBACC,gBAAAF;AAAA,YAAC;AAAA;AAAA,cAEA;AAAA,cACA;AAAA,cACA,GAAG,iBAAiB,IAAI;AAAA,cACxB,QACC,iBAAiB,iDAAiD;AAAA,cAEnE,aAAa,iBAAiB,IAAI;AAAA,cAClC,MACC,iBAAiB,yCAAyCI;AAAA,cAE3D,WAAU;AAAA,cACV,UAAU,QAAQ,KAAK;AAAA,cACvB,cAAY,GAAG,OAAO,SAAS,OAAO,EAAE,IAAI,OAAO,CAAC,EAAE,aAAa,CAAC,UAAU,EAAE,CAAC;AAAA,cACjF,eAAa,OAAO;AAAA,cACpB,cAAY;AAAA,cACZ,cAAc;AAAA,cACd,SAAS;AAAA,cACT,cAAc;AAAA,cACd,QAAQ;AAAA;AAAA,YAnBH;AAAA,UAoBN;AAAA,QAEF,CAAC;AAAA;AAAA;AAAA,EACH;AAEF;AAEA,IAAO,8BAAQ;;;AMlMf,YAAYC,YAAW;AAoCnB,gBAAAC,YAAA;AA7BJ,IAAM,2BACF,CAAC,EAAE,SAAS,MAAM,QAAAC,QAAO,MAAM;AACjC,QAAM,UAAU,kBAAkB;AAClC,QAAM,CAAC,SAAS,UAAU,IAAU,gBAAS,EAAE;AAC/C,QAAM,UAAgB,cAAe,EAAE;AAEvC,EAAM,iBAAU,MAAM;AACpB,QAAI,EAAC,mCAAS,SAAS;AACvB,UAAM,EAAE,SAAS,WAAW,IAAI;AAChC,QAAI;AACJ,QAAI,cAAc,WAAW,SAAS,GAAG;AAEvC,YAAM,QAAQ,WAAW,IAAI,OAAK,GAAG,EAAE,QAAQ,IAAI,EAAE,CAAC,EAAE,EAAE,KAAK,IAAI;AACvE,YAAM,SAAS,QAAQ,aAAa,OAAO,QAAQ,EAAE,aAAa,IAAI,OAAO,QAAQ,CAAC;AACtF,YAAM,GAAG,MAAM,WAAM,KAAK;AAAA,IACxB,OAAO;AACL,YAAMA,UAASA,QAAO,EAAE,UAAU,QAAQ,UAAU,GAAG,QAAQ,GAAG,GAAG,QAAQ,GAAG,OAAO,QAAQ,MAAM,CAAC,IAClG,iBAAiB,QAAQ,UAAU,QAAQ,GAAG,QAAQ,GAAG,QAAQ,KAAK;AAAA,IAC5E;AACA,QAAI,QAAQ,QAAQ,SAAS;AAC3B,cAAQ,UAAU;AAElB,iBAAW,EAAE;AACb,YAAM,UAAU,WAAW,MAAM,WAAW,GAAG,GAAG,EAAE;AACpD,aAAO,MAAM,aAAa,OAAO;AAAA,IACnC;AAAA,EACF,GAAG,CAAC,mCAAS,SAASA,OAAM,CAAC;AAE7B,SACE,gBAAAD;AAAA,IAAC;AAAA;AAAA,MACC,aAAW,SAAS,WAAW;AAAA,MAC/B,eAAY;AAAA,MACZ,OAAO,EAAE,UAAU,YAAY,OAAO,GAAG,QAAQ,GAAG,QAAQ,IAAI,SAAS,GAAG,UAAU,UAAU,MAAM,iBAAiB,QAAQ,EAAE;AAAA,MAEhI;AAAA;AAAA,EACH;AAEJ;AAEA,SAAS,iBAAiB,UAAkBE,IAA2BC,IAAW,OAAe;AAC/F,QAAM,SAASD,cAAa,OAAOA,GAAE,aAAa,IAAI,OAAOA,EAAC;AAC9D,SAAO,UAAU,QAAQ,WAAW,QAAQ,CAAC,KAAK,MAAM,WAAWC,EAAC;AACtE;AAEA,IAAO,mCAAQ;;;ACtBb,gBAAAC,OAcU,QAAAC,aAdV;AAvBK,IAAM,iBAA2B,MAAM;AAC5C,QAAM,UAAU,kBAAkB;AAClC,QAAM,QAAQ,gBAAgB;AAC9B,MAAI,CAAC,WAAW,CAAC,SAAS,CAAC,QAAQ,QAAS,QAAO;AACnD,QAAM,EAAE,SAAS,WAAW,IAAI;AAChC,QAAM,EAAE,YAAY,YAAY,IAAI;AACpC,QAAM,SAAS,KAAK,IAAI,KAAK,IAAI,QAAQ,SAAS,CAAC,GAAG,UAAU;AAChE,QAAM,SAAS,KAAK,IAAI,KAAK,IAAI,QAAQ,SAAS,CAAC,GAAG,WAAW;AACjE,QAAM,MAAM,SAAS;AACrB,QAAM,MAAM,SAAS;AACrB,QAAM,QAAQ,WAAW,SAAS;AAClC,QAAM,YAAY,QAAQ,aAAa,OAAO,QAAQ,EAAE,aAAa,IAAI,OAAO,QAAQ,CAAC;AACzF,QAAM,QAAQ,QAAQ,YAAY,GAAG,SAAS,WAAM,QAAQ,CAAC;AAG7D,QAAM,WAAW,OAAO,KAAK,QAAQ,YAAY,EAAE;AACnD,QAAM,YAAY,WAAW,SAAS,SAAS,CAAC,GAAG,EAAE,IAAI,IAAI;AAC7D,QAAM,cAAc,gBAAgB,aAAY,IAAI,YAAY,CAAC,KAAK;AAEtE,QAAM,cAAc;AACpB,SACE,gBAAAA,MAAC,OAAE,WAAU,qBAAoB,eAAc,QAEjD;AAAA,oBAAAD,MAAC,YAAO,IAAI,QAAQ,IAAI,QAAQ,GAAG,GAAG,MAAK,QAAO,QAAQ,aAAa,aAAa,GAAG;AAAA,IAEvF,gBAAAA,MAAC,YAAO,IAAI,QAAQ,IAAI,QAAQ,GAAG,GAAG,MAAK,QAAO,QAAQ,aAAa,aAAa,KAAK;AAAA,IAEzF,gBAAAA,MAAC,YAAO,IAAI,QAAQ,IAAI,QAAQ,GAAG,KAAK,MAAM,aAAa,QAAO,QAAO,aAAa,KAAK;AAAA,IACtF,SACE,MAAM;AACL,YAAM,aAAa;AACnB,YAAM,OAAO,WAAW,IAAI,OAAK,GAAG,EAAE,QAAQ,KAAK,EAAE,CAAC,EAAE;AACxD,YAAM,UAAU,CAAC,OAAO,GAAG,IAAI;AAC/B,YAAM,WAAW,QAAQ,OAAO,CAAC,GAAE,MAAI,KAAK,IAAI,GAAE,EAAE,MAAM,GAAE,CAAC;AAC7D,YAAM,QAAQ,KAAK,IAAI,IAAI,WAAW,MAAM,EAAE;AAC9C,YAAM,SAAS,aAAa,QAAQ,SAAS;AAC7C,aACE,gBAAAC,MAAC,OACC;AAAA,wBAAAD,MAAC,UAAK,GAAG,KAAK,GAAG,MAAM,QAAQ,IAAI,GAAG,IAAI,GAAG,OAAc,QAAgB,MAAK,WAAU,SAAS,MAAM;AAAA,QACxG,QAAQ,IAAI,CAAC,GAAE,MACd,gBAAAA,MAAC,UAAa,GAAG,MAAM,GAAG,GAAG,MAAM,SAAS,IAAI,cAAY,IAAE,MAAM,MAAK,QAAO,UAAU,IAAK,eAApF,CAAsF,CAClG;AAAA,SACH;AAAA,IAEJ,GAAG,IAEH,gBAAAC,MAAC,OACC;AAAA,sBAAAD,MAAC,UAAK,GAAG,KAAK,GAAG,MAAM,IAAI,IAAI,GAAG,IAAI,GAAG,OAAO,KAAK,IAAI,IAAI,MAAM,SAAS,GAAG,GAAG,QAAQ,IAAI,MAAK,WAAU,SAAS,MAAM;AAAA,MAC5H,gBAAAA,MAAC,UAAK,GAAG,MAAM,GAAG,GAAG,MAAM,GAAG,MAAK,QAAO,UAAU,IAAK,iBAAM;AAAA,OACjE;AAAA,KAEJ;AAEJ;AAEA,IAAO,yBAAQ;;;ArFyEC,SACE,OAAAE,OADF,QAAAC,aAAA;AA3EhB,IAAM,oBAAgH,CAAC;AAAA,EACrH;AAAA,EACA;AAAA,EACA,YAAY;AAAA,EACZ,aAAa;AAAA,EACb,kBAAkB;AAAA,EAClB,UAAU;AAAA,EACV;AAAA,EACA;AAAA,EACA;AAAA,EACA,oBAAoB;AAAA,EACpB,gBAAgB;AAAA,EAChB,qBAAqB;AAAA,EACrB,aAAa;AAAA,EACb,gBAAgB;AAAA,EAChB,cAAc;AAAA,EACd,iBAAiB;AAAA,EACjB,2BAA2B;AAAA,EAC3B,cAAc;AAAA,EACd,SAAS;AAAA,EACT,gBAAgB;AAAA,EAChB;AACF,MAAM;AAEJ,QAAM,cAAc,gBAAgB;AACpC,QAAM,OAAO,gBAAiB,eAAuB,mBAAmB,EAAE,QAAQ,IAAI,MAAM,IAAI,OAAO,IAAI,KAAK,GAAG,CAAC;AACpH,QAAM,WAAW,gBAAgB;AACjC,QAAM,aAAa,cAAc;AACjC,QAAM,gBAAsB,gBAAQ,MAAM;AACxC,QAAI,CAAC,WAAY,QAAO;AACxB,WAAO,OAAO,OAAO,OAAK,CAAC,WAAW,SAAS,EAAE,EAAE,CAAC;AAAA,EACtD,GAAG,CAAC,QAAQ,UAAU,CAAC;AACvB,QAAM,UAAgB,gBAAQ,MAAM;AAClC,QAAI,4BAA4B,WAAY,QAAO,cAAc,QAAQ,OAAK,EAAE,IAAI;AACpF,WAAO,OAAO,QAAQ,OAAK,EAAE,IAAI;AAAA,EACnC,GAAG,CAAC,QAAQ,eAAe,0BAA0B,UAAU,CAAC;AAChE,QAAM,SAAe,oBAAY,CAAC,MAAkB,EAAE,aAAa,OAAO,EAAE,IAAI,IAAI,KAAK,EAAE,CAAC,GAAI,CAAC,CAAC;AAClG,QAAM,SAAS,WAAW,SAAS,SAAe,gBAAQ,MAAM;AAC9D,QAAI,CAAC,WAAY,QAAO,iBAAiB,SAAS,QAAQ,CAAC,GAAG,KAAK,UAAU,CAAC;AAE9E,UAAM,QAAQ,QAAQ,IAAI,OAAK,OAAO,CAAC,EAAE,QAAQ,CAAC,EAAE,KAAK,CAAC,GAAE,MAAI,IAAE,CAAC;AACnE,QAAI,MAAM,WAAW,EAAG,QAAO,iBAAiB,SAAS,QAAQ,CAAC,GAAG,KAAK,UAAU,CAAC;AACrF,QAAI;AACJ,QAAI,MAAM,WAAW,GAAG;AACtB,aAAO,KAAK,OAAO;AAAA,IACrB,OAAO;AAEL,YAAM,QAAQ,CAAC;AACf,eAAS,IAAE,GAAE,IAAE,MAAM,QAAO,IAAK,OAAM,KAAK,MAAM,CAAC,IAAE,MAAM,IAAE,CAAC,CAAC;AAC/D,YAAM,KAAK,CAAC,GAAE,MAAI,IAAE,CAAC;AACrB,aAAO,MAAM,KAAK,MAAM,MAAM,SAAO,CAAC,CAAC,MAAM,MAAM,MAAM,SAAO,CAAC,IAAE,MAAM,CAAC,MAAI,MAAM,SAAO;AAAA,IAC7F;AACA,UAAMC,OAAM,OAAK;AACjB,UAAM,SAAuB,CAAC,IAAI,KAAK,MAAM,CAAC,IAAEA,IAAG,GAAG,IAAI,KAAK,MAAM,MAAM,SAAO,CAAC,IAAEA,IAAG,CAAC;AACzF,WAAO,KAAU,EAAE,OAAO,MAAM,EAAE,MAAM,CAAC,GAAG,KAAK,UAAU,CAAC;AAAA,EAC9D,GAAG,CAAC,SAAS,QAAQ,KAAK,YAAY,UAAU,CAAC;AACjD,QAAM,SAAS,WAAW,SAAS,SAAe,gBAAQ,MAAM,mBAAmB,SAAS,OAAK,EAAE,GAAG,CAAC,KAAK,aAAa,CAAC,CAAC,GAAG,CAAC,SAAS,KAAK,WAAW,CAAC;AACzJ,QAAM,aAAa,kBAAkB,CAAC,MAAY,EAAE,mBAAmB,QAAU,EAAE,OAAM,SAAS,KAAI,UAAS,CAAC;AAChH,QAAM,yBAAuC,gBAAQ,MAAM;AACzD,QAAI,eAAe,YAAY,OAAQ,QAAO,YAAY,IAAI,OAAK,aAAa,OAAO,IAAI,IAAI,KAAK,CAAC,CAAC;AACtG,QAAI,CAAC,kBAAmB,QAAO,CAAC;AAChC,UAAM,MAAM,oBAAI,IAAY;AAC5B,eAAW,KAAK,QAAS,KAAI,IAAI,OAAO,CAAC,EAAE,QAAQ,CAAC;AACpD,WAAO,MAAM,KAAK,GAAG,EAAE,KAAK,CAAC,GAAE,MAAI,IAAE,CAAC,EAAE,IAAI,QAAM,IAAI,KAAK,EAAE,CAAC;AAAA,EAChE,GAAG,CAAC,aAAa,mBAAmB,SAAS,MAAM,CAAC;AACpD,QAAM,cAAc,mBAAmB,CAAC,MAAc,OAAO,CAAC;AAC9D,QAAM,cAAoB,gBAAQ,MAAM,OAAO,IAAI,OAAK,iBAAiB,EAAE,EAAE,EAAE,GAAG,CAAC,MAAM,CAAC;AAC1F,QAAM,aACJ,gBAAAF,MAAC,SAAI,OAAO,KAAK,OAAO,QAAQ,KAAK,QAAQ,MAAK,OAChD,0BAAAC,MAAC,OAAE,WAAW,aAAa,KAAK,OAAO,IAAI,IAAI,KAAK,OAAO,GAAG,KAC3D;AAAA,qBACC,gBAAAD,MAAC,UACE,iBAAO,IAAI,CAAC,GAAG,MAAM;AACpB,YAAM,YAAY,EAAE,UAAU,YAAY,WAAW,gBAAgB,EAAE,IAAI,CAAC,IAAI,gBAAgB,CAAC;AACjG,aACE,gBAAAC,MAAC,oBAA0B,IAAI,YAAY,CAAC,GAAG,IAAG,MAAK,IAAG,MAAK,IAAG,MAAK,IAAG,QACxE;AAAA,wBAAAD,MAAC,UAAK,QAAO,MAAK,WAAW,WAAW,aAAa,MAAM;AAAA,QAC3D,gBAAAA,MAAC,UAAK,QAAO,QAAO,WAAW,WAAW,aAAa,GAAG;AAAA,WAFvC,EAAE,EAGvB;AAAA,IAEJ,CAAC,GACH;AAAA,IAEF,gBAAAA,MAAC,gBAAK,MAAK,KAAI,YAAY,YAAY,YAAY,uBAAuB,SAAS,yBAAyB,QAAW;AAAA,IACvH,gBAAAA,MAAC,gBAAK,MAAK,KAAI,YAAY,aAAa,OAAO,QAAQ;AAAA,IACvD,gBAAAA,MAAC,qBAAU,MAAK,KAAI;AAAA,IACzB,OAAO,IAAI,CAAC,GAAG,OACR,gBAAAA;AAAA,MAAC;AAAA;AAAA,QAEC,QAAQ;AAAA,QACR,aAAa;AAAA,QACb;AAAA,QACA;AAAA,QACA;AAAA,QACA,YAAY;AAAA,QACZ;AAAA,QACN;AAAA,QACA;AAAA,QACA;AAAA,QACA,gBAAgB,gBAAgB,YAAY,EAAE,IAAI;AAAA;AAAA,MAXvC,EAAE;AAAA,IAYT,CACD;AAAA,IACA,sBAAsB,gBAAAA,MAAC,0BAAe;AAAA,KACzC,GACF;AAGF,QAAM,qBAA8D,CAAC,EAAE,SAAS,MAAM;AACpF,UAAM,IAAI,kBAAkB;AAC5B,UAAM,YAAkB,oBAAY,CAAC,MAA2B;AAC9D,UAAI,CAAC,EAAG;AACR,cAAQ,EAAE,KAAK;AAAA,QACb,KAAK;AAAc,YAAE,eAAe;AAAG,YAAE,eAAe;AAAG;AAAA,QAC3D,KAAK;AAAa,YAAE,eAAe;AAAG,YAAE,eAAe;AAAG;AAAA,QAC1D,KAAK;AAAa,YAAE,gBAAgB;AAAG,YAAE,eAAe;AAAG;AAAA,QAC3D,KAAK;AAAW,YAAE,gBAAgB;AAAG,YAAE,eAAe;AAAG;AAAA,QACzD,KAAK;AAAQ,YAAE,gBAAgB;AAAG,YAAE,eAAe;AAAG;AAAA,QACtD,KAAK;AAAO,YAAE,eAAe;AAAG,YAAE,eAAe;AAAG;AAAA,QACpD,KAAK;AAAU,YAAE,MAAM;AAAG,YAAE,eAAe;AAAG;AAAA,QAC9C;AAAS;AAAA,MACX;AAAA,IACF,GAAG,CAAC,CAAC,CAAC;AACN,WACE,gBAAAA,MAAC,SAAI,WAAU,kBAAiB,MAAK,SAAQ,cAAY,WAAW,UAAU,GAAG,WAC9E,UACH;AAAA,EAEJ;AAEA,QAAM,OACJ,gBAAAA,MAAC,mBAAgB,YAAY,eAC1B,wBACC,gBAAAC,MAAC,sBACE;AAAA;AAAA,IACA,iBAAiB,gBAAAD,MAAC,oCAAyB;AAAA,KAC9C,IAEA,gBAAAC,MAAC,SAAI,WAAU,kBAAiB,MAAK,SAAQ,cAAY,WACtD;AAAA;AAAA,IACA,iBAAiB,gBAAAD,MAAC,oCAAyB;AAAA,KAC9C,GAEJ;AAEF,MAAI,SAAU,QAAO;AAErB,QAAM,QAAQ;AAAA,IACZ;AAAA,IACA;AAAA,IACA,WAAW,CAAC,IAAI,MAAM,OAAO,MAAM,CAAC;AAAA,IACpC,WAAW,CAAC,IAAI,MAAM,OAAO,MAAM,CAAC;AAAA,EACtC;AACA,SAAO,gBAAAA,MAAC,qBAAa,UAAb,EAAsB,OAAe,gBAAK;AACpD;AAEO,IAAM,YAAsC,CAAC,UAAU;AAtN9D,MAAAG;AAuNE,QAAM,MAAM,gBAAgB;AAC5B,QAAM,UAAU,gBAAAH,MAAC,qBAAmB,GAAG,OAAO,cAAc,KAAY;AACxE,MAAI,KAAK;AAEP,WAAO,gBAAgB,IAAI,UACzB,gBAAAA,MAAC,sBAAmB,QAAQ,MAAM,QAAQ,YAAY,IAAI,YAAY,aAAa,IAAI,aACpF,mBACH;AAAA,EAEJ;AAEA,QAAM,YAAa,MAAc;AACjC,SACE,gBAAAA,MAAC,aAAU,SAASG,MAAA,MAAc,WAAd,OAAAA,MAAwB,KAAK,WAAsB,QAAQ,EAAE,QAAQ,IAAI,MAAM,IAAI,OAAO,IAAI,KAAK,GAAG,GAE5H,0BAAAH,MAAC,qBAAmB,GAAG,OAAO,GAC5B;AAEJ;AAEA,IAAO,oBAAQ;;;AsF1Of,wBAAuB;AADvB,SAAgB,YAAAI,WAAU,eAAAC,cAAa,UAAAC,SAAQ,YAAY,2BAA2B;AA0IlF,SAME,OAAAC,OANF,QAAAC,aAAA;AAzHG,IAAM,OAAO,WAAkC,CAAC;AAAA,EACrD;AAAA,EACA;AAAA,EACA,WAAW;AAAA,EACX;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,eAAe;AAAA,EACf;AAAA,EACA;AAAA,EACA,eAAe;AAAA,EACf,GAAG;AACL,GAAG,QAAQ;AAET,QAAM,eAAe,wBAAwB;AAG7C,QAAM,CAAC,mBAAmB,oBAAoB,IAAIC,UAAoB,MAAM;AAnC9E,QAAAC;AAoCI,WAAO,sBAAoBA,MAAA,MAAM,CAAC,MAAP,gBAAAA,IAAU,OAAM;AAAA,EAC7C,CAAC;AAGD,QAAM,YAAY,eAAe,sBAAsB;AAGvD,QAAM,aAAaC,QAAuB,IAAI;AAC9C,QAAM,UAAUA,QAA0C,oBAAI,IAAI,CAAC;AAGnE,QAAM,iBAAiBC,aAAY,CAAC,UAAqB;AACvD,QAAI,CAAC,cAAc;AACjB,2BAAqB,KAAK;AAAA,IAC5B;AACA,+CAAc;AAAA,EAChB,GAAG,CAAC,cAAc,WAAW,CAAC;AAG9B,QAAM,iBAAiBA,aAAY,CAAC,UAAqB;AACvD,6CAAa;AACb,QAAI,cAAc;AAChB,qBAAe,KAAK;AAAA,IACtB;AAAA,EACF,GAAG,CAAC,YAAY,cAAc,cAAc,CAAC;AAG7C,QAAM,gBAAgBA,aAAY,CAAC,OAA4B,UAAqB;AAClF,UAAM,SAAS,MAAM,OAAO,CAAC,SAAkB,CAAC,KAAK,QAAQ,EAAE,IAAI,CAAC,SAAkB,KAAK,EAAE;AAC7F,UAAM,eAAe,OAAO,QAAQ,KAAK;AAEzC,QAAI,WAA0B;AAE9B,YAAQ,MAAM,KAAK;AAAA,MACjB,KAAK;AACH,mBAAW,eAAe,IAAI,eAAe,IAAI,OAAO,SAAS;AACjE;AAAA,MACF,KAAK;AACH,mBAAW,eAAe,OAAO,SAAS,IAAI,eAAe,IAAI;AACjE;AAAA,MACF,KAAK;AACH,mBAAW;AACX;AAAA,MACF,KAAK;AACH,mBAAW,OAAO,SAAS;AAC3B;AAAA,MACF,KAAK;AACH,cAAM,eAAe;AACrB;AACA;AAAA,MACF;AACE;AAAA,IACJ;AAEA,QAAI,aAAa,MAAM;AACrB,YAAM,eAAe;AACrB,YAAM,WAAW,OAAO,QAAQ;AAChC,YAAM,YAAY,QAAQ,QAAQ,IAAI,QAAQ;AAC9C,UAAI,WAAW;AACb,kBAAU,MAAM;AAChB,uBAAe,QAAQ;AAAA,MACzB;AAAA,IACF;AAAA,EACF,GAAG,CAAC,OAAO,gBAAgB,QAAQ,CAAC;AAGpC,QAAM,YAAYA,aAAY,CAAC,OAAkB,YAAsC;AACrF,QAAI,SAAS;AACX,cAAQ,QAAQ,IAAI,OAAO,OAAO;AAAA,IACpC,OAAO;AACL,cAAQ,QAAQ,OAAO,KAAK;AAAA,IAC9B;AAAA,EACF,GAAG,CAAC,CAAC;AAGL,QAAM,WAAWA,aAAY,CAAC,UAAqB;AACjD,UAAM,SAAS,QAAQ,QAAQ,IAAI,KAAK;AACxC,QAAI,QAAQ;AACV,aAAO,MAAM;AAAA,IACf;AAAA,EACF,GAAG,CAAC,CAAC;AAGL,sBAAoB,KAAK,OAAO;AAAA,IAC9B;AAAA,IACA,cAAc,MAAM;AAAA,IACpB,mBAAmB,MAAM,WAAW;AAAA,EACtC,IAAI,CAAC,UAAU,SAAS,CAAC;AAGzB,QAAM,oBAAoBA,aAAY,CAAC,UAA4B;AA9HrE,QAAAF;AAgII,UAAM,gBAAgB,MAAM;AAC5B,QAAI,GAACA,MAAA,WAAW,YAAX,gBAAAA,IAAoB,SAAS,iBAAgB;AAChD;AAAA,IACF;AAAA,EACF,GAAG,CAAC,aAAa,CAAC;AAGlB,QAAM,kBAAc,kBAAAG,SAAW,cAAc,SAAS;AAEtD,SACE,gBAAAL;AAAA,IAAC;AAAA;AAAA,MACC,WAAW;AAAA,MACX;AAAA,MACA,eAAa;AAAA,MACZ,GAAG;AAAA,MAEJ;AAAA,wBAAAD,MAAC,QAAG,WAAU,qBAAoB,sBAAQ;AAAA,QAE1C,gBAAAA;AAAA,UAAC;AAAA;AAAA,YACC,WAAU;AAAA,YACV,KAAK;AAAA,YAEL,0BAAAA;AAAA,cAAC;AAAA;AAAA,gBACC,WAAU;AAAA,gBACV,MAAK;AAAA,gBACL,QAAQ;AAAA,gBAEP,gBAAM,IAAI,CAAC,SAAkB;AAC5B,wBAAM,WAAW,KAAK,OAAO;AAC7B,wBAAM,aAAa,KAAK;AAExB,wBAAM,iBAAa,kBAAAM,SAAW,yBAAyB;AAAA,oBACrD,mCAAmC;AAAA,oBACnC,mCAAmC;AAAA,kBACrC,CAAC;AAED,yBACE,gBAAAN,MAAC,QAAiB,WAAW,YAAY,MAAK,gBAC5C,0BAAAA;AAAA,oBAAC;AAAA;AAAA,sBACC,KAAK,CAAC,YAAY,UAAU,KAAK,IAAI,OAAO;AAAA,sBAC5C,WAAU;AAAA,sBACV,MAAK;AAAA,sBACL,iBAAe;AAAA,sBACf,iBAAe,GAAG,KAAK,EAAE;AAAA,sBACzB,IAAI,GAAG,KAAK,EAAE;AAAA,sBACd,UAAU,WAAW,IAAI;AAAA,sBACzB,UAAU;AAAA,sBACV,SAAS,MAAM,CAAC,cAAc,eAAe,KAAK,EAAE;AAAA,sBACpD,WAAW,CAAC,UAAU,CAAC,cAAc,cAAc,OAAO,KAAK,EAAE;AAAA,sBACjE,SAAS,MAAM,CAAC,cAAc,eAAe,KAAK,EAAE;AAAA,sBACnD,GAAG,KAAK;AAAA,sBAER,eAAK;AAAA;AAAA,kBACR,KAhBO,KAAK,EAiBd;AAAA,gBAEJ,CAAC;AAAA;AAAA,YACH;AAAA;AAAA,QACF;AAAA,QAEC,MAAM,IAAI,CAAC,SAAkB;AAC5B,gBAAM,WAAW,KAAK,OAAO;AAE7B,iBACE,gBAAAA;AAAA,YAAC;AAAA;AAAA,cAEC,WAAU;AAAA,cACV,MAAK;AAAA,cACL,mBAAiB,GAAG,KAAK,EAAE;AAAA,cAC3B,IAAI,GAAG,KAAK,EAAE;AAAA,cACd,QAAQ,CAAC;AAAA,cAER,eAAK;AAAA;AAAA,YAPD,KAAK;AAAA,UAQZ;AAAA,QAEJ,CAAC;AAAA;AAAA;AAAA,EACH;AAEJ,CAAC;;;AC9MD,YAAYO,aAAW;;;ACoBhB,SAAS,eAAe,OAAgD;AAC7E,QAAM,UAAU,MAAM,WAAW;AACjC,QAAM,OAAO,MAAM,QAAQ;AAC3B,QAAM,YAAY,CAAC,CAAC,MAAM;AAC1B,QAAM,UAAU;AAAA,IACd;AAAA,IACA,oBAAoB,OAAO;AAAA,IAC3B,SAAS,YAAY,oBAAoB,IAAI,KAAK;AAAA,IAClD,YAAY,gCAAgC;AAAA,IAC5C,MAAM,aAAa;AAAA,EACrB,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG;AAE1B,QAAM,MAAM,MAAM,OAAO,MAAM;AAC/B,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA,MAAM,EAAE,QAAQ,aAAa;AAAA,IAC7B,OAAO,MAAM,OAAO,EAAE,MAAM,MAAM,MAAM,MAAM,SAAS,IAAI,EAAE,MAAM,SAAS;AAAA,IAC5E,oBAAoB,CAAC,CAAC,MAAM;AAAA,EAC9B;AACF;;;AD4LG,gBAAAC,aAAA;AAnOH,IAAM,EAAE,YAAAC,aAAY,aAAAC,cAAa,UAAAC,UAAS,IAAIC;AAmH9C,SAAS,gBACR,OACA,KACqB;AACrB,QAAM;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA,YAAY;AAAA,IACZ,YAAY;AAAA,IACZ,qBAAqB;AAAA,IACrB,GAAG;AAAA,EACJ,IAAI;AAGJ,QAAM,CAAC,WAAW,YAAY,IAAID,UAAS,KAAK;AAChD,QAAM,CAAC,WAAW,YAAY,IAAIA,UAAS,KAAK;AAChD,QAAM,CAAC,WAAW,YAAY,IAAIA,UAAS,KAAK;AAGhD,QAAM,QAAQ,eAAe;AAAA,IAC5B;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,MAAM,UAAU,OAAQ,KAAa,OAAO;AAAA,EAC7C,CAAC;AAGD,QAAM,aACL,cAAc,OAAO,KAAK,WAAW,KAAK,eAAe,MAAM;AAChE,QAAM,iBAAiB;AAAA,IACtB,GAAI,aAAa,EAAE,gBAAgB,OAAO;AAAA,IAC1C,GAAI,aAAa,EAAE,gBAAgB,OAAO;AAAA,IAC1C,GAAI,aAAa,EAAE,gBAAgB,OAAO;AAAA,IAC1C,GAAI,cAAc,EAAE,iBAAiB,OAAO;AAAA,EAC7C;AAGA,QAAM,kBAAkBD;AAAA,IACvB,MAAM,CAAC,cAAc,aAAa,IAAI;AAAA,IACtC,CAAC,UAAU;AAAA,EACZ;AACA,QAAM,gBAAgBA,aAAY,MAAM,aAAa,KAAK,GAAG,CAAC,CAAC;AAC/D,QAAM,mBAAmBA;AAAA,IACxB,MAAM,CAAC,cAAc,aAAa,IAAI;AAAA,IACtC,CAAC,UAAU;AAAA,EACZ;AACA,QAAM,mBAAmBA,aAAY,MAAM;AAC1C,iBAAa,KAAK;AAClB,iBAAa,KAAK;AAAA,EACnB,GAAG,CAAC,CAAC;AACL,QAAM,cAAcA,aAAY,MAAM,aAAa,IAAI,GAAG,CAAC,CAAC;AAC5D,QAAM,aAAaA,aAAY,MAAM,aAAa,KAAK,GAAG,CAAC,CAAC;AAG5D,QAAM,gBAAgBA;AAAA,IACrB,CAAC,UAA4C;AAE5C,UACC,MAAM,QAAQ,QACb,UAAU,QACV,MAAM,cAAc,aAAa,MAAM,MAAM,WAC7C;AACD,cAAM,eAAe;AACrB,QAAC,MAAM,cAA8B,MAAM;AAAA,MAC5C;AAAA,IACD;AAAA,IACA,CAAC,IAAI;AAAA,EACN;AAGA,QAAM,cAAcA;AAAA,IACnB,CAAC,UAAyC;AAEzC,UAAI,oBAAoB;AACvB,cAAM,SAAS,MAAM;AACrB,cAAM,sBACL,OAAO,aAAa,iBAAiB,MAAM;AAE5C,YAAI,qBAAqB;AACxB,gBAAM,eAAe;AACrB;AAAA,QACD;AAGA,eAAO,aAAa,mBAAmB,MAAM;AAG7C,mBAAW,MAAM;AAChB,iBAAO,gBAAgB,iBAAiB;AAAA,QACzC,GAAG,GAAI;AAAA,MACR;AAAA,IACD;AAAA,IACA,CAAC,kBAAkB;AAAA,EACpB;AAGA,MAAI,UAAU,QAAQ,KAAK,MAAM;AAChC,UAAM;AAAA,MACL,IAAAG;AAAA,MACA,OAAAC;AAAA,MACA,OAAAC;AAAA,MACA,CAAC,YAAY,GAAGC;AAAA,MAChB,CAAC,kBAAkB,GAAGC;AAAA,MACtB,CAAC,iBAAiB,GAAGC;AAAA,MACrB,UAAAC;AAAA,MACA,GAAG;AAAA,IACJ,IAAI;AACJ,UAAM,cAAc;AACpB,WACC,gBAAAX;AAAA,MAAC;AAAA;AAAA,QACA;AAAA,QACA,MAAM,YAAY;AAAA,QAClB,QAAQ,YAAY;AAAA,QACpB,KAAK,YAAY;AAAA,QACjB,WAAW,MAAM;AAAA,QACjB,MAAK;AAAA,QACL,WAAU;AAAA,QACV,eAAY;AAAA,QACX,GAAG;AAAA,QACH,GAAI,sBAAsB,EAAE,6BAA6B,OAAO;AAAA,QAChE,GAAG;AAAA,QACJ,WAAW,CAAC,UAAU;AAhP1B,cAAAY;AAiPK,WAAAA,MAAA,YAAY,cAAZ,gBAAAA,IAAA,kBAAwB;AACxB,wBAAc,KAAK;AAAA,QACpB;AAAA,QACA,SAAS,CAAC,UAAU;AApPxB,cAAAA;AAqPK,WAAAA,MAAA,YAAY,YAAZ,gBAAAA,IAAA,kBAAsB;AACtB,sBAAY,KAAK;AAAA,QAClB;AAAA,QACA,aAAa,CAAC,UAAU;AAxP5B,cAAAA;AAyPK,WAAAA,MAAA,YAAY,gBAAZ,gBAAAA,IAAA,kBAA0B;AAC1B,0BAAgB;AAAA,QACjB;AAAA,QACA,WAAW,CAAC,UAAU;AA5P1B,cAAAA;AA6PK,WAAAA,MAAA,YAAY,cAAZ,gBAAAA,IAAA,kBAAwB;AACxB,wBAAc;AAAA,QACf;AAAA,QACA,cAAc,CAAC,UAAU;AAhQ7B,cAAAA;AAiQK,WAAAA,MAAA,YAAY,iBAAZ,gBAAAA,IAAA,kBAA2B;AAC3B,2BAAiB;AAAA,QAClB;AAAA,QACA,cAAc,CAAC,UAAU;AApQ7B,cAAAA;AAqQK,WAAAA,MAAA,YAAY,iBAAZ,gBAAAA,IAAA,kBAA2B;AAC3B,2BAAiB;AAAA,QAClB;AAAA,QACA,SAAS,CAAC,UAAU;AAxQxB,cAAAA;AAyQK,WAAAA,MAAA,YAAY,YAAZ,gBAAAA,IAAA,kBAAsB;AACtB,sBAAY;AAAA,QACb;AAAA,QACA,QAAQ,CAAC,UAAU;AA5QvB,cAAAA;AA6QK,WAAAA,MAAA,YAAY,WAAZ,gBAAAA,IAAA,kBAAqB;AACrB,qBAAW;AAAA,QACZ;AAAA,QAEA,iBAAe,YAAY,eAAe;AAAA,QACzC,GAAI,YAAY,eAAe,MAAM,UAAU,EAAE,UAAU,GAAG;AAAA,QAE/D,IAAIP;AAAA,QACJ,OAAOC;AAAA,QACP,OAAOC;AAAA,QACP,cAAYC;AAAA,QACZ,oBAAkBC;AAAA,QAClB,mBAAiBC;AAAA,QACjB,UAAUC;AAAA,QAET;AAAA;AAAA,IACF;AAAA,EAEF;AAGA,QAAM;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA,CAAC,YAAY,GAAG;AAAA,IAChB,CAAC,kBAAkB,GAAG;AAAA,IACtB,CAAC,iBAAiB,GAAG;AAAA,IACrB;AAAA,IACA;AAAA,IACA,OAAO;AAAA,IACP;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,GAAG;AAAA,EACJ,IAAI;AACJ,QAAM,cAAc;AACpB,SACC,gBAAAX;AAAA,IAAC;AAAA;AAAA,MACA;AAAA,MACA,MAAM,YAAY,QAAQ;AAAA,MAC1B,UAAU,YAAY;AAAA,MACtB,WAAW,MAAM;AAAA,MACjB,eAAY;AAAA,MACX,GAAG;AAAA,MACH,GAAI,sBAAsB,EAAE,6BAA6B,OAAO;AAAA,MAChE,GAAI,YAAY,YAAY,EAAE,iBAAiB,OAAO;AAAA,MACtD,GAAG;AAAA,MACJ,WAAW,CAAC,UAAU;AAjUzB,YAAAY;AAkUI,SAAAA,MAAA,YAAY,cAAZ,gBAAAA,IAAA,kBAAwB;AACxB,sBAAc,KAAK;AAAA,MACpB;AAAA,MACA,SAAS,CAAC,UAAU;AArUvB,YAAAA;AAsUI,SAAAA,MAAA,YAAY,YAAZ,gBAAAA,IAAA,kBAAsB;AACtB,oBAAY,KAAK;AAAA,MAClB;AAAA,MACA,aAAa,CAAC,UAAU;AAzU3B,YAAAA;AA0UI,SAAAA,MAAA,YAAY,gBAAZ,gBAAAA,IAAA,kBAA0B;AAC1B,wBAAgB;AAAA,MACjB;AAAA,MACA,WAAW,CAAC,UAAU;AA7UzB,YAAAA;AA8UI,SAAAA,MAAA,YAAY,cAAZ,gBAAAA,IAAA,kBAAwB;AACxB,sBAAc;AAAA,MACf;AAAA,MACA,cAAc,CAAC,UAAU;AAjV5B,YAAAA;AAkVI,SAAAA,MAAA,YAAY,iBAAZ,gBAAAA,IAAA,kBAA2B;AAC3B,yBAAiB;AAAA,MAClB;AAAA,MACA,cAAc,CAAC,UAAU;AArV5B,YAAAA;AAsVI,SAAAA,MAAA,YAAY,iBAAZ,gBAAAA,IAAA,kBAA2B;AAC3B,yBAAiB;AAAA,MAClB;AAAA,MACA,SAAS,CAAC,UAAU;AAzVvB,YAAAA;AA0VI,SAAAA,MAAA,YAAY,YAAZ,gBAAAA,IAAA,kBAAsB;AACtB,oBAAY;AAAA,MACb;AAAA,MACA,QAAQ,CAAC,UAAU;AA7VtB,YAAAA;AA8VI,SAAAA,MAAA,YAAY,WAAZ,gBAAAA,IAAA,kBAAqB;AACrB,mBAAW;AAAA,MACZ;AAAA,MAEA;AAAA,MACA;AAAA,MACA;AAAA,MACA,cAAY;AAAA,MACZ,oBAAkB;AAAA,MAClB,mBAAiB;AAAA,MACjB;AAAA,MACA;AAAA,MACA,OAAO;AAAA,MACP;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MAEC;AAAA;AAAA,EACF;AAEF;AAaO,IAAM,SAASX,YAAW,eAAe;AAChD,OAAO,cAAc;AAKrB,IAAO,iBAAQ;;;AExYf,IAAAY,qBAAuB;;;ACAvB,IAAAC,qBAAuB;;;ACDvB,SAAgB,qBAAqB;;;ACarC,SAAS,YAAY,MAA4B;AAC/C,UAAO,MAAK;AAAA,IACV,KAAK;AAAA,IACL,KAAK;AAAM,aAAO;AAAA,IAClB,KAAK;AAAK,aAAO;AAAA,IACjB,KAAK;AAAK,aAAO;AAAA,IACjB,KAAK;AAAK,aAAO;AAAA,IACjB,KAAK;AAAM,aAAO;AAAA,IAClB;AAAS,aAAO;AAAA,EAClB;AACF;AAEO,SAAS,gBAAgB,OAAkD;AAzBlF,MAAAC;AA0BE,QAAM,SAAQA,MAAA,MAAM,UAAN,OAAAA,MAAe,YAAY,MAAM,IAAI;AACnD,QAAM,UAAU;AAAA,IACd;AAAA,IACA,MAAM,OAAO,kBAAkB,MAAM,IAAI,KAAK;AAAA,IAC9C,MAAM,aAAa;AAAA,EACrB,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG;AAC1B,QAAM,QAAQ,MAAM,eAAe,EAAE,cAAc,MAAM,aAAa,IAAI;AAC1E,SAAO,EAAE,KAAK,IAAI,KAAK,IAAW,SAAS,MAAM;AACnD;;;ADTsC,gBAAAC,aAAA;AAF/B,IAAM,UAAkC,CAAC,EAAE,OAAO,WAAW,MAAM,MAAM,UAAU,MAAM,cAAc,GAAG,KAAK,MAAM;AAC1H,QAAM,QAAQ,gBAAgB,EAAE,OAAO,MAAM,WAAW,aAAa,CAAC;AACtE,QAAM,UAAU,aAAa,OAAO,gBAAAA,MAAC,UAAK,yBAAyB,EAAE,QAAQ,KAAK,GAAG,IAAK;AAC1F,SAAO,cAAc,MAAM,KAAK,EAAE,WAAW,MAAM,SAAS,OAAO,MAAM,OAAO,GAAG,KAAK,GAAG,OAAO;AACpG;;;ADAQ,gBAAAC,OAiDJ,QAAAC,aAjDI;AArBD,IAAM,QAA8B,CAAC;AAAA,EAC1C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,eAAe;AAAA,EACf;AAAA,EACA;AAAA,EACA;AAAA,EACA,GAAG;AACL,MAAM;AACJ,QAAM,mBAAe,mBAAAC;AAAA,IACnB;AAAA,IACA;AAAA,EACF;AAEA,QAAM,gBAAgB,MAAM;AAC1B,QAAI,CAAC,eAAe,CAAC,eAAe,CAAC,SAAU,QAAO;AAEtD,QAAI,aAAa;AACf,aACE,gBAAAF;AAAA,QAAC;AAAA;AAAA,UACC,OAAO;AAAA,UACP,WAAU;AAAA,UACV,MAAM;AAAA,UACN,cAAa;AAAA;AAAA,MACf;AAAA,IAEJ;AAEA,QAAI,aAAa;AACf,aACE,gBAAAA;AAAA,QAAC;AAAA;AAAA,UACC,OAAO;AAAA,UACP,WAAU;AAAA,UACV,MAAM;AAAA,UACN,cAAa;AAAA;AAAA,MACf;AAAA,IAEJ;AAEA,WAAO;AAAA,EACT;AAEA,QAAM,aAAa,MAAM;AACvB,QAAI,UAAU;AACZ,aAAO,gBAAAA,MAAC,SAAI,WAAU,qBAAqB,UAAS;AAAA,IACtD;AAEA,QAAI,UAAU;AACZ,aACE,gBAAAA;AAAA,QAAC;AAAA;AAAA,UACC,WAAU;AAAA,UACV,yBAAyB,EAAE,QAAQ,SAAS;AAAA;AAAA,MAC9C;AAAA,IAEJ;AAEA,QAAI,UAAU;AACZ,aACE,gBAAAA,MAAC,SAAI,WAAU,qBACb,0BAAAA,MAAC,OAAG,oBAAS,GACf;AAAA,IAEJ;AAEA,WAAO;AAAA,EACT;AAEA,SACE,gBAAAC,MAAC,SAAI,WAAW,cAAc,IAAS,GAAG,OACvC;AAAA,kBAAc;AAAA,IACd,WAAW;AAAA,KACd;AAEJ;;;AD2Ca,0BAAAE,OAiHR,QAAAC,aAjHQ;AA/Fb,IAAM,iBAA0C,EAAE,SAAS,KAAK;AAChE,IAAM,oBAAoB,MAAM;AAC/B,MAAI,eAAe,QAAS,QAAO,eAAe;AAClD,MAAI;AACH,mBAAe,UAAU;AACzB,QAAI;AAAE;AAAA,IAAgD,QAAQ;AAAA,IAAC;AAC/D,QAAI;AAAE;AAAA,IAAyC,QAAQ;AAAA,IAAC;AACxD,QAAI;AAAE;AAAA,IAA0C,QAAQ;AAAA,IAAC;AAAA,EAC1D,QAAQ;AAAE,mBAAe,UAAU;AAAA,EAAM;AACzC,SAAO,eAAe;AACvB;AACO,IAAM,oBAAoB,CAAC,SAAiB;AAClD,QAAM,WAA6C;AAAA,IAClD,EAAE,OAAO,kLAAkL,KAAK,KAAK;AAAA,IACrM,EAAE,OAAO,8BAA8B,KAAK,MAAM;AAAA,IAClD,EAAE,OAAO,2BAA2B,KAAK,MAAM;AAAA,IAC/C,EAAE,OAAO,8BAA8B,KAAK,MAAM;AAAA,EACnD;AACA,MAAI,OAAO;AACX,WAAS,QAAQ,OAAK;AAAE,WAAO,KAAK,QAAQ,EAAE,OAAO,OAAK,2BAA4B,EAAE,GAAG,KAAM,CAAC,SAAS;AAAA,EAAG,CAAC;AAC/G,SAAO;AACR;AACO,IAAM,gBAAgB,CAAC,MAAc,MAAe,YAAsB;AAChF,MAAI,QAAS,QAAO;AACpB,MAAI,CAAC,KAAM,QAAO;AAClB,QAAMC,SAAQ,kBAAkB;AAChC,MAAIA,UAASA,OAAM,WAAW;AAC7B,UAAM,eAAeA,OAAM,UAAU,IAAI,IACtC,OACCA,OAAM,UAAU,eAAe,SAAS,QAAQ,SAAS,SAAS,SAAS,gBAC3E,eACCA,OAAM,UAAU,QAAQ,SAAS,SAAS,SAAS;AACxD,QAAI,cAAc;AACjB,UAAI;AAAE,eAAOA,OAAM,UAAU,MAAMA,OAAM,UAAU,YAAY,GAAG,YAAY;AAAA,MAAG,QAAQ;AAAA,MAAC;AAAA,IAC3F;AAAA,EACD;AACA,SAAO,kBAAkB,IAAI;AAC9B;AAEA,IAAM,YAAkC,CAAC;AAAA,EACxC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,oBAAoB;AAAA,EACpB,aAAa;AAAA,EACb;AAAA,EACA,eAAe;AAAA,EACf,QAAQ;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,eAAe;AAAA,EACf;AAAA,EACA;AAAA,EACA,wBAAwB;AACzB,MAAM;AAEL,QAAM,eACL,wBAAwB,cAAc,yBAAyB,WAAW,KAAK,EAAE,GAAG,KAAK;AAG1F,QAAM,qBAAiB,mBAAAC;AAAA,IACtB;AAAA,IACA;AAAA,MACC,0BAA0B;AAAA,IAC3B;AAAA,IACA;AAAA,EACD;AAGA,QAAM,yBAAqB,mBAAAA,SAAW,OAAO;AAG7C,QAAM,mBAAmB,CAAC,MAA2B,UAAkB;AACvE,UAAM,oBAAgB,mBAAAA;AAAA,MACrB;AAAA,MACA;AAAA,QACC,CAAC,wBAAwB,KAAK,MAAM,EAAE,GAAG,KAAK;AAAA,MAC/C;AAAA,MACA,KAAK;AAAA,IACN;AAEA,UAAM,mBAAmB;AAAA,MACxB,OAAO;AAAA,MACP,GAAI,KAAK,WAAW,EAAE,SAAS,KAAK,QAAQ;AAAA,MAC5C,GAAI,KAAK,WAAW,EAAE,SAAS,KAAK,QAAQ;AAAA,MAC5C,GAAI,cAAc,EAAE,MAAM,eAAe;AAAA,MACzC,GAAG,KAAK;AAAA,IACT;AAGC,QAAI;AACJ,QAAI,KAAK,QAAQ,MAAM;AACtB,gBAAU,gBAAAH,MAAA,YAAG,eAAK,MAAK;AAAA,IACxB,WAAW,KAAK,MAAM;AACrB,gBAAU,gBAAAA,MAAC,UAAK,yBAAyB,EAAE,QAAQ,KAAK,KAAK,GAAG;AAAA,IACjE,WAAW,KAAK,QAAQ,MAAM;AAC7B,YAAM,UAAU,MAAM,QAAQ,KAAK,IAAI;AACvC,YAAM,aAAa,UACf,KAAK,KAAkB,KAAK,IAAI,IAChC,KAAK;AACT,YAAM,cAAc,WAAW,WAAW,SAAS,IAAI;AACvD,YAAM,YAAY;AAAA,QACjB,eAAW,mBAAAG,SAAW,qBAAqB,KAAK,eAAe;AAAA,UAC9D,4BAA4B;AAAA,UAC5B,6BAA6B,CAAC;AAAA,QAC/B,CAAC;AAAA,QACD,GAAI,KAAK,eAAe,EAAE,iBAAiB,KAAK,aAAa,IAAI,CAAC;AAAA,MACnE;AACA,YAAM,cAAc,cAAc,YAAa,KAAa,YAAY;AACxE,gBAAU,cACT,gBAAAH,MAAC,SAAI,WAAU,oBACd,0BAAAA;AAAA,QAAC;AAAA;AAAA,UACC,GAAG;AAAA,UACJ,yBAAyB,EAAE,QAAQ,YAAY;AAAA;AAAA,MAChD,GACD,IAEA,gBAAAA;AAAA,QAAC;AAAA;AAAA,UACC,GAAG;AAAA,UACJ,yBAAyB,EAAE,QAAQ,YAAY;AAAA;AAAA,MAChD;AAAA,IAEF,OAAO;AACN,gBAAU,KAAK;AAAA,IAChB;AACA,WACC,gBAAAA,MAAC,QAAe,WAAW,eAAgB,GAAG,kBAC5C,qBADO,KAET;AAAA,EAEF;AAEA,QAAM,aAAa,CAClB,MACA,WACA,gBACI;AAEJ,UAAM,eAAgB,qBAAqB,eAAiB,KAAa;AAEzE,UAAM,kBAAc,mBAAAG;AAAA,MACnB,eAAe,wBAAwB;AAAA,MACvC;AAAA,QACC,CAAC,gBAAgB,eAAe,WAAW,MAAM,KAAK,KAAK,MAAM,EAAE,GAClE,KAAK;AAAA,MACP;AAAA,MACA,KAAK;AAAA,IACN;AAEA,UAAM,iBAAiB;AAAA,MACtB,GAAI,gBAAgB,EAAE,OAAO,MAAe;AAAA,MAC5C,GAAI,KAAK,WAAW,EAAE,SAAS,KAAK,QAAQ;AAAA,MAC5C,GAAI,KAAK,WAAW,EAAE,SAAS,KAAK,QAAQ;AAAA,MAC5C,GAAI,cAAc;AAAA,QACjB,MAAM,eAAe,cAAc;AAAA,QACnC,GAAI,KAAK,UAAU,EAAE,cAAc,KAAK,OAAO;AAAA,MAChD;AAAA,MACA,GAAG,KAAK;AAAA,IACT;AAEA,QAAI;AAGJ,QAAI,KAAK,QAAQ,MAAM;AACtB,cAAQ,gBAAAH,MAAA,YAAG,eAAK,MAAK;AAAA,IACtB,WAAW,KAAK,MAAM;AACrB,cAAQ,gBAAAA,MAAC,UAAK,yBAAyB,EAAE,QAAQ,KAAK,KAAK,GAAG;AAAA,IAC/D,WAAW,KAAK,QAAQ,MAAM;AAC7B,YAAM,UAAU,MAAM,QAAQ,KAAK,IAAI;AACvC,YAAM,aAAa,UACf,KAAK,KAAkB,KAAK,IAAI,IAChC,KAAK;AACT,YAAM,cAAc,WAAW,WAAW,SAAS,IAAI;AACvD,YAAM,YAAY;AAAA,QACjB,eAAW,mBAAAG,SAAW,qBAAqB,KAAK,eAAe;AAAA,UAC9D,4BAA4B;AAAA,UAC5B,6BAA6B,CAAC;AAAA,QAC/B,CAAC;AAAA,QACD,GAAI,KAAK,eAAe,EAAE,iBAAiB,KAAK,aAAa,IAAI,CAAC;AAAA,MACnE;AACA,YAAM,cAAc;AAAA,QACnB;AAAA,QACA,KAAK;AAAA,QACL,KAAK;AAAA,MACN;AACA,cAAQ,cACP,gBAAAH,MAAC,SAAI,WAAU,oBACd,0BAAAA;AAAA,QAAC;AAAA;AAAA,UACC,GAAG;AAAA,UACJ,yBAAyB,EAAE,QAAQ,YAAY;AAAA;AAAA,MAChD,GACD,IAEA,gBAAAA;AAAA,QAAC;AAAA;AAAA,UACC,GAAG;AAAA,UACJ,yBAAyB,EAAE,QAAQ,YAAY;AAAA;AAAA,MAChD;AAAA,IAEF,OAAO;AACN,cAAQ,KAAK;AAAA,IACd;AAEA,UAAM,cACL,gBAAAC,MAAA,YACE;AAAA,oBAAc,KAAK,UACnB,gBAAAA,MAAC,UAAK,WAAU,mCAAkC,eAAY,QAC5D;AAAA,aAAK;AAAA,QAAQ;AAAA,SACf;AAAA,MAEA;AAAA,OACF;AAGD,UAAM,YAAY,eAAe,OAAO;AAExC,WACC,gBAAAD,MAAC,aAA0B,WAAW,aAAc,GAAG,gBACrD,yBADc,SAEhB;AAAA,EAEF;AAGA,MAAI,cAAc;AAClB,MAAI,cAAc;AAClB,MAAI,CAAC,eAAe,WAAW,QAAQ,QAAQ;AAC9C,kBAAc,QAAQ,IAAI,CAAC,OAAO;AAAA,MACjC,MAAM,EAAE;AAAA,MACR,QAAQ,EAAE;AAAA,MACV,SAAS,EAAE;AAAA,MACX,YAAY,EAAE;AAAA,IACf,EAAE;AAAA,EACH;AACA,MAAI,CAAC,eAAe,WAAW,QAAQ,KAAK,QAAQ;AACnD,kBAAc,KAAK,IAAI,CAAC,QAAQ,SAAS;AACxC,aAAO,QAAQ,IAAI,CAAC,MAAM;AACzB,cAAM,MAAM,EAAE,WAAW,EAAE,SAAS,QAAQ,IAAI,IAAK,OAAe,EAAE,GAAG;AACzE,YAAI,OAAY,EAAE,QAAQ,EAAE,QAAQ,SAAS,EAAE,aAAa,YAAY,EAAE,eAAe;AACzF,YAAI,EAAE,UAAW,MAAK,YAAY;AAClC,YAAI,EAAE,QAAQ;AACb,gBAAM,WAAW,EAAE,OAAO,KAAK,QAAQ,MAAM,CAAC;AAC9C,cAAI,YAAY,QAAQ,OAAO,aAAa,UAAW,QAAO,EAAE,GAAG,MAAM,MAAM,GAAG;AAClF,cAAI,OAAO,aAAa,YAAY,OAAO,aAAa,UAAU;AACjE,mBAAO,EAAE,GAAG,MAAM,MAAM,OAAO,QAAQ,EAAE;AAAA,UAC1C;AACA,iBAAO,EAAE,GAAG,MAAM,GAAI,SAAiB;AAAA,QACxC;AACA,eAAO,EAAE,GAAG,MAAM,MAAM,OAAO,OAAO,OAAO,GAAG,IAAI,GAAG;AAAA,MACxD,CAAC;AAAA,IACF,CAAC;AAAA,EACF;AAEA,QAAM,cAAc,MACnB,gBAAAC;AAAA,IAAC;AAAA;AAAA,MACA,WAAW;AAAA,MACV,GAAI,cAAc,EAAE,MAAM,QAAQ;AAAA,MAClC,GAAG;AAAA,MACH,GAAI,UAAU,EAAE,eAAe,OAAO;AAAA,MAEtC;AAAA,mBACA,gBAAAD,MAAC,aAAQ,eAAW,mBAAAG,SAAW,cAAc,yBAAyB,yBAAyB,GAC7F,mBACF;AAAA,QAGA,eAAe,YAAY,SAAS,KACpC,gBAAAH;AAAA,UAAC;AAAA;AAAA,YACA,WAAU;AAAA,YACT,GAAI,cAAc,EAAE,MAAM,WAAW;AAAA,YAEtC,0BAAAA,MAAC,QAAI,GAAI,cAAc,EAAE,MAAM,MAAM,GACnC,sBAAY;AAAA,cAAI,CAAC,MAAW,UAC5B,iBAAiB,MAAM,KAAK;AAAA,YAC7B,GACD;AAAA;AAAA,QACD;AAAA,QAGD,gBAAAA,MAAC,WAAM,WAAU,qBACf,yBACA,YAAY,IAAI,CAAC,KAAU,aAC1B,gBAAAA;AAAA,UAAC;AAAA;AAAA,YAEA,WAAU;AAAA,YACT,GAAI,cAAc,EAAE,MAAM,MAAM;AAAA,YAEhC,cAAI;AAAA,cAAI,CAAC,MAAW,cACpB,WAAW,MAAM,WAAW,cAAc,CAAC;AAAA,YAC5C;AAAA;AAAA,UANK;AAAA,QAON,CACA,GACH;AAAA;AAAA;AAAA,EACD;AAGD,MAAI,OAAO;AACV,WACC,gBAAAC,MAAC,SAAM,WAAW,cAChB;AAAA,iBACA,gBAAAD,MAAC,WAAQ,OAAO,cAAc,WAAU,4BACtC,mBACF;AAAA,MAEA,YAAY;AAAA,OACd;AAAA,EAEF;AAEA,MAAI,oBAAoB;AACvB,WAAO,gBAAAA,MAAC,SAAI,WAAW,oBAAqB,sBAAY,GAAE;AAAA,EAC3D;AAEA,SAAO,YAAY;AACpB;AAIO,IAAM,eAA4C,CAAC;AAAA,EACzD;AAAA,EACA;AAAA,EACA;AACD,MAAM;AACL,QAAM,UAAM,mBAAAG;AAAA,IACX;AAAA,IACA,QAAQ,yBAAyB,IAAI;AAAA,IACrC;AAAA,EACD;AACA,SAAO,gBAAAH,MAAC,aAAQ,WAAW,KAAM,UAAS;AAC3C;AAEO,IAAM,eAA4C,CAAC;AAAA,EACzD;AAAA,EACA;AAAA,EACA;AAAA,EACA,GAAG;AACJ,MAAM;AACL,QAAM,YAAY,aAAa,EAAE,MAAM,MAAM,IAAI,CAAC;AAClD,SACC,gBAAAA,MAAC,QAAG,WAAuB,GAAG,WAAY,GAAG,MAC3C,UACF;AAEF;AAEO,IAAM,kBAA2D,CAAC;AAAA,EACxE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,QAAAI;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,KAAK;AACN,MAAM;AAEL,QAAM,oBAAgB,mBAAAD;AAAA,IACrB;AAAA,IACA,EAAE,CAAC,wBAAwBC,OAAM,EAAE,GAAGA,QAAO;AAAA,IAC7C;AAAA,EACD;AACA,QAAM,mBAAwB;AAAA,IAC7B,OAAO;AAAA,IACP,GAAI,WAAW,EAAE,SAAS,QAAQ;AAAA,IAClC,GAAI,WAAW,EAAE,SAAS,QAAQ;AAAA,IAClC,GAAI,cAAc,EAAE,MAAM,eAAe;AAAA,IACzC,GAAG;AAAA,EACJ;AACA,MAAI;AACJ,MAAI,QAAQ,KAAM,WAAU,gBAAAJ,MAAA,YAAG,gBAAK;AAAA,WAC3B,KAAM,WAAU,gBAAAA,MAAC,UAAK,yBAAyB,EAAE,QAAQ,KAAK,GAAG;AAAA,WACjE,QAAQ,MAAM;AACtB,UAAM,UAAU,MAAM,QAAQ,IAAI;AAClC,UAAM,aAAa,UACf,KAAkB,KAAK,IAAI,IAC3B;AACJ,UAAM,cAAc,WAAW,WAAW,SAAS,IAAI;AACvD,UAAM,YAAY;AAAA,MACjB,eAAW,mBAAAG,SAAW,qBAAqB,eAAe;AAAA,QACzD,4BAA4B;AAAA,QAC5B,6BAA6B,CAAC;AAAA,MAC/B,CAAC;AAAA,MACD,GAAI,eAAe,EAAE,iBAAiB,aAAa,IAAI,CAAC;AAAA,IACzD;AACA,UAAM,cAAc;AAAA,MACnB;AAAA,MACA;AAAA,MACA;AAAA,IACD;AACA,cAAU,cACT,gBAAAH,MAAC,SAAI,WAAU,oBACd,0BAAAA;AAAA,MAAC;AAAA;AAAA,QACC,GAAG;AAAA,QACJ,yBAAyB,EAAE,QAAQ,YAAY;AAAA;AAAA,IAChD,GACD,IAEA,gBAAAA,MAAC,UAAM,GAAG,WAAW,yBAAyB,EAAE,QAAQ,YAAY,GAAG;AAAA,EAEzE,MAAO,WAAU;AACjB,QAAM,YAAiB;AACvB,SACC,gBAAAA,MAAC,aAAU,WAAW,eAAgB,GAAG,kBACvC,mBACF;AAEF;AAEO,IAAM,YAAmD,CAAC;AAAA,EAChE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,QAAAI;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACD,MAAM;AACL,QAAM,WAAW,CAAC,CAAC;AACnB,QAAMC,OAAW,WAAW,OAAO;AACnC,QAAM,UAAM,mBAAAF;AAAA,IACX,WAAW,wBAAwB;AAAA,IACnCC,WAAU,gBAAgB,WAAW,WAAW,MAAM,KAAKA,OAAM;AAAA,IACjE;AAAA,EACD;AACA,QAAM,YAAiB;AAAA,IACtB,GAAI,WAAW,EAAE,SAAS,QAAQ;AAAA,IAClC,GAAI,WAAW,EAAE,SAAS,QAAQ;AAAA,IAClC,GAAI,YAAY,EAAE,OAAO,MAAM;AAAA,IAC/B,GAAI,cAAc,EAAE,MAAM,WAAW,cAAc,OAAO;AAAA,IAC1D,GAAG;AAAA,EACJ;AACA,MAAI;AACJ,MAAI,QAAQ,KAAM,WAAU,gBAAAJ,MAAA,YAAG,gBAAK;AAAA,WAC3B,KAAM,WAAU,gBAAAA,MAAC,UAAK,yBAAyB,EAAE,QAAQ,KAAK,GAAG;AAAA,WACjE,QAAQ,MAAM;AACtB,UAAM,UAAU,MAAM,QAAQ,IAAI;AAClC,UAAM,aAAa,UAAW,KAAkB,KAAK,IAAI,IAAK;AAC9D,UAAM,cAAc,WAAW,WAAW,SAAS,IAAI;AACvD,UAAM,YAAY;AAAA,MACjB,eAAW,mBAAAG,SAAW,qBAAqB,eAAe;AAAA,QACzD,4BAA4B;AAAA,QAC5B,6BAA6B,CAAC;AAAA,MAC/B,CAAC;AAAA,MACD,GAAI,eAAe,EAAE,iBAAiB,aAAa,IAAI,CAAC;AAAA,IACzD;AACA,UAAM,cAAc,cAAc,YAAY,cAAc,gBAAgB;AAC5E,cAAU,cACT,gBAAAH,MAAC,SAAI,WAAU,oBAAmB,0BAAAA,MAAC,UAAM,GAAG,WAAW,yBAAyB,EAAE,QAAQ,YAAY,GAAG,GAAE,IAE3G,gBAAAA,MAAC,UAAM,GAAG,WAAW,yBAAyB,EAAE,QAAQ,YAAY,GAAG;AAAA,EAEzE,MAAO,WAAU;AACjB,SAAO,gBAAAA,MAACK,MAAA,EAAI,WAAW,KAAM,GAAG,WAAY,mBAAQ;AACrD;AAaA,IAAM,QAAQ;AACd,MAAM,UAAU;AAChB,MAAM,UAAU;AAChB,MAAM,aAAa;AACnB,MAAM,OAAO;AAEb,IAAI,cAAc;AAClB,IAAI,aAAa;AACjB,OAAO,eAAe,OAAO,OAAO;AAAA,EACnC,cAAc;AAAA,EACd,YAAY;AAAA,EACZ,MAAM;AACL,QAA6C,CAAC,aAAa;AAC1D,cAAQ,KAAK,qDAAqD;AAClE,oBAAc;AAAA,IACf;AACA,WAAO;AAAA,EACR;AACD,CAAC;AACD,OAAO,eAAe,OAAO,MAAM;AAAA,EAClC,cAAc;AAAA,EACd,YAAY;AAAA,EACZ,MAAM;AACL,QAA6C,CAAC,YAAY;AACzD,cAAQ,KAAK,uDAAuD;AACpE,mBAAa;AAAA,IACd;AACA,WAAO;AAAA,EACR;AACD,CAAC;AAED,IAAO,gBAAQ;;;AIzXZ,SAGG,OAAAC,OAHH,QAAAC,cAAA;AAjHI,IAAM,qBAAwD,CAAC;AAAA,EACrE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,iBAAiB;AAAA,EACjB;AAAA,EACA,gBAAgB;AAAA,EAChB,gBAAgB;AAAA,EAChB,cAAc;AAAA,EACd,cAAc;AAAA,EACd,YAAY;AAAA,EACZ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,GAAG;AACJ,MAAM;AACL,MAAI,gBAAgB;AACpB,MACC,CAAC,iBACD,uBACA,oBAAoB,SAAS,KAC7B,CAAC,WACA;AAID,UAAM,QAAQ;AAAA,MACb,EAAE,MAAM,QAAQ,SAAS,kCAAkC;AAAA,MAC3D,GAAG,oBAAoB,IAAI,CAAC,OAAO;AAAA,QAClC,MAAM,EAAE,SAAS,EAAE;AAAA,QACnB,SAAS;AAAA,MACV,EAAE;AAAA,IACH;AAGA,UAAM,UAAU,oBAAoB;AAAA,MACnC,CAAC,GAAG,MAAO,EAAE,KAAK,SAAS,EAAE,KAAK,SAAS,IAAI;AAAA,MAC/C,oBAAoB,CAAC;AAAA,IACtB;AAEA,UAAM,OAAO,QAAQ,KAAK,IAAI,CAAC,GAAG,WAAW;AAC5C,YAAM,WAAW;AAAA,QAChB,MAAM,IAAI,KAAK,EAAE,CAAQ,EAAE,mBAAmB;AAAA,QAC9C,SAAS;AAAA,MACV;AACA,YAAM,cAAc,oBAAoB,IAAI,CAAC,MAAM;AAClD,cAAMC,SAAQ,EAAE,KAAK,MAAM;AAC3B,cAAM,OAAOA,SAAQA,OAAM,IAAI;AAC/B,eAAO;AAAA,UACN,MAAM,SAAS,UAAa,SAAS,OAAO,WAAM,OAAO,IAAI;AAAA,UAC7D,SAAS;AAAA,UACT,QAAQ,EAAE,SAAS,EAAE;AAAA,QACtB;AAAA,MACD,CAAC;AACD,aAAO,CAAC,UAAU,GAAG,WAAW;AAAA,IACjC,CAAC;AAED,UAAM,eACL,qBACC,QAAQ,MAAM,QAAQ,gBAAgB,GAAG,EAAE,YAAY,IAAI;AAC7D,UAAM,QAAQ,MAAM;AACnB,YAAM,aAAa,MAAM,IAAI,CAAC,MAAM,OAAO,EAAE,QAAQ,MAAM,GAAG,EAAE,KAAK,GAAG;AACxE,YAAM,OAAO,KACX,IAAI,CAACC,OAAMA,GAAE,IAAI,CAAC,MAAG;AA1H1B,YAAAC;AA0H6B,uBAAOA,MAAA,EAAE,SAAF,OAAAA,MAAU,MAAM;AAAA,OAAG,EAAE,KAAK,GAAG,CAAC,EAC7D,KAAK,IAAI;AACX,aAAO,aAAa,OAAO,OAAO;AAAA,IACnC;AACA,UAAM,iBAAiB,MAAM;AAE5B,UACC,OAAO,WAAW,eAClB,OAAO,aAAa,eACpB,OAAO,QAAQ,eACf,OAAO,SAAS,aACf;AAED,YAAI,MAAuC;AAC1C,kBAAQ;AAAA,YACP;AAAA,UACD;AAAA,QACD;AACA;AAAA,MACD;AACA,UAAI;AACH,cAAM,OAAO,IAAI,KAAK,CAAC,MAAM,CAAC,GAAG,EAAE,MAAM,0BAA0B,CAAC;AACpE,cAAM,OAAO,SAAS,cAAc,GAAG;AACvC,cAAM,MAAM,IAAI,gBAAgB,IAAI;AACpC,aAAK,OAAO;AACZ,aAAK,WAAW,GAAG,YAAY;AAC/B,aAAK,MAAM,UAAU;AACrB,cAAM,SAA8B,SAAS,QAAgC,SAAS;AACtF,YAAI,QAAQ;AACX,iBAAO,YAAY,IAAI;AACvB,eAAK,MAAM;AACX,iBAAO,YAAY,IAAI;AAAA,QACxB,OAAO;AAEN,eAAK,MAAM;AAAA,QACZ;AACA,YAAI,gBAAgB,GAAG;AAAA,MACxB,SAAS,GAAG;AACX,gBAAQ,KAAK,uBAAuB,CAAC;AAAA,MACtC;AAAA,IACD;AACA,oBACC,gBAAAH,OAAC,SAAI,WAAU,yBACb;AAAA,wBACA,gBAAAD,MAAC,SAAI,WAAU,2BACd,0BAAAA,MAAC,kBAAO,SAAQ,aAAY,SAAS,gBAAgB,MAAK,SAAQ,0BAElE,GACD;AAAA,MAED,gBAAAA,MAAC,iBAAM,SAAS,GAAG,KAAK,SAAS,MAAM,OAAO,MAAY,YAAU,MAAC;AAAA,OACtE;AAAA,EAEF;AAEA,QAAM,WAAW,CAAC,CAAC,iBAAiB,CAAC;AACrC,QAAM,gBAAgB,CAAC,eAAe;AAEtC,MAAI,CAAC,eAAe;AACnB,WACC,gBAAAA;AAAA,MAAC;AAAA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA,oBAAoB;AAAA,QACnB,GAAG;AAAA,QAEH;AAAA;AAAA,IACF;AAAA,EAEF;AAEA,QAAM,WAAsB;AAAA,IAC3B;AAAA,MACC,IAAI;AAAA,MACJ,OAAO;AAAA,MACP,SACC,gBAAAA;AAAA,QAAC;AAAA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA,oBAAoB;AAAA,UACnB,GAAG;AAAA,UAEH;AAAA;AAAA,MACF;AAAA,IAEF;AAAA,IACA;AAAA,MACC,IAAI;AAAA,MACJ,OAAO;AAAA,MACP,SACC,gBAAAA;AAAA,QAAC;AAAA;AAAA,UACA,WAAU;AAAA,UACV,cAAY,GAAG,KAAK;AAAA,UAEnB;AAAA;AAAA,MACF;AAAA,IAEF;AAAA,EACD;AAEA,QAAM,QAAmB,iBACtB,CAAC,GAAG,UAAU,GAAG,cAAc,IAC/B;AAEH,SACC,gBAAAA,MAAC,SAAI,WAAU,kBAAiB,yBAAqB,MACpD,0BAAAA;AAAA,IAAC;AAAA;AAAA,MACA;AAAA,MACA,kBAAkB;AAAA,MAClB,aAAa,CAAC,UAAkB;AAC/B,YAAI,UAAU,WAAW,UAAU,SAAS;AAC3C,uDAAe;AAAA,QAChB,OAAO;AACN,uDAAe;AAAA,QAChB;AAAA,MACD;AAAA;AAAA,EACD,GACD;AAEF;AAEA,IAAO,6BAAQ;;;AC7Pf,YAAYK,aAAW;AAkHX,SACE,OAAAC,OADF,QAAAC,cAAA;AA/EL,IAAM,SAAgC,CAAC;AAAA,EAC5C,OAAO;AAAA,EACP,UAAU;AAAA,EACV,YAAY;AAAA,EACZ,cAAc;AAAA,EACd,iCAAiC;AAAA,EACjC;AAAA,EACA,mBAAmB,CAAC;AAAA,EACpB;AAAA,EACA;AACF,MAAM;AACJ,QAAM,aAAa,cAAc;AACjC,QAAM,qBAAqB,CAAC,EAAE,cAAc,CAAC,eAAe,CAAC,sBAAsB,cAAc;AACjG,QAAM,uBAAuB,eAAe;AAC5C,QAAM,QAAQ,aAAa,CAAC;AAC5B,QAAM,aAAa,cAAc;AACjC,QAAM,CAAC,gBAAgB,iBAAiB,IAAU,iBAAsB,IAAI,IAAI,gBAAgB,CAAC;AACjG,QAAM,kBAAkB,aAAa,IAAI,IAAI,SAAS,IAAI;AAC1D,QAAM,CAAC,cAAc,eAAe,IAAU,iBAAS,EAAE;AAEzD,QAAM,SAAS,CAAC,OAAe;AAC7B,QAAI,sBAAsB,YAAY;AACpC,YAAMC,aAAY,WAAW,SAAS,EAAE;AACxC,iBAAW,OAAO,EAAE;AACpB,YAAMC,QAAO,MAAM,KAAK,OAAK,EAAE,OAAO,EAAE;AACxC,YAAMC,UAAQD,SAAA,gBAAAA,MAAM,UAAS;AAC7B,YAAME,OAAM,qBACR,mBAAmB,IAAIH,YAAWE,MAAK,IACvC,GAAGA,MAAK,IAAIF,aAAY,UAAU,QAAQ;AAC9C,sBAAgBG,IAAG;AACnB;AAAA,IACF;AACA,QAAI,CAAC,qBAAsB;AAC3B,UAAM,OAAO,IAAI,IAAI,eAAe;AACpC,UAAM,YAAY,KAAK,IAAI,EAAE;AAC7B,QAAI,UAAW,MAAK,OAAO,EAAE;AAAA,QAAQ,MAAK,IAAI,EAAE;AAChD,QAAI,CAAC,WAAY,mBAAkB,IAAI;AACvC,UAAM,aAAa,MAAM,OAAO,OAAK,CAAC,KAAK,IAAI,EAAE,EAAE,CAAC,EAAE,IAAI,OAAK,EAAE,EAAE;AACnE,UAAM,YAAY,MAAM,KAAK,IAAI;AACjC,6DAAqB,YAAY;AACjC,UAAM,OAAO,MAAM,KAAK,OAAK,EAAE,OAAO,EAAE;AACxC,UAAM,SAAQ,6BAAM,UAAS;AAC7B,UAAM,MAAM,qBACR,mBAAmB,IAAI,WAAW,KAAK,IACvC,GAAG,KAAK,IAAI,YAAY,UAAU,QAAQ;AAC9C,oBAAgB,GAAG;AAAA,EACrB;AAEA,SACE,gBAAAJ,OAAC,SAAI,WAAU,sBACb;AAAA,oBAAAD,MAAC,QAAG,WAAW,0BAA0B,SAAS,IAC/C,gBAAM,IAAI,CAAC,MAAM,MAAM;AACtB,YAAM,mBAAmB,KAAK,WAAW;AACzC,YAAM,OAAO,KAAK,UAChB,qBAAqB,WAAW,gBAAgB,KAAK,IAAI,CAAC,IACxD,qBAAqB,aAAa,kBAAkB,KAAK,IAAI,CAAC,IAC9D,qBAAqB,cAAc,kBAAkB,KAAK,IAAI,CAAC,IAC/D,gBAAgB,CAAC;AAErB,UAAI,SAAS,KAAK,WAChB,qBAAqB,WAAW,iBAAiB,KAAK,IAAI,CAAC,IACzD,qBAAqB,aAAa,mBAAmB,KAAK,IAAI,CAAC,IAC/D,qBAAqB,cAAc,mBAAmB,KAAK,IAAI,CAAC,IAChE,iBAAiB,CAAC;AAEtB,UAAI,kCAAkC,QAAQ;AAC5C,cAAM,OAAO,OAAO,KAAK,EAAE,YAAY;AACvC,YAAI,SAAS,UAAU,SAAS,aAAa,SAAS,WAAW,yCAAyC,KAAK,IAAI,GAAG;AAEpH,mBAAS;AAAA,QACX;AAAA,MACF;AACA,YAAM,SAAS,sBAAsB,aAAa,WAAW,SAAS,KAAK,EAAE,IAAI,gBAAgB,IAAI,KAAK,EAAE;AAC5G,YAAM,WAA0D,uBAAuB;AAAA,QACrF,gBAAgB,CAAC;AAAA,QACjB,cAAc,GAAG,KAAK,KAAK,KAAK,SAAS,SAAS,MAAM;AAAA,QACxD,SAAS,MAAM,OAAO,KAAK,EAAE;AAAA,MAC/B,IAAI,EAAE,cAAc,KAAK,MAAM;AAC/B,aACE,gBAAAC,OAAC,QAAiB,WAAW,mBAAmB,SAAS,8BAA8B,EAAE,IACvF;AAAA,wBAAAD;AAAA,UAAC;AAAA;AAAA,YACC,MAAK;AAAA,YACL,WAAU;AAAA,YACV,OAAO;AAAA,cACL,iBAAiB;AAAA,cACjB,iBAAiB,KAAK,iBAAiB,OAAO,KAAK,cAAc,MAAM;AAAA,cACvE,gBAAgB,KAAK,iBAAiB,SAAS;AAAA,cAC/C,aAAa;AAAA,YACf;AAAA,YACC,GAAG;AAAA;AAAA,QACN;AAAA,QACA,gBAAAA,MAAC,UAAK,WAAU,qBAAqB,eAAK,OAAM;AAAA,WAZzC,KAAK,EAad;AAAA,IAEJ,CAAC,GACH;AAAA,IACH,wBACK,gBAAAA,MAAC,SAAI,WAAU,uBAAsB,aAAU,UAAS,eAAY,QAAQ,wBAAa;AAAA,KAE7F;AAEJ;AAEA,IAAO,iBAAQ;;;AC1If,YAAYM,aAAW;AAwCL,gBAAAC,OAad,QAAAC,cAbc;AAzBX,IAAM,sBAA0D,CAAC;AAAA,EACtE;AAAA,EACA,iBAAiB;AAAA,EACjB,mBAAmB,CAAC;AAAA,EACpB;AAAA,EACA;AAAA,EACA;AAAA,EACA,eAAe;AAAA,EACf,UAAU;AAAA,EACV,GAAG;AACL,MAAM;AACJ,QAAM,WAAiB,gBAAQ,MAAM,eAAe,mBAAmB,QAAQ,EAAE,QAAQ,CAAC,IAAI,QAAQ,CAAC,QAAQ,cAAc,OAAO,CAAC;AACrI,QAAM,aAAa,cAAc;AACjC,QAAM,CAAC,gBAAgB,iBAAiB,IAAU,iBAAsB,IAAI,IAAI,gBAAgB,CAAC;AACjG,QAAM,YAAY,aAAa,IAAI,IAAI,SAAS,IAAI;AACpD,QAAM,gBAAsB,gBAAQ,MAAM,SAAS,OAAO,OAAK,CAAC,UAAU,IAAI,EAAE,EAAE,CAAC,GAAG,CAAC,UAAU,SAAS,CAAC;AAE3G,QAAM,yBAA+B,oBAAY,CAAC,aAAuB,kBAA4B;AACnG,QAAI,CAAC,WAAY,mBAAkB,IAAI,IAAI,aAAa,CAAC;AACzD,UAAM,aAAa,SAAS,OAAO,OAAK,CAAC,cAAc,SAAS,EAAE,EAAE,CAAC,EAAE,IAAI,OAAK,EAAE,EAAE;AACpF,qDAAiB,eAAe;AAAA,EAClC,GAAG,CAAC,YAAY,UAAU,cAAc,CAAC;AAEzC,QAAM,cAAoB,gBAAQ,MAAM,SAAS,IAAI,QAAM,EAAE,IAAI,EAAE,IAAI,OAAO,EAAE,SAAS,EAAE,IAAI,OAAO,EAAE,MAAM,EAAE,GAAG,CAAC,QAAQ,CAAC;AAE7H,QAAM,UAAU,gBAAAD,MAAC,qBAAW,GAAG,gBAAgB,QAAQ,eAAe,SAAkB;AACxF,QAAM,WACJ,gBAAAA;AAAA,IAAC;AAAA;AAAA,MACE,GAAG;AAAA,MACJ;AAAA,MACA,OAAO;AAAA,MACP,aAAW;AAAA,MACX,WAAW,MAAM,KAAK,SAAS;AAAA,MAC/B,oBAAoB,CAAC,SAAS,WAAW,uBAAuB,SAAS,MAAM;AAAA;AAAA,EACjF;AAGF,SACE,gBAAAC,OAAC,SAAI,WAAU,6BACZ;AAAA,uBAAmB,SAAS;AAAA,IAC5B;AAAA,IACA,mBAAmB,YAAY;AAAA,KAClC;AAEJ;AAEA,IAAO,8BAAQ;;;AC7Df,YAAYC,aAAW;AAwIlB,SACC,OAAAC,OADD,QAAAC,cAAA;AA5FE,IAAM,sBAA0D,CAAC;AAAA,EACvE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,WAAW;AAAA,EACX,iBAAiB;AAAA,EACjB,YAAY;AAAA,EACZ,SAAS;AAAA,EACT;AAAA,EACA,eAAe;AAAA,EACf;AACD,MAAM;AAxDN,MAAAC;AAyDC,QAAM,WAAW,gBAAgB;AACjC,MAAI,CAAC,SAAU,QAAO;AACtB,QAAM,EAAE,QAAQ,OAAO,IAAI;AAC3B,QAAM,aAAa,cAAc;AACjC,QAAM,YAAWA,MAAA,yCAAY,SAAS,OAAO,QAA5B,OAAAA,MAAmC;AACpD,QAAM,QAAQ,YAAY,mBAAmB;AAC7C,MAAI,YAAY,mBAAmB,SAAU,QAAO;AACpD,QAAM,UAAU,kBAAkB;AAElC,EAAM,kBAAU,MAAM;AACrB,QAAI,CAAC,QAAS;AACd,UAAM,aAAa,OAAO,KAAK,IAAI,CAAC,OAAO,EAAE,GAAG,OAAO,CAAC,GAAG,GAAG,EAAE,EAAE,EAAE;AACpE,YAAQ,eAAe,OAAO,IAAI,UAAU;AAC5C,WAAO,MAAM,QAAQ,iBAAiB,OAAO,EAAE;AAAA,EAChD,GAAG,CAAC,SAAS,OAAO,IAAI,OAAO,MAAM,MAAM,CAAC;AAE5C,QAAM,kBAAkB,UAAU,OAAO,WAAW;AACpD,QAAMC,SACL,OAAO,SACP,oBACC,YAAY,WACV,gBAAgB,OAAO,IAAI,WAAW,IACtC,gBAAgB,WAAW;AAI/B,QAAM,WAAiB,gBAAQ,MAAM;AACpC,QAAI,WAAW,QAAQ,WAAW,OAAO,KAAK,QAAQ;AAErD,aAAO;AAAA,QACN,OAAO;AAAA,QACP,CAAC,MAAM,OAAO,OAAO,CAAC,CAAC;AAAA,QACvB,CAAC,MAAM;AACN,gBAAM,MAAM,OAAO,KAAK,QAAQ,CAAC;AACjC,iBAAO,OAAO,QAAQ,GAAG,EAAE,EAAE;AAAA,QAC9B;AAAA,QACA,EAAE,OAAO;AAAA,MACV;AAAA,IACD;AACA,WAAO;AAAA,MACN,OAAO;AAAA,MACP,CAAC,MAAM,OAAO,OAAO,CAAC,CAAC;AAAA,MACvB,CAAC,MAAM,OAAO,EAAE,CAAC;AAAA,MACjB,EAAE,OAAO;AAAA,IACV;AAAA,EACD,GAAG,CAAC,OAAO,MAAM,SAAS,QAAQ,QAAQ,QAAQ,MAAM,CAAC;AACzD,QAAM,WAAiB,gBAAQ,MAAM;AACpC,QAAI,WAAW,QAAQ,WAAW,OAAO,KAAK,QAAQ;AACrD,YAAMC,OAAM,aAAmD,EAC7D,EAAE,CAAC,MAAM,OAAO,OAAO,CAAC,CAAC,CAAC,EAC1B,GAAG,CAAC,GAAG,MAAM,OAAO,QAAQ,CAAC,EAAE,EAAE,CAAC,EAClC,GAAG,CAAC,GAAG,MAAM,OAAO,QAAQ,CAAC,EAAE,EAAE,CAAC;AACpC,UAAI,OAAQ,CAAAA,KAAI,MAAM,SAAc;AACpC,aAAOA,KAAI,OAAO,IAAW,KAAK;AAAA,IACnC;AAGA,UAAM,CAAC,WAAW,SAAS,IAAI,OAAO,OAAO;AAC7C,QAAI,oBAAoB;AACxB,QAAI,oBAAoB,UAAW,qBAAoB;AAAA,aAC9C,oBAAoB,UAAW,qBAAoB;AAC5D,UAAM,MAAM,aAAkB,EAC5B,EAAE,CAAC,MAAM,OAAO,OAAO,CAAC,CAAC,CAAC,EAC1B,GAAG,MAAM,OAAO,iBAAiB,CAAC,EAClC,GAAG,CAAC,MAAM,OAAO,EAAE,CAAC,CAAC;AACvB,QAAI,OAAQ,KAAI,MAAM,SAAc;AACpC,WAAO,IAAI,OAAO,IAAI,KAAK;AAAA,EAC5B,GAAG,CAAC,OAAO,MAAM,SAAS,QAAQ,QAAQ,QAAQ,WAAW,MAAM,CAAC;AAEpE,QAAM,aAAmB,cAAM;AAC/B,SACC,gBAAAH;AAAA,IAAC;AAAA;AAAA,MACA,WAAU;AAAA,MACV,eAAa,OAAO;AAAA,MACpB,SAAS,QAAQ,OAAO;AAAA,MACxB,eAAa,QAAQ,OAAO;AAAA,MAE3B;AAAA,wBACA,gBAAAD,MAAC,UACA,0BAAAC,OAAC,oBAAe,IAAI,YAAY,IAAG,MAAK,IAAG,MAAK,IAAG,MAAK,IAAG,QAC1D;AAAA,0BAAAD,MAAC,UAAK,QAAO,MAAK,WAAWG,QAAO,aAAa,MAAM;AAAA,UACvD,gBAAAH,MAAC,UAAK,QAAO,QAAO,WAAWG,QAAO,aAAa,GAAG;AAAA,WACvD,GACD;AAAA,QAED,gBAAAH;AAAA,UAAC;AAAA;AAAA,YACA,WAAU;AAAA,YACV,GAAG;AAAA,YACH,MAAM,eAAe,QAAQ,UAAU,MAAMG;AAAA,YAC5C,GAAI,eAAe,CAAC,IAAI,EAAE,aAAa,KAAK;AAAA,YAC7C,QAAO;AAAA;AAAA,QACR;AAAA,QACC,CAAC,YACD,gBAAAH,MAAC,UAAK,GAAG,UAAU,MAAK,QAAO,QAAQG,QAAO,aAAa,GAAG;AAAA;AAAA;AAAA,EAEhE;AAEF;AAEA,IAAO,8BAAQ;;;AC5Jf,YAAYE,aAAW;AA6WjB,SAOC,OAAAC,OAPD,QAAAC,cAAA;AAnSC,IAAM,qBAAwD,CAAC;AAAA,EACrE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,YAAY;AAAA,EACZ,cAAc;AAAA,EACd,WAAW;AAAA,EACX;AAAA,EACA,WAAW;AAAA,EACX,yBAAyB;AAAA,EACzB,iBAAiB;AAAA,EACjB,YAAY;AAAA,EACZ;AAAA,EACA;AAAA,EACA,WAAW;AAAA,EACX;AAAA,EACA,eAAe;AAAA,EACf,sBAAsB;AAAA,EACtB,UAAU;AAAA,EACV,eAAe;AAAA,EACf,kBAAkB;AAAA,EAClB;AACD,MAAM;AAlGN,MAAAC;AAmGC,QAAM,oBAAoB,KAAK,IAAI,GAAG,QAAQ;AAC9C,QAAM,WAAW,gBAAgB;AACjC,QAAM,YAAY,gBAAgB;AAClC,MAAI,CAAC,YAAY,CAAC,UAAW,QAAO;AACpC,QAAM,EAAE,QAAQ,OAAO,IAAI;AAC3B,QAAM,aAAa,cAAc;AACjC,QAAM,YAAWA,MAAA,yCAAY,SAAS,OAAO,QAA5B,OAAAA,MAAmC;AACpD,QAAM,QAAQ,YAAY,mBAAmB;AAC7C,MAAI,YAAY,mBAAmB,SAAU,QAAO;AACpD,QAAM,UAAU,kBAAkB;AAGlC,EAAM,kBAAU,MAAM;AACrB,QAAI,CAAC,QAAS;AACd,UAAM,aAAa,OAAO,KAAK,IAAI,CAAC,OAAO,EAAE,GAAG,OAAO,CAAC,GAAG,GAAG,EAAE,EAAE,EAAE;AACpE,YAAQ,eAAe,OAAO,IAAI,UAAU;AAC5C,WAAO,MAAM,QAAQ,iBAAiB,OAAO,EAAE;AAAA,EAChD,GAAG,CAAC,SAAS,OAAO,IAAI,OAAO,MAAM,MAAM,CAAC;AAG5C,QAAM,cAAc,OAAQ,OAAe,cAAc;AACzD,QAAM,YAAY,cAAe,OAAe,UAAU,IAAI;AAC9D,QAAM,qBAA2B,gBAAQ,MAAM;AAC9C,QAAI,aAAa,KAAM,QAAO;AAE9B,UAAM,eAAe,aAAa,UAAU,SAAS,YAAY,CAAC,MAAM;AACxE,UAAM,SAAmB,CAAC;AAC1B,iBAAa,QAAQ,CAAC,MAAM;AAC3B,QAAE,KAAK,QAAQ,CAAC,MAAM;AACrB,cAAM,IAAI,OAAO,OAAO,CAAC,CAAC;AAC1B,YAAI,OAAO,SAAS,CAAC,EAAG,QAAO,KAAK,CAAC;AAAA,MACtC,CAAC;AAAA,IACF,CAAC;AACD,UAAM,cAAc,OAAO,KAAK,CAAC,GAAG,MAAM,IAAI,CAAC;AAC/C,QAAI,YAAY,UAAU,EAAG,QAAO;AACpC,UAAM,QAAkB,CAAC;AACzB,aAAS,IAAI,GAAG,IAAI,YAAY,QAAQ;AACvC,YAAM,KAAK,YAAY,CAAC,IAAI,YAAY,IAAI,CAAC,CAAC;AAC/C,UAAM,KAAK,CAAC,GAAG,MAAM,IAAI,CAAC;AAC1B,UAAM,SAAS,MAAM,KAAK,MAAM,MAAM,SAAS,CAAC,CAAC,KAAK;AACtD,WAAO,SAAS;AAAA,EACjB,GAAG,CAAC,OAAO,MAAM,WAAW,QAAQ,QAAQ,aAAa,SAAS,CAAC;AAGnE,QAAM,EAAE,WAAW,IAAU,gBAAQ,MAAM;AA/I5C,QAAAA,KAAAC;AAiJE,QAAI,aAAa;AAChB,YAAM,KAAK;AACX,YAAM,aAAa,KAAK;AAAA,QACvB;AAAA,SACC,KAAK,YAAY,cAAc,MAAM;AAAA,MACvC;AACA,YAAMC,aAAWF,MAAA,OAAO,aAAP,OAAAA,MAAmB;AACpC,UAAI,cAAcE,YAAW,KAAK,IAAIA,WAAU,EAAE,IAAI;AACtD,UAAI,UAAU;AACb,cAAM,cACL,KAAK,KAAK,IAAI,GAAG,KAAK,IAAI,MAAM,sBAAsB,CAAC;AACxD,cAAM,gBAAgB,KAAK;AAAA,UAC1B;AAAA,WACC,cAAc,YAAY,cAAc,MAAM;AAAA,QAChD;AACA,sBAAcA,YACX,KAAK,IAAI,aAAa,aAAa,IACnC;AAAA,MACJ;AACA,aAAO,EAAE,YAAY,YAAY;AAAA,IAClC;AAEA,UAAM,YAAWD,MAAA,OAAO,aAAP,OAAAA,MAAmB;AAEpC,UAAM,aAAa,KAAK;AAAA,MACvB;AAAA,OACC,qBAAqB,YAAY,cAAc,MAAM;AAAA,IACvD;AACA,QAAI,UAAU;AAEb,YAAM,eAAe,aAAa,UAAU,SAAS,YAAY,CAAC,MAAM;AACxE,YAAM,YAAsB,CAAC;AAC7B,mBAAa;AAAA,QAAQ,CAAC,MACrB,EAAE,KAAK,QAAQ,CAAC,MAAM;AACrB,gBAAM,IAAI,OAAO,OAAO,CAAC,CAAC;AAC1B,cAAI,OAAO,SAAS,CAAC,EAAG,WAAU,KAAK,CAAC;AAAA,QACzC,CAAC;AAAA,MACF;AACA,gBAAU,KAAK,CAAC,GAAG,MAAM,IAAI,CAAC;AAC9B,YAAM,QAAkB,CAAC;AACzB,eAAS,IAAI,GAAG,IAAI,UAAU,QAAQ;AACrC,cAAM,KAAK,UAAU,CAAC,IAAI,UAAU,IAAI,CAAC,CAAC;AAC3C,YAAM,KAAK,CAAC,GAAG,MAAM,IAAI,CAAC;AAC1B,YAAM,OAAO,MAAM,KAAK,MAAM,MAAM,SAAS,CAAC,CAAC,KAAK;AACpD,YAAM,cACL,OAAO,KAAK,IAAI,GAAG,KAAK,IAAI,MAAM,sBAAsB,CAAC;AAC1D,YAAM,cAAc,KAAK;AAAA,QACxB;AAAA,SACC,cAAc,YAAY,cAAc,MAAM;AAAA,MAChD;AACA,YAAM,WAAW,WAAW,KAAK,IAAI,UAAU,WAAW,IAAI;AAC9D,aAAO,EAAE,YAAY,SAAS;AAAA,IAC/B;AACA,QAAI,UAAU;AACb,YAAM,WAAW,KAAK,IAAI,UAAU,UAAU;AAC9C,aAAO,EAAE,YAAY,SAAS;AAAA,IAC/B;AACA,WAAO,EAAE,YAAY,WAAW;AAAA,EACjC,GAAG;AAAA,IACF;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,OAAO;AAAA,IACP;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACD,CAAC;AAED,QAAM,gBAAsB,gBAAQ,MAAM;AACzC,QAAI,YAAa,QAAO,CAAC;AACzB,UAAM,MAAgB,CAAC;AACvB,UAAM,MAAM,aAAa,UAAU,SAAS,YAAY,CAAC,MAAM;AAC/D,QAAI;AAAA,MAAQ,CAAC,MACZ,EAAE,KAAK,QAAQ,CAAC,OAAO;AACtB,cAAM,IAAI,OAAO,OAAO,EAAE,CAAC;AAC3B,YAAI,OAAO,SAAS,CAAC,EAAG,KAAI,KAAK,CAAC;AAAA,MACnC,CAAC;AAAA,IACF;AACA,QAAI,KAAK,CAAC,GAAG,MAAM,IAAI,CAAC;AACxB,WAAO,MAAM,KAAK,IAAI,IAAI,GAAG,CAAC;AAAA,EAC/B,GAAG,CAAC,aAAa,WAAW,QAAQ,QAAQ,MAAM,CAAC;AAGnD,QAAM,kBAAwB,gBAAQ,MAAM;AAC3C,QAAI;AACH,aAAO,CAAC;AACT,QAAI,CAAC,cAAc,OAAQ,QAAO,CAAC;AACnC,QAAI,cAAc,WAAW,GAAG;AAC/B,aAAO;AAAA,QACN,EAAE,QAAQ,cAAc,CAAC,GAAG,MAAM,GAAG,OAAO,UAAU,WAAW;AAAA,MAClE;AAAA,IACD;AACA,UAAM,QAA2D,CAAC;AAClE,aAAS,IAAI,GAAG,IAAI,cAAc,QAAQ,KAAK;AAC9C,YAAM,IAAI,cAAc,CAAC;AACzB,YAAM,OAAO,MAAM,IAAI,KAAK,cAAc,IAAI,CAAC,IAAI,KAAK;AACxD,YAAM,QACL,MAAM,cAAc,SAAS,IAC1B,UAAU,cACT,IAAI,cAAc,IAAI,CAAC,KAAK;AACjC,YAAM,KAAK;AAAA,QACV,QAAQ;AAAA,QACR,MAAM,KAAK,IAAI,GAAG,IAAI;AAAA,QACtB,OAAO,KAAK,IAAI,UAAU,YAAY,KAAK;AAAA,MAC5C,CAAC;AAAA,IACF;AACA,WAAO;AAAA,EACR,GAAG,CAAC,aAAa,eAAe,UAAU,UAAU,CAAC;AAGrD,QAAM,qBAA2B,gBAAQ,MAAM;AAC9C,QAAI,eAAe,CAAC,gBAAgB;AACnC,aAAO;AACR,UAAM,YAAY,KAAK,IAAI,GAAG,KAAK,IAAI,MAAM,WAAW,CAAC;AACzD,UAAM,YAAY,gBAAgB,IAAI,CAAC,MAAM,KAAK,IAAI,GAAG,EAAE,QAAQ,EAAE,IAAI,CAAC;AAE1E,UAAM,aAAa,UAAU;AAAA,MAAI,CAAC,SACjC,KAAK,IAAI,GAAG,KAAK,IAAI,OAAO,GAAG,OAAO,SAAS,CAAC;AAAA,IACjD;AACA,QAAI,oBAAoB,KAAK,IAAI,GAAG,UAAU;AAE9C,QAAI,aAAa;AAChB,UAAI,eAAe,GAAG;AACrB,cAAM,cAAc,KAAK,IAAI,GAAG,UAAU,IAAI,CAAC,SAAS,OAAO,CAAC,CAAC;AACjE,YAAI,eAAe,eAAe,oBAAoB,aAAa;AAClE,8BAAoB,KAAK,IAAI,aAAa,WAAW;AAAA,QACtD;AAAA,MACD,OAAO;AACN,cAAM,mBAAmB,KAAK,IAAI,GAAG,UAAU,IAAI,CAAC,SAAS,OAAO,CAAC,CAAC;AACtE,cAAM,sBACL,cAAc,eACb,cAAc,MAAM,cAAc;AACpC,YACC,uBAAuB,oBACvB,oBAAoB,qBACnB;AACD,8BAAoB;AAAA,QACrB;AAAA,MACD;AAAA,IACD;AACA,QAAI,eAAe,GAAG;AAErB,UAAI,eAAe,oBAAoB,aAAa;AAEnD,cAAM,YAAY,UAAU,MAAM,CAAC,SAAS,QAAQ,WAAW;AAC/D,YAAI;AACH,iBAAO,EAAE,YAAY,aAAa,UAAU,YAAY;AAAA,MAC1D;AACA,aAAO,EAAE,YAAY,mBAAmB,UAAU,kBAAkB;AAAA,IACrE;AAIA,QAAI,IACH,qBAAqB,eAAe,cAAc,KAAK;AACxD,QAAI,IAAI,EAAG,KAAI;AACf,QAAI,eAAe,IAAI,aAAa;AAEnC,YAAM,gBACL,cAAc,eACb,cAAc,MAAM,cAAc;AACpC,UAAI,iBAAiB,mBAAmB;AACvC,YAAI;AAAA,MACL;AAAA,IACD;AAEA,UAAM,aACL,IAAI,eAAe,cAAc,MAAM,IAAI;AAC5C,WAAO,EAAE,YAAY,UAAU,EAAE;AAAA,EAClC,GAAG;AAAA,IACF;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACD,CAAC;AAOD,QAAM,6BACL,UAAU,OAAO,WAAW,IAAI,OAAO,WAAW,IAAI;AACvD,QAAM,kBACL,OAAO,SACP,+BACC,YAAY,WACV,gBAAgB,OAAO,IAAI,WAAW,IACtC,gBAAgB,WAAW;AAC/B,QAAM,mBACL,YAAY,WACT,iBAAiB,OAAO,IAAI,WAAW,IACvC,iBAAiB,WAAW;AAEhC,QAAM,sBACL,wBAAwB,OAAO,SAAS,8BACrC,kBACA;AACJ,QAAM,YAAY,OAAO,SAAS,OAAO,CAAC,CAAC,IAAI,OAAO,CAAC,IAAI,OAAO,MAAM,EAAE,CAAC;AAG3E,QAAM,mBAAyB,cAAM;AACrC,MAAI,WAAW,QAAQ,WAAW,OAAO,KAAK,QAAQ;AAErD,WACC,gBAAAF;AAAA,MAAC;AAAA;AAAA,QACA,WAAU;AAAA,QACV,eAAa,OAAO;AAAA,QACpB,SAAS,QAAQ,eAAe;AAAA,QAChC,eAAa,QAAQ,OAAO;AAAA,QAE3B;AAAA,0BACA,gBAAAD,MAAC,UAEA,0BAAAC;AAAA,YAAC;AAAA;AAAA,cACA,IAAI;AAAA,cACJ,IAAG;AAAA,cACH,IAAG;AAAA,cACH,IAAG;AAAA,cACH,IAAG;AAAA,cAEH;AAAA,gCAAAD,MAAC,UAAK,QAAO,MAAK,WAAW,iBAAiB,aAAa,KAAK;AAAA,gBAChE,gBAAAA;AAAA,kBAAC;AAAA;AAAA,oBACA,QAAO;AAAA,oBACP,WAAW;AAAA,oBACX,aAAa;AAAA;AAAA,gBACd;AAAA,gBACA,gBAAAA;AAAA,kBAAC;AAAA;AAAA,oBACA,QAAO;AAAA,oBACP,WAAW;AAAA,oBACX,aAAa;AAAA;AAAA,gBACd;AAAA;AAAA;AAAA,UACD,GACD;AAAA,UAEA,OAAO,KAAK,IAAI,CAAC,GAAG,OAAO;AAlYhC,gBAAAE;AAmYK,kBAAM,OAAO,OAAO,CAAC;AACrB,kBAAM,OAAO,cAAc,OAAO,EAAE,CAAQ,IAAI,OAAO,IAAI;AAC3D,gBAAI;AACJ,gBAAI;AACJ,gBAAI,aAAa;AAChB,0BAAY;AACZ,qBAAO;AAAA,YACR,OAAO;AACN,oBAAM,OAAO,gBAAgB;AAAA,gBAC5B,CAAC,MAAM,KAAK,IAAI,EAAE,SAAS,IAAI,IAAI;AAAA,cACpC;AACA,kBAAI,CAAC,QAAQ,CAAC,oBAAoB;AACjC,4BAAY;AACZ,uBAAO,OAAO,aAAa;AAAA,cAC5B,OAAO;AACN,sBAAM,EAAE,WAAW,IAAI;AACvB,4BAAY;AACZ,oBAAI,YAAY,OAAO,aAAa;AAEpC,oBAAI,YAAY,KAAK,KAAM,aAAY,KAAK;AAC5C,oBAAI,YAAY,aAAa,KAAK;AACjC,8BAAY,KAAK,IAAI,KAAK,MAAM,KAAK,QAAQ,UAAU;AACxD,uBAAO;AAAA,cACR;AAAA,YACD;AACA,kBAAM,MAAM,QAAQ,EAAE;AACtB,kBAAM,KAAK,OAAO,IAAI,EAAE;AACxB,kBAAM,KAAK,OAAO,IAAI,EAAE;AACxB,kBAAMG,KAAI,KAAK,IAAI,IAAI,EAAE;AACzB,kBAAM,SAAS,KAAK,IAAI,KAAK,EAAE,KAAK;AAEpC,gBAAI,CAAC,eAAe,eAAe,YAAY,aAAa;AAC3D,oBAAM,OAAO,gBAAgB;AAAA,gBAC5B,CAAC,MAAM,KAAK,IAAI,EAAE,SAAS,IAAI,IAAI;AAAA,cACpC;AACA,kBAAI,MAAM;AACT,sBAAM,cAAc,KAAK,IAAI,GAAG,KAAK,QAAQ,KAAK,OAAO,CAAC;AAC1D,sBAAM,SAAS,KAAK,IAAI,aAAa,WAAW;AAChD,oBAAI,SAAS,WAAW;AACvB,8BAAY;AACZ,yBAAO,KAAK;AAAA,oBACX,KAAK;AAAA,oBACL,KAAK,IAAI,KAAK,QAAQ,WAAW,OAAO,YAAY,CAAC;AAAA,kBACtD;AAAA,gBACD;AAAA,cACD;AAAA,YACD;AACA,kBAAM,YACL,CAAC,WACDH,MAAA,mCAAS,YAAT,gBAAAA,IAAkB,cAAa,OAAO,MACtC,QAAQ,QAAQ,UAAU;AAC3B,kBAAM,UAAU,MAAM;AACrB,kBAAI,CAAC,WAAW,MAAO;AAEvB,sBAAQ,WAAW;AAAA,gBAClB,UAAU,OAAO;AAAA,gBACjB,OAAO;AAAA,gBACP,GAAG;AAAA,gBACH,GAAG,IAAI,KAAK,IAAI;AAAA,gBAChB,SAAS,OAAO,YAAY;AAAA,gBAC5B,SAASG;AAAA,cACV,CAAC;AAAA,YACF;AACA,kBAAM,UAAU,MAAM;AAlc3B,kBAAAH;AAmcM,oBACCA,MAAA,mCAAS,YAAT,gBAAAA,IAAkB,cAAa,OAAO,MACtC,QAAQ,QAAQ,UAAU;AAE1B,wBAAQ,MAAM;AAAA,YAChB;AACA,mBACC,gBAAAF;AAAA,cAAC;AAAA;AAAA,gBAEA,GAAG;AAAA,gBACH,GAAGK;AAAA,gBACH,OAAO;AAAA,gBACP;AAAA,gBACA,MACC,eAAe,QAAQ,gBAAgB,MAAM;AAAA,gBAE7C,GAAI,CAAC,eAAe,EAAE,aAAa,gBAAgB,IAAI,CAAC;AAAA,gBAEzD,QACC,YACG,iDACA,gBAAgB,sBACf,kBACA;AAAA,gBAEL,aAAa,YAAY,IAAI;AAAA,gBAC7B,WAAU;AAAA,gBACV,UAAU,SAAS,CAAC,YAAY,KAAK;AAAA,gBACrC,MAAK;AAAA,gBACL,cAAY,GAAG,OAAO,SAAS,OAAO,EAAE,IAAI,gBAAgB,OAAO,KAAK,aAAa,IAAI,IAAI,UAAU,IAAI,KAAK,IAAI,EAAE;AAAA,gBACtH,cAAc;AAAA,gBACd,SAAS;AAAA,gBACT,cAAc;AAAA,gBACd,QAAQ;AAAA;AAAA,cAzBH;AAAA,YA0BN;AAAA,UAEF,CAAC;AAAA;AAAA;AAAA,IACF;AAAA,EAEF;AAEA,SACC,gBAAAJ;AAAA,IAAC;AAAA;AAAA,MACA,WAAU;AAAA,MACV,eAAa,OAAO;AAAA,MACpB,SAAS,QAAQ,eAAe;AAAA,MAChC,eAAa,QAAQ,OAAO;AAAA,MAG3B;AAAA,wBACA,gBAAAA,OAAC,UACC;AAAA,wBAAc,YACd,gBAAAA;AAAA,YAAC;AAAA;AAAA,cACA,IAAI;AAAA,cACJ,IAAG;AAAA,cACH,IAAG;AAAA,cACH,IAAG;AAAA,cACH,IAAG;AAAA,cAEH;AAAA,gCAAAD,MAAC,UAAK,QAAO,MAAK,WAAW,iBAAiB,aAAa,KAAK;AAAA,gBAChE,gBAAAA;AAAA,kBAAC;AAAA;AAAA,oBACA,QAAO;AAAA,oBACP,WAAW;AAAA,oBACX,aAAa;AAAA;AAAA,gBACd;AAAA,gBACA,gBAAAA;AAAA,kBAAC;AAAA;AAAA,oBACA,QAAO;AAAA,oBACP,WAAW;AAAA,oBACX,aAAa;AAAA;AAAA,gBACd;AAAA;AAAA;AAAA,UACD;AAAA,UAEA,cAAc,cACd,OAAO,KAAK,IAAI,CAAC,GAAG,OAAO;AAC1B,kBAAM,kBAAkB,UAAU,OAAO,EAAE;AAC3C,kBAAM,WACL,oBACC,YAAY,WACV,gBAAgB,OAAO,EAAE,CAAC,GAAG,EAAE,IAC/B,gBAAgB,EAAE;AACtB,kBAAM,MAAM,GAAG,gBAAgB,IAAI,EAAE;AACrC,mBACC,gBAAAC;AAAA,cAAC;AAAA;AAAA,gBAEA,IAAI;AAAA,gBACJ,IAAG;AAAA,gBACH,IAAG;AAAA,gBACH,IAAG;AAAA,gBACH,IAAG;AAAA,gBAEH;AAAA,kCAAAD,MAAC,UAAK,QAAO,MAAK,WAAW,UAAU,aAAa,KAAK;AAAA,kBACzD,gBAAAA,MAAC,UAAK,QAAO,OAAM,WAAW,UAAU,aAAa,MAAM;AAAA,kBAC3D,gBAAAA,MAAC,UAAK,QAAO,QAAO,WAAW,UAAU,aAAa,MAAM;AAAA;AAAA;AAAA,cATvD;AAAA,YAUN;AAAA,UAEF,CAAC;AAAA,WACH;AAAA,QAEA,OAAO,KAAK,IAAI,CAAC,GAAG,OAAO;AAriB/B,cAAAE;AAsiBI,gBAAM,OAAO,OAAO,CAAC;AACrB,gBAAM,OAAO,cAAc,OAAO,EAAE,CAAQ,IAAI,OAAO,IAAI;AAE3D,cAAI;AACJ,cAAII;AACJ,cAAI,aAAa;AAChB,kBAAM,KAAK;AACX,gBAAI,eAAe,GAAG;AACrB,cAAAA,YAAW;AACX,qBAAO;AAAA,YACR,OAAO;AACN,cAAAA,YAAW,KAAK;AAAA,gBACf;AAAA,gBACA,MAAM,eAAe,cAAc,KAAK;AAAA,cACzC;AACA,oBAAM,MAAMA,YAAW;AACvB,oBAAM,aAAaA,YAAW,cAAc,OAAO,cAAc;AACjE,oBAAM,YAAY,QAAQ,KAAK,cAAc;AAC7C,qBAAO,YAAY,eAAeA,YAAW;AAAA,YAC9C;AAAA,UACD,OAAO;AACN,kBAAM,OAAO,gBAAgB,KAAK,CAAC,MAAM,EAAE,WAAW,IAAI;AAC1D,gBAAI,CAAC,QAAQ,CAAC,oBAAoB;AACjC,cAAAA,YAAW;AACX,qBAAO,OAAO,aAAa;AAC3B,kBAAI,eAAeA,YAAW,aAAa;AAC1C,gBAAAA,YAAW;AACX,uBAAO,OAAOA,YAAW;AAAA,cAC1B;AAAA,YACD,OAAO;AACN,oBAAM,EAAE,UAAU,KAAK,IAAI;AAC3B,cAAAA,YAAW;AACX,oBAAM,MAAM,cAAc,IAAI,OAAO,oBAAoB;AACzD,oBAAM,qBACLA,YAAW,cAAc,OAAO,cAAc;AAC/C,kBAAI,YAAY,OAAO,qBAAqB;AAC5C,kBAAI,YAAY,KAAK,KAAM,aAAY,KAAK;AAC5C,kBAAI,YAAY,qBAAqB,KAAK;AACzC,4BAAY,KAAK,IAAI,KAAK,MAAM,KAAK,QAAQ,kBAAkB;AAChE,qBAAO,YAAY,eAAeA,YAAW;AAAA,YAC9C;AAEA,gBAAI,eAAeA,YAAW,aAAa;AAC1C,oBAAM,QAAQ,gBAAgB;AAAA,gBAC7B,CAAC,MAAM,KAAK,IAAI,EAAE,SAAS,IAAI,IAAI;AAAA,cACpC;AACA,kBAAI,OAAO;AACV,sBAAM,cAAc,KAAK,IAAI,GAAG,MAAM,QAAQ,MAAM,OAAO,CAAC;AAC5D,sBAAM,SAAS,KAAK,IAAI,aAAa,WAAW;AAChD,oBAAI,SAASA,WAAU;AACtB,sBAAI,eAAe,GAAG;AACrB,oBAAAA,YAAW;AACX,2BAAO,KAAK;AAAA,sBACX,MAAM;AAAA,sBACN,KAAK,IAAI,MAAM,QAAQA,WAAU,OAAOA,YAAW,CAAC;AAAA,oBACrD;AAAA,kBACD,OAAO;AACN,0BAAM,MAAM,SAAS;AACrB,0BAAM,cACL,SAAS,cAAc,OAAO,cAAc;AAC7C,wBAAI,eAAe,MAAM,QAAQ,MAAM,OAAO,GAAG;AAChD,sBAAAA,YAAW;AACX,4BAAM,aAAa;AACnB,0BAAI,YAAY,OAAO,aAAa;AACpC,0BAAI,YAAY,MAAM,KAAM,aAAY,MAAM;AAC9C,0BAAI,YAAY,aAAa,MAAM;AAClC,oCAAY,KAAK;AAAA,0BAChB,MAAM;AAAA,0BACN,MAAM,QAAQ;AAAA,wBACf;AACD,6BAAO,YAAY,eAAeA,YAAW;AAAA,oBAC9C;AAAA,kBACD;AAAA,gBACD;AAAA,cACD;AAAA,YACD;AAAA,UACD;AACA,gBAAM,aAAa,OAAOA,YAAW;AACrC,gBAAM,SAAS,OAAO,EAAE,CAAC;AACzB,gBAAMD,KAAI,KAAK,IAAI,WAAW,MAAM;AACpC,gBAAM,SAAS,KAAK,IAAI,YAAY,MAAM;AAC1C,gBAAM,YACL,CAAC,WACDH,MAAA,mCAAS,YAAT,gBAAAA,IAAkB,cAAa,OAAO,MACtC,QAAQ,QAAQ,UAAU;AAC3B,gBAAM,UAAU,MAAM;AACrB,gBAAI,CAAC,WAAW,MAAO;AACvB,oBAAQ,WAAW;AAAA,cAClB,UAAU,OAAO;AAAA,cACjB,OAAO;AAAA,cACP,GAAG;AAAA,cACH,GAAG,EAAE;AAAA,cACL,SAAS;AAAA,cACT,SAAS;AAAA,YACV,CAAC;AAAA,UACF;AACA,gBAAM,UAAU,MAAM;AAtoB1B,gBAAAA;AAuoBK,kBACCA,MAAA,mCAAS,YAAT,gBAAAA,IAAkB,cAAa,OAAO,MACtC,QAAQ,QAAQ,UAAU;AAE1B,sBAAQ,MAAM;AAAA,UAChB;AACA,gBAAM,kBACL,cAAc,cAAc,SAAS,OAAO,EAAE,IAAI;AACnD,gBAAM,WACL,cAAc,aACX,oBACA,YAAY,WACV,gBAAgB,OAAO,EAAE,CAAC,GAAG,EAAE,IAC/B,gBAAgB,EAAE,KACpB;AACJ,gBAAM,SACL,cAAc,aACX,GAAG,gBAAgB,IAAI,EAAE,KACzB;AACJ,gBAAM,aACL,gBAAgB,sBACb,WACA,cAAc,aACb,YAAY,WACX,iBAAiB,OAAO,EAAE,CAAC,GAAG,EAAE,IAChC,iBAAiB,EAAE,IACpB;AACL,gBAAM,iBAAiB,YACpB,iDACA,cAAc;AACjB,iBACC,gBAAAF;AAAA,YAAC;AAAA;AAAA,cAEA,GAAG;AAAA,cACH,GAAGK;AAAA,cACH,OAAOC;AAAA,cACP,QAAQ,UAAU;AAAA,cAClB,MAAM,eAAe,QAAQ,MAAM,MAAM;AAAA,cACxC,GAAI,CAAC,eAAe,EAAE,aAAa,gBAAgB,IAAI,CAAC;AAAA,cACzD,QAAQ;AAAA,cACR,aAAa,YAAY,IAAI;AAAA,cAC7B,WAAU;AAAA,cACV,UAAU,SAAS,CAAC,YAAY,KAAK;AAAA,cACrC,MAAK;AAAA,cACL,cAAY,GAAG,OAAO,SAAS,OAAO,EAAE,IAAI,gBAAgB,OAAO,KAAK,aAAa,IAAI,IAAI,UAAU,EAAE,CAAC;AAAA,cAC1G,cAAc;AAAA,cACd,SAAS;AAAA,cACT,cAAc;AAAA,cACd,QAAQ;AAAA;AAAA,YAhBH;AAAA,UAiBN;AAAA,QAEF,CAAC;AAAA;AAAA;AAAA,EACF;AAEF;AAEA,IAAO,6BAAQ;;;AC/rBf,YAAYC,aAAW;AAyErB,gBAAAC,aAAA;AAlDK,IAAM,qBAAwD,CAAC;AAAA,EACrE;AAAA,EACA,YAAY;AAAA,EACZ,aAAa;AAAA,EACb,eAAe;AAAA,EACf,eAAe;AAAA,EACf;AAAA,EACA,aAAa;AACd,MAAM;AA/BN,MAAAC,KAAAC;AAgCC,QAAM,QAAQ,gBAAgB;AAC9B,QAAM,cAAaD,MAAA,kBAAM,+BAAO,eAAb,OAAAA,MAA2B;AAC9C,QAAM,eAAcC,MAAA,kBAAM,+BAAO,gBAAb,OAAAA,MAA4B;AAChD,QAAM,UAAgB,gBAAQ,MAAM,OAAO,QAAQ,CAAC,MAAM,EAAE,IAAI,GAAG,CAAC,MAAM,CAAC;AAE3E,QAAM,UAAgB,gBAAQ,MAAM;AACnC,UAAM,MAAM,oBAAI,IAAY;AAC5B,YAAQ,QAAQ,CAAC,MAAM,IAAI,IAAI,EAAE,CAAC,CAAC;AACnC,WAAO,MAAM,KAAK,GAAG;AAAA,EACtB,GAAG,CAAC,OAAO,CAAC;AAEZ,QAAM,OAAa;AAAA,IAClB,MAAM,KAAK,IAAI,GAAG,GAAG,QAAQ,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC;AAAA,IAC5C,CAAC,OAAO;AAAA,EACT;AAEA,QAAM,SAAe;AAAA,IACpB,MACC,KAAkB,EAChB,OAAO,OAAO,EACd,MAAM,CAAC,GAAG,UAAU,CAAC,EACrB,aAAa,YAAY,EACzB,aAAa,YAAY;AAAA,IAC5B,CAAC,SAAS,YAAY,cAAc,YAAY;AAAA,EACjD;AAEA,QAAM,SAAe;AAAA,IACpB,MAAMC,QAAY,EAAE,OAAO,CAAC,GAAG,IAAI,CAAC,EAAE,KAAK,EAAE,MAAM,CAAC,aAAa,CAAC,CAAC;AAAA,IACnE,CAAC,MAAM,WAAW;AAAA,EACnB;AAEA,QAAM,QAAiC;AAAA,IACtC,OAAO;AAAA,MACN;AAAA,MACA;AAAA,MACA,WAAW,MAAM;AAAA,MACjB,WAAW,CAAC,IAAI,eAAe,OAAO,MAAM,CAAC;AAAA,IAC9C;AAAA,IACA,CAAC,QAAQ,QAAQ,SAAS,UAAU;AAAA,EACrC;AACA,SACC,gBAAAH,MAAC,qBAAa,UAAb,EAAsB,OAAe,UAAS;AAEjD;;;ACjBG,SACC,OAAAI,OADD,QAAAC,cAAA;AAnCH,IAAM,cAAc,CAAC,MAAuC;AAC3D,UAAQ,GAAG;AAAA,IACV,KAAK;AACJ,aAAO;AAAA,IACR,KAAK;AACJ,aAAO;AAAA,IACR,KAAK;AACJ,aAAO;AAAA,IACR,KAAK;AACJ,aAAO;AAAA,IACR;AACC,aAAO;AAAA,EACT;AACD;AAGO,IAAM,iBAAgD,CAAC;AAAA,EAC7D,cAAc;AAAA,EACd;AAAA,EACA;AAAA,EACA;AAAA,EACA,OAAAC;AAAA,EACA,SAAS;AAAA,EACT,cAAc;AACf,MAAM;AACL,QAAM,QAAQ,gBAAgB;AAC9B,QAAM,SAAS,gBAAgB;AAC/B,MAAI,CAAC,SAAS,CAAC,OAAQ,QAAO;AAC9B,QAAM,EAAE,YAAY,YAAY,IAAI;AACpC,QAAM,SAASA,UAAS,YAAY,MAAM;AAE1C,MAAI,gBAAgB,cAAc;AACjC,UAAMC,KAAI,OAAO,OAAO,KAAK;AAC7B,QAAI,OAAO,MAAMA,EAAC,EAAG,QAAO;AAC5B,WACC,gBAAAF,OAAC,OAAE,WAAU,8CAA6C,eAAW,MACpE;AAAA,sBAAAD;AAAA,QAAC;AAAA;AAAA,UACA,IAAI;AAAA,UACJ,IAAIG;AAAA,UACJ,IAAI;AAAA,UACJA;AAAA,UACA;AAAA,UACA;AAAA,UACA,iBAAiB,SAAS,QAAQ;AAAA;AAAA,MACnC;AAAA,MACC,SACA,gBAAAH;AAAA,QAAC;AAAA;AAAA,UACA,GAAG,aAAa;AAAA,UAChB,GAAGG,KAAI;AAAA,UACP,YAAW;AAAA,UACX,UAAU;AAAA,UACV,MAAM;AAAA,UAEL;AAAA;AAAA,MACF;AAAA,OAEF;AAAA,EAEF;AACA,QAAMC,KAAI,OAAO;AAAA,IAChB,iBAAiB,OAAO,QAAQ,IAAI,KAAK,KAAY;AAAA,EACtD;AACA,MAAI,OAAO,MAAMA,EAAC,EAAG,QAAO;AAC5B,SACC,gBAAAH,OAAC,OAAE,WAAU,8CAA6C,eAAW,MACpE;AAAA,oBAAAD;AAAA,MAAC;AAAA;AAAA,QACA,IAAII;AAAA,QACJ,IAAI;AAAA,QACJA;AAAA,QACA,IAAI;AAAA,QACJ;AAAA,QACA;AAAA,QACA,iBAAiB,SAAS,QAAQ;AAAA;AAAA,IACnC;AAAA,IACC,SACA,gBAAAJ,MAAC,UAAK,GAAGI,KAAI,GAAG,GAAG,IAAI,UAAU,IAAI,MAAM,QACzC,iBACF;AAAA,KAEF;AAEF;AAEA,IAAO,yBAAQ;;;ACrDZ,gBAAAC,aAAA;AArCH,IAAM,aAAa,CAAC,MAAuC;AAC1D,UAAQ,GAAG;AAAA,IACV,KAAK;AACJ,aAAO;AAAA,IACR,KAAK;AACJ,aAAO;AAAA,IACR,KAAK;AACJ,aAAO;AAAA,IACR,KAAK;AACJ,aAAO;AAAA,IACR;AACC,aAAO;AAAA,EACT;AACD;AAGO,IAAM,YAAsC,CAAC;AAAA,EACnD,cAAc;AAAA,EACd;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,UAAU;AAAA,EACV,KAAK;AACN,MAAM;AACL,QAAM,QAAQ,gBAAgB;AAC9B,QAAM,SAAS,gBAAgB;AAC/B,MAAI,CAAC,SAAS,CAAC,OAAQ,QAAO;AAC9B,QAAM,EAAE,YAAY,YAAY,IAAI;AACpC,QAAMC,SAAQ,QAAQ,WAAW,MAAM;AACvC,MAAI,gBAAgB,cAAc;AACjC,UAAM,KAAK,OAAO,OAAO,IAAI;AAC7B,UAAM,KAAK,OAAO,OAAO,EAAE;AAC3B,QAAI,CAAC,IAAI,EAAE,EAAE,KAAK,CAAC,MAAM,OAAO,MAAM,CAAC,CAAC,EAAG,QAAO;AAClD,UAAMC,KAAI,KAAK,IAAI,IAAI,EAAE;AACzB,UAAM,IAAI,KAAK,IAAI,KAAK,EAAE;AAC1B,WACC,gBAAAF;AAAA,MAAC;AAAA;AAAA,QACA,GAAG;AAAA,QACH,GAAGE;AAAA,QACH,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,MAAMD;AAAA,QACN;AAAA,QACA;AAAA;AAAA,IACD;AAAA,EAEF;AACA,QAAM,KAAK,OAAO,OAAO,gBAAgB,OAAO,OAAO,IAAI,KAAK,IAAW,CAAC;AAC5E,QAAM,KAAK,OAAO,OAAO,cAAc,OAAO,KAAK,IAAI,KAAK,EAAS,CAAC;AACtE,MAAI,CAAC,IAAI,EAAE,EAAE,KAAK,CAAC,MAAM,OAAO,MAAM,CAAC,CAAC,EAAG,QAAO;AAClD,QAAME,KAAI,KAAK,IAAI,IAAI,EAAE;AACzB,QAAM,IAAI,KAAK,IAAI,KAAK,EAAE;AAC1B,SACC,gBAAAH;AAAA,IAAC;AAAA;AAAA,MACA,GAAGG;AAAA,MACH,GAAG;AAAA,MACH,OAAO;AAAA,MACP,QAAQ;AAAA,MACR,MAAMF;AAAA,MACN;AAAA,MACA;AAAA;AAAA,EACD;AAEF;AAEA,IAAO,oBAAQ;;;ACnCb,gBAAAG,OAyCG,QAAAC,cAzCH;AA7BF,IAAMC,eAAc,CAAC,MAAuC;AAC3D,UAAQ,GAAG;AAAA,IACV,KAAK;AACJ,aAAO;AAAA,IACR,KAAK;AACJ,aAAO;AAAA,IACR,KAAK;AACJ,aAAO;AAAA,IACR,KAAK;AACJ,aAAO;AAAA,IACR;AACC,aAAO;AAAA,EACT;AACD;AAEA,SAAS,SAAS;AAAA,EACjB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACD,GAKG;AACF,QAAM,IAAI,OAAO;AACjB,QAAM,SAAS,GAAG,EAAE,IAAI,KAAK,CAAC,IAAI,KAAK,IAAI,IAAI,KAAK,IAAI,GAAG,IAAI,KAAK,IAAI,IAAI,KAAK,IAAI,GAAG;AACxF,SACC,gBAAAF,MAAC,aAAQ,QAAgB,MAAY,QAAO,QAAO,aAAa,KAAK;AAEvE;AAEA,SAAS,QAAQ;AAAA,EAChB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACD,GAKG;AACF,QAAM,SAAS,GAAG,EAAE,IAAI,KAAK,IAAI,IAAI,KAAK,IAAI,IAAI,EAAE,IAAI,EAAE,IAAI,KAAK,IAAI,IAAI,KAAK,IAAI,IAAI,EAAE;AAC1F,SACC,gBAAAA,MAAC,aAAQ,QAAgB,MAAY,QAAO,QAAO,aAAa,KAAK;AAEvE;AAGO,IAAM,eAA4C,CAAC;AAAA,EACzD;AAAA,EACA,QAAQ;AAAA,EACR,OAAO;AACR,MAAM;AACL,QAAM,QAAQ,gBAAgB;AAC9B,QAAM,SAAS,gBAAgB;AAC/B,MAAI,CAAC,SAAS,CAAC,UAAU,CAAC,OAAO,OAAQ,QAAO;AAEhD,QAAM,OAAO,CAACG,OAAYA,cAAa,OAAOA,KAAI,IAAI,KAAKA,EAAC;AAC5D,SACC,gBAAAH,MAAC,OAAE,WAAU,qBAAoB,eAAW,MAC1C,iBAAO,IAAI,CAAC,GAAG,MAAM;AACrB,UAAM,KAAK,OAAO,OAAO,KAAK,EAAE,CAAC,CAAC;AAClC,UAAM,KAAK,EAAE,MAAM,SAAY,KAAK,IAAI,IAAI,EAAE,IAAI,OAAO,OAAO,EAAE,CAAC;AACnE,UAAM,OAAOE,aAAY,EAAE,MAAM;AACjC,UAAM,MAAM,MAAM,CAAC;AACnB,QAAI,OAAO,MAAM,EAAE,KAAK,OAAO,MAAM,EAAE,EAAG,QAAO;AACjD,WACC,gBAAAD,OAAC,OACC;AAAA,gBAAU,aACV,gBAAAD,MAAC,YAAS,IAAQ,IAAQ,MAAY,MAAY,IAC/C,UAAU,YACb,gBAAAA,MAAC,WAAQ,IAAQ,IAAQ,MAAY,MAAY,IAEjD,gBAAAA;AAAA,QAAC;AAAA;AAAA,UACA;AAAA,UACA;AAAA,UACA,GAAG;AAAA,UACH;AAAA,UACA,QAAO;AAAA,UACP,aAAa;AAAA;AAAA,MACd;AAAA,MAEA,EAAE,SACF,gBAAAA;AAAA,QAAC;AAAA;AAAA,UACA,GAAG,KAAK,OAAO;AAAA,UACf,GAAG,KAAK,OAAO;AAAA,UACf,UAAU;AAAA,UACV;AAAA,UAEC,YAAE;AAAA;AAAA,MACJ;AAAA,SAvBM,GAyBR;AAAA,EAEF,CAAC,GACF;AAEF;AAEA,IAAO,uBAAQ;;;ACxHf,YAAYI,aAAW;AA+Df,gBAAAC,OASF,QAAAC,cATE;AA3BD,IAAM,gBAA8C,CAAC;AAAA,EAC1D;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,UAAU;AAAA,EACV,gBAAgB;AAClB,MAAM;AACJ,QAAM,WAAiB,cAAM;AAC7B,QAAM,aAAa,MAAM;AACzB,QAAM,SAAS,cAAc,GAAG,UAAU,UAAU;AACpD,QAAM,WAAW,SAAS,GAAG,UAAU,SAAS;AAGhD,QAAM,aAAa,OAAO,WAAW,eAAe,CAAC;AAErD,SACE,gBAAAA;AAAA,IAAC;AAAA;AAAA,MACC,IAAI;AAAA,MACJ,WAAW,aAAK,iCAAiC,SAAS;AAAA,MAC1D,mBAAiB,GAAG,UAAU;AAAA,MAC9B,oBAAkB,aAAK,QAAQ,QAAQ;AAAA,MACvC,kBAAe;AAAA,MAEf;AAAA,wBAAAD,MAAC,YAAO,WAAU,qBAChB,0BAAAA,MAAC,QAAG,IAAI,GAAG,UAAU,UAAU,WAAU,oBAAoB,iBAAM,GACrE;AAAA,QACC,eACC,gBAAAA,MAAC,OAAE,IAAI,QAAQ,WAAU,0BAA0B,uBAAY;AAAA,QAGhE,CAAC,cACA,gBAAAA,MAAC,SAAI,WAAU,sBAAqB,MAAK,UAAS,aAAU,UAAU,mBAAQ;AAAA,QAEhF,gBAAAC,OAAC,SAAI,WAAU,uBAAsB,MAAK,SAAQ,cAAY,OAE5D;AAAA,0BAAAD,MAAC,cACC,0BAAAA,MAAC,SAAI,WAAU,+BACb,0BAAAA,MAAC,iBAAO,GAAG,OAAO,GACpB,GACF;AAAA,UAEA,gBAAAA,MAAC,SAAI,WAAU,oBAAmB,uBAAmB,MACnD,0BAAAA,MAAC,iBAAO,GAAG,OAAO,GACpB;AAAA,WACF;AAAA,QACE,UACA,gBAAAA,MAAC,gBAAW,WAAU,sBACnB,oBACC,gBAAAC,OAAC,WAAM,IAAI,UAAU,WAAU,qBAAoB;AAAA;AAAA,UAAS;AAAA,WAAO,GAEvE;AAAA;AAAA;AAAA,EAEJ;AAEJ;AAEA,IAAO,wBAAQ;;;AC/Ff,YAAYC,aAAW;AAwDd,gBAAAC,aAAA;AA3BT,IAAM,gBAA8C,CAAC,EAAE,WAAW,oBAAoB,YAAY,QAAQ,GAAG,SAAS,MAAM;AAC1H,QAAM,MAAY,eAA8B,IAAI;AAEpD,EAAM,kBAAU,MAAM;AACpB,UAAM,OAAO,IAAI;AACjB,QAAI,CAAC,KAAM;AACX,UAAM,QAAQ,MAAM;AAClB,YAAM,UAAU,MAAM,KAAK,KAAK,iBAA8B,QAAQ,CAAC;AACvE,UAAI,QAAQ,WAAW,EAAG;AAC1B,YAAM,gBAA+B,CAAC;AACtC,cAAQ,QAAQ,SAAO;AACrB,YAAI,CAAC,IAAI,UAAU,SAAS,qBAAqB,GAAG;AAClD,cAAI,UAAU,IAAI,qBAAqB;AACvC,wBAAc,KAAK,GAAG;AAAA,QACxB;AAAA,MACF,CAAC;AACD,UAAI,cAAc,UAAU,WAAY,YAAW,aAAa;AAAA,IAClE;AACA,QAAI,QAAQ,GAAG;AAEb,UAAI,OAAO,WAAW,YAAa;AACnC,YAAM,IAAI,OAAO,WAAW,OAAO,KAAK;AACxC,aAAO,MAAM,OAAO,aAAa,CAAC;AAAA,IACpC;AACA,UAAM;AAAA,EACR,GAAG,CAAC,UAAU,YAAY,KAAK,CAAC;AAEhC,SAAO,gBAAAA,MAAC,SAAI,KAAW,UAAS;AAClC;AAEA,IAAO,wBAAQ;;;AC3Df,YAAYC,aAAW;AA2JnB,SAqBI,YAAAC,WApBH,OAAAC,OADD,QAAAC,cAAA;AAlFG,IAAM,aAAwC,CAAC;AAAA,EACrD;AAAA,EACA;AAAA,EACA,MAAAC;AAAA,EACA;AAAA,EACA,SAAS;AAAA,EACT,UAAU;AAAA,EACV;AAAA,EACA;AAAA,EACA;AAAA,EACA,UAAU;AAAA,EACV;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,gBAAgB;AACjB,MAAM;AACL,QAAM,aAAmB,cAAM;AAC/B,QAAM,SAAS,MAAM;AACrB,QAAM,UAAU,GAAG,MAAM;AACzB,QAAM,UAAU,GAAG,MAAM;AACzB,QAAM,UAAU,GAAG,MAAM;AAEzB,QAAMC,YAAW,OAAO,UAAU,YAAY,CAAC,OAAO,MAAM,KAAK;AACjE,QAAM,iBAAiB,UACpB,WACA,QACC,KACAA,YACC,iBACC,eAAe,KAAe,IAC7B,MAAiB,eAAe,IAClC;AAEL,MAAI;AACJ,MAAI,cAAc;AAClB,MAAI,YAAY;AAChB,MAAI,SAAS,CAAC,WAAW,CAAC,OAAO;AAChC,qBACC,MAAM,cACL,MAAM,QAAQ,IAAI,OAAO,MAAM,QAAQ,IAAI,SAAS;AACtD,UAAM,SAAS,KAAK,IAAI,MAAM,KAAK;AACnC,UAAM,gBACL,mBAAmB,OAChB,IAAI,MAAM,KACV,mBAAmB,SAClB,IAAI,MAAM,KACV;AACL,UAAM,SAAS,MAAM,YAAY,MAAM;AAEvC,kBAAc,GAAG,aAAa,GAAG,MAAM;AACvC,QAAI,MAAM,WAAW;AACpB,kBAAY,MAAM;AAAA,IACnB,OAAO;AACN,YAAM,SAAS,MAAM,SAClB,mBAAmB,SACnB,mBAAmB;AACtB,YAAM,UACL,mBAAmB,YAChB,cACA,mBAAmB,OAClB,OACA;AACL,kBAAY,GAAG,OAAO,IAAI,MAAM,GAAG,MAAM,GAAG,mBAAmB,YAAY,KAAK,SAAS,mBAAmB,UAAU;AAAA,IACvH;AAAA,EACD;AAEA,SACC,gBAAAH;AAAA,IAAC;AAAA;AAAA,MACA,WAAW;AAAA,QACV;AAAA,QACA,WAAW,oBAAoB,OAAO;AAAA,QACtC,UAAU,2BAA2B,MAAM;AAAA,QAC3C,WAAW;AAAA,QACX,SAAS;AAAA,QACT;AAAA,MACD;AAAA,MACA,MAAK;AAAA,MACL,mBAAiB;AAAA,MACjB,kBAAe;AAAA,MAEf,0BAAAC,OAAC,SAAI,WAAU,0BACd;AAAA,wBAAAA,OAAC,SAAI,WAAU,2BACd;AAAA,0BAAAD,MAAC,QAAG,IAAI,SAAS,WAAU,0BACzB,iBACF;AAAA,UACC,YACA,gBAAAA,MAAC,SAAI,WAAU,6BAA6B,oBAAS;AAAA,WAEvD;AAAA,QAEA,gBAAAC,OAAC,SAAI,WAAU,4BACd;AAAA,0BAAAA,OAAC,SAAI,WAAU,kCACd;AAAA,4BAAAD,MAAC,SAAI,IAAI,SAAS,WAAU,0BAC1B,oBACA,gBAAAA,MAAC,SAAI,WAAU,6BAA4B,eAAY,QACtD,0BAAAA,MAAC,SAAI,WAAU,wEAAuE,GACvF,IACG,QACH,gBAAAA,MAAC,SAAI,WAAU,0BAAyB,MAAK,SAC3C,iBACF,IAEA,gBAAAC,OAAAF,WAAA,EACC;AAAA,8BAAAC,MAAC,UAAK,WAAU,2BACd,0BACF;AAAA,cACCE,SACA,gBAAAF,MAAC,UAAK,WAAU,yBAAyB,UAAAE,OAAK;AAAA,eAEhD,GAEF;AAAA,YAEC,YAAY,CAAC,WAAW,CAAC,SACzB,gBAAAF,MAAC,SAAI,WAAU,6BAA6B,oBAAS;AAAA,aAEvD;AAAA,UAEC,SAAS,CAAC,WAAW,CAAC,SACtB,gBAAAA,MAAC,SAAI,WAAU,kCACd,0BAAAC;AAAA,YAAC;AAAA;AAAA,cACA,IAAI;AAAA,cACJ,cAAY;AAAA,cACZ,WAAW;AAAA,gBACV;AAAA,gBACA,kBAAkB,2BAA2B,cAAc;AAAA,cAC5D;AAAA,cAEA;AAAA,gCAAAD,MAAC,UAAK,WAAU,gCACd,uBACF;AAAA,gBACC,MAAM,UACN,gBAAAA,MAAC,UAAK,WAAU,iCACd,gBAAM,QACR;AAAA;AAAA;AAAA,UAEF,GACD;AAAA,UAGA,aAAa,UAAU,SAAS,KAAK,CAAC,WAAW,CAAC,SAClD,gBAAAA,MAAC,SAAI,WAAU,0BAAyB,eAAY,QAEpD;AAAA,WAEF;AAAA,QAEC,iBAAiB,SAAS,CAAC,MAAM,aAAa,CAAC,WAAW,CAAC,SAC3D,gBAAAA,MAAC,SAAI,WAAU,uBAAsB,aAAU,UAC7C,qBACF;AAAA,SAEF;AAAA;AAAA,EACD;AAEF;AAEA,IAAO,qBAAQ;;;ACvOf,YAAYI,aAAW;;;ACchB,SAAS,YAAY,OAA0C;AACpE,QAAM,EAAE,OAAAC,SAAQ,WAAW,UAAU,UAAU,UAAU,UAAU,IAAI;AACvE,QAAM,UAAU;AAAA,IACd;AAAA,IACAA,WAAU,YAAY,cAAcA,MAAK,KAAK;AAAA,IAC9C,WAAW,yBAAyB;AAAA,IACpC,WAAW,wBAAwB;AAAA,IACnC,WAAW,wBAAwB;AAAA,IACnC,aAAa;AAAA,EACf,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG;AAC1B,SAAO,EAAE,SAAS,WAAW,CAAC,CAAC,UAAU,UAAU,CAAC,CAAC,SAAS;AAChE;;;ACGE,SAKE,OAAAC,OALF,QAAAC,cAAA;AAvBK,IAAM,MAA0B,CAAC;AAAA,EACvC;AAAA,EACA;AAAA,EACA;AAAA,EACA,OAAAC,SAAQ;AAAA,EACR,WAAW;AAAA,EACX,WAAW;AAAA,EACX;AAAA,EACA,WAAW;AAAA,EACX;AAAA,EACA,GAAG;AACJ,MAAM;AACL,QAAM,QAAQ,YAAY,EAAE,OAAAA,QAAO,UAAU,UAAU,UAAU,UAAU,CAAC;AAE5E,QAAM,cAAc,CAAC,MAAwB;AAC5C,MAAE,eAAe;AACjB,MAAE,gBAAgB;AAClB,QAAI,CAAC,YAAY,SAAS;AACzB,cAAQ;AAAA,IACT;AAAA,EACD;AAEA,SACC,gBAAAD,OAAC,YAAO,WAAW,MAAM,SAAU,GAAG,OAEpC;AAAA,eACA,WACG,OACH,gBAAAD,MAAC,UAAK,yBAAyB,EAAE,QAAQ,KAAK,GAAG,IAEjD;AAAA,IAIA,YACA,gBAAAA;AAAA,MAAC;AAAA;AAAA,QACA,MAAK;AAAA,QACL,WAAU;AAAA,QACV,SAAS;AAAA,QACT;AAAA,QACA,cAAW;AAAA,QACX,OAAM;AAAA,QACN;AAAA;AAAA,IAED;AAAA,KAEF;AAEF;;;ACpDA,IAAAG,qBAAuB;AADvB,SAAgB,YAAAC,kBAA2B;;;ACA3C,SAAgB,YAAAC,YAAU,aAAAC,kBAAiB;;;ACmBpC,SAAS,cAAc,GAA2C;AACvE,QAAM,OAAO,EAAE,QAAQ;AACvB,QAAM,UAAU,SAAS;AACzB,QAAM,UAAU;AAAA,IACd;AAAA,IACA,EAAE,WAAW,uBAAuB;AAAA,IACpC,UAAU,uBAAuB;AAAA,IAChC,CAAC,WAAW,EAAE,SAAS,EAAE,UAAU,SAAU,sBAAsB,EAAE,KAAK,KAAK;AAAA,IAChF,EAAE,aAAa;AAAA,EACjB,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG;AAC1B,SAAO,EAAE,SAAS,QAAQ;AAC5B;;;ADmEI,gBAAAC,OAcI,QAAAC,cAdJ;AA5FG,IAAM,QAA8B,CAAC;AAAA,EAC1C;AAAA,EACA;AAAA,EACA,OAAO;AAAA,EACP;AAAA,EACA;AAAA,EACA;AAAA,EACA,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX,WAAW;AAAA,EACX;AAAA,EACA;AAAA,EACA,QAAQ;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,kBAAkB;AAAA,EAClB,mBAAmB;AAAA,EACnB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,GAAG;AACL,MAAM;AACJ,QAAM,CAAC,cAAc,eAAe,IAAIC,WAAS,SAAS,iBAAiB,SAAS,UAAU,OAAO,MAAM,GAAG;AAE9G,EAAAC,WAAU,MAAM;AACd,QAAI,UAAU,QAAW;AACvB,sBAAgB,KAAK;AAAA,IACvB;AAAA,EACF,GAAG,CAAC,KAAK,CAAC;AAEV,QAAM,eAAe,CAAC,UAAuF;AAC3G,UAAM,KAAK,MAAM;AACjB,oBAAgB,GAAG,KAAK;AAExB,QAAI,UAAU,SAAU,MAAc,aAAa;AACjD,2CAAW;AAAA,IACb,WAAW,MAAM,SAAS,WAAW;AACnC,2CAAW;AAAA,IACb;AAAA,EACF;AAEA,QAAM,EAAE,SAAS,cAAc,QAAQ,IAAI,cAAc,EAAE,IAAI,MAAM,MAAM,UAAU,OAAO,UAAU,CAAC;AAEvG,QAAM,eAAe,UAAU;AAC/B,QAAM,mBAAmB;AAAA,IACvB;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,oBAAoB;AAAA,IACpB;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,UAAU;AAAA,IACV;AAAA,IACA;AAAA,IACA,WAAW,CAAC,MAA6C;AAEvD,UAAI,WAAW,QAAQ,KAAK,EAAE,GAAG,GAAG;AAClC,cAAM,SAAQ,6CAAc,eAAc,MAAM,EAAE;AAClD,QAAC,EAAE,OAA4B,QAAQ;AACvC,qBAAa,CAAC;AAAA,MAChB;AACA,6CAAY;AAAA,IACd;AAAA,IACA,GAAG;AAAA,EACL;AAGA,QAAM,yBAA0B,CAAC,gBAAgB,iBAAiB,SAC9D,EAAE,aAAa,IACf,CAAC;AACL,QAAM,uBAAuB,eAAe,EAAE,MAAM,IAAI,CAAC;AAEzD,QAAM,mBAAmB,MACvB,gBAAAH;AAAA,IAAC;AAAA;AAAA,MACC,WAAW;AAAA,MAEV,GAAG;AAAA,MACH,GAAG;AAAA,MAEJ,sBAAoB;AAAA,MACnB,GAAG;AAAA;AAAA,EACN;AAGF,QAAM,eAAe,UACnB,gBAAAC,OAAC,SAAI,WAAU,6BACZ;AAAA,uBACC,gBAAAA,OAAC,SAAI,WAAU,4BACb;AAAA,sBAAAD,MAAC,UAAK,WAAU,wDACb,sDAAa,QAAO,OAAO,KAC9B;AAAA,MACC,iBAAiB;AAAA,MAClB,gBAAAA,MAAC,UAAK,WAAU,wDACb,sDAAa,QAAO,OAAO,OAC9B;AAAA,OACF;AAAA,IAED,CAAC,mBAAmB,iBAAiB;AAAA,IACrC,oBACC,gBAAAA,MAAC,SAAI,WAAU,mCACb,0BAAAC,OAAC,UAAK,WAAU,mCACb;AAAA,kDAAa,YAAW;AAAA,MAAiB;AAAA,MAAC,gBAAAD,MAAC,YAAQ,wBAAa;AAAA,OACnE,GACF;AAAA,KAEJ,IACE;AAEJ,MAAI,SAAS;AACX,WAAO;AAAA,EACT;AAEA,SACE,gBAAAA;AAAA,IAAC;AAAA;AAAA,MACC,WAAW;AAAA,MACX;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACC,GAAI,UAAU,UAAa,iBAAiB,SAAY,EAAE,aAAa,IAAI,CAAC;AAAA,MAC7E;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA,oBAAkB;AAAA,MAClB;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACC,GAAG;AAAA;AAAA,EACN;AAEJ;;;AErJO,SAAS,cAAc,OAA8C;AAC1E,QAAM,OAAO,MAAM,QAAQ;AAC3B,QAAM,UAAU;AAAA,IACd;AAAA,IACA,SAAS,MAAM,gBAAgB,IAAI,KAAK;AAAA,IACxC,MAAM,aAAa;AAAA,EACrB,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG;AAC1B,SAAO;AAAA,IACL,KAAK,MAAM,gBAAgB,OAAO;AAAA,IAClC;AAAA,IACA;AAAA,IACA,SAAS,MAAM,gBAAgB,SAAY,MAAM;AAAA,IACjD,eAAe,CAAC,CAAC,MAAM;AAAA,EACzB;AACF;;;ACVQ,gBAAAI,aAAA;AAdD,IAAM,QAA8B,CAAC;AAAA,EAC1C;AAAA,EACA;AAAA,EACA,gBAAgB;AAAA,EAChB,OAAO;AAAA,EACP;AAAA,EACA,GAAG;AACL,MAAM;AACJ,QAAM,QAAQ,cAAc,EAAE,MAAM,eAAe,WAAW,QAAQ,CAAC;AACvE,QAAM,eAAe,MAAM;AAE3B,SACA,gBAAAA,MAAC,gBAAa,WAAW,MAAM,SAAS,SAAS,MAAM,SAAU,GAAG,OAC/D,0BACC,gBAAAA,MAAC,WAAM,WAAU,uBAAsB,SACpC,UACH,IAEA,UAEJ;AAEJ;;;ACNO,SAAS,iBAAiB,OAAoD;AArBrF,MAAAC;AAsBE,QAAM,kBAAkB,CAAC,kBAAkB,MAAM,aAAa,EAAE,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG;AAC1F,QAAM,gBAAgB,MAAM,SACxB;AAAA,IACE;AAAA,IACA,MAAM,OAAO,OAAO,2BAA2B,MAAM,OAAO,IAAI,KAAK;AAAA,IACrE,MAAM,OAAO,aAAa;AAAA,EAC5B,EACG,OAAO,OAAO,EACd,KAAK,GAAG,IACX;AACJ,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA,qBAAqB,CAAC,GAACA,MAAA,MAAM,WAAN,gBAAAA,IAAc;AAAA,IACrC,aAAa,MAAM;AAAA,EACrB;AACF;;;ACZG,gBAAAC,OAaD,QAAAC,cAbC;AArBI,IAAM,WAAoC,CAAC;AAAA,EACjD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,GAAG;AACJ,MAAM;AACL,QAAM,QAAQ,iBAAiB;AAAA,IAC9B;AAAA,IACA;AAAA,IACA,QAAQ,SACL;AAAA,MACA,MAAM,OAAO;AAAA,MACb,WAAW,OAAO;AAAA,MAClB,eAAe,OAAO;AAAA,IACvB,IACC;AAAA,EACJ,CAAC;AAED,QAAM,sBAAsB,MAAM;AACjC,UAAM,WAAU,iCAAQ,QACvB,gBAAAD,MAAC,UAAK,yBAAyB,EAAE,QAAQ,OAAO,KAAK,GAAG,IAExD,iCAAQ;AAGT,QAAI,MAAM,qBAAqB;AAC9B,aAAO,gBAAAA,MAAC,QAAG,WAAU,2BAA2B,mBAAQ;AAAA,IACzD;AAEA,WAAO;AAAA,EACR;AAEA,SACC,gBAAAC;AAAA,IAAC;AAAA;AAAA,MACA,WAAW,MAAM;AAAA,MACjB,oBAAkB,MAAM;AAAA,MACvB,GAAG;AAAA,MAEH;AAAA,mBAAW,OAAO,QAAQ,OAAO,SACjC,gBAAAD,MAAC,YAAO,WAAW,MAAM,eAAgB,8BAAoB,GAAE;AAAA,QAE/D;AAAA;AAAA;AAAA,EACF;AAEF;;;ACvCO,SAAS,mBAAmB,OAAwD;AACzF,QAAM,UAAU;AAAA,IACd;AAAA,IACA,MAAM,QAAQ,4BAA4B;AAAA,IAC1C,MAAM,aAAa;AAAA,EACrB,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG;AAC1B,QAAM,mBAAmB;AAAA,IACvB;AAAA,IACA,MAAM,WAAW,4BAA4B;AAAA,EAC/C,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG;AAC1B,SAAO,EAAE,SAAS,iBAAiB;AACrC;;;APwDU,gBAAAE,OAoCM,QAAAC,cApCN;AAlDH,IAAM,aAAwC,CAAC;AAAA,EACpD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,gBAAgB;AAAA,EAChB,aAAa;AAAA,EACb;AAAA,EACA;AAAA,EACA,YAAY;AAAA,EACZ,QAAQ;AAAA,EACR;AAAA,EACA;AAAA,EACA;AAAA,EACA,GAAG;AACL,MAAM;AACJ,QAAM,CAAC,gBAAgB,iBAAiB,IAAIC;AAAA,IAC1C,MAAM,OAAO,UAAQ,KAAK,OAAO,EAAE,IAAI,UAAQ,KAAK,KAAK;AAAA,EAC3D;AAGA,QAAM,gBAAgB,YAAY;AAClC,QAAM,SAAS,OAAO,GAAG,aAAa,UAAU;AAChD,QAAM,UAAU,eAAe,GAAG,aAAa,WAAW;AAC1D,QAAM,cAAc,CAAC,QAAQ,OAAO,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG,KAAK;AAEnE,QAAM,uBAAuB,CAAC,OAAe,YAAqB;AAChE,QAAI;AAEJ,QAAI,SAAS;AACX,kBAAY,CAAC,GAAG,gBAAgB,KAAK;AAAA,IACvC,OAAO;AACL,kBAAY,eAAe,OAAO,OAAK,MAAM,KAAK;AAAA,IACpD;AAEA,sBAAkB,SAAS;AAE3B,yCAAW;AAAA,EACb;AAGA,QAAM,cAAc,MAAM;AACxB,WAAO,MAAM,IAAI,CAAC,MAAM,UAAU;AAChC,YAAM,SAAS,GAAG,aAAa,IAAI,QAAQ,CAAC;AAC5C,YAAM,gBAAgB,GAAG,MAAM;AAC/B,YAAM,YAAY,eAAe,SAAS,KAAK,KAAK;AACpD,YAAM,aAAa,KAAK,YAAY;AAEpC,aACE,gBAAAD,OAAC,SAAqB,WAAU,0BAC9B;AAAA,wBAAAD;AAAA,UAAC;AAAA;AAAA,YACC,WAAU;AAAA,YACV,IAAI;AAAA,YACJ;AAAA,YACA,MAAK;AAAA,YACL,OAAO,KAAK;AAAA,YACZ,SAAS;AAAA,YACT,UAAU;AAAA,YACV,UAAU,CAAC,MAAM,qBAAqB,KAAK,OAAO,EAAE,OAAO,OAAO;AAAA,YAClE,oBAAkB,KAAK,OAAO,GAAG,MAAM,UAAU;AAAA,YAChD,GAAI,KAAK,eAAe;AAAA,cACvB,iBAAiB;AAAA,cACjB,iBAAiB,YAAY,SAAS;AAAA,YACxC;AAAA,YACC,GAAG,KAAK;AAAA;AAAA,QACX;AAAA,QACA,gBAAAA,MAAC,WAAM,WAAU,2BAA0B,SAAS,QACjD,eAAK,MACR;AAAA,QACC,KAAK,QACJ,gBAAAA,MAAC,SAAI,IAAI,GAAG,MAAM,SAAS,WAAU,0BAClC,eAAK,MACR;AAAA,QAED,KAAK,eACJ,gBAAAA;AAAA,UAAC;AAAA;AAAA,YACC,eAAW,mBAAAG,SAAW,iCAAiC;AAAA,cACrD,yCAAyC,CAAC;AAAA,YAC5C,CAAC;AAAA,YACD,IAAI;AAAA,YAEH,iBAAO,KAAK,gBAAgB,YAC5B,KAAK,gBAAgB,QACrB,WAAW,KAAK,eAChB,QAAQ,KAAK,eACb,UAAU,KAAK,cACd,gBAAAF,OAAC,SAAI,OAAO,EAAE,WAAW,OAAO,GAC5B;AAAA,mBAAK,YAAyC,SAC9C,gBAAAD,MAAC,SAAM,SAAU,KAAK,YAAyC,IAC3D,eAAK,YAAyC,OAClD;AAAA,cAEF,gBAAAA,MAAC,SAAO,GAAI,KAAK,aAA0C;AAAA,eAC7D,IAEA,KAAK;AAAA;AAAA,QAET;AAAA,WAhDM,KAAK,KAkDf;AAAA,IAEJ,CAAC;AAAA,EACH;AAEA,QAAM,EAAE,SAAS,mBAAmB,iBAAiB,IAAI,mBAAmB,EAAE,OAAO,WAAW,UAAU,CAAC,CAAC,aAAa,CAAC;AAE1H,SACE,gBAAAA,MAAC,SAAI,WAAW,kBAAmB,GAAG,YAAa,GAAG,OACpD,0BAAAC;AAAA,IAAC;AAAA;AAAA,MACC,QAAQ,SAAS;AAAA,QACf,MAAM;AAAA,QACN;AAAA,QACA,MAAM;AAAA,MACR,IAAI;AAAA,MACJ;AAAA,MACC,GAAG;AAAA,MAEH;AAAA,gBACC,gBAAAD,MAAC,SAAI,IAAI,QAAQ,WAAU,cACxB,gBACH;AAAA,QAGD,gBACC,gBAAAC,OAAC,SAAI,IAAI,SAAS,WAAU,uBAC1B;AAAA,0BAAAD,MAAC,UAAK,WAAU,2BAA0B,oBAAM;AAAA,UAAO;AAAA,UAAE;AAAA,WAC3D;AAAA,QAGF,gBAAAA,MAAC,SAAI,WAAW,mBACb,sBAAY,GACf;AAAA;AAAA;AAAA,EACF,GACF;AAEJ;AAEA,WAAW,cAAc;;;AQrKzB,SAAgB,YAAAI,YAAU,UAAAC,SAAQ,eAAAC,oBAAmB;;;ACCrD,IAAAC,qBAAuB;;;ACYhB,SAAS,eAAe,OAAgD;AAC7E,QAAM,UAAU;AAAA,IACd;AAAA,IACA,MAAM,WAAW,wBAAwB;AAAA,IACzC,MAAM,SAAS,UAAU,wBAAwB;AAAA,IACjD,MAAM,SAAS,yBAAyB;AAAA,IACxC,MAAM,aAAa;AAAA,EACrB,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG;AAC1B,SAAO,EAAE,SAAS,aAAa,MAAM,YAAY;AACnD;;;ADqDO,gBAAAC,OA6CG,QAAAC,cA7CH;AAlDA,SAAS,mBACf,OACA;AAAA,EACC;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACE;AACH,GACC;AAED,QAAM;AAAA,IACL,UAAU;AAAA,IACV,QAAQ;AAAA,IACR,SAAS;AAAA,IACT,GAAG;AAAA,EACJ,IAAI;AACJ,QAAM;AAAA,IACL;AAAA,IACA,WAAW;AAAA,IACX;AAAA,IACA;AAAA,IACA,OAAO;AAAA,IACP,SAAS;AAAA,IACT;AAAA,IACA,GAAG;AAAA,EACJ,IAAI;AAEJ,QAAM,EAAE,SAAS,eAAe,aAAa,kBAAkB,IAC9D,eAAe,EAAE,UAAU,MAAM,QAAQ,WAAW,YAAY,CAAC;AAElE,SACC,gBAAAD,MAAC,YACA,0BAAAA;AAAA,IAAC;AAAA;AAAA,MACA,WAAW;AAAA,MACV,GAAG;AAAA,MACH,GAAI,sBAAsB,EAAE,sBAAsB,SAAS,IAAI,CAAC;AAAA,MAEhE,kBAAQ,IAAI,CAAC,QAAa,UAAkB;AAC5C,cAAM,UAAU,GAAG,IAAI,IAAI,KAAK;AAChC,cAAM,gBAAgB,OAAO,cAC1B,GAAG,OAAO,iBACV;AACH,cAAM,aAAa,kBAAkB,OAAO;AAC5C,eACC,gBAAAC,OAAC,SAAuB,WAAU,sBACjC;AAAA,0BAAAD;AAAA,YAAC;AAAA;AAAA,cACA,WAAU;AAAA,cACV,IAAI;AAAA,cACJ;AAAA,cACA,MAAK;AAAA,cACL,OAAO,OAAO;AAAA,cACd,UAAU,OAAO;AAAA,cAChB,GAAI,YAAY,WACd;AAAA,gBACA,SAAS;AAAA,gBACT,UAAU;AAAA,gBACV,QAAQ;AAAA,gBACR,SAAS;AAAA,gBACT,WAAW;AAAA,gBACX,KAAK,CAAC,OAAyB;AAC9B,sBAAI,MAAM,SAAU,UAAS,QAAQ,KAAK,IAAI;AAAA,gBAC/C;AAAA,cACD,IACC;AAAA,gBACA,gBAAgB;AAAA,gBAChB,yBAAyB;AAAA,cAC1B;AAAA,cACF,oBAAkB;AAAA;AAAA,UACnB;AAAA,UACA,gBAAAA,MAAC,WAAM,WAAU,uBAAsB,SAAS,SAC9C,iBAAO,MACT;AAAA,UACC,OAAO,QACP,gBAAAA,MAAC,SAAI,WAAU,sBAAsB,iBAAO,MAAK;AAAA,UAEjD,OAAO,eACP,gBAAAA;AAAA,YAAC;AAAA;AAAA,cACA,eAAW,mBAAAE,SAAW,6BAA6B;AAAA,gBAClD,qCAAqC,CAAC;AAAA,cACvC,CAAC;AAAA,cACD,IAAI;AAAA,cACH,GAAI,YAAY,WACd,EAAE,+BAA+B,KAAK,IACtC,CAAC;AAAA,cAEH,iBAAO,OAAO,gBAAgB,YAC/B,OAAO,gBAAgB,QACvB,WAAW,OAAO,eAClB,QAAQ,OAAO,eACf,UAAU,OAAO,cAChB,gBAAAD,OAAC,SAAI,OAAO,EAAE,WAAW,OAAO,GAC7B;AAAA,uBAAO,YAAsC,SAC9C,gBAAAD;AAAA,kBAAC;AAAA;AAAA,oBACA,SACE,OAAO,YAAsC;AAAA,oBAG7C,iBAAO,YAAsC;AAAA;AAAA,gBAChD;AAAA,gBAED,gBAAAA;AAAA,kBAAC;AAAA;AAAA,oBACC,GAAI,OAAO;AAAA;AAAA,gBACb;AAAA,iBACD,IAEC,OAAO;AAAA;AAAA,UAEV;AAAA,aA/DQ,OAAO,KAiEjB;AAAA,MAEF,CAAC;AAAA;AAAA,EACF,GACD;AAEF;;;AD5IO,IAAM,SAAgC,CAAC,EAAE,OAAO,cAAc,UAAU,QAAQ,SAAS,GAAG,KAAK,MAAM;AAC7G,QAAM,CAAC,eAAe,gBAAgB,IAAIG,WAAS,SAAS,gBAAgB,EAAE;AAC9E,QAAM,WAAWC,QAA2B,CAAC,CAAC;AAG9C,QAAM,eAAeA,QAAsB,aAAa;AACxD,QAAM,eAAe,CAAC,UAA+C;AACpE,UAAM,WAAW,MAAM,OAAO;AAC9B,QAAI,aAAa,aAAa,QAAS;AACvC,iBAAa,UAAU;AACvB,qBAAiB,QAAQ;AACzB,yCAAW;AAAA,EACZ;AAEA,QAAM,cAAc,CAAC,UAA8C;AAClE,uCAAU;AAAA,EACX;AAEA,QAAM,gBAAgBC,aAAY,CAAC,UAAiD;AACnF,UAAM,EAAE,IAAI,IAAI;AAChB,QAAI,CAAC,CAAC,aAAa,WAAW,cAAc,WAAW,EAAE,SAAS,GAAG,EAAG;AACxE,UAAM,eAAe;AACrB,UAAM,gBAAgB,SAAS,QAAQ,OAAO,CAAAC,OAAKA,MAAK,CAACA,GAAE,QAAQ;AACnE,UAAM,UAAU,cAAc,QAAQ,MAAM,aAAa;AACzD,QAAI,YAAY,GAAI;AACpB,QAAI,YAAY;AAChB,QAAI,CAAC,aAAa,YAAY,EAAE,SAAS,GAAG,EAAG,cAAa,UAAU,KAAK,cAAc;AAAA,aAChF,CAAC,WAAW,WAAW,EAAE,SAAS,GAAG,EAAG,cAAa,UAAU,IAAI,cAAc,UAAU,cAAc;AAClH,UAAM,YAAY,cAAc,SAAS;AACzC,QAAI,WAAW;AACd,gBAAU,MAAM;AAChB,UAAI,CAAC,UAAU,QAAS,WAAU,MAAM;AAAA,IACzC;AAAA,EACD,GAAG,CAAC,CAAC;AAEL,SAAO;AAAA,IACN,EAAE,OAAO,cAAc,UAAU,QAAQ,SAAS,GAAG,KAAK;AAAA,IAC1D;AAAA,MACC,SAAS;AAAA,MACT;AAAA,MACA,qBAAqB;AAAA,MACrB;AAAA,MACA,YAAY;AAAA,MACZ;AAAA;AAAA,MACA;AAAA,MACA;AAAA,MACA,gBAAgB;AAAA,IACjB;AAAA,EACD;AACD;;;AGrDA,IAAAC,qBAAuB;AADvB,OAAOC,aAAW;AAmChB,gBAAAC,aAAA;AAYK,IAAM,MAA0B,CAAC;AAAA,EACvC;AAAA,EACA;AAAA,EACA;AAAA,EACA,GAAG;AACJ,MAAM;AACL,QAAM,iBAAa,mBAAAC,SAAW,kBAAkB,SAAS;AAEzD,SACC,gBAAAC,MAAC,SAAI,WAAW,YAAY,OAAe,GAAG,OAC5C,UACF;AAEF;AAUO,IAAM,SAAgC,CAAC;AAAA,EAC7C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,aAAa;AAAA,EACb;AAAA,EACA;AAAA,EACA,GAAG;AACJ,MAAM;AACL,QAAM,oBAAgB,mBAAAD;AAAA,IACrB;AAAA;AAAA,MAEC,CAAC,qBAAqB,KAAK,EAAE,GAAG,CAAC;AAAA;AAAA,MAEjC,CAAC,WAAW,KAAK,EAAE,GAAG;AAAA;AAAA,MAEtB,CAAC,WAAW,WAAW,SAAS,GAAG,CAAC,CAAC;AAAA,MACrC,CAAC,WAAW,WAAW,SAAS,GAAG,CAAC,CAAC;AAAA,MACrC,CAAC,WAAW,YAAY,UAAU,GAAG,CAAC,CAAC;AAAA;AAAA,MAGvC,CAAC,2BAA2B,KAAK,EAAE,GAAG,SAAS,SAAS,KAAK,SAAS;AAAA;AAAA,MAEtE,GAAI,QAAQ,EAAE,CAAC,oBAAoB,KAAK,EAAE,GAAG,KAAK,IAAI,CAAC;AAAA,IACxD;AAAA,IACA;AAAA,EACD;AAEA,SACC,gBAAAC,MAAC,SAAI,WAAW,eAAe,OAAe,GAAG,OAC/C,UACF;AAEF;;;AC1GA,IAAAC,qBAAuB;AAmBV,gBAAAC,aAAA;AAfN,IAAM,YAAsC,CAAC;AAAA,EAClD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,GAAG;AACL,MAAM;AACJ,QAAM,uBAAmB,mBAAAC,SAAW,oBAAoB,SAAS;AAEjE,QAAM,gBAAgB,MAAM;AAC1B,QAAI,UAAU;AACZ,aAAO;AAAA,IACT;AAEA,QAAI,MAAM;AACR,aAAO,gBAAAD,MAAC,SAAI,yBAAyB,EAAE,QAAQ,KAAK,GAAG;AAAA,IACzD;AAEA,QAAI,MAAM;AACR,aAAO,gBAAAA,MAAC,OAAG,gBAAK;AAAA,IAClB;AAEA,WAAO;AAAA,EACT;AAEA,SACE,gBAAAA,MAAC,SAAI,WAAW,kBAAmB,GAAG,MACnC,wBAAc,GACjB;AAEJ;;;AClCA,IAAAE,qBAAuB;AAwBb,gBAAAC,OAwBJ,QAAAC,cAxBI;AApBH,IAAM,cAA0C,CAAC;AAAA,EACtD;AAAA,EACA,WAAW;AAAA,EACX;AAAA,EACA,GAAG;AACL,MAAM;AACJ,QAAM,yBAAqB,mBAAAC;AAAA,IAC5B;AAAA,IACA;AAAA,MACE,iCAAiC;AAAA,IACnC;AAAA,IACA;AAAA,EACC;AAEA,QAAM,gBAAgB,CAAC,YAA0E;AAClG,QAAI,QAAQ,UAAU;AACpB,aAAO,QAAQ;AAAA,IACjB;AAEA,QAAI,QAAQ,MAAM;AAChB,aAAO,gBAAAF,MAAC,UAAK,yBAAyB,EAAE,QAAQ,QAAQ,KAAK,GAAG;AAAA,IAClE;AAEA,QAAI,QAAQ,MAAM;AAChB,aAAO,QAAQ;AAAA,IACjB;AAEA,WAAO;AAAA,EACN;AAEA,QAAM,gBAAgB,CAAC,YAAwC;AAChE,QAAI,CAAC,WAAW,CAAC,QAAQ,MAAM,QAAQ;AACrC,aAAO;AAAA,IACT;AAEE,WAEC,gBAAAA,MAAC,QAAG,WAAU,+BACb,0BAAAA,MAAC,QAAG,WAAU,oCACb,kBAAQ,MAAM,IAAI,CAAC,QAAQ,gBAC3B,gBAAAA;AAAA,MAAC;AAAA;AAAA,QAED,WAAU;AAAA,QAEV,0BAAAC;AAAA,UAAC;AAAA;AAAA,YACA,MAAM,OAAO;AAAA,YACb,WAAU;AAAA,YACT,GAAG,OAAO;AAAA,YAEV;AAAA,4BAAc,MAAM;AAAA,cACpB,OAAO,sBACR,gBAAAD,MAAC,UAAK,WAAU,2BACd,iBAAO,oBACT;AAAA;AAAA;AAAA,QAED;AAAA;AAAA,MAdK;AAAA,IAeL,CACA,GACD,GACD;AAAA,EAGF;AAEF,SACC,gBAAAA,MAAC,SAAI,WAAU,gCACd,0BAAAA,MAAC,QAAG,WAAW,oBAAqB,GAAG,MACtC,gBAAM,IAAI,CAAC,MAAM,UACjB,gBAAAC,OAAC,SAAgB,WAAU,2BAC3B;AAAA,oBAAAD,MAAC,QAAG,WAAU,2BACZ,wBAAc,KAAK,GAAG,GACxB;AAAA,IACA,gBAAAA,MAAC,QAAG,WAAU,6BACZ,wBAAc,KAAK,KAAK,GAC1B;AAAA,IACC,cAAc,KAAK,OAAO;AAAA,OAPjB,KAQV,CACA,GACD,GACD;AAED;;;ACtCE,SAEE,OAAAG,OAFF,QAAAC,cAAA;AA5BK,IAAM,iBAAgD,CAAC;AAAA,EAC7D;AAAA,EACA;AAAA,EACA;AACD,MAAM;AACL,QAAM,YAA+B,MAAM,IAAI,CAAC,GAAG,OAAO;AAAA,IACzD,KAAK,EAAE,MAAM,EAAE,YAAY,EAAE,OAAO;AAAA,IACpC,OAAO,EAAE,MAAM,MAAM,QAAQ,EAAE,KAAK,IAAI,EAAE,MAAM,KAAK,IAAI,IAAI,EAAE,MAAM;AAAA,IACrE,SAAS,WACN;AAAA,MACD,OAAO;AAAA,QACL;AAAA,UACC,MAAM;AAAA,UACN,MAAM;AAAA,UACN,oBAAoB,EAAE,YAAY,EAAE;AAAA,UACpC,YAAY;AAAA,YACX,SAAS,CAAC,MAAW;AACpB,gBAAE,eAAe;AACjB,uBAAS,CAAC;AAAA,YACX;AAAA,UACD;AAAA,QACD;AAAA,MACD;AAAA,IACD,IACC;AAAA,EACJ,EAAE;AAEF,SACC,gBAAAA,OAAC,WAAM,cAAW,YAAW,OAAO,EAAE,UAAU,WAAW,GACzD;AAAA,uBACA,gBAAAD,MAAC,OAAE,OAAO,EAAE,WAAW,GAAG,cAAc,GAAG,GAAI,2BAAgB;AAAA,IAE/D,MAAM,SAAS,KAAK,gBAAAA,MAAC,eAAY,OAAO,WAAW;AAAA,KACrD;AAEF;AAEA,IAAO,yBAAQ;;;ACbT,gBAAAE,aAAA;AAzBC,IAAM,gBAA8C,CAAC,EAAE,OAAO,SAAS,MAAM;AAClF,QAAM,OAA0B,MAAM,IAAI,CAAC,GAAG,OAAO;AAAA,IACnD,KAAK,EAAE,MAAM,EAAE,YAAY,EAAE,OAAO;AAAA,IACpC,OAAO,EAAE,MAAM,MAAM,QAAQ,EAAE,KAAK,IAAI,EAAE,MAAM,KAAK,IAAI,IAAI,EAAE,MAAM;AAAA,IACrE,SAAS,WACL;AAAA,MACE,OAAO;AAAA,QACL;AAAA,UACE,MAAM;AAAA,UACN,MAAM;AAAA,UACN,oBAAoB,EAAE,YAAY,EAAE;AAAA,UACpC,YAAY;AAAA,YACV,SAAS,CAAC,MAAW;AACnB,gBAAE,eAAe;AACjB,uBAAS,CAAC;AAAA,YACZ;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAAA,IACF,IACA;AAAA,EACN,EAAE;AAEF,SACE,gBAAAA,MAAC,SACC,0BAAAA,MAAC,eAAY,OAAO,MAAM,GAQ5B;AAEJ;AAEA,IAAO,wBAAQ;;;ACtDR,SAAS,UAAU,OAAkB,UAA0B;AAFtE,MAAAC;AAGC,QAAM,OAAOA,MAAA,MAAc,YAAd,gBAAAA,IAAwB;AACrC,MAAI,CAAC,IAAK,OAAM,IAAI,MAAM,WAAW,QAAQ,aAAa;AAC1D,SAAO;AACR;AAEO,SAAS,QAAQ,KAAa,QAA4B;AARjE,MAAAA;AASC,QAAM,QAAOA,MAAA,IAAI,UAAJ,gBAAAA,IAAY;AACzB,MAAI,CAAC,KAAM,OAAM,IAAI,MAAM,SAAS,MAAM,aAAa;AACvD,SAAO;AACR;AAKO,SAAS,cAAc,MAAW,QAAkC;AAC1E,QAAM,SAAS,WAAW,QAAQ,KAAK,MAAM,KAAK;AAClD,MAAI,CAAC,OAAQ,QAAO,CAAC;AACrB,SAAO,EAAE,QAAQ,OAAO,MAAM,WAAW,OAAO,UAAU;AAC3D;AAKO,SAAS,qBAAqB,MAAW,OAA2B;AAC1E,QAAM,UAAU,KAAK,WAAW,CAAC,GAAG,KAAK,CAAC,MAAW,EAAE,UAAU,KAAK;AACtE,MAAI,CAAC,OAAQ,QAAO,CAAC;AACrB,SAAO,EAAE,QAAQ,OAAO,MAAM,WAAW,OAAO,UAAU;AAC3D;AAMO,SAAS,oBAAoB,MAAW,QAA8B;AAC5E,QAAM,YAAY,KAAK,WAAW,CAAC,GAAG;AAAA,IAAO,CAAC,MAC7C,OAAO,SAAS,EAAE,KAAK;AAAA,EACxB;AACA,MAAI,SAAS,WAAW,EAAG,QAAO,CAAC;AACnC,QAAM,MAAgB,SAAS;AAAA,IAC9B,CAAC,MAAY,EAAE,aAAsC,CAAC;AAAA,EACvD;AACA,QAAM,UAAU,MAAM;AAAA,IACrB,IAAI,IAAI,SAAS,IAAI,CAAC,MAAW,EAAE,IAAI,EAAE,OAAO,OAAO,CAAC;AAAA,EACzD;AACA,QAAM,SAAS,QAAQ,WAAW,IAAK,QAAQ,CAAC,IAAe;AAE/D,QAAM,YAAY,MAAM,KAAK,IAAI,IAAI,GAAG,CAAC;AACzC,SAAO,EAAE,QAAQ,UAAU;AAC5B;;;AnBiII,SAyDF,YAAAC,WAxDG,OAAAC,OADD,QAAAC,cAAA;AAjJJ,SAAS,cAAc,OAAoB,UAAkB;AAE5D,MAAI;AACH,WAAO,UAAe,OAAc,QAAQ;AAAA,EAC7C,QAAQ;AACP,WAAQ,MAAc,QAAQ,QAAQ;AAAA,EACvC;AACD;AAEA,SAASC,SAAQ,OAAoB,UAAkB,QAAsB;AAC5E,MAAI;AACH,WAAO,QAAa,cAAc,OAAO,QAAQ,GAAU,MAAM;AAAA,EAClE,QAAQ;AACP,WAAQ,MAAc,QAAQ,QAAQ,EAAE,MAAM,MAAM;AAAA,EACrD;AACD;AAEA,SAAS,WAAW;AACnB,SAAO,OAAO,WAAW;AAC1B;AAEO,IAAM,gBAA8C,CAAC;AAAA,EAC3D;AAAA,EACA,WAAW;AAAA,EACX,aAAa;AACd,MAAM;AACL,QAAM,MAAM,cAAc,OAAO,QAAQ;AACzC,QAAM,SAAiB,IAAI;AAO3B,QAAM,CAACC,OAAM,OAAO,IAAU,iBAAmB,CAAC,MAAM,CAAC;AACzD,QAAM,CAAC,SAAS,UAAU,IAAU,iBAAmB,CAAC,CAAC;AACzD,QAAM,CAAC,QAAQ,SAAS,IAAU,iBAA0B,IAAI;AAChE,QAAM,CAAC,eAAe,gBAAgB,IAAU,iBAAiB,EAAE;AACnE,QAAM,CAAC,gBAAgB,iBAAiB,IAAU,iBAAmB,CAAC,CAAC;AAEvE,EAAM,kBAAU,MAAM;AA3EvB,QAAAC;AA4EE,QAAI,CAAC,SAAS,EAAG;AACjB,QAAI;AACH,YAAM,MAAM,OAAO,aAAa,QAAQ,UAAU;AAClD,UAAI,KAAK;AACR,cAAM,SAAS,KAAK,MAAM,GAAG;AAC7B,YAAI,MAAM,QAAQ,OAAO,IAAI,KAAK,MAAM,QAAQ,OAAO,OAAO,GAAG;AAChE,kBAAQ,OAAO,IAAI;AACnB,qBAAW,OAAO,OAAO;AACzB,qBAAUA,MAAA,OAAO,WAAP,OAAAA,MAAiB,IAAI;AAAA,QAChC;AAAA,MACD;AAAA,IACD,QAAQ;AAAA,IAAC;AAAA,EACV,GAAG,CAAC,UAAU,CAAC;AAEf,EAAM,kBAAU,MAAM;AACrB,QAAI,CAAC,SAAS,EAAG;AACjB,WAAO,aAAa;AAAA,MACnB;AAAA,MACA,KAAK,UAAU,EAAE,MAAAD,OAAM,SAAS,OAAO,CAAC;AAAA,IACzC;AAAA,EACD,GAAG,CAACA,OAAM,SAAS,QAAQ,UAAU,CAAC;AAEtC,QAAM,YAAYA,MAAKA,MAAK,SAAS,CAAC;AACtC,QAAM,OAAOD,SAAQ,OAAO,UAAU,SAAS;AAI/C,EAAM,kBAAU,MAAM;AACrB,UAAM,OAAO,QAAQ,KAAK,CAAC,MAAM,EAAE,WAAW,SAAS;AACvD,QAAI,MAAM;AACT,UAAI,MAAM,QAAQ,KAAK,KAAK,GAAG;AAC9B,0BAAkB,KAAK,KAAK;AAC5B,yBAAiB,EAAE;AAAA,MACpB,OAAO;AACN,yBAAiB,KAAK,KAAK;AAC3B,0BAAkB,CAAC,CAAC;AAAA,MACrB;AAAA,IACD,OAAO;AACN,uBAAiB,EAAE;AACnB,wBAAkB,CAAC,CAAC;AAAA,IACrB;AAAA,EACD,GAAG,CAAC,SAAS,CAAC;AAGd,EAAM,kBAAU,MAAM;AACrB,QAAI,CAAC,SAAS,EAAG;AACjB,UAAM,QAAQ,EAAE,MAAAC,OAAM,SAAS,OAAO;AACtC,QAAI;AACH,aAAO,QAAQ,aAAa,OAAO,EAAE;AAAA,IACtC,QAAQ;AAAA,IAAC;AACT,UAAM,QAAQ,CAAC,MAAqB;AA9HtC,UAAAC;AA+HG,YAAM,KAAM,EAAE,SAAS,CAAC;AACxB,UAAI,MAAM,MAAM,QAAQ,GAAG,IAAI,KAAK,MAAM,QAAQ,GAAG,OAAO,GAAG;AAC9D,gBAAQ,GAAG,IAAI;AACf,mBAAW,GAAG,OAAO;AACrB,mBAAUA,MAAA,GAAG,WAAH,OAAAA,MAAa,IAAI;AAAA,MAC5B;AAAA,IACD;AACA,WAAO,iBAAiB,YAAY,KAAK;AACzC,WAAO,MAAM,OAAO,oBAAoB,YAAY,KAAK;AAAA,EAC1D,GAAG,CAAC,CAAC;AAGL,QAAM,mBAAyB,gBAAQ,MAAM;AA3I9C,QAAAA,KAAAC,KAAA;AA4IE,QAAI,cAAc,mBAAoB,QAAO;AAC7C,UAAM,WAAUD,MAAA,QAAQ,KAAK,CAAC,MAAM,EAAE,WAAW,iBAAiB,MAAlD,gBAAAA,IACb;AACH,UAAM,gBAA+B,MAAM,QAAQ,OAAO,IACvD,QAAQ,CAAC,KAAK,OACd,WAAW;AACd,QAAI,CAAC,cAAe,QAAO;AAC3B,UAAM,YAAY,cAChB,QAAQ,cAAc,EAAE,EACxB,KAAK,EACL,YAAY;AACd,UAAM,SAAS,MAAAC,MAAA,+BAAe,WAAf,gBAAAA,IAAuB,UAAvB,mBAA8B;AAG7C,QAAI,CAAC,MAAM,QAAQ,KAAK,EAAG,QAAO;AAClC,QAAI,OAAO,MAAM;AAAA,MAChB,CAAC,OACC,EAAE,SAAS,IACV,YAAY,EACZ,QAAQ,cAAc,EAAE,EACxB,KAAK,MAAM;AAAA,IACf;AACA,QAAI,CAAC,QAAQ,UAAU,SAAS,WAAW,GAAG;AAC7C,aAAO,MAAM,KAAK,CAAC,MAAM,EAAE,OAAO,WAAW;AAAA,IAC9C;AACA,QAAI,CAAC,KAAM,QAAO;AAClB,UAAM,aAAqC;AAAA,MAC1C,aAAa;AAAA,MACb,YAAY;AAAA,MACZ,WAAW;AAAA,MACX,QAAQ;AAAA,MACR,SAAS;AAAA,MACT,cAAc;AAAA,IACf;AACA,UAAM,UAAoB,KAAK,uBAAuB,CAAC,GACrD,IAAI,CAAC,MAAc,WAAW,CAAC,KAAK,CAAC,EACrC,OAAO,OAAO;AAChB,QAAI,OAAO,WAAW,KAAK,CAAC,KAAK,MAAO,QAAO;AAC/C,WACC,gBAAAJ,OAAC,aACA;AAAA,sBAAAA,OAAC,SACA;AAAA,wBAAAD,MAAC,YAAQ,yBAAc;AAAA,QAAS;AAAA,SACjC;AAAA,MACC,OAAO,SAAS,KAChB,gBAAAA,MAAC,QAAG,OAAO,EAAE,WAAW,EAAE,GACxB,iBAAO,IAAI,CAAC,MACZ,gBAAAA,MAAC,QAAY,eAAJ,CAAM,CACf,GACF;AAAA,MAEA,KAAK,SAAS,gBAAAA,MAAC,OAAE,OAAO,EAAE,WAAW,EAAE,GAAI,eAAK,OAAM;AAAA,OACxD;AAAA,EAEF,GAAG,CAAC,SAAS,WAAW,KAAK,CAAC;AAE9B,QAAM,mBAAmB,CACxB,UACA,aACA,eACI;AACJ,QAAI,CAAC,SAAS,EAAG;AACjB,UAAM,QAAQ,EAAE,MAAM,UAAU,SAAS,aAAa,QAAQ,WAAW;AACzE,QAAI;AACH,aAAO,QAAQ,UAAU,OAAO,EAAE;AAAA,IACnC,QAAQ;AAAA,IAAC;AAAA,EACV;AACA,QAAM,SAAS,MAAM;AAEpB,QAAI,QAAQ;AACX,gBAAU,IAAI;AACd,iBAAW,CAAC,MAAO,EAAE,SAAS,IAAI,EAAE,MAAM,GAAG,EAAE,IAAI,CAAE;AACrD;AAAA,IACD;AACA,QAAI,SAAS,GAAG;AACf,aAAO,QAAQ,KAAK;AAAA,IACrB,OAAO;AACN,cAAQ,CAAC,MAAO,EAAE,SAAS,IAAI,EAAE,MAAM,GAAG,EAAE,IAAI,CAAE;AAClD,iBAAW,CAAC,MAAO,EAAE,SAAS,IAAI,EAAE,MAAM,GAAG,EAAE,IAAI,CAAE;AAAA,IACtD;AAAA,EACD;AACA,QAAM,QAAQ,MAAM;AACnB,YAAQ,CAAC,MAAM,CAAC;AAChB,eAAW,CAAC,CAAC;AACb,cAAU,IAAI;AACd,qBAAiB,EAAE;AACnB,sBAAkB,CAAC,CAAC;AACpB,QAAI,SAAS,GAAG;AACf,YAAM,QAAQ,EAAE,MAAM,CAAC,MAAM,GAAG,SAAS,CAAC,GAAG,QAAQ,KAAK;AAC1D,UAAI;AACH,eAAO,QAAQ,UAAU,OAAO,EAAE;AAAA,MACnC,QAAQ;AAAA,MAAC;AAAA,IACV;AAAA,EACD;AAIA,QAAM,YAAY,CAAC,cAClB,gBAAAC,OAAAF,WAAA,EACC;AAAA,oBAAAC,MAAC,WAAQ,OAAO,GAAG,gCAAkB;AAAA,IACrC,gBAAAA,MAAC,SACA,0BAAAA,MAAC,QACC,oBAAU,IAAI,CAACM,OACf,gBAAAN,MAAC,QACA,0BAAAA,MAAC,UAAM,UAAAM,IAAE,KADDA,EAET,CACA,GACF,GACD;AAAA,IACA,gBAAAN,MAAC,WAAQ,OAAO,GAAG,0BAAY;AAAA,IAC/B,gBAAAA;AAAA,MAAC;AAAA;AAAA,QACA,OAAO;AAAA,QACP,UAAU,CAAC,MAAM;AAEhB,oBAAU,IAAI;AACd,kBAAQ,CAAC,MAAM,EAAE,MAAM,GAAG,IAAI,CAAC,CAAC;AAChC,qBAAW,CAAC,MAAM,EAAE,MAAM,GAAG,CAAC,CAAC;AAAA,QAChC;AAAA;AAAA,IACD;AAAA,IACA,gBAAAA,MAAC,OACA,0BAAAC,OAAC,UAAO,iCACP;AAAA,sBAAAD,MAAC,kBAAO,SAAS,QAAQ,SAAQ,aAAY,kBAE7C;AAAA,MACA,gBAAAA,MAAC,kBAAO,SAAS,OAAO,OAAO,EAAE,YAAY,MAAM,GAAG,yBAEtD;AAAA,OACD,GACD;AAAA,KACD;AAGD,MAAI,UAA2B;AAE/B,OAAI,6BAAM,UAAS,SAAS,CAAC,QAAQ;AACpC,cAAU,UAAW,KAAa,aAAa,CAAC,CAAC;AAAA,EAClD,WAAW,QAAQ;AAClB,cAAU,UAAU,MAAM;AAAA,EAC3B,WAAW,CAAC,MAAM;AACjB,cAAU,gBAAAC,OAAC,aAAU;AAAA;AAAA,MAAe;AAAA,OAAU;AAAA,EAC/C,WAAW,KAAK,SAAS,mBAAmB,KAAK,SAAS,UAAU;AACnE,UAAM,UAAU,KAAK;AAKrB,UAAM,WACL,KAAK,SAAS,WACV,KAAa,SAAS,aACvB,CAAC,CAAE,KAAa;AACpB,cACC,gBAAAA,OAAC,OACA;AAAA,sBAAAA,OAAC,UAAO,iCACP;AAAA,wBAAAA,OAAC,WAAQ,OAAO,GACd;AAAA,kBAAQ,SAAS;AAAA,UAAE;AAAA,UAAG,KAAK;AAAA,WAC7B;AAAA,QACC,KAAK,QAAQ,gBAAAD,MAAC,aAAW,eAAK,MAAK;AAAA,QACnC;AAAA,QACA,WACA,gBAAAA;AAAA,UAAC;AAAA;AAAA,YAEA,MAAM;AAAA,YACN,OACC,QAAQ,IAAI,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,MAAM,EAAE,MAAM,EAAE;AAAA,YAEvD,UAAU,CAAC,SAAmB,kBAAkB,IAAI;AAAA;AAAA,UAL/C;AAAA,QAMN,IAEA,gBAAAA;AAAA,UAAC;AAAA;AAAA,YAEA,MAAM;AAAA,YACN,SAAS,QAAQ,IAAI,CAAC,OAAO;AAAA,cAC5B,OAAO,EAAE;AAAA,cACT,OAAO,EAAE;AAAA,cACT,MAAM,EAAE;AAAA,YACT,EAAE;AAAA,YACF,OAAO,EAAE,cAAc,QAAQ;AAAA,YAC/B,UAAU,CAAC,UACV,iBAAiB,MAAM,OAAO,KAAK;AAAA;AAAA,UAT/B;AAAA,QAWN;AAAA,QAED,gBAAAC,OAAC,OACA;AAAA,0BAAAD,MAAC,UAAO,iCACN,UAAAG,MAAK,SAAS,KACd,gBAAAH,MAAC,kBAAO,SAAS,QAAQ,SAAQ,aAAY,kBAE7C,GAEF;AAAA,UACA,gBAAAA,MAAC,UAAO,iCAA0B,4BACjC,0BAAAA;AAAA,YAAC;AAAA;AAAA,cACA,SAAS,MAAM;AACd,oBAAI,UAAU;AACb,wBAAM,MAAM,oBAAoB,MAAM,cAAc;AACpD,wBAAM,cAAc;AAAA,oBACnB,GAAG;AAAA,oBACH;AAAA,sBACC,QAAQ;AAAA,sBACR,UAAU,KAAK;AAAA,sBACf,OAAO;AAAA,sBACP,WAAW,IAAI;AAAA,oBAChB;AAAA,kBACD;AACA,sBAAI,IAAI,QAAQ;AACf,0BAAM,WAAW,CAAC,GAAGG,OAAM,IAAI,MAAM;AACrC,+BAAW,WAAW;AACtB,8BAAU,IAAI;AACd,4BAAQ,QAAQ;AAChB,qCAAiB,UAAU,aAAa,IAAI;AAAA,kBAC7C,WAAW,IAAI,aAAa,IAAI,UAAU,QAAQ;AACjD,+BAAW,WAAW;AACtB,8BAAU,IAAI,SAAS;AACvB,qCAAiBA,OAAM,aAAa,IAAI,SAAS;AAAA,kBAClD;AAAA,gBACD,OAAO;AACN,wBAAM,MAAM;AACZ,sBAAI,CAAC,IAAK;AACV,wBAAM,MAAM,qBAAqB,MAAM,GAAG;AAC1C,wBAAM,cAAc;AAAA,oBACnB,GAAG;AAAA,oBACH;AAAA,sBACC,QAAQ;AAAA,sBACR,UAAU,KAAK;AAAA,sBACf,OAAO;AAAA,sBACP,WAAW,IAAI;AAAA,oBAChB;AAAA,kBACD;AACA,sBAAI,IAAI,QAAQ;AACf,0BAAM,WAAW,CAAC,GAAGA,OAAM,IAAI,MAAM;AACrC,+BAAW,WAAW;AACtB,8BAAU,IAAI;AACd,4BAAQ,QAAQ;AAChB,qCAAiB,UAAU,aAAa,IAAI;AAAA,kBAC7C,WAAW,IAAI,aAAa,IAAI,UAAU,QAAQ;AACjD,+BAAW,WAAW;AACtB,8BAAU,IAAI,SAAS;AACvB,qCAAiBA,OAAM,aAAa,IAAI,SAAS;AAAA,kBAClD;AAAA,gBACD;AAAA,cACD;AAAA,cACA,UACC,WAAW,eAAe,WAAW,IAAI,CAAC;AAAA,cAE3C;AAAA;AAAA,UAED,GACD;AAAA,WACD;AAAA,SACD;AAAA,MACA,gBAAAH,MAAC,UAAO,iCACP,0BAAAA;AAAA,QAAC;AAAA;AAAA,UACA,OAAO;AAAA,UACP,UAAU,CAAC,MAAM;AAChB,oBAAQ,CAAC,MAAM,EAAE,MAAM,GAAG,IAAI,CAAC,CAAC;AAChC,uBAAW,CAAC,MAAM,EAAE,MAAM,GAAG,CAAC,CAAC;AAAA,UAChC;AAAA;AAAA,MACD,GACD;AAAA,OACD;AAAA,EAEF,WAAW,KAAK,SAAS,UAAU;AAClC,cACC,gBAAAC,OAAC,OACA;AAAA,sBAAAA,OAAC,UAAO,qCACP;AAAA,wBAAAD,MAAC,WAAQ,OAAO,GAAI,eAAK,UAAS;AAAA,QAClC,gBAAAA;AAAA,UAAC;AAAA;AAAA,YAEA,MAAM;AAAA,YACN,SAAS;AAAA,cACR,EAAE,MAAM,OAAO,OAAO,MAAM;AAAA,cAC5B,EAAE,MAAM,MAAM,OAAO,KAAK;AAAA,YAC3B;AAAA,YACA,UAAU,CAAC,UACV,iBAAiB,MAAM,OAAO,KAAK;AAAA;AAAA,UAP/B;AAAA,QASN;AAAA,QACA,gBAAAC,OAAC,OACA;AAAA,0BAAAD,MAAC,UAAO,iCACP,0BAAAA,MAAC,kBAAO,SAAS,QAAQ,sCAAkC,kBAE3D,GACD;AAAA,UACA,gBAAAA,MAAC,UAAO,iCAA0B,4BACjC,0BAAAA;AAAA,YAAC;AAAA;AAAA,cACA,SAAS,MAAM;AACd,sBAAM,MAAM;AACZ,oBAAI,CAAC,IAAK;AACV,sBAAM,MAAM;AAAA,kBACX;AAAA,kBACA,IAAI,YAAY,MAAM,QAAQ,QAAQ;AAAA,gBACvC;AACA,sBAAM,cAAc;AAAA,kBACnB,GAAG;AAAA,kBACH;AAAA,oBACC,QAAQ;AAAA,oBACR,UAAU,KAAK;AAAA,oBACf,OAAO;AAAA,oBACP,WAAW,IAAI;AAAA,kBAChB;AAAA,gBACD;AACA,oBAAI,IAAI,QAAQ;AACf,wBAAM,WAAW,CAAC,GAAGG,OAAM,IAAI,MAAM;AACrC,6BAAW,WAAW;AACtB,4BAAU,IAAI;AACd,0BAAQ,QAAQ;AAChB,mCAAiB,UAAU,aAAa,IAAI;AAAA,gBAC7C,WAAW,IAAI,aAAa,IAAI,UAAU,QAAQ;AACjD,6BAAW,WAAW;AACtB,4BAAU,IAAI,SAAS;AACvB,mCAAiBA,OAAM,aAAa,IAAI,SAAS;AAAA,gBAClD;AAAA,cACD;AAAA,cACA,UAAU,CAAC;AAAA,cACX;AAAA;AAAA,UAED,GACD;AAAA,WACD;AAAA,SACD;AAAA,MACA,gBAAAH,MAAC,UAAO,mCACP,0BAAAA;AAAA,QAAC;AAAA;AAAA,UACA,OAAO;AAAA,UACP,iBAAiB,KAAK;AAAA,UACtB,UAAU,CAAC,MAAM;AAChB,oBAAQ,CAAC,MAAM,EAAE,MAAM,GAAG,IAAI,CAAC,CAAC;AAChC,uBAAW,CAAC,MAAM,EAAE,MAAM,GAAG,CAAC,CAAC;AAAA,UAChC;AAAA;AAAA,MACD,GACD;AAAA,OACD;AAAA,EAEF,OAAO;AACN,cAAU,gBAAAC,OAAC,aAAU;AAAA;AAAA,MAAwB,KAAK;AAAA,OAAK;AAAA,EACxD;AAEA,SACC,gBAAAD,MAAAD,WAAA,EAEE,mBACF;AAEF;AAEA,IAAO,wBAAQ;;;AoBnef,YAAYQ,aAAW;;;ACAvB,YAAYC,aAAW;AACvB,SAAS,oBAAoB;;;ACEtB,IAAK,YAAL,kBAAKC,eAAL;AACN,EAAAA,WAAA,SAAM;AACN,EAAAA,WAAA,OAAI;AACJ,EAAAA,WAAA,OAAI;AAHO,SAAAA;AAAA,GAAA;AAOL,IAAK,uBAAL,kBAAKC,0BAAL;AACN,EAAAA,sBAAA,QAAK;AACL,EAAAA,sBAAA,UAAO;AACP,EAAAA,sBAAA,aAAU;AAHC,SAAAA;AAAA,GAAA;AAML,IAAK,gBAAL,kBAAKC,mBAAL;AACN,EAAAA,eAAA,iBAAc;AACd,EAAAA,eAAA,aAAU;AACV,EAAAA,eAAA,aAAU;AAEV,EAAAA,eAAA,gBAAa;AALF,SAAAA;AAAA,GAAA;AAiBL,IAAM,kBAA+B;AAAA,EAC3C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACD;AAGO,IAAM,kBACZ,gBAAgB;AAAA,EACf,CAAC,KAAK,IAAI,MAAM;AACf,QAAI,EAAE,IAAI,IAAI;AACd,WAAO;AAAA,EACR;AAAA,EACA,CAAC;AACF;AAMM,IAAM,aAAwC;AAAA,EACpD,CAAC,gCAAqB,GAAG;AAAA,EACzB,CAAC,0BAAkB,GAAG;AAAA,EACtB,CAAC,mBAAe,GAAG;AAAA,EACnB,CAAC,mBAAe,GAAG;AACpB;AAiBA,IAAM,gBAAoD;AAAA,EACzD,CAAC,gCAAqB,GAAG;AAAA,EACzB,CAAC,0BAAkB,GAAG;AAAA,EACtB,CAAC,mBAAe,GAAG;AAAA,EACnB,CAAC,mBAAe,GAAG;AACpB;AAEO,IAAM,gBACZ,gBAAgB;AAAA,EACf,CAAC,KAAK,IAAI,UAAU;AACnB,QAAI,EAAE,IAAI;AAAA,MACT;AAAA,MACA,MAAM,QAAQ;AAAA,MACd,OAAO,WAAW,EAAE;AAAA,MACpB,UAAU,cAAc,EAAE;AAAA,MAC1B,uBAAuB;AAAA,IACxB;AACA,WAAO;AAAA,EACR;AAAA,EACA,CAAC;AACF;AAEM,IAAM,sBAA8C,gBAAgB;AAAA,EAC1E,CAAC,OAAO,cAAc,EAAE;AACzB;AAqCO,IAAK,gBAAL,kBAAKC,mBAAL;AACN,EAAAA,eAAA,UAAO;AACP,EAAAA,eAAA,UAAO;AACP,EAAAA,eAAA,UAAO;AAHI,SAAAA;AAAA,GAAA;AAOL,IAAK,2BAAL,kBAAKC,8BAAL;AACN,EAAAA,0BAAA,WAAQ;AACR,EAAAA,0BAAA,WAAQ;AACR,EAAAA,0BAAA,WAAQ;AAHG,SAAAA;AAAA,GAAA;;;ACxHJ,IAAM,eAAwD;AAAA,EACpE,CAAC,mCAAuB,GAAG;AAAA,IAC3B,SAAS;AAAA,IACT,WAAW;AAAA,EACZ;AAAA,EACC,CAAC,uCAAyB,GAAG;AAAA,IAC7B,SAAS;AAAA,IACT,WAAW;AAAA,EACZ;AAAA,EACC,CAAC,iCAAsB,GAAG;AAAA,IAC1B,SAAS;AAAA,IACT,WAAW;AAAA,EACZ;AAAA,EACC,CAAC,qCAAwB,GAAG;AAAA,IAC5B,SAAS;AAAA,IACT,WAAW;AAAA,EACZ;AAAA,EACC,CAAC,iCAAsB,GAAG;AAAA,IAC1B,SAAS;AAAA,IACT,WAAW;AAAA,EACZ;AAAA,EACC,CAAC,qCAAwB,GAAG;AAAA,IAC5B,SAAS;AAAA,IACT,WAAW;AAAA,EACZ;AAAA,EACC,CAAC,uBAAiB,GAAG;AAAA,IACrB,SAAS;AAAA,IACT,WAAW;AAAA,EACZ;AAAA,EACC,CAAC,2BAAmB,GAAG;AAAA,IACvB,SAAS;AAAA,IACT,WAAW;AAAA,EACZ;AAAA,EACC,CAAC,uBAAiB,GAAG;AAAA,IACrB,SAAS;AAAA,IACT,WAAW;AAAA,EACZ;AAAA,EACC,CAAC,2BAAmB,GAAG;AAAA,IACvB,SAAS;AAAA,IACT,WAAW;AAAA,EACZ;AACD;AAGO,SAAS,eAAe,KAA6C;AAC3E,MAAI,CAAC,IAAK,QAAO,CAAC;AAClB,QAAM,MAAmB,CAAC;AAC1B,MAAI,IAAI,0BAA2B,KAAI,KAAK,mCAAuB;AACnE,MAAI,IAAI,4BAA6B,KAAI,KAAK,uCAAyB;AACvE,MAAI,IAAI,yBAA0B,KAAI,KAAK,iCAAsB;AACjE,MAAI,IAAI,2BAA4B,KAAI,KAAK,qCAAwB;AACrE,MAAI,IAAI,yBAA0B,KAAI,KAAK,iCAAsB;AACjE,MAAI,IAAI,2BAA4B,KAAI,KAAK,qCAAwB;AACrE,MAAI,IAAI,oBAAqB,KAAI,KAAK,uBAAiB;AACvD,MAAI,IAAI,sBAAuB,KAAI,KAAK,2BAAmB;AAC3D,MAAI,IAAI,oBAAqB,KAAI,KAAK,uBAAiB;AACvD,MAAI,IAAI,sBAAuB,KAAI,KAAK,2BAAmB;AAC3D,SAAO;AACR;AAGO,SAAS,eAAe,MAAgD;AAC9E,UAAQ,MAAM;AAAA,IACb;AACC,aAAO;AAAA,IACR;AACC,aAAO;AAAA,IACR;AACC,aAAO;AAAA,IACR;AACC,aAAO;AAAA;AAAA,IACR;AACC,aAAO;AAAA,EACT;AACD;AAGO,SAAS,eAAe,MAAgD;AAC9E,UAAQ,MAAM;AAAA,IACb;AACC,aAAO;AAAA,IACR;AACC,aAAO;AAAA,IACR;AACC,aAAO;AAAA,EACT;AACD;AAGO,SAAS,UACfC,OACA,OACA,OACgB;AAChB,MAAIA,SAAQ,QAAQ,CAAC,OAAO,SAAS,KAAK,KAAK,SAAS,EAAG,QAAO;AAClE,QAAM,IAAI,KAAK,KAAK,QAAQA,SAAQ,KAAK;AACzC,MAAI,IAAI,EAAG,QAAO;AAClB,MAAI,IAAI,EAAG,QAAO;AAClB,MAAI,IAAI,EAAG,QAAO;AAClB,SAAO;AACR;AAIO,IAAM,yBAGT;AAAA,EACH,aAAa;AAAA,IACZ,OAAO;AAAA,IACP,KAAK;AAAA,EACN;AAAA,EACA,SAAS;AAAA,IACR,OAAO;AAAA,IACP,KAAK;AAAA,EACN;AAAA,EACA,SAAS;AAAA,IACR,OAAO;AAAA,IACP,KAAK;AAAA,EACN;AAAA,EACA,YAAY;AAAA,IACX,OAAO;AAAA,IACP,KAAK;AAAA,EACN;AACD;AAEO,SAAS,uBACf,MACS;AAxJV,MAAAC,KAAAC;AAyJC,MAAI,CAAC,KAAM,QAAO,uBAAuB,QAAQ;AACjD,UACCA,OAAAD,MAAA,uBAAuB,IAAI,MAA3B,gBAAAA,IAA8B,UAA9B,OAAAC,MAAuC,uBAAuB,QAAQ;AAExE;AAEO,SAAS,qBAAqB,MAAyC;AA/J9E,MAAAD,KAAAC;AAgKC,MAAI,CAAC,KAAM,QAAO,uBAAuB,QAAQ;AACjD,UACCA,OAAAD,MAAA,uBAAuB,IAAI,MAA3B,gBAAAA,IAA8B,QAA9B,OAAAC,MAAqC,uBAAuB,QAAQ;AAEtE;;;AFqFM,SAEE,OAAAC,OAFF,QAAAC,cAAA;AA7MN,IAAM,oBAAsD,CAAC;AAAA,EAC5D;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,2BAA2B;AAAA,EAC3B,6BAA6B;AAC9B,MAAM;AArDN,MAAAC,KAAAC,KAAA;AAsDC,QAAM,UAAU,kBAAkB;AAClC,QAAM,QAAQ,gBAAgB;AAI9B,QAAM,CAAC,aAAa,cAAc,IAAU,iBAAqB,IAAI;AACrE,QAAM,CAAC,iBAAiB,kBAAkB,IAAU,iBAAS,KAAK;AAClE,QAAM,iBAAuB,eAAsB,IAAI;AAGvD,EAAM,kBAAU,MAAM;AACrB,QAAI,CAAC,QAAS;AACd,QAAI,QAAQ,SAAS;AACpB,qBAAe,QAAQ,OAAO;AAC9B,UAAI,eAAe,SAAS;AAC3B,6BAAqB,eAAe,OAAO;AAC3C,uBAAe,UAAU;AAAA,MAC1B;AAAA,IACD;AACA,QAAI,CAAC,QAAQ,WAAW,CAAC,iBAAiB;AACzC,YAAM,KAAK,sBAAsB,MAAM;AACtC,uBAAe,IAAI;AACnB,uBAAe,UAAU;AAAA,MAC1B,CAAC;AACD,qBAAe,UAAU;AAAA,IAC1B;AACA,WAAO,MAAM;AACZ,UAAI,eAAe,SAAS;AAC3B,6BAAqB,eAAe,OAAO;AAC3C,uBAAe,UAAU;AAAA,MAC1B;AAAA,IACD;AAAA,EACD,GAAG,CAAC,SAAS,mCAAS,SAAS,eAAe,CAAC;AAG/C,QAAM,UACL,YACC,QAAQ,YAAY,kBAAkB,cAAc,SAAS;AAG/D,QAAM,CAAC,SAAS,UAAU,IAAU,iBAAS,KAAK;AAClD,EAAM,kBAAU,MAAM;AACrB,UAAM,KAAK,sBAAsB,MAAM,WAAW,IAAI,CAAC;AACvD,WAAO,MAAM,qBAAqB,EAAE;AAAA,EACrC,GAAG,CAAC,mCAAS,KAAK,CAAC;AAGnB,QAAM,cAAaD,MAAA,+BAAO,eAAP,OAAAA,MAAqB;AACxC,QAAM,eAAcC,MAAA,+BAAO,gBAAP,OAAAA,MAAsB;AAC1C,QAAM,SAAS,UACZ,KAAK,IAAI,KAAK,IAAI,QAAQ,SAAS,CAAC,GAAG,UAAU,IACjD;AACH,QAAM,SAAS,UACZ,KAAK,IAAI,KAAK,IAAI,QAAQ,SAAS,CAAC,GAAG,WAAW,IAClD;AAGH,QAAM,eAAe,WAAc,QAAd,mBAAmB;AACxC,QAAM,OAAO;AAGb,MAAI,CAAC,SAAS;AACb,WAAO;AAAA,EACR;AAGA,QAAM,MAAM,yCAAa,QAAQ;AAEjC,QAAM,UAAU,eAAe,GAAG;AAClC,QAAM,QAAQ,QAAQ,IAAI,CAACC,QAAO,EAAE,IAAIA,IAAG,OAAO,aAAaA,EAAC,EAAE,QAAQ,EAAE;AAC5E,QAAM,UAAU,QAAQ,aAAa,OAAO,QAAQ,IAAI,IAAI,KAAK,QAAQ,CAAC;AAC1E,QAAM,YAAY,gBACf,cAAc,OAAO,IACrB,QAAQ,aAAa;AACxB,QAAMC,QAAO,cAAc,GAAG,WAAW,KAAK;AAC9C,QAAM,aACL,eAAeA,QACZ,GAAG,QAAQ,CAAC,GAAGA,QAAO,KAAKA,QAAO,GAAG,GAAG,cAAc,MAAM,cAAc,EAAE,KAC5E,GAAG,QAAQ,CAAC;AAGhB,QAAM,gBAA+B,eAAe,2BAAK,aAAa;AAEtE,QAAM,gBAA+B,eAAe,2BAAK,aAAa;AAGtE,QAAM,OAAsB;AAAA,KAC3B,YAAO,SAAP,YAAe;AAAA,IACf,OAAO;AAAA,IACP,QAAQ;AAAA,EACT;AAGA,QAAM,YAAY,iBACf,eAAe,QAAQ,OAAO,EAAE,GAAG,QAAQ,GAAG,GAAG,QAAQ,EAAE,CAAC,IAC5D;AACH,QAAM,aAAa,iBAAiB,iBAAiB;AAGrD,QAAM,aAAY,2BAAK,yBAAuB,2BAAK;AACnD,QAAM,oBAAmB,2BAAK,8CAA2C;AAEzE,QAAM,oBAAoB,8BAA8B,mBACrD,gHACA;AACH,QAAM,WAAW,MAAM,SAAS;AAEhC,QAAM,iBAAqC,2BAAK;AAChD,QAAM,cAAqC,2BAAK;AAEhD,QAAM,gBAAgB,6BAA4B,2BAAK,8CAA2C;AAIlG,QAAM,cAAc;AAEpB,QAAM,cAAc,uBAAuB,2BAAK,aAAa;AAO7D,QAAM,SAAS;AAEf,QAAM,sBAAsB;AAAA,IAC3B,aAAa;AAAA,IACb,GAAG,SAAS,WAAM,UAAU;AAAA,EAC7B,EAAE,OAAO,OAAO;AAChB,QAAM,uBAAuB,oBAAoB;AAAA,IAChD,CAAC,GAAG,MAAM,KAAK,IAAI,GAAG,EAAE,SAAS,SAAS,EAAE;AAAA,IAC5C;AAAA,EACD;AACA,QAAM,WAAW;AACjB,QAAM,WAAW;AACjB,QAAM,WAAW,KAAK,IAAI,UAAU,KAAK,IAAI,UAAU,oBAAoB,CAAC;AAE5E,MAAI,OAAO,SAAS;AAEpB,QAAM,aAAa,iBAAc,WAAd,mBAAsB,QAAtB,YAA6B;AAEhD,MAAI,MAAM,YAAY,SAAS;AAE/B,MAAI,OAAO,WAAW,YAAY;AACjC,UAAM,UAAU;AAChB,WAAO,SAAS,UAAU;AAAA,EAC3B;AAEA,MAAI,OAAO,EAAG,QAAO,KAAK,IAAI,GAAG,aAAa,QAAQ;AAGtD,QAAM,YAAY,UAAU,eAAe,QAAQ,KAAK,KAAK;AAC7D,QAAM,SAAS,OACZ;AAAA,IACA,gBAAAL;AAAA,MAAC;AAAA;AAAA,QACA,IAAI;AAAA,QACJ,WACC,4CACC,UAAU,gBAAgB;AAAA,QAE5B,OAAO;AAAA,UACN,UAAU;AAAA,UACV;AAAA,UACA;AAAA,UACA,OAAO;AAAA,UACP;AAAA,UACA,QAAQ;AAAA,UACR,eAAe;AAAA,UACf,YAAY;AAAA,QACb;AAAA,QACA,MAAK;AAAA,QACL,aAAU;AAAA,QACV,eAAa,UAAU,UAAU;AAAA,QACjC,iBAAa;AAAA,QACb,kBAAgB,OAAO,WAAW,KAAK,aAAa,SAAS;AAAA,QAC7D,gBAAgB,MAAM;AACrB,6BAAmB,IAAI;AACvB,cAAI,eAAe,SAAS;AAC3B,iCAAqB,eAAe,OAAO;AAC3C,2BAAe,UAAU;AAAA,UAC1B;AAAA,QACD;AAAA,QACA,gBAAgB,MAAM;AACrB,6BAAmB,KAAK;AAExB,cAAI,EAAC,mCAAS,UAAS;AACtB,kBAAM,KAAK,sBAAsB,MAAM;AACtC,6BAAe,IAAI;AACnB,6BAAe,UAAU;AAAA,YAC1B,CAAC;AACD,2BAAe,UAAU;AAAA,UAC1B;AAAA,QACD;AAAA,QAEA,0BAAAC,OAAC,SAAI,WAAU,yBACd;AAAA,0BAAAA,OAAC,SAAI,WAAU,2DACd;AAAA,4BAAAD,MAAC,SAAI,WAAU,kCACd,0BAAAA,MAAC,YAAO,kBAAI,GACb;AAAA,YACA,gBAAAA,MAAC,SAAI,WAAU,iCAAiC,qBAAU;AAAA,aAC3D;AAAA,UACA,gBAAAC,OAAC,SAAI,WAAU,4DACd;AAAA,4BAAAD,MAAC,SAAI,WAAU,kCACd,0BAAAA,MAAC,YAAO,mBAAK,GACd;AAAA,YACA,gBAAAA,MAAC,SAAI,WAAU,iCAAiC,sBAAW;AAAA,aAC5D;AAAA,UAMC,cACA,gBAAAC,OAAC,SAAI,WAAU,8DACd;AAAA,4BAAAD,MAAC,SAAI,WAAU,kCACd,0BAAAA,MAAC,YAAO,qBAAO,GAChB;AAAA,YACA,gBAAAA,MAAC,SAAI,WAAU,2BAA0B,cAAW,WACjD,iBAAM;AAEP,kBAAI,+CAAe,cAAc,SAAS,YAAY;AACrD,uBACC,gBAAAA;AAAA,kBAAC;AAAA;AAAA,oBACA,MAAM;AAAA,oBACN,OAAM;AAAA,oBACN,WAAU;AAAA;AAAA,gBACX;AAAA,cAEF;AACA,kBAAI,+CAAe,cAAc,SAAS,gBAAgB;AACzD,uBACC,gBAAAA;AAAA,kBAAC;AAAA;AAAA,oBACA,MAAM;AAAA,oBACN,OAAM;AAAA,oBACN,WAAU;AAAA;AAAA,gBACX;AAAA,cAEF;AACA,kBAAI,eAAe;AAClB,uBACC,gBAAAA;AAAA,kBAAC;AAAA;AAAA,oBACA,MAAM;AAAA,oBACN,OAAM;AAAA,oBACN,WAAU;AAAA,oBACV,cAAW;AAAA;AAAA,gBACZ;AAAA,cAEF;AACA,kBAAI,eAAe;AAClB,uBACC,gBAAAA;AAAA,kBAAC;AAAA;AAAA,oBACA,MAAM;AAAA,oBACN,OAAM;AAAA,oBACN,WAAU;AAAA;AAAA,gBACX;AAAA,cAEF;AACA,qBAAO;AAAA,YACR,GAAG,GACJ;AAAA,aACD;AAAA,UAEA,iBACA,gBAAAC,OAAC,SAAI,WAAU,gEACd;AAAA,4BAAAD,MAAC,SAAI,WAAU,kCACd,0BAAAA,MAAC,YAAO,uBAAS,GAClB;AAAA,YACA,gBAAAA,MAAC,SAAI,WAAU,2BAA0B,cAAW,UACjD,iBAAM;AACP,oBAAM,QAAQ,cAAc,YAAY;AAExC,oBAAM,SAAS,MAAM,SAAS,SAAS,KAAK,MAAM,SAAS,cAAc;AAEzE,oBAAM,SAAS,CAAC,UAAW,6BAA8B,KAAK,KAAK;AACnE,qBACC,gBAAAA;AAAA,gBAAC;AAAA;AAAA,kBACA,MAAM;AAAA,kBACN,OAAM;AAAA,kBAEN,WAAW,2DAA2D,SAAS,6BAA6B,sBAAsB;AAAA,kBAClI,cAAY,cAAc,aAAa;AAAA;AAAA,cACxC;AAAA,YAEF,GAAG,GACJ;AAAA,aACD;AAAA,UAEA,QACA,gBAAAC,OAAC,SAAI,WAAU,6DACd;AAAA,4BAAAD,MAAC,SAAI,WAAU,kCACd,0BAAAA,MAAC,YAAO,oCAAsB,GAC/B;AAAA,YACA,gBAAAA,MAAC,SAAI,WAAU,2BAA0B,cAAW,UACnD,0BAAAA;AAAA,cAAC;AAAA;AAAA,gBACA,OAAO,MAAM;AACZ,wBAAM,IAAI,KAAK,YAAY;AAC3B,sBAAI,EAAE,WAAW,UAAU,EAAG,QAAO;AACrC,sBAAI,EAAE,WAAW,UAAK,EAAG,QAAO;AAChC,sBAAI,EAAE,WAAW,UAAK,EAAG,QAAO;AAChC,sBAAI,EAAE,WAAW,IAAI,EAAG,QAAO;AAC/B,yBAAO;AAAA,gBACR,GAAG;AAAA,gBACH,OACC,KAAK,SAAS,IAAI,IACf,WACA,KAAK,SAAS,UAAK,IAClB,WACA;AAAA,gBAEL,cAAY,eAAe,IAAI;AAAA,gBAC/B,WAAU;AAAA;AAAA,YACX,GACD;AAAA,aACD;AAAA,UAEA,qBACA,gBAAAC,OAAC,SAAI,WAAU,6DAA4D,eAAW,MACrF;AAAA,4BAAAD,MAAC,SAAI,WAAU,kCAAiC,0BAAAA,MAAC,YAAO,0BAAY,GAAS;AAAA,YAC7E,gBAAAA,MAAC,SAAI,WAAU,gCAA+B,aAAU,OAAO,6BAAkB;AAAA,aAClF;AAAA,UAEA,YACA,gBAAAC,OAAC,SAAI,WAAU,4DACd;AAAA,4BAAAD,MAAC,SAAI,WAAU,kCACd,0BAAAA,MAAC,YAAO,2BAAa,GACtB;AAAA,YACA,gBAAAA;AAAA,cAAC;AAAA;AAAA,gBACA,WAAU;AAAA,gBACV,cAAW;AAAA,gBAEV,gBAAM,IAAI,CAAC,EAAE,IAAI,MAAM,MAAM;AAC7B,wBAAM,QAAQ,OAAO,EAAE;AACvB,wBAAM,UAAU,+CAA2C;AAE3D,wBAAM,iBAAiB,UACpB,uBACA,gBACC,8BACA,gBACC,cAAc,YAAY,EAAE,SAAS,SAAS,IAC7C,yBACA,cAAc,YAAY,EAAE,SAAS,aAAa,IACjD,6BACA,wBACF;AACL,yBACC,gBAAAA;AAAA,oBAAC;AAAA;AAAA,sBAEA,MAAM;AAAA,sBACN,OAAM;AAAA,sBACN,WAAW,oCAAoC,cAAc;AAAA,sBAC7D,gBAAc;AAAA;AAAA,oBAJT;AAAA,kBAKN;AAAA,gBAEF,CAAC;AAAA;AAAA,YACF;AAAA,YACE,kBACD,gBAAAC,OAAC,SAAI,WAAU,4DAA2D,OAAO,EAAE,WAAW,GAAG,GAChG;AAAA,8BAAAD,MAAC,SAAI,WAAU,kCAAiC,OAAO,EAAE,cAAc,EAAE,GACxE,0BAAAA,MAAC,YAAO,6BAAe,GACxB;AAAA,eACE,MAAM;AACP,sBAAM,kBAAkB,gBACrB,8BACA,gBACC,cAAc,YAAY,EAAE,SAAS,SAAS,IAC7C,yBACA,cAAc,YAAY,EAAE,SAAS,aAAa,IACjD,6BACA,wBACF;AACJ,sBAAM,aAAa,GAAG,cAAc,GAAG,cAAc,KAAK,WAAW,MAAM,EAAE;AAC7E,uBACC,gBAAAA;AAAA,kBAAC;AAAA;AAAA,oBACA,MAAM;AAAA,oBACN,OAAM;AAAA,oBACN,WAAW,oCAAoC,eAAe;AAAA,oBAC9D,cAAY,mBAAmB,cAAc,GAAG,cAAc,QAAQ,WAAW,KAAK,EAAE;AAAA;AAAA,gBACzF;AAAA,cAEF,GAAG;AAAA,eACJ;AAAA,aAEF;AAAA,WAEF;AAAA;AAAA,IACD;AAAA,IACA;AAAA,EACD,IACC;AAEH,SACC,gBAAAC;AAAA,IAAC;AAAA;AAAA,MACA,WAAU;AAAA,MACV,eAAc;AAAA,MACd,eAAY;AAAA,MAEZ;AAAA,wBAAAD;AAAA,UAAC;AAAA;AAAA,YACA,IAAI;AAAA,YACJ,IAAI;AAAA,YACJ,GAAG;AAAA,YACH,MAAK;AAAA,YACL,QAAQ;AAAA,YACR,aAAa;AAAA;AAAA,QACd;AAAA,QACA,gBAAAA;AAAA,UAAC;AAAA;AAAA,YACA,IAAI;AAAA,YACJ,IAAI;AAAA,YACJ,GAAG;AAAA,YACH,MAAK;AAAA,YACL,QAAQ;AAAA,YACR,aAAa;AAAA;AAAA,QACd;AAAA,QACA,gBAAAA;AAAA,UAAC;AAAA;AAAA,YACA,IAAI;AAAA,YACJ,IAAI;AAAA,YACJ,GAAG;AAAA,YACH,MAAM;AAAA,YACN,QAAO;AAAA,YACP,aAAa;AAAA;AAAA,QACd;AAAA,QACC;AAAA;AAAA;AAAA,EACF;AAEF;AAEA,IAAO,4BAAQ;;;AGhef,SAAgB,SAAAM,QAAO,WAAAC,iBAAe;;;ACCtC,IAAI,eAA2C;AAD/C;AAEA,IAAI;AAGH,QAAM,SAAS;AACf,mBAAe,4CAAQ,UAAR,mBAAgB,gBAAhB,mBAA6B,QAAO;AACpD,QAAQ;AAER;AAEO,IAAM,cAAc,CAAC,KAAa,aAA6B;AACrE,MAAI,CAAC,aAAc,QAAO;AAC1B,QAAM,QAAQ,IAAI,MAAM,GAAG;AAC3B,MAAI,UAAe;AACnB,aAAW,KAAK,OAAO;AACtB,QAAI,WAAW,KAAM;AACrB,cAAU,QAAQ,CAAC;AAAA,EACpB;AACA,QAAM,MAAM;AACZ,MAAI,OAAO,KAAM,QAAO;AACxB,MAAI,OAAO,QAAQ,YAAY,OAAO,QAAQ,SAAU,QAAO,OAAO,GAAG;AACzE,MAAI,IAAI,UAAU,KAAM,QAAO,OAAO,IAAI,MAAM;AAChD,MAAI,IAAI,SAAS,KAAM,QAAO,OAAO,IAAI,KAAK;AAC9C,SAAO;AACR;AAEO,IAAM,uBAAuB,OAAO;AAAA;AAAA,EAE1C,OAAO,YAAY,+BAA+B,MAAM;AAAA,EACxD,KAAK,YAAY,6BAA6B,MAAM;AAAA,EACpD,KAAK,YAAY,6BAA6B,GAAG;AAAA,EACjD,UAAU;AAAA,IACT;AAAA,IACA,YAAY,+BAA+B,MAAM;AAAA,EAClD;AAAA,EACA,QAAQ;AAAA,IACP;AAAA,IACA,YAAY,6BAA6B,MAAM;AAAA,EAChD;AAAA,EACA,QAAQ;AAAA,IACP;AAAA,IACA,YAAY,6BAA6B,GAAG;AAAA,EAC7C;AACD;;;AC3CO,IAAK,kBAAL,kBAAKC,qBAAL;AACN,EAAAA,iBAAA,UAAO;AACP,EAAAA,iBAAA,UAAO;AACP,EAAAA,iBAAA,eAAY;AAHD,SAAAA;AAAA,GAAA;AAUL,IAAM,kBAAmD;AAAA,EAC/D,CAAC,iBAAoB,GAAG;AAAA;AAAA,EACxB,CAAC,iBAAoB,GAAG;AAAA;AAAA,EACxB,CAAC,2BAAyB,GAAG;AAAA;AAC9B;AAGO,IAAM,kBAAmD;AAAA,EAC/D,CAAC,iBAAoB,GAAG;AAAA,EACxB,CAAC,iBAAoB,GAAG;AAAA,EACxB,CAAC,2BAAyB,GAAG;AAC9B;AAGO,IAAK,iBAAL,kBAAKC,oBAAL;AACN,EAAAA,gBAAA,oBAAiB;AACjB,EAAAA,gBAAA,mBAAgB;AAChB,EAAAA,gBAAA,sBAAmB;AAHR,SAAAA;AAAA,GAAA;AAOL,IAAK,YAAL,kBAAKC,eAAL;AACN,EAAAA,WAAA,YAAS;AACT,EAAAA,WAAA,WAAQ;AAFG,SAAAA;AAAA,GAAA;AAKL,IAAK,qBAAL,kBAAKC,wBAAL;AACN,EAAAA,oBAAA,eAAY;AACZ,EAAAA,oBAAA,mBAAgB;AAChB,EAAAA,oBAAA,kBAAe;AACf,EAAAA,oBAAA,UAAO;AAJI,SAAAA;AAAA,GAAA;AAOL,IAAK,iBAAL,kBAAKC,oBAAL;AACN,EAAAA,gBAAA,2BAAwB;AACxB,EAAAA,gBAAA,+BAA4B;AAC5B,EAAAA,gBAAA,iBAAc;AACd,EAAAA,gBAAA,6BAA0B;AAJf,SAAAA;AAAA,GAAA;AA8BZ,IAAM,iBAAiB,CAACC,SAAgB;AACvC,QAAM,IAAIA,KAAI,QAAQ,KAAK,EAAE;AAC7B,QAAMC,KAAI,SAAS,EAAE,MAAM,GAAG,CAAC,GAAG,EAAE,IAAI;AACxC,QAAM,IAAI,SAAS,EAAE,MAAM,GAAG,CAAC,GAAG,EAAE,IAAI;AACxC,QAAM,IAAI,SAAS,EAAE,MAAM,GAAG,CAAC,GAAG,EAAE,IAAI;AACxC,QAAM,OAAO,CAACA,IAAG,GAAG,CAAC,EAAE;AAAA,IAAI,CAAC,MAC3B,KAAK,UAAU,IAAI,QAAQ,KAAK,KAAK,IAAI,SAAS,OAAO,GAAG;AAAA,EAC7D;AACA,QAAM,IAAI,SAAS,KAAK,CAAC,IAAI,SAAS,KAAK,CAAC,IAAI,SAAS,KAAK,CAAC;AAC/D,SAAO,IAAI,OAAO,YAAY;AAC/B;AAEO,IAAM,oBAAgE;AAAA,EAC5E,CAAC,6DAAwC,GAAG;AAAA,IAC3C,KAAK,uBAAuB,QAAQ;AAAA,IACpC,WAAW;AAAA,IACX,OAAO;AAAA,IACP,aACC;AAAA,EACF;AAAA,EACA,CAAC,qDAAoC,GAAG;AAAA,IACvC,KAAK,uBAAuB,YAAY;AAAA,IACxC,WAAW;AAAA,IACX,OAAO;AAAA,IACP,aACC;AAAA,EACF;AAAA,EACA,CAAC,gCAA0B,GAAG;AAAA,IAC7B,KAAK,uBAAuB,QAAQ;AAAA,IACpC,WAAW;AAAA,IACX,OAAO;AAAA,IACP,aAAa;AAAA,EACd;AAAA,EACA,CAAC,0DAAsC,GAAG;AAAA,IACzC,KAAK,uBAAuB,WAAW;AAAA,IACvC,WAAW;AAAA,IACX,OAAO;AAAA,IACP,aACC;AAAA,EACF;AACD;AAEA,OAAO,OAAO,iBAAiB,EAAE,QAAQ,CAAC,QAAQ;AACjD,MAAI,CAAC,IAAI,KAAM,KAAI,OAAO,eAAe,IAAI,GAAG;AACjD,CAAC;AAEM,IAAM,qBAAqB,CAAC,UAClC,kBAAkB,KAAK;AACjB,IAAM,oBAAoB,CAAC,UACjC,kBAAkB,KAAK,EAAE,aAAa;AAOhC,IAAM,gBAAgB;AAAA,EAC5B,SAAS;AAAA,IACR,QAAQ;AAAA,MACP,EAAE,IAAI,MAAM,IAAI,MAAM;AAAA,MACtB,EAAE,IAAI,KAAK,IAAI,IAAI;AAAA,MACnB,EAAE,IAAI,OAAO,IAAI,MAAM;AAAA,MACvB,EAAE,IAAI,KAAK,IAAI,IAAI;AAAA,MACnB,EAAE,IAAI,KAAK,IAAI,IAAI;AAAA,IACpB;AAAA,IACA,OAAO;AAAA,MACN,EAAE,IAAI,MAAM,IAAI,MAAM;AAAA,MACtB,EAAE,IAAI,KAAK,IAAI,MAAM;AAAA,MACrB,EAAE,IAAI,OAAO,IAAI,MAAM;AAAA,MACvB,EAAE,IAAI,KAAK,IAAI,MAAM;AAAA,MACrB,EAAE,IAAI,OAAO,IAAI,IAAI;AAAA,IACtB;AAAA,EACD;AAAA,EACA,QAAQ;AAAA,IACP,EAAE,IAAI,MAAM,IAAI,MAAM;AAAA,IACtB,EAAE,IAAI,KAAK,IAAI,MAAM;AAAA,IACrB,EAAE,IAAI,OAAO,IAAI,IAAI;AAAA,IACrB,EAAE,IAAI,KAAK,IAAI,IAAI;AAAA,IACnB,EAAE,IAAI,OAAO,IAAI,IAAI;AAAA,EACtB;AACD;AAEO,SAAS,sBACf,OACA,WACU;AACV,MAAI;AACJ,MAAI,UAAU,iCAA4B,OAAM,cAAc;AAAA;AAE7D,UACC,cAAc,QAAQ,cAAc,sBAAkB,UAAU,QAAQ;AAC1E,SAAO,IAAI,IAAI,CAAC,OAAO,EAAE,GAAG,EAAE,EAAE;AACjC;;;ACpKO,IAAK,sBAAL,kBAAKC,yBAAL;AACL,EAAAA,qBAAA,aAAU;AACV,EAAAA,qBAAA,iBAAc;AACd,EAAAA,qBAAA,iBAAc;AACd,EAAAA,qBAAA,YAAS;AAJC,SAAAA;AAAA,GAAA;AASL,IAAK,yBAAL,kBAAKC,4BAAL;AACL,EAAAA,wBAAA,aAAU;AACV,EAAAA,wBAAA,cAAW;AACX,EAAAA,wBAAA,qBAAkB;AAHR,SAAAA;AAAA,GAAA;AAmBZ,IAAO,6BAAQ;;;AHgYZ,SAscC,YAAAC,WArcA,OAAAC,OADD,QAAAC,cAAA;AAtPH,IAAM,wBAAwB,CAC7B,UAKI;AA9KL,MAAAC,KAAAC;AAgLC,QAAM,kBAAkB,MAAM;AAC7B,QAAI,CAAE,WAAmB,6BAA6B;AACrD,cAAQ;AAAA,QACP;AAAA,MACD;AACA,MAAC,WAAmB,8BAA8B;AAAA,IACnD;AAAA,EACD;AAEA,MAAK,MAAwC,kBAAkB,QAAW;AACzE,UAAM,MAAM;AAEZ,QAAI,WAAuC;AAC3C,QAAI,IAAI,yBAAyB,QAAW;AAC3C,iBACC,IAAI,mFAED,IAAI;AAAA,IAGT,WAAW,IAAI,UAAU;AACxB,iBAAW,IAAI;AAAA,IAChB;AAEA,QAAIC;AACJ,YAAQ,IAAI,eAAe;AAAA,MAC1B;AACC,QAAAA;AAA8C;AAAA,MAC/C;AACC,QAAAA;AAAkD;AAAA,MACnD;AACC,QAAAA,SAAQ,IAAI;AAEmB;AAAA,MAChC;AAAA,MACA;AACC,QAAAA;AAAgD;AAAA,IAClD;AACA,QAAIC,aAAmC,IAAI;AAC3C,QAAI,CAACA,YAAW;AACf,UAAID,kEAAgD;AACnD,QAAAC,aAAY;AAAA,MACb,WAAWD,0EAAoD;AAC9D,QAAAC,aAAY;AAAA,MACb,WAAWD,uEAAkD;AAE5D,YAAI,IAAI,kBAAkB,CAAC,IAAI,cAAe,CAAAC;AAAA,iBACrC,IAAI,iBAAiB,CAAC,IAAI,eAAgB,CAAAA;AAAA,YAC9C,CAAAA;AAAA,MACN,OAAO;AACN,QAAAA;AAAA,MACD;AAAA,IACD;AACA,WAAO,EAAE,OAAAD,QAAO,WAAAC,YAAW,UAAU,yEAA4C;AAAA,EAClF;AAEA,MAAK,MAA8B,UAAU,QAAW;AACvD,oBAAgB;AAChB,UAAM,KAAK;AACX,QAAIA,aAAmC,GAAG;AAC1C,QACC,CAACA,eACA,GAAG,mEACH,GAAG,4EACJ,GAAG,UACF;AACD,UAAI,GAAG,iEAAgD;AACtD,QAAAA,aACC,GAAG;AAAA,MAGL,OAAO;AACN,QAAAA,aACC,GAAG;AAAA,MAGL;AAAA,IACD;AACA,QAAI,CAACA,YAAW;AACf,UAAI,GAAG;AACN,QAAAA;AAAA,eACQ,GAAG;AACX,QAAAA;AAAA,UACI,CAAAA;AAAA,IACN;AACA,WAAO;AAAA,MACN,OAAO,GAAG;AAAA,MACV,WAAAA;AAAA,MACA,WAAUH,MAAA,GAAG,aAAH,OAAAA;AAAA,IACX;AAAA,EACD;AAEA,QAAM,KAAK;AACX,kBAAgB;AAChB,QAAMI,OAAkD;AAAA,IACvD,4BAA6B;AAAA,IAC7B,oCAAiC;AAAA,IAEjC,kCAAgC;AAAA,IAChC,kBAAwB;AAAA,EACzB;AACA,QAAM,QAAQA,KAAI,GAAG,SAAS;AAC9B,MAAI;AACJ,MAAI,GAAG,2CAA4C;AAClD,gBACC,GAAG;AAAA,EAGL,WAAW,GAAG,mDAAgD;AAC7D,gBACC,GAAG;AAAA,EAGL,OAAO;AACN,iBAAaH,MAAA,GAAG,UAAH,OAAAA;AAAA,EACd;AACA,SAAO,EAAE,OAAO,WAAW,UAAU,GAAG,SAAS;AAClD;AAcO,SAAS,+BACf,OACA,SACS;AACT,QAAM,EAAE,OAAO,WAAW,SAAS,IAAI,sBAAsB,KAAK;AAClE,QAAM,YAAY,kBAAkB,KAAK;AAGzC,QAAM,WAAW,sCAAiC,UAAU;AAC5D,QAAM,YAAY,sCAAiC,YAAY;AAE/D,QAAM,kBAAkB,MAAM;AAC7B,YAAQ,UAAU;AAAA,MACjB;AACC,eAAO;AAAA,MACR;AACC,eAAO;AAAA,MACR;AACC,eAAO;AAAA,IACT;AAAA,EACD,GAAG;AAEH,QAAM,QAAQ,MAAM;AACnB,YAAQ,WAAW;AAAA,MAClB;AACC,eAAO,+DAA+D,QAAQ;AAAA,MAC/E;AACC,eAAO,iEAAiE,QAAQ;AAAA,MACjF;AACC,eAAO,6FAA6F,SAAS;AAAA,MAC9G;AAAA,MACA;AACC,eAAO;AAAA,IACT;AAAA,EACD,GAAG;AAEH,QAAM,QAAQ;AAAA,IACb;AAAA,IACA;AAAA,KACA,mCAAS,eAAc,YAAY,QAAQ,WAAW,MAAM;AAAA,KAC5D,mCAAS,kBAAiB,GAAG,QAAQ,cAAc,MAAM;AAAA,KACzD,mCAAS,gBAAe,iBAAiB,QAAQ,YAAY,MAAM;AAAA,KACnE,mCAAS,aAAY,cAAc,QAAQ,SAAS,MAAM;AAAA,KAC1D,mCAAS,kBAAiB,QAAQ,iBAAiB;AAAA,EACpD;AACA,SAAO,MAAM,OAAO,OAAO,EAAE,KAAK,GAAG;AACtC;AAmDA,IAAM,YAAY,CACjB,WACA,UACA,QACA,YACA,cACA,UAEA,gBAAAF,OAAC,UACC;AAAA,gBACA,gBAAAA,OAAC,YAAO,IAAI,UAAU,aAAY,qBACjC;AAAA,oBAAAD,MAAC,oBAAe,cAAa,KAAI;AAAA,IACjC,gBAAAA,MAAC,cAAS,IAAG,KAAI,IAAG,MAAK,QAAO,QAAO;AAAA,IACvC,gBAAAA,MAAC,aAAQ,YAAW,oBAAmB,cAAa,KAAI;AAAA,IACxD,gBAAAA,MAAC,iBAAY,KAAI,QAAO,UAAS,MAAK,QAAO,eAAc;AAAA,IAC3D,gBAAAA,MAAC,iBAAY,IAAG,iBAAgB,KAAI,eAAc,UAAS,QAAO;AAAA,KACnE;AAAA,EAEA,gBACA,gBAAAA,MAAC,oBAAe,IAAI,QAAQ,IAAG,MAAK,IAAG,MAAK,IAAG,QAAO,IAAG,QACvD,gBAAM,IAAI,CAAC,MACX,gBAAAA;AAAA,IAAC;AAAA;AAAA,MAEA,QAAQ,EAAE;AAAA,MACV,WAAW;AAAA,MACX,aAAa,WAAW,EAAE,OAAO;AAAA;AAAA,IAH5B,EAAE;AAAA,EAIR,CACA,GACF;AAAA,GAEF;AAGM,IAAM,mBAAmB,CAAC;AAAA,EAChC;AAAA,EACA,OAAO;AAAA,EACP;AAAA,EACA,aAAa;AAAA,EACb,aAAa;AAAA,EACb,eAAe;AAAA,EACf;AAAA,EACA,YAAY;AAAA;AAAA,EAEZ;AAAA,EACA;AAAA,EACA,GAAG;AACJ,MAA0D;AACzD,QAAM,WAAWO,OAAM;AACvB,QAAM,SAASA,OAAM;AAErB,QAAM;AAAA,IACL,OAAO;AAAA,IACP,KAAK;AAAA,IACL,KAAK;AAAA,IACL,UAAU;AAAA,IACV,QAAQ;AAAA,IACR,QAAQ;AAAA,EACT,IAAI,qBAAqB;AAGzB,QAAM,EAAE,OAAO,WAAW,SAAS,IAAIC;AAAA,IACtC,MAAM,sBAAsB,IAAyB;AAAA,IACrD,CAAC,IAAI;AAAA,EACN;AACA,QAAM,SAASA,UAAQ,MAAM,mBAAmB,KAAK,GAAG,CAAC,KAAK,CAAC;AAC/D,QAAM,YAAYA,UAAQ,MAAM,kBAAkB,KAAK,GAAG,CAAC,KAAK,CAAC;AACjE,QAAM,yBACL,6CACA;AACD,MAAI,SAAS;AAEb,MAAI,cAAc,wBAAwB;AACzC,QAAI,0CAAoC;AACvC,UAAI,qDAA4C,UAAS;AAAA,eAChD,mDAA2C,UAAS;AAAA,UACxD,UAAS;AAAA,IACf,OAAO;AACN,eAAS,sCAAiC,MAAM;AAAA,IACjD;AAAA,EACD;AAEA,MAAI,mBAAmB,OAAW,UAAS;AAC3C,QAAM,YAAY;AAClB,QAAM,gBAAgB;AACtB,QAAM,cAAc,YAAY,gBAAgB,SAAS;AACzD,QAAM,cAAc,YAAY,OAAO,MAAM;AAC7C,QAAM,SAAkBA;AAAA,IACvB,MAAM,sBAAsB,OAAO,SAAS;AAAA,IAC5C,CAAC,OAAO,SAAS;AAAA,EAClB;AACA,QAAM,OACL,aACA,GAAG,OAAO,KAAK,GACd,SAAU,sCAAiC,mBAAc,kBAAc,EACxE;AACD,QAAM,kBAAkB;AAAA,IACvB;AAAA,EACD;AAGA,MAAI,qDAAoD;AAEvD,UAAM,UAAU;AAChB,UAAM,UAAU;AAChB,UAAM,UAAU;AAChB,UAAM,aAAa;AAAA,MAClB,CAAC,SAAS,UAAU,UAAU,CAAC;AAAA,MAC/B,CAAC,UAAU,UAAU,GAAG,UAAU,UAAU,CAAC;AAAA,MAC7C,CAAC,UAAU,UAAU,GAAG,UAAU,UAAU,CAAC;AAAA,IAC9C;AACA,UAAM,eAAe;AAAA,MACpB,CAAC,SAAS,UAAU,UAAU,CAAC;AAAA,MAC/B,CAAC,UAAU,UAAU,GAAG,UAAU,UAAU,CAAC;AAAA,MAC7C,CAAC,UAAU,UAAU,GAAG,UAAU,UAAU,CAAC;AAAA,IAC9C;AAEA,QAAI,QAAyB;AAG7B,QACC,mEACA,yEACC;AACD,cACC,gBAAAR;AAAA,QAAC;AAAA;AAAA,UACA,SAAS,sCAAiC,aAAa,cACrD,IAAI,CAAC,MAAM,EAAE,KAAK,GAAG,CAAC,EACtB,KAAK,GAAG;AAAA,UACV,MAAM,OAAO;AAAA,UACb,QAAQ,OAAO;AAAA,UACf,aAAa;AAAA,UACb,WACC,sCACG,qBACA;AAAA;AAAA,MAEL;AAAA,IAEF,WAAW,sEAAkD;AAC5D,cACC,gBAAAA;AAAA,QAAC;AAAA;AAAA,UACA,QACC,sCACG,WAAW,IAAI,CAAC,MAAM,EAAE,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,IAC3C,aAAa,IAAI,CAAC,MAAM,EAAE,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG;AAAA,UAEjD,MAAM,OAAO;AAAA,UACb,QAAQ,OAAO;AAAA,UACf,aAAa;AAAA,UACb,WACC,sCACG,oBACA;AAAA;AAAA,MAEL;AAAA,IAEF;AAEA,UAAM,SAAS,KAAK,IAAI,GAAG,KAAK,IAAI,GAAG,KAAK,MAAM,aAAa,CAAC,CAAC,CAAC;AAClE,UAAM,OAAO,6CAAuC,MAAM,sCAAiC,MAAM;AACjG,UAAM,YAAY;AAClB,UAAM,SAAS;AACf,UAAM,YAAY,UAAU,IAAI;AAChC,UAAM,WAAW,kEACb,YAAY,eAAe,SAAS,IACpC,0EACC,YAAY,WAAW,SAAS,IAChC;AACL,UAAM,aAAa,MAAM,KAAK,EAAE,QAAQ,EAAE,CAAC,EAAE,IAAI,CAAC,GAAG,MAAM;AAC3D,YAAM,UAAU,mEACd,4EACA,KAAK,IAAI;AACV,YAAM,OAAO,SAAS,WAAW;AACjC,aACC,gBAAAA;AAAA,QAAC;AAAA;AAAA,UAEA,IAAI,YAAY,IAAI;AAAA,UACpB,IAAI;AAAA,UACJ,GAAG;AAAA,UACH;AAAA,UACA,QAAQ;AAAA,UACR,aAAa;AAAA;AAAA,QANR;AAAA,MAON;AAAA,IAEF,CAAC;AACD,UAAMS,QAAO;AAAA,MACZ,OAAO;AAAA,MACP;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,QACC,EAAE,QAAQ,MAAM,SAAS,aAAa;AAAA,QACtC,EAAE,QAAQ,OAAO,SAAS,WAAW;AAAA,QACrC,EAAE,QAAQ,QAAQ,SAAS,WAAW;AAAA,MACvC;AAAA,IACD;AAEA,UAAM,iBACL,6CACE,qBACA,sCACA,qBACA;AACH,WACC,gBAAAR;AAAA,MAAC;AAAA;AAAA,QACA,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,SAAQ;AAAA,QACR,MAAK;AAAA,QACL,cAAY;AAAA,QACZ,oBAAkB;AAAA,QACjB,GAAG;AAAA,QAEH;AAAA,UAAAQ;AAAA,UACD,gBAAAT;AAAA,YAAC;AAAA;AAAA,cACA,QAAO;AAAA,cACP,MAAM,eAAe,QAAQ,MAAM,MAAM;AAAA,cACxC,GAAI,aAAa,EAAE,QAAQ,QAAQ,QAAQ,IAAI,IAAI,CAAC;AAAA,cACrD,IAAG;AAAA,cACH,IAAG;AAAA,cACH,GAAE;AAAA;AAAA,UACH;AAAA,UACA,gBAAAA;AAAA,YAAC;AAAA;AAAA,cACA,QAAQ,OAAO;AAAA,cACf,aAAa;AAAA,cACb,kBAAkB;AAAA,cAClB,MAAK;AAAA,cACL,IAAG;AAAA,cACH,IAAG;AAAA,cACH,GAAE;AAAA;AAAA,UACH;AAAA,UACA,gBAAAC,OAAC,OAAE,WAAW,gBACZ;AAAA;AAAA,YACA,UACA,gBAAAD;AAAA,cAAC;AAAA;AAAA,gBACA,MAAK;AAAA,gBACL,YAAW;AAAA,gBACX,YAAW;AAAA,gBACX,UAAU;AAAA,gBACV,GAAE;AAAA,gBACF,GAAG,sCAAiC,MAAM;AAAA,gBAC1C,YAAW;AAAA,gBACX,kBAAiB;AAAA,gBAEhB;AAAA;AAAA,YACF;AAAA,YAEA;AAAA,aACF;AAAA;AAAA;AAAA,IACD;AAAA,EAEF;AAGA,MAAI,uCAA6C;AAKhD,UAAM,UAAU;AAChB,UAAM,UAAU;AAChB,UAAM,UAAU;AAChB,UAAM,aAAa;AAAA,MAClB,CAAC,SAAS,UAAU,UAAU,CAAC;AAAA,MAC/B,CAAC,UAAU,UAAU,GAAG,UAAU,UAAU,CAAC;AAAA,MAC7C,CAAC,UAAU,UAAU,GAAG,UAAU,UAAU,CAAC;AAAA,IAC9C;AACA,UAAM,eAAe;AAAA,MACpB,CAAC,SAAS,UAAU,UAAU,CAAC;AAAA,MAC/B,CAAC,UAAU,UAAU,GAAG,UAAU,UAAU,CAAC;AAAA,MAC7C,CAAC,UAAU,UAAU,GAAG,UAAU,UAAU,CAAC;AAAA,IAC9C;AAEA,UAAM,WAAW;AAAA,MAChB,CAAC,UAAU,UAAU,GAAG,UAAU,UAAU,CAAC;AAAA,MAC7C,CAAC,UAAU,UAAU,GAAG,UAAU,UAAU,CAAC;AAAA,IAC9C;AACA,QAAI,QAAyB;AAE7B,QACC,mEACA,yEACC;AACD,cACC,gBAAAA;AAAA,QAAC;AAAA;AAAA,UACA,SAAS,sCAAiC,aAAa,cACrD,IAAI,CAAC,MAAM,EAAE,KAAK,GAAG,CAAC,EACtB,KAAK,GAAG;AAAA,UACV,MAAM,OAAO;AAAA,UACb,QAAQ,OAAO;AAAA,UACf,aAAa;AAAA,UACb,WACC,sCACG,sBACA;AAAA;AAAA,MAEL;AAAA,IAEF,WAAW,sEAAkD;AAE5D,cACC,gBAAAA;AAAA,QAAC;AAAA;AAAA,UACA,QACC,sCACG,WAAW,IAAI,CAAC,MAAM,EAAE,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,IAC3C,aAAa,IAAI,CAAC,MAAM,EAAE,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG;AAAA,UAEjD,MAAM,OAAO;AAAA,UACb,QAAQ,OAAO;AAAA,UACf,aAAa;AAAA,UACb,WACC,sCACG,sBACA;AAAA;AAAA,MAEL;AAAA,IAEF,WAAW,4CAAsC;AAEhD,cACC,gBAAAA;AAAA,QAAC;AAAA;AAAA,UACA,IAAI,SAAS,CAAC,EAAE,CAAC;AAAA,UACjB,IAAI,SAAS,CAAC,EAAE,CAAC;AAAA,UACjB,IAAI,SAAS,CAAC,EAAE,CAAC;AAAA,UACjB,IAAI,SAAS,CAAC,EAAE,CAAC;AAAA,UACjB,QAAQ,OAAO;AAAA,UACf,aAAa;AAAA,UACb,eAAc;AAAA,UACd,WAAU;AAAA;AAAA,MACX;AAAA,IAEF;AACA,UAAMS,QAAO;AAAA,MACZ,OAAO;AAAA,MACP;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,QACC,EAAE,QAAQ,MAAM,SAAS,aAAa;AAAA,QACtC,EAAE,QAAQ,OAAO,SAAS,WAAW;AAAA,QACrC,EAAE,QAAQ,QAAQ,SAAS,WAAW;AAAA,MACvC;AAAA,IACD;AACA,WACC,gBAAAR;AAAA,MAAC;AAAA;AAAA,QACA,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,SAAQ;AAAA,QACR,MAAK;AAAA,QACL,cAAY;AAAA,QACZ,oBAAkB;AAAA,QACjB,GAAG;AAAA,QAEH;AAAA,UAAAQ;AAAA,UACD,gBAAAT;AAAA,YAAC;AAAA;AAAA,cACA,QAAO;AAAA,cACP,MAAM,eAAe,QAAQ,MAAM,MAAM;AAAA,cACxC,GAAI,aAAa,EAAE,QAAQ,QAAQ,QAAQ,IAAI,IAAI,CAAC;AAAA,cACrD,IAAG;AAAA,cACH,IAAG;AAAA,cACH,GAAE;AAAA;AAAA,UACH;AAAA,UACA,gBAAAA;AAAA,YAAC;AAAA;AAAA,cACA,QAAQ,OAAO;AAAA,cACf,aAAa;AAAA,cACb,kBAAkB;AAAA,cAClB,MAAK;AAAA,cACL,IAAG;AAAA,cACH,IAAG;AAAA,cACH,GAAE;AAAA;AAAA,UACH;AAAA,UACC;AAAA,UACA,WACC,mEACA,4EACA,gBAAAA;AAAA,YAAC;AAAA;AAAA,cACA,MAAK;AAAA,cACL,YAAW;AAAA,cACX,YAAW;AAAA,cACX,UAAU;AAAA,cACV,GAAE;AAAA,cACF,GAAG,sCAAiC,QAAQ;AAAA,cAC5C,YAAW;AAAA,cACX,kBAAiB;AAAA,cAGhB;AAAA;AAAA,UACF;AAAA;AAAA;AAAA,IAEH;AAAA,EAEF;AAGA,QAAM,OAAO;AAAA,IACZ,OAAO;AAAA,IACP;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,MACC,EAAE,QAAQ,MAAM,SAAS,UAAU;AAAA,MACnC,EAAE,QAAQ,OAAO,SAAS,QAAQ;AAAA,MAClC,EAAE,QAAQ,QAAQ,SAAS,QAAQ;AAAA,IACpC;AAAA,EACD;AACA,SACC,gBAAAC;AAAA,IAAC;AAAA;AAAA,MACA,OAAO;AAAA,MACP,QAAQ;AAAA,MACR,SAAQ;AAAA,MACR,MAAK;AAAA,MACL,cAAY;AAAA,MACZ,oBAAkB;AAAA,MACjB,GAAG;AAAA,MAEH;AAAA;AAAA,QACD,gBAAAD;AAAA,UAAC;AAAA;AAAA,YACA,QAAO;AAAA,YACP,MAAM,eAAe,QAAQ,MAAM,MAAM;AAAA,YACxC,GAAI,aAAa,EAAE,QAAQ,QAAQ,QAAQ,IAAI,IAAI,CAAC;AAAA,YACrD,IAAG;AAAA,YACH,IAAG;AAAA,YACH,GAAE;AAAA;AAAA,QACH;AAAA,QACA,gBAAAA;AAAA,UAAC;AAAA;AAAA,YACA,QAAQ,OAAO;AAAA,YACf,aAAa;AAAA,YACb,kBAAkB;AAAA,YAClB,MAAK;AAAA,YACL,IAAG;AAAA,YACH,IAAG;AAAA,YACH,GAAE;AAAA;AAAA,QACH;AAAA,QACC,UACA,gBAAAA;AAAA,UAAC;AAAA;AAAA,YACA,MAAM,OAAO;AAAA,YACb,YAAW;AAAA,YACX,YAAW;AAAA,YACX,UAAU;AAAA,YACV,WAAU;AAAA,YACV,YAAW;AAAA,YAEX,0BAAAA,MAAC,WAAM,GAAE,OAAM,GAAG,oCAAgC,QAAQ,OACxD,kBACF;AAAA;AAAA,QACD;AAAA,QAIA,gBACA,gBAAAA;AAAA,UAAC;AAAA;AAAA,YACA,eAAY;AAAA,YACZ,UAAS;AAAA,YACT,QAAO;AAAA,YACP,MAAM,OAAO;AAAA,YACZ,GAAI,oCACF,EAAE,WAAW,qBAAqB,IAClC,EAAE,WAAW,oCAAoC;AAAA,YACpD,GAAE;AAAA;AAAA,QACH,IAEA,gBAAAC,OAAAF,WAAA,EAEE;AAAA,iBAAO,WAAW,KAClB,gBAAAC;AAAA,YAAC;AAAA;AAAA,cACA,eAAY;AAAA,cACZ,MAAK;AAAA,cACL,QAAQ;AAAA,cACR,aAAa;AAAA,cACb,eAAc;AAAA,cACd,gBAAe;AAAA,cACf,SAAS;AAAA,cACT,GAAG,KAAK,OAAO,IAAI,CAAC,MAAM,GAAG,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,EAAE,KAAK,KAAK,CAAC;AAAA;AAAA,UACzD;AAAA,UAGA,OAAO,IAAI,CAAC,GAAU,MAAc;AACpC,kBAAM,aAAa,KAAK,OAAO,SAAS,KAAK;AAC7C,kBAAM,OAAO,aAAa,cAAc;AACxC,kBAAM,SAAS;AACf,mBACC,gBAAAA;AAAA,cAAC;AAAA;AAAA,gBAEA;AAAA,gBACA,aAAa;AAAA,gBACb,kBAAkB;AAAA,gBAClB;AAAA,gBACA,IAAI,EAAE;AAAA,gBACN,IAAI,EAAE;AAAA,gBACN,GAAG;AAAA;AAAA,cAPE;AAAA,YAQN;AAAA,UAEF,CAAC;AAAA,WACF;AAAA;AAAA;AAAA,EAEF;AAEF;AAEA,iBAAiB,cAAc;;;AI14B/B,SAAS,SAAAU,cAAa;AAmDjB,SAwCD,YAAAC,WAvCE,OAAAC,OADD,QAAAC,cAAA;AA9BE,IAAM,mBAAmB,CAAC;AAAA,EAChC;AAAA,EACA,OAAO;AAAA,EACP;AAAA,EACA,aAAa;AAAA,EACb;AAAA,EACA,eAAe;AAAA,EACf;AAAA,EACA,iBAAiB;AAAA,EACjB,GAAG;AACJ,MAAoD;AACnD,QAAM,WAAWC,OAAM;AACvB,QAAM,SAASA,OAAM;AAErB,QAAM,EAAE,OAAO,WAAW,KAAK,SAAS,KAAK,QAAQ,IAAI,qBAAqB;AAC9E,QAAM,SAAS,kBAAkB,gBAAgB,MAAM;AACvD,QAAM,UAAU,kBAAkB,gBAAgB,MAAM,GAAG,MAAM,GAAG,CAAC;AACrE,QAAM,OAAO,aAAa,aAAa,MAAM;AAE7C,SACC,gBAAAD;AAAA,IAAC;AAAA;AAAA,MACA,OAAO;AAAA,MACP,QAAQ;AAAA,MACR,SAAQ;AAAA,MACR,MAAK;AAAA,MACL,cAAY;AAAA,MACX,GAAG;AAAA,MAEJ;AAAA,wBAAAA,OAAC,UACC;AAAA,wBACA,gBAAAA,OAAC,YAAO,IAAI,UAAU,aAAY,qBACjC;AAAA,4BAAAD,MAAC,oBAAe,cAAa,KAAI;AAAA,YACjC,gBAAAA,MAAC,cAAS,IAAG,MAAK,IAAG,MAAK,QAAO,QAAO;AAAA,YACxC,gBAAAA,MAAC,aAAQ,YAAW,oBAAmB,cAAa,KAAI;AAAA,YACxD,gBAAAA,MAAC,iBAAY,KAAI,QAAO,UAAS,MAAK,QAAO,eAAc;AAAA,YAC3D,gBAAAA,MAAC,iBAAY,IAAG,iBAAgB,KAAI,eAAc,UAAS,QAAO;AAAA,aACnE;AAAA,UAEA,gBACA,gBAAAC,OAAC,oBAAe,IAAI,QAAQ,IAAG,MAAK,IAAG,MAAK,IAAG,QAAO,IAAG,QACxD;AAAA,4BAAAD,MAAC,UAAK,QAAO,MAAK,WAAW,QAAQ,aAAa,WAAW,SAAS,GAAG;AAAA,YACzE,gBAAAA,MAAC,UAAK,QAAO,OAAM,WAAW,QAAQ,aAAa,WAAW,OAAO,GAAG;AAAA,YACxE,gBAAAA,MAAC,UAAK,QAAO,QAAO,WAAU,WAAU,aAAa,WAAW,OAAO,GAAG;AAAA,aAC3E;AAAA,WAEF;AAAA,QACA,gBAAAA;AAAA,UAAC;AAAA;AAAA,YACA,QAAO;AAAA,YACP,MAAM,eAAe,QAAQ,MAAM,MAAM;AAAA,YACxC,GAAI,aAAa,EAAE,QAAQ,QAAQ,QAAQ,IAAI,IAAI,CAAC;AAAA,YACrD,IAAG;AAAA,YACH,IAAG;AAAA,YACH,GAAE;AAAA;AAAA,QACH;AAAA,QAEA,gBAAAA;AAAA,UAAC;AAAA;AAAA,YACA,MAAM;AAAA,YACN,YAAW;AAAA,YACX,YAAW;AAAA,YACX,UAAU;AAAA,YACV,GAAG;AAAA,YACH,GAAG;AAAA,YACH,WAAU;AAAA,YACV,YAAW;AAAA,YAEX,0BAAAA,MAAC,WAAM,GAAG,IAAI,GAAG,KACf,kBACF;AAAA;AAAA,QACD;AAAA,QACC,kBACA,gBAAAC,OAAAF,WAAA,EAEE;AAAA,yCACA,gBAAAC;AAAA,YAAC;AAAA;AAAA,cACA,IAAG;AAAA,cACH,QAAQ;AAAA,cACR,aAAa;AAAA,cACb,kBAAkB;AAAA,cAClB,iBAAgB;AAAA,cAChB,kBAAkB;AAAA,cAClB,MAAK;AAAA,cACL,GAAE;AAAA;AAAA,UACH,IACG,yCACH,gBAAAA;AAAA,YAAC;AAAA;AAAA,cACA,IAAG;AAAA,cACH,QAAO;AAAA,cACP,aAAa;AAAA,cACb,kBAAkB;AAAA,cAClB,iBAAgB;AAAA,cAChB,kBAAkB;AAAA,cAClB,MAAK;AAAA,cACL,GAAE;AAAA;AAAA,UACH,IAEA,gBAAAA;AAAA,YAAC;AAAA;AAAA,cACA,IAAG;AAAA,cACH,QAAQ;AAAA,cACR,aAAa;AAAA,cACb,kBAAkB;AAAA,cAClB,iBAAgB;AAAA,cAChB,kBAAkB;AAAA,cAClB,MAAK;AAAA,cACL,GAAE;AAAA;AAAA,UACH;AAAA,UAGD,gBAAAA;AAAA,YAAC;AAAA;AAAA,cACA,IAAG;AAAA,cACH,QAAO;AAAA,cACP,aAAa;AAAA,cACb,kBAAkB;AAAA,cAClB,MAAK;AAAA,cACL,GAAE;AAAA;AAAA,UACH;AAAA,UACA,gBAAAA;AAAA,YAAC;AAAA;AAAA,cACA,QAAQ;AAAA,cACR,aAAa;AAAA,cACb,kBAAkB;AAAA,cAClB,MAAK;AAAA,cACL,IAAG;AAAA,cACH,IAAG;AAAA,cACH,GAAE;AAAA;AAAA,UACH;AAAA,WACD;AAAA;AAAA;AAAA,EAEF;AAEF;AAEA,iBAAiB,cAAc;;;ACnJxB,IAAM,WAAW,CAAC,MAA4B,OAAO,MAAM,YAAY,OAAO,SAAS,CAAC;AACxF,IAAM,MAAM,CAAC,QAA0B,IAAI,OAAO,CAAC,GAAG,MAAM,IAAI,GAAG,CAAC;AACpE,IAAM,OAAO,CAAC,QAA2B,IAAI,SAAS,IAAI,GAAG,IAAI,IAAI,SAAS;AAG9E,SAAS,aAAa,QAA2B,QAAsC;AAC5F,QAAM,KAAwB,IAAI,MAAM,OAAO,MAAM,EAAE,KAAK,IAAI;AAChE,MAAI,UAAyB;AAC7B,WAAS,IAAI,GAAG,IAAI,OAAO,QAAQ,KAAK;AACtC,UAAM,KAAK,OAAO,CAAC;AACnB,QAAI,CAAC,OAAO,CAAC,KAAK,SAAS,EAAE,GAAG;AAC9B,UAAI,YAAY,MAAM;AACpB,cAAM,KAAK,OAAO,OAAO;AACzB,WAAG,CAAC,IAAI,SAAS,EAAE,IAAI,KAAK,IAAI,KAAK,EAAE,IAAI;AAAA,MAC7C;AACA,gBAAU;AAAA,IACZ;AAAA,EACF;AACA,SAAO;AACT;AAEO,SAAS,4BACd,IACA,iBACmC;AACnC,QAAM,OAAO,GAAG,OAAO,CAAC,MAAmB,SAAS,CAAC,CAAC;AACtD,MAAI,CAAC,KAAK,OAAQ,QAAO,EAAE,QAAQ,KAAK,OAAO,IAAI;AACnD,MAAI,YAAY,KAAK,IAAI;AACzB,MAAI,WAAW,QAAQ;AACvB,MAAI,iBAAiB;AACnB,UAAM,UAAU,KAAK,OAAO,CAAC,MAAM,KAAK,QAAQ;AAChD,QAAI,QAAQ,UAAU,QAAQ,WAAW,KAAK,QAAQ;AACpD,kBAAY,KAAK,OAAO;AACxB,iBAAW,QAAQ;AAAA,IACrB;AAAA,EACF;AACA,SAAO,EAAE,QAAQ,WAAW,OAAO,SAAS;AAC9C;AAEO,SAAS,UACd,YACA,WAQA;AACA,MAAI,CAAC,SAAS,UAAU,KAAK,CAAC,SAAS,SAAS;AAC9C,WAAO;AAAA,MACL,mBAAmB;AAAA,MACnB,mBAAmB;AAAA,MACnB,eAAe;AAAA,MACf,eAAe;AAAA,MACf,eAAe;AAAA,MACf,eAAe;AAAA,IACjB;AACF,QAAM,KAAK;AACX,QAAM,KAAM,IAAI,IAAK;AACrB,QAAM,KAAM,IAAI,IAAK;AACrB,SAAO;AAAA,IACL,mBAAmB,aAAa,KAAK;AAAA,IACrC,mBAAmB,aAAa,KAAK;AAAA,IACrC,eAAe,aAAa,KAAK;AAAA,IACjC,eAAe,aAAa,KAAK;AAAA,IACjC,eAAe,aAAa,KAAK;AAAA,IACjC,eAAe,aAAa,KAAK;AAAA,EACnC;AACF;AAGA,IAAM,UAAU;AAChB,IAAM,cAAc;AACb,IAAM,iBAAiB,CAAC,MAAqC,SAAS,CAAC,KAAK,KAAK,IAAI,KAAK,IAAI,GAAG,OAAO,IAAI;AAC5G,IAAM,mBAAmB,CAACG,OAAqC,SAASA,EAAC,KAAKA,MAAK,IAAI,KAAK,IAAIA,IAAG,WAAW,IAAI;AAGlH,SAAS,eAAe,GAAW,GAAmB;AAC3D,MAAI,EAAE,IAAI,KAAK,IAAI,MAAM,EAAE,IAAI,KAAK,IAAI,GAAI,QAAO;AACnD,SAAO,KAAK,IAAI,IAAI,CAAC,IAAI,KAAK,IAAI,IAAI,CAAC;AACzC;AAEA,IAAM,cAAc;AAAA,EAClB,KAAK,EAAE,KAAK,cAAc,MAAM,aAAa;AAAA,EAC7C,KAAK,EAAE,KAAK,cAAc,MAAM,aAAa;AAAA,EAC7C,OAAO,EAAE,KAAK,YAAa,MAAM,YAAY;AAC/C;AAEO,SAAS,wBAAwB,OAQtC;AACA,MAAI,CAAC,SAAS,KAAK,KAAK,QAAQ;AAC9B,WAAO;AAAA,MACL,IAAI;AAAA,MACJ,KAAK;AAAA,MACL,KAAK;AAAA,MACL,QAAQ;AAAA,MACR,SAAS;AAAA,MACT,QAAQ;AAAA,MACR,SAAS;AAAA,IACX;AACF,QAAM,IAAI,KAAK,QAAQ;AACvB,QAAM,cAAc,CAAC,MAAc,eAAe,GAAG,CAAC,IAAI;AAC1D,QAAM,KAAK,YAAY,GAAG;AAC1B,QAAM,MAAM,KAAK,IAAI,GAAG,YAAY,YAAY,MAAM,GAAG,CAAC;AAC1D,QAAM,MAAM,YAAY,YAAY,MAAM,IAAI;AAC9C,QAAM,OAAO,KAAK,IAAI,GAAG,YAAY,YAAY,IAAI,GAAG,CAAC;AACzD,QAAM,OAAO,YAAY,YAAY,IAAI,IAAI;AAC7C,QAAM,OAAO,KAAK,IAAI,GAAG,YAAY,YAAY,IAAI,GAAG,CAAC;AACzD,QAAM,OAAO,YAAY,YAAY,IAAI,IAAI;AAC7C,SAAO,EAAE,IAAI,KAAK,KAAK,QAAQ,MAAM,SAAS,MAAM,QAAQ,MAAM,SAAS,KAAK;AAClF;AAEO,SAAS,aACd,SACA,QACA,iBAYA;AACA,QAAMA,KAAI,QAAQ,IAAI,CAAC,MAAO,SAAS,CAAC,IAAI,eAAe,CAAC,IAAK,IAAK;AACtE,QAAM,MAAM,aAAaA,IAAG,MAAM;AAClC,QAAM,EAAE,QAAQ,YAAY,IAAI,4BAA4B,KAAK,CAAC,CAAC,eAAe;AAClF,QAAM,YAAYA,GAAE,OAAO,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,KAAK,SAAS,CAAC,CAAC;AAC9D,QAAM,OAAO,UAAU,SAAS,KAAK,SAAS,IAAI;AAClD,MAAI,CAAC,SAAS,IAAI,KAAK,CAAC,SAAS,WAAW,GAAG;AAC7C,WAAO;AAAA,MACL,QAAQ;AAAA,MACR,mBAAmB;AAAA,MACnB,mBAAmB;AAAA,MACnB,eAAe;AAAA,MACf,eAAe;AAAA,MACf,eAAe;AAAA,MACf,eAAe;AAAA,MACf,IAAI;AAAA,MACJ,QAAQ;AAAA,MACR,OAAO;AAAA,IACT;AAAA,EACF;AACA,QAAM,KAAK,MAAM,KAAM,IAAI,IAAK,IAAI,KAAM,IAAI,IAAK;AACnD,QAAM,OAAO,OAAO,KAAK;AACzB,QAAM,OAAO,OAAO,KAAK;AACzB,QAAM,OAAO,OAAO,KAAK;AACzB,QAAM,OAAO,OAAO,KAAK;AACzB,QAAM,OAAO,OAAO,KAAK;AACzB,QAAM,OAAO,OAAO,KAAK;AACzB,QAAM,SAAS,iBAAiB,IAAI;AACpC,QAAM,MAAM,iBAAiB,IAAI;AACjC,QAAM,MAAM,QAAQ,IAAI,OAAO,iBAAiB,IAAI;AACpD,QAAM,OAAO,iBAAiB,IAAI;AAClC,QAAM,OAAO,QAAQ,IAAI,OAAO,iBAAiB,IAAI;AACrD,QAAM,OAAO,iBAAiB,IAAI;AAClC,QAAM,OAAO,QAAQ,IAAI,OAAO,iBAAiB,IAAI;AACrD,SAAO;AAAA,IACL,QAAQ,0BAAU;AAAA,IAClB,mBAAmB,oBAAO;AAAA,IAC1B,mBAAmB,oBAAO;AAAA,IAC1B,eAAe,sBAAQ;AAAA,IACvB,eAAe,sBAAQ;AAAA,IACvB,eAAe,sBAAQ;AAAA,IACvB,eAAe,sBAAQ;AAAA,IACvB,IAAI;AAAA,IACJ,QAAQ;AAAA,IACR,OAAO,SAAS,WAAW,IAAI,QAAQ,cAAc;AAAA,EACvD;AACF;;;AC/KO,SAAS,qBAAqB,MAQnB;AACjB,QAAM;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA,MAAAC;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACD,IAAI;AAEJ,QAAMC,YAAW,CAAC,MACjB,OAAO,MAAM,YAAY,OAAO,SAAS,CAAW;AAErD,MAAI,CAACA,UAAS,KAAK,KAAKD,UAAS,QAAQ,CAACC,UAAS,MAAM,EAAG;AAE5D,MACC,kBACAA,UAAS,iBAAiB,KAC1BA,UAAS,iBAAiB,GACzB;AACD,QAAI,qCAA+C;AAClD,UAAIA,UAAS,iBAAiB,KAAK,oBAAoB;AACtD;AACD,UAAIA,UAAS,iBAAiB,KAAK,oBAAoB;AACtD;AACD;AAAA,IACD;AACA,QAAI,yCAAiD;AACpD,UAAIA,UAAS,iBAAiB,KAAK,oBAAoB;AACtD;AACD,UAAIA,UAAS,iBAAiB,KAAK,oBAAoB;AACtD;AACD;AAAA,IACD;AACA;AAAA,EACD;AAGA,MAAI;AACH,WAAO,SAAS;AACjB,MAAI;AACH,WAAO,SAAS;AACjB;AACD;;;ACzCO,SAAS,8BACf,MACA,QAgB0B;AAE1B,QAAM;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACD,IAAI;AACJ,QAAM,cAAuC,CAAC;AAG9C,MAAI,oBAAoB;AACxB,WAAS,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK;AACrC,UAAMC,KAAI,KAAK,CAAC;AAEhB,QAAI,IAAI,KAAK,KAAK,IAAI,CAAC,EAAE,gBAAgBA,GAAE,aAAa;AACvD,0BAAoB;AAAA,IACrB;AAEA,UAAM,aAAa,IAAI,KAAK,YAAY,IAAI,CAAC;AAC7C,UAAM,eAAe,IAAI,KAAK,cAAc,IAAI,CAAC;AACjD,UAAM,aAAa,IAAI,KAAK,YAAY,IAAI,CAAC;AAC7C,UAAM,eAAe,IAAI,KAAK,cAAc,IAAI,CAAC;AACjD,UAAM,cAAc,IAAI,KAAK,aAAa,IAAI,CAAC;AAC/C,UAAM,gBAAgB,IAAI,KAAK,eAAe,IAAI,CAAC;AACnD,UAAM,YAAY,YAAY,CAAC;AAC/B,UAAM,cAAc,cAAc,CAAC;AACnC,UAAM,YAAY,YAAY,CAAC;AAC/B,UAAM,cAAc,cAAc,CAAC;AACnC,UAAM,aAAa,aAAa,CAAC;AACjC,UAAM,eAAe,eAAe,CAAC;AACrC,UAAM,aAAoE,CAAC;AAC3E,QAAI,aAAa,CAAC,WAAY,YAAW,KAAK,EAAE,6BAAwC,OAAO,EAAE,CAAC;AAClG,QAAI,eAAe,CAAC,aAAc,YAAW,KAAK,EAAE,6BAAwC,OAAO,EAAE,CAAC;AACtG,QAAI,aAAa,CAAC,WAAY,YAAW,KAAK,EAAE,6BAAwC,OAAO,EAAE,CAAC;AAClG,QAAI,eAAe,CAAC,aAAc,YAAW,KAAK,EAAE,6BAAwC,OAAO,EAAE,CAAC;AACtG,QAAI,cAAc,CAAC,YAAa,YAAW,KAAK,EAAE,6BAAwC,OAAO,EAAE,CAAC;AACpG,QAAI,gBAAgB,CAAC,cAAe,YAAW,KAAK,EAAE,6BAAwC,OAAO,EAAE,CAAC;AAGxG,eAAW,KAAK,YAAY;AAC3B,UAAI,EAAE,QAAQ,oBAAoB,OAAQ;AAC1C,YAAM,WAAW,KAAK,IAAI,GAAG,EAAE,QAAQ,CAAC;AACxC,YAAM,SAAS,EAAE,QAAQ;AACzB,UAAI,SAAS,WAAW,IAAI,EAAG;AAC/B,YAAM,WAAW,EAAE;AACnB,YAAM,SAAS,EAAE,QAAQ,IAAI;AAC7B,UAAI,UAAU,KAAK,OAAQ;AAC3B,YAAM,UAAU,KACd,MAAM,UAAU,SAAS,CAAC,EAC1B,IAAI,CAAC,OAAO,GAAG,KAAK,EACpB;AAAA,QACA,CAAC,MAAmB,OAAO,MAAM,YAAY,OAAO,SAAS,CAAC;AAAA,MAC/D;AACD,YAAM,UAAU,KACd,MAAM,UAAU,SAAS,CAAC,EAC1B,IAAI,CAAC,OAAO,GAAG,KAAK,EACpB;AAAA,QACA,CAAC,MAAmB,OAAO,MAAM,YAAY,OAAO,SAAS,CAAC;AAAA,MAC/D;AACD,UAAI,QAAQ,SAAS,KAAK,QAAQ,SAAS,EAAG;AAE9C,YAAM,OAAO,KAAK,EAAE,KAAK;AACzB,UAAI,QAAuB;AAC3B,UACC,OAAO,KAAK,sBAAsB,YAClC,OAAO,KAAK,SAAS,UACpB;AACD,cAAM,OAAO,KAAK,oBAAoB,KAAK;AAC3C,YAAI,OAAO,EAAG,SAAQ,OAAO;AAAA,MAC9B;AACA,UAAI,CAAC,SAAS,SAAS,EAAG;AAC1B,YAAM,UAAU,KAAK,OAAO;AAC5B,YAAM,UAAU,KAAK,OAAO;AAC5B,YAAM,YAAY,UAAU;AAC5B,UAAI,KAAK,IAAI,SAAS,IAAI,gBAAgB,MAAO;AAEjD,YAAM,UAAU,KAAK,MAAM,UAAU,SAAS,CAAC;AAC/C,YAAM,eAAe,QAAQ;AAAA,QAC5B,CAAC,OAAO,GAAG;AAAA,MACZ,EAAE;AACF,UAAI,eAAe,EAAG;AAEtB,YAAM,WAAW,CAAC,QAAkB;AACnC,cAAM,IAAI,KAAK,GAAG;AAClB,eAAO,IAAI,SACR,IAAI,OAAO,CAAC,GAAG,MAAM,KAAK,IAAI,MAAM,IAAI,IAAI,CAAC,IAAI,IAAI,SACrD;AAAA,MACJ;AACA,YAAM,SAAS,SAAS,OAAO;AAC/B,YAAM,SAAS,SAAS,OAAO;AAC/B,UAAI,YACH,EAAE,iCACC,KACA,EAAE,iCACF,KACA;AACJ,UAAI,SAAS,OAAQ,cAAa;AAClC,mBAAa,eAAe;AAC5B,UAAI,YAAY,eAAgB;AAChC,YAAM,WAAW,YAAY,KAAK,CAAC,MAAM,EAAE,UAAU,EAAE,KAAK;AAC5D,UAAI,UAAU;AACb,cAAM,WAAW,CAAC,WACjB,iCACG,IACA,iCACA,IACA;AACJ,YACC,SAAS,EAAE,MAAM,IAAI,SAAS,SAAS,MAAM,KAC7C,YAAY,SAAS,OACpB;AACD,mBAAS,SAAS,EAAE;AACpB,mBAAS,QAAQ;AACjB,mBAAS,YAAY;AACrB,mBAAS,UAAU;AACnB,mBAAS,UAAU;AACnB,mBAAS,SAAS,CAAC,UAAU,MAAM;AAAA,QACpC;AAAA,MACD,OAAO;AACN,oBAAY,KAAK;AAAA,UAChB,OAAO,EAAE;AAAA,UACT,QAAQ,EAAE;AAAA,UACV,OAAO;AAAA,UACP;AAAA,UACA;AAAA,UACA;AAAA,UACA,QAAQ,CAAC,UAAU,MAAM;AAAA,QAC1B,CAAC;AAAA,MACF;AAAA,IACD;AAAA,EACD;AACA,cAAY,KAAK,CAAC,GAAG,MAAM,EAAE,QAAQ,EAAE,KAAK;AAC5C,SAAO;AACR;;;AC7IA,SAAS,iBAA0B;AAvCnC,MAAAC;AAyCC,QAAM,IAAU;AAChB,MAAI,OAAO,EAAE,wBAAwB,YAAa,QAAO,CAAC,CAAC,EAAE;AAE7D,MAAI,OAAO,YAAY,aAAa;AACnC,UAAM,KAAKA,MAAA,mCAAiB,QAAjB,gBAAAA,IAAsB;AACjC,QAAI,OAAO,MAAM,aAAa;AAC7B,YAAM,IAAI,OAAO,CAAC,EAAE,YAAY;AAChC,UAAI,MAAM,OAAO,MAAM,OAAQ,QAAO;AACtC,UAAI,MAAM,OAAO,MAAM,QAAS,QAAO;AAAA,IACxC;AAAA,EACD;AAEA,SAAO;AACR;AAsOO,IAAK,qBAAL,kBAAKC,wBAAL;AACN,EAAAA,oBAAA,UAAO;AACP,EAAAA,oBAAA,aAAU;AACV,EAAAA,oBAAA,WAAQ;AAHG,SAAAA;AAAA,GAAA;AAKL,IAAK,qBAAL,kBAAKC,wBAAL;AACN,EAAAA,oBAAA,YAAS;AACT,EAAAA,oBAAA,UAAO;AACP,EAAAA,oBAAA,YAAS;AACT,EAAAA,oBAAA,kBAAe;AACf,EAAAA,oBAAA,cAAW;AACX,EAAAA,oBAAA,WAAQ;AACR,EAAAA,oBAAA,YAAS;AACT,EAAAA,oBAAA,WAAQ;AACR,EAAAA,oBAAA,eAAY;AATD,SAAAA;AAAA,GAAA;AAaL,IAAK,iBAAL,kBAAKC,oBAAL;AACN,EAAAA,gBAAA,sBAAmB;AACnB,EAAAA,gBAAA,8BAA2B;AAC3B,EAAAA,gBAAA,0BAAuB;AACvB,EAAAA,gBAAA,wBAAqB;AACrB,EAAAA,gBAAA,4BAAyB;AACzB,EAAAA,gBAAA,wBAAqB;AACrB,EAAAA,gBAAA,iCAA8B;AAC9B,EAAAA,gBAAA,8BAA2B;AAC3B,EAAAA,gBAAA,yBAAsB;AACtB,EAAAA,gBAAA,sBAAmB;AAVR,SAAAA;AAAA,GAAA;AAoCL,SAAS,4BAA4B,KAAa;AACxD,QAAM,UAAuB,CAAC;AAC9B,QAAM,YAAyB,CAAC;AAChC,MAAI,IAAI,0BAA2B,SAAQ,qCAA0B;AACrE,MAAI,IAAI,4BAA6B,WAAU,qCAA0B;AACzE,MAAI,IAAI,yBAA0B,SAAQ,+BAAuB;AACjE,MAAI,IAAI,2BAA4B,WAAU,+BAAuB;AACrE,MAAI,IAAI,oBAAqB,SAAQ,wBAAoB;AACzD,MAAI,IAAI,sBAAuB,WAAU,wBAAoB;AAC7D,MAAI,IAAI,oBAAqB,SAAQ,wBAAoB;AACzD,MAAI,IAAI,sBAAuB,WAAU,wBAAoB;AAC7D,QAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,OAAO,KAAK,IAAI,GAAG,cAAc,EAAE,EAAE,IAAI,GAAG,CAAC;AAC9E,QAAM,UAAU,UAAU,OAAO,CAAC,GAAG,OAAO,KAAK,IAAI,GAAG,cAAc,EAAE,EAAE,IAAI,GAAG,CAAC;AAClF,SAAO,EAAE,SAAS,WAAW,OAAO,SAAS,OAAO,QAAQ,SAAO,GAAG,SAAS,UAAU,SAAO,EAAE;AACnG;AAkBA,SAAS,cAAc,MAAwC;AAC9D,QAAM,aAA+B,CAAC;AACtC,MAAI,UAA0B,CAAC;AAC/B,aAAW,OAAO,MAAM;AACvB,QAAI,IAAI,YAAY,QAAQ,QAAQ;AACnC,iBAAW,KAAK,OAAO;AACvB,gBAAU,CAAC;AAAA,IACZ;AACA,YAAQ,KAAK,GAAG;AAAA,EACjB;AACA,MAAI,QAAQ,OAAQ,YAAW,KAAK,OAAO;AAC3C,SAAO;AACR;AAGA,SAAS,gCACR,MACA,UACA,mBACC;AArYF,MAAAH;AAsYC,QAAM,SAAS,SAAS,8BAA8B,SAAS,2BAA2B;AAC1F,MAAI,KAAK,SAAS,SAAS,EAAG;AAG9B,QAAM,UAA4C,KAChD,IAAI,CAACI,IAAG,OAAO,EAAE,KAAK,GAAG,OAAOA,GAAE,MAAO,EAAE,EAC3C,OAAO,OAAK,SAAS,EAAE,KAAK,CAAC;AAC/B,MAAI,QAAQ,SAAS,SAAS,EAAG;AAGjC,QAAM,WAAW,uCAAiD;AAClE,QAAM,aAAa;AAEnB,WAAS,WAAW,MAAc,aAAqB;AACtD,UAAMC,SAAQ,QAAQ,MAAM,MAAM,WAAW,EAAE,IAAI,OAAK,EAAE,KAAK;AAC/D,WAAOA,OAAM,SAAS,KAAKA,MAAiB,IAAI;AAAA,EACjD;AAEA,MAAI,QAAuB;AAC3B,MAAI,QAAQ,SAAS,GAAG;AACvB,UAAM,QAAkB,CAAC;AACzB,aAAS,IAAE,GAAE,IAAE,QAAQ,QAAO,IAAK,OAAM,KAAK,KAAK,IAAI,QAAQ,CAAC,EAAE,QAAQ,QAAQ,IAAE,CAAC,EAAE,KAAK,CAAC;AAC7F,UAAM,QAAQ,KAAK,KAAiB;AACpC,QAAI,SAAS,KAAK,KAAK,QAAQ,EAAG,SAAQ,SAAS,OAAK;AAAA,EACzD;AACA,MAAI,CAAC,SAAS,SAAS,EAAG;AAC1B,QAAM,kBAAiBL,MAAA,SAAS,8BAAT,OAAAA,MAAsC;AAE7D,WAAS,QAAQ,QAAQ,SAAS,QAAQ,SAAS,QAAQ,SAAS;AACnE,UAAM,WAAW,QAAQ;AACzB,UAAM,UAAU,WAAW,UAAU,KAAK;AAC1C,UAAM,WAAW,WAAW,OAAO,QAAQ,MAAM;AACjD,QAAI,CAAC,SAAS,OAAO,KAAK,CAAC,SAAS,QAAQ,EAAG;AAC/C,UAAM,QAAQ,WAAW;AACzB,UAAM,aAAa,QAAQ;AAC3B,UAAM,aAAa,WAAW,cAAc,iBAAiB,aAAa,CAAC,cAAc,iBAAiB,KAAK,IAAI,UAAU,KAAK;AAClI,QAAI,CAAC,WAAY;AAEjB,UAAM,WAAW,QAAQ,MAAM,OAAO,QAAQ,MAAM,EAAE,IAAI,OAAK,EAAE,KAAK;AACtE,UAAM,cAAc,WAAW,SAAS,MAAM,OAAK,IAAI,OAAO,IAAI,aAAa,SAAS,MAAM,OAAK,IAAI,OAAO,IAAI,SAAS,MAAM,OAAK,WAAW,IAAI,UAAU,IAAI,OAAO;AAC1K,QAAI,CAAC,YAAa;AAElB,UAAM,cAAc,QAAQ,KAAK,EAAE;AACnC,QAAI,CAAC,KAAK,WAAW,EAAE,UAAU;AAChC,WAAK,WAAW,EAAE,WAAW;AAAA,IAC9B;AACA;AAAA,EACD;AACD;AAgCO,SAAS,qBAAqB,MAAoC;AAtdzE,MAAAA,KAAAM,KAAA;AAudC,MAAI,CAAC,KAAM,QAAO,CAAC;AACnB,QAAM,SAAS;AACf,QAAM,KAAK;AAGX,QAAM,SAAQN,MAAA,GAAG,UAAH,OAAAA,MAAY,CAAC;AAC3B,QAAM,cAAaM,MAAA,GAAG,eAAH,OAAAA,MAAiB,CAAC;AACrC,QAAM,cAAa,QAAG,eAAH,YAAiB,CAAC;AACrC,QAAM,YAAW,QAAG,aAAH,YAAe,CAAC;AACjC,QAAM,aAAY,QAAG,cAAH,YAAgB,CAAC;AACnC,QAAM,cAAa,QAAG,eAAH,YAAiB,CAAC;AACrC,QAAM,SAAQ,QAAG,UAAH,YAAY,CAAC;AAC3B,QAAM,mBAAkB,QAAG,oBAAH,YAAsB,CAAC;AAC/C,QAAM,cAAa,QAAG,eAAH,YAAiB,CAAC;AAGrC,QAAM,wBAAwB,uBAAM,oBAAN,YAAyB,GAAG,yBAA5B,YAAoD,OAAO,yBAA3D,YAAmF,OAAO;AACxH,QAAM,8BAA8B,uBAAM,+BAAN,YAAoC,GAAG,+BAAvC,YAAqE,OAAO,+BAA5E,YAA0G,OAAO;AAGrJ,MAAI,eAAe,GAAG;AACrB,QAAI,OAAO,2BAA2B,QAAW;AAChD,YAAM,IAAI,MAAM,kGAAkG;AAAA,IACnH;AACA,QAAI,OAAO,yBAAyB,QAAW;AAC9C,YAAM,IAAI,MAAM,2GAA2G;AAAA,IAC5H;AAAA,EACD;AAGA,QAAM,YAAY;AAClB,MAAI,CAAC,eAAe,KAAK,OAAO,2BAA2B,UAAa,GAAG,yBAAyB,UAAa,MAAM,oBAAoB,UAAa,CAAC,UAAU,mCAAmC;AACrM,cAAU,oCAAoC;AAC9C,YAAQ,KAAK,uEAAuE;AAAA,EACrF;AACA,MAAI,CAAC,eAAe,KAAK,OAAO,yBAAyB,UAAa,MAAM,+BAA+B,UAAa,GAAG,+BAA+B,UAAa,CAAC,UAAU,iCAAiC;AAClN,cAAU,kCAAkC;AAC5C,YAAQ,KAAK,gFAAgF;AAAA,EAC9F;AAGA,QAAM,iBAAiB,CAAgC,QAAuB;AAC7E,UAAM,MAA2B,CAAC;AAClC,eAAW,KAAK,OAAO,KAAK,GAAG,GAAG;AACjC,YAAM,IAAK,IAAY,CAAC;AACxB,UAAI,MAAM,OAAW,KAAI,CAAC,IAAI;AAAA,IAC/B;AACA,WAAO;AAAA,EACR;AAGA,QAAM,YAAyB,eAA4B;AAAA;AAAA,IAE1D,6BAA4B,eAAU,+BAAV,YAAwC,OAAO;AAAA;AAAA,IAE3E,0BAAyB,WAAM,gBAAN,YAAqB,OAAO;AAAA,IACrD,0BAAyB,WAAM,gBAAN,YAAqB,OAAO;AAAA,IACrD,uBAAsB,WAAM,sBAAN,YAA2B,OAAO;AAAA,IACxD,gCAA+B,WAAM,6BAAN,YAAkC,OAAO;AAAA,IACxE,4BAA4B,kEAA8B,OAAO;AAAA;AAAA,IAEjE,qBAAoB,gBAAW,aAAX,YAAuB,OAAO;AAAA,IAClD,yBAAwB,gBAAW,iBAAX,YAA2B,OAAO;AAAA;AAAA,IAE1D,gBAAe,gBAAW,kBAAX,YAA4B,OAAO;AAAA,IAClD,yBAAwB,gBAAW,2BAAX,YAAqC,OAAO;AAAA,IACpE,yBAAyB,gBAAW,2BAAX,YAAqC,OAAO;AAAA,IACrE,gBAAgB,gBAAW,kBAAX,YAA4B,OAAO;AAAA,IACnD,yBAAwB,gBAAW,2BAAX,YAAqC,OAAO;AAAA;AAAA,IAEpE,uBAAsB,cAAS,yBAAT,YAAiC,OAAO;AAAA,IAC9D,uBAAsB,cAAS,yBAAT,YAAiC,OAAO;AAAA,IAC9D,+BAA8B,cAAS,iCAAT,YAAyC,OAAO;AAAA,IAC9E,mBAAkB,cAAS,qBAAT,YAA6B,OAAO;AAAA,IACtD,0BAAyB,cAAS,4BAAT,YAAoC,OAAO;AAAA,IACpE,0BAAyB,cAAS,4BAAT,YAAoC,OAAO;AAAA,IACpE,wBAAuB,cAAS,0BAAT,YAAkC,OAAO;AAAA,IAChE,8BAA6B,cAAS,gCAAT,YAAwC,OAAO;AAAA,IAC5E,wBAAuB,cAAS,0BAAT,YAAkC,OAAO;AAAA;AAAA,IAEhE,0BAAyB,gBAAW,4BAAX,YAAsC,OAAO;AAAA;AAAA,IAEtE;AAAA,IACA,wBAAwB;AAAA;AAAA,IAExB,kBAAiB,qBAAgB,YAAhB,YAA2B,OAAO;AAAA,IACnD,+BAA8B,qBAAgB,kBAAhB,YAAiC,OAAO;AAAA,IACtE,iCAAgC,qBAAgB,oBAAhB,YAAmC,OAAO;AAAA,IAC1E,wBAAuB,qBAAgB,WAAhB,YAA0B,OAAO;AAAA,IACxD,gCAA+B,qBAAgB,mBAAhB,YAAkC,OAAO;AAAA;AAAA,IAExE,4BAA2B,gBAAW,YAAX,YAAsB,OAAO;AAAA,IACxD,6BAA4B,gBAAW,gBAAX,YAA0B,OAAO;AAAA,IAC7D,4BAA2B,gBAAW,eAAX,YAAyB,OAAO;AAAA,EAC5D,CAAgB;AAGhB,QAAM,SAAsB,EAAE,GAAG,WAAW,GAAG,eAA4B,MAAM,EAAE;AAEnF,MAAI,yBAAyB,QAAW;AACvC,IAAC,OAAe,uBAAuB;AACvC,IAAC,OAAe,QAAQ,EAAE,GAAI,OAAe,OAAO,iBAAiB,qBAAqB;AAAA,EAC3F;AACA,MAAK,UAAkB,+BAA+B,QAAW;AAChE,UAAM,IAAK,UAAkB;AAC7B,IAAC,OAAe,6BAA6B;AAC7C,IAAC,OAAe,QAAQ,EAAE,GAAI,OAAe,OAAO,4BAA4B,EAAE;AAAA,EACnF;AAEA,SAAO,eAA4B,MAAM;AAC1C;AAEO,SAAS,SAAS,MAA+B;AAvkBxD,MAAAN,KAAAM,KAAA;AAwkBC,QAAM;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA,UAAU,kBAAkB,CAAC;AAAA,EAC9B,IAAI;AAGJ,QAAM,eAAe,qBAAqB,eAAe;AAEzD,QAAM,WAAW;AAAA,IAChB,4BAA4B;AAAA,IAC5B,yBAAyB;AAAA,IACzB,yBAAyB;AAAA,IACzB,sBAAsB;AAAA,IACtB,eAAe;AAAA,IACf,sBAAsB;AAAA,IACtB,wBAAwB;AAAA,IACxB,wBAAwB;AAAA,IACxB,eAAe;AAAA,IACf,sBAAsB;AAAA,IACtB,8BAA8B;AAAA,IAC9B,kBAAkB;AAAA,IAClB,yBAAyB;AAAA,IACzB,yBAAyB;AAAA,IACzB,uBAAuB;AAAA,IACvB,6BAA6B;AAAA,IAC7B,uBAAuB;AAAA,IACvB,yBAAyB;AAAA,IACzB,wBAAwB;AAAA,IACxB,4BAA4B;AAAA,IAC5B,iBAAiB;AAAA,IACjB,8BAA8B;AAAA,IAC9B,gCAAgC;AAAA,IAChC,uBAAuB;AAAA,IACvB,+BAA+B;AAAA,IAC/B;AAAA,IACA,wBAAwB;AAAA,IACxB,OAAO,CAAC;AAAA,IACR,OAAO,CAAC;AAAA;AAAA,IAER,2BAA2B;AAAA,IAC3B,4BAA4B;AAAA,IAC5B,2BAA2B;AAAA,IAC3B,GAAG;AAAA,EACJ;AAEA,MAAI,CAAC,MAAM,QAAQ,IAAI,EAAG,OAAM,IAAI,MAAM,+BAA+B;AACzE,QAAM,YAA4B,KAAK,IAAI,CAAC,GAAG,OAAO;AAAA,IACrD,OAAO,IAAI;AAAA,IACX,GAAG,EAAE;AAAA,IACL,OAAO,SAAS,EAAE,KAAK,IAAI,EAAE,QAAQ;AAAA,IACrC,OAAO,CAAC,CAAC,EAAE;AAAA,IACX,UAAU,CAAC,CAAC,EAAE;AAAA,IACd,QAAQ,SAAS,EAAE,MAAM,IAAI,EAAE,SAAS;AAAA,EACzC,EAAE;AAGF,MAAI,6CAAc,2BAA2B;AAC5C,QAAI;AACH,sCAAgC,WAAW,cAAc,iBAAiB;AAAA,IAC3E,QAAQ;AAAA,IAER;AAAA,EACD;AACA,QAAM,aAAa,cAAc,SAAS;AAC1C,QAAM,SAAmB,CAAC;AAC1B,QAAM,WAAyB,CAAC;AAGhC,QAAM,sBAAsB,UAAU;AAAA,IACrC,CAACF,OAAM,CAACA,GAAE,SAAS,SAASA,GAAE,KAAK;AAAA,EACpC,EAAE;AACF,QAAM,eAAe,yBAAwBJ,MAAA,SAAS,kBAAT,OAAAA,MAA0B;AAGvE,MAAI,cAAc;AAClB,QAAM,0BAAkD,CAAC;AACzD,aAAW,QAAQ,YAAY;AAC9B;AAEA,UAAM,SAAS,KAAK,IAAI,CAACI,OAAMA,GAAE,KAAK;AACtC,UAAM,SAAS,KAAK,IAAI,CAACA,OAAMA,GAAE,KAAK;AAGtC,QAAI,KAAwB,IAAI,MAAM,OAAO,MAAM,EAAE,KAAK,IAAI;AAC9D,QAAI,aAAqB;AACzB,QAAI,SAAiB;AACrB,QAAI,QAAgB;AAKpB,QAAI,MAOA;AAAA,MACH,mBAAmB;AAAA,MACnB,mBAAmB;AAAA,MACnB,eAAe;AAAA,MACf,eAAe;AAAA,MACf,eAAe;AAAA,MACf,eAAe;AAAA,IAChB;AAOA,QAAI,cAAc,OAAO;AACxB,WAAK,aAAa,QAAQ,MAAM;AAChC,YAAM,eAAe,OAAO;AAAA,QAC3B,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,KAAK,SAAS,CAAC;AAAA,MACnC;AACA,mBAAa,aAAa,SAAS,KAAK,YAAY,IAAI;AACxD,YAAM,MAAM;AAAA,QACX;AAAA,QACA,CAAC,CAAC,SAAS;AAAA,MACZ;AACA,eAAS,IAAI;AACb,cAAQ,IAAI;AACZ,YAAM,UAAU,YAAY,MAAM;AAAA,IACnC,WAAW,cAAc,KAAK;AAC7B,YAAM,OAAO;AAAA,QACZ;AAAA,QACA;AAAA,QACA,CAAC,CAAC,SAAS;AAAA,MACZ;AACA,WAAK,KAAK;AACV,gBAASE,MAAA,KAAK,WAAL,OAAAA,MAAe;AACxB,eAAQ,UAAK,UAAL,YAAc;AACtB,oBAAa,UAAK,WAAL,YAAe;AAC5B,YAAM;AAAA,QACL,mBAAmB,KAAK;AAAA,QACxB,mBAAmB,KAAK;AAAA,QACxB,eAAe,KAAK;AAAA,QACpB,eAAe,KAAK;AAAA,QACpB,eAAe,KAAK;AAAA,QACpB,eAAe,KAAK;AAAA,MACrB;AAAA,IACD,WAAW,cAAc,KAAK;AAC7B,YAAM,eAAe,OAAO;AAAA,QAC3B,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,KAAK,SAAS,CAAC;AAAA,MACnC;AACA,YAAM,QAAQ,aAAa,SAAS,KAAK,YAAY,IAAI;AACzD,YAAM,IAAI,wBAAwB,KAAK;AACvC,oBAAa,OAAE,OAAF,YAAQ;AACrB,YAAM;AAAA,QACL,mBAAmB,EAAE;AAAA,QACrB,mBAAmB,EAAE;AAAA,QACrB,eAAe,EAAE;AAAA,QACjB,eAAe,EAAE;AAAA,QACjB,eAAe,EAAE;AAAA,QACjB,eAAe,EAAE;AAAA,MAClB;AAEA,WAAK,IAAI,MAAM,OAAO,MAAM,EAAE,KAAK,IAAI;AACvC,eAAS;AACT,cAAQ;AAAA,IACT,OAAO;AACN,eAAS,KAAK;AAAA,QACb,MAAM;AAAA,QACN,UAAU;AAAA,QACV,UAAU;AAAA,QACV,SAAS,sBAAsB,SAAS;AAAA,QACxC,SAAS,EAAE,UAAU;AAAA,MACtB,CAAC;AAAA,IACF;AAKA,UAAM,YAAsB,KAAK,IAAI,CAACF,IAAG,MAAM;AAC9C,YAAM,YACL,CAACA,GAAE,SAAS,SAASA,GAAE,KAAK,IACzB,OAAO,MAAM,GAAG,IAAI,CAAC,EAAE,OAAO,CAAC,GAAG,MAAM,CAAC,OAAO,CAAC,KAAK,SAAS,CAAC,CAAC,EAChE,SACD;AAEJ,YAAM,gBAAgB;AACtB,YAAM,SAAS,gBACZ,MACA;AAAA,QACA,mBAAmB;AAAA,QACnB,mBAAmB;AAAA,QACnB,eAAe;AAAA,QACf,eAAe;AAAA,QACf,eAAe;AAAA,QACf,eAAe;AAAA,MAChB;AAEF,YAAM,MAAc;AAAA,QACnB,OAAOA,GAAE;AAAA,QACT,GAAGA,GAAE;AAAA,QACL,OAAO,SAASA,GAAE,KAAK,IAAIA,GAAE,QAAQ;AAAA,QACrC,OAAOA,GAAE;AAAA,QACT;AAAA,QACA;AAAA,QACA,MAAM,iBAAiB,SAAS,UAAU,IAAI,aAAa;AAAA,QAC3D,IAAI,SAAS,GAAG,CAAC,CAAC,IAAI,GAAG,CAAC,IAAI;AAAA,QAC9B,QAAQ,iBAAiB,SAAS,MAAM,IAAI,SAAS;AAAA,QACrD,OAAO,iBAAiB,SAAS,KAAK,IAAI,QAAQ;AAAA,QAClD,mBAAmB,SAAS,OAAO,iBAAiB,IACjD,OAAO,oBACP;AAAA,QACH,mBAAmB,SAAS,OAAO,iBAAiB,IACjD,OAAO,oBACP;AAAA,QACH,eAAe,SAAS,OAAO,aAAa,IACzC,OAAO,gBACP;AAAA,QACH,eAAe,SAAS,OAAO,aAAa,IACzC,OAAO,gBACP;AAAA,QACH,eAAe,SAAS,OAAO,aAAa,IACzC,OAAO,gBACP;AAAA,QACH,eAAe,SAAS,OAAO,aAAa,IACzC,OAAO,gBACP;AAAA,QACH,QAAQ,SAASA,GAAE,MAAM,IAAIA,GAAE,SAAS;AAAA,QACxC,+BAA+B;AAAA;AAAA,QAE/B,2BAA2B;AAAA,QAC3B,6BAA6B;AAAA,QAC7B,0BAA0B;AAAA,QAC1B,4BAA4B;AAAA,QAC5B,0BAA0B;AAAA,QAC1B,4BAA4B;AAAA,QAC5B,qBAAqB;AAAA,QACrB,uBAAuB;AAAA,QACvB,qBAAqB;AAAA,QACrB,uBAAuB;AAAA,QACvB;AAAA,QACA;AAAA,QACA,eACC,iBAAiB,SAAS,UAAU,IAAI,aAAa;AAAA,QACtD,eACC,iBAAiB,SAAS,UAAU,IAAI,aAAa;AAAA,QACtD,2BACC,iBAAiB,SAAS,KAAK,IAAI,QAAQ;AAAA,QAC5C,YAAYA,GAAE,SAAS,SAASA,GAAE,KAAK,IAAIA,GAAE,QAAQ;AAAA,QACrD,WAAW,CAAC,CAACA,GAAE;AAAA,QACf,8BAA8B;AAAA,QAC9B,0BAA0B;AAAA,QAC1B,0BAA0B;AAAA,QAC1B,UAAU,CAAC;AAAA,MACZ;AACA,aAAO;AAAA,IACR,CAAC;AAED,4BAAwB,WAAW,IAAI,UAAU;AAAA,MAChD,CAACA,OAAM,CAACA,GAAE,SAAS,SAASA,GAAE,KAAK;AAAA,IACpC,EAAE;AAGF,UAAM,UAAS,cAAS,4BAAT,YAAoC;AACnD,UAAM,UAAS,cAAS,4BAAT,YAAoC;AAGnD,UAAM,kBAA4B,CAAC;AACnC,UAAM,iBAA2B,CAAC;AAClC,aAAS,IAAI,GAAG,IAAI,UAAU,QAAQ,KAAK;AAC1C,YAAM,MAAM,UAAU,CAAC;AACvB,YAAM,IAAI,IAAI;AACd,UAAI,CAAC,IAAI,SAAS,SAAS,CAAC,GAAG;AAC9B,wBAAgB,KAAK,CAAC;AACtB,uBAAe,KAAK,CAAC;AAAA,MACtB;AAEA,YAAM,YACL,SAAS,IAAI,IAAI,KACjB,SAAS,IAAI,iBAAiB,KAC9B,SAAS,IAAI,iBAAiB;AAC/B,UAAI,CAAC,aAAa,IAAI,SAAS,CAAC,SAAS,CAAC,GAAG;AAC5C,eAAO,KAAK,GAAG;AACf;AAAA,MACD;AAGA,UAAI,4BAA4B,SAAS,IAAI,iBAAiB,IAC3D,IAAI,IAAI,oBACR;AACH,UAAI,8BAA8B,SAAS,IAAI,iBAAiB,IAC7D,IAAI,IAAI,oBACR;AAOH,aAAO,KAAK,GAAG;AAAA,IAChB;AAGA,QAAI,gBAAgB,QAAQ;AAE3B,YAAM,SAAS,CAAC,QAAgB,UAAU,GAAG;AAE7C,UAAI,UAAoB,CAAC;AACzB,UAAI,SAAmB,CAAC;AACxB,iBAAW,YAAY,iBAAiB;AACvC,cAAMA,KAAI,OAAO,QAAQ;AACzB,YAAI,CAAC,SAASA,GAAE,IAAI,KAAK,CAAC,SAASA,GAAE,KAAK,GAAG;AAAE,oBAAU,CAAC;AAAG,mBAAS,CAAC;AAAG;AAAA,QAAU;AACpF,YAAIA,GAAE,QAAQA,GAAE,MAAM;AAAE,kBAAQ,KAAK,QAAQ;AAAG,mBAAS,CAAC;AAAA,QAAG,WAAWA,GAAE,QAAQA,GAAE,MAAM;AAAE,iBAAO,KAAK,QAAQ;AAAG,oBAAU,CAAC;AAAA,QAAG,OAAO;AAAE,oBAAU,CAAC;AAAG,mBAAS,CAAC;AAAA,QAAG;AACrK,YAAI,QAAQ,UAAU,QAAQ;AAC7B,qBAAW,KAAK,SAAS;AAAE,kBAAM,KAAK,OAAO,CAAC;AAAG,eAAG,sBAAsB;AAAA,UAAM;AAAA,QACjF;AACA,YAAI,OAAO,UAAU,QAAQ;AAC5B,qBAAW,KAAK,QAAQ;AAAE,kBAAM,KAAK,OAAO,CAAC;AAAG,eAAG,wBAAwB;AAAA,UAAM;AAAA,QAClF;AAAA,MACD;AAGA,eAAS,IAAI,GAAG,KAAK,gBAAgB,SAAS,GAAG,KAAK;AACrD,cAAM,YAAY,gBAAgB,MAAM,GAAG,IAAI,CAAC;AAChD,cAAM,QAAQ,UAAU,IAAI,MAAM;AAClC,YAAI,CAAC,MAAM,MAAM,CAAAA,OAAK,SAASA,GAAE,IAAI,KAAK,SAASA,GAAE,KAAK,CAAC,EAAG;AAC9D,cAAM,UAAU,MAAM,CAAC,EAAE;AACzB,cAAM,cAAc,MAAM,MAAM,CAAAA,OAAKA,GAAE,QAAS,OAAO;AACvD,cAAM,aAAa,MAAM,MAAM,CAAAA,OAAKA,GAAE,QAAS,OAAO;AACtD,YAAI,CAAC,eAAe,CAAC,WAAY;AACjC,cAAM,MAAK,WAAM,CAAC,EAAE,kBAAT,YAA0B;AACrC,cAAM,MAAK,WAAM,CAAC,EAAE,kBAAT,YAA0B;AACrC,cAAM,MAAK,WAAM,CAAC,EAAE,sBAAT,YAA8B;AACzC,cAAM,MAAK,WAAM,CAAC,EAAE,sBAAT,YAA8B;AAEzC,cAAM,aAAa,MAAM,OAAO,CAAAA,OAAKA,GAAE,QAAS,MAAMA,GAAE,SAAU,EAAE;AACpE,cAAM,YAAY,MAAM,OAAO,CAAAA,OAAKA,GAAE,QAAS,MAAMA,GAAE,SAAU,EAAE;AACnE,YAAI,eAAe,WAAW,UAAU,GAAG;AAC1C,qBAAWA,MAAK,YAAY;AAAE,YAAAA,GAAE,2BAA2B;AAAA,UAAM;AAAA,QAClE;AACA,YAAI,cAAc,UAAU,UAAU,GAAG;AACxC,qBAAWA,MAAK,WAAW;AAAE,YAAAA,GAAE,6BAA6B;AAAA,UAAM;AAAA,QACnE;AAAA,MACD;AAEA,UAAI,SAAS,sBAAsB;AAClC,iBAAS,IAAI,GAAG,KAAK,gBAAgB,SAAS,GAAG,KAAK;AACrD,gBAAM,YAAY,gBAAgB,MAAM,GAAG,IAAI,CAAC;AAChD,gBAAM,QAAQ,UAAU,IAAI,MAAM;AAClC,cAAI,CAAC,MAAM,MAAM,CAAAA,OAAK,SAASA,GAAE,IAAI,KAAK,SAASA,GAAE,KAAK,CAAC,EAAG;AAC9D,gBAAM,UAAU,MAAM,CAAC,EAAE;AACzB,cAAI,CAAC,MAAM,MAAM,CAAAA,OAAKA,GAAE,QAAS,OAAO,KAAK,CAAC,MAAM,MAAM,CAAAA,OAAKA,GAAE,QAAS,OAAO,EAAG;AACpF,gBAAM,MAAK,WAAM,CAAC,EAAE,kBAAT,YAA0B;AACrC,gBAAM,MAAK,WAAM,CAAC,EAAE,kBAAT,YAA0B;AACrC,gBAAM,aAAa,MAAM,OAAO,CAAAA,OAAKA,GAAE,QAAS,EAAE;AAClD,gBAAM,YAAY,MAAM,OAAO,CAAAA,OAAKA,GAAE,QAAS,EAAE;AACjD,cAAI,MAAM,MAAM,CAAAA,OAAKA,GAAE,QAAS,OAAO,KAAK,WAAW,UAAU,GAAG;AACnE,uBAAWA,MAAK,YAAY;AAAE,cAAAA,GAAE,2BAA2B;AAAA,YAAM;AAAA,UAClE;AACA,cAAI,MAAM,MAAM,CAAAA,OAAKA,GAAE,QAAS,OAAO,KAAK,UAAU,UAAU,GAAG;AAClE,uBAAWA,MAAK,WAAW;AAAE,cAAAA,GAAE,6BAA6B;AAAA,YAAM;AAAA,UACnE;AAAA,QACD;AAAA,MACD;AAEA,eAAS,IAAI,GAAG,KAAK,gBAAgB,SAAS,QAAQ,KAAK;AAC1D,cAAM,YAAY,gBAAgB,MAAM,GAAG,IAAI,MAAM;AACrD,cAAM,QAAQ,UAAU,IAAI,MAAM;AAClC,YAAI,CAAC,MAAM,MAAM,CAAAA,OAAI,SAASA,GAAE,KAAK,CAAC,EAAG;AACzC,YAAI,MAAM;AAAM,YAAI,MAAM;AAC1B,iBAAS,IAAE,GAAE,IAAE,MAAM,QAAO,KAAK;AAChC,cAAI,EAAE,MAAM,CAAC,EAAE,QAAS,MAAM,IAAE,CAAC,EAAE,OAAS,OAAM;AAClD,cAAI,EAAE,MAAM,CAAC,EAAE,QAAS,MAAM,IAAE,CAAC,EAAE,OAAS,OAAM;AAClD,cAAI,CAAC,OAAO,CAAC,IAAK;AAAA,QACnB;AACA,YAAI,IAAK,YAAW,KAAK,WAAW;AAAE,gBAAM,KAAK,OAAO,CAAC;AAAG,aAAG,sBAAsB;AAAA,QAAM;AAC3F,YAAI,IAAK,YAAW,KAAK,WAAW;AAAE,gBAAM,KAAK,OAAO,CAAC;AAAG,aAAG,wBAAwB;AAAA,QAAM;AAAA,MAC9F;AAGA,UAAI,SAAS,+BAA+B;AAC3C,YAAI,WAAqB,CAAC;AAC1B,mBAAW,YAAY,iBAAiB;AACvC,gBAAMA,KAAI,OAAO,QAAQ;AACzB,cAAI,CAAC,SAASA,GAAE,KAAK,KAAK,CAAC,SAASA,GAAE,IAAI,KAAK,CAAC,SAASA,GAAE,aAAa,KAAK,CAAC,SAASA,GAAE,aAAa,GAAG;AAAE,uBAAW,CAAC;AAAG;AAAA,UAAU;AACpI,gBAAM,SAASA,GAAE,QAAQA,GAAE,iBAAkBA,GAAE,QAAQA,GAAE;AACzD,cAAI,CAAC,QAAQ;AAAE,uBAAW,CAAC;AAAG;AAAA,UAAU;AACxC,mBAAS,KAAK,QAAQ;AACtB,cAAI,SAAS,UAAU,IAAI;AAC1B,kBAAM,UAAU,SAAS,IAAI,MAAM;AACnC,kBAAM,WAAW,QAAQ,KAAK,QAAM,GAAG,QAAS,GAAG,IAAK;AACxD,kBAAM,WAAW,QAAQ,KAAK,QAAM,GAAG,QAAS,GAAG,IAAK;AACxD,gBAAI,YAAY,UAAU;AACzB,yBAAW,KAAK,SAAU,QAAO,CAAC,EAAE,gCAAgC;AAAA,YACrE;AAAA,UACD;AAAA,QACD;AAAA,MACD;AAAA,IAGD;AAGA,QACC,SAAS,0BACT,OAAO,SAAS,SAAS,sBAAsB,GAC9C;AACD,YAAM,MAAM,SAAS;AACrB,UAAI,OAAO;AACX,iBAAW,OAAO,OAAO,OAAO,CAACA,OAAMA,GAAE,gBAAgB,WAAW,GAAG;AACtE,YAAI,CAAC,IAAI,SAAS,SAAS,IAAI,KAAK,EAAG;AACvC,YAAI,OAAO,KAAK;AACf,cAAI,OAAO,IAAI,oBAAoB,IAAI,oBAAoB;AAC3D,cAAI,gBACH,IAAI,gBACJ,IAAI,gBACJ,IAAI,gBACH;AAAA,QACH;AAAA,MACD;AAAA,IACD;AAAA,EAGD;AAMA,aAAWA,MAAK,QAAQ;AACvB,QAAIA,GAAE,YAAYA,GAAE,SAAS,OAAQ;AACrC,UAAM,OAAiB,CAAC;AACxB,QAAIA,GAAE,oBAAqB,MAAK,iCAA4B;AAC5D,QAAIA,GAAE,sBAAuB,MAAK,+BAA2B;AAC7D,QAAIA,GAAE,oBAAqB,MAAK,sCAAkC;AAClE,QAAIA,GAAE,sBAAuB,MAAK,sCAAkC;AACpE,QAAIA,GAAE,0BAA2B,MAAK,0CAAmC;AACzE,QAAIA,GAAE,4BAA6B,MAAK,0CAAmC;AAC3E,QAAIA,GAAE,yBAA0B,MAAK,+CAAkC;AACvE,QAAIA,GAAE,2BAA4B,MAAK,+CAAkC;AACzE,QAAIA,GAAE,yBAA0B,MAAK,+CAAkC;AACvE,QAAIA,GAAE,2BAA4B,MAAK,+CAAkC;AACzE,QAAIA,GAAE,8BAA+B,MAAK,kDAAoC;AAE9E,QAAI,KAAK,OAAQ,CAAAA,GAAE,WAAW;AAAA,EAC/B;AAQA,WAAS,MAAM,GAAG,MAAM,OAAO,QAAQ,OAAO;AAC7C,UAAM,MAAM,OAAO,GAAG;AAItB,QAAI,CAAE,OAAO,UAAU,eAAe,KAAK,wEAAmD,GAAI;AACjG,aAAO,eAAe,0EAAqD;AAAA,QAC1E,MAAM;AAlhCV,cAAAJ;AAkhCY,kBAAQA,MAAA,IAAY,yCAAZ,OAAAA,MAAoD;AAAA,QAAM;AAAA,QAC1E,YAAY;AAAA,QACZ,cAAc;AAAA,MACf,CAAC;AAAA,IACF;AACA,QAAI,CAAE,OAAO,UAAU,eAAe,KAAK,gEAA+C,GAAI;AAC7F,aAAO,eAAe,kEAAiD;AAAA,QACtE,MAAM;AAzhCV,cAAAA;AAyhCY,kBAAQA,MAAA,IAAY,qCAAZ,OAAAA,MAAgD;AAAA,QAAM;AAAA,QACtE,YAAY;AAAA,QACZ,cAAc;AAAA,MACf,CAAC;AAAA,IACF;AACA,QAAI,IAAI,SAAS,CAAC,SAAS,IAAI,KAAK,KAAK,IAAI,SAAS,MAAM;AAC3D,UAAI;AACJ;AAAA,IACD;AAGA,UAAM,aAAa,IAAI,QAAS,IAAI;AACpC,UAAM,YAAa,IAAI,QAAS,IAAI;AAGpC,SAAI,cAAS,UAAT,mBAAgB,4BAA4B;AAC/C,UAAI,IAAI,4BAA4B,IAAI,0BAA0B;AAAE,YAAI,2BAA2B;AAAA,MAAO;AAC1G,UAAI,IAAI,8BAA8B,IAAI,4BAA4B;AAAE,YAAI,6BAA6B;AAAA,MAAO;AAAA,IACjH;AAMA,UAAM,mBAAmB,IAAI,uBAAuB;AACpD,UAAM,qBAAqB,IAAI,yBAAyB;AACxD,UAAM,cAAe,IAAI,6BAA6B,IAAI,4BAA6B,SAAS,wBAAwB,IAAI,4BAA6B,IAAI,uBAAuB;AACpL,UAAM,aAAc,IAAI,+BAA+B,IAAI,8BAA+B,SAAS,wBAAwB,IAAI,8BAA+B,IAAI,yBAAyB;AAG3L,QAAI,qBAAqB;AACzB,QAAI,SAAS,wEAA+D,cAAS,UAAT,mBAAgB,oBAAmB,SAAS,wBAAwB,SAAS,yBAAyB;AACjL,YAAM,SAAS,SAAS,2BAA2B;AACnD,UAAI,SAAS,KAAK,EAAE,IAAI,uBAAuB,IAAI,wBAAwB;AAC1E,cAAM,SAAS,SAAS;AAExB,cAAM,MAAgB,CAAC;AACvB,iBAAS,OAAO,KAAK,QAAQ,KAAK,IAAI,SAAS,QAAQ,QAAQ;AAC9D,gBAAM,QAAQ,OAAO,IAAI;AACzB,cAAI,CAAC,MAAM,SAAS,SAAS,MAAM,KAAK,KAAK,MAAM,SAAS,KAAM,KAAI,QAAQ,KAAK;AAAA,QACpF;AACA,YAAI,IAAI,WAAW,QAAQ;AAC1B,cAAI,YAAY;AAChB,mBAAS,IAAI,GAAG,IAAI,IAAI,UAAU,WAAW,KAAK;AACjD,gBAAI,qCAA+C;AAClD,kBAAI,EAAE,IAAI,CAAC,EAAE,QAAS,IAAI,IAAE,CAAC,EAAE,OAAS,aAAY;AAAA,YACrD,WAAW,yCAAiD;AAC3D,kBAAI,EAAE,IAAI,CAAC,EAAE,QAAS,IAAI,IAAE,CAAC,EAAE,OAAS,aAAY;AAAA,YACrD,OAAO;AACN,0BAAY;AAAA,YACb;AAAA,UACD;AACA,+BAAqB;AAAA,QACtB;AAAA,MACD;AAAA,IACD;AAEA,QAAI,SAAS,mEAA4D;AAOxE,YAAM,gBAAgB,sCAAgD,cAAc,0CAAkD,aAAa;AAInJ,YAAM,aAAa;AACnB,YAAM,eAAe,sCAAgD,aAAa,0CAAkD,cAAc;AAClJ,UAAI,cAAc,CAAC,aAAc,KAAI;AAAA,eAC5B,gBAAgB,CAAC,WAAY,KAAI,gBAAgB;AAAA,eACjD,cAAc,aAAc,KAAI,gBAAiB,sBAAsB,IAAI,uBAAuB,IAAI;AAAA,UAC1G,KAAI;AAAA,IACV,OAAO;AACN,UAAI,oCAA+C,KAAI,gBAAgB,gDAA0C;AAAA,eACxG,wCAAiD,KAAI,gBAAgB,+CAAyC;AAAA,UAClH,KAAI;AAAA,IACV;AAIA,UAAM,YAAY,eAAe;AACjC,QAAI,+BACH,aAAa,IAAI,oDACd,IAAI,QACJ;AACJ,QAAI,2BACH,aAAa,IAAI,4CACd,IAAI,QACJ;AACJ,QAAI,2BACH,aAAa,IAAI,4CACd,IAAI,QACJ;AAGJ,QACC,SAAS,uEACT,IAAI,iCAAiC,QACrC,IAAI,6BAA6B,MAChC;AAGD,YAAM,SAAwD,CAAC;AAE/D,UAAI,IAAI,0BAA2B,QAAO,KAAK,EAAE,sCAA2B,MAAM,GAAG,oBAAc,CAAC;AACpG,UAAI,IAAI,4BAA6B,QAAO,KAAK,EAAE,sCAA2B,MAAM,GAAG,wBAAgB,CAAC;AACxG,UAAI,IAAI,yBAA0B,QAAO,KAAK,EAAE,gCAAwB,MAAM,GAAG,oBAAc,CAAC;AAChG,UAAI,IAAI,2BAA4B,QAAO,KAAK,EAAE,gCAAwB,MAAM,GAAG,wBAAgB,CAAC;AACpG,UAAI,IAAI,oBAAqB,QAAO,KAAK,EAAE,yBAAqB,MAAM,GAAG,oBAAc,CAAC;AACxF,UAAI,IAAI,sBAAuB,QAAO,KAAK,EAAE,yBAAqB,MAAM,GAAG,wBAAgB,CAAC;AAC5F,UAAI,IAAI,oBAAqB,QAAO,KAAK,EAAE,yBAAqB,MAAM,GAAG,oBAAc,CAAC;AACxF,UAAI,IAAI,sBAAuB,QAAO,KAAK,EAAE,yBAAqB,MAAM,GAAG,wBAAgB,CAAC;AAE5F,YAAM,QAAQ,OAAO,OAAO,OAAK,EAAE,sBAAgB,EAAE,OAAO,CAAC,GAAE,MAAK,KAAK,IAAI,GAAE,EAAE,IAAI,GAAG,CAAC;AACzF,YAAM,UAAU,OAAO,OAAO,OAAK,EAAE,0BAAkB,EAAE,OAAO,CAAC,GAAE,MAAK,KAAK,IAAI,GAAE,EAAE,IAAI,GAAG,CAAC;AAC7F,UAAI;AACJ,UAAI,QAAQ,QAAS;AAAA,eAAyC,UAAU,MAAO;AAAA,UAAuC;AACtH,YAAM,sBAAsB,IAAI;AAChC,YAAM,kBAAkB,IAAI;AAE5B,UAAI,mCAAkC;AACrC,YAAI,qCAA+C;AAClD,cAAI,2BAA2B;AAAA,QAChC,WAAW,yCAAiD;AAC3D,cAAI,+BAA+B;AAAA,QACpC;AAAA,MACD,WAAW,uCAAoC;AAC9C,YAAI,qCAA+C;AAClD,cAAI,+BAA+B;AAAA,QACpC,WAAW,yCAAiD;AAC3D,cAAI,2BAA2B;AAAA,QAChC;AAAA,MACD,OAAO;AAGN,YAAI,IAAI,mDAA6C;AACpD,cAAI,2BAA2B;AAAA,QAChC,WAAW,IAAI,2CAAyC;AACvD,cAAI,+BAA+B;AAAA,QACpC,OAAO;AAEN,cAAI,2BAA2B;AAAA,QAChC;AAAA,MACD;AAEA,UAAI,IAAI,iCAAiC,QAAQ,IAAI,6BAA6B,MAAM;AACvF,YAAI;AAAA,MACL,WAAW,IAAI,6BAA6B,QAAQ,IAAI,iCAAiC,MAAM;AAC9F,YAAI;AAAA,MACL,WAAW,IAAI,iCAAiC,QAAQ,IAAI,6BAA6B,MAAM;AAE9F,YAAI;AAAA,MACL;AAEA,YAAM,cAAgC,IAAI,iCAAiC,uBACxE,IAAI,6BAA6B,2BACjC;AACH,YAAM,cAAc,gCAA0B,QAAQ,oCAA4B,UAAU,KAAK,IAAI,OAAO,OAAO;AACnH,YAAM,SAAS,OAAO,KAAK,OAAK,EAAE,SAAS,gBAAgB,CAAC,eAAe,EAAE,SAAS,YAAY;AAClG,UAAI,yBAAyB;AAC7B,UAAI,mBAAmB;AACvB,UAAI,uBAAuB,eAAe;AAC1C,UAAI,OAAQ,KAAI,2BAA2B,OAAO;AAClD,UAAI;AACJ,UAAI,uCAAuC;AAC3C,UAAI,mCAAmC;AAAA,IACxC;AAGA;AACC,YAAM,WAAW,UAAU,IAAI,QAAQ,CAAC;AACxC,YAAM,SAAS,qBAAqB;AAAA,QACnC;AAAA,QACA,gBAAgB,SAAS;AAAA,QACzB,OAAO,IAAI;AAAA,QACX,MAAM,IAAI;AAAA,QACV,mBAAmB,IAAI;AAAA,QACvB,mBAAmB,IAAI;AAAA,QACvB,QAAQ,SAAS,qCAAU,MAAM,IAAI,SAAS,SAAU;AAAA,MACzD,CAAC;AACD,UAAI,gBAAgB;AAAA,IACrB;AAAA,EACD;AAGA,QAAK,cAAS,yBAAT,YAAiC,UAAU,CAAC,cAAc;AAC9D,UAAM,YAAY,UAAU;AAAA,MAC3B,CAACI,OAAM,CAACA,GAAE,SAAS,SAASA,GAAE,KAAK;AAAA,IACpC,EAAE;AACF,aAAS,KAAK;AAAA,MACb,MAAM;AAAA,MACN,UAAU;AAAA,MACV,UAAU;AAAA,MACV,SAAS,QAAQ,SAAS,oDAAoD,SAAS,aAAa;AAAA,MACpG,SAAS,EAAE,WAAW,iBAAiB,SAAS,cAAc;AAAA,IAC/D,CAAC;AAAA,EACF;AAaA,MAAI,SAAS,8BAA8B;AAC1C,eAAW,OAAO,QAAQ;AACxB,UAAI,IAAI,mDAA6C;AACpD,cAAM,cACJ,IAAI,6BACJ,IAAI,4BACH,SAAS,wBACT,IAAI,4BACL,IAAI,uBACJ,IAAI,yBACJ,IAAI,+BACJ,IAAI,8BACH,SAAS,wBACT,IAAI,8BACL,IAAI,yBACJ,IAAI;AACN,YAAI,YAAY;AACf,mBAAS,KAAK;AAAA,YACb,MAAM;AAAA,YACN,UAAU;AAAA,YACV,UAAU;AAAA,YACV,SAAS,OAAO,IAAI,KAAK;AAAA,YACzB,SAAS,EAAE,OAAO,IAAI,MAAM;AAAA,UAC7B,CAAC;AAAA,QACF;AAAA,MACF;AAAA,IACD;AAAA,EACD;AAGA,MAAI,SAAS,iBAAiB,OAAO,SAAS,SAAS,aAAa,GAAG;AACtE,UAAM,MAAM,SAAS;AACrB,QAAI,OAAO;AACX,eAAW,OAAO,QAAQ;AACzB,UAAI,CAAC,IAAI,SAAS,SAAS,IAAI,KAAK,EAAG;AACvC,UAAI,OAAO,KAAK;AACf,YAAI,OAAO,IAAI,oBAAoB,IAAI,oBAAoB;AAC3D,YAAI,gBACH,IAAI,gBACJ,IAAI,gBACJ,IAAI,gBACH;AAAA,MACH;AAAA,IACD;AAAA,EACD;AAGA,MAAI,SAAS,qBAAqB,iCAA+B,4BAA4B;AAC5F,UAAM,YAAY,UAAU;AAAA,MAC3B,CAACA,OACA,CAACA,GAAE,UACFA,GAAE,UAAU,QAAQA,GAAE,UAAU,UAAa,CAAC,SAASA,GAAE,KAAK;AAAA,IACjE,EAAE;AACF,QAAI;AACH,eAAS,KAAK;AAAA,QACb,MAAM;AAAA,QACN,UAAU;AAAA,QACV,UAAU;AAAA,QACV,SAAS,GAAG,SAAS;AAAA,QACrB,SAAS,EAAE,UAAU;AAAA,MACtB,CAAC;AAAA,EACH;AACA,MACC,SAAS,4BACR,6BAA6B,4BAC7B;AACD,UAAM,YAAY,UAAU,KAAK,CAACA,OAAM,SAASA,GAAE,MAAM,CAAC;AAC1D,QAAI;AACH,eAAS,KAAK;AAAA,QACb,MAAM;AAAA,QACN,UAAU;AAAA,QACV,UAAU;AAAA,QACV,SAAS,oCAAoC,SAAS;AAAA,QACtD,SAAS,EAAE,UAAU;AAAA,MACtB,CAAC;AAAA,EACH;AACA,MACC,SAAS,4BACR,6BAA6B,4BAC7B;AACD,UAAM,aAAa,UAAU,OAAO,CAACA,OAAMA,GAAE,KAAK,EAAE;AACpD,QAAI;AACH,eAAS,KAAK;AAAA,QACb,MAAM;AAAA,QACN,UAAU;AAAA,QACV,UAAU;AAAA,QACV,SAAS,GAAG,UAAU,gDAAgD,SAAS;AAAA,QAC/E,SAAS,EAAE,WAAW,WAAW;AAAA,MAClC,CAAC;AAAA,EACH;AACA,MAAI,SAAS,uBAAuB;AACnC,WAAO,QAAQ,uBAAuB,EAAE,QAAQ,CAAC,CAAC,KAAK,KAAK,MAAM;AACjE,UAAI,QAAQ,SAAS;AACpB,iBAAS,KAAK;AAAA,UACb,MAAM;AAAA,UACN,UAAU;AAAA,UACV,UAAU;AAAA,UACV,SAAS,aAAa,GAAG,aAAa,KAAK,0CAA0C,SAAS,sBAAsB;AAAA,UACpH,SAAS;AAAA,YACR,aAAa,OAAO,GAAG;AAAA,YACvB;AAAA,YACA,SAAS,SAAS;AAAA,UACnB;AAAA,QACD,CAAC;AAAA,IACH,CAAC;AAAA,EACF;AACA,MAAI,SAAS,6BAA6B;AACzC,UAAM,YAAsB,CAAC;AAC7B,WAAO,QAAQ,CAACA,OAAM;AACrB,YAAM,QAAQ,UAAUA,GAAE,QAAQ,CAAC;AACnC,UAAI,MAAM,UAAU;AACnB,cAAM,YACLA,GAAE,6BACFA,GAAE,+BACFA,GAAE,4BACFA,GAAE,8BACFA,GAAE,4BACFA,GAAE,8BACFA,GAAE,uBACFA,GAAE,yBACFA,GAAE,uBACFA,GAAE;AACH,YAAI,UAAW,WAAU,KAAKA,GAAE,KAAK;AAAA,MACtC;AAAA,IACD,CAAC;AACD,QAAI,UAAU;AACb,eAAS,KAAK;AAAA,QACb,MAAM;AAAA,QACN,UAAU;AAAA,QACV,UAAU;AAAA,QACV,SAAS,sDAAsD,UAAU,KAAK,IAAI,CAAC;AAAA,QACnF,SAAS,EAAE,MAAM,UAAU;AAAA,MAC5B,CAAC;AAAA,EACH;AACA,MAAI,SAAS,uBAAuB;AACnC,QACC,SAAS,0BACT,OAAO,SAAS,SAAS,sBAAsB;AAE/C,eAAS,KAAK;AAAA,QACb,MAAM;AAAA,QACN,UAAU;AAAA,QACV,UAAU;AAAA,QACV,SAAS,2BAA2B,SAAS,sBAAsB;AAAA,QACnE,SAAS,EAAE,KAAK,SAAS,uBAAuB;AAAA,MACjD,CAAC;AACF,QAAI,SAAS,iBAAiB,OAAO,SAAS,SAAS,aAAa;AACnE,eAAS,KAAK;AAAA,QACb,MAAM;AAAA,QACN,UAAU;AAAA,QACV,UAAU;AAAA,QACV,SAAS,yCAAyC,SAAS,aAAa;AAAA,QACxE,SAAS,EAAE,KAAK,SAAS,cAAc;AAAA,MACxC,CAAC;AAAA,EACH;AAEA,MAAI;AACJ,MAAI,SAAS,iBAAiB;AAC7B,UAAM,IAAI,SAAS;AACnB,UAAM,SAAS,SAAS;AACxB,UAAM,gBAAgB,SAAS;AAC/B,UAAM,iBAAiB,SAAS;AAChC,UAAM,kBAAiB,cAAS,4BAAT,YAAoC;AAC3D,UAAM,kBAAiB,cAAS,4BAAT,YAAoC;AAC3D,UAAM,MAAM;AAAA,MACX,OAAO,IAAI,CAAAA,QAAM;AAAA,QAChB,OAAOA,GAAE;AAAA,QACT,aAAaA,GAAE;AAAA,QACf,eAAeA,GAAE;AAAA,QACjB,MAAMA,GAAE;AAAA,QACR,mBAAmBA,GAAE;AAAA,MACtB,EAAE;AAAA,MACF;AAAA,QACC;AAAA,QAAG;AAAA,QAAQ;AAAA,QAAe;AAAA,QAC1B;AAAA,QAAgB;AAAA,QAChB,aAAa,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE;AAAA,QAChC,eAAe,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE;AAAA,QAClC,aAAa,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE;AAAA,QAChC,eAAe,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE;AAAA,QAClC,cAAc,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE;AAAA,QACjC,gBAAgB,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,EAAE;AAAA,MACpC;AAAA,IACD;AACA,yBAAqB,IAAI,IAAI,QAAM;AAAA,MAClC,OAAO,EAAE;AAAA,MACT,QAAQ,EAAE;AAAA,MACV,OAAO,EAAE;AAAA,MACT,WAAW,EAAE;AAAA,MACb,SAAS,EAAE;AAAA,MACX,SAAS,EAAE;AAAA,MACX,QAAQ,EAAE;AAAA,IACX,EAAE;AAAA,EACH;AACA,SAAO,EAAE,MAAM,QAAQ,UAAU,GAAI,qBAAqB,EAAE,mBAAmB,IAAI,CAAC,EAAG;AACxF;;;ACv3CO,SAAS,oBACf,KACA,mBACC;AACD,QAAM,UAAU,4BAA4B,GAAG;AAC/C,QAAM,QAAQ,QAAQ;AACtB,QAAM,UAAU,QAAQ;AAExB,QAAM,OAAO,QAAQ,QAAQ,IAAI,SAAO,EAAE,IAAI,MAAM,gBAAgB,EAAE,EAAE,EAAE;AAC1E,QAAM,MAAM,QAAQ,UAAU,IAAI,SAAO,EAAE,IAAI,MAAM,gBAAgB,EAAE,EAAE,EAAE;AAC3E,MAAI;AACJ,MAAI,QAAQ,QAAS;AAAA,WACZ,UAAU,MAAO;AAAA,MACrB;AAIL,QAAM,UAAU,QAAQ;AACxB,QAAM,SAAS,UAAU;AACzB,QAAM,sBACJ,uCAAiD,WACjD,2CAAmD,SACjD,IAAI,QACJ;AACJ,QAAM,kBACJ,uCAAiD,UACjD,2CAAmD,UACjD,IAAI,QACJ;AAEJ,MAAI,8BAA8B;AAClC,MAAI,0BAA0B;AAG9B,MAAI,wBAAwB,QAAQ,oBAAoB,MAAM;AAC7D,QAAI,YAAY;AAChB,QAAI,mCAAkC;AACrC,UAAI,qCAA+C;AAAA,MAEnD,WAAW,yCAAiD;AAC3D,YAAI,8BAA8B;AAAA,MACnC;AAAA,IACD,WAAW,uCAAoC;AAC9C,UAAI,qCAA+C;AAClD,YAAI,8BAA8B;AAAA,MACnC,WAAW,yCAAiD;AAAA,MAE5D;AAAA,IACD,OAAO;AAGN,UAAI,wBAAwB,MAAM;AACjC,YAAI,0BAA0B;AAAA,MAC/B,WAAW,oBAAoB,MAAM;AAEpC,YAAI,8BAA8B;AAAA,MACnC;AAAA,IACD;AAAA,EACD;AAGA,MAAI,IAAI,+BAA+B,CAAC,IAAI,yBAAyB;AACpE,QAAI;AAAA,EACL,WAAW,CAAC,IAAI,+BAA+B,IAAI,yBAAyB;AAC3E,QAAI;AAAA,EACL,WAAW,CAAC,IAAI,+BAA+B,CAAC,IAAI,yBAAyB;AAC5E,QAAI;AAAA,EACL,OAAO;AAEN,QAAI;AAAA,EACL;AAEA,MAAI,iBAAiB;AACrB,MAAI,YAAY,KAAK,IAAI,OAAO,OAAO,KAAK;AAC5C,MAAI;AAEJ,QAAM,cACL,IAAI,4CACD,0EAGA;AAGJ,QAAM,YAAY,gCAA0B,OAAO;AACnD,QAAM,MAAM,UAAU;AAAA,IACrB,CAAC,MAAM,MAAO,CAAC,QAAQ,EAAE,OAAO,KAAK,OAAO,IAAI;AAAA,IAChD;AAAA,EACD;AACA,MAAI,IAAK,KAAI,cAAc,IAAI;AAChC;AAEO,SAAS,kBACf,MACqB;AACrB,QAAM;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA,WAAW,CAAC;AAAA,EACb,IAAI;AACJ,QAAM,OAAO,SAAS;AAAA,IACrB;AAAA,IACA;AAAA,IACA;AAAA,IACA,UAAU;AAAA,MACT,GAAG;AAAA,IACJ;AAAA,EACD,CAAC;AACD,QAAM,OAA0B,KAAK,KAAK,IAAI,CAACG,QAAO,EAAE,GAAGA,GAAE,EAAE;AAC/D,aAAWA,MAAK,MAAM;AACrB,wBAAoBA,IAAG,iBAAiB;AAAA,EACzC;AACA,SAAO,EAAE,MAAM,UAAU,KAAK,SAAS;AACxC;;;ACxKA,YAAYC,aAAW;AAgGnB,gBAAAC,OAIE,QAAAC,cAJF;AArEJ,IAAM,sBAA0D,CAAC;AAAA,EAChE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACD,MAAM;AAjCN,MAAAC,KAAAC;AAkCC,QAAM,IAAI,kBAAkB;AAC5B,QAAM,WAAUD,MAAA,uBAAG,YAAH,OAAAA,MAAc;AAC9B,QAAM,SAAQC,MAAA,mCAAS,UAAT,OAAAA,MAAkB;AAChC,QAAM,MACL,OAAO,UAAU,YAAY,aAAa,WAAW,KAAK,IAAI;AAE/D,QAAM,QAAc,gBAAQ,MAAO,MAAM,eAAe,GAAG,IAAI,CAAC,GAAI,CAAC,GAAG,CAAC;AACzE,QAAM,iBAAuB;AAAA,IAC5B,MACC,MAAM;AAAA,MACL,IAAI,IAAI,MAAM,IAAI,CAACC,OAAG;AA5C1B,YAAAF;AA4C6B,gBAAAA,MAAA,aAAaE,EAAC,MAAd,gBAAAF,IAAiB;AAAA,OAAS,EAAE,OAAO,OAAO,CAAC;AAAA,IACrE;AAAA,IACD,CAAC,KAAK;AAAA,EACP;AAGA,QAAM,gBAA+B,MAClC,eAAe,IAAI,aAAa,IAChC;AACH,QAAM,gBAA+B,MAClC,eAAe,IAAI,aAAa,IAChC;AACH,QAAM,WAAW,MAAM,SAAS;AAChC,QAAM,gBAAgB,MACnB,IAAI,6CAA2C,WAC/C;AAGH,QAAM,aAAmB,eAAsB,IAAI;AACnD,EAAM,kBAAU,MAAM;AACrB,QAAI,CAAC,cAAe;AACpB,QAAI,CAAC,WAAW,OAAO,KAAM;AAC7B,UAAM,MAAM,GAAG,QAAQ,QAAQ,IAAI,QAAQ,KAAK;AAChD,QAAI,WAAW,YAAY,IAAK;AAChC,eAAW,UAAU;AACrB,QAAI;AACH,oBAAc;AAAA,QACb,OAAO,QAAQ;AAAA,QACf,GAAG,QAAQ;AAAA,QACX,GAAG,QAAQ;AAAA,QACX;AAAA,QACA;AAAA,MACD,CAAC;AAAA,IACF,QAAQ;AAAA,IAER;AAAA,EACD,GAAG,CAAC,mCAAS,UAAU,mCAAS,OAAO,mCAAS,GAAG,mCAAS,GAAG,KAAK,OAAO,aAAa,CAAC;AAEzF,SACC,gBAAAD;AAAA,IAAC;AAAA;AAAA,MACA,WAAU;AAAA,MACV,MAAK;AAAA,MACL,cAAW;AAAA,MACX,eAAY;AAAA,MAEZ;AAAA,wBAAAA;AAAA,UAAC;AAAA;AAAA,YACA,WAAU;AAAA,YACV,OAAO;AAAA,cACN,SAAS;AAAA,cACT,YAAY;AAAA,cACZ,gBAAgB;AAAA,YACjB;AAAA,YAEA;AAAA,8BAAAD,MAAC,YAAO,+BAAiB;AAAA,cACzB,gBAAAA,MAAC,SAAI,WAAU,0BAAyB,eAAa,CAAC,GAEpD,eACA,gBAAAC,OAAC,SAAI,OAAO,EAAE,SAAS,QAAQ,KAAK,EAAE,GACrC;AAAA,gCAAAD;AAAA,kBAAC;AAAA;AAAA,oBACA,MAAK;AAAA,oBACL,WAAU;AAAA,oBACV,SAAS,MAAM;AACd,0BAAI,CAAC,EAAE,QAAS,GAAE,gBAAgB;AAAA,0BAC7B,GAAE,eAAe;AAAA,oBACvB;AAAA,oBACA,cAAW;AAAA,oBACX;AAAA;AAAA,gBAED;AAAA,gBACA,gBAAAA;AAAA,kBAAC;AAAA;AAAA,oBACA,MAAK;AAAA,oBACL,WAAU;AAAA,oBACV,SAAS,MAAM;AACd,0BAAI,CAAC,EAAE,QAAS,GAAE,gBAAgB;AAAA,0BAC7B,GAAE,eAAe;AAAA,oBACvB;AAAA,oBACA,cAAW;AAAA,oBACX;AAAA;AAAA,gBAED;AAAA,iBACD,GAEF;AAAA;AAAA;AAAA,QACD;AAAA,QACC,CAAC,OAAO,CAAC,UACT,gBAAAA,MAAC,OAAE,WAAU,4BAA2B,gCAAkB,IAE1D,gBAAAC,OAAC,SAAI,WAAU,2BACd;AAAA,0BAAAA;AAAA,YAAC;AAAA;AAAA,cACA,WAAU;AAAA,cACV,OAAO,EAAE,SAAS,QAAQ,KAAK,IAAI,UAAU,OAAO;AAAA,cAEpD;AAAA,gCAAAA,OAAC,UACA;AAAA,kCAAAD,MAAC,YAAO,oBAAM;AAAA,kBAAS;AAAA,kBAAE,QAAQ,QAAQ;AAAA,mBAC1C;AAAA,gBACA,gBAAAC,OAAC,UACA;AAAA,kCAAAD,MAAC,YAAO,oBAAM;AAAA,kBAAS;AAAA,kBAAE,QAAQ;AAAA,kBAChC,cAAc,IAAI,WAAW,KAAK;AAAA,kBAClC,cAAc,IAAI,WAAW,KAAK;AAAA,mBACpC;AAAA;AAAA;AAAA,UACD;AAAA,WAGE,iBAAiB,iBAAiB,kBACnC,gBAAAA;AAAA,YAAC;AAAA;AAAA,cACA,WAAU;AAAA,cACV,OAAO,EAAE,WAAW,EAAE;AAAA,cAEtB,0BAAAC;AAAA,gBAAC;AAAA;AAAA,kBACA,OAAO;AAAA,oBACN,SAAS;AAAA,oBACT,KAAK;AAAA,oBACL,UAAU;AAAA,oBACV,YAAY;AAAA,kBACb;AAAA,kBAEE;AAAA,2BAAM;AACP,0BAAI,+CAAe,cAAc,SAAS,YAAY;AACrD,+BACC,gBAAAD;AAAA,0BAAC;AAAA;AAAA,4BACA,MAAM;AAAA,4BACN,OAAM;AAAA,4BACN,WAAU;AAAA;AAAA,wBACX;AAAA,sBAEF;AACA,0BAAI,+CAAe,cAAc,SAAS,gBAAgB;AACzD,+BACC,gBAAAA;AAAA,0BAAC;AAAA;AAAA,4BACA,MAAM;AAAA,4BACN,OAAM;AAAA,4BACN,WAAU;AAAA;AAAA,wBACX;AAAA,sBAEF;AACA,0BAAI,eAAe;AAClB,+BACC,gBAAAA;AAAA,0BAAC;AAAA;AAAA,4BACA,MAAK;AAAA,4BACL,OAAM;AAAA,4BACN,WAAU;AAAA,4BACV,cAAW;AAAA;AAAA,wBACZ;AAAA,sBAEF;AACA,0BAAI,eAAe;AAClB,+BACC,gBAAAA;AAAA,0BAAC;AAAA;AAAA,4BACA,MAAM;AAAA,4BACN,OAAM;AAAA,4BACN,WAAU;AAAA;AAAA,wBACX;AAAA,sBAEF;AACA,6BAAO;AAAA,oBACR,GAAG;AAAA,oBACF,kBACC,MAAM;AACN,4BAAM,QAAQ,cAAc,YAAY;AACxC,4BAAM,SACL,MAAM,SAAS,SAAS,KACxB,MAAM,SAAS,cAAc;AAC9B,4BAAM,SACL,CAAC,UAAU,yBAAyB,KAAK,KAAK;AAC/C,6BACC,gBAAAA;AAAA,wBAAC;AAAA;AAAA,0BACA,MAAM;AAAA,0BACN,OAAM;AAAA,0BACN,WAAW,2DAA2D,SAAS,6BAA6B,sBAAsB;AAAA,0BAClI,cAAY,cAAc,aAAa;AAAA;AAAA,sBACxC;AAAA,oBAEF,GAAG;AAAA;AAAA;AAAA,cACL;AAAA;AAAA,UACD;AAAA,UAID,gBAAAC,OAAC,SAAI,WAAU,4BAA2B,OAAO,EAAE,WAAW,EAAE,GAC/D;AAAA,4BAAAD,MAAC,YAAO,4BAAc;AAAA,YACtB,gBAAAA;AAAA,cAAC;AAAA;AAAA,gBACA,WAAU;AAAA,gBACV,cAAW;AAAA,gBACX,OAAO;AAAA,kBACN,SAAS;AAAA,kBACT,KAAK;AAAA,kBACL,UAAU;AAAA,kBACV,WAAW;AAAA,gBACZ;AAAA,gBAEC,gBAAM,WAAW,IACjB,gBAAAA,MAAC,UAAK,mBAAK,IAEX,MAAM,IAAI,CAACI,OAAM;AA7OzB,sBAAAF,KAAAC;AA8OS,wBAAM,QAAQ,OAAOC,EAAC;AACtB,wBAAM,UACL,+CACA;AACD,wBAAM,iBAAiB,UACpB,uBACA,gBACC,8BACA,gBACC,cAAc,YAAY,EAAE,SAAS,SAAS,IAC7C,yBACA,cAAc,YAAY,EAAE,SAAS,aAAa,IACjD,6BACA,wBACF;AACL,wBAAM,UAAQF,MAAA,aAAaE,EAAC,MAAd,gBAAAF,IAAiB,YAAW;AAC1C,yBACC,gBAAAF;AAAA,oBAAC;AAAA;AAAA,sBAEA,MAAM;AAAA,sBACN,OAAM;AAAA,sBACN,WAAW,oCAAoC,cAAc;AAAA,sBAC7D,gBAAc;AAAA,sBACd,QAAOG,MAAA,aAAaC,EAAC,MAAd,gBAAAD,IAAiB;AAAA;AAAA,oBALnB;AAAA,kBAMN;AAAA,gBAEF,CAAC;AAAA;AAAA,YAEH;AAAA,aACD;AAAA,UAEC,eAAe,SAAS,KACxB,gBAAAF;AAAA,YAAC;AAAA;AAAA,cACA,WAAU;AAAA,cACV,OAAO,EAAE,WAAW,EAAE;AAAA,cAEtB;AAAA,gCAAAD,MAAC,YAAO,sBAAQ;AAAA,gBAAS;AAAA,gBAAE,eAAe,KAAK,IAAI;AAAA;AAAA;AAAA,UACpD;AAAA,WAEF;AAAA;AAAA;AAAA,EAEF;AAEF;AAEA,IAAO,8BAAQ;;;Ad2OZ,SAw8BI,YAAAK,WA57BF,OAAAC,OAZF,QAAAC,cAAA;AA9dH,IAAI,6BAA6B;AAkH1B,IAAM,WAAoC,CAAC;AAAA,EACjD;AAAA,EACA,YAAY;AAAA,EACZ,SAAS;AAAA,EACT,YAAY;AAAA,EACZ,aAAa;AAAA,EACb,gBAAgB;AAAA,EAChB;AAAA,EACA,MAAAC;AAAA,EACA,wBAAwB;AAAA,EACxB;AAAA,EACA;AAAA,EACA,cAAc;AAAA,EACd,YAAY;AAAA,EACZ,mBAAmB;AAAA,EACnB;AAAA,EACA;AAAA,EACA,SAAS;AAAA,EACT;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,oBAAoB;AAAA,EACpB,qBAAqB;AAAA,EACrB,mBAAmB;AAAA,EACnB,oBAAoB;AAAA,EACpB;AAAA,EACA,2BAA2B;AAAA,EAC3B,6BAA6B;AAAA,EAC7B,kBAAkB;AAAA,EAClB;AAAA,EACA;AAAA,EACA,kBAAkB;AAAA,EAClB,qBAAqB;AAAA,EACrB,eAAe;AAAA,EACf,qBAAqB;AAAA,EACrB,wBAAwB;AAAA,EACxB,kCAAkC;AAAA,EAClC,yBAAyB;AAAA,EACzB,uBAAuB;AAAA,EACvB;AACD,MAAM;AAnMN,MAAAC,KAAAC,KAAA;AAsMC,QAAM,oBAA0B;AAAA,IAC/B,CAAC,SAA0C;AAC1C,YAAM,MAAM,OAAO,IAAI;AACvB,aAAO,IACL,QAAQ,yBAAyB,EAAE,EACnC,QAAQ,WAAW,GAAG,EACtB,KAAK,EACL,MAAM,GAAG,EACT,OAAO,OAAO,EACd,IAAI,CAAC,MAAO,EAAE,SAAS,EAAE,CAAC,EAAE,YAAY,IAAI,EAAE,MAAM,CAAC,IAAI,CAAE,EAC3D,KAAK,GAAG;AAAA,IACX;AAAA,IACA,CAAC;AAAA,EACF;AAGA,QAAM,wBAA8B;AAAA,IACnC,CAAC,QAA6C;AAC7C,aAAO,OAAO,GAAG,EACf,QAAQ,WAAW,GAAG,EACtB,KAAK,EACL,MAAM,GAAG,EACT,OAAO,OAAO,EACd,IAAI,CAAC,MAAO,EAAE,SAAS,EAAE,CAAC,EAAE,YAAY,IAAI,EAAE,MAAM,CAAC,IAAI,CAAE,EAC3D,KAAK,GAAG;AAAA,IACX;AAAA,IACA,CAAC;AAAA,EACF;AAGA,MAA6C,2BAA2B,QAAW;AAClF,YAAQ;AAAA,MACP;AAAA,IACD;AAAA,EACD;AAaA,QAAM,SAAe,gBAAQ,MAAM;AAClC,UAAM,YAAY,KAAK,IAAI,CAAC,GAAG,MAAG;AAtPpC,UAAAD,KAAAC,KAAAC;AAsPwC;AAAA,QACrC,GAAG,EAAE;AAAA,QACL,OAAO,EAAE;AAAA,QACT,SAAQF,MAAA,2CAAc,OAAd,OAAAA,MAAoB;AAAA,QAC5B,WAAUC,MAAA,uCAAY,OAAZ,OAAAA,MAAkB;AAAA,QAC5B,QAAOC,MAAA,iCAAS,OAAT,OAAAA,MAAe;AAAA,MACvB;AAAA,KAAE;AACF,QAAI;AAEH,YAAM,iBAA0C,WAAW,EAAE,GAAG,SAAS,IAAI;AAC7E,UAAI,oBAAoB;AACvB,eAAO,kBAAkB;AAAA,UACxB;AAAA,UACA;AAAA,UACA,MAAM;AAAA,UACN,UAAU;AAAA,QACX,CAAC;AAAA,MACF;AACA,aAAO,SAAS,EAAE,WAAW,mBAAmB,MAAM,WAAW,UAAU,eAAe,CAAC;AAAA,IAC5F,QAAQ;AACP,aAAO;AAAA,IACR;AAAA,EACD,GAAG;AAAA,IACF;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACD,CAAC;AAGD,QAAM,uBAAuB,iCAAQ,KACnC,QACA,UACA,KAAK,CAACC,OAAMA,GAAE,QAAQ;AACxB,QAAMC,SAAOJ,MAAA,6DAAsB,SAAtB,OAAAA,MAA8B;AAC3C,QAAM,YAAW,iCAAQ,aAAY,CAAC;AACtC,QAAM,mBAAyB,gBAAQ,MAAM;AAC5C,QAAI,CAAC,SAAS,OAAQ,QAAO,CAAC;AAC9B,QAAI,CAAC,eAAgB,QAAO;AAC5B,WAAO,SAAS,OAAO,CAAC,MAAM;AAC7B,UACC,eAAe,cACf,EAAE,YACF,CAAC,eAAe,WAAW,SAAS,EAAE,QAAQ;AAE9C,eAAO;AACR,UACC,eAAe,cACf,EAAE,YACF,CAAC,eAAe,WAAW,SAAS,EAAE,QAAQ;AAE9C,eAAO;AACR,UACC,eAAe,SACf,CAAC,eAAe,MAAM,SAAS,EAAE,IAAsB;AAEvD,eAAO;AACR,aAAO;AAAA,IACR,CAAC;AAAA,EACF,GAAG,CAAC,UAAU,cAAc,CAAC;AAG7B,QAAM,CAAC,oBAAoB,qBAAqB,IACzC,iBAAiB,EAAE;AAC1B,QAAM,qBAA2B,eAAe,EAAE;AAClD,EAAM,kBAAU,MAAM;AACrB,QAAI,CAAC,mBAAmB;AACvB,UAAI,mBAAmB,YAAY,IAAI;AACtC,2BAAmB,UAAU;AAC7B,8BAAsB,EAAE;AAAA,MACzB;AACA;AAAA,IACD;AACA,UAAM,QAAQ,iBAAiB;AAC/B,QAAI,CAAC,OAAO;AACX,YAAMK,OAAM;AACZ,UAAIA,SAAQ,mBAAmB,SAAS;AACvC,2BAAmB,UAAUA;AAC7B,8BAAsBA,IAAG;AAAA,MAC1B;AACA;AAAA,IACD;AACA,UAAM,SAAS;AAAA,MACd,OAAO,iBAAiB;AAAA,QACvB,CAAC,MAAM,EAAE;AAAA,MACV,EAAE;AAAA,MACF,SAAS,iBAAiB;AAAA,QACzB,CAAC,MAAM,EAAE;AAAA,MACV,EAAE;AAAA,MACF,MAAM,iBAAiB;AAAA,QACtB,CAAC,MAAM,EAAE;AAAA,MACV,EAAE;AAAA,IACH;AACA,UAAM,iBAA2B,CAAC;AAClC,QAAI,OAAO;AACV,qBAAe;AAAA,QACd,GAAG,OAAO,KAAK,SAAS,OAAO,UAAU,IAAI,KAAK,GAAG;AAAA,MACtD;AACD,QAAI,OAAO;AACV,qBAAe;AAAA,QACd,GAAG,OAAO,OAAO,WAAW,OAAO,YAAY,IAAI,KAAK,GAAG;AAAA,MAC5D;AACD,QAAI,OAAO,KAAM,gBAAe,KAAK,GAAG,OAAO,IAAI,OAAO;AAC1D,UAAM,MAAM,wBAAwB,KAAK,WAAW,UAAU,IAAI,KAAK,GAAG,KAAK,eAAe,KAAK,IAAI,CAAC;AACxG,QAAI,QAAQ,mBAAmB,SAAS;AACvC,yBAAmB,UAAU;AAC7B,4BAAsB,GAAG;AAAA,IAC1B;AAAA,EACD,GAAG,CAAC,mBAAmB,gBAAgB,CAAC;AAGxC,QAAM,OAAMJ,MAAA,6DAAsB,sBAAtB,OAAAA,MAA2C;AACvD,QAAM,OAAM,kEAAsB,sBAAtB,YAA2C;AACvD,QAAM,UAAS,kEAAsB,kBAAtB,YAAuC;AACtD,QAAM,UAAS,kEAAsB,kBAAtB,YAAuC;AACtD,QAAM,UAAS,kEAAsB,kBAAtB,YAAuC;AACtD,QAAM,UAAS,kEAAsB,kBAAtB,YAAuC;AACtD,QAAM,QAAQG,SAAQ,QAAQ,UAAU,OAAO,KAAK,IAAI,SAASA,KAAI,IAAI;AAGzE,QAAM,SAAe;AAAA,IACpB,MAAM,CAAC,EAAE,IAAI,WAAW,MAAM,OAAO,UAAU,CAAC;AAAA,IAChD,CAAC,IAAI;AAAA,EACN;AACA,QAAM,UAAgB,gBAAQ,MAAM;AAEnC,QAAI,cAAc;AAEjB,YAAM,UAAU,KAAK,IAAI,OAAK,EAAE,CAAC;AACjC,YAAM,UAAU,KAAK,IAAI,KAAK,GAAG,OAAO;AACxC,YAAM,WAAW,KAAK,IAAI,GAAG,GAAG,OAAO;AACvC,aAAO,CAAC,WAAW,IAAI,WAAW,GAAG,UAAU,MAAM,UAAU,GAAG;AAAA,IACnE;AAEA,UAAM,SAAS,KAAK,IAAI,CAAC,MAAM,EAAE,CAAC;AAClC,UAAM,OAAO,CAAC,GAAG,MAAM;AACvB,KAACA,OAAM,KAAK,KAAK,QAAQ,QAAQ,QAAQ,MAAM,EAAE,QAAQ,CAAC,MAAM;AAC/D,UAAI,KAAK,KAAM,MAAK,KAAK,CAAC;AAAA,IAC3B,CAAC;AAGD,QAAI;AACH,kBAAY,QAAQ,CAAC,MAAiC;AACrD,YAAI,OAAO,MAAM,YAAY,CAAC,MAAM,CAAC,EAAG,MAAK,KAAK,CAAC;AAAA,MACpD,CAAC;AACF,QAAI,CAAC,KAAK,OAAQ,QAAO;AACzB,QAAI,MAAM,KAAK,IAAI,GAAG,IAAI;AAC1B,QAAI,MAAM,KAAK,IAAI,GAAG,IAAI;AAC1B,QAAI,gBAAiB,OAAM,KAAK,IAAI,GAAG,GAAG;AAC1C,QAAI,mBAAoB,OAAM,KAAK,IAAI,KAAK,GAAG;AAC/C,WAAO,CAAC,KAAK,GAAG;AAAA,EAEjB,GAAG,CAAC,MAAMA,OAAM,KAAK,KAAK,QAAQ,QAAQ,QAAQ,QAAQ,aAAa,iBAAiB,oBAAoB,YAAY,CAAC;AAGzH,QAAM,WAAiB,gBAAQ,MAAM;AACpC,QAAIL,UAAQ,qDAAkB,aAAa,QAAO;AAClD,QAAI,CAAC,KAAK,OAAQ,QAAO;AACzB,WAAO,KAAK,MAAM,CAAC,MAAM,EAAE,KAAK,KAAK,EAAE,KAAK,CAAC,IAAI,MAAM;AAAA,EACxD,GAAG,CAACA,OAAM,qDAAkB,aAAa,IAAI,CAAC;AAE9C,QAAM,iBAAgB,KAAAA,SAAA,OAAAA,QAAQ,qDAAkB,gBAA1B,YAAyC;AAC/D,QAAM,4BAAkC,gBAAQ,MAAM;AACrD,WAAO,gBACJ,EAAE,GAAI,oBAAoB,CAAC,GAAI,aAAa,cAAc,IAC1D;AAAA,EACJ,GAAG,CAAC,kBAAkB,aAAa,CAAC;AAGpC,QAAM,mBAAyB,gBAAQ,MAAM;AAC5C,QAAI,EAAC,iCAAQ,MAAM,QAAO,CAAC;AAC3B,UAAM,UAAoB,CAAC;AAC3B,aAAS,IAAI,GAAG,IAAI,OAAO,KAAK,QAAQ,KAAK;AAC5C,UAAI,OAAO,KAAK,CAAC,EAAE,gBAAgB,OAAO,KAAK,IAAI,CAAC,EAAE;AACrD,gBAAQ,KAAK,CAAC;AAAA,IAChB;AACA,WAAO;AAAA,EACR,GAAG,CAAC,iCAAQ,IAAI,CAAC;AAGjB,QAAM,eAAqB,gBAAQ,MAAM;AA9a1C,QAAAC,KAAAC;AA+aE,QAAI,CAAC,oBAAoB,GAACD,MAAA,iCAAQ,SAAR,gBAAAA,IAAc,QAAQ,QAAO;AACvD,UAAM,aAAa,OAAO;AAE1B,UAAM,aAAYC,MAAA,qCAAU,kBAAV,OAAAA,MAA2B;AAC7C,UAAM,gBAAgB,WAAW;AAAA,MAChC,CAACE,OAAM,CAACA,GAAE,SAASA,GAAE,SAAS;AAAA,IAC/B,EAAE;AAEF,QAAI,gBAAgB,UAAW,QAAO;AAGtC,QAAI,UAAU;AACd,aAAS,IAAI,WAAW,SAAS,GAAG,KAAK,GAAG,KAAK;AAChD,YAAMA,KAAI,WAAW,CAAC;AACtB,UAAIA,MAAKA,GAAE,SAAS,QAAQ,CAACA,GAAE,OAAO;AACrC,kBAAU;AACV;AAAA,MACD;AAAA,IACD;AACA,QAAI,YAAY,GAAI,QAAO;AAC3B,UAAM,UAAU,WAAW,OAAO;AAClC,UAAM,YAAY,QAAQ;AAC1B,UAAM,qBAAgD;AACtD,UAAM,eAAe,QAAQ;AAC7B,UAAM,yBACL,kDAAgD,CAAC,CAAC,QAAQ;AAG3D,UAAM,wBACL,yDAEG;AAKJ,QAAI,QAA+B;AACnC,QAAI,sDAAiD;AAEpD,YAAM,aAAa,QAAQ;AAC3B,YAAM,YAAY,QAAQ;AAC1B,UAAI,qCAA+C;AAElD,YAAI,WAAY;AAAA,iBACP,UAAW;AAAA,MACrB,WAAW,yCAAiD;AAE3D,YAAI,UAAW;AAAA,iBACN,WAAY;AAAA,MACtB,OAAO;AAEN;AAAA,MACD;AAAA,IACF,WAAW,kDAAgD,wBAAwB;AAEjF,YAAM,cACL,QAAQ,6BACR,QAAQ,4BACR,QAAQ,4BACR,QAAQ,uBACR,QAAQ;AACT,YAAM,aACL,QAAQ,+BACR,QAAQ,8BACR,QAAQ,8BACR,QAAQ,yBACR,QAAQ;AACT,UAAI,eAAe,CAAC,WAAY;AAAA,eACvB,cAAc,CAAC,YAAa;AAAA,UAChC;AAAA,IACN;AAOA,QAAI;AACJ,QAAI;AACH;AAAA,aACQ;AACR;AAAA,QACI;AAEL,UAAM,WAAW;AAEjB,WACC,gBAAAG;AAAA,MAAC;AAAA;AAAA,QAEA,OAAO,EAAE,SAAS,QAAQ,KAAK,IAAI,aAAa,GAAG;AAAA,QAEnD;AAAA,0BAAAC;AAAA,YAAC;AAAA;AAAA,cACA,WAAU;AAAA,cACV,kBAAgB,OAAO,kBAAkB;AAAA,cACzC,kBAAgB,QAAQ,OAAO,KAAK,IAAI;AAAA,cACxC,cAAY,QAAQ,OAAO,KAAK,IAAI;AAAA,cACpC,iBAAe,OAAO,8BAAY,SAAS;AAAA,cAC3C,OAAO,EAAE,OAAO,UAAU,QAAQ,SAAS;AAAA,cAE3C,0BAAAA;AAAA,gBAAC;AAAA;AAAA,kBACA,YAAY;AAAA,kBACZ,MAAM;AAAA,oBACL,eAAe;AAAA,oBACf,sBAAsB;AAAA,oBACtB;AAAA,oBACA,qBAAqB;AAAA,oBACrB,gBACC,QAAQ,6BACP,QAAQ,4BACR,QAAQ,4BACR,QAAQ,uBACR,QAAQ;AAAA,oBACV,eACC,QAAQ,+BACP,QAAQ,8BACR,QAAQ,8BACR,QAAQ,yBACR,QAAQ;AAAA,oBACV,GAAI,QAAQ,EAAE,MAAM,IAAI,CAAC;AAAA,kBAC1B;AAAA,kBAEA,YACC;AAAA,kBAID,MAAM;AAAA,kBACN,SAAS;AAAA,kBACT,WACC,kEACG,wBACA;AAAA;AAAA,cAEL;AAAA;AAAA,UACD;AAAA,UAEA,gBAAAA;AAAA,YAAC;AAAA;AAAA,cACA,WAAU;AAAA,cACV,kBAAgB,OAAO,YAAY;AAAA,cACnC,OAAO,EAAE,OAAO,UAAU,QAAQ,SAAS;AAAA,cAE3C,0BAAAA;AAAA,gBAAC;AAAA;AAAA,kBACA,QAAQ;AAAA,kBACR,MAAM;AAAA,kBACN,YAAY;AAAA;AAAA,cACb;AAAA;AAAA,UACD;AAAA;AAAA;AAAA,MA1DK,iBAAiB,OAAO;AAAA,IA2D9B;AAAA,EAEF,GAAG;AAAA,IACF;AAAA,IACA,iCAAQ;AAAA,IACR;AAAA,IACA,qCAAU;AAAA,IACV;AAAA,IACA;AAAA,IACA;AAAA,EACD,CAAC;AAED,SACC,gBAAAD;AAAA,IAAC;AAAA;AAAA,MACA,WACC,YACG,yBAAyB,SAAS,KAClC;AAAA,MAIH;AAAA,4BACA,gBAAAC;AAAA,UAAC;AAAA;AAAA,YACA,WAAU;AAAA,YACV,OAAO;AAAA,cACN,SAAS;AAAA,cACT,gBAAgB;AAAA,cAChB,cAAc;AAAA,YACf;AAAA,YAEC;AAAA;AAAA,QACF;AAAA,QAGD,gBAAAA;AAAA,UAAC;AAAA;AAAA,YACA;AAAA,YACA;AAAA,YACA,QAAQ,EAAE,QAAQ,IAAI,MAAM,IAAI,OAAO,IAAI,KAAK,GAAG;AAAA,YACnD,WAAW;AAAA,YAEX,0BAAAA,MAAC,sBAAmB,QAAuB,SAC1C,0BAAAA;AAAA,cAAC;AAAA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA,QAAQ,EAAE,MAAAH,OAAM,KAAK,KAAK,OAAO,QAAQ,QAAQ,QAAQ,OAAO;AAAA,gBAChE;AAAA,gBACA;AAAA,gBACA,aAAY,iCAAQ,SAAQ;AAAA,gBAC5B;AAAA,gBACA;AAAA,gBACA,kBAAkB;AAAA,gBAClB;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA;AAAA,YACD,GACD;AAAA;AAAA,QACD;AAAA,QACC,UACA,gBAAAG,MAAC,SAAI,WAAU,yBAAwB,cAAW,qBAChD,iBAAO,WAAW,WAAW,gBAAAD,OAAC,WAAM;AAAA;AAAA,UAAS;AAAA,WAAO,IAAW,QACjE;AAAA,QAGA,qBAAqB,sBACrB,gBAAAC;AAAA,UAAC;AAAA;AAAA,YACA,eAAY;AAAA,YACZ,aAAU;AAAA,YACV,OAAO;AAAA,cACN,UAAU;AAAA,cACV,OAAO;AAAA,cACP,QAAQ;AAAA,cACR,SAAS;AAAA,cACT,QAAQ;AAAA,cACR,UAAU;AAAA,cACV,MAAM;AAAA,cACN,YAAY;AAAA,cACZ,QAAQ;AAAA,YACT;AAAA,YAEC;AAAA;AAAA,QACF;AAAA,QAEA,qBAAqB,iBAAiB,SAAS,KAC/C,gBAAAD;AAAA,UAAC;AAAA;AAAA,YACA,WAAU;AAAA,YACV,MAAK;AAAA,YACL,cAAW;AAAA,YAEX;AAAA,8BAAAC,MAAC,OAAE,WAAU,mCAAkC,yBAAW;AAAA,cAC1D,gBAAAA;AAAA,gBAAC;AAAA;AAAA,kBACA,mBAAmB;AAAA,kBACnB,OAAO;AAAA,kBACP,YAAY;AAAA,kBACZ,MAAM;AAAA,oBACL,EAAE,MAAM,WAAW;AAAA,oBACnB,EAAE,MAAM,WAAW;AAAA,oBACnB,EAAE,MAAM,OAAO;AAAA,oBACf,EAAE,MAAM,UAAU;AAAA,kBACnB;AAAA,kBACA,MAAM,iBAAiB,IAAI,CAAC,MAAM;AACjC,wBAAI,gBAAqB;AACzB,wBAAI,EAAE;AACL,sCAAgB;AAAA,6BACR,EAAE;AACV,sCAAgB;AAAA,6BACR,EAAE;AACV,sCAAgB;AACjB,2BAAO;AAAA,sBACN;AAAA,wBACC,MACC,gBAAAA;AAAA,0BAAC;AAAA;AAAA,4BACA,OAAO;AAAA,4BACP,OAAO,EAAE,WAAW,OAAO,EAAE,QAAQ,IAAI,QAAQ;AAAA,8BAChD;AAAA,8BACA,CAAC,MAAM,EAAE,YAAY;AAAA,4BACtB;AAAA;AAAA,wBACD;AAAA,wBAED,SACC;AAAA,sBACF;AAAA,sBACA;AAAA,wBACC,MAAM,EAAE,WACP,gBAAAA;AAAA,0BAAC;AAAA;AAAA,4BACA,OAAM;AAAA,4BACN,MAAM,sBAAsB,EAAE,QAAQ;AAAA;AAAA,wBACvC,IAEA,gBAAAA,MAAC,UAAK,WAAU,gCAA+B,oBAAC;AAAA,wBAEjD,SACC;AAAA,sBACF;AAAA,sBACA;AAAA,wBACC,MAAM,gBAAAA,MAAC,OAAI,OAAM,QAAO,MAAM,kBAAkB,EAAE,IAAI,GAAG;AAAA,wBACzD,SACC;AAAA,sBACF;AAAA,sBACA;AAAA,wBACC,MACC,gBAAAD,OAAC,SAAI,WAAU,kCACd;AAAA,0CAAAC,MAAC,UAAM,YAAE,SAAQ;AAAA,0BAChB,EAAE,WAAW,OAAO,KAAK,EAAE,OAAO,EAAE,SAAS,KAC7C,gBAAAD;AAAA,4BAAC;AAAA;AAAA,8BACA,WAAU;AAAA,8BACV,OAAO,EAAE,WAAW,EAAE;AAAA,8BAEtB;AAAA,gDAAAC,MAAC,aAAQ,qBAAO;AAAA,gCAChB,gBAAAA,MAAC,SAAK,eAAK,UAAU,EAAE,SAAS,MAAM,CAAC,GAAE;AAAA;AAAA;AAAA,0BAC1C;AAAA,2BAEF;AAAA,wBAED,SACC;AAAA,sBACF;AAAA,oBACD;AAAA,kBACD,CAAC;AAAA,kBACD,SAAQ;AAAA,kBACR,cAAa;AAAA;AAAA,cACd;AAAA;AAAA;AAAA,QACD;AAAA;AAAA;AAAA,EAEF;AAEF;AAkDA,IAAM,cAAuC,CAAC;AAAA,EAC7C;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA,2BAA2B;AAAA,EAC3B,6BAA6B;AAAA,EAC7B,kBAAkB;AAAA,EAClB,wBAAwB;AAAA,EACxB,kCAAkC;AAAA,EAClC,yBAAyB;AAAA,EACzB,uBAAuB;AAAA,EACvB;AACD,MAAM;AAh0BN,MAAAP;AAi0BC,QAAM,WAAW,gBAAgB;AACjC,QAAM,WAAW,gBAAgB;AACjC,MAAI,CAAC,SAAU,QAAO;AACtB,QAAM,EAAE,QAAQ,OAAO,IAAI;AAE3B,QAAM,oBAA0B;AAAA,IAC/B,aAAa,EAAE;AAAA,EAChB;AACA,QAAM,aAAa,kBAAkB;AACrC,QAAM,QAAMA,MAAA,OAAO,CAAC,MAAR,gBAAAA,IAAW,SAAQ,CAAC;AAChC,QAAM,eAAqB,gBAAQ,MAAM;AACxC,QAAI,CAAC,OAAO,OAAO,CAAC,OAAO,IAAK,QAAO,oBAAI,IAAY;AACvD,UAAM,MAAM,oBAAI,IAAY;AAC5B,QAAI,QAAQ,CAAC,GAAG,MAAM;AACrB,UACE,OAAO,OAAO,QAAQ,EAAE,IAAI,OAAO,OACnC,OAAO,OAAO,QAAQ,EAAE,IAAI,OAAO;AAEpC,YAAI,IAAI,CAAC;AAAA,IACX,CAAC;AACD,WAAO;AAAA,EACR,GAAG,CAAC,KAAK,OAAO,KAAK,OAAO,GAAG,CAAC;AAGhC,QAAM,gBAAsB,gBAAQ,MAAM;AACzC,QAAI,CAAC,WAAY,QAAO;AACxB,UAAMQ,OAWF,CAAC;AACL,eAAW,QAAQ,CAACL,IAAG,QAAQ;AAC9B,UAAIA,GAAE,SAAS,QAAQA,GAAE,MAAO;AAChC,YAAM,aACLA,GAAE,6BACFA,GAAE,+BACFA,GAAE,4BACFA,GAAE,8BACFA,GAAE,4BACFA,GAAE,8BACFA,GAAE,uBACFA,GAAE,yBACFA,GAAE,uBACFA,GAAE;AACH,MAAAK,KAAI,GAAG,IAAI;AAAA,QACV,WAAWL,GAAE;AAAA,QACb,WAAWA,GAAE;AAAA,QACb,SAAS;AAAA,QACT,SAASA,GAAE;AAAA,QACX,aAAaA,GAAE;AAAA,QACf,SAAS,CAAC,CAACA,GAAE;AAAA,QACb,WAAW,CAAC,CAACA,GAAE;AAAA,MAChB;AAAA,IACD,CAAC;AACD,WAAOK;AAAA,EACR,GAAG,CAAC,UAAU,CAAC;AAGf,QAAM,gBAAsB,gBAAQ,MAAM;AACzC,QAAI,CAAC,cAAc,CAAC,WAAW,OAAQ,QAAO;AAC9C,UAAM,SAAmB,CAAC;AAC1B,eAAWL,MAAK,YAAY;AAC3B,UAAI,OAAOA,GAAE,WAAW,YAAY,CAAC,MAAMA,GAAE,MAAM;AAClD,eAAO,KAAKA,GAAE,MAAM;AAAA,IACtB;AACA,QAAI,CAAC,OAAO,OAAQ,QAAO;AAC3B,UAAM,QAAQ,OAAO,CAAC;AACtB,WAAO,OAAO,MAAM,CAAC,MAAM,MAAM,KAAK,IAAI,QAAQ;AAAA,EACnD,GAAG,CAAC,UAAU,CAAC;AAIf,QAAM,aAAmB,gBAAQ,MAAM;AACtC,QAAI,CAAC,iBAAiB,CAAC,IAAI;AAC1B,aAAO,CAAC;AACT,UAAM,MACL,IAAI,IAAI,CAAC,IAAI,MAAM;AAClB,YAAM,MAAM,+CAAgB;AAC5B,UAAI,2BAAK,QAAS,QAAO,2BAAoB;AAC7C,UAAI,2BAAK,YAAa,QAAO,2BAAoB;AAEjD,WAAI,2BAAK,YAAW,IAAI,uCAAqC;AAC5D,YAAI,oBAAoB,2BAA2B,qBAAqB,+CAAoD;AAC3H,cAAI,IAAI,SAAS;AAChB,mBAAO,sCAAgD,2BAAoB,cAAc,2BAAoB;AAAA,UAC9G;AACA,cAAI,IAAI,WAAW;AAClB,mBAAO,0CAAkD,2BAAoB,cAAc,2BAAoB;AAAA,UAChH;AAAA,QACD;AAEA,YAAI,yBAA0B,QAAO,2BAAoB;AAAA,MAC1D;AACA,aAAO,2BAAoB;AAAA,IAC5B,CAAC;AAGF,UAAM,cAAc,uCAAW,SAAS;AACxC,QAAI,aAAa;AAChB,cAAQ;AAAA,QACP,IAAI,SAAS;AAAA,QACb,IAAI,IAAI,CAAC,KAAK,MAAM,GAAG,CAAC,IAAI,GAAG,IAAI,IAAI,CAAC,EAAE,CAAC,GAAG,EAAE,KAAK,IAAI;AAAA,MAC1D;AAAA,IACD;AAEA,WAAO;AAAA,EACR,GAAG,CAAC,eAAe,KAAK,WAAW,0BAA0B,iBAAiB,iBAAiB,CAAC;AAGhG,QAAM,YAAkB,gBAAQ,MAAM;AACrC,QAAI,CAAC,qBAAqB,CAAC,WAAW;AACrC,aAAO,CAAC;AAMT,UAAM,OAAO,CAAC,GAAG,UAAU;AAE3B,QAAI,IAAI;AACR,WAAO,IAAI,KAAK,QAAQ;AACvB,YAAM,MAAM,KAAK,CAAC;AAClB,UAAI,IAAI,IAAI;AACZ,aAAO,IAAI,KAAK,UAAU,KAAK,CAAC,MAAM,IAAK;AAC3C,YAAM,SAAS,IAAI;AACnB,UAAI,WAAW,KAAK,QAAQ,2BAAoB,QAAQ;AACvD,aAAK,CAAC,IAAI,2BAAoB;AAAA,MAC/B;AACA,UAAI;AAAA,IACL;AAEA,UAAM,MAIA,CAAC;AACP,QAAI,KAAK,QAAQ;AAChB,UAAI,QAAQ;AACZ,eAAS,IAAI,GAAG,KAAK,KAAK,QAAQ,KAAK;AACtC,YAAI,MAAM,KAAK,UAAU,KAAK,CAAC,MAAM,KAAK,KAAK,GAAG;AACjD,gBAAM,SAAS,KAAK,KAAK;AACzB,gBAAM,MAAM,IAAI;AAChB,gBAAM,MAAM,MAAM,QAAQ;AAC1B,cAAI,WAAW,2BAAoB,UAAU,OAAO;AACnD,gBAAI,KAAK,EAAE,OAAO,KAAK,UAAU,OAAO,CAAC;AAC1C,kBAAQ;AAAA,QACT;AAAA,MACD;AAAA,IACD;AACA,UAAM,cAAc,uCAAW,SAAS;AACxC,QAAI,aAAa;AAChB,cAAQ;AAAA,QACP,IAAI,SAAS;AAAA,QACb,IAAI,IAAI,CAAC,MAAM,GAAG,EAAE,KAAK,IAAI,EAAE,GAAG,IAAI,EAAE,QAAQ,EAAE,EAAE,KAAK,IAAI;AAAA,MAC9D;AAAA,IACD;AACA,WAAO;AAAA,EACR,GAAG,CAAC,mBAAmB,YAAY,SAAS,CAAC;AAG7C,QAAM,aAAmB;AAAA,IACxB,MAAM,IAAI,IAAI,CAAC,MAAM,OAAO,EAAE,aAAa,OAAO,EAAE,IAAI,IAAI,KAAK,EAAE,CAAC,CAAC,CAAC;AAAA,IACtE,CAAC,KAAK,MAAM;AAAA,EACb;AACA,QAAM,YAAY,OAAO,MAAM,EAAE,CAAC;AAGlC,QAAM,gBAAsB,gBAAQ,MAAM;AACzC,QAAI,CAAC,cAAc,CAAC,WAAW,OAAQ,QAAO;AAO9C,QAAI,aAAa,OAAO;AACxB,QAAI,eAAe,OAAO;AAC1B,eAAW,QAAQ,CAACA,IAAG,MAAM;AAC5B,UAAIA,GAAE,oBAAqB,cAAa,KAAK,IAAI,YAAY,CAAC;AAC9D,UAAIA,GAAE,sBAAuB,gBAAe,KAAK,IAAI,cAAc,CAAC;AAAA,IACrE,CAAC;AACD,QAAI,CAAC,OAAO,SAAS,UAAU,KAAK,CAAC,OAAO,SAAS,YAAY,EAAG,QAAO;AAC3E,UAAM,QAAQ,cAAc;AAC5B,UAAM,YAA2B,QAAQ,OAAO;AAChD,UAAM,aAAa,QAAQ,aAAa;AAExC,UAAM,eAAe,CAAC,QAAsB;AAC3C,UAAI,qBAAqB,QAAQ,8CAAoD,QAAO;AAC5F,UAAI,OAAO,QAAQ,OAAO,IAAI,UAAU,YAAY,OAAO,IAAI,SAAS,SAAU,QAAO;AACzF,UAAI,cAAc,MAAM;AACvB,eAAO,sCAAgD,IAAI,QAAQ,IAAI,OAAO,IAAI,QAAQ,IAAI;AAAA,MAC/F;AAEA,aAAO,0CAAkD,IAAI,QAAQ,IAAI,OAAO,IAAI,QAAQ,IAAI;AAAA,IACjG;AACA,QAAI,yBAAwC;AAC5C,aAAS,IAAI,YAAY,IAAI,WAAW,QAAQ,KAAK;AACpD,YAAMA,KAAI,WAAW,CAAC;AACtB,YAAM,UAAU,QAAQ,CAAC,CAACA,GAAE,sBAAsB,CAAC,CAACA,GAAE;AACtD,UAAI,CAAC,QAAS;AACd,UAAI,aAAaA,EAAC,GAAG;AAAE,iCAAyB;AAAG;AAAA,MAAO;AAAA,IAC3D;AACA,QAAI,sBAAsB;AAC1B,QAAI,0BAA0B,MAAM;AACnC,UAAI,kBAAkB;AACtB,eAAS,IAAI,wBAAwB,IAAI,WAAW,QAAQ,KAAK;AAChE,cAAMA,KAAI,WAAW,CAAC;AACtB,cAAM,UAAU,QAAQ,CAAC,CAACA,GAAE,sBAAsB,CAAC,CAACA,GAAE;AACtD,YAAI,CAAC,QAAS;AACd,YAAI,aAAaA,EAAC,EAAG;AAAA,MACtB;AACA,4BAAsB,mBAAmB;AAAA,IAC1C;AACA,WAAO,EAAE,WAAW,YAAY,wBAAwB,oBAAoB;AAAA,EAC7E,GAAG,CAAC,YAAY,iBAAiB,CAAC;AAGlC,QAAM,gBAAsB,gBAAQ,MAAM;AACzC,QAAI,CAAC,cAAc,CAAC,WAAW,OAAQ,QAAO;AAE9C,UAAM,QAAQ,CAAC,QAA2C;AACzD,YAAM,OAAgD,CAAC;AACvD,UAAI,QAAuB;AAC3B,UAAI,UAAyB;AAC7B,eAAS,IAAI,GAAG,IAAI,WAAW,QAAQ,KAAK;AAC3C,cAAM,MAAM,WAAW,CAAC;AACxB,cAAM,IAAI,OAAO,IAAI,GAAG,MAAM,WAAY,IAAI,GAAG,IAAe;AAChE,YAAI,KAAK,QAAQ,MAAM,CAAC,GAAG;AAE1B,cAAI,UAAU,QAAQ,WAAW,MAAM;AACtC,iBAAK,KAAK;AAAA,cACT,IAAI,WAAW,KAAK;AAAA,cACpB,IAAI,WAAW,IAAI,CAAC;AAAA,cACpB,GAAG,OAAO,OAAO;AAAA,YAClB,CAAC;AACD,oBAAQ;AACR,sBAAU;AAAA,UACX;AACA;AAAA,QACD;AACA,YAAI,UAAU,MAAM;AACnB,kBAAQ;AACR,oBAAU;AACV;AAAA,QACD;AAEA,cAAM,MAAM;AACZ,YAAI,WAAW,QAAQ,KAAK,IAAI,IAAI,OAAO,KAAK,KAAK;AAAA,QAErD,OAAO;AAEN,cAAI,WAAW,MAAM;AACpB,iBAAK,KAAK;AAAA,cACT,IAAI,WAAW,KAAK;AAAA,cACpB,IAAI,WAAW,IAAI,CAAC;AAAA,cACpB,GAAG,OAAO,OAAO;AAAA,YAClB,CAAC;AAAA,UACF;AACA,kBAAQ;AACR,oBAAU;AAAA,QACX;AAAA,MACD;AACA,UAAI,UAAU,QAAQ,WAAW,MAAM;AACtC,aAAK,KAAK;AAAA,UACT,IAAI,WAAW,KAAK;AAAA,UACpB,IAAI,WAAW,WAAW,SAAS,CAAC;AAAA,UACpC,GAAG,OAAO,OAAO;AAAA,QAClB,CAAC;AAAA,MACF;AACA,aAAO;AAAA,IACR;AACA,WAAO;AAAA,MACN,MAAM,MAAM,MAAM;AAAA,MAClB,KAAK,MAAM,mBAAmB;AAAA,MAC9B,KAAK,MAAM,mBAAmB;AAAA,MAC9B,QAAQ,MAAM,eAAe;AAAA,MAC7B,QAAQ,MAAM,eAAe;AAAA,MAC7B,QAAQ,MAAM,eAAe;AAAA,MAC7B,QAAQ,MAAM,eAAe;AAAA,IAC9B;AAAA,EACD,GAAG,CAAC,YAAY,YAAY,MAAM,CAAC;AAGnC,QAAM,eAAqB,gBAAQ,MAAM;AACxC,QAAI,CAAC,UAAU,OAAQ,QAAO;AAC9B,WACC,gBAAAG,OAAC,UAEA;AAAA,sBAAAA,OAAC,oBAAe,IAAI,GAAG,kBAAkB,OAAO,gBAAgB,IAAG,MAAK,IAAG,MAAK,IAAG,MAAK,IAAG,QAC1F;AAAA,wBAAAC,MAAC,UAAK,QAAO,MAAK,WAAW,2DAA2D,aAAa,MAAM;AAAA,QAC3G,gBAAAA,MAAC,UAAK,QAAO,OAAM,WAAW,2DAA2D,aAAa,MAAM;AAAA,QAC5G,gBAAAA,MAAC,UAAK,QAAO,QAAO,WAAW,2DAA2D,aAAa,OAAO;AAAA,SAC/G;AAAA,MACC,UAAU,IAAI,CAAC,KAAK,QAAQ;AAC5B,cAAM,KAAK,GAAG,kBAAkB,OAAO,SAAS,GAAG;AACnD,YAAI;AACJ,YAAI,MAAM,MACT,MAAM,MACN,MAAM;AACP,gBAAQ,IAAI,UAAU;AAAA,UACrB,KAAK,2BAAoB;AACxB,sBAAU;AAEV,kBAAM;AACN,kBAAM;AACN,kBAAM;AACN;AAAA,UACD,KAAK,2BAAoB;AACxB,sBACC;AACD,kBAAM;AACN,kBAAM;AACN,kBAAM;AACN;AAAA,UACD,KAAK,2BAAoB;AACxB,sBACC;AAED,kBAAM;AACN,kBAAM;AACN,kBAAM;AACN;AAAA,UACD;AACC,sBACC;AAAA,QACH;AACA,eACC,gBAAAD,OAAC,oBAAwB,IAAQ,IAAG,MAAK,IAAG,MAAK,IAAG,MAAK,IAAG,QAC3D;AAAA,0BAAAC,MAAC,UAAK,QAAO,MAAK,WAAW,SAAS,aAAa,KAAK;AAAA,UACxD,gBAAAA,MAAC,UAAK,QAAO,OAAM,WAAW,SAAS,aAAa,KAAK;AAAA,UACzD,gBAAAA,MAAC,UAAK,QAAO,QAAO,WAAW,SAAS,aAAa,KAAK;AAAA,aAHtC,EAIrB;AAAA,MAEF,CAAC;AAAA,OACF;AAAA,EAEF,GAAG,CAAC,SAAS,CAAC;AAEd,QAAM,gBAAsB,gBAAQ,MAAM;AACzC,QAAI,CAAC,UAAU,OAAQ,QAAO;AAE9B,UAAM,CAAC,SAAS,IAAI,OAAO,OAAO;AAClC,UAAM,QAAQ,OAAO,SAAS;AAE9B,UAAM,QAAQ,UACZ,IAAI,CAAC,KAAK,QAAQ;AAClB,YAAM,EAAE,OAAO,UAAU,KAAK,SAAS,SAAS,IAAI;AAEpD,UAAI,WAAW,KAAK,WAAW,WAAW,UAAU,WAAW;AAC9D,eAAO;AAER,YAAM,SAAS,WAAW,QAAQ;AAClC,YAAM,QAAQ,WAAW,OAAO;AAEhC,UAAI,IAAI;AAER,UAAI,aAAa,2BAAoB,QAAQ;AAE5C,cAAM,UAAU,MAAM,IAAI,UAAU,MAAM,CAAC,IAAI;AAC/C,cAAM,UAAU,MAAM,UAAU,SAAS,IAAI,UAAU,MAAM,CAAC,IAAI;AAElE,cAAM,QAAQ,UAAU,WAAW,QAAQ,GAAG,IAAI;AAClD,cAAM,QAAQ,UAAU,OAAO,IAAI,QAAQ,GAAG,EAAE,CAAC,IAAI;AAErD,cAAM,SAAS,UAAU,WAAW,QAAQ,KAAK,IAAI;AACrD,cAAM,SAAS,UAAU,OAAO,IAAI,QAAQ,KAAK,EAAE,CAAC,IAAI;AAExD,YAAI,KAAK,KAAK,IAAI,KAAK;AACvB,aAAK,MAAM,KAAK,IAAI,KAAK;AAEzB,iBAAS,IAAI,UAAU,KAAK,SAAS,KAAK;AACzC,eAAK,MAAM,WAAW,CAAC,CAAC,IAAI,OAAO,IAAI,CAAC,EAAE,CAAC,CAAC;AAAA,QAC7C;AAEA,aAAK,MAAM,MAAM,IAAI,MAAM;AAC3B,aAAK,MAAM,MAAM,IAAI,KAAK;AAAA,MAC3B,OAAO;AAEN,cAAM,UAAU,MAAM,IAAI,UAAU,MAAM,CAAC,IAAI;AAC/C,cAAM,UAAU,MAAM,UAAU,SAAS,IAAI,UAAU,MAAM,CAAC,IAAI;AAClE,cAAM,eAAe,WAAW,QAAQ,aAAa,2BAAoB;AACzE,cAAM,eAAe,WAAW,QAAQ,aAAa,2BAAoB;AACzE,cAAM,SAAS,OAAO,IAAI,QAAQ,EAAE,CAAC;AACrC,cAAM,QAAQ,OAAO,IAAI,OAAO,EAAE,CAAC;AACnC,YAAI,iBAAiB;AACrB,YAAI,eAAe;AAGnB,YAAI,cAAc;AACjB,gBAAM,QAAQ,WAAW,QAAS,GAAG;AACrC,gBAAM,QAAQ,OAAO,IAAI,QAAS,GAAG,EAAE,CAAC;AACxC,gBAAM,YAAY,IAAI,QAAQ,EAAE,IAAI,IAAI,QAAS,GAAG,EAAE;AACtD,cAAI,uBAAuB,uBAA4B,YAAY,GAAG;AAErE,gBAAI,KAAK,KAAK,IAAI,KAAK,MAAM,MAAM,IAAI,MAAM;AAC7C,6BAAiB;AAAA,UAClB,OAAO;AAEN,gBAAI,KAAK,MAAM,IAAI,KAAK,MAAM,MAAM,IAAI,MAAM;AAC9C,6BAAiB;AAAA,UAClB;AAAA,QACD,OAAO;AAEN,cAAI,KAAK,MAAM,IAAI,KAAK,MAAM,MAAM,IAAI,MAAM;AAAA,QAC/C;AAEA,iBAAS,IAAI,WAAW,GAAG,KAAK,SAAS,KAAK;AAC7C,eAAK,MAAM,WAAW,CAAC,CAAC,IAAI,OAAO,IAAI,CAAC,EAAE,CAAC,CAAC;AAAA,QAC7C;AAEA,aAAK,MAAM,KAAK,IAAI,KAAK;AAGzB,YAAI,cAAc;AACjB,gBAAM,aAAa,WAAW,QAAS,KAAK;AAC5C,gBAAM,aAAa,OAAO,IAAI,QAAS,KAAK,EAAE,CAAC;AAC/C,gBAAM,YAAY,IAAI,QAAS,KAAK,EAAE,IAAI,IAAI,OAAO,EAAE;AACvD,cACE,uBAAuB,uBAA4B,aAAa,KACjE,uBAAuB,uBACtB;AAED,iBAAK,MAAM,UAAU,IAAI,UAAU;AACnC,2BAAe;AAAA,UAChB;AAAA,QACD;AAGA,aAAK,MAAM,YAAY,IAAI,KAAK;AAChC,aAAK,MAAM,cAAc,IAAI,KAAK;AAGlC,YAAI,uBAAuB,2BAA8B,cAAc;AACtE,gBAAM,QAAQ,WAAW,QAAS,GAAG;AACrC,gBAAM,QAAQ,OAAO,IAAI,QAAS,GAAG,EAAE,CAAC;AACxC,gBAAM,QACL,gBAAAA;AAAA,YAAC;AAAA;AAAA,cAEA,GAAG,KAAK,KAAK,IAAI,KAAK,MAAM,KAAK,IAAI,KAAK,MAAM,MAAM,IAAI,MAAM,MAAM,MAAM,IAAI,KAAK;AAAA,cACrF,MAAM,QAAQ,kBAAkB,OAAO;AAAA,cACvC,QAAO;AAAA,cACP,WAAU;AAAA,cACV,eAAY;AAAA;AAAA,YALP,aAAa,GAAG;AAAA,UAMtB;AAED,iBACC,gBAAAD,OAAC,OACC;AAAA;AAAA,YACD,gBAAAC;AAAA,cAAC;AAAA;AAAA,gBAEA;AAAA,gBACA,MAAM,QAAQ,kBAAkB,OAAO,SAAS,GAAG;AAAA,gBACnD,QAAO;AAAA,gBACP,WAAU;AAAA,gBACV,eAAY;AAAA;AAAA,cALP,YAAY,GAAG;AAAA,YAMrB;AAAA,eATO,aAAa,GAAG,EAUxB;AAAA,QAEF;AAAA,MACD;AAEA,aACC,gBAAAA;AAAA,QAAC;AAAA;AAAA,UAEA;AAAA,UACA,MAAM,QAAQ,kBAAkB,OAAO,SAAS,GAAG;AAAA,UACnD,QAAO;AAAA,UACP,WAAU;AAAA,UACV,eAAY;AAAA;AAAA,QALP,YAAY,GAAG;AAAA,MAMrB;AAAA,IAEF,CAAC,EACA,OAAO,OAAO;AAEhB,WAAO,gBAAAA,MAAC,OAAE,WAAU,yBAAyB,iBAAM;AAAA,EACpD,GAAG,CAAC,WAAW,YAAY,WAAW,QAAQ,KAAK,kBAAkB,CAAC;AAItE,QAAM,oBAA0B,gBAAQ,MAAM;AAC7C,QAAI,EAAC,qDAAkB,cAAa,IAAI,UAAU,GAAG;AACpD,YAAM,KAAK,IAAI,IAAI,CAAC,MAAO,EAAE,aAAa,OAAO,EAAE,IAAI,IAAI,KAAK,EAAE,CAAC,CAAE;AACrE,YAAM,MAAM,IAAI,KAAK,KAAK,IAAI,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC,CAAC;AAC5D,YAAM,MAAM,IAAI,KAAK,KAAK,IAAI,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC,CAAC;AAC5D,YAAM,WACL,KAAK,OAAO,IAAI,QAAQ,IAAI,IAAI,QAAQ,KAAK,KAAQ,KAAK;AAC3D,UAAI,WAAW;AACd,eAAO,kCAAkC,WAAW,CAAC;AACtD,YAAM,QAAQ,KAAK,MAAM,WAAW,CAAC;AACrC,UAAI,QAAQ,GAAI,QAAO,kCAAkC,KAAK;AAC9D,YAAM,UACJ,IAAI,YAAY,IAAI,IAAI,YAAY,KAAK,MACzC,IAAI,SAAS,IAAI,IAAI,SAAS,KAC/B;AACD,aAAO,kCAAkC,MAAM;AAAA,IAChD;AACA,QAAI,qDAAkB,WAAW;AAChC,aAAO,kCAAkC,iBAAiB,SAAS;AAAA,IACpE;AACA,WAAO;AAAA,EACR,GAAG,CAAC,qDAAkB,WAAW,GAAG,CAAC;AAErC,QAAME,WAAU,CAAC,MAAc;AAC9B,UAAM,QAAQ,IAAI,IACjB,SAAS,IAAI;AACd,QAAI,UAAU,KAAK,WAAW,GAAI,QAAO,GAAG,CAAC;AAC7C,QAAI,UAAU,KAAK,WAAW,GAAI,QAAO,GAAG,CAAC;AAC7C,QAAI,UAAU,KAAK,WAAW,GAAI,QAAO,GAAG,CAAC;AAC7C,WAAO,GAAG,CAAC;AAAA,EACZ;AACA,QAAM,iBAAiB,CAAC,MACvB,GAAGA,SAAQ,EAAE,QAAQ,CAAC,CAAC,IAAI,EAAE,eAAe,SAAS,EAAE,OAAO,OAAO,CAAC,CAAC,KAAK,EAAE,YAAY,CAAC;AAE5F,QAAM,aAAmB;AAAA,IACxB,CAAC;AAAA,MACA;AAAA,MACA,GAAAC;AAAA,MACA,GAAAC;AAAA,IACD,MAKM;AACL,YAAM,MAAM,yCAAa;AACzB,YAAM,UAAUD,cAAa,OAAOA,KAAI,IAAI,KAAKA,EAAC;AAClD,YAAM,YAAY,eAAe,OAAO;AACxC,YAAMX,SAAO,qDAAkB,eAC5B,IAAI,iBAAiB,WAAW,KAChC;AACH,YAAM,WAAU,qDAAkB,eAC/B,IAAI,iBAAiB,WAAW,KAChC;AACH,UAAI,CAAC,KAAK;AACT,eAAO,uBAAuB,oBAAoB,oBAAoB,OAAO,EAAE,SAAS,QAAQ,CAAC,KAAK,SAAS,KAAKY,EAAC,GAAGZ,KAAI,GAAG,OAAO;AAAA,MACvI;AACA,YAAM,WAAW,eAAe,IAAI,aAAa,KAAK;AACtD,YAAM,UAAU,eAAe,GAAG;AAClC,YAAM,WAAW,QAAQ,SACtB,WAAW,CAAC,GAAG,IAAI,IAAI,QAAQ,IAAI,CAACI,OAAM,aAAaA,EAAC,EAAE,SAAS,CAAC,CAAC,EAAE,KAAK,IAAI,CAAC,MACjF;AACH,YAAM,WAAqB,CAAC;AAC5B,UAAI,qDAAkB;AACrB,iBAAS,KAAK,YAAY,iBAAiB,WAAW,GAAG;AAC1D,UAAI,qDAAkB;AACrB,iBAAS,KAAK,GAAG,iBAAiB,cAAc,GAAG;AACpD,UAAI,qDAAkB;AACrB,iBAAS,KAAK,iBAAiB,iBAAiB,YAAY,GAAG;AAChE,UAAI,qDAAkB;AACrB,iBAAS,KAAK,iBAAiB,cAAc;AAC9C,aAAO;AAAA,QACN;AAAA,QACA,GAAG;AAAA,QACH,SAAS,QAAQ,CAAC;AAAA,QAClB,YAAY;AAAA,QACZ,mBAAmBQ,EAAC,IAAIZ,KAAI,GAAG,OAAO;AAAA,QACtC,WAAW;AAAA,QACX;AAAA,MACD,EACE,KAAK,GAAG,EACR,QAAQ,QAAQ,GAAG,EACnB,KAAK;AAAA,IACR;AAAA,IACA,CAAC,YAAY,kBAAkB,iBAAiB;AAAA,EACjD;AAGA,QAAM,gBAAsB;AAAA,IAC3B,CAAC,OAAe,MAAoC;AACnD,YAAM,MAAM,yCAAa;AACzB,UAAI,CAAC,IAAK,QAAO;AACjB,YAAM,OAAO,WAAW;AAAA,QACvB;AAAA,QACA,UAAU;AAAA,QACV,GAAG,EAAE,aAAa,OAAO,EAAE,IAAI,IAAI,KAAK,EAAE,CAAC;AAAA,QAC3C,GAAG,EAAE;AAAA,MACN,CAAC;AAED,aAAO,KACL,QAAQ,2BAA2B,EAAE,EACrC,QAAQ,iBAAiB,EAAE;AAAA,IAC9B;AAAA,IACA,CAAC,YAAY,UAAU;AAAA,EACxB;AAEA,SACC,gBAAAQ,MAAC,mBACA,0BAAAD;AAAA,IAAC;AAAA;AAAA,MACA,WAAU;AAAA,MACV,MAAK;AAAA,MACL,cAAW;AAAA,MACX,wBAAqB;AAAA,MAErB;AAAA,wBAAAC;AAAA,UAAC;AAAA;AAAA,YACA,OAAO,SAAS,OAAO,MAAM,EAAE,CAAC,IAAI,KAAK;AAAA,YACzC,QAAQ,SAAS,OAAO,MAAM,EAAE,CAAC,IAAI,KAAK;AAAA,YAC1C,MAAK;AAAA,YAEL,0BAAAD,OAAC,OAAE,WAAW,oBACb;AAAA,8BAAAC,MAAC,gBAAK,MAAK,KAAI;AAAA,cACf,gBAAAA,MAAC,gBAAK,MAAK,KAAI;AAAA,cACf,gBAAAA,MAAC,qBAAU,MAAK,KAAI;AAAA,cACnB;AAAA,cACA;AAAA,cACA,iBAAiB,IAAI,CAAC,KAAa,MAAc;AACjD,sBAAM,IAAI,IAAI,GAAG;AACjB,oBAAI,CAAC,EAAG,QAAO;AACf,sBAAMG,KAAI,OAAO,EAAE,aAAa,OAAO,EAAE,IAAI,IAAI,KAAK,EAAE,CAAC,CAAC;AAC1D,uBACC,gBAAAH;AAAA,kBAAC;AAAA;AAAA,oBAEA,IAAIG;AAAA,oBACJA;AAAA,oBACA,IAAI;AAAA,oBACJ,IAAI,OAAO,MAAM,EAAE,CAAC;AAAA,oBACpB,QAAO;AAAA,oBACP,iBAAgB;AAAA,oBAChB,aAAa;AAAA,oBACb,eAAY;AAAA,oBACZ,WAAU;AAAA;AAAA,kBATL,oBAAoB,CAAC;AAAA,gBAU3B;AAAA,cAEF,CAAC;AAAA,eAEA,+CAAe,KAAK,WAAU,MAAM;AACpC,uBACC,gBAAAJ,OAAC,OAAE,eAAY,QAAO,WAAU,qBAC9B;AAAA,gCAAc,KAAK,IAAI,CAAC,GAAE,MAC1B,gBAAAC,MAAC,UAAuB,WAAU,eAAc,IAAI,EAAE,IAAI,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,IAAI,EAAE,KAAxE,QAAQ,CAAC,EAAkE,CACtF;AAAA,kBACA,cAAc,KAAK,IAAI,CAAC,GAAE,MAAM;AAChC,wBAAI,MAAM,cAAc,KAAK,SAAS,EAAG,QAAO;AAChD,0BAAM,OAAO,cAAc,KAAK,IAAE,CAAC;AACnC,wBAAI,CAAC,KAAM,QAAO;AAClB,wBAAI,EAAE,MAAM,KAAK,EAAG,QAAO;AAC3B,0BAAM,MAAM,KAAK,IAAI,GAAI,KAAK,KAAK,EAAE,MAAO,CAAC;AAC7C,0BAAM,IAAI,MAAM;AAEhB,0BAAM,IAAI,KAAK,EAAE,EAAE,IAAI,EAAE,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,EAAE,CAAC,IAAI,KAAK,KAAK,CAAC,IAAI,KAAK,CAAC,IAAI,KAAK,EAAE,IAAI,KAAK,CAAC;AAC7F,2BAAO,gBAAAA,MAAC,UAA4B,WAAU,gCAA+B,GAAM,MAAK,UAAtE,aAAa,CAAC,EAA+D;AAAA,kBAChG,CAAC;AAAA,mBACF;AAAA,cAEF,GAAG,IAAI;AAAA,cACN,iBAAiB;AAAA,cAEjB,gBAAAA,MAAAK,WAAA,EAAE;AAAA,eAEF,+CAAe,IAAI,WAAU,MAC7B,gBAAAN,OAAC,OAAE,eAAY,QAAO,WAAU,kDAC9B;AAAA,8BAAc,IAAI,IAAI,CAAC,GAAE,MACzB,gBAAAC,MAAC,UAAsB,WAAU,sCAAqC,IAAI,EAAE,IAAI,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,aAAa,KAA9G,OAAO,CAAC,EAAyG,CAC5H;AAAA,gBACA,cAAc,IAAI,IAAI,CAAC,GAAE,MAAM;AAC/B,sBAAI,MAAM,cAAc,IAAI,SAAS,EAAG,QAAO;AAC/C,wBAAM,OAAO,cAAc,IAAI,IAAE,CAAC;AAClC,sBAAI,CAAC,KAAM,QAAO;AAClB,sBAAI,EAAE,MAAM,KAAK,EAAG,QAAO;AAC3B,wBAAM,MAAM,KAAK,IAAI,GAAI,KAAK,KAAK,EAAE,MAAO,CAAC;AAC7C,wBAAM,IAAI,MAAM;AAChB,wBAAM,IAAI,KAAK,EAAE,EAAE,IAAI,EAAE,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,EAAE,CAAC,IAAI,KAAK,KAAK,CAAC,IAAI,KAAK,CAAC,IAAI,KAAK,EAAE,IAAI,KAAK,CAAC;AAC7F,yBAAO,gBAAAA,MAAC,UAA2B,WAAU,0DAAyD,GAAM,MAAK,QAAO,aAAa,KAAnH,YAAY,CAAC,EAAyG;AAAA,gBACzI,CAAC;AAAA,iBACF,GACE,IAAI;AAAA,eACN,+CAAe,IAAI,WAAU,MAC7B,gBAAAD,OAAC,OAAE,eAAY,QAAO,WAAU,kDAC9B;AAAA,8BAAc,IAAI,IAAI,CAAC,GAAE,MACzB,gBAAAC,MAAC,UAAsB,WAAU,sCAAqC,IAAI,EAAE,IAAI,IAAI,EAAE,IAAI,IAAI,EAAE,GAAG,IAAI,EAAE,GAAG,aAAa,KAA9G,OAAO,CAAC,EAAyG,CAC5H;AAAA,gBACA,cAAc,IAAI,IAAI,CAAC,GAAE,MAAM;AAC/B,sBAAI,MAAM,cAAc,IAAI,SAAS,EAAG,QAAO;AAC/C,wBAAM,OAAO,cAAc,IAAI,IAAE,CAAC;AAClC,sBAAI,CAAC,KAAM,QAAO;AAClB,sBAAI,EAAE,MAAM,KAAK,EAAG,QAAO;AAC3B,wBAAM,MAAM,KAAK,IAAI,GAAI,KAAK,KAAK,EAAE,MAAO,CAAC;AAC7C,wBAAM,IAAI,MAAM;AAChB,wBAAM,IAAI,KAAK,EAAE,EAAE,IAAI,EAAE,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,EAAE,CAAC,IAAI,KAAK,KAAK,CAAC,IAAI,KAAK,CAAC,IAAI,KAAK,EAAE,IAAI,KAAK,CAAC;AAC7F,yBAAO,gBAAAA,MAAC,UAA2B,WAAU,0DAAyD,GAAM,MAAK,QAAO,aAAa,KAAnH,YAAY,CAAC,EAAyG;AAAA,gBACzI,CAAC;AAAA,iBACF,GACE,IAAI;AAAA,cAEN,iBAAiB,QACjB,gBAAAD,OAAC,OAAE,eAAY,QAAO,WAAU,yBAC/B;AAAA,gCAAAC;AAAA,kBAAC;AAAA;AAAA,oBACA,WAAU;AAAA,oBACV,eAAY;AAAA,oBACZ,IAAI;AAAA,oBACJ,IAAI,OAAO,MAAM,EAAE,CAAC;AAAA,oBACpB,IAAI,OAAO,aAAa;AAAA,oBACxB,IAAI,OAAO,aAAa;AAAA,oBACxB,aAAa;AAAA;AAAA,gBACd;AAAA,gBACA,gBAAAD;AAAA,kBAAC;AAAA;AAAA,oBACA,eAAY;AAAA,oBACZ,GAAG,OAAO,MAAM,EAAE,CAAC,IAAI;AAAA,oBACvB,GAAG,OAAO,aAAa,IAAI;AAAA,oBAC3B,YAAW;AAAA,oBACX,WAAU;AAAA,oBACV,UAAU;AAAA,oBACV;AAAA;AAAA,sBACQ;AAAA,sBAAe;AAAA,sBACtB,kBAAiB,qDAAkB,gBAAe;AAAA;AAAA;AAAA,gBACpD;AAAA,iBACD;AAAA,cAEA,aAAa,iBAAiB,cAAc,KAAK,SAAS,KAC1D,gBAAAA,OAAAM,WAAA,EACE;AAAA,8BAAc,OAAO,IAAI,CAAC,GAAG,MAC7B,gBAAAL;AAAA,kBAAC;AAAA;AAAA,oBAEA,WAAU;AAAA,oBACV,IAAI,EAAE;AAAA,oBACN,IAAI,EAAE;AAAA,oBACN,IAAI,EAAE;AAAA,oBACN,IAAI,EAAE;AAAA,oBACN,eAAY;AAAA,oBACZ,aAAa;AAAA;AAAA,kBAPR,UAAU,CAAC;AAAA,gBAQjB,CACA;AAAA,gBACA,cAAc,OAAO,IAAI,CAAC,GAAG,MAC7B,gBAAAA;AAAA,kBAAC;AAAA;AAAA,oBAEA,WAAU;AAAA,oBACV,IAAI,EAAE;AAAA,oBACN,IAAI,EAAE;AAAA,oBACN,IAAI,EAAE;AAAA,oBACN,IAAI,EAAE;AAAA,oBACN,eAAY;AAAA,oBACZ,aAAa;AAAA;AAAA,kBAPR,UAAU,CAAC;AAAA,gBAQjB,CACA;AAAA,gBACA,cAAc,OAAO,IAAI,CAAC,GAAG,MAC7B,gBAAAA;AAAA,kBAAC;AAAA;AAAA,oBAEA,WAAU;AAAA,oBACV,IAAI,EAAE;AAAA,oBACN,IAAI,EAAE;AAAA,oBACN,IAAI,EAAE;AAAA,oBACN,IAAI,EAAE;AAAA,oBACN,eAAY;AAAA,oBACZ,aAAa;AAAA;AAAA,kBAPR,UAAU,CAAC;AAAA,gBAQjB,CACA;AAAA,gBACA,cAAc,OAAO,IAAI,CAAC,GAAG,MAC7B,gBAAAA;AAAA,kBAAC;AAAA;AAAA,oBAEA,WAAU;AAAA,oBACV,IAAI,EAAE;AAAA,oBACN,IAAI,EAAE;AAAA,oBACN,IAAI,EAAE;AAAA,oBACN,IAAI,EAAE;AAAA,oBACN,eAAY;AAAA,oBACZ,aAAa;AAAA;AAAA,kBAPR,UAAU,CAAC;AAAA,gBAQjB,CACA;AAAA,iBACF;AAAA,cAGA,kBAAkB,yBAAyB,mCAAmC,4BAA4B,MAAM;AAChH,sBAAM,WAAW,cAAc;AAC/B,sBAAM,WAAW,cAAc;AAC/B,sBAAM,KAAK,IAAI,QAAQ,IAAI,OAAO,IAAI,QAAQ,EAAE,aAAa,OAAO,IAAI,QAAQ,EAAE,IAAY,IAAI,KAAK,IAAI,QAAQ,EAAE,CAAC,CAAC,IAAI;AAC3H,sBAAM,KAAK,IAAI,QAAQ,IAAI,OAAO,IAAI,QAAQ,EAAE,CAAC,IAAI;AACrD,sBAAM,KAAM,YAAY,QAAQ,IAAI,QAAQ,IAAK,OAAO,IAAI,QAAQ,EAAE,aAAa,OAAO,IAAI,QAAQ,EAAE,IAAY,IAAI,KAAK,IAAI,QAAQ,EAAE,CAAC,CAAC,IAAI;AACjJ,sBAAM,KAAM,YAAY,QAAQ,IAAI,QAAQ,IAAK,OAAO,IAAI,QAAQ,EAAE,CAAC,IAAI;AAC3E,uBACC,gBAAAD,OAAC,OAAE,eAAY,QAAO,WAAU,2BAC9B;AAAA,4CAA0B,MAAM,QAAQ,MAAM,QAAQ,MAAM,QAAQ,MAAM,QAC1E,gBAAAC,MAAC,UAAK,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,QAAO,QAAO,iBAAgB,OAAM,aAAa,GACtF,0BAAAA,MAAC,WAAM,gEAAkD,GAC1D;AAAA,kBAEA,yBAAyB,MAAM,QAAQ,MAAM,QAC7C,gBAAAA,MAAC,YAAO,IAAI,IAAI,IAAI,IAAI,GAAG,GAAG,MAAK,SAAQ,QAAO,QAAO,aAAa,GACrE,0BAAAA,MAAC,WAAM,yCAA2B,GACnC;AAAA,kBAEA,mCAAmC,MAAM,QAAQ,MAAM,QACvD,gBAAAA,MAAC,YAAO,IAAQ,IAAQ,GAAG,GAAG,MAAK,QAClC,0BAAAA,MAAC,WAAM,6CAA+B,GACvC;AAAA,mBAEF;AAAA,cAEF,GAAG;AAAA,cACH,gBAAAA;AAAA,gBAAC;AAAA;AAAA,kBACA,QAAQ,OAAO,CAAC;AAAA,kBAChB,aAAa;AAAA,kBACb,SAAQ;AAAA,kBACR,YAAY;AAAA,kBACZ,iBAAiB;AAAA,kBACjB,YAAY;AAAA,kBACZ,QAAQ,CAAC,MACR,EAAE,aAAa,OAAO,EAAE,IAAI,IAAI,KAAK,EAAE,CAAC;AAAA,kBAEzC,QAAQ;AAAA,kBACR,aAAa;AAAA;AAAA,cACd;AAAA,cACC,cACA,IAAI,IAAI,CAAC,GAAG,MAAM;AAzmDzB,oBAAAP;AA0mDQ,sBAAM,KAAK,OAAO,EAAE,aAAa,OAAO,EAAE,IAAI,IAAI,KAAK,EAAE,CAAC,CAAC;AAC3D,sBAAM,KAAK,OAAO,EAAE,CAAC;AACrB,sBAAM,MAAM,aAAa,IAAI,CAAC;AAC9B,sBAAM,MAAM,+CAAgB;AAG5B,sBAAM,sBACL,oBAAoB,2BACpB,CAAC,EAAC,2BAAK,aACP,2BAAK,0CACL,qBAAqB,QACrB;AACD,sBAAM,2BACL,yBACE,2BAAK,YAAW,wCAChB,2BAAK,cAAa;AACrB,sBAAM,uBACL,yBACE,2BAAK,YAAW,4CAChB,2BAAK,cAAa;AACrB,sBAAM,gBAAgB,CAAC,GAAE,2BAAK,gBAAe;AAC7C,sBAAM,YAAY,CAAC,GAAE,2BAAK,YAAW;AACrC,sBAAM,UAAU;AAAA,kBACf;AAAA,kBACA,OAAO,wBAAwB,wBAAwB;AAAA,kBACvD,gBAAe,2BAAK,YAAW,YAC5B,+BACA;AAAA,kBACH,gBAAe,2BAAK,YAAW,gBAC5B,mCACA;AAAA;AAAA,kBAEH,eACA,6BACA,2BAAK,YACL,IAAI,yCACJ,CAAC,iBACD,CAAC,YACE,oCACA;AAAA,mBACH,2BAAK,mCACF,mCACA;AAAA,mBACH,2BAAK,mCACF,mCACA;AAAA,gBACJ,EACE,OAAO,OAAO,EACd,KAAK,GAAG;AACV,sBAAMa,aACL,SAAS,IAAI,CAAC,UAAU,EAAE,CAAC,OAC1B,2BAAK,WAAU,mBAAmB,QAClC,2BAAK,iDACH,gBACA,2BAAK,yCACJ,aACA;AAEL,sBAAM,cAAYb,MAAA,yCAAY,YAAZ,gBAAAA,IAAqB,WAAU;AACjD,uBACC,gBAAAO;AAAA,kBAAC;AAAA;AAAA,oBAEA;AAAA,oBACA;AAAA,oBACA,GAAG;AAAA,oBACH,WAAW;AAAA,oBACX,kBAAgB,2BAAK;AAAA,oBACrB,kBAAgB,2BAAK;AAAA,oBACrB,cAAYM;AAAA,oBACX,GAAI,YACF,EAAE,oBAAoB,eAAe,CAAC,GAAG,IACzC,CAAC;AAAA;AAAA,kBAVC;AAAA,gBAWN;AAAA,cAEF,CAAC;AAAA,cACD,aACA,eACA,iBACA,IAAI,IAAI,CAAC,GAAG,MAAM;AACjB,sBAAM,MAAM,cAAc,CAAC;AAC3B,oBAAI,CAAC,IAAK,QAAO;AACjB,oBAAI,EAAE,IAAI,WAAW,IAAI,aAAc,QAAO;AAC9C,sBAAM,OAAO,OAAO,EAAE,aAAa,OAAO,EAAE,IAAI,IAAI,KAAK,EAAE,CAAC,CAAC;AAC7D,sBAAM,YAAY,OAAO,EAAE,CAAC;AAC5B,oBAAI,QAAQ,YAAY;AACxB,sBAAM,aAAa;AACnB,sBAAM,cAAc,OAAO,MAAM,EAAE,CAAC,IAAI;AACxC,oBAAI,QAAQ,YAAY;AAGvB,0BAAQ,KAAK,IAAI,YAAY,IAAI,WAAW;AAAA,gBAC7C;AAEA,sBAAMC,aAAY,OAAO,MAAM,EAAE,CAAC;AAClC,sBAAM,QAAQ,KAAK,IAAI,KAAK,IAAI,MAAM,CAAC,GAAGA,aAAY,CAAC;AACvD,uBACC,gBAAAP;AAAA,kBAAC;AAAA;AAAA,oBAEA,GAAG;AAAA,oBACH,GAAG;AAAA,oBACH,YAAW;AAAA,oBACX,WAAW,iBAAiB,IAAI,UAAU,2BAA2B,4BAA4B;AAAA,oBACjG,eAAY;AAAA,oBAEX,cAAI,UAAU,MAAM;AAAA;AAAA,kBAPhB,QAAQ,CAAC;AAAA,gBAQf;AAAA,cAEF,CAAC;AAAA,cAED,YACA,gBAAAA;AAAA,gBAAC;AAAA;AAAA,kBACA,OAAO,OAAO,MAAM,EAAE,CAAC;AAAA,kBACvB,QAAQ,OAAO,MAAM,EAAE,CAAC;AAAA;AAAA,cACzB;AAAA,cAEA,CAAC,wBACD,gBAAAA;AAAA,gBAAC;AAAA;AAAA,kBACA;AAAA,kBACA,QAAQ,EAAE,MAAM,OAAO,MAAM,OAAO,OAAO,MAAM;AAAA,kBACjD,gBAAgB;AAAA,kBAChB,aAAa,qDAAkB;AAAA,kBAC/B,aAAa,qDAAkB;AAAA,kBAC/B,eAAe,CAAC,MAAY,eAAe,CAAC;AAAA,kBAC5C;AAAA,kBACA;AAAA;AAAA,cACD;AAAA,eAEF;AAAA;AAAA,QACD;AAAA,QACC,wBACA,gBAAAA,MAAC,SAAI,OAAO,EAAE,WAAW,EAAE,GAC1B,0BAAAA;AAAA,UAAC;AAAA;AAAA,YACA;AAAA,YACA,aAAa,qDAAkB;AAAA,YAC/B,aAAa,kBAAiB,qDAAkB;AAAA,YAChD;AAAA;AAAA,QACD,GACD;AAAA,QAEA,iBACA,gBAAAA;AAAA,UAAC;AAAA;AAAA,YACA,QAAQ,CAAC,MACR,WAAW,EAAE,GAAG,GAAG,GAAG,EAAE,aAAa,OAAO,EAAE,IAAI,IAAI,KAAK,EAAE,CAAC,EAAE,CAAC;AAAA;AAAA,QAEnE;AAAA;AAAA;AAAA,EAEF,GACD;AAEF;AAGA,IAAM,mBAAgE,CAAC;AAAA,EACtE;AAAA,EACA;AACD,MAAM;AACL,QAAM,IAAI,kBAAkB;AAC5B,MAAI,CAAC,EAAG,QAAO;AACf,SACC,gBAAAA;AAAA,IAAC;AAAA;AAAA,MACA,WAAU;AAAA,MACV;AAAA,MACA;AAAA,MACA,MAAK;AAAA,MACL,UAAU;AAAA,MACV,cAAW;AAAA,MACX,aAAa,CAAC,MAAM;AACnB,cAAM,SAAS,EAAE;AACjB,cAAM,SAAS,OAAO,sBAAsB;AAC5C,cAAMG,KAAI,EAAE,UAAU,OAAO;AAC7B,cAAMC,KAAI,EAAE,UAAU,OAAO;AAC7B,UAAE,aAAaD,IAAGC,EAAC;AAAA,MACpB;AAAA,MACA,cAAc,MAAM,EAAE,MAAM;AAAA,MAC5B,WAAW,CAAC,MAAM;AACjB,gBAAQ,EAAE,KAAK;AAAA,UACd,KAAK;AACJ,cAAE,eAAe;AACjB,cAAE,eAAe;AACjB;AAAA,UACD,KAAK;AACJ,cAAE,eAAe;AACjB,cAAE,eAAe;AACjB;AAAA,UACD,KAAK;AACJ,cAAE,gBAAgB;AAClB,cAAE,eAAe;AACjB;AAAA,UACD,KAAK;AACJ,cAAE,gBAAgB;AAClB,cAAE,eAAe;AACjB;AAAA,UACD,KAAK;AACJ,cAAE,gBAAgB;AAClB,cAAE,eAAe;AACjB;AAAA,UACD,KAAK;AACJ,cAAE,eAAe;AACjB,cAAE,eAAe;AACjB;AAAA,QACF;AAAA,MACD;AAAA,MACA,OAAO,EAAE,QAAQ,YAAY;AAAA;AAAA,EAC9B;AAEF;AAGA,IAAO,mBAAQ;;;Ae1zDf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;",
  "names": ["classNames", "Prism", "_self", "lang", "range", "Prism", "Prism", "React", "x", "x", "key", "ticks", "range", "range", "range", "format", "r", "t1", "x", "y", "y", "y", "color", "rgb", "r", "x", "x", "zero", "i", "x", "number", "x", "x", "range", "r", "i", "y", "number", "x", "x", "x", "x", "x", "x", "locale", "sign", "zero", "format", "formatPrefix", "value", "linear", "date", "range", "date", "date", "date", "date", "date", "date", "date", "date", "ticks", "step", "date", "y", "locale", "formats", "pad", "format", "sign", "locale", "defaultLocale", "number", "ticks", "second", "format", "formatYear", "tickFormat", "date", "y", "constant_default", "x", "x", "y", "r", "x", "x", "y", "x", "y", "constant_default", "path", "constant_default", "path", "x", "point", "t0", "t1", "y", "range", "linear", "pad", "x", "y", "_a", "React", "_a", "_b", "React", "jsx", "React", "jsx", "_a", "_b", "React", "jsx", "jsxs", "ticks", "y", "_a", "jsx", "jsxs", "ticks", "React", "path", "hex", "x", "r", "y", "rgb", "_a", "_b", "path", "map", "hex", "copy", "React", "jsx", "React", "jsx", "xScale", "yScale", "d", "jsx", "jsxs", "_a", "path", "color", "React", "jsx", "format", "x", "y", "jsx", "jsxs", "jsx", "jsxs", "pad", "_a", "useState", "useCallback", "useRef", "jsx", "jsxs", "useState", "_a", "useRef", "useCallback", "classNames", "React", "jsx", "forwardRef", "useCallback", "useState", "React", "id", "style", "title", "ariaLabel", "ariaDescribedBy", "ariaLabelledBy", "tabIndex", "_a", "import_classnames", "import_classnames", "_a", "jsx", "jsx", "jsxs", "classNames", "jsx", "jsxs", "Prism", "classNames", "format", "Tag", "jsx", "jsxs", "point", "r", "_a", "React", "jsx", "jsxs", "wasHidden", "item", "label", "msg", "React", "jsx", "jsxs", "React", "jsx", "jsxs", "_a", "color", "gen", "React", "jsx", "jsxs", "_a", "_b", "explicit", "y", "barWidth", "React", "jsx", "_a", "_b", "linear", "jsx", "jsxs", "color", "y", "x", "jsx", "color", "y", "x", "jsx", "jsxs", "statusColor", "x", "React", "jsx", "jsxs", "React", "jsx", "React", "Fragment", "jsx", "jsxs", "unit", "isNumber", "React", "color", "jsx", "jsxs", "color", "import_classnames", "useState", "useState", "useEffect", "jsx", "jsxs", "useState", "useEffect", "jsx", "_a", "jsx", "jsxs", "jsx", "jsxs", "useState", "classNames", "useState", "useRef", "useCallback", "import_classnames", "jsx", "jsxs", "classNames", "useState", "useRef", "useCallback", "r", "import_classnames", "React", "jsx", "classNames", "jsx", "import_classnames", "jsx", "classNames", "import_classnames", "jsx", "jsxs", "classNames", "jsx", "jsxs", "jsx", "_a", "Fragment", "jsx", "jsxs", "getNode", "path", "_a", "_b", "r", "React", "React", "ChartType", "ImprovementDirection", "VariationIcon", "AssuranceIcon", "BaselineSuggestionReason", "mean", "_a", "_b", "jsx", "jsxs", "_a", "_b", "r", "unit", "useId", "useMemo", "AssuranceResult", "MetricPolarity", "Direction", "VariationJudgement", "VariationState", "hex", "r", "SpcGradientCategory", "SpcEmbeddedIconVariant", "Fragment", "jsx", "jsxs", "_a", "_b", "state", "direction", "map", "useId", "useMemo", "defs", "useId", "Fragment", "jsx", "jsxs", "useId", "y", "mean", "isNumber", "r", "_a", "SpcWarningSeverity", "SpcWarningCategory", "SpcWarningCode", "r", "slice", "_b", "r", "React", "jsx", "jsxs", "_a", "_b", "r", "Fragment", "jsx", "jsxs", "unit", "_a", "_b", "_c", "r", "mean", "msg", "jsxs", "jsx", "map", "ordinal", "x", "y", "Fragment", "ariaLabel", "plotWidth"]
}
