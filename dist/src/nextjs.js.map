{"version":3,"file":"nextjs.js","sources":["../../src/nextjs/useNavigationSplitNextUrlSync.ts","../../src/nextjs/NHSBehavioursInit.tsx","../../src/nextjs/InitBehaviours.tsx"],"sourcesContent":["/**\n * @deprecated This hook is deprecated and will be removed in a future version.\n * \n * Use the framework-agnostic `useNavigationSplitUrlSync` instead:\n * ```ts\n * import { useNavigationSplitUrlSync } from '@nhsdigital/fdp-design-system';\n * ```\n * \n * If you need Next.js App Router integration, create your own wrapper in your app:\n * ```tsx\n * // app/hooks/useNavigationSplitNextUrlSync.ts\n * \"use client\";\n * import { useSearchParams, usePathname, useRouter } from 'next/navigation';\n * import { useCallback } from 'react';\n * \n * export function useNavigationSplitNextUrlSync<ID = string>(options: {\n *   paramSelected?: string;\n *   paramDrill?: string;\n *   method?: 'replace' | 'push';\n * } = {}) {\n *   const { paramSelected = 'nsv', paramDrill = 'nsvDrill', method = 'replace' } = options;\n *   const searchParams = useSearchParams();\n *   const pathname = usePathname();\n *   const router = useRouter();\n * \n *   const selectedId = (searchParams.get(paramSelected) as ID | null) || undefined;\n *   const drilledIn = searchParams.get(paramDrill) === '1';\n * \n *   const update = useCallback((nextSelected: ID | undefined, nextDrilled: boolean) => {\n *     const sp = new URLSearchParams(searchParams.toString());\n *     if (nextSelected) sp.set(paramSelected, String(nextSelected)); else sp.delete(paramSelected);\n *     sp.set(paramDrill, nextDrilled ? '1' : '0');\n *     const url = `${pathname}?${sp.toString()}`;\n *     method === 'push' ? router.push(url, { scroll: false }) : router.replace(url, { scroll: false });\n *   }, [searchParams, pathname, router, method, paramSelected, paramDrill]);\n * \n *   return {\n *     selectedId,\n *     drilledIn,\n *     setSelectedId: (id: ID | undefined) => update(id, drilledIn),\n *     setDrilledIn: (d: boolean) => update(selectedId, d)\n *   } as const;\n * }\n * ```\n */\nimport * as React from 'react';\n\n// Dynamically (optionally) load next/navigation so the library can build\n// without Next.js installed (optional peer). We intentionally avoid a\n// static import because Vite's optional peer plugin rewrites it and\n// Rollup then verifies named exports that won't exist when Next is absent.\n// Using a guarded require keeps this entry tree‑shakable for non‑Next\n// consumers while still providing full behaviour in a Next environment.\n\nlet nextNav: any | null = null;\ntry {\n  // Use Function constructor to avoid bundlers trying to resolve at build.\n  const req = (Function('return require'))();\n  nextNav = req('next/navigation');\n} catch {\n  nextNav = null;\n}\n\nconst useSearchParams = nextNav?.useSearchParams as (() => URLSearchParams) | undefined;\nconst usePathname = nextNav?.usePathname as (() => string) | undefined;\ninterface NextRouterLike { push: (url: string, opts?: { scroll?: boolean; shallow?: boolean }) => void; replace: (url: string, opts?: { scroll?: boolean; shallow?: boolean }) => void; }\nconst useRouter = nextNav?.useRouter as (() => NextRouterLike) | undefined;\n\nexport interface UseNavigationSplitNextUrlSyncOptions {\n  paramSelected?: string;\n  paramDrill?: string;\n  /** Navigation method for updates (default replace to avoid history spam) */\n  method?: 'replace' | 'push';\n}\n\n/**\n * @deprecated Use `useNavigationSplitUrlSync` from the main entry instead.\n * This Next.js-specific hook will be removed in a future version.\n */\nexport function useNavigationSplitNextUrlSync<ID = string>(options: UseNavigationSplitNextUrlSyncOptions = {}) {\n  const { paramSelected = 'nsv', paramDrill = 'nsvDrill', method = 'replace' } = options;\n\n  // Emit deprecation warning once per session\n  React.useEffect(() => {\n    if (process.env.NODE_ENV !== 'production') {\n      console.warn(\n        '[useNavigationSplitNextUrlSync] DEPRECATED: This hook will be removed in a future version. ' +\n        'Use useNavigationSplitUrlSync from the main entry, or create your own Next.js wrapper in your app. ' +\n        'See the JSDoc comments for migration guidance.'\n      );\n    }\n  }, []);\n\n  if (!useSearchParams || !usePathname || !useRouter) {\n    if (process.env.NODE_ENV !== 'production') {\n      console.warn('[useNavigationSplitNextUrlSync] next/navigation not available – returning inert helpers. Import this hook only within a Next.js App Router environment.');\n    }\n    return {\n      selectedId: undefined as ID | undefined,\n      drilledIn: false,\n      setSelectedId: () => {},\n      setDrilledIn: () => {}\n    } as const;\n  }\n\n  const searchParams = useSearchParams();\n  const pathname = usePathname();\n  const router = useRouter();\n\n  const selectedId = (searchParams.get(paramSelected) as ID | null | undefined) || undefined;\n  const drilledIn = searchParams.get(paramDrill) === '1';\n\n  const update = React.useCallback((nextSelected: ID | undefined, nextDrilled: boolean) => {\n    const sp = new URLSearchParams(searchParams.toString());\n    if (nextSelected) sp.set(paramSelected, String(nextSelected)); else sp.delete(paramSelected);\n    sp.set(paramDrill, nextDrilled ? '1' : '0');\n    const qs = sp.toString();\n    const url = qs ? `${pathname}?${qs}` : pathname;\n    const nav = method === 'push' ? router.push : router.replace;\n    nav(url, { scroll: false });\n  }, [searchParams, pathname, router, method, paramSelected, paramDrill]);\n\n  return {\n    selectedId,\n    drilledIn,\n    setSelectedId: (id: ID | undefined) => update(id, drilledIn),\n    setDrilledIn: (d: boolean) => update(selectedId, d)\n  } as const;\n}\n\nexport type UseNavigationSplitNextUrlSyncReturn<ID = string> = ReturnType<typeof useNavigationSplitNextUrlSync<ID>>;\n","\"use client\";\n\n/**\n * @deprecated This component is deprecated and will be removed in a future version.\n * \n * Instead, create your own client-side behaviours initializer in your Next.js app:\n * \n * ```tsx\n * // app/components/BehavioursInit.tsx\n * \"use client\";\n * import { useEffect } from \"react\";\n * \n * export function BehavioursInit() {\n *   useEffect(() => {\n *     let cancelled = false;\n *     (async () => {\n *       try {\n *         const { initAll } = await import(\"@nhsdigital/fdp-design-system/behaviours\");\n *         if (!cancelled && typeof initAll === \"function\") {\n *           initAll(document);\n *         }\n *       } catch (err) {\n *         console.error(\"Failed to load behaviours\", err);\n *       }\n *     })();\n *     return () => { cancelled = true; };\n *   }, []);\n *   return null;\n * }\n * ```\n * \n * Then use it in your layout:\n * ```tsx\n * // app/layout.tsx\n * import { BehavioursInit } from \"./components/BehavioursInit\";\n * \n * export default function RootLayout({ children }) {\n *   return (\n *     <html>\n *       <body>\n *         {children}\n *         <BehavioursInit />\n *       </body>\n *     </html>\n *   );\n * }\n * ```\n * \n * This approach removes the Next.js dependency from the design system while\n * giving you full control over when and how behaviours are initialized.\n */\nimport { useEffect } from \"react\";\n\n/**\n * @deprecated Create your own BehavioursInit component in your app instead.\n * See the JSDoc above for migration guidance.\n */\nexport function NHSBehavioursInit() {\n\tuseEffect(() => {\n\t\t// Emit deprecation warning once\n\t\tif (process.env.NODE_ENV !== 'production') {\n\t\t\tconsole.warn(\n\t\t\t\t'[NHSBehavioursInit] DEPRECATED: This component will be removed in a future version. ' +\n\t\t\t\t'Create your own BehavioursInit component in your app instead. ' +\n\t\t\t\t'See the JSDoc comments for migration guidance.'\n\t\t\t);\n\t\t}\n\n\t\tlet cancelled = false;\n\n\t\t(async () => {\n\t\t\ttry {\n\t\t\t\t// Import via the package export so Next bundles it for the client.\n\t\t\t\tconst mod: any = await import(\n\t\t\t\t\t\"@nhsdigital/fdp-design-system/behaviours\"\n\t\t\t\t);\n\t\t\t\tif (cancelled) return;\n\n\t\t\t\t// The behaviours bundle already exposes globals when loaded.\n\t\t\t\t// For determinism in hydration-sensitive apps, also invoke initAll immediately if present.\n\t\t\t\tif (mod && typeof mod.initAll === \"function\") {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tmod.initAll(document);\n\t\t\t\t\t} catch {}\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error(\"NHSBehavioursInit: failed to load behaviours\", err);\n\t\t\t}\n\t\t})();\n\n\t\treturn () => {\n\t\t\tcancelled = true;\n\t\t};\n\t}, []);\n\n\treturn null;\n}\n","/**\n * @deprecated These components are deprecated and will be removed in a future version.\n * \n * Create your own BehavioursInit component in your Next.js app instead.\n * See NHSBehavioursInit.tsx for migration guidance and example code.\n */\nimport { NHSBehavioursInit } from './NHSBehavioursInit';\n\n/**\n * @deprecated Use your own BehavioursInit component instead.\n * See NHSBehavioursInit.tsx for migration guidance.\n */\nexport function InitBehaviours() {\n\t// Forward to the client component. This avoids brittle inline script imports.\n\treturn <NHSBehavioursInit />;\n}\n\n/**\n * @deprecated Use your own BehavioursInit component instead.\n * See NHSBehavioursInit.tsx for migration guidance.\n */\nexport function InitBehavioursInline() {\n\treturn <NHSBehavioursInit />;\n}\n"],"names":["nextNav","useSearchParams","usePathname","useRouter","useNavigationSplitNextUrlSync","options","paramSelected","paramDrill","method","React","searchParams","pathname","router","selectedId","drilledIn","update","nextSelected","nextDrilled","sp","qs","url","id","d","NHSBehavioursInit","useEffect","cancelled","mod","err","InitBehaviours","InitBehavioursInline"],"mappings":";;;;AAsDA,IAAIA,IAAsB;AAC1B,IAAI;AAGF,EAAAA,IADa,SAAS,gBAAgB,EAAA,EACxB,iBAAiB;AACjC,QAAQ;AACN,EAAAA,IAAU;AACZ;AAEA,MAAMC,IAAkBD,GAAS,iBAC3BE,IAAcF,GAAS,aAEvBG,IAAYH,GAAS;AAapB,SAASI,EAA2CC,IAAgD,IAAI;AAC7G,QAAM,EAAE,eAAAC,IAAgB,OAAO,YAAAC,IAAa,YAAY,QAAAC,IAAS,cAAcH;AAa/E,MAVAI,EAAM,UAAU,MAAM;AACpB,IAAI,QAAQ,IAAI,aAAa,gBAC3B,QAAQ;AAAA,MACN;AAAA,IAAA;AAAA,EAKN,GAAG,CAAA,CAAE,GAED,CAACR,KAAmB,CAACC,KAAe,CAACC;AACvC,WAAI,QAAQ,IAAI,aAAa,gBAC3B,QAAQ,KAAK,yJAAyJ,GAEjK;AAAA,MACL,YAAY;AAAA,MACZ,WAAW;AAAA,MACX,eAAe,MAAM;AAAA,MAAC;AAAA,MACtB,cAAc,MAAM;AAAA,MAAC;AAAA,IAAA;AAIzB,QAAMO,IAAeT,EAAA,GACfU,IAAWT,EAAA,GACXU,IAAST,EAAA,GAETU,IAAcH,EAAa,IAAIJ,CAAa,KAA+B,QAC3EQ,IAAYJ,EAAa,IAAIH,CAAU,MAAM,KAE7CQ,IAASN,EAAM,YAAY,CAACO,GAA8BC,MAAyB;AACvF,UAAMC,IAAK,IAAI,gBAAgBR,EAAa,UAAU;AACtD,IAAIM,IAAcE,EAAG,IAAIZ,GAAe,OAAOU,CAAY,CAAC,IAAQE,EAAG,OAAOZ,CAAa,GAC3FY,EAAG,IAAIX,GAAYU,IAAc,MAAM,GAAG;AAC1C,UAAME,IAAKD,EAAG,SAAA,GACRE,IAAMD,IAAK,GAAGR,CAAQ,IAAIQ,CAAE,KAAKR;AAEvC,KADYH,MAAW,SAASI,EAAO,OAAOA,EAAO,SACjDQ,GAAK,EAAE,QAAQ,GAAA,CAAO;AAAA,EAC5B,GAAG,CAACV,GAAcC,GAAUC,GAAQJ,GAAQF,GAAeC,CAAU,CAAC;AAEtE,SAAO;AAAA,IACL,YAAAM;AAAA,IACA,WAAAC;AAAA,IACA,eAAe,CAACO,MAAuBN,EAAOM,GAAIP,CAAS;AAAA,IAC3D,cAAc,CAACQ,MAAeP,EAAOF,GAAYS,CAAC;AAAA,EAAA;AAEtD;ACvEO,SAASC,IAAoB;AACnC,SAAAC,EAAU,MAAM;AAEf,IAAI,QAAQ,IAAI,aAAa,gBAC5B,QAAQ;AAAA,MACP;AAAA,IAAA;AAMF,QAAIC,IAAY;AAEhB,YAAC,YAAY;AACZ,UAAI;AAEH,cAAMC,IAAW,MAAM,OACtB,0CACD;AACA,YAAID,EAAW;AAIf,YAAIC,KAAO,OAAOA,EAAI,WAAY;AACjC,cAAI;AACH,YAAAA,EAAI,QAAQ,QAAQ;AAAA,UACrB,QAAQ;AAAA,UAAC;AAAA,MAEX,SAASC,GAAK;AACb,gBAAQ,MAAM,gDAAgDA,CAAG;AAAA,MAClE;AAAA,IACD,GAAA,GAEO,MAAM;AACZ,MAAAF,IAAY;AAAA,IACb;AAAA,EACD,GAAG,CAAA,CAAE,GAEE;AACR;ACpFO,SAASG,IAAiB;AAEhC,6CAAQL,GAAA,IAAkB;AAC3B;AAMO,SAASM,IAAuB;AACtC,6CAAQN,GAAA,IAAkB;AAC3B;"}