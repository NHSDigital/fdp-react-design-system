<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NHS Frutiger Font Test</title>
    <style>
        @font-face {
            font-family: "Frutiger W01";
            src: url("https://assets.nhs.uk/fonts/FrutigerLTW01-55Roman.woff2") format("woff2"),
                 url("https://assets.nhs.uk/fonts/FrutigerLTW01-55Roman.woff") format("woff");
            font-weight: 400;
            font-style: normal;
            font-display: swap;
        }

        @font-face {
            font-family: "Frutiger W01";
            src: url("https://assets.nhs.uk/fonts/FrutigerLTW01-65Bold.woff2") format("woff2"),
                 url("https://assets.nhs.uk/fonts/FrutigerLTW01-65Bold.woff") format("woff");
            font-weight: 600;
            font-style: normal;
            font-display: swap;
        }

        .test-text {
            font-family: "Frutiger W01", Arial, Helvetica, sans-serif;
            font-size: 24px;
            margin: 20px;
            padding: 20px;
            border: 1px solid #ccc;
        }

        .fallback-text {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 24px;
            margin: 20px;
            padding: 20px;
            border: 1px solid #999;
        }

        .bold-text {
            font-weight: 600;
        }

        .debug-info {
            font-family: monospace;
            font-size: 12px;
            background: #f0f0f0;
            padding: 10px;
            margin: 20px;
        }
    </style>
</head>
<body>
    <h1>NHS Frutiger Font Loading Test</h1>
    
    <div class="test-text">
        This text should be rendered in Frutiger W01 (Normal weight)
    </div>
    
    <div class="test-text bold-text">
        This text should be rendered in Frutiger W01 (Bold weight)
    </div>
    
    <div class="fallback-text">
        This text is rendered in Arial for comparison
    </div>
    
    <div class="fallback-text bold-text">
        This text is rendered in Arial Bold for comparison
    </div>

    <div class="debug-info">
        <h3>Debug Information</h3>
        <div id="font-check"></div>
        <div id="network-check"></div>
    </div>

    <script>
        async function checkFonts() {
            const debugDiv = document.getElementById('font-check');
            const networkDiv = document.getElementById('network-check');
            
            // Check if document.fonts API is available
            if (!document.fonts) {
                debugDiv.innerHTML = '<strong>Error:</strong> document.fonts API not available';
                return;
            }

            debugDiv.innerHTML = '<strong>Checking fonts...</strong><br>';

            try {
                // Try to load the fonts
                await document.fonts.load('400 1em "Frutiger W01"');
                await document.fonts.load('600 1em "Frutiger W01"');
                
                // Check if fonts are loaded
                const normalLoaded = document.fonts.check('400 1em "Frutiger W01"');
                const boldLoaded = document.fonts.check('600 1em "Frutiger W01"');
                
                debugDiv.innerHTML += `Normal weight (400) loaded: ${normalLoaded}<br>`;
                debugDiv.innerHTML += `Bold weight (600) loaded: ${boldLoaded}<br>`;
                
                // Test font metrics to see if they're actually different from Arial
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                ctx.font = '20px "Frutiger W01", Arial';
                const frutigerWidth = ctx.measureText('Test text for font comparison').width;
                
                ctx.font = '20px Arial';
                const arialWidth = ctx.measureText('Test text for font comparison').width;
                
                debugDiv.innerHTML += `Frutiger text width: ${frutigerWidth}px<br>`;
                debugDiv.innerHTML += `Arial text width: ${arialWidth}px<br>`;
                debugDiv.innerHTML += `Fonts are different: ${frutigerWidth !== arialWidth}<br>`;
                
                if (frutigerWidth === arialWidth) {
                    debugDiv.innerHTML += '<strong>Warning:</strong> Font metrics are identical - Frutiger may not be loading!<br>';
                }
                
            } catch (error) {
                debugDiv.innerHTML += `<strong>Error loading fonts:</strong> ${error.message}<br>`;
            }

            // Test network access to font files
            try {
                const response1 = await fetch('https://assets.nhs.uk/fonts/FrutigerLTW01-55Roman.woff2', {method: 'HEAD'});
                const response2 = await fetch('https://assets.nhs.uk/fonts/FrutigerLTW01-65Bold.woff2', {method: 'HEAD'});
                
                networkDiv.innerHTML = `<strong>Network Check:</strong><br>`;
                networkDiv.innerHTML += `Normal font accessible: ${response1.ok} (${response1.status})<br>`;
                networkDiv.innerHTML += `Bold font accessible: ${response2.ok} (${response2.status})<br>`;
                
                if (!response1.ok || !response2.ok) {
                    networkDiv.innerHTML += '<strong>Error:</strong> Font files not accessible from browser<br>';
                }
                
            } catch (error) {
                networkDiv.innerHTML += `<strong>Network Error:</strong> ${error.message}<br>`;
            }
        }

        // Run checks when DOM is loaded
        document.addEventListener('DOMContentLoaded', checkFonts);
        
        // Also run after fonts should be loaded
        document.fonts.ready.then(() => {
            console.log('All fonts loaded');
            setTimeout(checkFonts, 100); // Small delay to ensure everything is processed
        });
    </script>
</body>
</html>
