@use '../../../packages/nhs-fdp/scss' as nhs;

.nhs-aria-button {
	// Base button styles
	box-sizing: border-box;
	position: relative;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	margin: 0;
	border: 2px solid transparent;
	border-radius: 4px;
	padding: 8px 16px;
	font-family: #{nhs.$nhs-fdp-font-family-base}, #{nhs.$nhs-fdp-font-family-fallback};
	text-align: center;
	text-decoration: none;
	cursor: pointer;
	-webkit-appearance: none;
	-moz-appearance: none;
	appearance: none;
	box-shadow: 0 nhs.$nhs-fdp-button-shadow-size 0 nhs.$nhs-fdp-semantic-color-button-primary-shadow;
	
	// Prevent text selection
	-webkit-user-select: none;
	-moz-user-select: none;
	user-select: none;
	
	// Ensure consistent baseline
	vertical-align: top;

	@include nhs.nhs-fdp-font(19, bold); // Matches NHS UK @include nhsuk-font(19, $weight: bold)

	// Focus styles (React Aria provides focus-visible state)
	&[data-focus-visible] {
		outline: 4px solid nhs.$nhs-fdp-semantic-color-focus-background;
		outline-offset: 2px;
		box-shadow: 0 0 0 4px nhs.$nhs-fdp-semantic-color-focus-background;
	}

	// Hover styles (React Aria provides hovered state)
	&[data-hovered] {
		//transform: translateY(-2px);
		box-shadow: 0 nhs.$nhs-fdp-button-shadow-size 0 nhs.$nhs-fdp-semantic-color-button-primary-shadow;
		color: nhs.$nhs-fdp-color-primary-white;
	}

	// Press/Active styles (React Aria provides pressed state)
	&[data-pressed] {
		transform: translateY(4px);
		//box-shadow: 0 nhs.$nhs-fdp-button-shadow-size 0 nhs.$nhs-fdp-semantic-color-button-primary-shadow;
		box-shadow: 0;
		color: nhs.$nhs-fdp-color-primary-white;
	}

	// Disabled styles
	&[data-disabled] {
		opacity: 0.5;
		cursor: not-allowed;
		transform: none;
		box-shadow: 0 nhs.$nhs-fdp-button-shadow-size 0 nhs.$nhs-fdp-semantic-color-button-primary-shadow;
	}

	// Default size (explicit for clarity)
	// Also covers .nhs-aria-button--default case
	&,
	&--default {
		padding: nhs.$nhs-fdp-component-button-padding-mobile-vertical nhs.$nhs-fdp-component-button-padding-mobile-horizontal;
		font-size: 16px;
		min-height: 44px;

		@media (min-width: nhs.$nhs-fdp-breakpoint-medium) {
			padding: nhs.$nhs-fdp-component-button-padding-desktop-vertical nhs.$nhs-fdp-component-button-padding-desktop-horizontal;
		}
	}

	&[data-focused] {
		background-color: nhs.$nhs-fdp-semantic-color-focus-background;
		color: nhs.$nhs-fdp-semantic-color-focus-text;
		box-shadow: 0 4px 0 nhs.$nhs-fdp-semantic-color-focus-text;
		border-color: nhs.$nhs-fdp-semantic-color-focus-background;
	}

	// Base focus (always works - accessibility baseline)
	&:focus {
		outline: none;
		outline-offset: 2px;
	}

	// Enhanced focus-visible (modern browsers)
	&:focus-visible {
		outline: none;
		outline-offset: 2px;
		box-shadow: 0 4px 0 nhs.$nhs-fdp-semantic-color-focus-text;
	}

	// React Aria enhancement (when available)
	&[data-focus-visible] {
		outline: none;
		outline-offset: 2px;
		box-shadow: 0 4px 0 nhs.$nhs-fdp-semantic-color-focus-text;
	}

	// Special focused state (React Aria managed)
	&[data-focused] {
		background-color: nhs.$nhs-fdp-semantic-color-focus-background;
		color: nhs.$nhs-fdp-semantic-color-focus-text;
		border-color: nhs.$nhs-fdp-semantic-color-focus-background;
	}

	// Remove default outline when React Aria is handling focus
	&[data-focus-visible]:focus {
		outline: none;
	}

	// Remove outline on mouse focus when focus-visible is supported
	&:focus:not(:focus-visible) {
		outline: none;
	}

	&:focus:not(:active) {
		background-color: nhs.$nhs-fdp-semantic-color-focus-background;
		color: nhs.$nhs-fdp-semantic-color-focus-text;
		border-color: nhs.$nhs-fdp-semantic-color-focus-background;
		box-shadow: 0 4px 0 nhs.$nhs-fdp-semantic-color-focus-text;
	}

	// Primary variant
	&--primary {
		background-color: nhs.$nhs-fdp-semantic-color-button-primary-background;
		color: nhs.$nhs-fdp-color-primary-white;
		border-color: nhs.$nhs-fdp-semantic-color-button-primary-background;

		&:not([data-disabled]) {

			&[data-hovered] {
				background-color: nhs.$nhs-fdp-semantic-color-button-primary-hover;
				border-color: nhs.$nhs-fdp-semantic-color-button-primary-hover;
				box-shadow: 0 nhs.$nhs-fdp-button-shadow-size 0 nhs.$nhs-fdp-semantic-color-button-primary-shadow;
			}
			
			&[data-pressed] {
				// This handles the press/active state
				background-color: nhs.$nhs-fdp-semantic-color-button-primary-shadow;
				border-color: nhs.$nhs-fdp-semantic-color-button-primary-active;
				box-shadow: 0 nhs.$nhs-fdp-button-shadow-size 0 nhs.$nhs-fdp-color-primary-white;
				color: nhs.$nhs-fdp-color-primary-white;
			}

			// &[data-disabled]
			// &[data-selected]
			// &[data-loading]
			// &[data-pending]
			// &[data-invalid]
			// &[data-required]
		}
	}

	// Secondary variant
	&--secondary {
		background-color: nhs.$nhs-fdp-color-primary-white;
		color: nhs.$nhs-fdp-color-primary-blue;
		border-color: nhs.$nhs-fdp-color-primary-blue;
		box-shadow: 0 nhs.$nhs-fdp-button-shadow-size 0 nhs.$nhs-fdp-color-primary-blue;

		&:not([data-disabled]) {
			&[data-hovered] {
				background-color: nhs.$nhs-fdp-semantic-color-button-secondary-hover;
				border-color: nhs.$nhs-fdp-semantic-color-button-login-hover;
				color: nhs.$nhs-fdp-semantic-color-button-login-hover;
			}
			&[data-pressed] {
				background-color: nhs.$nhs-fdp-semantic-color-button-secondary-active;
				border-color: nhs.$nhs-fdp-semantic-color-button-login-hover;
				box-shadow: 0 nhs.$nhs-fdp-button-shadow-size 0 nhs.$nhs-fdp-color-primary-white;
			}
		}
	}

	// Reverse variant (for dark backgrounds)
	&--reverse {
		background-color: nhs.$nhs-fdp-color-primary-white;
		color: nhs.$nhs-fdp-semantic-color-button-reverse-text;
		border-color: nhs.$nhs-fdp-color-primary-white;

		&:not([data-disabled]) {
			&[data-hovered] {
				background-color: nhs.$nhs-fdp-semantic-color-button-reverse-hover;
				color: nhs.$nhs-fdp-semantic-color-button-reverse-text;
				border-color: nhs.$nhs-fdp-semantic-color-button-reverse-hover;
			}
			&[data-pressed] {
				background-color: nhs.$nhs-fdp-semantic-color-button-reverse-active;
				border-color: nhs.$nhs-fdp-semantic-color-button-reverse-active;
				box-shadow: 0 nhs.$nhs-fdp-button-shadow-size 0 transparent;
			}
		}
	}

	// Warning variant
	&--warning {
		background-color: nhs.$nhs-fdp-semantic-color-error;
		color: nhs.$nhs-fdp-color-primary-white;
		border-color: nhs.$nhs-fdp-semantic-color-error;
		box-shadow: nhs.$nhs-fdp-shadow-button-warning;

		&:not([data-disabled]) {
			&[data-hovered] {
				background-color: nhs.$nhs-fdp-semantic-color-button-warning-hover;
				border-color: nhs.$nhs-fdp-semantic-color-button-warning-hover;
			}
			&[data-pressed] {
				background-color: nhs.$nhs-fdp-semantic-color-button-warning-active;
				border-color: nhs.$nhs-fdp-semantic-color-button-warning-active;
				box-shadow: 0 nhs.$nhs-fdp-button-shadow-size 0 nhs.$nhs-fdp-color-primary-white;
				color: nhs.$nhs-fdp-color-primary-white;
			}
		}
	}

	// Login variant
	&--login {
		background-color: nhs.$nhs-fdp-color-primary-blue;
		color: nhs.$nhs-fdp-color-primary-white;
		border-color: nhs.$nhs-fdp-color-primary-blue;

		&:not([data-disabled]) {
			&[data-hovered] {
				background-color: nhs.$nhs-fdp-color-primary-blue;
				border-color: nhs.$nhs-fdp-color-primary-blue;
			}
			&[data-pressed] {
				background-color: nhs.$nhs-fdp-semantic-color-button-login-active;
				border-color: nhs.$nhs-fdp-semantic-color-button-login-active;
				box-shadow: 0 nhs.$nhs-fdp-button-shadow-size 0 nhs.$nhs-fdp-color-primary-white;
				color: nhs.$nhs-fdp-color-primary-white;
			}
		}
	}

	// Size variants
	&--small {
		padding: 6px 12px;
		font-size: 14px;
		min-height: 32px;
	}
	
	&--large {
		padding: 12px 24px;
		font-size: 18px;
		min-height: 56px;
	}

	// Full width variant
	&--full-width {
		width: 100%;
		display: flex;
	}

	// Loading state
	&--loading {
		position: relative;
		color: transparent;

		&::after {
			content: "";
			position: absolute;
			top: 50%;
			left: 50%;
			width: 16px;
			height: 16px;
			margin: -8px 0 0 -8px;
			border: 2px solid transparent;
			border-top-color: currentColor;
			border-radius: 50%;
			animation: nhs-button-spin 0.6s linear infinite;
		}
	}

	// Responsive adjustments
	@media (max-width: 768px) {
		width: 100%;
		margin-bottom: 16px;

		&:last-child {
			margin-bottom: 0;
		}
	}
}

// Keyframes for loading spinner
@keyframes nhs-button-spin {
	to {
		transform: rotate(360deg);
	}
}
